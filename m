Return-Path: <driverdev-devel-bounces@linuxdriverproject.org>
X-Original-To: lists+driverdev-devel@lfdr.de
Delivered-To: lists+driverdev-devel@lfdr.de
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
	by mail.lfdr.de (Postfix) with ESMTPS id 499BC32F93
	for <lists+driverdev-devel@lfdr.de>; Mon,  3 Jun 2019 14:28:20 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by hemlock.osuosl.org (Postfix) with ESMTP id 2F7F2879FD;
	Mon,  3 Jun 2019 12:28:18 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 4uKF7+blVptv; Mon,  3 Jun 2019 12:28:17 +0000 (UTC)
Received: from ash.osuosl.org (ash.osuosl.org [140.211.166.34])
	by hemlock.osuosl.org (Postfix) with ESMTP id BCB5387986;
	Mon,  3 Jun 2019 12:28:03 +0000 (UTC)
X-Original-To: devel@linuxdriverproject.org
Delivered-To: driverdev-devel@osuosl.org
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
 by ash.osuosl.org (Postfix) with ESMTP id 1B4E51BF4E6
 for <devel@linuxdriverproject.org>; Mon,  3 Jun 2019 12:28:01 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by whitealder.osuosl.org (Postfix) with ESMTP id 076D485FC0
 for <devel@linuxdriverproject.org>; Mon,  3 Jun 2019 12:28:01 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id M-O5qS+RcB2G for <devel@linuxdriverproject.org>;
 Mon,  3 Jun 2019 12:27:43 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mout.web.de (mout.web.de [212.227.17.11])
 by whitealder.osuosl.org (Postfix) with ESMTPS id 5B8D486146
 for <devel@driverdev.osuosl.org>; Mon,  3 Jun 2019 12:27:29 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=web.de;
 s=dbaedf251592; t=1559564846;
 bh=4Ig1MLesNUJX/Py/2W8C82vany71oY884Fky/7ebFWQ=;
 h=X-UI-Sender-Class:From:To:Cc:Subject:Date:In-Reply-To:References;
 b=RdRVDTlaa5239Z6d0mPpK6jCkycOPsWzDn30Vh3bkIC9o1fXKHIHRO/bbQXTjjE8n
 P51Q6y1KI/1D93EsaPYEc9FsdyKB28R1bw7inwWJ4g47+m5WA6153HQeU/zzr06nvN
 TvwRDMfIgRpPa/enMFgu7d4JjggglDO/oLJoGjnE=
X-UI-Sender-Class: c548c8c5-30a9-4db5-a2e7-cb6cb037b8f9
Received: from lab-pc08.sra.uni-hannover.de ([130.75.33.87]) by smtp.web.de
 (mrweb102 [213.165.67.124]) with ESMTPSA (Nemesis) id
 0LeLWz-1gmMwN28uT-00qE3Z; Mon, 03 Jun 2019 14:21:26 +0200
From: =?UTF-8?q?Christian=20M=C3=BCller?= <muellerch-privat@web.de>
To: gregkh@linuxfoundation.org
Subject: [PATCH 1/3] drivers/staging/rtl8192u: Reformat comments
Date: Mon,  3 Jun 2019 14:21:02 +0200
Message-Id: <20190603122104.2564-2-muellerch-privat@web.de>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190603122104.2564-1-muellerch-privat@web.de>
References: <20190603122104.2564-1-muellerch-privat@web.de>
MIME-Version: 1.0
X-Provags-ID: V03:K1:igxNqR2AXDvQUI2W7009dcLCrvU3znM4ZmriRJq/tOYOncQN2X8
 vt8RCEIOVjaBZM4KGxDhWjMAAy3lC8w/apa03xR7PLxJV3k8GquNM7Dm0zCE8IYovIJIvtd
 +8KF+/hw5WDtxn0keJ3YsSrQvK9+BlzQW1OfY2u5d2af+YcN+BiJ3KSygjpsF0aCmTnbGKV
 5Y/BYXa3aW56JdU5nt3YQ==
X-UI-Out-Filterresults: notjunk:1;V03:K0:zDls2uZhbiU=:7cJ+vdk80if78A77DpB6dB
 xUGqrjoT9GyJa4k0v/BOcL5Dn8xperRphdnWGY9C9QcBeSUb9pmdNx1S6mWrmA8EU449XwrkV
 zfK42KbvkCTfC+mn68jOAr3l6IZYYTXKQdERVGbA9gu9YxSGDibgVsi+cBj6rYEXnEoH/iI4L
 OO+ryLza2dKGuONsyNOVPexcDfzAUI74cmrcLZNlHxwa8mwWUks+awOIEwOocToPk02zf25Dg
 M5rDLYSgWTV9QGI2HKPH1ewWR+XvAFhFPVoYjgoLY3vsLZopZShnm/KSnBoBh2TouP07tg4FT
 DBZAGfEmxKH62mBiVGd/B7YpdbTKX0zh2PIgg56bmNyfYzop2a6xzHsJ7ZkJJPquaVsJ6IInR
 u1MWe5h3tNXei8RpIt7QETDI4k3cYZ8uysdF5wlwBv7HiuVrM8mGc//1AzMWndCvF5QoKodUf
 9Mwnngxs+TtB26PEB8/AESBFTn1W+9A4EBIqxOhm0j1HIdZn3C7Nd1effVczPzXZ20pBAYoHY
 ths7bpC2OvH3Uft/prkc3quRcGGahPbgcrDZeDjAdiEF6Vc5XqWtur7uV/nZaNoTj2OYfwhiv
 UdCFPi46RL3UlM80ruUBOiVsZRgqdn64Z5zr728ZFYct82YQWT4msr8ruCbap6cZnJe5UkIDE
 HW4saC8oC5isVhtziDY5WCPm5JRkKs8UiJ2bgghb58MQjKG9Fz1s0gu3wYwBmDNFpHjffX54T
 3U5x1BZqUSNNb9cNg0ShnqAHGlfViccCHKEPAhKxCiEFnogQI2gsL9q8Pij4aoX+jKYokiTyf
 +ep4IMy6lvDDHP++KqLEKqYVIkot8WW9LEIm9BsEx1abg2kEL88+/7GqN+fb7nFeF8Jt/Qhsx
 XDp9nUzlPBZgBiZt+oZcjVVVyVf4FrJrSmtuMFD/S8BBy2Su52jYgUjdX09XUOdBDJRBGVRSC
 96K/d9MuAO7wwzIT2EQZGIAM9zm5eexU=
X-BeenThere: driverdev-devel@linuxdriverproject.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux Driver Project Developer List
 <driverdev-devel.linuxdriverproject.org>
List-Unsubscribe: <http://driverdev.linuxdriverproject.org/mailman/options/driverdev-devel>, 
 <mailto:driverdev-devel-request@linuxdriverproject.org?subject=unsubscribe>
List-Archive: <http://driverdev.linuxdriverproject.org/pipermail/driverdev-devel/>
List-Post: <mailto:driverdev-devel@linuxdriverproject.org>
List-Help: <mailto:driverdev-devel-request@linuxdriverproject.org?subject=help>
List-Subscribe: <http://driverdev.linuxdriverproject.org/mailman/listinfo/driverdev-devel>, 
 <mailto:driverdev-devel-request@linuxdriverproject.org?subject=subscribe>
Cc: devel@driverdev.osuosl.org, felix.trommer@hotmail.de,
 linux-kernel@i4.cs.fau.de, linux-kernel@vger.kernel.org,
 johnfwhitmore@gmail.com,
 =?UTF-8?q?Christian=20M=C3=BCller?= <muellerch-privat@web.de>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: driverdev-devel-bounces@linuxdriverproject.org
Sender: "devel" <driverdev-devel-bounces@linuxdriverproject.org>

RnJvbTogRmVsaXggVHJvbW1lciA8ZmVsaXgudHJvbW1lckBob3RtYWlsLmRlPgoKUmVwbGFjZSBD
OTktU3R5bGUgY29tbWVudHMgd2l0aCBDODktU3R5bGUgY29tbWVudHMuCgpTaWduZWQtb2ZmLWJ5
OiBGZWxpeCBUcm9tbWVyIDxmZWxpeC50cm9tbWVyQGhvdG1haWwuZGU+ClNpZ25lZC1vZmYtYnk6
IENocmlzdGlhbiBNw7xsbGVyIDxtdWVsbGVyY2gtcHJpdmF0QHdlYi5kZT4KLS0tCiBkcml2ZXJz
L3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2RvdDExZC5jICAgfCAgIDYgKy0KIC4uLi9zdGFn
aW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTEuaCAgICB8IDI3NiArKysrKysrKy0tLS0t
LS0tLQogLi4uL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHQuYyAgICAgIHwgICAz
ICstCiAuLi4vcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdC5oICAgICAgfCAgMTUg
Ky0KIC4uLi9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX2NyeXB0X2NjbXAuYyB8ICAgNiAr
LQogLi4uL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHRfdGtpcC5jIHwgIDEyICst
CiAuLi4vcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdF93ZXAuYyAgfCAgIDkgKy0K
IC4uLi9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX21vZHVsZS5jICAgICB8ICAgMyArLQog
Li4uL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9yeC5jIHwgMjg0ICsrKysr
KysrKysrLS0tLS0tLQogLi4uL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfc29mdG1hYy5j
ICAgIHwgMTk3ICsrKysrKy0tLS0tLQogLi4uL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFf
c29mdG1hY193eC5jIHwgICA4ICstCiAuLi4vc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVl
ZTgwMjExX3R4LmMgfCAxMjQgKysrKy0tLS0KIC4uLi9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIx
MS9pZWVlODAyMTFfd3guYyB8ICA0NSArLS0KIC4uLi9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIx
MS9ydGw4MTl4X0JBLmggICB8ICAgMiArLQogLi4uL3J0bDgxOTJ1L2llZWU4MDIxMS9ydGw4MTl4
X0JBUHJvYy5jICAgICAgIHwgMTQ4ICsrKystLS0tLQogLi4uL3N0YWdpbmcvcnRsODE5MnUvaWVl
ZTgwMjExL3J0bDgxOXhfSFQuaCAgIHwgIDk0ICsrKy0tLQogLi4uL3J0bDgxOTJ1L2llZWU4MDIx
MS9ydGw4MTl4X0hUUHJvYy5jICAgICAgIHwgMTk2ICsrKysrKy0tLS0tLQogLi4uL3N0YWdpbmcv
cnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfUW9zLmggIHwgIDIwICstCiAuLi4vcnRsODE5MnUv
aWVlZTgwMjExL3J0bDgxOXhfVFNQcm9jLmMgICAgICAgfCAgODUgKysrLS0tCiBkcml2ZXJzL3N0
YWdpbmcvcnRsODE5MnUvcjgxODBfOTNjeDYuYyAgICAgICAgfCAgIDMgKy0KIGRyaXZlcnMvc3Rh
Z2luZy9ydGw4MTkydS9yODE4MF85M2N4Ni5oICAgICAgICB8ICAgNCArLQogZHJpdmVycy9zdGFn
aW5nL3J0bDgxOTJ1L3I4MTkwX3J0bDgyNTYuYyAgICAgIHwgIDMzICstCiBkcml2ZXJzL3N0YWdp
bmcvcnRsODE5MnUvcjgxOTJVLmggICAgICAgICAgICAgfCAgNDcgKy0tCiBkcml2ZXJzL3N0YWdp
bmcvcnRsODE5MnUvcjgxOTJVX2NvcmUuYyAgICAgICAgfCAxNTQgKysrKysrLS0tLQogZHJpdmVy
cy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTkyVV9kbS5jICAgICAgICAgIHwgMTMxICsrKystLS0tCiBk
cml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOTJVX2RtLmggICAgICAgICAgfCAgMjIgKy0KIGRy
aXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5MlVfaHcuaCAgICAgICAgICB8IDE3NiArKysrKy0t
LS0tLQogZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTkyVV93eC5jICAgICAgICAgIHwgIDEy
ICstCiBkcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX2NtZHBrdC5jICAgICAgfCAgNzcg
KysrLS0KIGRyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5eFVfY21kcGt0LmggICAgICB8ICAx
NCArLQogZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTl4VV9maXJtd2FyZS5jICAgIHwgICA5
ICstCiBkcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX3BoeS5jICAgICAgICAgfCAgMzAg
Ky0KIGRyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5eFVfcGh5LmggICAgICAgICB8ICAgNCAr
LQogZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTl4VV9waHlyZWcuaCAgICAgIHwgICA5ICst
CiAzNCBmaWxlcyBjaGFuZ2VkLCAxMjY3IGluc2VydGlvbnMoKyksIDk5MSBkZWxldGlvbnMoLSkK
CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2RvdDExZC5j
IGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9kb3QxMWQuYwppbmRleCAxMzBk
ZGZlOTg2OGYuLmJiYjEwMTQwMDdhNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3J0bDgx
OTJ1L2llZWU4MDIxMS9kb3QxMWQuYworKysgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVl
ZTgwMjExL2RvdDExZC5jCkBAIC02MywxNCArNjMsMTYgQEAgdm9pZCBkb3QxMWRfdXBkYXRlX2Nv
dW50cnlfaWUoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmRldiwgdTggKnBUYWRkciwKIAlwVHJp
cGxlID0gKHN0cnVjdCBjaG5sX3R4cG93ZXJfdHJpcGxlICopKHBDb3V0cnlJZSArIDMpOwogCWZv
ciAoaSA9IDA7IGkgPCBOdW1UcmlwbGVzOyBpKyspIHsKIAkJaWYgKE1heENobmxOdW0gPj0gcFRy
aXBsZS0+Zmlyc3RfY2hhbm5lbCkgewotCQkJLyogSXQgaXMgbm90IGluIGEgbW9ub3RvbmljYWxs
eSBpbmNyZWFzaW5nIG9yZGVyLCBzbworCQkJLyoKKwkJCSAqIEl0IGlzIG5vdCBpbiBhIG1vbm90
b25pY2FsbHkgaW5jcmVhc2luZyBvcmRlciwgc28KIAkJCSAqIHN0b3AgcHJvY2Vzc2luZy4KIAkJ
CSAqLwogCQkJbmV0ZGV2X2VycihkZXYtPmRldiwgImRvdDExZF91cGRhdGVfY291bnRyeV9pZSgp
OiBJbnZhbGlkIGNvdW50cnkgSUUsIHNraXAgaXQuLi4uLi4uLjFcbiIpOwogCQkJcmV0dXJuOwog
CQl9CiAJCWlmIChNQVhfQ0hBTk5FTF9OVU1CRVIgPCAocFRyaXBsZS0+Zmlyc3RfY2hhbm5lbCAr
IHBUcmlwbGUtPm51bV9jaGFubmVscykpIHsKLQkJCS8qIEl0IGlzIG5vdCBhIHZhbGlkIHNldCBv
ZiBjaGFubmVsIGlkLCBzbyBzdG9wCisJCQkvKgorCQkJICogSXQgaXMgbm90IGEgdmFsaWQgc2V0
IG9mIGNoYW5uZWwgaWQsIHNvIHN0b3AKIAkJCSAqIHByb2Nlc3NpbmcuCiAJCQkgKi8KIAkJCW5l
dGRldl9lcnIoZGV2LT5kZXYsICJkb3QxMWRfdXBkYXRlX2NvdW50cnlfaWUoKTogSW52YWxpZCBj
b3VudHJ5IElFLCBza2lwIGl0Li4uLi4uLi4yXG4iKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3Rh
Z2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExLmggYi9kcml2ZXJzL3N0YWdpbmcvcnRs
ODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMS5oCmluZGV4IGQzNjk2MzQ2OTAxNS4uOGJlOGE5NGEy
MjUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4
MDIxMS5oCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjEx
LmgKQEAgLTU0LDkgKzU0LDcgQEAKIC8qIGFkZGVkIGZvciBydGw4MTl4IHR4IHByb2NlZHVyZSAq
LwogI2RlZmluZSBNQVhfUVVFVUVfU0laRQkJMHgxMAoKLS8vCi0vLyA4MTkwIHF1ZXVlIG1hcHBp
bmcKLS8vCisvKiA4MTkwIHF1ZXVlIG1hcHBpbmcgKi8KICNkZWZpbmUgQktfUVVFVUUgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgMAogI2RlZmluZSBCRV9RVUVVRSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAxCiAjZGVmaW5lIFZJX1FVRVVFICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIDIKQEAgLTcwLDEzICs2OCwxMyBAQAogI2RlZmluZSBMT1dfUVVFVUUgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBCRV9RVUVVRQogI2RlZmluZSBOT1JNQUxfUVVFVUUgICAg
ICAgICAgICAgICAgICAgICAgICAgICBNR05UX1FVRVVFCgotLy9hZGRlZCBieSBhbXkgZm9yIHBz
CisvKiBhZGRlZCBieSBhbXkgZm9yIHBzICovCiAjZGVmaW5lIFNXUkZfVElNRU9VVAkJCQk1MAoK
LS8vYWRkZWQgYnkgYW15IGZvciBMRUFQIHJlbGF0ZWQKLSNkZWZpbmUgSUVfQ0lTQ09fRkxBR19Q
T1NJVElPTgkJMHgwOAkvLyBGbGFnIGJ5dGU6IGJ5dGUgOCwgbnVtYmVyZWQgZnJvbSAwLgotI2Rl
ZmluZSBTVVBQT1JUX0NLSVBfTUlDCQkJMHgwOAkvLyBiaXQzCi0jZGVmaW5lIFNVUFBPUlRfQ0tJ
UF9QSwkJCTB4MTAJLy8gYml0NAorLyogYWRkZWQgYnkgYW15IGZvciBMRUFQIHJlbGF0ZWQgKi8K
KyNkZWZpbmUgSUVfQ0lTQ09fRkxBR19QT1NJVElPTgkJMHgwOAkvKiBGbGFnIGJ5dGU6IGJ5dGUg
OCwgbnVtYmVyZWQgZnJvbSAwLiAqLworI2RlZmluZSBTVVBQT1JUX0NLSVBfTUlDCQkJMHgwOAkv
KiBiaXQzICovCisjZGVmaW5lIFNVUFBPUlRfQ0tJUF9QSwkJCTB4MTAJLyogYml0NCAqLwogLyog
ZGVmaW5lZCBmb3Igc2tiIGNiIGZpZWxkICovCiAvKiBBdCBtb3N0IDI4IGJ5dGUgKi8KIHN0cnVj
dCBjYl9kZXNjIHsKQEAgLTg4LDcgKzg2LDcgQEAgc3RydWN0IGNiX2Rlc2MgewogCXU4IGJFbmNy
eXB0OjE7CiAJdTggYlR4RGlzYWJsZVJhdGVGYWxsQmFjazoxOwogCXU4IGJUeFVzZURyaXZlckFz
c2luZ2VkUmF0ZToxOwotCXU4IGJId1NlYzoxOyAvL2luZGljYXRlIHdoZXRoZXIgdXNlIEh3IHNl
Y3VyaXR5LiBXQgorCXU4IGJId1NlYzoxOyAvKiBpbmRpY2F0ZSB3aGV0aGVyIHVzZSBIdyBzZWN1
cml0eS4gV0IgKi8KCiAJdTggcmVzZXJ2ZWQxOwoKQEAgLTEwOCwxNyArMTA2LDE3IEBAIHN0cnVj
dCBjYl9kZXNjIHsKIAl1OCBiUlRTVXNlU2hvcnRHSToxOwogCXU4IGJNdWx0aWNhc3Q6MTsKIAl1
OCBiQnJvYWRjYXN0OjE7Ci0JLy91OCByZXNlcnZlZDI6MjsKKwkvKiB1OCByZXNlcnZlZDI6Mjsg
Ki8KIAl1OCBkcnZfYWdnX2VuYWJsZToxOwogCXU4IHJlc2VydmVkMjoxOwoKIAkvKiBUeCBEZXNj
IHJlbGF0ZWQgZWxlbWVudCgxMi0xOSkgKi8KIAl1OCByYXRhX2luZGV4OwogCXU4IHF1ZXVlX2lu
ZGV4OwotCS8vdTggcmVzZXJ2ZWQzOwotCS8vdTggcmVzZXJ2ZWQ0OworCS8qIHU4IHJlc2VydmVk
MzsgKi8KKwkvKiB1OCByZXNlcnZlZDQ7ICovCiAJdTE2IHR4YnVmX3NpemU7Ci0JLy91OCByZXNl
cnZlZDU7CisJLyogdTggcmVzZXJ2ZWQ1OyAqLwogCXU4IFJBVFJJbmRleDsKIAl1OCByZXNlcnZl
ZDY7CiAJdTggcmVzZXJ2ZWQ3OwpAQCAtMTI5LDkgKzEyNyw5IEBAIHN0cnVjdCBjYl9kZXNjIHsK
IAl1OCBydHNfcmF0ZTsKIAl1OCBhbXBkdV9mYWN0b3I7CiAJdTggYW1wZHVfZGVuc2l0eTsKLQkv
L3U4IHJlc2VydmVkOTsKLQkvL3U4IHJlc2VydmVkMTA7Ci0JLy91OCByZXNlcnZlZDExOworCS8q
IHU4IHJlc2VydmVkOTsgKi8KKwkvKiB1OCByZXNlcnZlZDEwOyAqLworCS8qIHU4IHJlc2VydmVk
MTE7ICovCiAJdTggRHJ2QWdnck51bTsKIAl1MTYgcGt0X3NpemU7CiAJdTggcmVzZXJ2ZWQxMjsK
QEAgLTE4NywxNSArMTg1LDIxIEBAIHN0cnVjdCBjYl9kZXNjIHsKICNkZWZpbmUgSUVFRV9QQVJB
TV9QUklWQUNZX0lOVk9LRUQJCTQKICNkZWZpbmUgSUVFRV9QQVJBTV9BVVRIX0FMR1MJCQk1CiAj
ZGVmaW5lIElFRUVfUEFSQU1fSUVFRV84MDJfMVgJCQk2Ci0vL0l0IHNob3VsZCBjb25zaXN0ZW50
IHdpdGggdGhlIGRyaXZlcl9YWFguYwotLy8gICBEYXZpZCwgMjAwNi45LjI2CisvKgorICogSXQg
c2hvdWxkIGNvbnNpc3RlbnQgd2l0aCB0aGUgZHJpdmVyX1hYWC5jCisgKiBEYXZpZCwgMjAwNi45
LjI2CisgKi8KICNkZWZpbmUgSUVFRV9QQVJBTV9XUEFYX1NFTEVDVAkJCTcKLS8vQWRkZWQgZm9y
IG5vdGlmeSB0aGUgZW5jcnlwdGlvbiB0eXBlIHNlbGVjdGlvbgotLy8gICBEYXZpZCwgMjAwNi45
LjI2CisvKgorICogQWRkZWQgZm9yIG5vdGlmeSB0aGUgZW5jcnlwdGlvbiB0eXBlIHNlbGVjdGlv
bgorICogRGF2aWQsIDIwMDYuOS4yNgorICovCiAjZGVmaW5lIElFRUVfUFJPVE9fV1BBCQkJCTEK
ICNkZWZpbmUgSUVFRV9QUk9UT19SU04JCQkJMgotLy9BZGRlZCBmb3Igbm90aWZ5IHRoZSBlbmNy
eXB0aW9uIHR5cGUgc2VsZWN0aW9uCi0vLyAgIERhdmlkLCAyMDA2LjkuMjYKKy8qCisgKiBBZGRl
ZCBmb3Igbm90aWZ5IHRoZSBlbmNyeXB0aW9uIHR5cGUgc2VsZWN0aW9uCisgKiBEYXZpZCwgMjAw
Ni45LjI2CisgKi8KICNkZWZpbmUgSUVFRV9XUEFYX1VTRUdST1VQCQkJMAogI2RlZmluZSBJRUVF
X1dQQVhfV0VQNDAJCQkJMQogI2RlZmluZSBJRUVFX1dQQVhfVEtJUAkJCQkyCkBAIC0yMjIsNyAr
MjI2LDcgQEAgc3RydWN0IGNiX2Rlc2MgewoKICNkZWZpbmUgTUFYX0lFX0xFTiAgMHhmZgoKLS8v
IGFkZGVkIGZvciBrZXJuZWwgY29uZmxpY3QKKy8qIGFkZGVkIGZvciBrZXJuZWwgY29uZmxpY3Qg
Ki8KICNkZWZpbmUgaWVlZTgwMjExX2NyeXB0X2RlaW5pdF9lbnRyaWVzCWllZWU4MDIxMV9jcnlw
dF9kZWluaXRfZW50cmllc19yc2wKICNkZWZpbmUgaWVlZTgwMjExX2NyeXB0X2RlaW5pdF9oYW5k
bGVyCWllZWU4MDIxMV9jcnlwdF9kZWluaXRfaGFuZGxlcl9yc2wKICNkZWZpbmUgaWVlZTgwMjEx
X2NyeXB0X2RlbGF5ZWRfZGVpbml0CWllZWU4MDIxMV9jcnlwdF9kZWxheWVkX2RlaW5pdF9yc2wK
QEAgLTMyMiw3ICszMjYsNyBAQCBzdHJ1Y3QgaWVlZV9wYXJhbSB7CiB9OwoKCi0vLyBsaW51eCB1
bmRlciAyLjYuOSByZWxlYXNlIG1heSBub3Qgc3VwcG9ydCBpdCwgc28gbW9kaWZ5IGl0IGZvciBj
b21tb24gdXNlCisvKiBsaW51eCB1bmRlciAyLjYuOSByZWxlYXNlIG1heSBub3Qgc3VwcG9ydCBp
dCwgc28gbW9kaWZ5IGl0IGZvciBjb21tb24gdXNlICovCiAjZGVmaW5lIElFRUU4MDIxMV9EQVRB
X0xFTgkJMjMwNAogLyogTWF4aW11bSBzaXplIGZvciB0aGUgTUEtVU5JVERBVEEgcHJpbWl0aXZl
LCA4MDIuMTEgc3RhbmRhcmQgc2VjdGlvbgogICogICA2LjIuMS4xLjIuCkBAIC0zNTQsNyArMzU4
LDcgQEAgc3RydWN0IGllZWVfcGFyYW0gewogI2RlZmluZSBJRUVFODAyMTFfRkNUTF9GUkFNRVRZ
UEUJMHgwMGZjCiAjZGVmaW5lIElFRUU4MDIxMV9GQ1RMX1RPRFMJCTB4MDEwMAogI2RlZmluZSBJ
RUVFODAyMTFfRkNUTF9GUk9NRFMJCTB4MDIwMAotI2RlZmluZSBJRUVFODAyMTFfRkNUTF9EU1RP
RFMJCTB4MDMwMCAvL2FkZGVkIGJ5IGRhdmlkCisjZGVmaW5lIElFRUU4MDIxMV9GQ1RMX0RTVE9E
UwkJMHgwMzAwIC8qIGFkZGVkIGJ5IGRhdmlkICovCiAjZGVmaW5lIElFRUU4MDIxMV9GQ1RMX01P
UkVGUkFHUwkweDA0MDAKICNkZWZpbmUgSUVFRTgwMjExX0ZDVExfUkVUUlkJCTB4MDgwMAogI2Rl
ZmluZSBJRUVFODAyMTFfRkNUTF9QTQkJMHgxMDAwCkBAIC0zOTgsNyArNDAyLDcgQEAgc3RydWN0
IGllZWVfcGFyYW0gewogI2RlZmluZSBJRUVFODAyMTFfU1RZUEVfQ0ZBQ0sJCTB4MDA1MAogI2Rl
ZmluZSBJRUVFODAyMTFfU1RZUEVfQ0ZQT0xMCQkweDAwNjAKICNkZWZpbmUgSUVFRTgwMjExX1NU
WVBFX0NGQUNLUE9MTAkweDAwNzAKLSNkZWZpbmUgSUVFRTgwMjExX1NUWVBFX1FPU19EQVRBCTB4
MDA4MCAvL2FkZGVkIGZvciBXTU0gMjAwNi84LzIKKyNkZWZpbmUgSUVFRTgwMjExX1NUWVBFX1FP
U19EQVRBCTB4MDA4MCAvKiBhZGRlZCBmb3IgV01NIDIwMDYvOC8yICovCiAjZGVmaW5lIElFRUU4
MDIxMV9TVFlQRV9RT1NfTlVMTAkweDAwQzAKCiAjZGVmaW5lIElFRUU4MDIxMV9TQ1RMX0ZSQUcJ
CTB4MDAwRgpAQCAtNDEwLDcgKzQxNCw3IEBAIHN0cnVjdCBpZWVlX3BhcmFtIHsKICNkZWZpbmUJ
RkNfUU9TX0JJVAkJCQkJQklUKDcpCiAjZGVmaW5lIElzRGF0YUZyYW1lKHBkdSkJCQkoKChwZHVb
MF0gJiAweDBDKSA9PSAweDA4KSA/IHRydWUgOiBmYWxzZSkKICNkZWZpbmUJSXNMZWdhY3lEYXRh
RnJhbWUocGR1KQkoSXNEYXRhRnJhbWUocGR1KSAmJiAoIShwZHVbMF0gJiBGQ19RT1NfQklUKSkp
Ci0vL2FkZGVkIGJ5IHdiLiBJcyB0aGlzIHJpZ2h0PworLyogYWRkZWQgYnkgd2IuIElzIHRoaXMg
cmlnaHQ/ICovCiAjZGVmaW5lIElzUW9TRGF0YUZyYW1lKHBmcmFtZSkgICgoKih1MTYgKilwZnJh
bWUgJiAoSUVFRTgwMjExX1NUWVBFX1FPU19EQVRBIHwgSUVFRTgwMjExX0ZUWVBFX0RBVEEpKSA9
PSAoSUVFRTgwMjExX1NUWVBFX1FPU19EQVRBIHwgSUVFRTgwMjExX0ZUWVBFX0RBVEEpKQogI2Rl
ZmluZSBGcmFtZV9PcmRlcihwZnJhbWUpICAgICAoKih1MTYgKilwZnJhbWUgJiBJRUVFODAyMTFf
RkNUTF9PUkRFUikKICNkZWZpbmUgU05fTEVTUyhhLCBiKQkJKCgoYSAtIGIpICYgMHg4MDApICE9
IDApCkBAIC00NTAsOCArNDU0LDggQEAgZXh0ZXJuIHUzMiBpZWVlODAyMTFfZGVidWdfbGV2ZWw7
CiAjZGVmaW5lIElFRUU4MDIxMV9ERUJVRyhsZXZlbCwgZm10LCBhcmdzLi4uKSBcCiBkbyB7IGlm
IChpZWVlODAyMTFfZGVidWdfbGV2ZWwgJiAobGV2ZWwpKSBcCiAgIHByaW50ayhLRVJOX0RFQlVH
ICJpZWVlODAyMTE6ICIgZm10LCAjIyBhcmdzKTsgfSB3aGlsZSAoMCkKLS8vd2IgYWRkZWQgdG8g
ZGVidWcgb3V0IGRhdGEgYnVmCi0vL2lmIHlvdSB3YW50IHByaW50IERBVEEgYnVmZmVyIHJlbGF0
ZWQgQkEsIHBsZWFzZSBzZXQgaWVlZTgwMjExX2RlYnVnX2xldmVsIHRvIERBVEF8QkEKKy8qIHdi
IGFkZGVkIHRvIGRlYnVnIG91dCBkYXRhIGJ1ZiAqLworLyogaWYgeW91IHdhbnQgcHJpbnQgREFU
QSBidWZmZXIgcmVsYXRlZCBCQSwgcGxlYXNlIHNldCBpZWVlODAyMTFfZGVidWdfbGV2ZWwgdG8g
REFUQXxCQSAqLwogI2RlZmluZSBJRUVFODAyMTFfREVCVUdfREFUQShsZXZlbCwgZGF0YSwgZGF0
YWxlbikJXAogCWRvIHsgaWYgKChpZWVlODAyMTFfZGVidWdfbGV2ZWwgJiAobGV2ZWwpKSA9PSAo
bGV2ZWwpKQlcCiAJCXsJXApAQCAtNTExLDE2ICs1MTUsMTYgQEAgZG8geyBpZiAoaWVlZTgwMjEx
X2RlYnVnX2xldmVsICYgKGxldmVsKSkgXAogI2RlZmluZSBJRUVFODAyMTFfRExfVFggICAgICAg
ICAgICAoMTw8OCkKICNkZWZpbmUgSUVFRTgwMjExX0RMX1JYICAgICAgICAgICAgKDE8PDkpCgot
I2RlZmluZSBJRUVFODAyMTFfRExfSFQJCSAgICgxPDwxMCkgIC8vSFQKLSNkZWZpbmUgSUVFRTgw
MjExX0RMX0JBCQkgICAoMTw8MTEpICAvL2JhCi0jZGVmaW5lIElFRUU4MDIxMV9ETF9UUwkJICAg
KDE8PDEyKSAgLy9UUworI2RlZmluZSBJRUVFODAyMTFfRExfSFQJCSAgICgxPDwxMCkgIC8qIEhU
ICovCisjZGVmaW5lIElFRUU4MDIxMV9ETF9CQQkJICAgKDE8PDExKSAgLyogYmEgKi8KKyNkZWZp
bmUgSUVFRTgwMjExX0RMX1RTCQkgICAoMTw8MTIpICAvKiBUUyAqLwogI2RlZmluZSBJRUVFODAy
MTFfRExfUU9TICAgICAgICAgICAoMTw8MTMpCiAjZGVmaW5lIElFRUU4MDIxMV9ETF9SRU9SREVS
CSAgICgxPDwxNCkKICNkZWZpbmUgSUVFRTgwMjExX0RMX0lPVAkgICAoMTw8MTUpCiAjZGVmaW5l
IElFRUU4MDIxMV9ETF9JUFMJICAgKDE8PDE2KQotI2RlZmluZSBJRUVFODAyMTFfRExfVFJBQ0UJ
ICAgKDE8PDI5KSAgLy90cmFjZSBmdW5jdGlvbiwgbmVlZCB0byB1c2VyIG5ldF9yYXRlbGltaXQo
KSB0b2dldGhlciBpbiBvcmRlciBub3QgdG8gcHJpbnQgdG9vIG11Y2ggdG8gdGhlIHNjcmVlbgot
I2RlZmluZSBJRUVFODAyMTFfRExfREFUQQkgICAoMTw8MzApICAgLy91c2UgdGhpcyBmbGFnIHRv
IGNvbnRyb2wgd2hldGhlciBwcmludCBkYXRhIGJ1ZiBvdXQuCi0jZGVmaW5lIElFRUU4MDIxMV9E
TF9FUlIJICAgKDE8PDMxKSAgIC8vYWx3YXlzIG9wZW4KKyNkZWZpbmUgSUVFRTgwMjExX0RMX1RS
QUNFCSAgICgxPDwyOSkgIC8qIHRyYWNlIGZ1bmN0aW9uLCBuZWVkIHRvIHVzZXIgbmV0X3JhdGVs
aW1pdCgpIHRvZ2V0aGVyIGluIG9yZGVyIG5vdCB0byBwcmludCB0b28gbXVjaCB0byB0aGUgc2Ny
ZWVuICovCisjZGVmaW5lIElFRUU4MDIxMV9ETF9EQVRBCSAgICgxPDwzMCkgICAvKiB1c2UgdGhp
cyBmbGFnIHRvIGNvbnRyb2wgd2hldGhlciBwcmludCBkYXRhIGJ1ZiBvdXQuICovCisjZGVmaW5l
IElFRUU4MDIxMV9ETF9FUlIJICAgKDE8PDMxKSAgIC8qIGFsd2F5cyBvcGVuICovCiAjZGVmaW5l
IElFRUU4MDIxMV9FUlJPUihmLCBhLi4uKSBwcmludGsoS0VSTl9FUlIgImllZWU4MDIxMTogIiBm
LCAjIyBhKQogI2RlZmluZSBJRUVFODAyMTFfV0FSTklORyhmLCBhLi4uKSBwcmludGsoS0VSTl9X
QVJOSU5HICJpZWVlODAyMTE6ICIgZiwgIyMgYSkKICNkZWZpbmUgSUVFRTgwMjExX0RFQlVHX0lO
Rk8oZiwgYS4uLikgICBJRUVFODAyMTFfREVCVUcoSUVFRTgwMjExX0RMX0lORk8sIGYsICMjIGEp
CkBAIC01MzksOSArNTQzLDkgQEAgZG8geyBpZiAoaWVlZTgwMjExX2RlYnVnX2xldmVsICYgKGxl
dmVsKSkgXAogI2luY2x1ZGUgPGxpbnV4L2lmX2FycC5oPiAvKiBBUlBIUkRfRVRIRVIgKi8KCiAj
aWZuZGVmIFdJUkVMRVNTX1NQWQotI2RlZmluZSBXSVJFTEVTU19TUFkJCS8vIGVuYWJsZSBpd3Nw
eSBzdXBwb3J0CisjZGVmaW5lIFdJUkVMRVNTX1NQWQkJLyogZW5hYmxlIGl3c3B5IHN1cHBvcnQg
Ki8KICNlbmRpZgotI2luY2x1ZGUgPG5ldC9pd19oYW5kbGVyLmg+CS8vIG5ldyBkcml2ZXIgQVBJ
CisjaW5jbHVkZSA8bmV0L2l3X2hhbmRsZXIuaD4JLyogbmV3IGRyaXZlciBBUEkgKi8KCiAjaWZu
ZGVmIEVUSF9QX1BBRQogI2RlZmluZSBFVEhfUF9QQUUgMHg4ODhFIC8qIFBvcnQgQWNjZXNzIEVu
dGl0eSAoSUVFRSA4MDIuMVgpICovCkBAIC02NjAsNyArNjY0LDcgQEAgc3RydWN0IGllZWU4MDIx
MV9zbmFwX2hkciB7CiAjZGVmaW5lIElFRUU4MDIxMV9PRkRNX1NISUZUX01BU0tfQSAgICAgICAg
IDQKCgotLyogdGhpcyBpcyBzdG9sZW4gYW5kIG1vZGlmaWVkIGZyb20gdGhlIG1hZHdpZmkgZHJp
dmVyKi8KKy8qIHRoaXMgaXMgc3RvbGVuIGFuZCBtb2RpZmllZCBmcm9tIHRoZSBtYWR3aWZpIGRy
aXZlciAqLwogI2RlZmluZSBJRUVFODAyMTFfRkMwX1RZUEVfTUFTSwkJMHgwYwogI2RlZmluZSBJ
RUVFODAyMTFfRkMwX1RZUEVfREFUQQkJMHgwOAogI2RlZmluZSBJRUVFODAyMTFfRkMwX1NVQlRZ
UEVfTUFTSwkweEIwCkBAIC03MDAsMjggKzcwNCwyOCBAQCBzdHJ1Y3QgaWVlZTgwMjExX3J4X3N0
YXRzIHsKIAl1OCBuaWNfdHlwZTsKIAl1MTYgICAgICAgTGVuZ3RoOwogCS8vICAgICAgdTggICAg
ICAgIERhdGFSYXRlOyAgICAgIC8vIEluIDAuNSBNYnBzCi0JdTggICAgICAgIFNpZ25hbFF1YWxp
dHk7IC8vIGluIDAtMTAwIGluZGV4LgotCXMzMiAgICAgICBSZWN2U2lnbmFsUG93ZXI7IC8vIFJl
YWwgcG93ZXIgaW4gZEJtIGZvciB0aGlzIHBhY2tldCwgbm8gYmVhdXRpZmljYXRpb24gYW5kIGFn
Z3JlZ2F0aW9uLgotCXM4ICAgICAgICBSeFBvd2VyOyAvLyBpbiBkQm0gVHJhbnNsYXRlIGZyb20g
UFdkQgotCXU4ICAgICAgICBTaWduYWxTdHJlbmd0aDsgLy8gaW4gMC0xMDAgaW5kZXguCisJdTgg
ICAgICAgIFNpZ25hbFF1YWxpdHk7IC8qIGluIDAtMTAwIGluZGV4LiAqLworCXMzMiAgICAgICBS
ZWN2U2lnbmFsUG93ZXI7IC8qIFJlYWwgcG93ZXIgaW4gZEJtIGZvciB0aGlzIHBhY2tldCwgbm8g
YmVhdXRpZmljYXRpb24gYW5kIGFnZ3JlZ2F0aW9uLiAqLworCXM4ICAgICAgICBSeFBvd2VyOyAv
KiBpbiBkQm0gVHJhbnNsYXRlIGZyb20gUFdkQiAqLworCXU4ICAgICAgICBTaWduYWxTdHJlbmd0
aDsgLyogaW4gMC0xMDAgaW5kZXguICovCiAJdTE2ICAgICAgIGJId0Vycm9yOjE7CiAJdTE2ICAg
ICAgIGJDUkM6MTsKIAl1MTYgICAgICAgYklDVjoxOwogCXUxNiAgICAgICBiU2hvcnRQcmVhbWJs
ZToxOwotCXUxNiAgICAgICBBbnRlbm5hOjE7ICAgICAgLy9mb3IgcnRsODE4NQotCXUxNiAgICAg
ICBEZWNyeXB0ZWQ6MTsgICAgLy9mb3IgcnRsODE4NSwgcnRsODE4NwotCXUxNiAgICAgICBXYWtl
dXA6MTsgICAgICAgLy9mb3IgcnRsODE4NQotCXUxNiAgICAgICBSZXNlcnZlZDA6MTsgICAgLy9m
b3IgcnRsODE4NQorCXUxNiAgICAgICBBbnRlbm5hOjE7ICAgICAgLyogZm9yIHJ0bDgxODUgKi8K
Kwl1MTYgICAgICAgRGVjcnlwdGVkOjE7ICAgIC8qIGZvciBydGw4MTg1LCBydGw4MTg3ICovCisJ
dTE2ICAgICAgIFdha2V1cDoxOyAgICAgICAvKiBmb3IgcnRsODE4NSAqLworCXUxNiAgICAgICBS
ZXNlcnZlZDA6MTsgICAgLyogZm9yIHJ0bDgxODUgKi8KIAl1OCAgICAgICAgQUdDOwogCXUzMiAg
ICAgICBUaW1lU3RhbXBMb3c7CiAJdTMyICAgICAgIFRpbWVTdGFtcEhpZ2g7CiAJYm9vbCAgICAg
IGJTaGlmdDsKLQlib29sICAgICAgYklzUW9zRGF0YTsgICAgICAgICAgICAgLy8gQWRkZWQgYnkg
QW5uaWUsIDIwMDUtMTItMjIuCisJYm9vbCAgICAgIGJJc1Fvc0RhdGE7ICAgICAgICAgICAgIC8q
IEFkZGVkIGJ5IEFubmllLCAyMDA1LTEyLTIyLiAqLwogCXU4ICAgICAgICBVc2VyUHJpb3JpdHk7
CgotCS8vMSEhISEhISEhISEhISEhISEhISEhISEhISEhIQotCS8vMUF0dGVudGlvbiBQbGVhc2Uh
ISE8MTFuIG9yIDgxOTAgc3BlY2lmaWMgY29kZSBzaG91bGQgYmUgcHV0IGJlbG93IHRoaXMgbGlu
ZT4KLQkvLzEhISEhISEhISEhISEhISEhISEhISEhISEhISEKKwkvKgorCSAqIEF0dGVudGlvbiBQ
bGVhc2UhISE8MTFuIG9yIDgxOTAgc3BlY2lmaWMgY29kZSBzaG91bGQgYmUgcHV0IGJlbG93IHRo
aXMgbGluZT4KKwkgKi8KCiAJdTggICAgICAgIFJ4RHJ2SW5mb1NpemU7CiAJdTggICAgICAgIFJ4
QnVmU2hpZnQ7CkBAIC03MzAsMjEgKzczNCwyMSBAQCBzdHJ1Y3QgaWVlZTgwMjExX3J4X3N0YXRz
IHsKIAlib29sICAgICAgYkNvbnRhaW5IVEM7CiAJYm9vbCAgICAgIFJ4SXM0ME1IelBhY2tldDsK
IAl1MzIgICAgICAgUnhQV0RCQWxsOwotCXU4ICAgICAgICBSeE1JTU9TaWduYWxTdHJlbmd0aFs0
XTsgICAgICAgIC8vIGluIDB+MTAwIGluZGV4CisJdTggICAgICAgIFJ4TUlNT1NpZ25hbFN0cmVu
Z3RoWzRdOyAgICAgICAgLyogaW4gMH4xMDAgaW5kZXggKi8KIAlzOCAgICAgICAgUnhNSU1PU2ln
bmFsUXVhbGl0eVsyXTsKIAlib29sICAgICAgYlBhY2tldE1hdGNoQlNTSUQ7CiAJYm9vbCAgICAg
IGJJc0NDSzsKIAlib29sICAgICAgYlBhY2tldFRvU2VsZjsKLQkvL2FkZGVkIGJ5IGFteQorCS8q
IGFkZGVkIGJ5IGFteSAqLwogCXU4ICAgICAgICAqdmlydHVhbF9hZGRyZXNzOwotCXUxNiAgICAg
ICAgICBwYWNrZXRsZW5ndGg7ICAgICAgICAgICAgICAvLyBUb3RhbCBwYWNrZXQgbGVuZ3RoOiBN
dXN0IGVxdWFsIHRvIHN1bSBvZiBhbGwgRnJhZ0xlbmd0aAotCXUxNiAgICAgICAgICBmcmFnbGVu
Z3RoOyAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZyYWdMZW5ndGggc2hvdWxkIGVxdWFsIHRv
IFBhY2tldExlbmd0aCBpbiBub24tZnJhZ21lbnQgY2FzZQotCXUxNiAgICAgICAgICBmcmFnb2Zm
c2V0OyAgICAgICAgICAgICAgICAgICAgICAgIC8vIERhdGEgb2Zmc2V0IGZvciB0aGlzIGZyYWdt
ZW50CisJdTE2ICAgICAgICAgIHBhY2tldGxlbmd0aDsgICAgICAgICAgICAgIC8qIFRvdGFsIHBh
Y2tldCBsZW5ndGg6IE11c3QgZXF1YWwgdG8gc3VtIG9mIGFsbCBGcmFnTGVuZ3RoICovCisJdTE2
ICAgICAgICAgIGZyYWdsZW5ndGg7ICAgICAgICAgICAgICAgICAgICAgICAgLyogRnJhZ0xlbmd0
aCBzaG91bGQgZXF1YWwgdG8gUGFja2V0TGVuZ3RoIGluIG5vbi1mcmFnbWVudCBjYXNlICovCisJ
dTE2ICAgICAgICAgIGZyYWdvZmZzZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgLyogRGF0YSBv
ZmZzZXQgZm9yIHRoaXMgZnJhZ21lbnQgKi8KIAl1MTYgICAgICAgICAgbnRvdGFsZnJhZzsKIAli
b29sCQkgIGJpc3J4YWdncnN1YmZyYW1lOwotCWJvb2wJCSAgYlBhY2tldEJlYWNvbjsJLy9jb3Nh
IGFkZCBmb3IgcnNzaQotCWJvb2wJCSAgYlRvU2VsZkJBOwkJLy9jb3NhIGFkZCBmb3IgcnNzaQot
CXM4CQkgIGNja19hZGNfcHdkYls0XTsJLy9jb3NhIGFkZCBmb3IgcnggcGF0aCBzZWxlY3Rpb24K
Kwlib29sCQkgIGJQYWNrZXRCZWFjb247CS8qIGNvc2EgYWRkIGZvciByc3NpICovCisJYm9vbAkJ
ICBiVG9TZWxmQkE7CQkvKiBjb3NhIGFkZCBmb3IgcnNzaSAqLworCXM4CQkgIGNja19hZGNfcHdk
Yls0XTsJLyogY29zYSBhZGQgZm9yIHJ4IHBhdGggc2VsZWN0aW9uICovCiAJdTE2CQkgIFNlcV9O
dW07CgogfTsKQEAgLTEwNjQsNyArMTA2OCw3IEBAIHR5cGVkZWYgdW5pb24gX2ZyYW1lcW9zIHsK
CiAjZGVmaW5lIE1BWF9DSEFOTkVMX05VTUJFUiAgICAgICAgICAgICAgICAgMTYxCiAjZGVmaW5l
IElFRUU4MDIxMV9TT0ZUTUFDX1NDQU5fVElNRQkgICAxMDAKLS8vKEhaIC8gMikKKy8qIChIWiAv
IDIpICovCiAjZGVmaW5lIElFRUU4MDIxMV9TT0ZUTUFDX0FTU09DX1JFVFJZX1RJTUUgKEhaICog
MikKCiAjZGVmaW5lIENSQ19MRU5HVEggICAgICAgICAgICAgICAgIDRVCkBAIC0xMTg1LDcgKzEx
ODksNyBAQCBzdGF0aWMgaW5saW5lIGNvbnN0IGNoYXIgKmVhcF9nZXRfdHlwZShpbnQgdHlwZSkK
IHsKIAlyZXR1cm4gKCh1MzIpdHlwZSA+PSBBUlJBWV9TSVpFKGVhcF90eXBlcykpID8gIlVua25v
d24iIDogZWFwX3R5cGVzW3R5cGVdOwogfQotLy9hZGRlZCBieSBhbXkgZm9yIHJlb3JkZXIKKy8q
IGFkZGVkIGJ5IGFteSBmb3IgcmVvcmRlciAqLwogc3RhdGljIGlubGluZSB1OCBGcmFtZV9Rb1NU
SUQodTggKmJ1ZikKIHsKIAlzdHJ1Y3QgcnRsXzgwMjExX2hkcl8zYWRkciAqaGRyOwpAQCAtMTE5
NSw3ICsxMTk5LDcgQEAgc3RhdGljIGlubGluZSB1OCBGcmFtZV9Rb1NUSUQodTggKmJ1ZikKIAly
ZXR1cm4gKHU4KSgoZnJhbWVxb3MgKikoYnVmICsgKCgoZmMgJiBJRUVFODAyMTFfRkNUTF9UT0RT
KSAmJiAoZmMgJiBJRUVFODAyMTFfRkNUTF9GUk9NRFMpKSA/IDMwIDogMjQpKSktPmZpZWxkLnRp
ZDsKIH0KCi0vL2FkZGVkIGJ5IGFteSBmb3IgcmVvcmRlcgorLyogYWRkZWQgYnkgYW15IGZvciBy
ZW9yZGVyICovCgogc3RydWN0IGVhcG9sIHsKIAl1OCBzbmFwWzZdOwpAQCAtMTI1Myw3ICsxMjU3
LDcgQEAgc3RydWN0IGllZWU4MDIxMV9pbmZvX2VsZW1lbnRfaGRyIHsKICovCgogI2RlZmluZSBJ
RUVFODAyMTFfREVGQVVMVF9UWF9FU1NJRCAiUGVuZ3VpbiIKLSNkZWZpbmUgSUVFRTgwMjExX0RF
RkFVTFRfQkFTSUNfUkFURSAyIC8vMU1icHMKKyNkZWZpbmUgSUVFRTgwMjExX0RFRkFVTFRfQkFT
SUNfUkFURSAyIC8qIDFNYnBzICovCgogZW51bSB7V01NX2FsbF9mcmFtZSwgV01NX3R3b19mcmFt
ZSwgV01NX2ZvdXJfZnJhbWUsIFdNTV9zaXhfZnJhbWV9OwogI2RlZmluZSBNQVhfU1BfTGVuICAo
V01NX2FsbF9mcmFtZSA8PCA0KQpAQCAtMTI2OSw3ICsxMjczLDcgQEAgZW51bSB7V01NX2FsbF9m
cmFtZSwgV01NX3R3b19mcmFtZSwgV01NX2ZvdXJfZnJhbWUsIFdNTV9zaXhfZnJhbWV9OwogI2Rl
ZmluZSBJRUVFODAyMTFfUFNfVU5JQ0FTVCBJRUVFODAyMTFfRFRJTV9VQ0FTVAogI2RlZmluZSBJ
RUVFODAyMTFfUFNfTUJDQVNUIElFRUU4MDIxMV9EVElNX01CQ0FTVAoKLS8vYWRkZWQgYnkgRGF2
aWQgZm9yIFFvUyAyMDA2LzYvMzAKKy8qIGFkZGVkIGJ5IERhdmlkIGZvciBRb1MgMjAwNi82LzMw
ICovCiAvLyNkZWZpbmUgV01NX0hhbmdfODE4NwogI2lmZGVmIFdNTV9IYW5nXzgxODcKICN1bmRl
ZiBXTU1fSGFuZ184MTg3CkBAIC0xMjg1LDcgKzEyODksNyBAQCBlbnVtIHtXTU1fYWxsX2ZyYW1l
LCBXTU1fdHdvX2ZyYW1lLCBXTU1fZm91cl9mcmFtZSwgV01NX3NpeF9mcmFtZX07CgogI2RlZmlu
ZSBNQVhfUkVDRUlWRV9CVUZGRVJfU0laRSA5MTAwCgotLy9VUCBNYXBwaW5nIHRvIEFDLCB1c2lu
ZyBpbiBNZ250UXVlcnlfU2VxdWVuY2VOdW1iZXIoKSBhbmQgbWF5YmUgZm9yIERTQ1AKKy8qIFVQ
IE1hcHBpbmcgdG8gQUMsIHVzaW5nIGluIE1nbnRRdWVyeV9TZXF1ZW5jZU51bWJlcigpIGFuZCBt
YXliZSBmb3IgRFNDUCAqLwogLy8jZGVmaW5lIFVQMkFDKHVwKQkoKHVwPDMpID8gKCh1cD09MCk/
MTowKSA6ICh1cD4+MSkpCiAjZGVmaW5lIFVQMkFDKHVwKSAoCQkgICBcCiAJKCh1cCkgPCAxKSA/
IFdNRV9BQ19CRSA6IFwKQEAgLTEyOTMsNyArMTI5Nyw3IEBAIGVudW0ge1dNTV9hbGxfZnJhbWUs
IFdNTV90d29fZnJhbWUsIFdNTV9mb3VyX2ZyYW1lLCBXTU1fc2l4X2ZyYW1lfTsKIAkoKHVwKSA8
IDQpID8gV01FX0FDX0JFIDogXAogCSgodXApIDwgNikgPyBXTUVfQUNfVkkgOiBcCiAJV01FX0FD
X1ZPKQotLy9BQyBNYXBwaW5nIHRvIFVQLCB1c2luZyBpbiBUeCBwYXJ0IGZvciBzZWxlY3Rpbmcg
dGhlIGNvcnJlc3BvbmRpbmcgVFggcXVldWUKKy8qIEFDIE1hcHBpbmcgdG8gVVAsIHVzaW5nIGlu
IFR4IHBhcnQgZm9yIHNlbGVjdGluZyB0aGUgY29ycmVzcG9uZGluZyBUWCBxdWV1ZSAqLwogI2Rl
ZmluZSBBQzJVUChfYWMpCSggICAgICAgXAogCSgoX2FjKSA9PSBXTUVfQUNfVk8pID8gNiA6IFwK
IAkoKF9hYykgPT0gV01FX0FDX1ZJKSA/IDUgOiBcCkBAIC0xMzI4LDcgKzEzMzIsNyBAQCBzdHJ1
Y3QgaWVlZTgwMjExX25ldHdvcmsgewogCXU4IGJzc2lkW0VUSF9BTEVOXTsgICAvKiB1MTYgYWxp
Z25lZCEgKi8KIAl1OCBjaGFubmVsOwoKLQkvLyBDQ1h2NCBTNTksIE1CU1NJRC4KKwkvKiBDQ1h2
NCBTNTksIE1CU1NJRC4gKi8KIAlib29sCWJNQnNzaWRWYWxpZDsKIAl1OAlNQnNzaWRbRVRIX0FM
RU5dOyAgICAvKiB1MTYgYWxpZ25lZCEgKi8KIAl1OAlNQnNzaWRNYXNrOwpAQCAtMTMzNywxMiAr
MTM0MSwxMiBAQCBzdHJ1Y3QgaWVlZTgwMjExX25ldHdvcmsgewogCXU4IHNzaWRfbGVuOwogCXN0
cnVjdCBpZWVlODAyMTFfcW9zX2RhdGEgcW9zX2RhdGE7CgotCS8vYWRkZWQgYnkgYW15IGZvciBM
RUFQCisJLyogYWRkZWQgYnkgYW15IGZvciBMRUFQICovCiAJYm9vbAliV2l0aEFpcm9uZXRJRTsK
IAlib29sCWJDa2lwU3VwcG9ydGVkOwogCWJvb2wJYkNjeFJtRW5hYmxlOwogCXUxNglDY3hSbVN0
YXRlWzJdOwotCS8vIENDWCAyIFMzOCwgV0xBTiBEZXZpY2UgVmVyc2lvbiBOdW1iZXIgZWxlbWVu
dC4gQW5uaWUsIDIwMDYtMDgtMjAuCisJLyogQ0NYIDIgUzM4LCBXTEFOIERldmljZSBWZXJzaW9u
IE51bWJlciBlbGVtZW50LiBBbm5pZSwgMjAwNi0wOC0yMC4gKi8KIAlib29sCWJXaXRoQ2N4VmVy
TnVtOwogCXU4CUJzc0NjeFZlck51bWJlcjsKIAkvKiBUaGVzZSBhcmUgbmV0d29yayBzdGF0aXN0
aWNzICovCkBAIC0xMzcxLDE4ICsxMzc1LDE4IEBAIHN0cnVjdCBpZWVlODAyMTFfbmV0d29yayB7
CiAJdTggIGR0aW1fZGF0YTsKIAl1MzIgbGFzdF9kdGltX3N0YV90aW1lWzJdOwoKLQkvL2FwcGVk
ZWQgZm9yIFFvUworCS8qIGFwcGVkZWQgZm9yIFFvUyAqLwogCXU4IHdtbV9pbmZvOwogCXN0cnVj
dCBpZWVlODAyMTFfd21tX2FjX3BhcmFtIHdtbV9wYXJhbVs0XTsKIAl1OCBRb1NfRW5hYmxlOwog
I2lmZGVmIFRIT01BU19UVVJCTwotCXU4IFR1cmJvX0VuYWJsZTsvL2VuYWJsZSB0dXJibyBtb2Rl
LCBhZGRlZCBieSB0aG9tYXMKKwl1OCBUdXJib19FbmFibGU7IC8qIGVuYWJsZSB0dXJibyBtb2Rl
LCBhZGRlZCBieSB0aG9tYXMgKi8KICNlbmRpZgogCXUxNiBDb3VudHJ5SWVMZW47CiAJdTggQ291
bnRyeUllQnVmW01BWF9JRV9MRU5dOwotCS8vIEhUIFJlbGF0ZWQsIGJ5IGFteSwgMjAwOC4wNC4y
OQorCS8qIEhUIFJlbGF0ZWQsIGJ5IGFteSwgMjAwOC4wNC4yOSAqLwogCUJTU19IVAlic3NodDsK
LQkvLyBBZGQgdG8gaGFuZGxlIGJyb2FkY29tIEFQIG1hbmFnZW1lbnQgZnJhbWUgQ0NLIHJhdGUu
CisJLyogQWRkIHRvIGhhbmRsZSBicm9hZGNvbSBBUCBtYW5hZ2VtZW50IGZyYW1lIENDSyByYXRl
LiAqLwogCWJvb2wgYnJvYWRjb21fY2FwX2V4aXN0OwogCWJvb2wgcmFsaW5rX2NhcF9leGlzdDsK
IAlib29sIGF0aGVyb3NfY2FwX2V4aXN0OwpAQCAtMTM5MSw3ICsxMzk1LDcgQEAgc3RydWN0IGll
ZWU4MDIxMV9uZXR3b3JrIHsKIC8vCXU4CWJlcnBfaW5mbzsKIAlib29sCWJlcnBfaW5mb192YWxp
ZDsKIAlib29sIGJ1c2Vwcm90ZWN0aW9uOwotCS8vcHV0IGF0IHRoZSBlbmQgb2YgdGhlIHN0cnVj
dHVyZS4KKwkvKiBwdXQgYXQgdGhlIGVuZCBvZiB0aGUgc3RydWN0dXJlLiAqLwogCXN0cnVjdCBs
aXN0X2hlYWQgbGlzdDsKIH07CgpAQCAtMTQ2Niw3ICsxNDcwLDcgQEAgc3RydWN0IGJhbmR3aWR0
aF9hdXRvc3dpdGNoIHsKIH07CgoKLS8vYWRkZWQgYnkgYW15IGZvciBvcmRlcgorLyogYWRkZWQg
YnkgYW15IGZvciBvcmRlciAqLwoKICNkZWZpbmUgUkVPUkRFUl9XSU5fU0laRQkxMjgKICNkZWZp
bmUgUkVPUkRFUl9FTlRSWV9OVU0JMTI4CkBAIC0xNDc1LDE4ICsxNDc5LDE4IEBAIHN0cnVjdCBy
eF9yZW9yZGVyX2VudHJ5IHsKIAl1MTYJCQlTZXFOdW07CiAJc3RydWN0IGllZWU4MDIxMV9yeGIg
KnByeGI7CiB9OwotLy9hZGRlZCBieSBhbXkgZm9yIG9yZGVyCisvKiBhZGRlZCBieSBhbXkgZm9y
IG9yZGVyICovCiB0eXBlZGVmIGVudW0gX0ZzeW5jX1N0YXRlIHsKIAlEZWZhdWx0X0ZzeW5jLAog
CUhXX0ZzeW5jLAogCVNXX0ZzeW5jCiB9IEZzeW5jX1N0YXRlOwoKLS8vIFBvd2VyIHNhdmUgbW9k
ZSBjb25maWd1cmVkLgorLyogUG93ZXIgc2F2ZSBtb2RlIGNvbmZpZ3VyZWQuICovCiB0eXBlZGVm
CWVudW0gX1JUX1BTX01PREUgewotCWVBY3RpdmUsCS8vIEFjdGl2ZS9Db250aW51b3VzIGFjY2Vz
cy4KLQllTWF4UHMsCQkvLyBNYXggcG93ZXIgc2F2ZSBtb2RlLgotCWVGYXN0UHMJCS8vIEZhc3Qg
cG93ZXIgc2F2ZSBtb2RlLgorCWVBY3RpdmUsCS8qIEFjdGl2ZS9Db250aW51b3VzIGFjY2Vzcy4g
Ki8KKwllTWF4UHMsCQkvKiBNYXggcG93ZXIgc2F2ZSBtb2RlLiAqLworCWVGYXN0UHMJCS8qIEZh
c3QgcG93ZXIgc2F2ZSBtb2RlLiAqLwogfSBSVF9QU19NT0RFOwoKIHR5cGVkZWYgZW51bSBfSVBT
X0NBTExCQUNLX0ZVTkNJT04gewpAQCAtMTUwNSw5ICsxNTA5LDkgQEAgdHlwZWRlZiBlbnVtIF9S
VF9KT0lOX0FDVElPTiB7CiBzdHJ1Y3QgaWJzc19wYXJtcyB7CiAJdTE2ICAgYXRpbVdpbjsKIH07
Ci0jZGVmaW5lIE1BWF9OVU1fUkFURVMJMjY0IC8vIE1heCBudW0gb2Ygc3VwcG9ydCByYXRlcyBl
bGVtZW50OiA4LCAgTWF4IG51bSBvZiBleHQuIHN1cHBvcnQgcmF0ZTogMjU1LiAwNjExMjIsIGJ5
IHJjbmprby4KKyNkZWZpbmUgTUFYX05VTV9SQVRFUwkyNjQgLyogTWF4IG51bSBvZiBzdXBwb3J0
IHJhdGVzIGVsZW1lbnQ6IDgsICBNYXggbnVtIG9mIGV4dC4gc3VwcG9ydCByYXRlOiAyNTUuIDA2
MTEyMiwgYnkgcmNuamtvLiAqLwoKLS8vIFJGIHN0YXRlLgorLyogUkYgc3RhdGUuICovCiB0eXBl
ZGVmCWVudW0gX1JUX1JGX1BPV0VSX1NUQVRFIHsKIAllUmZPbiwKIAllUmZTbGVlcCwKQEAgLTE1
MTYsOSArMTUyMCw5IEBAIHR5cGVkZWYJZW51bSBfUlRfUkZfUE9XRVJfU1RBVEUgewoKIHN0cnVj
dCBydF9wb3dlcl9zYXZlX2NvbnRyb2wgewoKLQkvLwotCS8vIEluYWN0aXZlIFBvd2VyIFNhdmUo
SVBTKSA6IERpc2FibGUgUkYgd2hlbiBkaXNjb25uZWN0ZWQKLQkvLworCS8qCisJICogSW5hY3Rp
dmUgUG93ZXIgU2F2ZShJUFMpIDogRGlzYWJsZSBSRiB3aGVuIGRpc2Nvbm5lY3RlZAorCSAqLwog
CWJvb2wJCQkJYkluYWN0aXZlUHM7CiAJYm9vbAkJCQliSVBTTW9kZUJhY2t1cDsKIAlib29sCQkJ
CWJTd1JmUHJvY2Vzc2luZzsKQEAgLTE1MjYsMTUgKzE1MzAsMTUgQEAgc3RydWN0IHJ0X3Bvd2Vy
X3NhdmVfY29udHJvbCB7CiAJc3RydWN0IHdvcmtfc3RydWN0CUluYWN0aXZlUHNXb3JrSXRlbTsK
IAlzdHJ1Y3QgdGltZXJfbGlzdAlJbmFjdGl2ZVBzVGltZXI7CgotCS8vIFJldHVybiBwb2ludCBm
b3Igam9pbiBhY3Rpb24KKwkvKiBSZXR1cm4gcG9pbnQgZm9yIGpvaW4gYWN0aW9uICovCiAJSVBT
X0NBTExCQUNLX0ZVTkNJT04JUmV0dXJuUG9pbnQ7CgotCS8vIFJlY29yZWQgUGFyYW1ldGVycyBm
b3IgcmVzY2hlZHVsZWQgSm9pblJlcXVlc3QKKwkvKiBSZWNvcmVkIFBhcmFtZXRlcnMgZm9yIHJl
c2NoZWR1bGVkIEpvaW5SZXF1ZXN0ICovCiAJYm9vbAkJCQliVG1wQnNzRGVzYzsKIAlSVF9KT0lO
X0FDVElPTgkJdG1wSm9pbkFjdGlvbjsKIAlzdHJ1Y3QgaWVlZTgwMjExX25ldHdvcmsgdG1wQnNz
RGVzYzsKCi0JLy8gUmVjb3JlZCBQYXJhbWV0ZXJzIGZvciByZXNjaGVkdWxlZCBNZ250TGlua1Jl
cXVlc3QKKwkvKiBSZWNvcmVkIFBhcmFtZXRlcnMgZm9yIHJlc2NoZWR1bGVkIE1nbnRMaW5rUmVx
dWVzdCAqLwogCWJvb2wJCQkJYlRtcFNjYW5Pbmx5OwogCWJvb2wJCQkJYlRtcEFjdGl2ZVNjYW47
CiAJYm9vbAkJCQliVG1wRmlsdGVySGlkZGVuQVA7CkBAIC0xNTUzLDkgKzE1NTcsOSBAQCBzdHJ1
Y3QgcnRfcG93ZXJfc2F2ZV9jb250cm9sIHsKIAlzdHJ1Y3QgaWJzc19wYXJtcwkJCXRtcElicG07
CiAJYm9vbAkJCQliVG1wSWJwbTsKCi0JLy8KLQkvLyBMZWlzcmUgUG9zd2VyIFNhdmUgOiBEaXNh
YmxlIFJGIGlmIGNvbm5lY3RlZCBidXQgdHJhZmZpYyBpcyBub3QgYnVzeQotCS8vCisJLyoKKwkg
KiBMZWlzcmUgUG9zd2VyIFNhdmUgOiBEaXNhYmxlIFJGIGlmIGNvbm5lY3RlZCBidXQgdHJhZmZp
YyBpcyBub3QgYnVzeQorCSAqLwogCWJvb2wJCQkJYkxlaXN1cmVQczsKCiB9OwpAQCAtMTU2NSw3
ICsxNTY5LDcgQEAgdHlwZWRlZiB1MzIgUlRfUkZfQ0hBTkdFX1NPVVJDRTsKICNkZWZpbmUgUkZf
Q0hBTkdFX0JZX0hXCQlCSVQoMzApCiAjZGVmaW5lIFJGX0NIQU5HRV9CWV9QUwkJQklUKDI5KQog
I2RlZmluZSBSRl9DSEFOR0VfQllfSVBTCUJJVCgyOCkKLSNkZWZpbmUgUkZfQ0hBTkdFX0JZX0lO
SVQJMAkvLyBEbyBub3QgY2hhbmdlIHRoZSBSRk9mZiByZWFzb24uIERlZmluZWQgYnkgQnJ1Y2Us
IDIwMDgtMDEtMTcuCisjZGVmaW5lIFJGX0NIQU5HRV9CWV9JTklUCTAJLyogRG8gbm90IGNoYW5n
ZSB0aGUgUkZPZmYgcmVhc29uLiBEZWZpbmVkIGJ5IEJydWNlLCAyMDA4LTAxLTE3LiAqLwoKIHR5
cGVkZWYgZW51bSB7CiAJQ09VTlRSWV9DT0RFX0ZDQyA9IDAsCkBAIC0xNTg3LDkgKzE1OTEsOSBA
QCBzdHJ1Y3QgcnRfbGlua19kZXRlY3QgewogCXUzMgkJCQlOdW1SZWN2QmNuSW5QZXJpb2Q7CiAJ
dTMyCQkJCU51bVJlY3ZEYXRhSW5QZXJpb2Q7CgotCXUzMgkJCQlSeEJjbk51bVtSVF9NQVhfTERf
U0xPVF9OVU1dOwkvLyBudW1iZXIgb2YgUnggYmVhY29uIC8gQ2hlY2tGb3JIYW5nX3BlcmlvZCAg
dG8gZGV0ZXJtaW5lIGxpbmsgc3RhdHVzCi0JdTMyCQkJCVJ4RGF0YU51bVtSVF9NQVhfTERfU0xP
VF9OVU1dOwkvLyBudW1iZXIgb2YgUnggZGF0YSAvIENoZWNrRm9ySGFuZ19wZXJpb2QgIHRvIGRl
dGVybWluZSBsaW5rIHN0YXR1cwotCXUxNgkJCQlTbG90TnVtOwkvLyBudW1iZXIgb2YgQ2hlY2tG
b3JIYW5nIHBlcmlvZCB0byBkZXRlcm1pbmUgbGluayBzdGF0dXMKKwl1MzIJCQkJUnhCY25OdW1b
UlRfTUFYX0xEX1NMT1RfTlVNXTsJLyogbnVtYmVyIG9mIFJ4IGJlYWNvbiAvIENoZWNrRm9ySGFu
Z19wZXJpb2QgIHRvIGRldGVybWluZSBsaW5rIHN0YXR1cyAqLworCXUzMgkJCQlSeERhdGFOdW1b
UlRfTUFYX0xEX1NMT1RfTlVNXTsJLyogbnVtYmVyIG9mIFJ4IGRhdGEgLyBDaGVja0Zvckhhbmdf
cGVyaW9kICB0byBkZXRlcm1pbmUgbGluayBzdGF0dXMgKi8KKwl1MTYJCQkJU2xvdE51bTsJLyog
bnVtYmVyIG9mIENoZWNrRm9ySGFuZyBwZXJpb2QgdG8gZGV0ZXJtaW5lIGxpbmsgc3RhdHVzICov
CiAJdTE2CQkJCVNsb3RJbmRleDsKCiAJdTMyCQkJCU51bVR4T2tJblBlcmlvZDsKQEAgLTE2MDIs
MzYgKzE2MDYsMzYgQEAgc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgewogCXN0cnVjdCBuZXRfZGV2
aWNlICpkZXY7CiAJc3RydWN0IGllZWU4MDIxMV9zZWN1cml0eSBzZWM7CgotCS8vaHcgc2VjdXJp
dHkgcmVsYXRlZAorCS8qIGh3IHNlY3VyaXR5IHJlbGF0ZWQgKi8KIC8vCXU4IGh3c2VjX3N1cHBv
cnQ7IC8vc3VwcG9ydD8KLQl1OCBod3NlY19hY3RpdmU7ICAvL2h3IHNlY3VyaXR5IGFjdGl2ZS4K
Kwl1OCBod3NlY19hY3RpdmU7ICAvKiBodyBzZWN1cml0eSBhY3RpdmUuICovCiAJYm9vbCBpc19z
aWxlbnRfcmVzZXQ7CiAJYm9vbCBpZWVlX3VwOwotCS8vYWRkZWQgYnkgYW15CisJLyogYWRkZWQg
YnkgYW15ICovCiAJYm9vbCBiU3VwcG9ydFJlbW90ZVdha2VVcDsKLQlSVF9QU19NT0RFCWRvdDEx
UG93ZXJTYXZlTW9kZTsgLy8gUG93ZXIgc2F2ZSBtb2RlIGNvbmZpZ3VyZWQuCisJUlRfUFNfTU9E
RQlkb3QxMVBvd2VyU2F2ZU1vZGU7IC8qIFBvd2VyIHNhdmUgbW9kZSBjb25maWd1cmVkLiAqLwog
CWJvb2wgYWN0c2Nhbm5pbmc7CiAJYm9vbCBiZWlucmV0cnk7CiAJUlRfUkZfUE9XRVJfU1RBVEUJ
CWVSRlBvd2VyU3RhdGU7CiAJUlRfUkZfQ0hBTkdFX1NPVVJDRQlSZk9mZlJlYXNvbjsKIAlib29s
IGlzX3NldF9rZXk7Ci0JLy8xMW4gc3BlYyByZWxhdGVkIEkgd29uZGVyIGlmIFRoZXNlIGluZm8g
c3RydWN0dXJlIG5lZWQgdG8gYmUgbW92ZWQgb3V0IG9mIGllZWU4MDIxMV9kZXZpY2UKKwkvKiAx
MW4gc3BlYyByZWxhdGVkIEkgd29uZGVyIGlmIFRoZXNlIGluZm8gc3RydWN0dXJlIG5lZWQgdG8g
YmUgbW92ZWQgb3V0IG9mIGllZWU4MDIxMV9kZXZpY2UgKi8KCi0JLy8xMW4gSFQgYmVsb3cKKwkv
KiAxMW4gSFQgYmVsb3cgKi8KIAlQUlRfSElHSF9USFJPVUdIUFVUCXBIVEluZm87CiAJLy9zdHJ1
Y3QgdGltZXJfbGlzdAkJU3dCd1RpbWVyOwogLy8Jc3BpbmxvY2tfdCBjaG5sb3Bfc3BpbmxvY2s7
CiAJc3BpbmxvY2tfdCBid19zcGlubG9jazsKCiAJc3BpbmxvY2tfdCByZW9yZGVyX3NwaW5sb2Nr
OwotCS8vIGZvciBIVCBvcGVyYXRpb24gcmF0ZSBzZXQuICB3ZSB1c2UgdGhpcyBvbmUgZm9yIEhU
IGRhdGEgcmF0ZSB0byBzZXBhcmF0ZSBkaWZmZXJlbnQgZGVzY3JpcHRvcnMKLQkvL3RoZSB3YXkg
ZmlsbCB0aGlzIGlzIHRoZSBzYW1lIGFzIGluIHRoZSBJRQotCXU4CVJlZ2RvdDExSFRPcGVyYXRp
b25hbFJhdGVTZXRbMTZdOwkJLy91c2UgUkFUUiBmb3JtYXQKLQl1OAlkb3QxMUhUT3BlcmF0aW9u
YWxSYXRlU2V0WzE2XTsJCS8vdXNlIFJBVFIgZm9ybWF0CisJLyogZm9yIEhUIG9wZXJhdGlvbiBy
YXRlIHNldC4gIHdlIHVzZSB0aGlzIG9uZSBmb3IgSFQgZGF0YSByYXRlIHRvIHNlcGFyYXRlIGRp
ZmZlcmVudCBkZXNjcmlwdG9ycyAqLworCS8qIHRoZSB3YXkgZmlsbCB0aGlzIGlzIHRoZSBzYW1l
IGFzIGluIHRoZSBJRSAqLworCXU4CVJlZ2RvdDExSFRPcGVyYXRpb25hbFJhdGVTZXRbMTZdOwkJ
LyogdXNlIFJBVFIgZm9ybWF0ICovCisJdTgJZG90MTFIVE9wZXJhdGlvbmFsUmF0ZVNldFsxNl07
CQkvKiB1c2UgUkFUUiBmb3JtYXQgKi8KIAl1OAlSZWdIVFN1cHBSYXRlU2V0WzE2XTsKIAl1OAkJ
CQlIVEN1cnJlbnRPcGVyYVJhdGU7CiAJdTgJCQkJSFRIaWdoZXN0T3BlcmFSYXRlOwotCS8vd2Ig
YWRkZWQgZm9yIHJhdGUgb3BlcmF0aW9uIG1vZGUgdG8gZmlybXdhcmUKKwkvKiB3YiBhZGRlZCBm
b3IgcmF0ZSBvcGVyYXRpb24gbW9kZSB0byBmaXJtd2FyZSAqLwogCXU4CWJUeERpc2FibGVSYXRl
RmFsbEJhY2s7CiAJdTgJYlR4VXNlRHJpdmVyQXNzaW5nZWRSYXRlOwogCWF0b21pY190CWF0bV9j
aG5sb3A7CkBAIC0xNjM5LDEyICsxNjQzLDEyIEBAIHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlIHsK
IC8vCXU4CUhUSGlnaGVzdE9wZXJhUmF0ZTsKIC8vCXU4CUhUQ3VycmVudE9wZXJhUmF0ZTsKCi0J
Ly8gODAyLjExZSBhbmQgV01NIFRyYWZmaWMgU3RyZWFtIEluZm8gKFRYKQorCS8qIDgwMi4xMWUg
YW5kIFdNTSBUcmFmZmljIFN0cmVhbSBJbmZvIChUWCkgKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkCQlU
eF9UU19BZG1pdF9MaXN0OwogCXN0cnVjdCBsaXN0X2hlYWQJCVR4X1RTX1BlbmRpbmdfTGlzdDsK
IAlzdHJ1Y3QgbGlzdF9oZWFkCQlUeF9UU19VbnVzZWRfTGlzdDsKIAlzdHJ1Y3QgdHhfdHNfcmVj
b3JkCQlUeFRzUmVjb3JkW1RPVEFMX1RTX05VTV07Ci0JLy8gODAyLjExZSBhbmQgV01NIFRyYWZm
aWMgU3RyZWFtIEluZm8gKFJYKQorCS8qIDgwMi4xMWUgYW5kIFdNTSBUcmFmZmljIFN0cmVhbSBJ
bmZvIChSWCkgKi8KIAlzdHJ1Y3QgbGlzdF9oZWFkCQlSeF9UU19BZG1pdF9MaXN0OwogCXN0cnVj
dCBsaXN0X2hlYWQJCVJ4X1RTX1BlbmRpbmdfTGlzdDsKIAlzdHJ1Y3QgbGlzdF9oZWFkCQlSeF9U
U19VbnVzZWRfTGlzdDsKQEAgLTE2NTMsOSArMTY1Nyw5IEBAIHN0cnVjdCBpZWVlODAyMTFfZGV2
aWNlIHsKIAlzdHJ1Y3QgcnhfcmVvcmRlcl9lbnRyeQlSeFJlb3JkZXJFbnRyeVsxMjhdOwogCXN0
cnVjdCBsaXN0X2hlYWQJCVJ4UmVvcmRlcl9VbnVzZWRfTGlzdDsKIC8vI2VuZGlmCi0JLy8gUW9z
IHJlbGF0ZWQuIEFkZGVkIGJ5IEFubmllLCAyMDA1LTExLTAxLgorCS8qIFFvcyByZWxhdGVkLiBB
ZGRlZCBieSBBbm5pZSwgMjAwNS0xMS0wMS4gKi8KIC8vCVBTVEFfUU9TCQkJcFN0YVFvczsKLQl1
OAkJCQlGb3JjZWRQcmlvcml0eTsJCS8vIEZvcmNlIHBlci1wYWNrZXQgcHJpb3JpdHkgMX43LiAo
ZGVmYXVsdDogMCwgbm90IHRvIGZvcmNlIGl0LikKKwl1OAkJCQlGb3JjZWRQcmlvcml0eTsJCS8q
IEZvcmNlIHBlci1wYWNrZXQgcHJpb3JpdHkgMX43LiAoZGVmYXVsdDogMCwgbm90IHRvIGZvcmNl
IGl0LikgKi8KCgogCS8qIEJvb2trZWVwaW5nIHN0cnVjdHVyZXMgKi8KQEAgLTE3MjUsNyArMTcy
OSw3IEBAIHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlIHsKIAkJCSAgICovCgogCS8qIEZyYWdtZW50
YXRpb24gc3RydWN0dXJlcyAqLwotCS8vIGVhY2ggc3RyZWFtaW5nIGNvbnRhaW4gYSBlbnRyeQor
CS8qIGVhY2ggc3RyZWFtaW5nIGNvbnRhaW4gYSBlbnRyeSAqLwogCXN0cnVjdCBpZWVlODAyMTFf
ZnJhZ19lbnRyeSBmcmFnX2NhY2hlWzE3XVtJRUVFODAyMTFfRlJBR19DQUNIRV9MRU5dOwogCXVu
c2lnbmVkIGludCBmcmFnX25leHRfaWR4WzE3XTsKIAl1MTYgZnRzOyAvKiBGcmFnbWVudGF0aW9u
IFRocmVzaG9sZCAqLwpAQCAtMTc2NywxMiArMTc3MSwxMiBAQCBzdHJ1Y3QgaWVlZTgwMjExX2Rl
dmljZSB7CiAJdTE2IHByZXZfc2VxX2N0bDsgICAgICAgLyogdXNlZCB0byBkcm9wIGR1cGxpY2F0
ZSBmcmFtZXMgKi8KCiAJLyogbWFwIG9mIGFsbG93ZWQgY2hhbm5lbHMuIDAgaXMgZHVtbXkgKi8K
LQkvLyBGSVhNRTogcmVtZW1iZXIgdG8gZGVmYXVsdCB0byBhIGJhc2ljIGNoYW5uZWwgcGxhbiBk
ZXBlbmRpbmcgb2YgdGhlIFBIWSB0eXBlCisJLyogRklYTUU6IHJlbWVtYmVyIHRvIGRlZmF1bHQg
dG8gYSBiYXNpYyBjaGFubmVsIHBsYW4gZGVwZW5kaW5nIG9mIHRoZSBQSFkgdHlwZSAqLwogCXZv
aWQgKmRvdDExZF9pbmZvOwogCWJvb2wgYkdsb2JhbERvbWFpbjsKIAlpbnQgcmF0ZTsgICAgICAg
LyogY3VycmVudCByYXRlICovCiAJaW50IGJhc2ljX3JhdGU7Ci0JLy9GSVhNRTogcGxlYWNlIGNh
bGxiYWNrLCBzZWUgaWYgcmVkdW5kYW50IHdpdGggc29mdG1hY19mZWF0dXJlcworCS8qIEZJWE1F
OiBwbGVhY2UgY2FsbGJhY2ssIHNlZSBpZiByZWR1bmRhbnQgd2l0aCBzb2Z0bWFjX2ZlYXR1cmVz
ICovCiAJc2hvcnQgYWN0aXZlX3NjYW47CgogCS8qIHRoaXMgY29udGFpbnMgZmxhZ3MgZm9yIHNl
bGVjdGl2ZWx5IGVuYWJsZSBzb2Z0bWFjIHN1cHBvcnQgKi8KQEAgLTE4MTMsOCArMTgxNyw4IEBA
IHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlIHsKIAlzaG9ydCB3YXBfc2V0OwogCXNob3J0IHNzaWRf
c2V0OwoKLQl1OCAgd3BheF90eXBlX3NldDsgICAgLy97YWRkZWQgYnkgRGF2aWQsIDIwMDYuOS4y
OH0KLQl1MzIgd3BheF90eXBlX25vdGlmeTsgLy97YWRkZWQgYnkgRGF2aWQsIDIwMDYuOS4yNn0K
Kwl1OCAgd3BheF90eXBlX3NldDsgICAgLyoge2FkZGVkIGJ5IERhdmlkLCAyMDA2LjkuMjh9ICov
CisJdTMyIHdwYXhfdHlwZV9ub3RpZnk7IC8qIHthZGRlZCBieSBEYXZpZCwgMjAwNi45LjI2fSAq
LwoKIAkvKiBRb1MgcmVsYXRlZCBmbGFnICovCiAJczggIGluaXRfd21tcGFyYW1fZmxhZzsKQEAg
LTE4MzYsNyArMTg0MCw3IEBAIHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlIHsKIAlzdHJ1Y3Qgc2tf
YnVmZiAqbWdtdF9xdWV1ZV9yaW5nW01HTVRfUVVFVUVfTlVNXTsKIAlpbnQgbWdtdF9xdWV1ZV9o
ZWFkOwogCWludCBtZ210X3F1ZXVlX3RhaWw7Ci0vL3sgYWRkZWQgZm9yIHJ0bDgxOXgKKy8qIHsg
YWRkZWQgZm9yIHJ0bDgxOXggKi8KICNkZWZpbmUgSUVFRTgwMjExX1FVRVVFX0xJTUlUIDEyOAog
CXU4IEFzb2NSZXRyeUNvdW50OwogCXVuc2lnbmVkIGludCBod19oZWFkZXI7CkBAIC0xODQ1LDEy
ICsxODQ5LDEyIEBAIHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlIHsKIAlzdHJ1Y3Qgc2tfYnVmZl9o
ZWFkICBza2JfZHJ2X2FnZ1FbTUFYX1FVRVVFX1NJWkVdOwogCXUzMglzdGFfZWRjYV9wYXJhbVs0
XTsKIAlib29sIGFnZ3JlZ2F0aW9uOwotCS8vIEVuYWJsZS9EaXNhYmxlIFJ4IGltbWVkaWF0ZSBC
QSBjYXBhYmlsaXR5LgorCS8qIEVuYWJsZS9EaXNhYmxlIFJ4IGltbWVkaWF0ZSBCQSBjYXBhYmls
aXR5LiAqLwogCWJvb2wgZW5hYmxlX3J4X2ltbV9CQTsKIAlib29sIGJpYnNzY29vcmRpbmF0b3I7
CgotCS8vK2J5IGFteSBmb3IgRE0gLDA4MDUxNQotCS8vRHluYW1pYyBUeCBwb3dlciBmb3IgbmVh
ci9mYXIgcmFuZ2UgZW5hYmxlL0Rpc2FibGUgICwgYnkgYW15ICwgMjAwOC0wNS0xNQorCS8qICti
eSBhbXkgZm9yIERNICwwODA1MTUgKi8KKwkvKiBEeW5hbWljIFR4IHBvd2VyIGZvciBuZWFyL2Zh
ciByYW5nZSBlbmFibGUvRGlzYWJsZSAgLCBieSBhbXkgLCAyMDA4LTA1LTE1ICovCiAJYm9vbAli
ZHluYW1pY190eHBvd2VyX2VuYWJsZTsKCiAJYm9vbCBiQ1RTVG9TZWxmRW5hYmxlOwpAQCAtMTg2
MSwyMSArMTg2NSwyMSBAQCBzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSB7CiAJdTgJZnN5bmNfcnNz
aV90aHJlc2hvbGQ7CiAJYm9vbAliZnN5bmNfZW5hYmxlOwoKLQl1OAlmc3luY19tdWx0aXBsZV90
aW1laW50ZXJ2YWw7CQkvLyBGc3luY011bHRpcGxlVGltZUludGVydmFsICogRnN5bmNUaW1lSW50
ZXJ2YWwKLQl1MzIJZnN5bmNfZmlyc3RkaWZmX3JhdGV0aHJlc2hvbGQ7CQkvLyBsb3cgdGhyZXNo
b2xkCi0JdTMyCWZzeW5jX3NlY29uZGRpZmZfcmF0ZXRocmVzaG9sZDsJIC8vIGRlY3JlYXNlIHRo
cmVzaG9sZAorCXU4CWZzeW5jX211bHRpcGxlX3RpbWVpbnRlcnZhbDsJCS8qIEZzeW5jTXVsdGlw
bGVUaW1lSW50ZXJ2YWwgKiBGc3luY1RpbWVJbnRlcnZhbCAqLworCXUzMglmc3luY19maXJzdGRp
ZmZfcmF0ZXRocmVzaG9sZDsJCS8qIGxvdyB0aHJlc2hvbGQgKi8KKwl1MzIJZnN5bmNfc2Vjb25k
ZGlmZl9yYXRldGhyZXNob2xkOwkgLyogZGVjcmVhc2UgdGhyZXNob2xkICovCiAJRnN5bmNfU3Rh
dGUJCQlmc3luY19zdGF0ZTsKIAlib29sCQliaXNfYW55X25vbmJlcGt0czsKLQkvLzIwTWh6IDQw
TWh6IEF1dG9Td2l0Y2ggVGhyZXNob2xkCisJLyogMjBNaHogNDBNaHogQXV0b1N3aXRjaCBUaHJl
c2hvbGQgKi8KIAlzdHJ1Y3QgYmFuZHdpZHRoX2F1dG9zd2l0Y2ggYmFuZHdpZHRoX2F1dG9fc3dp
dGNoOwotCS8vZm9yIHR4cG93ZXIgdHJhY2tpbmcKKwkvKiBmb3IgdHhwb3dlciB0cmFja2luZyAq
LwogCWJvb2wgRndSV1JGOwoKLQkvL2FkZGVkIGJ5IGFteSBmb3IgQVAgcm9hbWluZworCS8qIGFk
ZGVkIGJ5IGFteSBmb3IgQVAgcm9hbWluZyAqLwogCXN0cnVjdCBydF9saW5rX2RldGVjdCBMaW5r
RGV0ZWN0SW5mbzsKLQkvL2FkZGVkIGJ5IGFteSBmb3IgcHMKKwkvKiBhZGRlZCBieSBhbXkgZm9y
IHBzICovCiAJc3RydWN0IHJ0X3Bvd2VyX3NhdmVfY29udHJvbCBQb3dlclNhdmVDb250cm9sOwot
Ly99CisvKiB9ICovCiAJLyogdXNlZCBpZiBJRUVFX1NPRlRNQUNfVFhfUVVFVUUgaXMgc2V0ICov
CiAJc3RydWN0ICB0eF9wZW5kaW5nIHR4X3BlbmRpbmc7CgpAQCAtMTg5MSwxMSArMTg5NSwxMSBA
QCBzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSB7CiAJIHN0cnVjdCBkZWxheWVkX3dvcmsgc3RhcnRf
aWJzc193cTsKIAlzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd3hfc3luY19zY2FuX3dxOwogCXN0cnVjdCB3
b3JrcXVldWVfc3RydWN0ICp3cTsKLQkvLyBRb3MgcmVsYXRlZC4gQWRkZWQgYnkgQW5uaWUsIDIw
MDUtMTEtMDEuCi0JLy9TVEFfUU9TICBTdGFRb3M7CisJLyogUW9zIHJlbGF0ZWQuIEFkZGVkIGJ5
IEFubmllLCAyMDA1LTExLTAxLiAqLworCS8qIFNUQV9RT1MgIFN0YVFvczsgKi8KCi0JLy91MzIg
U1RBX0VEQ0FfUEFSQU1bNF07Ci0JLy9DSEFOTkVMX0FDQ0VTU19TRVRUSU5HIENoYW5uZWxBY2Nl
c3NTZXR0aW5nOworCS8qIHUzMiBTVEFfRURDQV9QQVJBTVs0XTsgKi8KKwkvKiBDSEFOTkVMX0FD
Q0VTU19TRVRUSU5HIENoYW5uZWxBY2Nlc3NTZXR0aW5nOyAqLwoKIAlzdHJ1Y3QgaWVlZTgwMjEx
X3J4YiAqc3RhdHNfSW5kaWNhdGVBcnJheVtSRU9SREVSX1dJTl9TSVpFXTsKCkBAIC0xOTk3LDcg
KzIwMDEsNyBAQCBzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSB7CgogCS8qIGNoZWNrIHdoZXRoZXIg
VHggaHcgcmVzb3VyY2UgYXZhaWxhYmxlICovCiAJc2hvcnQgKCpjaGVja19uaWNfZW5vdWdoX2Rl
c2MpKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIGludCBxdWV1ZV9pbmRleCk7Ci0JLy9hZGRlZCBi
eSB3YiBmb3IgSFQgcmVsYXRlZAorCS8qIGFkZGVkIGJ5IHdiIGZvciBIVCByZWxhdGVkICovCiAv
Lwl2b2lkICgqU3dDaG5sQnlUaW1lckhhbmRsZXIpKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIGlu
dCBjaGFubmVsKTsKIAl2b2lkICgqU2V0QldNb2RlSGFuZGxlcikoc3RydWN0IG5ldF9kZXZpY2Ug
KmRldiwgZW51bSBodF9jaGFubmVsX3dpZHRoIEJhbmR3aWR0aCwgZW51bSBodF9leHRlbnNpb25f
Y2hhbl9vZmZzZXQgT2Zmc2V0KTsKIC8vCXZvaWQgKCpVcGRhdGVIYWxSQVRSVGFibGVIYW5kbGVy
KShzdHJ1Y3QgbmV0X2RldmljZSogZGV2LCB1OCogcE1jc1JhdGUpOwpAQCAtMjM0OSw4ICsyMzUz
LDggQEAgaW50IGllZWU4MDIxMV93eF9zZXRfcnRzKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICpp
ZWVlLAogaW50IGllZWU4MDIxMV93eF9nZXRfcnRzKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICpp
ZWVlLAogCQkJIHN0cnVjdCBpd19yZXF1ZXN0X2luZm8gKmluZm8sCiAJCQkgdW5pb24gaXdyZXFf
ZGF0YSAqd3JxdSwgY2hhciAqZXh0cmEpOwotLy9IVAotI2RlZmluZSBNQVhfUkVDRUlWRV9CVUZG
RVJfU0laRSA5MTAwICAvLworLyogSFQgKi8KKyNkZWZpbmUgTUFYX1JFQ0VJVkVfQlVGRkVSX1NJ
WkUgOTEwMAogdm9pZCBIVERlYnVnSFRDYXBhYmlsaXR5KHU4ICpDYXBJRSwgdTggKlRpdGxlU3Ry
aW5nKTsKIHZvaWQgSFREZWJ1Z0hUSW5mbyh1OCAqSW5mb0lFLCB1OCAqVGl0bGVTdHJpbmcpOwoK
QEAgLTIzNzgsNyArMjM4Miw3IEBAIHU4IEhUQ0NoZWNrKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNl
ICppZWVlLCB1OCAqcEZyYW1lKTsKIHZvaWQgSFRSZXNldElPVFNldHRpbmcoUFJUX0hJR0hfVEhS
T1VHSFBVVCBwSFRJbmZvKTsKIGJvb2wgSXNIVEhhbGZObW9kZUFQcyhzdHJ1Y3QgaWVlZTgwMjEx
X2RldmljZSAqaWVlZSk7CiB1MTYgVHhDb3VudFRvRGF0YVJhdGUoc3RydWN0IGllZWU4MDIxMV9k
ZXZpY2UgKmllZWUsIHU4IG5EYXRhUmF0ZSk7Ci0vL2Z1bmN0aW9uIGluIEJBUFJPQy5jCisvKiBm
dW5jdGlvbiBpbiBCQVBST0MuYyAqLwogaW50IGllZWU4MDIxMV9yeF9BRERCQVJlcShzdHJ1Y3Qg
aWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0IHNrX2J1ZmYgKnNrYik7CiBpbnQgaWVlZTgw
MjExX3J4X0FEREJBUnNwKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1Y3Qgc2tf
YnVmZiAqc2tiKTsKIGludCBpZWVlODAyMTFfcnhfREVMQkEoc3RydWN0IGllZWU4MDIxMV9kZXZp
Y2UgKmllZWUsIHN0cnVjdCBza19idWZmICpza2IpOwpAQCAtMjM5MCwxMyArMjM5NCwxMyBAQCB2
b2lkIEJhU2V0dXBUaW1lT3V0KHN0cnVjdCB0aW1lcl9saXN0ICp0KTsKIHZvaWQgVHhCYUluYWN0
VGltZW91dChzdHJ1Y3QgdGltZXJfbGlzdCAqdCk7CiB2b2lkIFJ4QmFJbmFjdFRpbWVvdXQoc3Ry
dWN0IHRpbWVyX2xpc3QgKnQpOwogdm9pZCBSZXNldEJhRW50cnkoc3RydWN0IGJhX3JlY29yZCAq
cEJBKTsKLS8vZnVuY3Rpb24gaW4gVFMuYworLyogZnVuY3Rpb24gaW4gVFMuYyAqLwogYm9vbCBH
ZXRUcygKIAlzdHJ1Y3QgaWVlZTgwMjExX2RldmljZQkJKmllZWUsCiAJc3RydWN0IHRzX2NvbW1v
bl9pbmZvICAgICAgICAgICAqKnBwVFMsCiAJdTggICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAqQWRkciwKIAl1OCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRJRCwKLQllbnVtIHRy
X3NlbGVjdCAgICAgICAgICAgICAgICAgIFR4UnhTZWxlY3QsICAvL1J4OjEsIFR4OjAKKwllbnVt
IHRyX3NlbGVjdCAgICAgICAgICAgICAgICAgIFR4UnhTZWxlY3QsICAvKiBSeDoxLCBUeDowICov
CiAJYm9vbCAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQWRkTmV3VHMKIAkpOwogdm9pZCBU
U0luaXRpYWxpemUoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpOwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHQuYyBiL2Ry
aXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX2NyeXB0LmMKaW5kZXgg
MzY5ODdmY2NhYzVkLi5hNDdiYTM2MDdiNzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9y
dGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX2NyeXB0LmMKKysrIGIvZHJpdmVycy9zdGFnaW5n
L3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHQuYwpAQCAtODEsNyArODEsOCBAQCB2
b2lkIGllZWU4MDIxMV9jcnlwdF9kZWxheWVkX2RlaW5pdChzdHJ1Y3QgaWVlZTgwMjExX2Rldmlj
ZSAqaWVlZSwKIAl0bXAgPSAqY3J5cHQ7CiAJKmNyeXB0ID0gTlVMTDsKCi0JLyogbXVzdCBub3Qg
cnVuIG9wcy0+ZGVpbml0KCkgd2hpbGUgdGhlcmUgbWF5IGJlIHBlbmRpbmcgZW5jcnlwdCBvcgor
CS8qCisJICogbXVzdCBub3QgcnVuIG9wcy0+ZGVpbml0KCkgd2hpbGUgdGhlcmUgbWF5IGJlIHBl
bmRpbmcgZW5jcnlwdCBvcgogCSAqIGRlY3J5cHQgb3BlcmF0aW9ucy4gVXNlIGEgbGlzdCBvZiBk
ZWxheWVkIGRlaW5pdHMgdG8gYXZvaWQgbmVlZGluZwogCSAqIGxvY2tpbmcuCiAJICovCmRpZmYg
LS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlw
dC5oIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHQu
aAppbmRleCBkM2JkNTU5OGIyNWIuLjRmYmM1MjQxZjdiNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9z
dGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHQuaAorKysgYi9kcml2ZXJz
L3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdC5oCkBAIC0yNCw3ICsy
NCw4IEBACiBzdHJ1Y3QgaWVlZTgwMjExX2NyeXB0b19vcHMgewogCWNvbnN0IGNoYXIgKm5hbWU7
CgotCS8qIGluaXQgbmV3IGNyeXB0byBjb250ZXh0IChlLmcuLCBhbGxvY2F0ZSBwcml2YXRlIGRh
dGEgc3BhY2UsCisJLyoKKwkgKiBpbml0IG5ldyBjcnlwdG8gY29udGV4dCAoZS5nLiwgYWxsb2Nh
dGUgcHJpdmF0ZSBkYXRhIHNwYWNlLAogCSAqIHNlbGVjdCBJViwgZXRjLik7IHJldHVybnMgTlVM
TCBvbiBmYWlsdXJlIG9yIHBvaW50ZXIgdG8gYWxsb2NhdGVkCiAJICogcHJpdmF0ZSBkYXRhIG9u
IHN1Y2Nlc3MKIAkgKi8KQEAgLTMzLDcgKzM0LDggQEAgc3RydWN0IGllZWU4MDIxMV9jcnlwdG9f
b3BzIHsKIAkvKiBkZWluaXRpYWxpemUgY3J5cHRvIGNvbnRleHQgYW5kIGZyZWUgYWxsb2NhdGVk
IHByaXZhdGUgZGF0YSAqLwogCXZvaWQgKCpkZWluaXQpKHZvaWQgKnByaXYpOwoKLQkvKiBlbmNy
eXB0L2RlY3J5cHQgcmV0dXJuIDwgMCBvbiBlcnJvciBvciA+PSAwIG9uIHN1Y2Nlc3MuIFRoZSBy
ZXR1cm4KKwkvKgorCSAqIGVuY3J5cHQvZGVjcnlwdCByZXR1cm4gPCAwIG9uIGVycm9yIG9yID49
IDAgb24gc3VjY2Vzcy4gVGhlIHJldHVybgogCSAqIHZhbHVlIGZyb20gZGVjcnlwdF9tcGR1IGlz
IHBhc3NlZCBhcyB0aGUga2V5aWR4IHZhbHVlIGZvcgogCSAqIGRlY3J5cHRfbXNkdS4gc2tiIG11
c3QgaGF2ZSBlbm91Z2ggaGVhZCBhbmQgdGFpbCByb29tIGZvciB0aGUKIAkgKiBlbmNyeXB0aW9u
OyBpZiBub3QsIGVycm9yIHdpbGwgYmUgcmV0dXJuZWQ7IHRoZXNlIGZ1bmN0aW9ucyBhcmUKQEAg
LTQyLDcgKzQ0LDggQEAgc3RydWN0IGllZWU4MDIxMV9jcnlwdG9fb3BzIHsKIAlpbnQgKCplbmNy
eXB0X21wZHUpKHN0cnVjdCBza19idWZmICpza2IsIGludCBoZHJfbGVuLCB2b2lkICpwcml2KTsK
IAlpbnQgKCpkZWNyeXB0X21wZHUpKHN0cnVjdCBza19idWZmICpza2IsIGludCBoZHJfbGVuLCB2
b2lkICpwcml2KTsKCi0JLyogVGhlc2UgZnVuY3Rpb25zIGFyZSBjYWxsZWQgZm9yIGZ1bGwgTVNE
VXMsIGkuZS4gZnVsbCBmcmFtZXMuCisJLyoKKwkgKiBUaGVzZSBmdW5jdGlvbnMgYXJlIGNhbGxl
ZCBmb3IgZnVsbCBNU0RVcywgaS5lLiBmdWxsIGZyYW1lcy4KIAkgKiBUaGVzZSBjYW4gYmUgTlVM
TCBpZiBmdWxsIE1TRFUgb3BlcmF0aW9ucyBhcmUgbm90IG5lZWRlZC4KIAkgKi8KIAlpbnQgKCpl
bmNyeXB0X21zZHUpKHN0cnVjdCBza19idWZmICpza2IsIGludCBoZHJfbGVuLCB2b2lkICpwcml2
KTsKQEAgLTUyLDEyICs1NSwxNCBAQCBzdHJ1Y3QgaWVlZTgwMjExX2NyeXB0b19vcHMgewogCWlu
dCAoKnNldF9rZXkpKHZvaWQgKmtleSwgaW50IGxlbiwgdTggKnNlcSwgdm9pZCAqcHJpdik7CiAJ
aW50ICgqZ2V0X2tleSkodm9pZCAqa2V5LCBpbnQgbGVuLCB1OCAqc2VxLCB2b2lkICpwcml2KTsK
Ci0JLyogcHJvY2ZzIGhhbmRsZXIgZm9yIHByaW50aW5nIG91dCBrZXkgaW5mb3JtYXRpb24gYW5k
IHBvc3NpYmxlCisJLyoKKwkgKiBwcm9jZnMgaGFuZGxlciBmb3IgcHJpbnRpbmcgb3V0IGtleSBp
bmZvcm1hdGlvbiBhbmQgcG9zc2libGUKIAkgKiBzdGF0aXN0aWNzCiAJICovCiAJY2hhciAqICgq
cHJpbnRfc3RhdHMpKGNoYXIgKnAsIHZvaWQgKnByaXYpOwoKLQkvKiBtYXhpbXVtIG51bWJlciBv
ZiBieXRlcyBhZGRlZCBieSBlbmNyeXB0aW9uOyBlbmNyeXB0IGJ1ZiBpcworCS8qCisJICogbWF4
aW11bSBudW1iZXIgb2YgYnl0ZXMgYWRkZWQgYnkgZW5jcnlwdGlvbjsgZW5jcnlwdCBidWYgaXMK
IAkgKiBhbGxvY2F0ZWQgd2l0aCBleHRyYV9wcmVmaXhfbGVuIGJ5dGVzLCBjb3B5IG9mIGluX2J1
ZiwgYW5kCiAJICogZXh0cmFfcG9zdGZpeF9sZW47IGVuY3J5cHQgbmVlZCBub3QgdXNlIGFsbCB0
aGlzIHNwYWNlLCBidXQKIAkgKiB0aGUgcmVzdWx0IG11c3Qgc3RhcnQgYXQgdGhlIGJlZ2lubmlu
ZyBvZiB0aGUgYnVmZmVyIGFuZCBjb3JyZWN0CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcv
cnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdF9jY21wLmMgYi9kcml2ZXJzL3N0YWdp
bmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdF9jY21wLmMKaW5kZXggZDcxODhi
M2YzMTkwLi5hZDBiOTE4ZWNmMGQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTky
dS9pZWVlODAyMTEvaWVlZTgwMjExX2NyeXB0X2NjbXAuYworKysgYi9kcml2ZXJzL3N0YWdpbmcv
cnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdF9jY21wLmMKQEAgLTEzMyw3ICsxMzMs
OCBAQCBzdGF0aWMgdm9pZCBjY21wX2luaXRfYmxvY2tzKHN0cnVjdCBjcnlwdG9fdGZtICp0Zm0s
CiAJCXFjID0gKnBvcyAmIDB4MGY7CiAJCWFhZF9sZW4gKz0gMjsKIAl9Ci0JLyogQ0NNIEluaXRp
YWwgQmxvY2s6CisJLyoKKwkgKiBDQ00gSW5pdGlhbCBCbG9jazoKIAkgKiBGbGFnIChJbmNsdWRl
IGF1dGhlbnRpY2F0aW9uIGhlYWRlciwgTT0zICg4LW9jdGV0IE1JQyksCiAJICogICAgICAgTD0x
ICgyLW9jdGV0IERsZW4pKQogCSAqIE5vbmNlOiAweDAwIHwgQTIgfCBQTgpAQCAtMTQ2LDcgKzE0
Nyw4IEBAIHN0YXRpYyB2b2lkIGNjbXBfaW5pdF9ibG9ja3Moc3RydWN0IGNyeXB0b190Zm0gKnRm
bSwKIAliMFsxNF0gPSAoZGxlbiA+PiA4KSAmIDB4ZmY7CiAJYjBbMTVdID0gZGxlbiAmIDB4ZmY7
CgotCS8qIEFBRDoKKwkvKgorCSAqIEFBRDoKIAkgKiBGQyB3aXRoIGJpdHMgNC4uNiBhbmQgMTEu
LjEzIG1hc2tlZCB0byB6ZXJvOyAxNCBpcyBhbHdheXMgb25lCiAJICogQTEgfCBBMiB8IEEzCiAJ
ICogU0Mgd2l0aCBiaXRzIDQuLjE1IChzZXEjKSBtYXNrZWQgdG8gemVybwpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHRfdGtpcC5j
IGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHRfdGtp
cC5jCmluZGV4IDA5MjdiMmIxNTE1MS4uZGI0YjY0MGQxZDhjIDEwMDY0NAotLS0gYS9kcml2ZXJz
L3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdF90a2lwLmMKKysrIGIv
ZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfY3J5cHRfdGtpcC5j
CkBAIC01NjcsMTEgKzU2NywxMSBAQCBzdGF0aWMgaW50IGllZWU4MDIxMV9taWNoYWVsX21pY19h
ZGQoc3RydWN0IHNrX2J1ZmYgKnNrYiwgaW50IGhkcl9sZW4sIHZvaWQgKnByaQoKIAltaWNoYWVs
X21pY19oZHIoc2tiLCB0a2V5LT50eF9oZHIpOwoKLQkvLyB7IGRhdmlkLCAyMDA2LjkuMQotCS8v
IGZpeCB0aGUgd3BhIHByb2Nlc3Mgd2l0aCB3bW0gZW5hYmxlZC4KKwkvKiB7IGRhdmlkLCAyMDA2
LjkuMSAqLworCS8qIGZpeCB0aGUgd3BhIHByb2Nlc3Mgd2l0aCB3bW0gZW5hYmxlZC4gKi8KIAlp
ZiAoSUVFRTgwMjExX1FPU19IQVNfU0VRKGxlMTZfdG9fY3B1KGhkci0+ZnJhbWVfY3RsKSkpCiAJ
CXRrZXktPnR4X2hkclsxMl0gPSAqKHNrYi0+ZGF0YSArIGhkcl9sZW4gLSAyKSAmIDB4MDc7Ci0J
Ly8gfQorCS8qIH0gKi8KIAlwb3MgPSBza2JfcHV0KHNrYiwgOCk7CgogCWlmIChtaWNoYWVsX21p
Yyh0a2V5LT50eF90Zm1fbWljaGFlbCwgJnRrZXktPmtleVsxNl0sIHRrZXktPnR4X2hkciwKQEAg
LTYxNSwxMSArNjE1LDExIEBAIHN0YXRpYyBpbnQgaWVlZTgwMjExX21pY2hhZWxfbWljX3Zlcmlm
eShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBpbnQga2V5aWR4LAogCQlyZXR1cm4gLTE7CgogCW1pY2hh
ZWxfbWljX2hkcihza2IsIHRrZXktPnJ4X2hkcik7Ci0JLy8geyBkYXZpZCwgMjAwNi45LjEKLQkv
LyBmaXggdGhlIHdwYSBwcm9jZXNzIHdpdGggd21tIGVuYWJsZWQuCisJLyogeyBkYXZpZCwgMjAw
Ni45LjEgKi8KKwkvKiBmaXggdGhlIHdwYSBwcm9jZXNzIHdpdGggd21tIGVuYWJsZWQuICovCiAJ
aWYgKElFRUU4MDIxMV9RT1NfSEFTX1NFUShsZTE2X3RvX2NwdShoZHItPmZyYW1lX2N0bCkpKQog
CQl0a2V5LT5yeF9oZHJbMTJdID0gKihza2ItPmRhdGEgKyBoZHJfbGVuIC0gMikgJiAweDA3Owot
CS8vIH0KKwkvKiB9ICovCgogCWlmIChtaWNoYWVsX21pYyh0a2V5LT5yeF90Zm1fbWljaGFlbCwg
JnRrZXktPmtleVsyNF0sIHRrZXktPnJ4X2hkciwKIAkJCXNrYi0+ZGF0YSArIGhkcl9sZW4sIHNr
Yi0+bGVuIC0gOCAtIGhkcl9sZW4sIG1pYykpCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcv
cnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdF93ZXAuYyBiL2RyaXZlcnMvc3RhZ2lu
Zy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX2NyeXB0X3dlcC5jCmluZGV4IDgwNTQ5M2Ew
ODcwZC4uOWNiMzg2NDM2Mzc3IDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUv
aWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdF93ZXAuYworKysgYi9kcml2ZXJzL3N0YWdpbmcvcnRs
ODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9jcnlwdF93ZXAuYwpAQCAtNzIsNyArNzIsOCBAQCBz
dGF0aWMgdm9pZCBwcmlzbTJfd2VwX2RlaW5pdCh2b2lkICpwcml2KQogCWtmcmVlKHByaXYpOwog
fQoKLS8qIFBlcmZvcm0gV0VQIGVuY3J5cHRpb24gb24gZ2l2ZW4gc2tiIHRoYXQgaGFzIGF0IGxl
YXN0IDQgYnl0ZXMgb2YgaGVhZHJvb20KKy8qCisgKiBQZXJmb3JtIFdFUCBlbmNyeXB0aW9uIG9u
IGdpdmVuIHNrYiB0aGF0IGhhcyBhdCBsZWFzdCA0IGJ5dGVzIG9mIGhlYWRyb29tCiAgKiBmb3Ig
SVYgYW5kIDQgYnl0ZXMgb2YgdGFpbHJvb20gZm9yIElDVi4gQm90aCBJViBhbmQgSUNWIHdpbGwg
YmUgdHJhbnNtaXR0ZWQsCiAgKiBzbyB0aGUgcGF5bG9hZCBsZW5ndGggaW5jcmVhc2VzIHdpdGgg
OCBieXRlcy4KICAqCkBAIC0xMDMsNyArMTA0LDggQEAgc3RhdGljIGludCBwcmlzbTJfd2VwX2Vu
Y3J5cHQoc3RydWN0IHNrX2J1ZmYgKnNrYiwgaW50IGhkcl9sZW4sIHZvaWQgKnByaXYpCgogCXdl
cC0+aXYrKzsKCi0JLyogRmx1aHJlciwgTWFudGluLCBhbmQgU2hhbWlyIGhhdmUgcmVwb3J0ZWQg
d2Vha25lc3NlcyBpbiB0aGUga2V5CisJLyoKKwkgKiBGbHVocmVyLCBNYW50aW4sIGFuZCBTaGFt
aXIgaGF2ZSByZXBvcnRlZCB3ZWFrbmVzc2VzIGluIHRoZSBrZXkKIAkgKiBzY2hlZHVsaW5nIGFs
Z29yaXRobSBvZiBSQzQuIEF0IGxlYXN0IElWcyAoS2V5Qnl0ZSArIDMsIDB4ZmYsIE4pCiAJICog
Y2FuIGJlIHVzZWQgdG8gc3BlZWR1cCBhdHRhY2tzLCBzbyBhdm9pZCB1c2luZyB0aGVtLgogCSAq
LwpAQCAtMTUwLDcgKzE1Miw4IEBAIHN0YXRpYyBpbnQgcHJpc20yX3dlcF9lbmNyeXB0KHN0cnVj
dCBza19idWZmICpza2IsIGludCBoZHJfbGVuLCB2b2lkICpwcml2KQogfQoKCi0vKiBQZXJmb3Jt
IFdFUCBkZWNyeXB0aW9uIG9uIGdpdmVuIGJ1ZmZlci4gQnVmZmVyIGluY2x1ZGVzIHdob2xlIFdF
UCBwYXJ0IG9mCisvKgorICogUGVyZm9ybSBXRVAgZGVjcnlwdGlvbiBvbiBnaXZlbiBidWZmZXIu
IEJ1ZmZlciBpbmNsdWRlcyB3aG9sZSBXRVAgcGFydCBvZgogICogdGhlIGZyYW1lOiBJViAoNCBi
eXRlcyksIGVuY3J5cHRlZCBwYXlsb2FkIChpbmNsdWRpbmcgU05BUCBoZWFkZXIpLAogICogSUNW
ICg0IGJ5dGVzKS4gbGVuIGluY2x1ZGVzIGJvdGggSVYgYW5kIElDVi4KICAqCmRpZmYgLS1naXQg
YS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9tb2R1bGUuYyBi
L2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX21vZHVsZS5jCmlu
ZGV4IGQ3OTc1YWEzMzViMi4uZGQ3ZmY3ZTg0YmQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdp
bmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9tb2R1bGUuYworKysgYi9kcml2ZXJzL3N0
YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9tb2R1bGUuYwpAQCAtMTU4LDcgKzE1
OCw4IEBAIHN0cnVjdCBuZXRfZGV2aWNlICphbGxvY19pZWVlODAyMTEoaW50IHNpemVvZl9wcml2
KQogCWlmIChpZWVlLT5wSFRJbmZvID09IE5VTEwpIHsKIAkJSUVFRTgwMjExX0RFQlVHKElFRUU4
MDIxMV9ETF9FUlIsICJjYW4ndCBhbGxvYyBtZW1vcnkgZm9yIEhUSW5mb1xuIik7CgotCQkvKiBC
eSB0aGlzIHBvaW50IGluIGNvZGUgaWVlZTgwMjExX25ldHdvcmtzX2FsbG9jYXRlKCkgaGFzIGJl
ZW4KKwkJLyoKKwkJICogQnkgdGhpcyBwb2ludCBpbiBjb2RlIGllZWU4MDIxMV9uZXR3b3Jrc19h
bGxvY2F0ZSgpIGhhcyBiZWVuCiAJCSAqIHN1Y2Nlc3NmdWxseSBjYWxsZWQgc28gdGhlIG1lbW9y
eSBhbGxvY2F0ZWQgc2hvdWxkIGJlIGZyZWVkCiAJCSAqLwogCQlpZWVlODAyMTFfbmV0d29ya3Nf
ZnJlZShpZWVlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAy
MTEvaWVlZTgwMjExX3J4LmMgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2ll
ZWU4MDIxMV9yeC5jCmluZGV4IDBlNzYyZTU1OTY3NS4uZWViZDhkZWIwMDg3IDEwMDY0NAotLS0g
YS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9yeC5jCisrKyBi
L2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX3J4LmMKQEAgLTE0
Myw4ICsxNDMsMTAgQEAgaWVlZTgwMjExX2ZyYWdfY2FjaGVfZ2V0KHN0cnVjdCBpZWVlODAyMTFf
ZGV2aWNlICppZWVlLAogCQltZW1jcHkoZW50cnktPnNyY19hZGRyLCBoZHItPmFkZHIyLCBFVEhf
QUxFTik7CiAJCW1lbWNweShlbnRyeS0+ZHN0X2FkZHIsIGhkci0+YWRkcjEsIEVUSF9BTEVOKTsK
IAl9IGVsc2UgewotCQkvKiByZWNlaXZlZCBhIGZyYWdtZW50IG9mIGEgZnJhbWUgZm9yIHdoaWNo
IHRoZSBoZWFkIGZyYWdtZW50Ci0JCSAqIHNob3VsZCBoYXZlIGFscmVhZHkgYmVlbiByZWNlaXZl
ZCAqLworCQkvKgorCQkgKiByZWNlaXZlZCBhIGZyYWdtZW50IG9mIGEgZnJhbWUgZm9yIHdoaWNo
IHRoZSBoZWFkIGZyYWdtZW50CisJCSAqIHNob3VsZCBoYXZlIGFscmVhZHkgYmVlbiByZWNlaXZl
ZAorCQkgKi8KIAkJZW50cnkgPSBpZWVlODAyMTFfZnJhZ19jYWNoZV9maW5kKGllZWUsIHNlcSwg
ZnJhZywgdGlkLGhkci0+YWRkcjIsCiAJCQkJCQkgIGhkci0+YWRkcjEpOwogCQlpZiAoZW50cnkp
IHsKQEAgLTE5OSwxNyArMjAxLDIwIEBAIHN0YXRpYyBpbnQgaWVlZTgwMjExX2ZyYWdfY2FjaGVf
aW52YWxpZGF0ZShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwKCgoKLS8qIGllZWU4MDIx
MV9yeF9mcmFtZV9tZ3RtdAorLyoKKyAqIGllZWU4MDIxMV9yeF9mcmFtZV9tZ3RtdAogICoKICAq
IFJlc3BvbnNpYmxlIGZvciBoYW5kbGluZyBtYW5hZ2VtZW50IGNvbnRyb2wgZnJhbWVzCiAgKgot
ICogQ2FsbGVkIGJ5IGllZWU4MDIxMV9yeCAqLworICogQ2FsbGVkIGJ5IGllZWU4MDIxMV9yeAor
ICovCiBzdGF0aWMgaW5saW5lIGludAogaWVlZTgwMjExX3J4X2ZyYW1lX21nbXQoc3RydWN0IGll
ZWU4MDIxMV9kZXZpY2UgKmllZWUsIHN0cnVjdCBza19idWZmICpza2IsCiAJCQlzdHJ1Y3QgaWVl
ZTgwMjExX3J4X3N0YXRzICpyeF9zdGF0cywgdTE2IHR5cGUsCiAJCQl1MTYgc3R5cGUpCiB7Ci0J
LyogT24gdGhlIHN0cnVjdCBzdGF0cyBkZWZpbml0aW9uIHRoZXJlIGlzIHdyaXR0ZW4gdGhhdAor
CS8qCisJICogT24gdGhlIHN0cnVjdCBzdGF0cyBkZWZpbml0aW9uIHRoZXJlIGlzIHdyaXR0ZW4g
dGhhdAogCSAqIHRoaXMgaXMgbm90IG1hbmRhdG9yeS4uLi4gYnV0IHNlZW1zIHRoYXQgdGhlIHBy
b2JlCiAJICogcmVzcG9uc2UgcGFyc2VyIHVzZXMgaXQKIAkgKi8KQEAgLTI0NCwxNSArMjQ5LDE5
IEBAIGllZWU4MDIxMV9yeF9mcmFtZV9tZ210KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVl
LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQlpZiAoc3R5cGUgPT0gV0xBTl9GQ19TVFlQRV9CRUFD
T04gJiYKIAkJICAgIGllZWUtPml3X21vZGUgPT0gSVdfTU9ERV9NQVNURVIpIHsKIAkJCXN0cnVj
dCBza19idWZmICpza2IyOwotCQkJLyogUHJvY2VzcyBiZWFjb24gZnJhbWVzIGFsc28gaW4ga2Vy
bmVsIGRyaXZlciB0bwotCQkJICogdXBkYXRlIFNUQShBUCkgdGFibGUgc3RhdGlzdGljcyAqLwor
CQkJLyoKKwkJCSAqIFByb2Nlc3MgYmVhY29uIGZyYW1lcyBhbHNvIGluIGtlcm5lbCBkcml2ZXIg
dG8KKwkJCSAqIHVwZGF0ZSBTVEEoQVApIHRhYmxlIHN0YXRpc3RpY3MKKwkJCSAqLwogCQkJc2ti
MiA9IHNrYl9jbG9uZShza2IsIEdGUF9BVE9NSUMpOwogCQkJaWYgKHNrYjIpCiAJCQkJaG9zdGFw
X3J4KHNrYjItPmRldiwgc2tiMiwgcnhfc3RhdHMpOwogCQl9CgotCQkvKiBzZW5kIG1hbmFnZW1l
bnQgZnJhbWVzIHRvIHRoZSB1c2VyIHNwYWNlIGRhZW1vbiBmb3IKLQkJICogcHJvY2Vzc2luZyAq
LworCQkvKgorCQkgKiBzZW5kIG1hbmFnZW1lbnQgZnJhbWVzIHRvIHRoZSB1c2VyIHNwYWNlIGRh
ZW1vbiBmb3IKKwkJICogcHJvY2Vzc2luZworCQkgKi8KIAkJaWVlZS0+YXBkZXZzdGF0cy5yeF9w
YWNrZXRzKys7CiAJCWllZWUtPmFwZGV2c3RhdHMucnhfYnl0ZXMgKz0gc2tiLT5sZW47CiAJCXBy
aXNtMl9yeF84MDIxMShpZWVlLT5hcGRldiwgc2tiLCByeF9zdGF0cywgUFJJU00yX1JYX01HTVQp
OwpAQCAtNDI1LDE4ICs0MzQsMTggQEAgc3RhdGljIGludCBpc19kdXBsaWNhdGVfcGFja2V0KHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAogCXU4IHRpZDsKCgotCS8vVE8yRFMgYW5kIFFv
UworCS8qIFRPMkRTIGFuZCBRb1MgKi8KIAlpZigoKGZjICYgSUVFRTgwMjExX0ZDVExfRFNUT0RT
KSA9PSBJRUVFODAyMTFfRkNUTF9EU1RPRFMpJiZJRUVFODAyMTFfUU9TX0hBU19TRVEoZmMpKSB7
CiAJICBoZHJfNGFkZHJxb3MgPSAoc3RydWN0IHJ0bF84MDIxMV9oZHJfNGFkZHJxb3MgKiloZWFk
ZXI7CiAJICB0aWQgPSBsZTE2X3RvX2NwdShoZHJfNGFkZHJxb3MtPnFvc19jdGwpICYgSUVFRTgw
MjExX1FDVExfVElEOwogCSAgdGlkID0gVVAyQUModGlkKTsKIAkgIHRpZCsrOwotCX0gZWxzZSBp
ZihJRUVFODAyMTFfUU9TX0hBU19TRVEoZmMpKSB7IC8vUW9TCisJfSBlbHNlIGlmIChJRUVFODAy
MTFfUU9TX0hBU19TRVEoZmMpKSB7IC8qIFFvUyAqLwogCSAgaGRyXzNhZGRycW9zID0gKHN0cnVj
dCBydGxfODAyMTFfaGRyXzNhZGRycW9zICopaGVhZGVyOwogCSAgdGlkID0gbGUxNl90b19jcHUo
aGRyXzNhZGRycW9zLT5xb3NfY3RsKSAmIElFRUU4MDIxMV9RQ1RMX1RJRDsKIAkgIHRpZCA9IFVQ
MkFDKHRpZCk7CiAJICB0aWQrKzsKLQl9IGVsc2UgeyAvLyBubyBRb1MKKwl9IGVsc2UgeyAvKiBu
byBRb1MgKi8KIAkgIHRpZCA9IDA7CiAJfQoKQEAgLTUzMiw3ICs1NDEsNyBAQCB2b2lkIGllZWU4
MDIxMV9pbmRpY2F0ZV9wYWNrZXRzKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1
Y3QgaWVlZTgwMjExXwogLy8JCUlFRUU4MDIxMV9ERUJVRyhJRUVFODAyMTFfRExfUkVPUkRFUiwi
JXMoKTogaGFoYWhhaGhoaCwgV2UgaW5kaWNhdGUgcGFja2V0IGZyb20gcmVvcmRlciBsaXN0LCBp
bmRleCBpcyAldVxuIixfX2Z1bmNfXyxpbmRleCk7CiAJZm9yKGogPSAwOyBqPGluZGV4OyBqKysp
CiAJewotLy9hZGRlZCBieSBhbXkgZm9yIHJlb3JkZXIKKy8qIGFkZGVkIGJ5IGFteSBmb3IgcmVv
cmRlciAqLwogCQlzdHJ1Y3QgaWVlZTgwMjExX3J4YiAqcHJ4YiA9IHByeGJJbmRpY2F0ZUFycmF5
W2pdOwogCQlmb3IoaSA9IDA7IGk8cHJ4Yi0+bnJfc3ViZnJhbWVzOyBpKyspIHsKIAkJCXN0cnVj
dCBza19idWZmICpzdWJfc2tiID0gcHJ4Yi0+c3ViZnJhbWVzW2ldOwpAQCAtNTQzLDggKzU1Miwx
MCBAQCB2b2lkIGllZWU4MDIxMV9pbmRpY2F0ZV9wYWNrZXRzKHN0cnVjdCBpZWVlODAyMTFfZGV2
aWNlICppZWVlLCBzdHJ1Y3QgaWVlZTgwMjExXwogCQkJCSgobWVtY21wKHN1Yl9za2ItPmRhdGEs
IHJmYzEwNDJfaGVhZGVyLCBTTkFQX1NJWkUpID09IDAgJiYKIAkJCQkgIGV0aGVydHlwZSAhPSBF
VEhfUF9BQVJQICYmIGV0aGVydHlwZSAhPSBFVEhfUF9JUFgpIHx8CiAJCQkJIG1lbWNtcChzdWJf
c2tiLT5kYXRhLCBicmlkZ2VfdHVubmVsX2hlYWRlciwgU05BUF9TSVpFKSA9PSAwKSkgewotCQkJ
LyogcmVtb3ZlIFJGQzEwNDIgb3IgQnJpZGdlLVR1bm5lbCBlbmNhcHN1bGF0aW9uIGFuZAotCQkJ
ICogcmVwbGFjZSBFdGhlclR5cGUgKi8KKwkJCS8qCisJCQkgKiByZW1vdmUgUkZDMTA0MiBvciBC
cmlkZ2UtVHVubmVsIGVuY2Fwc3VsYXRpb24gYW5kCisJCQkgKiByZXBsYWNlIEV0aGVyVHlwZQor
CQkJICovCiAJCQkJc2tiX3B1bGwoc3ViX3NrYiwgU05BUF9TSVpFKTsKIAkJCQltZW1jcHkoc2ti
X3B1c2goc3ViX3NrYiwgRVRIX0FMRU4pLCBwcnhiLT5zcmMsIEVUSF9BTEVOKTsKIAkJCQltZW1j
cHkoc2tiX3B1c2goc3ViX3NrYiwgRVRIX0FMRU4pLCBwcnhiLT5kc3QsIEVUSF9BTEVOKTsKQEAg
LTYzNyw3ICs2NDgsOCBAQCBzdGF0aWMgdm9pZCBSeFJlb3JkZXJJbmRpY2F0ZVBhY2tldChzdHJ1
Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwKIAkgKiBBZnRlciBQYWNrZXQgZHJvcHBpbmcgYW5k
IFNsaWRpbmcgV2luZG93IHNoaWZ0aW5nIGFzIGFib3ZlLCB3ZSBjYW4gbm93IGp1c3QgaW5kaWNh
dGUgdGhlIHBhY2tldHMKIAkgKiB3aXRoIHRoZSBTZXFOdW0gc21hbGxlciB0aGFuIGxhdGVzdCBX
aW5TdGFydCBhbmQgYnVmZmVyIG90aGVyIHBhY2tldHMuCiAJICovCi0JLyogRm9yIFJ4IFJlb3Jk
ZXIgY29uZGl0aW9uOgorCS8qCisJICogRm9yIFJ4IFJlb3JkZXIgY29uZGl0aW9uOgogCSAqIDEu
IEFsbCBwYWNrZXRzIHdpdGggU2VxTnVtIHNtYWxsZXIgdGhhbiBXaW5TdGFydCA9PiBJbmRpY2F0
ZQogCSAqIDIuIEFsbCBwYWNrZXRzIHdpdGggU2VxTnVtIGxhcmdlciB0aGFuIG9yIGVxdWFsIHRv
IFdpblN0YXJ0ID0+IEJ1ZmZlciBpdC4KIAkgKi8KQEAgLTY1MCw3ICs2NjIsNyBAQCBzdGF0aWMg
dm9pZCBSeFJlb3JkZXJJbmRpY2F0ZVBhY2tldChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVl
ZSwKIAkJaW5kZXggPSAxOwogCX0gZWxzZSB7CiAJCS8qIEN1cnJlbnQgcGFja2V0IGlzIGdvaW5n
IHRvIGJlIGluc2VydGVkIGludG8gcGVuZGluZyBsaXN0LiovCi0JCS8vSUVFRTgwMjExX0RFQlVH
KElFRUU4MDIxMV9ETF9SRU9SREVSLCIlcygpOiBXZSBSWCBubyBvcmRlcmVkIHBhY2tlZCwgaW5z
ZXJ0IHRvIG9yZGVyZWQgbGlzdFxuIixfX2Z1bmNfXyk7CisJCS8qIElFRUU4MDIxMV9ERUJVRyhJ
RUVFODAyMTFfRExfUkVPUkRFUiwiJXMoKTogV2UgUlggbm8gb3JkZXJlZCBwYWNrZWQsIGluc2Vy
dCB0byBvcmRlcmVkIGxpc3RcbiIsX19mdW5jX18pOyAqLwogCQlpZighbGlzdF9lbXB0eSgmaWVl
ZS0+UnhSZW9yZGVyX1VudXNlZF9MaXN0KSkgewogCQkJcFJlb3JkZXJFbnRyeSA9IGxpc3RfZW50
cnkoaWVlZS0+UnhSZW9yZGVyX1VudXNlZF9MaXN0Lm5leHQsIHN0cnVjdCByeF9yZW9yZGVyX2Vu
dHJ5LCBMaXN0KTsKIAkJCWxpc3RfZGVsX2luaXQoJnBSZW9yZGVyRW50cnktPkxpc3QpOwpAQCAt
NzI4LDExICs3NDAsMTEgQEAgc3RhdGljIHZvaWQgUnhSZW9yZGVySW5kaWNhdGVQYWNrZXQoc3Ry
dWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCgogCS8qIEhhbmRsaW5nIHBlbmRpbmcgdGltZXIu
IFNldCB0aGlzIHRpbWVyIHRvIHByZXZlbnQgZnJvbSBsb25nIHRpbWUgUnggYnVmZmVyaW5nLiov
CiAJaWYgKGluZGV4PjApIHsKLQkJLy8gQ2FuY2VsIHByZXZpb3VzIHBlbmRpbmcgdGltZXIuCisJ
CS8qIENhbmNlbCBwcmV2aW91cyBwZW5kaW5nIHRpbWVyLiAqLwogCS8vCWRlbF90aW1lcl9zeW5j
KCZwVFMtPnJ4X3BrdF9wZW5kaW5nX3RpbWVyKTsKIAkJcFRTLT5yeF90aW1lb3V0X2luZGljYXRl
X3NlcSA9IDB4ZmZmZjsKCi0JCS8vIEluZGljYXRlIHBhY2tldHMKKwkJLyogSW5kaWNhdGUgcGFj
a2V0cyAqLwogCQlpZihpbmRleD5SRU9SREVSX1dJTl9TSVpFKXsKIAkJCUlFRUU4MDIxMV9ERUJV
RyhJRUVFODAyMTFfRExfRVJSLCAiUnhSZW9yZGVySW5kaWNhdGVQYWNrZXQoKTogUnggUmVvcmRl
ciBidWZmZXIgZnVsbCEhIFxuIik7CiAJCQlrZnJlZShwcnhiSW5kaWNhdGVBcnJheSk7CkBAIC03
NDIsNyArNzU0LDcgQEAgc3RhdGljIHZvaWQgUnhSZW9yZGVySW5kaWNhdGVQYWNrZXQoc3RydWN0
IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCiAJfQoKIAlpZiAoYlBrdEluQnVmICYmIHBUUy0+cnhf
dGltZW91dF9pbmRpY2F0ZV9zZXEgPT0gMHhmZmZmKSB7Ci0JCS8vIFNldCBuZXcgcGVuZGluZyB0
aW1lci4KKwkJLyogU2V0IG5ldyBwZW5kaW5nIHRpbWVyLiAqLwogCQlJRUVFODAyMTFfREVCVUco
SUVFRTgwMjExX0RMX1JFT1JERVIsIiVzKCk6IFNFVCByeCB0aW1lb3V0IHRpbWVyXG4iLCBfX2Z1
bmNfXyk7CiAJCXBUUy0+cnhfdGltZW91dF9pbmRpY2F0ZV9zZXEgPSBwVFMtPnJ4X2luZGljYXRl
X3NlcTsKIAkJaWYodGltZXJfcGVuZGluZygmcFRTLT5yeF9wa3RfcGVuZGluZ190aW1lcikpCkBA
IC03ODUsNyArNzk3LDcgQEAgc3RhdGljIHU4IHBhcnNlX3N1YmZyYW1lKHN0cnVjdCBza19idWZm
ICpza2IsCiAJaWYgKHJ4X3N0YXRzLT5iQ29udGFpbkhUQykgewogCQlMTENPZmZzZXQgKz0gSFRD
TE5HOwogCX0KLQkvLyBOdWxsIHBhY2tldCwgZG9uJ3QgaW5kaWNhdGUgaXQgdG8gdXBwZXIgbGF5
ZXIKKwkvKiBOdWxsIHBhY2tldCwgZG9uJ3QgaW5kaWNhdGUgaXQgdG8gdXBwZXIgbGF5ZXIgKi8K
IAlDaGtMZW5ndGggPSBMTENPZmZzZXQ7LyogKyAoRnJhbWVfV0VQKGZyYW1lKSE9MCA/QWRhcHRl
ci0+TWdudEluZm8uU2VjdXJpdHlJbmZvLkVuY3J5cHRpb25IZWFkT3ZlcmhlYWQ6MCk7Ki8KCiAJ
aWYgKHNrYi0+bGVuIDw9IENoa0xlbmd0aCkKQEAgLTgxMiw3ICs4MjQsNyBAQCBzdGF0aWMgdTgg
cGFyc2Vfc3ViZnJhbWUoc3RydWN0IHNrX2J1ZmYgKnNrYiwKIAkJd2hpbGUoc2tiLT5sZW4gPiBF
VEhFUk5FVF9IRUFERVJfU0laRSkgewogCQkJLyogT2Zmc2V0IDEyIGRlbm90ZSAyIG1hYyBhZGRy
ZXNzICovCiAJCQluU3ViZnJhbWVfTGVuZ3RoID0gKigodTE2ICopKHNrYi0+ZGF0YSArIDEyKSk7
Ci0JCQkvLz09bT09PmNoYW5nZSB0aGUgbGVuZ3RoIG9yZGVyCisJCQkvKiA9PW09PT5jaGFuZ2Ug
dGhlIGxlbmd0aCBvcmRlciAqLwogCQkJblN1YmZyYW1lX0xlbmd0aCA9IChuU3ViZnJhbWVfTGVu
Z3RoPj44KSArIChuU3ViZnJhbWVfTGVuZ3RoPDw4KTsKCiAJCQlpZiAoc2tiLT5sZW48KEVUSEVS
TkVUX0hFQURFUl9TSVpFICsgblN1YmZyYW1lX0xlbmd0aCkpIHsKQEAgLTg2OSw5ICs4ODEsMTEg
QEAgc3RhdGljIHU4IHBhcnNlX3N1YmZyYW1lKHN0cnVjdCBza19idWZmICpza2IsCiAJfQogfQoK
LS8qIEFsbCByZWNlaXZlZCBmcmFtZXMgYXJlIHNlbnQgdG8gdGhpcyBmdW5jdGlvbi4gQHNrYiBj
b250YWlucyB0aGUgZnJhbWUgaW4KKy8qCisgKiBBbGwgcmVjZWl2ZWQgZnJhbWVzIGFyZSBzZW50
IHRvIHRoaXMgZnVuY3Rpb24uIEBza2IgY29udGFpbnMgdGhlIGZyYW1lIGluCiAgKiBJRUVFIDgw
Mi4xMSBmb3JtYXQsIGkuZS4sIGluIHRoZSBmb3JtYXQgaXQgd2FzIHNlbnQgb3ZlciBhaXIuCi0g
KiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBvbmx5IGFzIGEgdGFza2xldCAoc29mdHdhcmUgSVJR
KS4gKi8KKyAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIG9ubHkgYXMgYSB0YXNrbGV0IChzb2Z0
d2FyZSBJUlEpLgorICovCiBpbnQgaWVlZTgwMjExX3J4KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNl
ICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQkgc3RydWN0IGllZWU4MDIxMV9yeF9zdGF0
cyAqcnhfc3RhdHMpCiB7CkBAIC04ODQsMTIgKzg5OCwxMiBAQCBpbnQgaWVlZTgwMjExX3J4KHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCXN0cnVj
dCBuZXRfZGV2aWNlX3N0YXRzICpzdGF0czsKIAl1bnNpZ25lZCBpbnQgZnJhZzsKIAl1MTYgZXRo
ZXJ0eXBlOwotCS8vYWRkZWQgYnkgYW15IGZvciByZW9yZGVyCisJLyogYWRkZWQgYnkgYW15IGZv
ciByZW9yZGVyICovCiAJdTgJVElEID0gMDsKIAl1MTYJU2VxTnVtID0gMDsKIAlzdHJ1Y3Qgcnhf
dHNfcmVjb3JkICpwVFMgPSBOVUxMOwogCS8vYm9vbCBiSXNBZ2dyZWdhdGVGcmFtZSA9IGZhbHNl
OwotCS8vYWRkZWQgYnkgYW15IGZvciByZW9yZGVyCisJLyogYWRkZWQgYnkgYW15IGZvciByZW9y
ZGVyICovCiAjaWZkZWYgTk9UX1lFVAogCXN0cnVjdCBuZXRfZGV2aWNlICp3ZHMgPSBOVUxMOwog
CXN0cnVjdCBuZXRfZGV2aWNlICp3ZHMgPSBOVUxMOwpAQCAtOTA1LDcgKzkxOSw3IEBAIGludCBp
ZWVlODAyMTFfcngoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHN0cnVjdCBza19idWZm
ICpza2IsCgogCWludCBpOwogCXN0cnVjdCBpZWVlODAyMTFfcnhiICpyeGIgPSBOVUxMOwotCS8v
IGNoZWF0IHRoZSBoZHIgdHlwZQorCS8qIGNoZWF0IHRoZSBoZHIgdHlwZSAqLwogCWhkciA9IChz
dHJ1Y3QgcnRsXzgwMjExX2hkcl80YWRkciAqKXNrYi0+ZGF0YTsKIAlzdGF0cyA9ICZpZWVlLT5z
dGF0czsKCkBAIC05MzMsOCArOTQ3LDEwIEBAIGludCBpZWVlODAyMTFfcngoc3RydWN0IGllZWU4
MDIxMV9kZXZpY2UgKmllZWUsIHN0cnVjdCBza19idWZmICpza2IsCgogCS8vSUVFRTgwMjExX0RF
QlVHX0RBVEEoSUVFRTgwMjExX0RMX0RBVEEsIHNrYi0+ZGF0YSwgc2tiLT5sZW4pOwogI2lmZGVm
IE5PVF9ZRVQKLQkvKiBQdXQgdGhpcyBjb2RlIGhlcmUgc28gdGhhdCB3ZSBhdm9pZCBkdXBsaWNh
dGluZyBpdCBpbiBhbGwKLQkgKiBSeCBwYXRocy4gLSBKZWFuIElJICovCisJLyoKKwkgKiBQdXQg
dGhpcyBjb2RlIGhlcmUgc28gdGhhdCB3ZSBhdm9pZCBkdXBsaWNhdGluZyBpdCBpbiBhbGwKKwkg
KiBSeCBwYXRocy4gLSBKZWFuIElJCisJICovCiAjaWZkZWYgSVdfV0lSRUxFU1NfU1BZCQkvKiBk
ZWZpbmVkIGluIGl3X2hhbmRsZXIuaCAqLwogCS8qIElmIHNweSBtb25pdG9yaW5nIG9uICovCiAJ
aWYgKGlmYWNlLT5zcHlfZGF0YS5zcHlfbnVtYmVyID4gMCkgewpAQCAtOTY0LDI4ICs5ODAsMzQg
QEAgaW50IGllZWU4MDIxMV9yeChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0
IHNrX2J1ZmYgKnNrYiwKICNpZmRlZiBOT1RfWUVUCiAJCXN0YSA9IE5VTEw7CgotCQkvKiBVc2Ug
c3RhdGlvbiBzcGVjaWZpYyBrZXkgdG8gb3ZlcnJpZGUgZGVmYXVsdCBrZXlzIGlmIHRoZQorCQkv
KgorCQkgKiBVc2Ugc3RhdGlvbiBzcGVjaWZpYyBrZXkgdG8gb3ZlcnJpZGUgZGVmYXVsdCBrZXlz
IGlmIHRoZQogCQkgKiByZWNlaXZlciBhZGRyZXNzIGlzIGEgdW5pY2FzdCBhZGRyZXNzICgiaW5k
aXZpZHVhbCBSQSIpLiBJZgogCQkgKiBiY3J4X3N0YV9rZXkgcGFyYW1ldGVyIGlzIHNldCwgc3Rh
dGlvbiBzcGVjaWZpYyBrZXkgaXMgdXNlZAogCQkgKiBldmVuIHdpdGggYnJvYWQvbXVsdGljYXN0
IHRhcmdldHMgKHRoaXMgaXMgYWdhaW5zdCBJRUVFCiAJCSAqIDgwMi4xMSwgYnV0IG1ha2VzIGl0
IGVhc2llciB0byB1c2UgZGlmZmVyZW50IGtleXMgd2l0aAotCQkgKiBzdGF0aW9ucyB0aGF0IGRv
IG5vdCBzdXBwb3J0IFdFUCBrZXkgbWFwcGluZykuICovCisJCSAqIHN0YXRpb25zIHRoYXQgZG8g
bm90IHN1cHBvcnQgV0VQIGtleSBtYXBwaW5nKS4KKwkJICovCgogCQlpZiAoIShoZHItPmFkZHIx
WzBdICYgMHgwMSkgfHwgbG9jYWwtPmJjcnhfc3RhX2tleSkKIAkJCSh2b2lkKSBob3N0YXBfaGFu
ZGxlX3N0YV9jcnlwdG8obG9jYWwsIGhkciwgJmNyeXB0LAogCQkJCQkJCSZzdGEpOwogI2VuZGlm
CgotCQkvKiBhbGxvdyBOVUxMIGRlY3J5cHQgdG8gaW5kaWNhdGUgYW4gc3RhdGlvbiBzcGVjaWZp
YyBvdmVycmlkZQotCQkgKiBmb3IgZGVmYXVsdCBlbmNyeXB0aW9uICovCisJCS8qCisJCSAqIGFs
bG93IE5VTEwgZGVjcnlwdCB0byBpbmRpY2F0ZSBhbiBzdGF0aW9uIHNwZWNpZmljIG92ZXJyaWRl
CisJCSAqIGZvciBkZWZhdWx0IGVuY3J5cHRpb24KKwkJICovCiAJCWlmIChjcnlwdCAmJiAoIWNy
eXB0LT5vcHMgfHwgIWNyeXB0LT5vcHMtPmRlY3J5cHRfbXBkdSkpCiAJCQljcnlwdCA9IE5VTEw7
CgogCQlpZiAoIWNyeXB0ICYmIChmYyAmIElFRUU4MDIxMV9GQ1RMX1dFUCkpIHsKLQkJCS8qIFRo
aXMgc2VlbXMgdG8gYmUgdHJpZ2dlcmVkIGJ5IHNvbWUgKG11bHRpY2FzdD8pCisJCQkvKgorCQkJ
ICogVGhpcyBzZWVtcyB0byBiZSB0cmlnZ2VyZWQgYnkgc29tZSAobXVsdGljYXN0PykKIAkJCSAq
IGZyYW1lcyBmcm9tIG90aGVyIHRoYW4gY3VycmVudCBCU1MsIHNvIGp1c3QgZHJvcCB0aGUKIAkJ
CSAqIGZyYW1lcyBzaWxlbnRseSBpbnN0ZWFkIG9mIGZpbGxpbmcgc3lzdGVtIGxvZyB3aXRoCi0J
CQkgKiB0aGVzZSByZXBvcnRzLiAqLworCQkJICogdGhlc2UgcmVwb3J0cy4KKwkJCSAqLwogCQkJ
SUVFRTgwMjExX0RFQlVHX0RST1AoIkRlY3J5cHRpb24gZmFpbGVkIChub3Qgc2V0KSIKIAkJCQkJ
ICAgICAiIChTQT0lcE0pXG4iLAogCQkJCQkgICAgIGhkci0+YWRkcjIpOwpAQCAtOTk3LDcgKzEw
MTksNyBAQCBpbnQgaWVlZTgwMjExX3J4KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBz
dHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCWlmIChza2ItPmxlbiA8IElFRUU4MDIxMV9EQVRBX0hEUjNf
TEVOKQogCQlnb3RvIHJ4X2Ryb3BwZWQ7CgotCS8vIGlmIFFvUyBlbmFibGVkLCBzaG91bGQgY2hl
Y2sgdGhlIHNlcXVlbmNlIGZvciBlYWNoIG9mIHRoZSBBQworCS8qIGlmIFFvUyBlbmFibGVkLCBz
aG91bGQgY2hlY2sgdGhlIHNlcXVlbmNlIGZvciBlYWNoIG9mIHRoZSBBQyAqLwogCWlmICgoIWll
ZWUtPnBIVEluZm8tPmJDdXJSeFJlb3JkZXJFbmFibGUpIHx8ICFpZWVlLT5jdXJyZW50X25ldHdv
cmsucW9zX2RhdGEuYWN0aXZlfHwgIUlzRGF0YUZyYW1lKHNrYi0+ZGF0YSkgfHwgSXNMZWdhY3lE
YXRhRnJhbWUoc2tiLT5kYXRhKSkgewogCQlpZiAoaXNfZHVwbGljYXRlX3BhY2tldChpZWVlLCBo
ZHIpKQogCQlnb3RvIHJ4X2Ryb3BwZWQ7CkBAIC0xMTA0LDEzICsxMTI2LDE1IEBAIGludCBpZWVl
ODAyMTFfcngoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHN0cnVjdCBza19idWZmICpz
a2IsCiAJfQogI2VuZGlmCiAJLy9JRUVFODAyMTFfREVCVUdfREFUQShJRUVFODAyMTFfRExfREFU
QSwgc2tiLT5kYXRhLCBza2ItPmxlbik7Ci0JLyogTnVsbGZ1bmMgZnJhbWVzIG1heSBoYXZlIFBT
LWJpdCBzZXQsIHNvIHRoZXkgbXVzdCBiZSBwYXNzZWQgdG8KLQkgKiBob3N0YXBfaGFuZGxlX3N0
YV9yeCgpIGJlZm9yZSBiZWluZyBkcm9wcGVkIGhlcmUuICovCisJLyoKKwkgKiBOdWxsZnVuYyBm
cmFtZXMgbWF5IGhhdmUgUFMtYml0IHNldCwgc28gdGhleSBtdXN0IGJlIHBhc3NlZCB0bworCSAq
IGhvc3RhcF9oYW5kbGVfc3RhX3J4KCkgYmVmb3JlIGJlaW5nIGRyb3BwZWQgaGVyZS4KKwkgKi8K
IAlpZiAoc3R5cGUgIT0gSUVFRTgwMjExX1NUWVBFX0RBVEEgJiYKIAkgICAgc3R5cGUgIT0gSUVF
RTgwMjExX1NUWVBFX0RBVEFfQ0ZBQ0sgJiYKIAkgICAgc3R5cGUgIT0gSUVFRTgwMjExX1NUWVBF
X0RBVEFfQ0ZQT0xMICYmCiAJICAgIHN0eXBlICE9IElFRUU4MDIxMV9TVFlQRV9EQVRBX0NGQUNL
UE9MTCYmCi0JICAgIHN0eXBlICE9IElFRUU4MDIxMV9TVFlQRV9RT1NfREFUQS8vYWRkIGJ5IERh
dmlkLDIwMDYuOC40CisJICAgIHN0eXBlICE9IElFRUU4MDIxMV9TVFlQRV9RT1NfREFUQS8qIGFk
ZCBieSBEYXZpZCwyMDA2LjguNCAqLwogCSAgICApIHsKIAkJaWYgKHN0eXBlICE9IElFRUU4MDIx
MV9TVFlQRV9OVUxMRlVOQykKIAkJCUlFRUU4MDIxMV9ERUJVR19EUk9QKApAQCAtMTEzNiw3ICsx
MTYwLDcgQEAgaW50IGllZWU4MDIxMV9yeChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwg
c3RydWN0IHNrX2J1ZmYgKnNrYiwKIAloZHIgPSAoc3RydWN0IHJ0bF84MDIxMV9oZHJfNGFkZHIg
Kikgc2tiLT5kYXRhOwoKIAkvKiBza2I6IGhkciArIChwb3NzaWJseSBmcmFnbWVudGVkKSBwbGFp
bnRleHQgcGF5bG9hZCAqLwotCS8vIFBSOiBGSVhNRTogaG9zdGFwIGhhcyBhZGRpdGlvbmFsIGNv
bmRpdGlvbnMgaW4gdGhlICJpZiIgYmVsb3c6CisJLyogUFI6IEZJWE1FOiBob3N0YXAgaGFzIGFk
ZGl0aW9uYWwgY29uZGl0aW9ucyBpbiB0aGUgImlmIiBiZWxvdzogKi8KIAkvLyBpZWVlLT5ob3N0
X2RlY3J5cHQgJiYgKGZjICYgSUVFRTgwMjExX0ZDVExfV0VQKSAmJgogCWlmICgoZnJhZyAhPSAw
IHx8IChmYyAmIElFRUU4MDIxMV9GQ1RMX01PUkVGUkFHUykpKSB7CiAJCWludCBmbGVuOwpAQCAt
MTE2NCwzMyArMTE4OCw0MyBAQCBpbnQgaWVlZTgwMjExX3J4KHN0cnVjdCBpZWVlODAyMTFfZGV2
aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQl9CgogCQlpZiAoZnJhZyA9PSAwKSB7
Ci0JCQkvKiBjb3B5IGZpcnN0IGZyYWdtZW50IChpbmNsdWRpbmcgZnVsbCBoZWFkZXJzKSBpbnRv
Ci0JCQkgKiBiZWdpbm5pbmcgb2YgdGhlIGZyYWdtZW50IGNhY2hlIHNrYiAqLworCQkJLyoKKwkJ
CSAqIGNvcHkgZmlyc3QgZnJhZ21lbnQgKGluY2x1ZGluZyBmdWxsIGhlYWRlcnMpIGludG8KKwkJ
CSAqIGJlZ2lubmluZyBvZiB0aGUgZnJhZ21lbnQgY2FjaGUgc2tiCisJCQkgKi8KIAkJCXNrYl9w
dXRfZGF0YShmcmFnX3NrYiwgc2tiLT5kYXRhLCBmbGVuKTsKIAkJfSBlbHNlIHsKLQkJCS8qIGFw
cGVuZCBmcmFtZSBwYXlsb2FkIHRvIHRoZSBlbmQgb2YgdGhlIGZyYWdtZW50Ci0JCQkgKiBjYWNo
ZSBza2IgKi8KKwkJCS8qCisJCQkgKiBhcHBlbmQgZnJhbWUgcGF5bG9hZCB0byB0aGUgZW5kIG9m
IHRoZSBmcmFnbWVudAorCQkJICogY2FjaGUgc2tiCisJCQkgKi8KIAkJCXNrYl9wdXRfZGF0YShm
cmFnX3NrYiwgc2tiLT5kYXRhICsgaGRybGVuLCBmbGVuKTsKIAkJfQogCQlkZXZfa2ZyZWVfc2ti
X2FueShza2IpOwogCQlza2IgPSBOVUxMOwoKIAkJaWYgKGZjICYgSUVFRTgwMjExX0ZDVExfTU9S
RUZSQUdTKSB7Ci0JCQkvKiBtb3JlIGZyYWdtZW50cyBleHBlY3RlZCAtIGxlYXZlIHRoZSBza2Ig
aW4gZnJhZ21lbnQKKwkJCS8qCisJCQkgKiBtb3JlIGZyYWdtZW50cyBleHBlY3RlZCAtIGxlYXZl
IHRoZSBza2IgaW4gZnJhZ21lbnQKIAkJCSAqIGNhY2hlIGZvciBub3c7IGl0IHdpbGwgYmUgZGVs
aXZlcmVkIHRvIHVwcGVyIGxheWVycwotCQkJICogYWZ0ZXIgYWxsIGZyYWdtZW50cyBoYXZlIGJl
ZW4gcmVjZWl2ZWQgKi8KKwkJCSAqIGFmdGVyIGFsbCBmcmFnbWVudHMgaGF2ZSBiZWVuIHJlY2Vp
dmVkCisJCQkgKi8KIAkJCWdvdG8gcnhfZXhpdDsKIAkJfQoKLQkJLyogdGhpcyB3YXMgdGhlIGxh
c3QgZnJhZ21lbnQgYW5kIHRoZSBmcmFtZSB3aWxsIGJlCi0JCSAqIGRlbGl2ZXJlZCwgc28gcmVt
b3ZlIHNrYiBmcm9tIGZyYWdtZW50IGNhY2hlICovCisJCS8qCisJCSAqIHRoaXMgd2FzIHRoZSBs
YXN0IGZyYWdtZW50IGFuZCB0aGUgZnJhbWUgd2lsbCBiZQorCQkgKiBkZWxpdmVyZWQsIHNvIHJl
bW92ZSBza2IgZnJvbSBmcmFnbWVudCBjYWNoZQorCQkgKi8KIAkJc2tiID0gZnJhZ19za2I7CiAJ
CWhkciA9IChzdHJ1Y3QgcnRsXzgwMjExX2hkcl80YWRkciAqKSBza2ItPmRhdGE7CiAJCWllZWU4
MDIxMV9mcmFnX2NhY2hlX2ludmFsaWRhdGUoaWVlZSwgaGRyKTsKIAl9CgotCS8qIHNrYjogaGRy
ICsgKHBvc3NpYmxlIHJlYXNzZW1ibGVkKSBmdWxsIE1TRFUgcGF5bG9hZDsgcG9zc2libHkgc3Rp
bGwKLQkgKiBlbmNyeXB0ZWQvYXV0aGVudGljYXRlZCAqLworCS8qCisJICogc2tiOiBoZHIgKyAo
cG9zc2libGUgcmVhc3NlbWJsZWQpIGZ1bGwgTVNEVSBwYXlsb2FkOyBwb3NzaWJseSBzdGlsbAor
CSAqIGVuY3J5cHRlZC9hdXRoZW50aWNhdGVkCisJICovCiAJaWYgKGllZWUtPmhvc3RfZGVjcnlw
dCAmJiAoZmMgJiBJRUVFODAyMTFfRkNUTF9XRVApICYmCiAJICAgIGllZWU4MDIxMV9yeF9mcmFt
ZV9kZWNyeXB0X21zZHUoaWVlZSwgc2tiLCBrZXlpZHgsIGNyeXB0KSkKIAl7CkBAIC0xMTk4LDcg
KzEyMzIsNyBAQCBpbnQgaWVlZTgwMjExX3J4KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVl
LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQlnb3RvIHJ4X2Ryb3BwZWQ7CiAJfQoKLQkvL2FkZGVk
IGJ5IGFteSBmb3IgQVAgcm9hbWluZworCS8qIGFkZGVkIGJ5IGFteSBmb3IgQVAgcm9hbWluZyAq
LwogCWllZWUtPkxpbmtEZXRlY3RJbmZvLk51bVJlY3ZEYXRhSW5QZXJpb2QrKzsKIAlpZWVlLT5M
aW5rRGV0ZWN0SW5mby5OdW1SeE9rSW5QZXJpb2QrKzsKCkBAIC0xMjA4LDggKzEyNDIsMTAgQEAg
aW50IGllZWU4MDIxMV9yeChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0IHNr
X2J1ZmYgKnNrYiwKIAkJICAgIGllZWU4MDIxMV9pc19lYXBvbF9mcmFtZShpZWVlLCBza2IsIGhk
cmxlbikpIHsKCiAjaWZkZWYgQ09ORklHX0lFRUU4MDIxMV9ERUJVRwotCQkJLyogcGFzcyB1bmVu
Y3J5cHRlZCBFQVBPTCBmcmFtZXMgZXZlbiBpZiBlbmNyeXB0aW9uIGlzCi0JCQkgKiBjb25maWd1
cmVkICovCisJCQkvKgorCQkJICogcGFzcyB1bmVuY3J5cHRlZCBFQVBPTCBmcmFtZXMgZXZlbiBp
ZiBlbmNyeXB0aW9uIGlzCisJCQkgKiBjb25maWd1cmVkCisJCQkgKi8KIAkJCXN0cnVjdCBlYXBv
bCAqZWFwID0gKHN0cnVjdCBlYXBvbCAqKShza2ItPmRhdGEgKwogCQkJCTI0KTsKIAkJCUlFRUU4
MDIxMV9ERUJVR19FQVAoIlJYOiBJRUVFIDgwMi4xWCBFQVBPTCBmcmFtZTogJXNcbiIsCkBAIC0x
MjQ4LDcgKzEyODQsNyBAQCBpbnQgaWVlZTgwMjExX3J4KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNl
ICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQlwcmludGsoS0VSTl9XQVJOSU5HICJSWDog
SUVFRTgwMi4xWCBFUEFPTCBmcmFtZSFcbiIpOwogCX0KICovCi0vL2FkZGVkIGJ5IGFteSBmb3Ig
cmVvcmRlcgorLyogYWRkZWQgYnkgYW15IGZvciByZW9yZGVyICovCiAJaWYgKGllZWUtPmN1cnJl
bnRfbmV0d29yay5xb3NfZGF0YS5hY3RpdmUgJiYgSXNRb1NEYXRhRnJhbWUoc2tiLT5kYXRhKQog
CQkmJiAhaXNfbXVsdGljYXN0X2V0aGVyX2FkZHIoaGRyLT5hZGRyMSkpCiAJewpAQCAtMTI2MCw3
ICsxMjk2LDcgQEAgaW50IGllZWU4MDIxMV9yeChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVl
ZSwgc3RydWN0IHNrX2J1ZmYgKnNrYiwKIAkJCWllZWUtPmJpc19hbnlfbm9uYmVwa3RzID0gdHJ1
ZTsKIAkJfQogCX0KLS8vYWRkZWQgYnkgYW15IGZvciByZW9yZGVyCisvKiBhZGRlZCBieSBhbXkg
Zm9yIHJlb3JkZXIgKi8KIAkvKiBza2I6IGhkciArIChwb3NzaWJsZSByZWFzc2VtYmxlZCkgZnVs
bCBwbGFpbnRleHQgcGF5bG9hZCAqLwogCS8vZXRoZXJ0eXBlID0gKHBheWxvYWRbNl0gPDwgOCkg
fCBwYXlsb2FkWzddOwogCXJ4YiA9IGttYWxsb2Moc2l6ZW9mKHN0cnVjdCBpZWVlODAyMTFfcnhi
KSwgR0ZQX0FUT01JQyk7CkBAIC0xMjc4LDkgKzEzMTQsOSBAQCBpbnQgaWVlZTgwMjExX3J4KHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQlnb3Rv
IHJ4X2Ryb3BwZWQ7CiAJfQoKLS8vYWRkZWQgYnkgYW15IGZvciByZW9yZGVyCisvKiBhZGRlZCBi
eSBhbXkgZm9yIHJlb3JkZXIgKi8KIAlpZiAoIWllZWUtPnBIVEluZm8tPmJDdXJSeFJlb3JkZXJF
bmFibGUgfHwgIXBUUykgewotLy9hZGRlZCBieSBhbXkgZm9yIHJlb3JkZXIKKy8qIGFkZGVkIGJ5
IGFteSBmb3IgcmVvcmRlciAqLwogCQlmb3IoaSA9IDA7IGk8cnhiLT5ucl9zdWJmcmFtZXM7IGkr
KykgewogCQkJc3RydWN0IHNrX2J1ZmYgKnN1Yl9za2IgPSByeGItPnN1YmZyYW1lc1tpXTsKCkBA
IC0xMjkxLDggKzEzMjcsMTAgQEAgaW50IGllZWU4MDIxMV9yeChzdHJ1Y3QgaWVlZTgwMjExX2Rl
dmljZSAqaWVlZSwgc3RydWN0IHNrX2J1ZmYgKnNrYiwKIAkJCQkJCSgobWVtY21wKHN1Yl9za2It
PmRhdGEsIHJmYzEwNDJfaGVhZGVyLCBTTkFQX1NJWkUpID09IDAgJiYKIAkJCQkJCSAgZXRoZXJ0
eXBlICE9IEVUSF9QX0FBUlAgJiYgZXRoZXJ0eXBlICE9IEVUSF9QX0lQWCkgfHwKIAkJCQkJCSBt
ZW1jbXAoc3ViX3NrYi0+ZGF0YSwgYnJpZGdlX3R1bm5lbF9oZWFkZXIsIFNOQVBfU0laRSkgPT0g
MCkpIHsKLQkJCQkJLyogcmVtb3ZlIFJGQzEwNDIgb3IgQnJpZGdlLVR1bm5lbCBlbmNhcHN1bGF0
aW9uIGFuZAotCQkJCQkgKiByZXBsYWNlIEV0aGVyVHlwZSAqLworCQkJCQkvKgorCQkJCQkgKiBy
ZW1vdmUgUkZDMTA0MiBvciBCcmlkZ2UtVHVubmVsIGVuY2Fwc3VsYXRpb24gYW5kCisJCQkJCSAq
IHJlcGxhY2UgRXRoZXJUeXBlCisJCQkJCSAqLwogCQkJCQlza2JfcHVsbChzdWJfc2tiLCBTTkFQ
X1NJWkUpOwogCQkJCQltZW1jcHkoc2tiX3B1c2goc3ViX3NrYiwgRVRIX0FMRU4pLCBzcmMsIEVU
SF9BTEVOKTsKIAkJCQkJbWVtY3B5KHNrYl9wdXNoKHN1Yl9za2IsIEVUSF9BTEVOKSwgZHN0LCBF
VEhfQUxFTik7CkBAIC0xMzQ2LDkgKzEzODQsMTEgQEAgaW50IGllZWU4MDIxMV9yeChzdHJ1Y3Qg
aWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0IHNrX2J1ZmYgKnNrYiwKIAlyeGIgPSBOVUxM
OwogCXN0YXRzLT5yeF9kcm9wcGVkKys7CgotCS8qIFJldHVybmluZyAwIGluZGljYXRlcyB0byBj
YWxsZXIgdGhhdCB3ZSBoYXZlIG5vdCBoYW5kbGVkIHRoZSBTS0ItLQorCS8qCisJICogUmV0dXJu
aW5nIDAgaW5kaWNhdGVzIHRvIGNhbGxlciB0aGF0IHdlIGhhdmUgbm90IGhhbmRsZWQgdGhlIFNL
Qi0tCiAJICogc28gaXQgaXMgc3RpbGwgYWxsb2NhdGVkIGFuZCBjYW4gYmUgdXNlZCBhZ2FpbiBi
eSB1bmRlcmx5aW5nCi0JICogaGFyZHdhcmUgYXMgYSBETUEgdGFyZ2V0ICovCisJICogaGFyZHdh
cmUgYXMgYSBETUEgdGFyZ2V0CisJICovCiAJcmV0dXJuIDA7CiB9CiBFWFBPUlRfU1lNQk9MKGll
ZWU4MDIxMV9yeCk7CkBAIC0xNTc0LDExICsxNjE0LDExIEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBp
ZWVlODAyMTFfZXh0cmFjdF9jb3VudHJ5X2llKAogCQkJfQogCQl9CgotCQkvLwotCQkvLyAwNzAz
MDUsIHJjbmprbzogSSB1cGRhdGUgY291bnRyeSBJRSB3YXRjaCBkb2cgaGVyZSBiZWNhdXNlCi0J
CS8vIHNvbWUgQVAgKGUuZy4gQ2lzY28gMTI0MikgZG9uJ3QgaW5jbHVkZSBjb3VudHJ5IElFIGlu
IHRoZWlyCi0JCS8vIHByb2JlIHJlc3BvbnNlIGZyYW1lLgotCQkvLworCQkvKgorCQkgKiAwNzAz
MDUsIHJjbmprbzogSSB1cGRhdGUgY291bnRyeSBJRSB3YXRjaCBkb2cgaGVyZSBiZWNhdXNlCisJ
CSAqIHNvbWUgQVAgKGUuZy4gQ2lzY28gMTI0MikgZG9uJ3QgaW5jbHVkZSBjb3VudHJ5IElFIGlu
IHRoZWlyCisJCSAqIHByb2JlIHJlc3BvbnNlIGZyYW1lLgorCQkgKi8KIAkJaWYgKElTX0VRVUFM
X0NJRV9TUkMoaWVlZSwgYWRkcjIpICkKIAkJewogCQkJVVBEQVRFX0NJRV9XQVRDSERPRyhpZWVl
KTsKQEAgLTE2MTMsOSArMTY1MywxMSBAQCBpbnQgaWVlZTgwMjExX3BhcnNlX2luZm9fcGFyYW0o
c3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCiAJCQkJCSAgICAgaW5mb19lbGVtZW50LT5s
ZW4gKwogCQkJCQkgICAgIHNpemVvZigqaW5mb19lbGVtZW50KSwKIAkJCQkJICAgICBsZW5ndGgs
IGluZm9fZWxlbWVudC0+aWQpOwotCQkJLyogV2Ugc3RvcCBwcm9jZXNzaW5nIGJ1dCBkb24ndCBy
ZXR1cm4gYW4gZXJyb3IgaGVyZQorCQkJLyoKKwkJCSAqIFdlIHN0b3AgcHJvY2Vzc2luZyBidXQg
ZG9uJ3QgcmV0dXJuIGFuIGVycm9yIGhlcmUKIAkJCSAqIGJlY2F1c2Ugc29tZSBtaXNiZWhhdmlv
dXIgQVBzIGJyZWFrIHRoaXMgcnVsZS4gaWUuCi0JCQkgKiBPcmlub2NvIEFQMTAwMC4gKi8KKwkJ
CSAqIE9yaW5vY28gQVAxMDAwLgorCQkJICovCiAJCQlicmVhazsKIAkJfQoKQEAgLTE3ODksNyAr
MTgzMSw3IEBAIGludCBpZWVlODAyMTFfcGFyc2VfaW5mb19wYXJhbShzdHJ1Y3QgaWVlZTgwMjEx
X2RldmljZSAqaWVlZSwKIAkJCX0KICNlbmRpZgoKLQkJCS8vZm9yIEhUY2FwIGFuZCBIVGluZm8g
cGFyYW1ldGVycworCQkJLyogZm9yIEhUY2FwIGFuZCBIVGluZm8gcGFyYW1ldGVycyAqLwogCQkJ
aWYodG1wX2h0Y2FwX2xlbiA9PSAwKXsKIAkJCQlpZihpbmZvX2VsZW1lbnQtPmxlbiA+PSA0ICYm
CiAJCQkJICAgaW5mb19lbGVtZW50LT5kYXRhWzBdID09IDB4MDAgJiYKQEAgLTE4ODMsNyArMTky
NSw3IEBAIGludCBpZWVlODAyMTFfcGFyc2VfaW5mb19wYXJhbShzdHJ1Y3QgaWVlZTgwMjExX2Rl
dmljZSAqaWVlZSwKIAkJCX0KIAkJCWVsc2UKIAkJCQluZXR3b3JrLT5yYWxpbmtfY2FwX2V4aXN0
ID0gZmFsc2U7Ci0JCQkvL2FkZGVkIGJ5IGFteSBmb3IgYXRoZXJvcyBBUAorCQkJLyogYWRkZWQg
YnkgYW15IGZvciBhdGhlcm9zIEFQICovCiAJCQlpZigoaW5mb19lbGVtZW50LT5sZW4gPj0gMyAm
JgogCQkJCWluZm9fZWxlbWVudC0+ZGF0YVswXSA9PSAweDAwICYmCiAJCQkJaW5mb19lbGVtZW50
LT5kYXRhWzFdID09IDB4MDMgJiYKQEAgLTE5MDgsNyArMTk1MCw3IEBAIGludCBpZWVlODAyMTFf
cGFyc2VfaW5mb19wYXJhbShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwKIAkJCX0KIAkJ
CWVsc2UKIAkJCQluZXR3b3JrLT5jaXNjb19jYXBfZXhpc3QgPSBmYWxzZTsKLQkJCS8vYWRkZWQg
YnkgYW15IGZvciBMRUFQIG9mIGNpc2NvCisJCQkvKiBhZGRlZCBieSBhbXkgZm9yIExFQVAgb2Yg
Y2lzY28gKi8KIAkJCWlmIChpbmZvX2VsZW1lbnQtPmxlbiA+IDQgJiYKIAkJCQlpbmZvX2VsZW1l
bnQtPmRhdGFbMF0gPT0gMHgwMCAmJgogCQkJCWluZm9fZWxlbWVudC0+ZGF0YVsxXSA9PSAweDQw
ICYmCkBAIC0xOTI0LDkgKzE5NjYsOSBAQCBpbnQgaWVlZTgwMjExX3BhcnNlX2luZm9fcGFyYW0o
c3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCiAJCQkJCX0KIAkJCQkJZWxzZQogCQkJCQkJ
bmV0d29yay0+YkNjeFJtRW5hYmxlID0gZmFsc2U7Ci0JCQkJCS8vCi0JCQkJCS8vIENDWHY0IFRh
YmxlIDU5LTEgTUJTU0lEIE1hc2tzLgotCQkJCQkvLworCQkJCQkvKgorCQkJCQkgKiBDQ1h2NCBU
YWJsZSA1OS0xIE1CU1NJRCBNYXNrcy4KKwkJCQkJICovCiAJCQkJCW5ldHdvcmstPk1Cc3NpZE1h
c2sgPSBuZXR3b3JrLT5DY3hSbVN0YXRlWzFdICYgMHgwNzsKIAkJCQkJaWYobmV0d29yay0+TUJz
c2lkTWFzayAhPSAwKQogCQkJCQl7CkBAIC0xOTczLDcgKzIwMTUsNyBAQCBpbnQgaWVlZTgwMjEx
X3BhcnNlX2luZm9fcGFyYW0oc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCiAJCQkgICAg
ICAgbmV0d29yay0+cnNuX2llX2xlbik7CiAJCQlicmVhazsKCi0JCQkvL0hUIHJlbGF0ZWQgZWxl
bWVudC4KKwkJCS8qIEhUIHJlbGF0ZWQgZWxlbWVudC4gKi8KIAkJY2FzZSBNRklFX1RZUEVfSFRf
Q0FQOgogCQkJSUVFRTgwMjExX0RFQlVHX1NDQU4oIk1GSUVfVFlQRV9IVF9DQVA6ICVkIGJ5dGVz
XG4iLAogCQkJCQkgICAgIGluZm9fZWxlbWVudC0+bGVuKTsKQEAgLTE5ODQsOSArMjAyNiwxMSBA
QCBpbnQgaWVlZTgwMjExX3BhcnNlX2luZm9fcGFyYW0oc3RydWN0IGllZWU4MDIxMV9kZXZpY2Ug
KmllZWUsCiAJCQkJCXNpemVvZihuZXR3b3JrLT5ic3NodC5iZEhUQ2FwQnVmKTp0bXBfaHRjYXBf
bGVuOwogCQkJCW1lbWNweShuZXR3b3JrLT5ic3NodC5iZEhUQ2FwQnVmLGluZm9fZWxlbWVudC0+
ZGF0YSxuZXR3b3JrLT5ic3NodC5iZEhUQ2FwTGVuKTsKCi0JCQkJLy9JZiBwZWVyIGlzIEhULCBi
dXQgbm90IFdNTSwgY2FsbCBRb3NTZXRMZWdhY3lXTU1QYXJhbVdpdGhIVCgpCi0JCQkJLy8gd2lu
ZG93cyBkcml2ZXIgd2lsbCB1cGRhdGUgV01NIHBhcmFtZXRlcnMgZWFjaCBiZWFjb24gcmVjZWl2
ZWQgb25jZSBjb25uZWN0ZWQKLQkJCQkvLyBMaW51eCBkcml2ZXIgaXMgYSBiaXQgZGlmZmVyZW50
LgorCQkJCS8qCisJCQkJICogSWYgcGVlciBpcyBIVCwgYnV0IG5vdCBXTU0sIGNhbGwgUW9zU2V0
TGVnYWN5V01NUGFyYW1XaXRoSFQoKQorCQkJCSAqIHdpbmRvd3MgZHJpdmVyIHdpbGwgdXBkYXRl
IFdNTSBwYXJhbWV0ZXJzIGVhY2ggYmVhY29uIHJlY2VpdmVkIG9uY2UgY29ubmVjdGVkCisJCQkJ
ICogTGludXggZHJpdmVyIGlzIGEgYml0IGRpZmZlcmVudC4KKwkJCQkgKi8KIAkJCQluZXR3b3Jr
LT5ic3NodC5iZFN1cHBvcnRIVCA9IHRydWU7CiAJCQl9CiAJCQllbHNlCkBAIC0yMDEzLDkgKzIw
NTcsMTEgQEAgaW50IGllZWU4MDIxMV9wYXJzZV9pbmZvX3BhcmFtKHN0cnVjdCBpZWVlODAyMTFf
ZGV2aWNlICppZWVlLAogCQkJewogCQkJCW5ldHdvcmstPmJXaXRoQWlyb25ldElFID0gdHJ1ZTsK
Ci0JCQkJLy8gQ0NYIDEgc3BlYyB2MS4xMywgQTAxLjEgQ0tJUCBOZWdvdGlhdGlvbiAocGFnZTIz
KToKLQkJCQkvLyAiQSBDaXNjbyBhY2Nlc3MgcG9pbnQgYWR2ZXJ0aXNlcyBzdXBwb3J0IGZvciBD
S0lQIGluIGJlYWNvbiBhbmQgcHJvYmUgcmVzcG9uc2UgcGFja2V0cywKLQkJCQkvLyAgYnkgYWRk
aW5nIGFuIEFpcm9uZXQgZWxlbWVudCBhbmQgc2V0dGluZyBvbmUgb3IgYm90aCBvZiB0aGUgQ0tJ
UCBuZWdvdGlhdGlvbiBiaXRzLiIKKwkJCQkvKgorCQkJCSAqIENDWCAxIHNwZWMgdjEuMTMsIEEw
MS4xIENLSVAgTmVnb3RpYXRpb24gKHBhZ2UyMyk6CisJCQkJICogIkEgQ2lzY28gYWNjZXNzIHBv
aW50IGFkdmVydGlzZXMgc3VwcG9ydCBmb3IgQ0tJUCBpbiBiZWFjb24gYW5kIHByb2JlIHJlc3Bv
bnNlIHBhY2tldHMsCisJCQkJICogYnkgYWRkaW5nIGFuIEFpcm9uZXQgZWxlbWVudCBhbmQgc2V0
dGluZyBvbmUgb3IgYm90aCBvZiB0aGUgQ0tJUCBuZWdvdGlhdGlvbiBiaXRzLiIKKwkJCQkgKi8K
IAkJCQlpZigJKGluZm9fZWxlbWVudC0+ZGF0YVtJRV9DSVNDT19GTEFHX1BPU0lUSU9OXSZTVVBQ
T1JUX0NLSVBfTUlDKQl8fAogCQkJCQkoaW5mb19lbGVtZW50LT5kYXRhW0lFX0NJU0NPX0ZMQUdf
UE9TSVRJT05dJlNVUFBPUlRfQ0tJUF9QSykJKQogCQkJCXsKQEAgLTIwNDAsNyArMjA4Niw3IEBA
IGludCBpZWVlODAyMTFfcGFyc2VfaW5mb19wYXJhbShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAq
aWVlZSwKIAkJY2FzZSBNRklFX1RZUEVfQ09VTlRSWToKIAkJCUlFRUU4MDIxMV9ERUJVR19TQ0FO
KCJNRklFX1RZUEVfQ09VTlRSWTogJWQgYnl0ZXNcbiIsCiAJCQkJCSAgICAgaW5mb19lbGVtZW50
LT5sZW4pOwotCQkJaWVlZTgwMjExX2V4dHJhY3RfY291bnRyeV9pZShpZWVlLCBpbmZvX2VsZW1l
bnQsIG5ldHdvcmssIG5ldHdvcmstPmJzc2lkKTsvL2FkZHIyIGlzIHNhbWUgYXMgYWRkcjMgd2hl
biBmcm9tIGFuIEFQCisJCQlpZWVlODAyMTFfZXh0cmFjdF9jb3VudHJ5X2llKGllZWUsIGluZm9f
ZWxlbWVudCwgbmV0d29yaywgbmV0d29yay0+YnNzaWQpOy8qIGFkZHIyIGlzIHNhbWUgYXMgYWRk
cjMgd2hlbiBmcm9tIGFuIEFQICovCiAJCQlicmVhazsKIC8qIFRPRE8gKi8KIAkJZGVmYXVsdDoK
QEAgLTIwNzUsNyArMjEyMSw3IEBAIHN0YXRpYyBpbmxpbmUgdTggaWVlZTgwMjExX1NpZ25hbFN0
cmVuZ3RoVHJhbnNsYXRlKAogewogCXU4IFJldFNTOwoKLQkvLyBTdGVwIDEuIFNjYWxlIG1hcHBp
bmcuCisJLyogU3RlcCAxLiBTY2FsZSBtYXBwaW5nLiAqLwogCWlmKEN1cnJTUyA+PSA3MSAmJiBD
dXJyU1MgPD0gMTAwKQogCXsKIAkJUmV0U1MgPSA5MCArICgoQ3VyclNTIC0gNzApIC8gMyk7CkBA
IC0yMTE4LDcgKzIxNjQsNyBAQCBzdGF0aWMgaW5saW5lIHU4IGllZWU4MDIxMV9TaWduYWxTdHJl
bmd0aFRyYW5zbGF0ZSgKIAl9CiAJLy9SVF9UUkFDRShDT01QX0RCRywgREJHX0xPVUQsICgiIyMj
IyMgQWZ0ZXIgTWFwcGluZzogIExhc3RTUzogJWQsIEN1cnJTUzogJWQsIFJldFNTOiAlZFxuIiwg
TGFzdFNTLCBDdXJyU1MsIFJldFNTKSk7CgotCS8vIFN0ZXAgMi4gU21vb3RoaW5nLgorCS8qIFN0
ZXAgMi4gU21vb3RoaW5nLiAqLwoKIAkvL1JUX1RSQUNFKENPTVBfREJHLCBEQkdfTE9VRCwgKCIk
JCQkJCBBZnRlciBTbW9vdGhpbmc6ICBMYXN0U1M6ICVkLCBDdXJyU1M6ICVkLCBSZXRTUzogJWRc
biIsIExhc3RTUywgQ3VyclNTLCBSZXRTUykpOwoKQEAgLTIxMjgsOSArMjE3NCw5IEBAIHN0YXRp
YyBpbmxpbmUgdTggaWVlZTgwMjExX1NpZ25hbFN0cmVuZ3RoVHJhbnNsYXRlKAogLyogMC0xMDAg
aW5kZXggKi8KIHN0YXRpYyBsb25nIGllZWU4MDIxMV90cmFuc2xhdGVfdG9kYm0odTggc2lnbmFs
X3N0cmVuZ3RoX2luZGV4KQogewotCWxvbmcJc2lnbmFsX3Bvd2VyOyAvLyBpbiBkQm0uCisJbG9u
ZwlzaWduYWxfcG93ZXI7IC8qIGluIGRCbS4gKi8KCi0JLy8gVHJhbnNsYXRlIHRvIGRCbSAoeD0w
LjV5LTk1KS4KKwkvKiBUcmFuc2xhdGUgdG8gZEJtICh4PTAuNXktOTUpLiAqLwogCXNpZ25hbF9w
b3dlciA9IChsb25nKSgoc2lnbmFsX3N0cmVuZ3RoX2luZGV4ICsgMSkgPj4gMSk7CiAJc2lnbmFs
X3Bvd2VyIC09IDk1OwoKQEAgLTIxODAsNyArMjIyNiw3IEBAIHN0YXRpYyBpbmxpbmUgaW50IGll
ZWU4MDIxMV9uZXR3b3JrX2luaXQoCiAjZW5kaWYKIAluZXR3b3JrLT5Db3VudHJ5SWVMZW4gPSAw
OwogCW1lbXNldChuZXR3b3JrLT5Db3VudHJ5SWVCdWYsIDAsIE1BWF9JRV9MRU4pOwotLy9Jbml0
aWFsaXplIEhUIHBhcmFtZXRlcnMKKy8qIEluaXRpYWxpemUgSFQgcGFyYW1ldGVycyAqLwogCS8v
aWVlZTgwMjExX2h0X2luaXRpYWxpemUoJm5ldHdvcmstPmJzc2h0KTsKIAlIVEluaXRpYWxpemVC
c3NEZXNjKCZuZXR3b3JrLT5ic3NodCk7CiAJaWYgKHN0YXRzLT5mcmVxID09IElFRUU4MDIxMV81
MkdIWl9CQU5EKSB7CkBAIC0yMjM2LDEwICsyMjgyLDEyIEBAIHN0YXRpYyBpbmxpbmUgaW50IGll
ZWU4MDIxMV9uZXR3b3JrX2luaXQoCiBzdGF0aWMgaW5saW5lIGludCBpc19zYW1lX25ldHdvcmso
c3RydWN0IGllZWU4MDIxMV9uZXR3b3JrICpzcmMsCiAJCQkJICBzdHJ1Y3QgaWVlZTgwMjExX25l
dHdvcmsgKmRzdCwgc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpCiB7Ci0JLyogQSBuZXR3
b3JrIGlzIG9ubHkgYSBkdXBsaWNhdGUgaWYgdGhlIGNoYW5uZWwsIEJTU0lELCBFU1NJRAorCS8q
CisJICogQSBuZXR3b3JrIGlzIG9ubHkgYSBkdXBsaWNhdGUgaWYgdGhlIGNoYW5uZWwsIEJTU0lE
LCBFU1NJRAogCSAqIGFuZCB0aGUgY2FwYWJpbGl0eSBmaWVsZCAoaW4gcGFydGljdWxhciBJQlNT
IGFuZCBCU1MpIGFsbCBtYXRjaC4KIAkgKiBXZSB0cmVhdCBhbGwgPGhpZGRlbj4gd2l0aCB0aGUg
c2FtZSBCU1NJRCBhbmQgY2hhbm5lbAotCSAqIGFzIG9uZSBuZXR3b3JrICovCisJICogYXMgb25l
IG5ldHdvcmsKKwkgKi8KIAlyZXR1cm4gLy8oKHNyYy0+c3NpZF9sZW4gPT0gZHN0LT5zc2lkX2xl
bikgJiYKIAkJKCgoc3JjLT5zc2lkX2xlbiA9PSBkc3QtPnNzaWRfbGVuKSB8fCAoaWVlZS0+aXdf
bW9kZSA9PSBJV19NT0RFX0lORlJBKSkgJiYKIAkJKHNyYy0+Y2hhbm5lbCA9PSBkc3QtPmNoYW5u
ZWwpICYmCkBAIC0yMzM0LDcgKzIzODIsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgdXBkYXRlX25l
dHdvcmsoc3RydWN0IGllZWU4MDIxMV9uZXR3b3JrICpkc3QsCiAJZHN0LT5xb3NfZGF0YS5vbGRf
cGFyYW1fY291bnQgPSBvbGRfcGFyYW07CgogCS8qIGRzdC0+bGFzdF9hc3NvY2lhdGUgaXMgbm90
IG92ZXJ3cml0dGVuICovCi0JZHN0LT53bW1faW5mbyA9IHNyYy0+d21tX2luZm87IC8vc3VyZSB0
byBleGlzdCBpbiBiZWFjb24gb3IgcHJvYmUgcmVzcG9uc2UgZnJhbWUuCisJZHN0LT53bW1faW5m
byA9IHNyYy0+d21tX2luZm87IC8qIHN1cmUgdG8gZXhpc3QgaW4gYmVhY29uIG9yIHByb2JlIHJl
c3BvbnNlIGZyYW1lLiAqLwogCWlmIChzcmMtPndtbV9wYXJhbVswXS5hY2lfYWlmc258fCBcCiAJ
ICAgc3JjLT53bW1fcGFyYW1bMV0uYWNpX2FpZnNufHwgXAogCSAgIHNyYy0+d21tX3BhcmFtWzJd
LmFjaV9haWZzbnx8IFwKQEAgLTIzNDksNyArMjM5Nyw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCB1
cGRhdGVfbmV0d29yayhzdHJ1Y3QgaWVlZTgwMjExX25ldHdvcmsgKmRzdCwKIAlkc3QtPkNvdW50
cnlJZUxlbiA9IHNyYy0+Q291bnRyeUllTGVuOwogCW1lbWNweShkc3QtPkNvdW50cnlJZUJ1Ziwg
c3JjLT5Db3VudHJ5SWVCdWYsIHNyYy0+Q291bnRyeUllTGVuKTsKCi0JLy9hZGRlZCBieSBhbXkg
Zm9yIExFQVAKKwkvKiBhZGRlZCBieSBhbXkgZm9yIExFQVAgKi8KIAlkc3QtPmJXaXRoQWlyb25l
dElFID0gc3JjLT5iV2l0aEFpcm9uZXRJRTsKIAlkc3QtPmJDa2lwU3VwcG9ydGVkID0gc3JjLT5i
Q2tpcFN1cHBvcnRlZDsKIAltZW1jcHkoZHN0LT5DY3hSbVN0YXRlLCBzcmMtPkNjeFJtU3RhdGUs
IDIpOwpAQCAtMjQyMCwxMiArMjQ2OCwxNCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaWVlZTgwMjEx
X3Byb2Nlc3NfcHJvYmVfcmVzcG9uc2UoCiAJCWdvdG8gb3V0OwogCX0KCi0JLy8gRm9yIEFzdXMg
RWVlUGMgcmVxdWVzdCwKLQkvLyAoMSkgaWYgd2lyZWxlc3MgYWRhcHRlciByZWNlaXZlIGdldCBh
bnkgODAyLjExZCBjb3VudHJ5IGNvZGUgaW4gQVAgYmVhY29uLAotCS8vCSAgIHdpcmVsZXNzIGFk
YXB0ZXIgc2hvdWxkIGZvbGxvdyB0aGUgY291bnRyeSBjb2RlLgotCS8vICgyKSAgSWYgdGhlcmUg
aXMgbm8gYW55IGNvdW50cnkgY29kZSBpbiBiZWFjb24sCi0JLy8gICAgICAgdGhlbiB3aXJlbGVz
cyBhZGFwdGVyIHNob3VsZCBkbyBhY3RpdmUgc2NhbiBmcm9tIGNoMX4xMSBhbmQKLQkvLyAgICAg
ICBwYXNzaXZlIHNjYW4gZnJvbSBjaDEyfjE0CisJLyoKKwkgKiBGb3IgQXN1cyBFZWVQYyByZXF1
ZXN0LAorCSAqICgxKSBpZiB3aXJlbGVzcyBhZGFwdGVyIHJlY2VpdmUgZ2V0IGFueSA4MDIuMTFk
IGNvdW50cnkgY29kZSBpbiBBUCBiZWFjb24sCisJICogd2lyZWxlc3MgYWRhcHRlciBzaG91bGQg
Zm9sbG93IHRoZSBjb3VudHJ5IGNvZGUuCisJICogKDIpICBJZiB0aGVyZSBpcyBubyBhbnkgY291
bnRyeSBjb2RlIGluIGJlYWNvbiwKKwkgKiB0aGVuIHdpcmVsZXNzIGFkYXB0ZXIgc2hvdWxkIGRv
IGFjdGl2ZSBzY2FuIGZyb20gY2gxfjExIGFuZAorCSAqIHBhc3NpdmUgc2NhbiBmcm9tIGNoMTJ+
MTQKKwkgKi8KCiAJaWYgKCFpc19sZWdhbF9jaGFubmVsKGllZWUsIG5ldHdvcmstPmNoYW5uZWwp
KQogCQlnb3RvIG91dDsKQEAgLTI0MzMsNyArMjQ4Myw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBp
ZWVlODAyMTFfcHJvY2Vzc19wcm9iZV9yZXNwb25zZSgKIAl7CiAJCWlmIChmYyA9PSBJRUVFODAy
MTFfU1RZUEVfUFJPQkVfUkVTUCkKIAkJewotCQkJLy8gQ2FzZSAxOiBDb3VudHJ5IGNvZGUKKwkJ
CS8qIENhc2UgMTogQ291bnRyeSBjb2RlICovCiAJCQlpZihJU19DT1VOVFJZX0lFX1ZBTElEKGll
ZWUpICkKIAkJCXsKIAkJCQlpZiAoIWlzX2xlZ2FsX2NoYW5uZWwoaWVlZSwgbmV0d29yay0+Y2hh
bm5lbCkpIHsKQEAgLTI0NDEsMTAgKzI0OTEsMTAgQEAgc3RhdGljIGlubGluZSB2b2lkIGllZWU4
MDIxMV9wcm9jZXNzX3Byb2JlX3Jlc3BvbnNlKAogCQkJCQlnb3RvIG91dDsKIAkJCQl9CiAJCQl9
Ci0JCQkvLyBDYXNlIDI6IE5vIGFueSBjb3VudHJ5IGNvZGUuCisJCQkvKiBDYXNlIDI6IE5vIGFu
eSBjb3VudHJ5IGNvZGUuICovCiAJCQllbHNlCiAJCQl7Ci0JCQkJLy8gRmlsdGVyIG92ZXIgY2hh
bm5lbCBjaDEyfjE0CisJCQkJLyogRmlsdGVyIG92ZXIgY2hhbm5lbCBjaDEyfjE0ICovCiAJCQkJ
aWYgKG5ldHdvcmstPmNoYW5uZWwgPiAxMSkKIAkJCQl7CiAJCQkJCXByaW50aygiR2V0U2Nhbklu
Zm8oKTogRm9yIEdsb2JhbCBEb21haW4sIGZpbHRlciBwcm9iZSByZXNwb25zZSBhdCBjaGFubmVs
KCVkKS5cbiIsIG5ldHdvcmstPmNoYW5uZWwpOwpAQCAtMjQ1NCw3ICsyNTA0LDcgQEAgc3RhdGlj
IGlubGluZSB2b2lkIGllZWU4MDIxMV9wcm9jZXNzX3Byb2JlX3Jlc3BvbnNlKAogCQl9CiAJCWVs
c2UKIAkJewotCQkJLy8gQ2FzZSAxOiBDb3VudHJ5IGNvZGUKKwkJCS8qIENhc2UgMTogQ291bnRy
eSBjb2RlICovCiAJCQlpZihJU19DT1VOVFJZX0lFX1ZBTElEKGllZWUpICkKIAkJCXsKIAkJCQlp
ZiAoIWlzX2xlZ2FsX2NoYW5uZWwoaWVlZSwgbmV0d29yay0+Y2hhbm5lbCkpIHsKQEAgLTI0NjIs
MTAgKzI1MTIsMTAgQEAgc3RhdGljIGlubGluZSB2b2lkIGllZWU4MDIxMV9wcm9jZXNzX3Byb2Jl
X3Jlc3BvbnNlKAogCQkJCQlnb3RvIG91dDsKIAkJCQl9CiAJCQl9Ci0JCQkvLyBDYXNlIDI6IE5v
IGFueSBjb3VudHJ5IGNvZGUuCisJCQkvKiBDYXNlIDI6IE5vIGFueSBjb3VudHJ5IGNvZGUuICov
CiAJCQllbHNlCiAJCQl7Ci0JCQkJLy8gRmlsdGVyIG92ZXIgY2hhbm5lbCBjaDEyfjE0CisJCQkJ
LyogRmlsdGVyIG92ZXIgY2hhbm5lbCBjaDEyfjE0ICovCiAJCQkJaWYgKG5ldHdvcmstPmNoYW5u
ZWwgPiAxNCkKIAkJCQl7CiAJCQkJCXByaW50aygiR2V0U2NhbkluZm8oKTogRm9yIEdsb2JhbCBE
b21haW4sIGZpbHRlciBiZWFjb24gYXQgY2hhbm5lbCglZCkuXG4iLG5ldHdvcmstPmNoYW5uZWwp
OwpAQCAtMjQ3NSwxNSArMjUyNSwxOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaWVlZTgwMjExX3By
b2Nlc3NfcHJvYmVfcmVzcG9uc2UoCiAJCX0KIAl9CgotCS8qIFRoZSBuZXR3b3JrIHBhcnNlZCBj
b3JyZWN0bHkgLS0gc28gbm93IHdlIHNjYW4gb3VyIGtub3duIG5ldHdvcmtzCisJLyoKKwkgKiBU
aGUgbmV0d29yayBwYXJzZWQgY29ycmVjdGx5IC0tIHNvIG5vdyB3ZSBzY2FuIG91ciBrbm93biBu
ZXR3b3JrcwogCSAqIHRvIHNlZSBpZiB3ZSBjYW4gZmluZCBpdCBpbiBvdXIgbGlzdC4KIAkgKgog
CSAqIE5PVEU6ICBUaGlzIHNlYXJjaCBpcyBkZWZpbml0ZWx5IG5vdCBvcHRpbWl6ZWQuICBPbmNl
IGl0cyBkb2luZwogCSAqICAgICAgICB0aGUgInJpZ2h0IHRoaW5nIiB3ZSdsbCBvcHRpbWl6ZSBp
dCBmb3IgZWZmaWNpZW5jeSBpZgotCSAqICAgICAgICBuZWNlc3NhcnkgKi8KKwkgKiAgICAgICAg
bmVjZXNzYXJ5CisJICovCgotCS8qIFNlYXJjaCBmb3IgdGhpcyBlbnRyeSBpbiB0aGUgbGlzdCBh
bmQgdXBkYXRlIGl0IGlmIGl0IGlzCi0JICogYWxyZWFkeSB0aGVyZS4gKi8KKwkvKgorCSAqIFNl
YXJjaCBmb3IgdGhpcyBlbnRyeSBpbiB0aGUgbGlzdCBhbmQgdXBkYXRlIGl0IGlmIGl0IGlzCisJ
ICogYWxyZWFkeSB0aGVyZS4KKwkgKi8KCiAJc3Bpbl9sb2NrX2lycXNhdmUoJmllZWUtPmxvY2ss
IGZsYWdzKTsKCkBAIC0yNTAwLDggKzI1NTQsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaWVlZTgw
MjExX3Byb2Nlc3NfcHJvYmVfcmVzcG9uc2UoCiAJCXsKIAkJCWlmKGllZWUtPnN0YXRlID09IElF
RUU4MDIxMV9MSU5LRUQpCiAJCQkJaWVlZS0+TGlua0RldGVjdEluZm8uTnVtUmVjdkJjbkluUGVy
aW9kKys7Ci0JCX0KLQkJZWxzZSAvL2hpZGRlbiBBUAorCQl9IGVsc2UgLyogaGlkZGVuIEFQICov
CiAJCQluZXR3b3JrLT5mbGFncyA9ICh+TkVUV09SS19FTVBUWV9FU1NJRCAmIG5ldHdvcmstPmZs
YWdzKXwoTkVUV09SS19FTVBUWV9FU1NJRCAmIGllZWUtPmN1cnJlbnRfbmV0d29yay5mbGFncyk7
CiAJfQoKQEAgLTI1MTMsOCArMjU2NiwxMCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaWVlZTgwMjEx
X3Byb2Nlc3NfcHJvYmVfcmVzcG9uc2UoCiAJCQlvbGRlc3QgPSB0YXJnZXQ7CiAJfQoKLQkvKiBJ
ZiB3ZSBkaWRuJ3QgZmluZCBhIG1hdGNoLCB0aGVuIGdldCBhIG5ldyBuZXR3b3JrIHNsb3QgdG8g
aW5pdGlhbGl6ZQotCSAqIHdpdGggdGhpcyBiZWFjb24ncyBpbmZvcm1hdGlvbiAqLworCS8qCisJ
ICogSWYgd2UgZGlkbid0IGZpbmQgYSBtYXRjaCwgdGhlbiBnZXQgYSBuZXcgbmV0d29yayBzbG90
IHRvIGluaXRpYWxpemUKKwkgKiB3aXRoIHRoaXMgYmVhY29uJ3MgaW5mb3JtYXRpb24KKwkgKi8K
IAlpZiAoJnRhcmdldC0+bGlzdCA9PSAmaWVlZS0+bmV0d29ya19saXN0KSB7CiAJCWlmIChsaXN0
X2VtcHR5KCZpZWVlLT5uZXR3b3JrX2ZyZWVfbGlzdCkpIHsKIAkJCS8qIElmIHRoZXJlIGFyZSBu
byBtb3JlIHNsb3RzLCBleHBpcmUgdGhlIG9sZGVzdCAqLwpAQCAtMjU1MywxMiArMjYwOCwxMyBA
QCBzdGF0aWMgaW5saW5lIHZvaWQgaWVlZTgwMjExX3Byb2Nlc3NfcHJvYmVfcmVzcG9uc2UoCiAJ
CQkJICAgICBmYyA9PSBJRUVFODAyMTFfU1RZUEVfUFJPQkVfUkVTUCA/CiAJCQkJICAgICAiUFJP
QkUgUkVTUE9OU0UiIDogIkJFQUNPTiIpOwoKLQkJLyogd2UgaGF2ZSBhbiBlbnRyeSBhbmQgd2Ug
YXJlIGdvaW5nIHRvIHVwZGF0ZSBpdC4gQnV0IHRoaXMgZW50cnkgbWF5CisJCS8qCisJCSAqIHdl
IGhhdmUgYW4gZW50cnkgYW5kIHdlIGFyZSBnb2luZyB0byB1cGRhdGUgaXQuIEJ1dCB0aGlzIGVu
dHJ5IG1heQogCQkgKiBiZSBhbHJlYWR5IGV4cGlyZWQuIEluIHRoaXMgY2FzZSB3ZSBkbyB0aGUg
c2FtZSBhcyB3ZSBmb3VuZCBhIG5ldwogCQkgKiBuZXQgYW5kIGNhbGwgdGhlIG5ld19uZXQgaGFu
ZGxlcgogCQkgKi8KIAkJcmVuZXcgPSAhdGltZV9hZnRlcih0YXJnZXQtPmxhc3Rfc2Nhbm5lZCAr
IGllZWUtPnNjYW5fYWdlLCBqaWZmaWVzKTsKLQkJLy9ZSixhZGQsMDgwODE5LGZvciBoaWRkZW4g
YXAKKwkJLyogWUosYWRkLDA4MDgxOSxmb3IgaGlkZGVuIGFwICovCiAJCWlmKGlzX2JlYWNvbihi
ZWFjb24tPmhlYWRlci5mcmFtZV9jdGwpID09IDApCiAJCQluZXR3b3JrLT5mbGFncyA9ICh+TkVU
V09SS19FTVBUWV9FU1NJRCAmIG5ldHdvcmstPmZsYWdzKXwoTkVUV09SS19FTVBUWV9FU1NJRCAm
IHRhcmdldC0+ZmxhZ3MpOwogCQkvL2lmKHN0cm5jbXAobmV0d29yay0+c3NpZCwgImxpbmtzeXMt
YyIsOSkgPT0gMCkKQEAgLTI1NjcsNyArMjYyMyw3IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBpZWVl
ODAyMTFfcHJvY2Vzc19wcm9iZV9yZXNwb25zZSgKIAkJICAgICYmICgoKG5ldHdvcmstPnNzaWRf
bGVuID4gMCkgJiYgKHN0cm5jbXAodGFyZ2V0LT5zc2lkLCBuZXR3b3JrLT5zc2lkLCBuZXR3b3Jr
LT5zc2lkX2xlbikpKVwKIAkJICAgIHx8KChpZWVlLT5jdXJyZW50X25ldHdvcmsuc3NpZF9sZW4g
PT0gbmV0d29yay0+c3NpZF9sZW4pJiYoc3RybmNtcChpZWVlLT5jdXJyZW50X25ldHdvcmsuc3Np
ZCwgbmV0d29yay0+c3NpZCwgbmV0d29yay0+c3NpZF9sZW4pID09IDApJiYoaWVlZS0+c3RhdGUg
PT0gSUVFRTgwMjExX05PTElOSykpKSkKIAkJCXJlbmV3ID0gMTsKLQkJLy9ZSixhZGQsMDgwODE5
LGZvciBoaWRkZW4gYXAsZW5kCisJCS8qIFlKLGFkZCwwODA4MTksZm9yIGhpZGRlbiBhcCxlbmQg
Ki8KCiAJCXVwZGF0ZV9uZXR3b3JrKHRhcmdldCwgbmV0d29yayk7CiAJCWlmKHJlbmV3ICYmIChp
ZWVlLT5zb2Z0bWFjX2ZlYXR1cmVzICYgSUVFRV9TT0ZUTUFDX0FTU09DSUFURSkpCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9zb2Z0bWFj
LmMgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9zb2Z0bWFj
LmMKaW5kZXggOTQ0Yzg4OTRmOWZmLi4yN2U4MWExZGU1MWUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
c3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX3NvZnRtYWMuYworKysgYi9kcml2
ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV9zb2Z0bWFjLmMKQEAgLTMz
LDcgKzMzLDggQEAgc2hvcnQgaWVlZTgwMjExX2lzX3Nob3J0c2xvdChjb25zdCBzdHJ1Y3QgaWVl
ZTgwMjExX25ldHdvcmsgKm5ldCkKIH0KIEVYUE9SVF9TWU1CT0woaWVlZTgwMjExX2lzX3Nob3J0
c2xvdCk7CgotLyogcmV0dXJucyB0aGUgdG90YWwgbGVuZ3RoIG5lZWRlZCBmb3IgcGxlYWNpbmcg
dGhlIFJBVEUgTUZJRQorLyoKKyAqIHJldHVybnMgdGhlIHRvdGFsIGxlbmd0aCBuZWVkZWQgZm9y
IHBsZWFjaW5nIHRoZSBSQVRFIE1GSUUKICAqIHRhZyBhbmQgdGhlIEVYVEVOREVEIFJBVEUgTUZJ
RSB0YWcgaWYgbmVlZGVkLgogICogSXQgZW5jbHVkZXMgdHdvIGJ5dGVzIHBlciB0YWcgZm9yIHRo
ZSB0YWcgaXRzZWxmIGFuZCBpdHMgbGVuCiAgKi8KQEAgLTUwLDcgKzUxLDggQEAgc3RhdGljIHVu
c2lnbmVkIGludCBpZWVlODAyMTFfTUZJRV9yYXRlX2xlbihzdHJ1Y3QgaWVlZTgwMjExX2Rldmlj
ZSAqaWVlZSkKIAlyZXR1cm4gcmF0ZV9sZW47CiB9CgotLyogcGxlYWNlIHRoZSBNRklFIHJhdGUs
IHRhZyB0byB0aGUgbWVtb3J5IChkb3VibGUpIHBvaW5lZC4KKy8qCisgKiBwbGVhY2UgdGhlIE1G
SUUgcmF0ZSwgdGFnIHRvIHRoZSBtZW1vcnkgKGRvdWJsZSkgcG9pbmVkLgogICogVGhlbiBpdCB1
cGRhdGVzIHRoZSBwb2ludGVyIHNvIHRoYXQKICAqIGl0IHBvaW50cyBhZnRlciB0aGUgbmV3IE1G
SUUgdGFnIGFkZGVkLgogICovCkBAIC0yNjMsOSArMjY1LDEwIEBAIGlubGluZSB2b2lkIHNvZnRt
YWNfbWdtdF94bWl0KHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBpZWVlODAyMTFfZGV2aWNl
ICppZWVlCiAJCSAgICAoc2tiX3F1ZXVlX2xlbigmaWVlZS0+c2tiX3dhaXRRW3RjYl9kZXNjLT5x
dWV1ZV9pbmRleF0pICE9IDApIHx8IFwKIAkJICAgIChpZWVlLT5xdWV1ZV9zdG9wKSkgewogCQkJ
LyogaW5zZXJ0IHRoZSBza2IgcGFja2V0IHRvIHRoZSBtYW5hZ2VtZW50IHF1ZXVlICovCi0JCQkv
KiBhcyBmb3IgdGhlIGNvbXBsZXRpb24gZnVuY3Rpb24sIGl0IGRvZXMgbm90IG5lZWQKKwkJCS8q
CisJCQkgKiBhcyBmb3IgdGhlIGNvbXBsZXRpb24gZnVuY3Rpb24sIGl0IGRvZXMgbm90IG5lZWQK
IAkJCSAqIHRvIGNoZWNrIGl0IGFueSBtb3JlLgotCQkJICogKi8KKwkJCSAqLwogCQkJcHJpbnRr
KCIlcygpOmluc2VydCB0byB3YWl0cXVldWUhXG4iLCBfX2Z1bmNfXyk7CiAJCQlza2JfcXVldWVf
dGFpbCgmaWVlZS0+c2tiX3dhaXRRW3RjYl9kZXNjLT5xdWV1ZV9pbmRleF0sIHNrYik7CiAJCX0g
ZWxzZSB7CkBAIC00MDUsNyArNDA4LDggQEAgc3RhdGljIHZvaWQgaWVlZTgwMjExX3NlbmRfcHJv
YmVfcmVxdWVzdHMoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpCiAJfQogfQoKLS8qIHRo
aXMgcGVyZm9ybXMgc3luY3JvIHNjYW4gYmxvY2tpbmcgdGhlIGNhbGxlciB1bnRpbCBhbGwgY2hh
bm5lbHMKKy8qCisgKiB0aGlzIHBlcmZvcm1zIHN5bmNybyBzY2FuIGJsb2NraW5nIHRoZSBjYWxs
ZXIgdW50aWwgYWxsIGNoYW5uZWxzCiAgKiBpbiB0aGUgYWxsb3dlZCBjaGFubmVsIG1hcCBoYXMg
YmVlbiBjaGVja2VkLgogICovCiB2b2lkIGllZWU4MDIxMV9zb2Z0bWFjX3NjYW5fc3luY3JvKHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlKQpAQCAtNDIzLDcgKzQyNyw4IEBAIHZvaWQgaWVl
ZTgwMjExX3NvZnRtYWNfc2Nhbl9zeW5jcm8oc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUp
CiAJCQkJZ290byBvdXQ7IC8qIHNjYW4gY29tcGxldGVkICovCiAJCX0gd2hpbGUgKCFjaGFubmVs
X21hcFtjaF0pOwoKLQkJLyogdGhpcyBmdW5jdGlvbiBjYW4gYmUgY2FsbGVkIGluIHR3byBzaXR1
YXRpb25zCisJCS8qCisJCSAqIHRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCBpbiB0d28gc2l0
dWF0aW9ucwogCQkgKiAxLSBXZSBoYXZlIHN3aXRjaGVkIHRvIGFkLWhvYyBtb2RlIGFuZCB3ZSBh
cmUKIAkJICogICAgcGVyZm9ybWluZyBhIGNvbXBsZXRlIHN5bmNybyBzY2FuIGJlZm9yZSBjb25j
bHVkZQogCQkgKiAgICB0aGVyZSBhcmUgbm8gaW50ZXJlc3RpbmcgY2VsbCBhbmQgdG8gY3JlYXRl
IGEKQEAgLTQ0OCw3ICs0NTMsOCBAQCB2b2lkIGllZWU4MDIxMV9zb2Z0bWFjX3NjYW5fc3luY3Jv
KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlKQogCQlpZiAoY2hhbm5lbF9tYXBbY2hdID09
IDEpCiAJCQlpZWVlODAyMTFfc2VuZF9wcm9iZV9yZXF1ZXN0cyhpZWVlKTsKCi0JCS8qIHRoaXMg
cHJldmVudCBleGNlc3NpdmUgdGltZSB3YWl0IHdoZW4gd2UKKwkJLyoKKwkJICogdGhpcyBwcmV2
ZW50IGV4Y2Vzc2l2ZSB0aW1lIHdhaXQgd2hlbiB3ZQogCQkgKiBuZWVkIHRvIHdhaXQgZm9yIGEg
c3luY3JvIHNjYW4gdG8gZW5kLi4KIAkJICovCiAJCWlmIChpZWVlLT5zdGF0ZSA+PSBJRUVFODAy
MTFfTElOS0VEICYmIGllZWUtPnN5bmNfc2Nhbl9odXJyeXVwKQpAQCAtNzEyLDcgKzcxOCw3IEBA
IHN0YXRpYyBzdHJ1Y3Qgc2tfYnVmZiAqaWVlZTgwMjExX3Byb2JlX3Jlc3Aoc3RydWN0IGllZWU4
MDIxMV9kZXZpY2UgKmllZWUsIHU4ICpkCiAvLwlwcmludGsoIj09PT09PT09PT09PT09PT50bXBf
aHRfY2FwX2xlbiBpcyAlZCx0bXBfaHRfaW5mb19sZW4gaXMgJWQsIHRtcF9nZW5lcmljX2llX2xl
biBpcyAlZFxuIix0bXBfaHRfY2FwX2xlbix0bXBfaHRfaW5mb19sZW4sdG1wX2dlbmVyaWNfaWVf
bGVuKTsKIAliZWFjb25fc2l6ZSA9IHNpemVvZihzdHJ1Y3QgaWVlZTgwMjExX3Byb2JlX3Jlc3Bv
bnNlKSArIDIKIAkJKyBzc2lkX2xlbgotCQkrIDMgLy9jaGFubmVsCisJCSsgMyAvKiBjaGFubmVs
ICovCiAJCSsgcmF0ZV9sZW4KIAkJKyByYXRlX2V4X2xlbgogCQkrIGF0aW1fbGVuCkBAIC03ODks
NyArNzk1LDcgQEAgc3RhdGljIHN0cnVjdCBza19idWZmICppZWVlODAyMTFfcHJvYmVfcmVzcChz
dHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgdTggKmQKCiAJaWYgKHdwYV9pZV9sZW4pIHsK
IAkJaWYgKGllZWUtPml3X21vZGUgPT0gSVdfTU9ERV9BREhPQykgewotCQkJLy9hcyBXaW5kb3dz
IHdpbGwgc2V0IHBhaXJ3aXNlIGtleSBzYW1lIGFzIHRoZSBncm91cCBrZXkgd2hpY2ggaXMgbm90
IGFsbG93ZWQgaW4gTGludXgsIHNvIHNldCB0aGlzIGZvciBJT1QgaXNzdWUuIFdCIDIwMDguMDcu
MDcKKwkJCS8qIGFzIFdpbmRvd3Mgd2lsbCBzZXQgcGFpcndpc2Uga2V5IHNhbWUgYXMgdGhlIGdy
b3VwIGtleSB3aGljaCBpcyBub3QgYWxsb3dlZCBpbiBMaW51eCwgc28gc2V0IHRoaXMgZm9yIElP
VCBpc3N1ZS4gV0IgMjAwOC4wNy4wNyAqLwogCQkJbWVtY3B5KCZpZWVlLT53cGFfaWVbMTRdLCAm
aWVlZS0+d3BhX2llWzhdLCA0KTsKIAkJfQogCQltZW1jcHkodGFnLCBpZWVlLT53cGFfaWUsIGll
ZWUtPndwYV9pZV9sZW4pOwpAQCAtOTQ2LDcgKzk1Miw3IEBAIGllZWU4MDIxMV9hc3NvY2lhdGlv
bl9yZXEoc3RydWN0IGllZWU4MDIxMV9uZXR3b3JrICpiZWFjb24sCiAJLy91MTYgc3VpdGVfY291
bnQgPSAwOwogCS8vdTggc3VpdF9zZWxlY3QgPSAwOwogCS8vdW5zaWduZWQgaW50IHdwYV9sZW4g
PSBiZWFjb24tPndwYV9pZV9sZW47Ci0JLy9mb3IgSFQKKwkvKiBmb3IgSFQgKi8KIAl1OCAqaHRf
Y2FwX2J1ZiA9IE5VTEw7CiAJdTggaHRfY2FwX2xlbiA9IDA7CiAJdTggKnJlYWx0ZWtfaWVfYnVm
ID0gTlVMTDsKQEAgLTEwMzMsMTggKzEwMzksMTggQEAgaWVlZTgwMjExX2Fzc29jaWF0aW9uX3Jl
cShzdHJ1Y3QgaWVlZTgwMjExX25ldHdvcmsgKmJlYWNvbiwKIAltZW1jcHkoaGRyLT5oZWFkZXIu
YWRkcjIsIGllZWUtPmRldi0+ZGV2X2FkZHIsIEVUSF9BTEVOKTsKIAltZW1jcHkoaGRyLT5oZWFk
ZXIuYWRkcjMsIGJlYWNvbi0+YnNzaWQsIEVUSF9BTEVOKTsKCi0JbWVtY3B5KGllZWUtPmFwX21h
Y19hZGRyLCBiZWFjb24tPmJzc2lkLCBFVEhfQUxFTik7Ly9mb3IgSFcgc2VjdXJpdHksIEpvaG4K
KwltZW1jcHkoaWVlZS0+YXBfbWFjX2FkZHIsIGJlYWNvbi0+YnNzaWQsIEVUSF9BTEVOKTsvKiBm
b3IgSFcgc2VjdXJpdHksIEpvaG4gKi8KCiAJaGRyLT5jYXBhYmlsaXR5ID0gY3B1X3RvX2xlMTYo
V0xBTl9DQVBBQklMSVRZX0JTUyk7CiAJaWYgKGJlYWNvbi0+Y2FwYWJpbGl0eSAmIFdMQU5fQ0FQ
QUJJTElUWV9QUklWQUNZKQogCQloZHItPmNhcGFiaWxpdHkgfD0gY3B1X3RvX2xlMTYoV0xBTl9D
QVBBQklMSVRZX1BSSVZBQ1kpOwoKIAlpZiAoYmVhY29uLT5jYXBhYmlsaXR5ICYgV0xBTl9DQVBB
QklMSVRZX1NIT1JUX1BSRUFNQkxFKQotCQloZHItPmNhcGFiaWxpdHkgfD0gY3B1X3RvX2xlMTYo
V0xBTl9DQVBBQklMSVRZX1NIT1JUX1BSRUFNQkxFKTsgLy9hZGQgc2hvcnRfcHJlYW1ibGUgaGVy
ZQorCQloZHItPmNhcGFiaWxpdHkgfD0gY3B1X3RvX2xlMTYoV0xBTl9DQVBBQklMSVRZX1NIT1JU
X1BSRUFNQkxFKTsgLyogYWRkIHNob3J0X3ByZWFtYmxlIGhlcmUgKi8KCiAJaWYgKGllZWUtPnNo
b3J0X3Nsb3QpCiAJCWhkci0+Y2FwYWJpbGl0eSB8PSBjcHVfdG9fbGUxNihXTEFOX0NBUEFCSUxJ
VFlfU0hPUlRfU0xPVCk7Ci0JaWYgKHdtbV9pbmZvX2xlbikgLy9RT1MKKwlpZiAod21tX2luZm9f
bGVuKSAvKiBRT1MgKi8KIAkJaGRyLT5jYXBhYmlsaXR5IHw9IGNwdV90b19sZTE2KFdMQU5fQ0FQ
QUJJTElUWV9RT1MpOwoKIAloZHItPmxpc3Rlbl9pbnRlcnZhbCA9IGNwdV90b19sZTE2KDB4YSk7
CkBAIC0xMDU4LDI0ICsxMDY0LDI2IEBAIGllZWU4MDIxMV9hc3NvY2lhdGlvbl9yZXEoc3RydWN0
IGllZWU4MDIxMV9uZXR3b3JrICpiZWFjb24sCgogCWllZWU4MDIxMV9NRklFX0JyYXRlKGllZWUs
ICZ0YWcpOwogCWllZWU4MDIxMV9NRklFX0dyYXRlKGllZWUsICZ0YWcpOwotCS8vIEZvciBDQ1gg
MSBTMTMsIENLSVAuIEFkZGVkIGJ5IEFubmllLCAyMDA2LTA4LTE0LgorCS8qIEZvciBDQ1ggMSBT
MTMsIENLSVAuIEFkZGVkIGJ5IEFubmllLCAyMDA2LTA4LTE0LiAqLwogCWlmIChiZWFjb24tPmJD
a2lwU3VwcG9ydGVkKSB7Ci0JCXN0YXRpYyB1OAlBaXJvbmV0SWVPdWlbXSA9IHsweDAwLCAweDAx
LCAweDY2fTsgLy8gIjQ1MDAtY2xpZW50IgorCQlzdGF0aWMgdTgJQWlyb25ldEllT3VpW10gPSB7
MHgwMCwgMHgwMSwgMHg2Nn07IC8qICI0NTAwLWNsaWVudCIgKi8KIAkJdTgJQ2N4QWlyb25ldEJ1
ZlszMF07CiAJCXN0cnVjdCBvY3RldF9zdHJpbmcJb3NDY3hBaXJvbmV0SUU7CgogCQltZW1zZXQo
Q2N4QWlyb25ldEJ1ZiwgMCwgMzApOwogCQlvc0NjeEFpcm9uZXRJRS5vY3RldCA9IENjeEFpcm9u
ZXRCdWY7CiAJCW9zQ2N4QWlyb25ldElFLmxlbmd0aCA9IHNpemVvZihDY3hBaXJvbmV0QnVmKTsK
LQkJLy8KLQkJLy8gUmVmLiBDQ1ggdGVzdCBwbGFuIHYzLjYxLCAzLjIuMy4xIHN0ZXAgMTMuCi0J
CS8vIFdlIHdhbnQgdG8gbWFrZSB0aGUgZGV2aWNlIHR5cGUgYXMgIjQ1MDAtY2xpZW50Ii4gMDYw
OTI2LCBieSBDQ1cuCi0JCS8vCisJCS8qCisJCSAqIFJlZi4gQ0NYIHRlc3QgcGxhbiB2My42MSwg
My4yLjMuMSBzdGVwIDEzLgorCQkgKiBXZSB3YW50IHRvIG1ha2UgdGhlIGRldmljZSB0eXBlIGFz
ICI0NTAwLWNsaWVudCIuIDA2MDkyNiwgYnkgQ0NXLgorCQkgKi8KIAkJbWVtY3B5KG9zQ2N4QWly
b25ldElFLm9jdGV0LCBBaXJvbmV0SWVPdWksIHNpemVvZihBaXJvbmV0SWVPdWkpKTsKCi0JCS8v
IENDWDEgc3BlYyBWMS4xMywgQTAxLjEgQ0tJUCBOZWdvdGlhdGlvbiAocGFnZTIzKToKLQkJLy8g
IlRoZSBDS0lQIG5lZ290aWF0aW9uIGlzIHN0YXJ0ZWQgd2l0aCB0aGUgYXNzb2NpYXRlIHJlcXVl
c3QgZnJvbSB0aGUgY2xpZW50IHRvIHRoZSBhY2Nlc3MgcG9pbnQsCi0JCS8vICBjb250YWluaW5n
IGFuIEFpcm9uZXQgZWxlbWVudCB3aXRoIGJvdGggdGhlIE1JQyBhbmQgS1AgYml0cyBzZXQuIgor
CQkvKgorCQkgKiBDQ1gxIHNwZWMgVjEuMTMsIEEwMS4xIENLSVAgTmVnb3RpYXRpb24gKHBhZ2Uy
Myk6CisJCSAqICJUaGUgQ0tJUCBuZWdvdGlhdGlvbiBpcyBzdGFydGVkIHdpdGggdGhlIGFzc29j
aWF0ZSByZXF1ZXN0IGZyb20gdGhlIGNsaWVudCB0byB0aGUgYWNjZXNzIHBvaW50LAorCQkgKiAg
Y29udGFpbmluZyBhbiBBaXJvbmV0IGVsZW1lbnQgd2l0aCBib3RoIHRoZSBNSUMgYW5kIEtQIGJp
dHMgc2V0LiIKKwkJICovCiAJCW9zQ2N4QWlyb25ldElFLm9jdGV0W0lFX0NJU0NPX0ZMQUdfUE9T
SVRJT05dIHw9IChTVVBQT1JUX0NLSVBfUEsgfCBTVVBQT1JUX0NLSVBfTUlDKTsKIAkJdGFnID0g
c2tiX3B1dChza2IsIGNraXBfaWVfbGVuKTsKIAkJKnRhZysrID0gTUZJRV9UWVBFX0FJUk9ORVQ7
CkBAIC0xMTA5LDcgKzExMTcsNyBAQCBpZWVlODAyMTFfYXNzb2NpYXRpb25fcmVxKHN0cnVjdCBp
ZWVlODAyMTFfbmV0d29yayAqYmVhY29uLAogCQltZW1jcHkodGFnLCBvc0NjeFZlck51bS5vY3Rl
dCwgb3NDY3hWZXJOdW0ubGVuZ3RoKTsKIAkJdGFnICs9IG9zQ2N4VmVyTnVtLmxlbmd0aDsKIAl9
Ci0JLy9IVCBjYXAgZWxlbWVudAorCS8qIEhUIGNhcCBlbGVtZW50ICovCiAJaWYgKGllZWUtPnBI
VEluZm8tPmJDdXJyZW50SFRTdXBwb3J0ICYmIGllZWUtPnBIVEluZm8tPmJFbmFibGVIVCkgewog
CQlpZiAoaWVlZS0+cEhUSW5mby0+ZVBlZXJIVFNwZWNWZXIgIT0gSFRfU1BFQ19WRVJfRVdDKSB7
CiAJCQl0YWcgPSBza2JfcHV0KHNrYiwgaHRfY2FwX2xlbik7CkBAIC0xMTIwLDcgKzExMjgsNyBA
QCBpZWVlODAyMTFfYXNzb2NpYXRpb25fcmVxKHN0cnVjdCBpZWVlODAyMTFfbmV0d29yayAqYmVh
Y29uLAogCQl9CiAJfQoKLQkvL2Nob29zZSB3aGF0IHdwYV9zdXBwbGljYW50IGdpdmVzIHRvIGFz
c29jaWF0ZS4KKwkvKiBjaG9vc2Ugd2hhdCB3cGFfc3VwcGxpY2FudCBnaXZlcyB0byBhc3NvY2lh
dGUuICovCiAJaWYgKHdwYV9pZV9sZW4pCiAJCXNrYl9wdXRfZGF0YShza2IsIGllZWUtPndwYV9p
ZSwgd3BhX2llX2xlbik7CgpAQCAtMTE2Myw3ICsxMTcxLDggQEAgdm9pZCBpZWVlODAyMTFfYXNz
b2NpYXRlX2Fib3J0KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlKQoKIAlpZWVlLT5hc3Nv
Y2lhdGVfc2VxKys7CgotCS8qIGRvbid0IHNjYW4sIGFuZCBhdm9pZCB0byBoYXZlIHRoZSBSWCBw
YXRoIHBvc3NpYmlseQorCS8qCisJICogZG9uJ3Qgc2NhbiwgYW5kIGF2b2lkIHRvIGhhdmUgdGhl
IFJYIHBhdGggcG9zc2liaWx5CiAJICogdHJ5IGFnYWluIHRvIGFzc29jaWF0ZS4gRXZlbiBkbyBu
b3QgcmVhY3QgdG8gQVVUSCBvcgogCSAqIEFTU09DIHJlc3BvbnNlLiBKdXN0IHdhaXQgZm9yIHRo
ZSByZXRyeSB3cSB0byBiZSBzY2hlZHVsZWQuCiAJICogSGVyZSB3ZSB3aWxsIGNoZWNrIGlmIHRo
ZXJlIGFyZSBnb29kIG5ldHMgdG8gYXNzb2NpYXRlCkBAIC0xMjA4LDcgKzEyMTcsNyBAQCBzdGF0
aWMgdm9pZCBpZWVlODAyMTFfYXNzb2NpYXRlX3N0ZXAxKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNl
ICppZWVlKQogCQlpZWVlLT5zdGF0ZSA9IElFRUU4MDIxMV9BU1NPQ0lBVElOR19BVVRIRU5USUNB
VElORzsKIAkJSUVFRTgwMjExX0RFQlVHX01HTVQoIlNlbmRpbmcgYXV0aGVudGljYXRpb24gcmVx
dWVzdFxuIik7CiAJCXNvZnRtYWNfbWdtdF94bWl0KHNrYiwgaWVlZSk7Ci0JCS8vQlVHT04gd2hl
biB5b3UgdHJ5IHRvIGFkZF90aW1lciB0d2ljZSwgdXNpbmcgbW9kX3RpbWVyIG1heSBiZSBiZXR0
ZXIsIGpvaG4wNzA5CisJCS8qIEJVR09OIHdoZW4geW91IHRyeSB0byBhZGRfdGltZXIgdHdpY2Us
IHVzaW5nIG1vZF90aW1lciBtYXkgYmUgYmV0dGVyLCBqb2huMDcwOSAqLwogCQlpZiAoIXRpbWVy
X3BlbmRpbmcoJmllZWUtPmFzc29jaWF0ZV90aW1lcikpIHsKIAkJCWllZWUtPmFzc29jaWF0ZV90
aW1lci5leHBpcmVzID0gamlmZmllcyArIChIWiAvIDIpOwogCQkJYWRkX3RpbWVyKCZpZWVlLT5h
c3NvY2lhdGVfdGltZXIpOwpAQCAtMTI4OSw3ICsxMjk4LDcgQEAgc3RhdGljIHZvaWQgaWVlZTgw
MjExX2Fzc29jaWF0ZV9jb21wbGV0ZV93cShzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJCS8v
SFRTZXRDb25uZWN0QndNb2RlKGllZWUsIEhUX0NIQU5ORUxfV0lEVEhfMjAsIEhUX0VYVENITkxf
T0ZGU0VUX05PX0VYVCk7CiAJfQogCWllZWUtPkxpbmtEZXRlY3RJbmZvLlNsb3ROdW0gPSAyICog
KDEgKyBpZWVlLT5jdXJyZW50X25ldHdvcmsuYmVhY29uX2ludGVydmFsIC8gNTAwKTsKLQkvLyBU
byBwcmV2ZW50IHRoZSBpbW1lZGlhdGVseSBjYWxsaW5nIHdhdGNoX2RvZyBhZnRlciBhc3NvY2lh
dGlvbi4KKwkvKiBUbyBwcmV2ZW50IHRoZSBpbW1lZGlhdGVseSBjYWxsaW5nIHdhdGNoX2RvZyBh
ZnRlciBhc3NvY2lhdGlvbi4gKi8KIAlpZiAoaWVlZS0+TGlua0RldGVjdEluZm8uTnVtUmVjdkJj
bkluUGVyaW9kID09IDAgfHwgaWVlZS0+TGlua0RldGVjdEluZm8uTnVtUmVjdkRhdGFJblBlcmlv
ZCA9PSAwKSB7CiAJCWllZWUtPkxpbmtEZXRlY3RJbmZvLk51bVJlY3ZCY25JblBlcmlvZCA9IDE7
CiAJCWllZWUtPkxpbmtEZXRlY3RJbmZvLk51bVJlY3ZEYXRhSW5QZXJpb2QgPSAxOwpAQCAtMTM0
Niw3ICsxMzU1LDggQEAgaW5saW5lIHZvaWQgaWVlZTgwMjExX3NvZnRtYWNfbmV3X25ldChzdHJ1
Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0IGllZWUKCiAJc2hvcnQgYXBzZXQsIHNz
aWRzZXQsIHNzaWRicm9hZCwgYXBtYXRjaCwgc3NpZG1hdGNoOwoKLQkvKiB3ZSBhcmUgaW50ZXJl
c3RlZCBpbiBuZXcgbmV3IG9ubHkgaWYgd2UgYXJlIG5vdCBhc3NvY2lhdGVkCisJLyoKKwkgKiB3
ZSBhcmUgaW50ZXJlc3RlZCBpbiBuZXcgbmV3IG9ubHkgaWYgd2UgYXJlIG5vdCBhc3NvY2lhdGVk
CiAJICogYW5kIHdlIGFyZSBub3QgYXNzb2NpYXRpbmcgLyBhdXRoZW50aWNhdGluZwogCSAqLwog
CWlmIChpZWVlLT5zdGF0ZSAhPSBJRUVFODAyMTFfTk9MSU5LKQpAQCAtMTM1OSw3ICsxMzY5LDgg
QEAgaW5saW5lIHZvaWQgaWVlZTgwMjExX3NvZnRtYWNfbmV3X25ldChzdHJ1Y3QgaWVlZTgwMjEx
X2RldmljZSAqaWVlZSwgc3RydWN0IGllZWUKIAkJcmV0dXJuOwoKIAlpZiAoaWVlZS0+aXdfbW9k
ZSA9PSBJV19NT0RFX0lORlJBIHx8IGllZWUtPml3X21vZGUgPT0gSVdfTU9ERV9BREhPQykgewot
CQkvKiBpZiB0aGUgdXNlciBzcGVjaWZpZWQgdGhlIEFQIE1BQywgd2UgbmVlZCBhbHNvIHRoZSBl
c3NpZAorCQkvKgorCQkgKiBpZiB0aGUgdXNlciBzcGVjaWZpZWQgdGhlIEFQIE1BQywgd2UgbmVl
ZCBhbHNvIHRoZSBlc3NpZAogCQkgKiBUaGlzIGNvdWxkIGJlIG9idGFpbmVkIGJ5IGJlYWNvbnMg
b3IsIGlmIHRoZSBuZXR3b3JrIGRvZXMgbm90CiAJCSAqIGJyb2FkY2FzdCBpdCwgaXQgY2FuIGJl
IHB1dCBtYW51YWxseS4KIAkJICovCkBAIC0xMzcwLDE4ICsxMzgxLDIxIEBAIGlubGluZSB2b2lk
IGllZWU4MDIxMV9zb2Z0bWFjX25ld19uZXQoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUs
IHN0cnVjdCBpZWVlCiAJCXNzaWRtYXRjaCA9IChpZWVlLT5jdXJyZW50X25ldHdvcmsuc3NpZF9s
ZW4gPT0gbmV0LT5zc2lkX2xlbikgJiYKIAkJCSghc3RybmNtcChpZWVlLT5jdXJyZW50X25ldHdv
cmsuc3NpZCwgbmV0LT5zc2lkLCBuZXQtPnNzaWRfbGVuKSk7CgotCQkvKiBpZiB0aGUgdXNlciBz
ZXQgdGhlIEFQIGNoZWNrIGlmIG1hdGNoLgorCQkvKgorCQkgKiBpZiB0aGUgdXNlciBzZXQgdGhl
IEFQIGNoZWNrIGlmIG1hdGNoLgogCQkgKiBpZiB0aGUgbmV0d29yayBkb2VzIG5vdCBicm9hZGNh
c3QgZXNzaWQgd2UgY2hlY2sgdGhlIHVzZXIgc3VwcGx5ZWQgQU5ZIGVzc2lkCiAJCSAqIGlmIHRo
ZSBuZXR3b3JrIGRvZXMgYnJvYWRjYXN0IGFuZCB0aGUgdXNlciBkb2VzIG5vdCBzZXQgZXNzaWQg
aXQgaXMgT0sKIAkJICogaWYgdGhlIG5ldHdvcmsgZG9lcyBicm9hZGNhc3QgYW5kIHRoZSB1c2Vy
IGRpZCBzZXQgZXNzaWQgY2hlY2ggaWYgZXNzaWQgbWF0Y2gKIAkJICovCiAJCWlmICgoYXBzZXQg
JiYgYXBtYXRjaCAmJgogCQkgICAgICgoc3NpZHNldCAmJiBzc2lkYnJvYWQgJiYgc3NpZG1hdGNo
KSB8fCAoc3NpZGJyb2FkICYmICFzc2lkc2V0KSB8fCAoIXNzaWRicm9hZCAmJiBzc2lkc2V0KSkp
IHx8Ci0JCSAgICAvKiBpZiB0aGUgYXAgaXMgbm90IHNldCwgY2hlY2sgdGhhdCB0aGUgdXNlciBz
ZXQgdGhlIGJzc2lkCisJCSAgICAvKgorCQkgICAgICogaWYgdGhlIGFwIGlzIG5vdCBzZXQsIGNo
ZWNrIHRoYXQgdGhlIHVzZXIgc2V0IHRoZSBic3NpZAogCQkgICAgICogYW5kIHRoZSBuZXR3b3Jr
IGRvZXMgYnJvYWRjYXN0IGFuZCB0aGF0IHRob3NlIHR3byBic3NpZCBtYXRjaGVzCiAJCSAgICAg
Ki8KIAkJICAgICghYXBzZXQgJiYgc3NpZHNldCAmJiBzc2lkYnJvYWQgJiYgc3NpZG1hdGNoKSkg
ewotCQkJLyogaWYgdGhlIGVzc2lkIGlzIGhpZGRlbiByZXBsYWNlIGl0IHdpdGggdGhlCisJCQkv
KgorCQkJICogaWYgdGhlIGVzc2lkIGlzIGhpZGRlbiByZXBsYWNlIGl0IHdpdGggdGhlCiAJCQkg
KiBlc3NpZCBwcm92aWRlZCBieSB0aGUgdXNlci4KIAkJCSAqLwogCQkJaWYgKCFzc2lkYnJvYWQp
IHsKQEAgLTE0MDQsNyArMTQxOCw3IEBAIGlubGluZSB2b2lkIGllZWU4MDIxMV9zb2Z0bWFjX25l
d19uZXQoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHN0cnVjdCBpZWVlCiAJCQlpZiAo
aWVlZS0+aXdfbW9kZSA9PSBJV19NT0RFX0lORlJBKSB7CiAJCQkJLyogSm9pbiB0aGUgbmV0d29y
ayBmb3IgdGhlIGZpcnN0IHRpbWUgKi8KIAkJCQlpZWVlLT5Bc29jUmV0cnlDb3VudCA9IDA7Ci0J
CQkJLy9mb3IgSFQgYnkgYW15IDA4MDUxNAorCQkJCS8qIGZvciBIVCBieSBhbXkgMDgwNTE0ICov
CiAJCQkJaWYgKChpZWVlLT5jdXJyZW50X25ldHdvcmsucW9zX2RhdGEuc3VwcG9ydGVkID09IDEp
ICYmCiAJCQkJICAgIC8vIChpZWVlLT5wSFRJbmZvLT5iRW5hYmxlSFQgJiYgaWVlZS0+Y3VycmVu
dF9uZXR3b3JrLmJzc2h0LmJkU3VwcG9ydEhUKSkKIAkJCQkgICAgaWVlZS0+Y3VycmVudF9uZXR3
b3JrLmJzc2h0LmJkU3VwcG9ydEhUKSB7CkBAIC0xNDQ0LDcgKzE0NTgsOCBAQCB2b2lkIGllZWU4
MDIxMV9zb2Z0bWFjX2NoZWNrX2FsbF9uZXRzKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVl
KQogCXNwaW5fbG9ja19pcnFzYXZlKCZpZWVlLT5sb2NrLCBmbGFncyk7CgogCWxpc3RfZm9yX2Vh
Y2hfZW50cnkodGFyZ2V0LCAmaWVlZS0+bmV0d29ya19saXN0LCBsaXN0KSB7Ci0JCS8qIGlmIHRo
ZSBzdGF0ZSBiZWNvbWUgZGlmZmVyZW50IHRoYXQgTk9MSU5LIG1lYW5zCisJCS8qCisJCSAqIGlm
IHRoZSBzdGF0ZSBiZWNvbWUgZGlmZmVyZW50IHRoYXQgTk9MSU5LIG1lYW5zCiAJCSAqIHdlIGhh
ZCBmb3VuZCB3aGF0IHdlIGFyZSBzZWFyY2hpbmcgZm9yCiAJCSAqLwoKQEAgLTE2MjQsNyArMTYz
OSw3IEBAIGllZWU4MDIxMV9yeF9hc3NvY19ycShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVl
ZSwgc3RydWN0IHNrX2J1ZmYgKnNrYikKIAkJaWVlZTgwMjExX3Jlc3BfdG9fYXNzb2NfcnEoaWVl
ZSwgZGVzdCk7CgogCXByaW50ayhLRVJOX0lORk8iTmV3IGNsaWVudCBhc3NvY2lhdGVkOiAlcE1c
biIsIGRlc3QpOwotCS8vRklYTUUKKwkvKiBGSVhNRSAqLwogfQoKIHN0YXRpYyB2b2lkIGllZWU4
MDIxMV9zdGFfcHNfc2VuZF9udWxsX2ZyYW1lKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVl
LApAQCAtMTY1MSw3ICsxNjY2LDcgQEAgc3RhdGljIHNob3J0IGllZWU4MDIxMV9zdGFfcHNfc2xl
ZXAoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHUzMiAqdGltZV9oLAogCWR0aW0gPSBp
ZWVlLT5jdXJyZW50X25ldHdvcmsuZHRpbV9kYXRhOwogCWlmICghKGR0aW0gJiBJRUVFODAyMTFf
RFRJTV9WQUxJRCkpCiAJCXJldHVybiAwOwotCXRpbWVvdXQgPSBpZWVlLT5jdXJyZW50X25ldHdv
cmsuYmVhY29uX2ludGVydmFsOyAvL3Nob3VsZCB3ZSB1c2UgcHNfdGltZW91dCB2YWx1ZSBvciBi
ZWFjb25faW50ZXJ2YWwKKwl0aW1lb3V0ID0gaWVlZS0+Y3VycmVudF9uZXR3b3JrLmJlYWNvbl9p
bnRlcnZhbDsgLyogc2hvdWxkIHdlIHVzZSBwc190aW1lb3V0IHZhbHVlIG9yIGJlYWNvbl9pbnRl
cnZhbCAqLwogCWllZWUtPmN1cnJlbnRfbmV0d29yay5kdGltX2RhdGEgPSBJRUVFODAyMTFfRFRJ
TV9JTlZBTElEOwoKIAlpZiAoZHRpbSAmICgoSUVFRTgwMjExX0RUSU1fVUNBU1QgfCBJRUVFODAy
MTFfRFRJTV9NQkNBU1QpICYgaWVlZS0+cHMpKQpAQCAtMTY5Niw3ICsxNzExLDcgQEAgc3RhdGlj
IGlubGluZSB2b2lkIGllZWU4MDIxMV9zdGFfcHMoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmll
ZWUpCiAJaWYgKChpZWVlLT5wcyA9PSBJRUVFODAyMTFfUFNfRElTQUJMRUQgfHwKIAkgICAgIGll
ZWUtPml3X21vZGUgIT0gSVdfTU9ERV9JTkZSQSB8fAogCSAgICAgaWVlZS0+c3RhdGUgIT0gSUVF
RTgwMjExX0xJTktFRCkpIHsKLQkJLy8JI3dhcm5pbmcgQ0hFQ0tfTE9DS19IRVJFCisJCS8qIAkj
d2FybmluZyBDSEVDS19MT0NLX0hFUkUgKi8KIAkJc3Bpbl9sb2NrX2lycXNhdmUoJmllZWUtPm1n
bXRfdHhfbG9jaywgZmxhZ3MyKTsKCiAJCWllZWU4MDIxMV9zdGFfd2FrZXVwKGllZWUsIDEpOwpA
QCAtMTcyOSw3ICsxNzQ0LDcgQEAgc3RhdGljIGlubGluZSB2b2lkIGllZWU4MDIxMV9zdGFfcHMo
c3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpCiAJCQlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCZpZWVlLT5tZ210X3R4X2xvY2ssIGZsYWdzMik7CiAJCX0KIAl9IGVsc2UgaWYgKHNsZWVwID09
IDIpIHsKLS8vI3dhcm5pbmcgQ0hFQ0tfTE9DS19IRVJFCisvKiAjd2FybmluZyBDSEVDS19MT0NL
X0hFUkUgKi8KIAkJc3Bpbl9sb2NrX2lycXNhdmUoJmllZWUtPm1nbXRfdHhfbG9jaywgZmxhZ3My
KTsKCiAJCWllZWU4MDIxMV9zdGFfd2FrZXVwKGllZWUsIDEpOwpAQCAtMTc3NCw3ICsxNzg5LDgg
QEAgdm9pZCBpZWVlODAyMTFfcHNfdHhfYWNrKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVl
LCBzaG9ydCBzdWNjZXNzKQogCQkJaWVlZS0+c3RhX3NsZWVwID0gMTsKIAkJCWllZWUtPmVudGVy
X3NsZWVwX3N0YXRlKGllZWUtPmRldiwgaWVlZS0+cHNfdGgsIGllZWUtPnBzX3RsKTsKIAkJfQot
CQkvKiBpZiB0aGUgY2FyZCByZXBvcnQgbm90IHN1Y2Nlc3Mgd2UgY2FuJ3QgYmUgc3VyZSB0aGUg
QVAKKwkJLyoKKwkJICogaWYgdGhlIGNhcmQgcmVwb3J0IG5vdCBzdWNjZXNzIHdlIGNhbid0IGJl
IHN1cmUgdGhlIEFQCiAJCSAqIGhhcyBub3QgUlhlZCBzbyB3ZSBjYW4ndCBhc3N1bWUgdGhlIEFQ
IGJlbGlldmUgdXMgYXdha2UKIAkJICovCiAJfSBlbHNlIHsKQEAgLTE5MjUsNyArMTk0MSw3IEBA
IGllZWU4MDIxMV9yeF9mcmFtZV9zb2Z0bWFjKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVl
LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQkJCQkJCQkgICAgICAgbmV0d29yaywgcnhfc3RhdHMp
KSB7CiAJCQkJCQlyZXR1cm4gMTsKIAkJCQkJfSBlbHNlIHsKLQkJCQkJCS8vZmlsbGluZyB0aGUg
UGVlckhUQ2FwLiAvL21heWJlIG5vdCBuZWNlc3NhcnkgYXMgd2UgY2FuIGdldCBpdHMgaW5mbyBm
cm9tIGN1cnJlbnRfbmV0d29yay4KKwkJCQkJCS8qIGZpbGxpbmcgdGhlIFBlZXJIVENhcC4gbWF5
YmUgbm90IG5lY2Vzc2FyeSBhcyB3ZSBjYW4gZ2V0IGl0cyBpbmZvIGZyb20gY3VycmVudF9uZXR3
b3JrLiAqLwogCQkJCQkJbWVtY3B5KGllZWUtPnBIVEluZm8tPlBlZXJIVENhcEJ1ZiwgbmV0d29y
ay0+YnNzaHQuYmRIVENhcEJ1ZiwgbmV0d29yay0+YnNzaHQuYmRIVENhcExlbik7CiAJCQkJCQlt
ZW1jcHkoaWVlZS0+cEhUSW5mby0+UGVlckhUSW5mb0J1ZiwgbmV0d29yay0+YnNzaHQuYmRIVElu
Zm9CdWYsIG5ldHdvcmstPmJzc2h0LmJkSFRJbmZvTGVuKTsKIAkJCQkJfQpAQCAtMTk3OCw5ICsx
OTk0LDEwIEBAIGllZWU4MDIxMV9yeF9mcmFtZV9zb2Z0bWFjKHN0cnVjdCBpZWVlODAyMTFfZGV2
aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAoKIAljYXNlIElFRUU4MDIxMV9TVFlQRV9E
SVNBU1NPQzoKIAljYXNlIElFRUU4MDIxMV9TVFlQRV9ERUFVVEg6Ci0JCS8qIEZJWE1FIGZvciBu
b3cgcmVwZWF0IGFsbCB0aGUgYXNzb2NpYXRpb24gcHJvY2VkdXJlCi0JCSogYm90aCBmb3IgZGlz
YXNzb2NpYXRpb24gYW5kIGRlYXV0aGVudGljYXRpb24KLQkJKi8KKwkJLyoKKwkJICogRklYTUUg
Zm9yIG5vdyByZXBlYXQgYWxsIHRoZSBhc3NvY2lhdGlvbiBwcm9jZWR1cmUKKwkJICogYm90aCBm
b3IgZGlzYXNzb2NpYXRpb24gYW5kIGRlYXV0aGVudGljYXRpb24KKwkJICovCiAJCWlmICgoaWVl
ZS0+c29mdG1hY19mZWF0dXJlcyAmIElFRUVfU09GVE1BQ19BU1NPQ0lBVEUpICYmCiAJCSAgICBp
ZWVlLT5zdGF0ZSA9PSBJRUVFODAyMTFfTElOS0VEICYmCiAJCSAgICBpZWVlLT5pd19tb2RlID09
IElXX01PREVfSU5GUkEpIHsKQEAgLTIwMDQsNyArMjAyMSw4IEBAIGllZWU4MDIxMV9yeF9mcmFt
ZV9zb2Z0bWFjKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAq
c2tiLAogCXJldHVybiAwOwogfQoKLS8qIFRoZSBmb2xsb3dpbmcgYXJlIGZvciBhIHNpbXBsZXIg
VFggcXVldWUgbWFuYWdlbWVudC4KKy8qCisgKiBUaGUgZm9sbG93aW5nIGFyZSBmb3IgYSBzaW1w
bGVyIFRYIHF1ZXVlIG1hbmFnZW1lbnQuCiAgKiBJbnN0ZWFkIG9mIHVzaW5nIG5ldGlmX1tzdG9w
L3dha2VdX3F1ZXVlLCB0aGUgZHJpdmVyCiAgKiB3aWxsIHVzZSB0aGVzZSB0d28gZnVuY3Rpb25z
IChwbHVzIGEgcmVzZXQgb25lKSB0aGF0CiAgKiB3aWxsIGludGVybmFsbHkgY2FsbCB0aGUga2Vy
bmVsIG5ldGlmXyogYW5kIHRha2UgY2FyZQpAQCAtMjA1MSw3ICsyMDY5LDggQEAgdm9pZCBpZWVl
ODAyMTFfc29mdG1hY194bWl0KHN0cnVjdCBpZWVlODAyMTFfdHhiICp0eGIsIHN0cnVjdCBpZWVl
ODAyMTFfZGV2aWNlICoKIAkJICAgICghaWVlZS0+Y2hlY2tfbmljX2Vub3VnaF9kZXNjKGllZWUt
PmRldiwgcXVldWVfaW5kZXgpKSB8fCBcCiAJCSAgICAoaWVlZS0+cXVldWVfc3RvcCkpIHsKIAkJ
CS8qIGluc2VydCB0aGUgc2tiIHBhY2tldCB0byB0aGUgd2FpdCBxdWV1ZSAqLwotCQkJLyogYXMg
Zm9yIHRoZSBjb21wbGV0aW9uIGZ1bmN0aW9uLCBpdCBkb2VzIG5vdCBuZWVkCisJCQkvKgorCQkJ
ICogYXMgZm9yIHRoZSBjb21wbGV0aW9uIGZ1bmN0aW9uLCBpdCBkb2VzIG5vdCBuZWVkCiAJCQkg
KiB0byBjaGVjayBpdCBhbnkgbW9yZS4KIAkJCSAqICovCiAJCQkvL3ByaW50aygiZXJyb3I6bm8g
ZGVzY3JpcHRvciBsZWZ0QHF1ZXVlX2luZGV4ICVkXG4iLCBxdWV1ZV9pbmRleCk7CkBAIC0yMjA1
LDcgKzIyMjQsOCBAQCBzdGF0aWMgdm9pZCBpZWVlODAyMTFfc3RhcnRfaWJzc193cShzdHJ1Y3Qg
d29ya19zdHJ1Y3QgKndvcmspCiB7CiAJc3RydWN0IGRlbGF5ZWRfd29yayAqZHdvcmsgPSB0b19k
ZWxheWVkX3dvcmsod29yayk7CiAJc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUgPSBjb250
YWluZXJfb2YoZHdvcmssIHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlLCBzdGFydF9pYnNzX3dxKTsK
LQkvKiBpd2NvbmZpZyBtb2RlIGFkLWhvYyB3aWxsIHNjaGVkdWxlIHRoaXMgYW5kIHJldHVybgor
CS8qCisJICogaXdjb25maWcgbW9kZSBhZC1ob2Mgd2lsbCBzY2hlZHVsZSB0aGlzIGFuZCByZXR1
cm4KIAkgKiBvbiB0aGUgb3RoZXIgaGFuZCB0aGlzIHdpbGwgYmxvY2sgZnVydGhlciBpd2NvbmZp
ZyBTRVQKIAkgKiBvcGVyYXRpb25zIGJlY2F1c2Ugb2YgdGhlIHd4X211dGV4IGhvbGQuCiAJICog
QW55d2F5IHNvbWUgbW9zdCBzZXQgb3BlcmF0aW9ucyBzZXQgYSBmbGFnIHRvIHNwZWVkLXVwCkBA
IC0yMjMwLDcgKzIyNTAsOCBAQCBzdGF0aWMgdm9pZCBpZWVlODAyMTFfc3RhcnRfaWJzc193cShz
dHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAvLwlpZigoSVNfRE9UMTFEX0VOQUJMRShpZWVlKSkg
JiYgKGllZWUtPnN0YXRlID09IElFRUU4MDIxMV9OT0xJTkspKQogCWlmIChpZWVlLT5zdGF0ZSA9
PSBJRUVFODAyMTFfTk9MSU5LKQogCQlpZWVlLT5jdXJyZW50X25ldHdvcmsuY2hhbm5lbCA9IDY7
Ci0JLyogaWYgbm90IHRoZW4gdGhlIHN0YXRlIGlzIG5vdCBsaW5rZWQuIE1heWJlIHRoZSB1c2Vy
IHN3aXRjaGVkIHRvCisJLyoKKwkgKiBpZiBub3QgdGhlbiB0aGUgc3RhdGUgaXMgbm90IGxpbmtl
ZC4gTWF5YmUgdGhlIHVzZXIgc3dpdGNoZWQgdG8KIAkgKiBhZC1ob2MgbW9kZSBqdXN0IGFmdGVy
IGJlaW5nIGluIG1vbml0b3IgbW9kZSwgb3IganVzdCBhZnRlcgogCSAqIGJlaW5nIHZlcnkgZmV3
IHRpbWUgaW4gbWFuYWdlZCBtb2RlIChzbyB0aGUgY2FyZCBoYXZlIGhhZCBubwogCSAqIHRpbWUg
dG8gc2NhbiBhbGwgdGhlIGNoYW5zLi4pIG9yIHdlIGhhdmUganVzdCBydW4gdXAgdGhlIGlmYWNl
CkBAIC0yMjgxLDcgKzIzMDIsNyBAQCBzdGF0aWMgdm9pZCBpZWVlODAyMTFfc3RhcnRfaWJzc193
cShzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspCiAJCQlpZWVlLT5yYXRlID0gMjI7CiAJCX0KCi0J
CS8vIEJ5IGRlZmF1bHQsIFdNTSBmdW5jdGlvbiB3aWxsIGJlIGRpc2FibGVkIGluIElCU1MgbW9k
ZQorCQkvKiBCeSBkZWZhdWx0LCBXTU0gZnVuY3Rpb24gd2lsbCBiZSBkaXNhYmxlZCBpbiBJQlNT
IG1vZGUgKi8KIAkJaWVlZS0+Y3VycmVudF9uZXR3b3JrLlFvU19FbmFibGUgPSAwOwogCQlpZWVl
LT5TZXRXaXJlbGVzc01vZGUoaWVlZS0+ZGV2LCBJRUVFX0cpOwogCQlpZWVlLT5jdXJyZW50X25l
dHdvcmsuYXRpbV93aW5kb3cgPSAwOwpAQCAtMjMxNSwyMiArMjMzNiwyNCBAQCBpbmxpbmUgdm9p
ZCBpZWVlODAyMTFfc3RhcnRfaWJzcyhzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSkKIHZv
aWQgaWVlZTgwMjExX3N0YXJ0X2JzcyhzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSkKIHsK
IAl1bnNpZ25lZCBsb25nIGZsYWdzOwotCS8vCi0JLy8gUmVmOiA4MDIuMTFkIDExLjEuMy4zCi0J
Ly8gU1RBIHNoYWxsIG5vdCBzdGFydCBhIEJTUyB1bmxlc3MgcHJvcGVybHkgZm9ybWVkIEJlYWNv
biBmcmFtZSBpbmNsdWRpbmcgYSBDb3VudHJ5IElFLgotCS8vCisJLyoKKwkgKiBSZWY6IDgwMi4x
MWQgMTEuMS4zLjMKKwkgKiBTVEEgc2hhbGwgbm90IHN0YXJ0IGEgQlNTIHVubGVzcyBwcm9wZXJs
eSBmb3JtZWQgQmVhY29uIGZyYW1lIGluY2x1ZGluZyBhIENvdW50cnkgSUUuCisJICovCiAJaWYg
KElTX0RPVDExRF9FTkFCTEUoaWVlZSkgJiYgIUlTX0NPVU5UUllfSUVfVkFMSUQoaWVlZSkpIHsK
IAkJaWYgKCFpZWVlLT5iR2xvYmFsRG9tYWluKQogCQkJcmV0dXJuOwogCX0KLQkvKiBjaGVjayBp
ZiB3ZSBoYXZlIGFscmVhZHkgZm91bmQgdGhlIG5ldCB3ZQorCS8qCisJICogY2hlY2sgaWYgd2Ug
aGF2ZSBhbHJlYWR5IGZvdW5kIHRoZSBuZXQgd2UKIAkgKiBhcmUgaW50ZXJlc3RlZCBpbiAoaWYg
YW55KS4KIAkgKiBpZiBub3QgKHdlIGFyZSBkaXNhc3NvY2lhdGVkIGFuZCB3ZSBhcmUgbm90CiAJ
ICogaW4gYXNzb2NpYXRpbmcgLyBhdXRoZW50aWNhdGluZyBwaGFzZSkgc3RhcnQgdGhlIGJhY2tn
cm91bmQgc2Nhbm5pbmcuCiAJICovCiAJaWVlZTgwMjExX3NvZnRtYWNfY2hlY2tfYWxsX25ldHMo
aWVlZSk7CgotCS8qIGVuc3VyZSBuby1vbmUgc3RhcnQgYW4gYXNzb2NpYXRpbmcgcHJvY2VzcyAo
dGh1cyBzZXR0aW5nCisJLyoKKwkgKiBlbnN1cmUgbm8tb25lIHN0YXJ0IGFuIGFzc29jaWF0aW5n
IHByb2Nlc3MgKHRodXMgc2V0dGluZwogCSAqIHRoZSBpZWVlLT5zdGF0ZSB0byBpZWVlODAyMTFf
QVNTT0NJQVRJTkcpIHdoaWxlIHdlCiAJICogaGF2ZSBqdXN0IGNoZWtlZCBpdCBhbmQgd2UgYXJl
IGdvaW5nIHRvIGVuYWJsZSBzY2FuLgogCSAqIFRoZSBpZWVlODAyMTFfbmV3X25ldCBmdW5jdGlv
biBpcyBhbHdheXMgY2FsbGVkIHdpdGgKQEAgLTIzNzgsMTkgKzI0MDEsMjAgQEAgc3RhdGljIHZv
aWQgaWVlZTgwMjExX2Fzc29jaWF0ZV9yZXRyeV93cShzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmsp
CiAJaWYgKGllZWUtPnN0YXRlICE9IElFRUU4MDIxMV9BU1NPQ0lBVElOR19SRVRSWSkKIAkJZ290
byBleGl0OwoKLQkvKiB1bnRpbCB3ZSBkbyBub3Qgc2V0IHRoZSBzdGF0ZSB0byBJRUVFODAyMTFf
Tk9MSU5LCi0JKiB0aGVyZSBhcmUgbm8gcG9zc2liaWxpdHkgdG8gaGF2ZSBzb21lb25lIGVsc2Ug
dHJ5aW5nCi0JKiB0byBzdGFydCBhbiBhc3NvY2lhdGlvbiBwcm9jZWR1cmUgKHdlIGdldCBoZXJl
IHdpdGgKLQkqIGllZWUtPnN0YXRlID0gSUVFRTgwMjExX0FTU09DSUFUSU5HKS4KLQkqIFdoZW4g
d2Ugc2V0IHRoZSBzdGF0ZSB0byBJRUVFODAyMTFfTk9MSU5LIGl0IGlzIHBvc3NpYmxlCi0JKiB0
aGF0IHRoZSBSWCBwYXRoIHJ1biBhbiBhdHRlbXB0IHRvIGFzc29jaWF0ZSwgYnV0Ci0JKiBib3Ro
IGllZWU4MDIxMV9zb2Z0bWFjX2NoZWNrX2FsbF9uZXRzIGFuZCB0aGUKLQkqIFJYIHBhdGggd29y
a3Mgd2l0aCBpZWVlLT5sb2NrIGhlbGQgc28gdGhlcmUgYXJlIG5vCi0JKiBwcm9ibGVtcy4gSWYg
d2UgYXJlIHN0aWxsIGRpc2Fzc29jaWF0ZWQgdGhlbiBzdGFydCBhIHNjYW4uCi0JKiB0aGUgbG9j
ayBoZXJlIGlzIG5lY2Vzc2FyeSB0byBlbnN1cmUgbm8gb25lIHRyeSB0byBzdGFydAotCSogYW4g
YXNzb2NpYXRpb24gcHJvY2VkdXJlIHdoZW4gd2UgaGF2ZSBqdXN0IGNoZWNrZWQgdGhlCi0JKiBz
dGF0ZSBhbmQgd2UgYXJlIGdvaW5nIHRvIHN0YXJ0IHRoZSBzY2FuLgotCSovCisJLyoKKwkgKiB1
bnRpbCB3ZSBkbyBub3Qgc2V0IHRoZSBzdGF0ZSB0byBJRUVFODAyMTFfTk9MSU5LCisJICogdGhl
cmUgYXJlIG5vIHBvc3NpYmlsaXR5IHRvIGhhdmUgc29tZW9uZSBlbHNlIHRyeWluZworCSAqIHRv
IHN0YXJ0IGFuIGFzc29jaWF0aW9uIHByb2NlZHVyZSAod2UgZ2V0IGhlcmUgd2l0aAorCSAqIGll
ZWUtPnN0YXRlID0gSUVFRTgwMjExX0FTU09DSUFUSU5HKS4KKwkgKiBXaGVuIHdlIHNldCB0aGUg
c3RhdGUgdG8gSUVFRTgwMjExX05PTElOSyBpdCBpcyBwb3NzaWJsZQorCSAqIHRoYXQgdGhlIFJY
IHBhdGggcnVuIGFuIGF0dGVtcHQgdG8gYXNzb2NpYXRlLCBidXQKKwkgKiBib3RoIGllZWU4MDIx
MV9zb2Z0bWFjX2NoZWNrX2FsbF9uZXRzIGFuZCB0aGUKKwkgKiBSWCBwYXRoIHdvcmtzIHdpdGgg
aWVlZS0+bG9jayBoZWxkIHNvIHRoZXJlIGFyZSBubworCSAqIHByb2JsZW1zLiBJZiB3ZSBhcmUg
c3RpbGwgZGlzYXNzb2NpYXRlZCB0aGVuIHN0YXJ0IGEgc2Nhbi4KKwkgKiB0aGUgbG9jayBoZXJl
IGlzIG5lY2Vzc2FyeSB0byBlbnN1cmUgbm8gb25lIHRyeSB0byBzdGFydAorCSAqIGFuIGFzc29j
aWF0aW9uIHByb2NlZHVyZSB3aGVuIHdlIGhhdmUganVzdCBjaGVja2VkIHRoZQorCSAqIHN0YXRl
IGFuZCB3ZSBhcmUgZ29pbmcgdG8gc3RhcnQgdGhlIHNjYW4uCisJICovCiAJaWVlZS0+c3RhdGUg
PSBJRUVFODAyMTFfTk9MSU5LOwoKIAlpZWVlODAyMTFfc29mdG1hY19jaGVja19hbGxfbmV0cyhp
ZWVlKTsKQEAgLTI0NjgsNyArMjQ5Miw3IEBAIHZvaWQgaWVlZTgwMjExX3N0b3BfcHJvdG9jb2wo
c3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpCiAJaWVlZTgwMjExX3N0b3Bfc2NhbihpZWVl
KTsKCiAJaWVlZTgwMjExX2Rpc2Fzc29jaWF0ZShpZWVlKTsKLQlSZW1vdmVBbGxUUyhpZWVlKTsg
Ly9hZGRlZCBhcyB3ZSBkaXNjb25uZWN0IGZyb20gdGhlIHByZXZpb3VzIEJTUywgUmVtb3ZlIGFs
bCBUUworCVJlbW92ZUFsbFRTKGllZWUpOyAvKiBhZGRlZCBhcyB3ZSBkaXNjb25uZWN0IGZyb20g
dGhlIHByZXZpb3VzIEJTUywgUmVtb3ZlIGFsbCBUUyAqLwogfQoKIHZvaWQgaWVlZTgwMjExX3Nv
ZnRtYWNfc3RhcnRfcHJvdG9jb2woc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpCkBAIC0y
NTEwLDkgKzI1MzQsMTAgQEAgdm9pZCBpZWVlODAyMTFfc3RhcnRfcHJvdG9jb2woc3RydWN0IGll
ZWU4MDIxMV9kZXZpY2UgKmllZWUpCiAJCWllZWUtPmxhc3RfcGFja2V0X3RpbWVbaV0gPSAwOwog
CX0KCi0JaWVlZS0+aW5pdF93bW1wYXJhbV9mbGFnID0gMDsvL3JlaW5pdGlhbGl6ZSBBQ194eF9Q
QVJBTSByZWdpc3RlcnMuCisJaWVlZS0+aW5pdF93bW1wYXJhbV9mbGFnID0gMDsvKiByZWluaXRp
YWxpemUgQUNfeHhfUEFSQU0gcmVnaXN0ZXJzLiAqLwoKLQkvKiBpZiB0aGUgdXNlciBzZXQgdGhl
IE1BQyBvZiB0aGUgYWQtaG9jIGNlbGwgYW5kIHRoZW4KKwkvKgorCSAqIGlmIHRoZSB1c2VyIHNl
dCB0aGUgTUFDIG9mIHRoZSBhZC1ob2MgY2VsbCBhbmQgdGhlbgogCSAqIHN3aXRjaCB0byBtYW5h
Z2VkIG1vZGUsIHNoYWxsIHdlICBtYWtlIHN1cmUgdGhhdCBhc3NvY2lhdGlvbgogCSAqIGF0dGVt
cHRzIGRvZXMgbm90IGZhaWwganVzdCBiZWNhdXNlIHRoZSB1c2VyIHByb3ZpZGUgdGhlIGVzc2lk
CiAJICogYW5kIHRoZSBuaWMgaXMgc3RpbGwgY2hlY2tpbmcgZm9yIHRoZSBBUCBNQUMgPz8KQEAg
LTI1NDQsNyArMjU2OSw3IEBAIHZvaWQgaWVlZTgwMjExX3NvZnRtYWNfaW5pdChzdHJ1Y3QgaWVl
ZTgwMjExX2RldmljZSAqaWVlZSkKIAlpZWVlLT5kb3QxMWRfaW5mbyA9IGt6YWxsb2Moc2l6ZW9m
KHN0cnVjdCBydF9kb3QxMWRfaW5mbyksIEdGUF9LRVJORUwpOwogCWlmICghaWVlZS0+ZG90MTFk
X2luZm8pCiAJCUlFRUU4MDIxMV9ERUJVRyhJRUVFODAyMTFfRExfRVJSLCAiY2FuJ3QgYWxsb2Mg
bWVtb3J5IGZvciBET1QxMURcbiIpOwotCS8vYWRkZWQgZm9yICBBUCByb2FtaW5nCisJLyogYWRk
ZWQgZm9yICBBUCByb2FtaW5nICovCiAJaWVlZS0+TGlua0RldGVjdEluZm8uU2xvdE51bSA9IDI7
CiAJaWVlZS0+TGlua0RldGVjdEluZm8uTnVtUmVjdkJjbkluUGVyaW9kID0gMDsKIAlpZWVlLT5M
aW5rRGV0ZWN0SW5mby5OdW1SZWN2RGF0YUluUGVyaW9kID0gMDsKQEAgLTI1NTIsNyArMjU3Nyw3
IEBAIHZvaWQgaWVlZTgwMjExX3NvZnRtYWNfaW5pdChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAq
aWVlZSkKIAlpZWVlLT5hc3NvY19pZCA9IDA7CiAJaWVlZS0+cXVldWVfc3RvcCA9IDA7CiAJaWVl
ZS0+c2Nhbm5pbmcgPSAwOwotCWllZWUtPnNvZnRtYWNfZmVhdHVyZXMgPSAwOyAvL3NvIElFRUUy
MTAwLWxpa2UgZHJpdmVyIGFyZSBoYXBweQorCWllZWUtPnNvZnRtYWNfZmVhdHVyZXMgPSAwOyAv
KiBzbyBJRUVFMjEwMC1saWtlIGRyaXZlciBhcmUgaGFwcHkgKi8KIAlpZWVlLT53YXBfc2V0ID0g
MDsKIAlpZWVlLT5zc2lkX3NldCA9IDA7CiAJaWVlZS0+cHJvdG9fc3RhcnRlZCA9IDA7CkBAIC0y
NTYwLDEwICsyNTg1LDEwIEBAIHZvaWQgaWVlZTgwMjExX3NvZnRtYWNfaW5pdChzdHJ1Y3QgaWVl
ZTgwMjExX2RldmljZSAqaWVlZSkKIAlpZWVlLT5yYXRlID0gMjI7CiAJaWVlZS0+cHMgPSBJRUVF
ODAyMTFfUFNfRElTQUJMRUQ7CiAJaWVlZS0+c3RhX3NsZWVwID0gMDsKLQlpZWVlLT5SZWdkb3Qx
MUhUT3BlcmF0aW9uYWxSYXRlU2V0WzBdID0gMHhmZjsvL3N1cHBvcnQgTUNTIDB+NwotCWllZWUt
PlJlZ2RvdDExSFRPcGVyYXRpb25hbFJhdGVTZXRbMV0gPSAweGZmOy8vc3VwcG9ydCBNQ1MgOH4x
NQorCWllZWUtPlJlZ2RvdDExSFRPcGVyYXRpb25hbFJhdGVTZXRbMF0gPSAweGZmOy8qIHN1cHBv
cnQgTUNTIDB+NyAqLworCWllZWUtPlJlZ2RvdDExSFRPcGVyYXRpb25hbFJhdGVTZXRbMV0gPSAw
eGZmOy8qIHN1cHBvcnQgTUNTIDh+MTUgKi8KIAlpZWVlLT5SZWdkb3QxMUhUT3BlcmF0aW9uYWxS
YXRlU2V0WzRdID0gMHgwMTsKLQkvL2FkZGVkIGJ5IGFteQorCS8qIGFkZGVkIGJ5IGFteSAqLwog
CWllZWUtPmFjdHNjYW5uaW5nID0gZmFsc2U7CiAJaWVlZS0+YmVpbnJldHJ5ID0gZmFsc2U7CiAJ
aWVlZS0+aXNfc2V0X2tleSA9IGZhbHNlOwpAQCAtMjYzOSw3ICsyNjY0LDcgQEAgc3RhdGljIGlu
dCBpZWVlODAyMTFfd3BhX21sbWUoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIGludCBj
b21tYW5kLCBpbnQgcmUKCiAJc3dpdGNoIChjb21tYW5kKSB7CiAJY2FzZSBJRUVFX01MTUVfU1RB
X0RFQVVUSDoKLQkJLy8gc2lsZW50bHkgaWdub3JlCisJCS8qIHNpbGVudGx5IGlnbm9yZSAqLwog
CQlicmVhazsKCiAJY2FzZSBJRUVFX01MTUVfU1RBX0RJU0FTU09DOgpAQCAtMjcyOCw3ICsyNzUz
LDggQEAgc3RhdGljIGludCBpZWVlODAyMTFfd3BhX3NldF9wYXJhbShzdHJ1Y3QgaWVlZTgwMjEx
X2RldmljZSAqaWVlZSwgdTggbmFtZSwgdTMyIHYKIAkJYnJlYWs7CgogCWNhc2UgSUVFRV9QQVJB
TV9EUk9QX1VORU5DUllQVEVEOiB7Ci0JCS8qIEhBQ0s6CisJCS8qCisJCSAqIEhBQ0s6CiAJCSAq
CiAJCSAqIHdwYV9zdXBwbGljYW50IGNhbGxzIHNldF93cGFfZW5hYmxlZCB3aGVuIHRoZSBkcml2
ZXIKIAkJICogaXMgbG9hZGVkIGFuZCB1bmxvYWRlZCwgcmVnYXJkbGVzcyBvZiBpZiBXUEEgaXMg
YmVpbmcKQEAgLTI3NDQsNyArMjc3MCw4IEBAIHN0YXRpYyBpbnQgaWVlZTgwMjExX3dwYV9zZXRf
cGFyYW0oc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHU4IG5hbWUsIHUzMiB2CiAJCQku
ZW5hYmxlZCA9IHZhbHVlLAogCQl9OwogCQlpZWVlLT5kcm9wX3VuZW5jcnlwdGVkID0gdmFsdWU7
Ci0JCS8qIFdlIG9ubHkgY2hhbmdlIFNFQ19MRVZFTCBmb3Igb3BlbiBtb2RlLiBPdGhlcnMKKwkJ
LyoKKwkJICogV2Ugb25seSBjaGFuZ2UgU0VDX0xFVkVMIGZvciBvcGVuIG1vZGUuIE90aGVycwog
CQkgKiBhcmUgc2V0IGJ5IGlwd193cGFfc2V0X2VuY3J5cHRpb24uCiAJCSAqLwogCQlpZiAoIXZh
bHVlKSB7CkBAIC0yNzcxLDcgKzI3OTgsNyBAQCBzdGF0aWMgaW50IGllZWU4MDIxMV93cGFfc2V0
X3BhcmFtKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCB1OCBuYW1lLCB1MzIgdgogCQlp
ZWVlLT5pZWVlODAyXzF4ID0gdmFsdWU7CiAJCWJyZWFrOwogCWNhc2UgSUVFRV9QQVJBTV9XUEFY
X1NFTEVDVDoKLQkJLy8gYWRkZWQgZm9yIFdQQTIgbWl4ZWQgbW9kZQorCQkvKiBhZGRlZCBmb3Ig
V1BBMiBtaXhlZCBtb2RlICovCiAJCXNwaW5fbG9ja19pcnFzYXZlKCZpZWVlLT53cGF4X3N1aXRs
aXN0X2xvY2ssIGZsYWdzKTsKIAkJaWVlZS0+d3BheF90eXBlX3NldCA9IDE7CiAJCWllZWUtPndw
YXhfdHlwZV9ub3RpZnkgPSB2YWx1ZTsKQEAgLTI4MjEsNyArMjg0OCw3IEBAIHN0YXRpYyBpbnQg
aWVlZTgwMjExX3dwYV9zZXRfZW5jcnlwdGlvbihzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVl
ZSwKIAlpZiAoc3RyY21wKHBhcmFtLT51LmNyeXB0LmFsZywgIm5vbmUiKSA9PSAwKSB7CiAJCWlm
IChjcnlwdCkgewogCQkJc2VjLmVuYWJsZWQgPSAwOwotCQkJLy8gRklYTUUgRklYTUUKKwkJCS8q
IEZJWE1FIEZJWE1FICovCiAJCQkvL3NlYy5lbmNyeXB0ID0gMDsKIAkJCXNlYy5sZXZlbCA9IFNF
Q19MRVZFTF8wOwogCQkJc2VjLmZsYWdzIHw9IFNFQ19FTkFCTEVEIHwgU0VDX0xFVkVMOwpAQCAt
MjgzMCw3ICsyODU3LDcgQEAgc3RhdGljIGludCBpZWVlODAyMTFfd3BhX3NldF9lbmNyeXB0aW9u
KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAogCQlnb3RvIGRvbmU7CiAJfQogCXNlYy5l
bmFibGVkID0gMTsKLS8vIEZJWE1FIEZJWE1FCisvKiBGSVhNRSBGSVhNRSAqLwogLy8Jc2VjLmVu
Y3J5cHQgPSAxOwogCXNlYy5mbGFncyB8PSBTRUNfRU5BQkxFRDsKCkBAIC0yODM5LDcgKzI4NjYs
NyBAQCBzdGF0aWMgaW50IGllZWU4MDIxMV93cGFfc2V0X2VuY3J5cHRpb24oc3RydWN0IGllZWU4
MDIxMV9kZXZpY2UgKmllZWUsCiAJICAgIHN0cmNtcChwYXJhbS0+dS5jcnlwdC5hbGcsICJUS0lQ
IikpCiAJCWdvdG8gc2tpcF9ob3N0X2NyeXB0OwoKLQkvL3NldCBXRVA0MCBmaXJzdCwgaXQgd2ls
bCBiZSBtb2RpZmllZCBhY2NvcmRpbmcgdG8gV0VQMTA0IG9yIFdFUDQwIGF0IG90aGVyIHBsYWNl
CisJLyogc2V0IFdFUDQwIGZpcnN0LCBpdCB3aWxsIGJlIG1vZGlmaWVkIGFjY29yZGluZyB0byBX
RVAxMDQgb3IgV0VQNDAgYXQgb3RoZXIgcGxhY2UgKi8KIAlpZiAoIXN0cmNtcChwYXJhbS0+dS5j
cnlwdC5hbGcsICJXRVAiKSkKIAkJbW9kdWxlID0gImllZWU4MDIxMV9jcnlwdF93ZXAiOwogCWVs
c2UgaWYgKCFzdHJjbXAocGFyYW0tPnUuY3J5cHQuYWxnLCAiVEtJUCIpKQpAQCAtMjkxOSwxMSAr
Mjk0NiwxMyBAQCBzdGF0aWMgaW50IGllZWU4MDIxMV93cGFfc2V0X2VuY3J5cHRpb24oc3RydWN0
IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCiAJaWYgKGllZWUtPnNldF9zZWN1cml0eSkKIAkJaWVl
ZS0+c2V0X3NlY3VyaXR5KGllZWUtPmRldiwgJnNlYyk7CgotCS8qIERvIG5vdCByZXNldCBwb3J0
IGlmIGNhcmQgaXMgaW4gTWFuYWdlZCBtb2RlIHNpbmNlIHJlc2V0dGluZyB3aWxsCisJLyoKKwkg
KiBEbyBub3QgcmVzZXQgcG9ydCBpZiBjYXJkIGlzIGluIE1hbmFnZWQgbW9kZSBzaW5jZSByZXNl
dHRpbmcgd2lsbAogCSAqIGdlbmVyYXRlIG5ldyBJRUVFIDgwMi4xMSBhdXRoZW50aWNhdGlvbiB3
aGljaCBtYXkgZW5kIHVwIGluIGxvb3BpbmcKIAkgKiB3aXRoIElFRUUgODAyLjFYLiAgSWYgeW91
ciBoYXJkd2FyZSByZXF1aXJlcyBhIHJlc2V0IGFmdGVyIFdFUAogCSAqIGNvbmZpZ3VyYXRpb24g
KGZvciBleGFtcGxlLi4uIFByaXNtMiksIGltcGxlbWVudCB0aGUgcmVzZXRfcG9ydCBpbgotCSAq
IHRoZSBjYWxsYmFja3Mgc3RydWN0dXJlcyB1c2VkIHRvIGluaXRpYWxpemUgdGhlIDgwMi4xMSBz
dGFjay4gKi8KKwkgKiB0aGUgY2FsbGJhY2tzIHN0cnVjdHVyZXMgdXNlZCB0byBpbml0aWFsaXpl
IHRoZSA4MDIuMTEgc3RhY2suCisJICovCiAJaWYgKGllZWUtPnJlc2V0X29uX2tleWNoYW5nZSAm
JgogCSAgICBpZWVlLT5pd19tb2RlICE9IElXX01PREVfSU5GUkEgJiYKIAkgICAgaWVlZS0+cmVz
ZXRfcG9ydCAmJgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIx
MS9pZWVlODAyMTFfc29mdG1hY193eC5jIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4
MDIxMS9pZWVlODAyMTFfc29mdG1hY193eC5jCmluZGV4IGFhYjE1ODZmZTBkZC4uMmJmMzMzYzEy
YmJjIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4
MDIxMV9zb2Z0bWFjX3d4LmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIx
MS9pZWVlODAyMTFfc29mdG1hY193eC5jCkBAIC0xMTIsNyArMTEyLDcgQEAgaW50IGllZWU4MDIx
MV93eF9nZXRfd2FwKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAogCWlmIChpZWVlLT5p
d19tb2RlID09IElXX01PREVfTU9OSVRPUikKIAkJcmV0dXJuIC0xOwoKLQkvKiBXZSB3YW50IGF2
b2lkIHRvIGdpdmUgdG8gdGhlIHVzZXIgaW5jb25zaXN0ZW50IGluZm9zKi8KKwkvKiBXZSB3YW50
IGF2b2lkIHRvIGdpdmUgdG8gdGhlIHVzZXIgaW5jb25zaXN0ZW50IGluZm9zICovCiAJc3Bpbl9s
b2NrX2lycXNhdmUoJmllZWUtPmxvY2ssIGZsYWdzKTsKCiAJaWYgKGllZWUtPnN0YXRlICE9IElF
RUU4MDIxMV9MSU5LRUQgJiYKQEAgLTE1OSw3ICsxNTksOCBAQCBpbnQgaWVlZTgwMjExX3d4X3Nl
dF93YXAoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCiAJaWYgKGlmdXApCiAJCWllZWU4
MDIxMV9zdG9wX3Byb3RvY29sKGllZWUpOwoKLQkvKiBqdXN0IHRvIGF2b2lkIHRvIGdpdmUgaW5j
b25zaXN0ZW50IGluZm9zIGluIHRoZQorCS8qCisJICoganVzdCB0byBhdm9pZCB0byBnaXZlIGlu
Y29uc2lzdGVudCBpbmZvcyBpbiB0aGUKIAkgKiBnZXQgd3ggbWV0aG9kLiBub3QgcmVhbGx5IG5l
ZWRlZCBvdGhlcndpc2UKIAkgKi8KIAlzcGluX2xvY2tfaXJxc2F2ZSgmaWVlZS0+bG9jaywgZmxh
Z3MpOwpAQCAtNDA4LDcgKzQwOSw4IEBAIGludCBpZWVlODAyMTFfd3hfc2V0X2Vzc2lkKHN0cnVj
dCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAogCQlpZWVlODAyMTFfc3RvcF9wcm90b2NvbChpZWVl
KTsKCgotCS8qIHRoaXMgaXMganVzdCB0byBiZSBzdXJlIHRoYXQgdGhlIEdFVCB3eCBjYWxsYmFj
aworCS8qCisJICogdGhpcyBpcyBqdXN0IHRvIGJlIHN1cmUgdGhhdCB0aGUgR0VUIHd4IGNhbGxi
YWNrCiAJICogaGFzIGNvbnNpc3RlbiBpbmZvcy4gbm90IG5lZWRlZCBvdGhlcndpc2UKIAkgKi8K
IAlzcGluX2xvY2tfaXJxc2F2ZSgmaWVlZS0+bG9jaywgZmxhZ3MpOwpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9pZWVlODAyMTFfdHguYyBiL2RyaXZlcnMv
c3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX3R4LmMKaW5kZXggOGUxZWM0NDA5
YjRmLi5mNWM5OTFmNmQzNGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9p
ZWVlODAyMTEvaWVlZTgwMjExX3R4LmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2ll
ZWU4MDIxMS9pZWVlODAyMTFfdHguYwpAQCAtMTg4LDEyICsxODgsMTQgQEAgaW50IGllZWU4MDIx
MV9lbmNyeXB0X2ZyYWdtZW50KAogCQlyZXR1cm4gLTE7CiAJfQoKLQkvKiBUbyBlbmNyeXB0LCBm
cmFtZSBmb3JtYXQgaXM6CisJLyoKKwkgKiBUbyBlbmNyeXB0LCBmcmFtZSBmb3JtYXQgaXM6CiAJ
ICogSVYgKDQgYnl0ZXMpLCBjbGVhciBwYXlsb2FkIChpbmNsdWRpbmcgU05BUCksIElDViAoNCBi
eXRlcykKIAkgKi8KCi0JLy8gUFI6IEZJWE1FOiBDb3BpZWQgZnJvbSBob3N0YXAuIENoZWNrIGZy
YWdtZW50YXRpb24vTVNEVS9NUERVIGVuY3J5cHRpb24uCi0JLyogSG9zdC1iYXNlZCBJRUVFIDgw
Mi4xMSBmcmFnbWVudGF0aW9uIGZvciBUWCBpcyBub3QgeWV0IHN1cHBvcnRlZCwgc28KKwkvKiBQ
UjogRklYTUU6IENvcGllZCBmcm9tIGhvc3RhcC4gQ2hlY2sgZnJhZ21lbnRhdGlvbi9NU0RVL01Q
RFUgZW5jcnlwdGlvbi4gKi8KKwkvKgorCSAqIEhvc3QtYmFzZWQgSUVFRSA4MDIuMTEgZnJhZ21l
bnRhdGlvbiBmb3IgVFggaXMgbm90IHlldCBzdXBwb3J0ZWQsIHNvCiAJICogY2FsbCBib3RoIE1T
RFUgYW5kIE1QRFUgZW5jcnlwdGlvbiBmdW5jdGlvbnMgZnJvbSBoZXJlLgogCSAqLwogCWF0b21p
Y19pbmMoJmNyeXB0LT5yZWZjbnQpOwpAQCAtMjU1LDggKzI1Nyw4IEBAIHN0YXRpYyBzdHJ1Y3Qg
aWVlZTgwMjExX3R4YiAqaWVlZTgwMjExX2FsbG9jX3R4YihpbnQgbnJfZnJhZ3MsIGludCB0eGJf
c2l6ZSwKIAlyZXR1cm4gdHhiOwogfQoKLS8vIENsYXNzaWZ5IHRoZSB0by1iZSBzZW5kIGRhdGEg
cGFja2V0Ci0vLyBOZWVkIHRvIGFjcXVpcmUgdGhlIHNlbnQgcXVldWUgaW5kZXguCisvKiBDbGFz
c2lmeSB0aGUgdG8tYmUgc2VuZCBkYXRhIHBhY2tldCAqLworLyogTmVlZCB0byBhY3F1aXJlIHRo
ZSBzZW50IHF1ZXVlIGluZGV4LiAqLwogc3RhdGljIGludAogaWVlZTgwMjExX2NsYXNzaWZ5KHN0
cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBpZWVlODAyMTFfbmV0d29yayAqbmV0d29yaykKIHsK
QEAgLTMwMSwxMSArMzAzLDExIEBAIHN0YXRpYyB2b2lkIGllZWU4MDIxMV90eF9xdWVyeV9hZ2df
Y2FwKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAoKIAlpZiAoaXNfbXVsdGljYXN0X2V0
aGVyX2FkZHIoaGRyLT5hZGRyMSkpCiAJCXJldHVybjsKLQkvL2NoZWNrIHBhY2tldCBhbmQgbW9k
ZSBsYXRlcgorCS8qIGNoZWNrIHBhY2tldCBhbmQgbW9kZSBsYXRlciAqLwogI2lmZGVmIFRPX0RP
X0xJU1QKIAlpZiAocFRjYi0+UGFja2V0TGVuZ3RoID49IDQwOTYpCiAJCXJldHVybjsKLQkvLyBG
b3IgUlRMODE5WCwgaWYgcGFpcndpc2VrZXkgPSB3ZXAvdGtpcCwgd2UgZG9uJ3QgYWdncnJlZ2F0
aW9uLgorCS8qIEZvciBSVEw4MTlYLCBpZiBwYWlyd2lzZWtleSA9IHdlcC90a2lwLCB3ZSBkb24n
dCBhZ2dycmVnYXRpb24uICovCiAJaWYgKCFBZGFwdGVyLT5IYWxGdW5jLkdldE5tb2RlU3VwcG9y
dEJ5U2VjQ2ZnSGFuZGxlcihBZGFwdGVyKSkKIAkJcmV0dXJuOwogI2VuZGlmCkBAIC0zNjYsOCAr
MzY4LDggQEAgc3RhdGljIHZvaWQgaWVlZTgwMjExX3F1cmV5X1Nob3J0UHJlYW1ibGVNb2RlKHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAogCQkJCQkgICAgICBzdHJ1Y3QgY2JfZGVzYyAq
dGNiX2Rlc2MpCiB7CiAJdGNiX2Rlc2MtPmJVc2VTaG9ydFByZWFtYmxlID0gZmFsc2U7Ci0JaWYg
KHRjYl9kZXNjLT5kYXRhX3JhdGUgPT0gMikKLQl7Ly8vLyAxTSBjYW4gb25seSB1c2UgTG9uZyBQ
cmVhbWJsZS4gMTFCIHNwZWMKKwlpZiAodGNiX2Rlc2MtPmRhdGFfcmF0ZSA9PSAyKSB7CisJLyog
MU0gY2FuIG9ubHkgdXNlIExvbmcgUHJlYW1ibGUuIDExQiBzcGVjICovCiAJCXJldHVybjsKIAl9
CiAJZWxzZSBpZiAoaWVlZS0+Y3VycmVudF9uZXR3b3JrLmNhcGFiaWxpdHkgJiBXTEFOX0NBUEFC
SUxJVFlfU0hPUlRfUFJFQU1CTEUpCkBAIC00MTEsOSArNDEzLDkgQEAgc3RhdGljIHZvaWQgaWVl
ZTgwMjExX3F1ZXJ5X0JhbmR3aWR0aE1vZGUoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUs
CiAJaWYgKHRjYl9kZXNjLT5iTXVsdGljYXN0IHx8IHRjYl9kZXNjLT5iQnJvYWRjYXN0KQogCQly
ZXR1cm47CgotCWlmICgodGNiX2Rlc2MtPmRhdGFfcmF0ZSAmIDB4ODApPT0wKSAvLyBJZiB1c2lu
ZyBsZWdhY3kgcmF0ZSwgaXQgc2hhbGwgdXNlIDIwTUh6IGNoYW5uZWwuCisJaWYgKCh0Y2JfZGVz
Yy0+ZGF0YV9yYXRlICYgMHg4MCkgPT0gMCkgLyogSWYgdXNpbmcgbGVnYWN5IHJhdGUsIGl0IHNo
YWxsIHVzZSAyME1IeiBjaGFubmVsLiAqLwogCQlyZXR1cm47Ci0JLy9CYW5kV2lkdGhBdXRvU3dp
dGNoIGlzIGZvciBhdXRvIHN3aXRjaCB0byAyMCBvciA0MCBpbiBsb25nIGRpc3RhbmNlCisJLyog
QmFuZFdpZHRoQXV0b1N3aXRjaCBpcyBmb3IgYXV0byBzd2l0Y2ggdG8gMjAgb3IgNDAgaW4gbG9u
ZyBkaXN0YW5jZSAqLwogCWlmKHBIVEluZm8tPmJDdXJCVzQwTUh6ICYmIHBIVEluZm8tPmJDdXJU
eEJXNDBNSHogJiYgIWllZWUtPmJhbmR3aWR0aF9hdXRvX3N3aXRjaC5iZm9yY2VkX3R4MjBNaHop
CiAJCXRjYl9kZXNjLT5iUGFja2V0QlcgPSB0cnVlOwogCXJldHVybjsKQEAgLTQyMywyNSArNDI1
LDI3IEBAIHN0YXRpYyB2b2lkIGllZWU4MDIxMV9xdWVyeV9wcm90ZWN0aW9ubW9kZShzdHJ1Y3Qg
aWVlZTgwMjExX2RldmljZSAqaWVlZSwKIAkJCQkJICAgc3RydWN0IGNiX2Rlc2MgKnRjYl9kZXNj
LAogCQkJCQkgICBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQogewotCS8vIENvbW1vbiBTZXR0aW5ncwor
CS8qIENvbW1vbiBTZXR0aW5ncyAqLwogCXRjYl9kZXNjLT5iUlRTU1RCQwkJCT0gZmFsc2U7Ci0J
dGNiX2Rlc2MtPmJSVFNVc2VTaG9ydEdJCQk9IGZhbHNlOyAvLyBTaW5jZSBwcm90ZWN0aW9uIGZy
YW1lcyBhcmUgYWx3YXlzIHNlbnQgYnkgbGVnYWN5IHJhdGUsIFNob3J0R0kgd2lsbCBuZXZlciBi
ZSB1c2VkLgotCXRjYl9kZXNjLT5iQ1RTRW5hYmxlCQkJPSBmYWxzZTsgLy8gTW9zdCBvZiBwcm90
ZWN0aW9uIHVzaW5nIFJUUy9DVFMKLQl0Y2JfZGVzYy0+UlRTU0MJCQkJPSAwOwkJLy8gMjBNSHo6
IERvbid0IGNhcmU7ICA0ME1IejogRHVwbGljYXRlLgotCXRjYl9kZXNjLT5iUlRTQlcJCQk9IGZh
bHNlOyAvLyBSVFMgZnJhbWUgYmFuZHdpZHRoIGlzIGFsd2F5cyAyME1IegorCXRjYl9kZXNjLT5i
UlRTVXNlU2hvcnRHSQkJPSBmYWxzZTsgLyogU2luY2UgcHJvdGVjdGlvbiBmcmFtZXMgYXJlIGFs
d2F5cyBzZW50IGJ5IGxlZ2FjeSByYXRlLCBTaG9ydEdJIHdpbGwgbmV2ZXIgYmUgdXNlZC4gKi8K
Kwl0Y2JfZGVzYy0+YkNUU0VuYWJsZQkJCT0gZmFsc2U7IC8qIE1vc3Qgb2YgcHJvdGVjdGlvbiB1
c2luZyBSVFMvQ1RTICovCisJdGNiX2Rlc2MtPlJUU1NDCQkJCT0gMDsJCS8qIDIwTUh6OiBEb24n
dCBjYXJlOyAgNDBNSHo6IER1cGxpY2F0ZS4gKi8KKwl0Y2JfZGVzYy0+YlJUU0JXCQkJPSBmYWxz
ZTsgLyogUlRTIGZyYW1lIGJhbmR3aWR0aCBpcyBhbHdheXMgMjBNSHogKi8KCi0JaWYodGNiX2Rl
c2MtPmJCcm9hZGNhc3QgfHwgdGNiX2Rlc2MtPmJNdWx0aWNhc3QpLy9vbmx5IHVuaWNhc3QgZnJh
bWUgd2lsbCB1c2UgcnRzL2N0cworCWlmICh0Y2JfZGVzYy0+YkJyb2FkY2FzdCB8fCB0Y2JfZGVz
Yy0+Yk11bHRpY2FzdCkvKiBvbmx5IHVuaWNhc3QgZnJhbWUgd2lsbCB1c2UgcnRzL2N0cyAqLwog
CQlyZXR1cm47CgotCWlmIChpc19icm9hZGNhc3RfZXRoZXJfYWRkcihza2ItPmRhdGErMTYpKSAg
Ly9jaGVjayBhZGRyMyBhcyBpbmZyYXN0cnVjdHVyZSBhZGQzIGlzIERBLgorCWlmIChpc19icm9h
ZGNhc3RfZXRoZXJfYWRkcihza2ItPmRhdGErMTYpKSAgLyogY2hlY2sgYWRkcjMgYXMgaW5mcmFz
dHJ1Y3R1cmUgYWRkMyBpcyBEQS4gKi8KIAkJcmV0dXJuOwoKLQlpZiAoaWVlZS0+bW9kZSA8IElF
RUVfTl8yNEcpIC8vYiwgZyBtb2RlCisJaWYgKGllZWUtPm1vZGUgPCBJRUVFX05fMjRHKSAvKiBi
LCBnIG1vZGUgKi8KIAl7Ci0JCQkvLyAoMSkgUlRTX1RocmVzaG9sZCBpcyBjb21wYXJlZCB0byB0
aGUgTVBEVSwgbm90IE1TRFUuCi0JCQkvLyAoMikgSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUg
ZnJhZyBpbiAgdGhpcyBNU0RVLCBvbmx5IHRoZSBmaXJzdCBmcmFnIHVzZXMgcHJvdGVjdGlvbiBm
cmFtZS4KLQkJCS8vCQlPdGhlciBmcmFnbWVudHMgYXJlIHByb3RlY3RlZCBieSBwcmV2aW91cyBm
cmFnbWVudC4KLQkJCS8vCQlTbyB3ZSBvbmx5IG5lZWQgdG8gY2hlY2sgdGhlIGxlbmd0aCBvZiBm
aXJzdCBmcmFnbWVudC4KKwkJCS8qCisJCQkgKiAoMSkgUlRTX1RocmVzaG9sZCBpcyBjb21wYXJl
ZCB0byB0aGUgTVBEVSwgbm90IE1TRFUuCisJCQkgKiAoMikgSWYgdGhlcmUgYXJlIG1vcmUgdGhh
biBvbmUgZnJhZyBpbiAgdGhpcyBNU0RVLCBvbmx5IHRoZSBmaXJzdCBmcmFnIHVzZXMgcHJvdGVj
dGlvbiBmcmFtZS4KKwkJCSAqIAlPdGhlciBmcmFnbWVudHMgYXJlIHByb3RlY3RlZCBieSBwcmV2
aW91cyBmcmFnbWVudC4KKwkJCSAqIAlTbyB3ZSBvbmx5IG5lZWQgdG8gY2hlY2sgdGhlIGxlbmd0
aCBvZiBmaXJzdCBmcmFnbWVudC4KKwkJCSAqLwogCQlpZiAoc2tiLT5sZW4gPiBpZWVlLT5ydHMp
CiAJCXsKIAkJCXRjYl9kZXNjLT5iUlRTRW5hYmxlID0gdHJ1ZTsKQEAgLTQ0OSw1NyArNDUzLDU0
IEBAIHN0YXRpYyB2b2lkIGllZWU4MDIxMV9xdWVyeV9wcm90ZWN0aW9ubW9kZShzdHJ1Y3QgaWVl
ZTgwMjExX2RldmljZSAqaWVlZSwKIAkJfQogCQllbHNlIGlmIChpZWVlLT5jdXJyZW50X25ldHdv
cmsuYnVzZXByb3RlY3Rpb24pCiAJCXsKLQkJCS8vIFVzZSBDVFMtdG8tU0VMRiBpbiBwcm90ZWN0
aW9uIG1vZGUuCisJCQkvKiBVc2UgQ1RTLXRvLVNFTEYgaW4gcHJvdGVjdGlvbiBtb2RlLiAqLwog
CQkJdGNiX2Rlc2MtPmJSVFNFbmFibGUgPSB0cnVlOwogCQkJdGNiX2Rlc2MtPmJDVFNFbmFibGUg
PSB0cnVlOwogCQkJdGNiX2Rlc2MtPnJ0c19yYXRlID0gTUdOXzI0TTsKIAkJfQotCQkvL290aGVy
d2lzZSByZXR1cm47CisJCS8qIG90aGVyd2lzZSByZXR1cm47ICovCiAJCXJldHVybjsKLQl9Ci0J
ZWxzZQotCXsvLyAxMW4gSGlnaCB0aHJvdWdocHV0IGNhc2UuCisJfSBlbHNlIHsvKiAxMW4gSGln
aCB0aHJvdWdocHV0IGNhc2UuICovCiAJCVBSVF9ISUdIX1RIUk9VR0hQVVQgcEhUSW5mbyA9IGll
ZWUtPnBIVEluZm87CiAJCXdoaWxlICh0cnVlKQogCQl7Ci0JCQkvL2NoZWNrIEVSUCBwcm90ZWN0
aW9uCi0JCQlpZiAoaWVlZS0+Y3VycmVudF9uZXR3b3JrLmJ1c2Vwcm90ZWN0aW9uKQotCQkJey8v
IENUUy10by1TRUxGCisJCQkvKiBjaGVjayBFUlAgcHJvdGVjdGlvbiAqLworCQkJaWYgKGllZWUt
PmN1cnJlbnRfbmV0d29yay5idXNlcHJvdGVjdGlvbikgey8qIENUUy10by1TRUxGICovCiAJCQkJ
dGNiX2Rlc2MtPmJSVFNFbmFibGUgPSB0cnVlOwogCQkJCXRjYl9kZXNjLT5iQ1RTRW5hYmxlID0g
dHJ1ZTsKIAkJCQl0Y2JfZGVzYy0+cnRzX3JhdGUgPSBNR05fMjRNOwogCQkJCWJyZWFrOwogCQkJ
fQotCQkJLy9jaGVjayBIVCBvcCBtb2RlCisJCQkvKiBjaGVjayBIVCBvcCBtb2RlICovCiAJCQlp
ZihwSFRJbmZvLT5iQ3VycmVudEhUU3VwcG9ydCAgJiYgcEhUSW5mby0+YkVuYWJsZUhUKQogCQkJ
ewogCQkJCXU4IEhUT3BNb2RlID0gcEhUSW5mby0+Q3VycmVudE9wTW9kZTsKIAkJCQlpZigocEhU
SW5mby0+YkN1ckJXNDBNSHogJiYgKEhUT3BNb2RlID09IDIgfHwgSFRPcE1vZGUgPT0gMykpIHx8
CiAJCQkJCQkJKCFwSFRJbmZvLT5iQ3VyQlc0ME1IeiAmJiBIVE9wTW9kZSA9PSAzKSApCiAJCQkJ
ewotCQkJCQl0Y2JfZGVzYy0+cnRzX3JhdGUgPSBNR05fMjRNOyAvLyBSYXRlIGlzIDI0TWJwcy4K
KwkJCQkJdGNiX2Rlc2MtPnJ0c19yYXRlID0gTUdOXzI0TTsgLyogUmF0ZSBpcyAyNE1icHMuICov
CiAJCQkJCXRjYl9kZXNjLT5iUlRTRW5hYmxlID0gdHJ1ZTsKIAkJCQkJYnJlYWs7CiAJCQkJfQog
CQkJfQotCQkJLy9jaGVjayBydHMKKwkJCS8qIGNoZWNrIHJ0cyAqLwogCQkJaWYgKHNrYi0+bGVu
ID4gaWVlZS0+cnRzKQogCQkJewotCQkJCXRjYl9kZXNjLT5ydHNfcmF0ZSA9IE1HTl8yNE07IC8v
IFJhdGUgaXMgMjRNYnBzLgorCQkJCXRjYl9kZXNjLT5ydHNfcmF0ZSA9IE1HTl8yNE07IC8qIFJh
dGUgaXMgMjRNYnBzLiAqLwogCQkJCXRjYl9kZXNjLT5iUlRTRW5hYmxlID0gdHJ1ZTsKIAkJCQli
cmVhazsKIAkJCX0KLQkJCS8vdG8gZG8gbGlzdDogY2hlY2sgTUlNTyBwb3dlciBzYXZlIGNvbmRp
dGlvbi4KLQkJCS8vY2hlY2sgQU1QRFUgYWdncmVnYXRpb24gZm9yIFRYT1AKKwkJCS8qIHRvIGRv
IGxpc3Q6IGNoZWNrIE1JTU8gcG93ZXIgc2F2ZSBjb25kaXRpb24uICovCisJCQkvKiBjaGVjayBB
TVBEVSBhZ2dyZWdhdGlvbiBmb3IgVFhPUCAqLwogCQkJaWYodGNiX2Rlc2MtPmJBTVBEVUVuYWJs
ZSkKIAkJCXsKLQkJCQl0Y2JfZGVzYy0+cnRzX3JhdGUgPSBNR05fMjRNOyAvLyBSYXRlIGlzIDI0
TWJwcy4KLQkJCQkvLyBBY2NvcmRpbmcgdG8gODE5MCBkZXNpZ24sIGZpcm13YXJlIHNlbmRzIENG
LUVuZCBvbmx5IGlmIFJUUy9DVFMgaXMgZW5hYmxlZC4gSG93ZXZlciwgaXQgZGVncmFkcwotCQkJ
CS8vIHRocm91Z2hwdXQgYXJvdW5kIDEwTSwgc28gd2UgZGlzYWJsZSBvZiB0aGlzIG1lY2hhbmlz
bS4gMjAwNy4wOC4wMyBieSBFbWlseQorCQkJCXRjYl9kZXNjLT5ydHNfcmF0ZSA9IE1HTl8yNE07
IC8qIFJhdGUgaXMgMjRNYnBzLiAqLworCQkJCS8qIEFjY29yZGluZyB0byA4MTkwIGRlc2lnbiwg
ZmlybXdhcmUgc2VuZHMgQ0YtRW5kIG9ubHkgaWYgUlRTL0NUUyBpcyBlbmFibGVkLiBIb3dldmVy
LCBpdCBkZWdyYWRzICovCisJCQkJLyogdGhyb3VnaHB1dCBhcm91bmQgMTBNLCBzbyB3ZSBkaXNh
YmxlIG9mIHRoaXMgbWVjaGFuaXNtLiAyMDA3LjA4LjAzIGJ5IEVtaWx5ICovCiAJCQkJdGNiX2Rl
c2MtPmJSVFNFbmFibGUgPSBmYWxzZTsKIAkJCQlicmVhazsKIAkJCX0KLQkJCS8vY2hlY2sgSU9U
IGFjdGlvbgorCQkJLyogY2hlY2sgSU9UIGFjdGlvbiAqLwogCQkJaWYocEhUSW5mby0+SU9UQWN0
aW9uICYgSFRfSU9UX0FDVF9GT1JDRURfQ1RTMlNFTEYpCiAJCQl7CiAJCQkJdGNiX2Rlc2MtPmJD
VFNFbmFibGUJPSB0cnVlOwpAQCAtNTA3LDExICs1MDgsMTEgQEAgc3RhdGljIHZvaWQgaWVlZTgw
MjExX3F1ZXJ5X3Byb3RlY3Rpb25tb2RlKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAog
CQkJCXRjYl9kZXNjLT5iUlRTRW5hYmxlID0gdHJ1ZTsKIAkJCQlicmVhazsKIAkJCX0KLQkJCS8v
IFRvdGFsbHkgbm8gcHJvdGVjdGlvbiBjYXNlISEKKwkJCS8qIFRvdGFsbHkgbm8gcHJvdGVjdGlv
biBjYXNlISEgKi8KIAkJCWdvdG8gTk9fUFJPVEVDVElPTjsKIAkJfQogCQl9Ci0JLy8gRm9yIHRl
c3QgLCBDVFMgcmVwbGFjZSB3aXRoIFJUUworCS8qIEZvciB0ZXN0ICwgQ1RTIHJlcGxhY2Ugd2l0
aCBSVFMgKi8KIAlpZiAoMCkgewogCQl0Y2JfZGVzYy0+YkNUU0VuYWJsZQk9IHRydWU7CiAJCXRj
Yl9kZXNjLT5ydHNfcmF0ZSA9IE1HTl8yNE07CkBAIC01NjcsNyArNTY4LDcgQEAgc3RhdGljIHZv
aWQgaWVlZTgwMjExX3F1ZXJ5X3NlcW51bShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwK
IHsKIAlpZiAoaXNfbXVsdGljYXN0X2V0aGVyX2FkZHIoZHN0KSkKIAkJcmV0dXJuOwotCWlmIChJ
c1FvU0RhdGFGcmFtZShza2ItPmRhdGEpKSAvL3dlIGRlYWwgcW9zIGRhdGEgb25seQorCWlmIChJ
c1FvU0RhdGFGcmFtZShza2ItPmRhdGEpKSAvKiB3ZSBkZWFsIHFvcyBkYXRhIG9ubHkgKi8KIAl7
CiAJCXN0cnVjdCB0eF90c19yZWNvcmQgKnBUUyA9IE5VTEw7CiAJCWlmICghR2V0VHMoaWVlZSwg
KHN0cnVjdCB0c19jb21tb25faW5mbyAqKikoJnBUUyksIGRzdCwgc2tiLT5wcmlvcml0eSwgVFhf
RElSLCB0cnVlKSkKQEAgLTYwMyw3ICs2MDQsOCBAQCBpbnQgaWVlZTgwMjExX3htaXQoc3RydWN0
IHNrX2J1ZmYgKnNrYiwgc3RydWN0IG5ldF9kZXZpY2UgKmRldikKCiAJc3Bpbl9sb2NrX2lycXNh
dmUoJmllZWUtPmxvY2ssIGZsYWdzKTsKCi0JLyogSWYgdGhlcmUgaXMgbm8gZHJpdmVyIGhhbmRs
ZXIgdG8gdGFrZSB0aGUgVFhCLCBkb250JyBib3RoZXIKKwkvKgorCSAqIElmIHRoZXJlIGlzIG5v
IGRyaXZlciBoYW5kbGVyIHRvIHRha2UgdGhlIFRYQiwgZG9udCcgYm90aGVyCiAJICogY3JlYXRp
bmcgaXQuLi4KIAkgKi8KIAlpZiAoKCFpZWVlLT5oYXJkX3N0YXJ0X3htaXQgJiYgIShpZWVlLT5z
b2Z0bWFjX2ZlYXR1cmVzICYgSUVFRV9TT0ZUTUFDX1RYX1FVRVVFKSl8fApAQCAtNjY3LDE0ICs2
NjksMTYgQEAgaW50IGllZWU4MDIxMV94bWl0KHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYpCgogCQlpZiAoaWVlZS0+aXdfbW9kZSA9PSBJV19NT0RFX0lORlJBKSB7
CiAJCQlmYyB8PSBJRUVFODAyMTFfRkNUTF9UT0RTOwotCQkJLyogVG8gRFM6IEFkZHIxID0gQlNT
SUQsIEFkZHIyID0gU0EsCisJCQkvKgorCQkJICogVG8gRFM6IEFkZHIxID0gQlNTSUQsIEFkZHIy
ID0gU0EsCiAJCQkgKiBBZGRyMyA9IERBCiAJCQkgKi8KIAkJCW1lbWNweSgmaGVhZGVyLmFkZHIx
LCBpZWVlLT5jdXJyZW50X25ldHdvcmsuYnNzaWQsIEVUSF9BTEVOKTsKIAkJCW1lbWNweSgmaGVh
ZGVyLmFkZHIyLCAmc3JjLCBFVEhfQUxFTik7CiAJCQltZW1jcHkoJmhlYWRlci5hZGRyMywgJmRl
c3QsIEVUSF9BTEVOKTsKIAkJfSBlbHNlIGlmIChpZWVlLT5pd19tb2RlID09IElXX01PREVfQURI
T0MpIHsKLQkJCS8qIG5vdCBGcm9tL1RvIERTOiBBZGRyMSA9IERBLCBBZGRyMiA9IFNBLAorCQkJ
LyoKKwkJCSAqIG5vdCBGcm9tL1RvIERTOiBBZGRyMSA9IERBLCBBZGRyMiA9IFNBLAogCQkJICog
QWRkcjMgPSBCU1NJRAogCQkJICovCiAJCQltZW1jcHkoJmhlYWRlci5hZGRyMSwgZGVzdCwgRVRI
X0FMRU4pOwpAQCAtNjg0LDcgKzY4OCw4IEBAIGludCBpZWVlODAyMTFfeG1pdChzdHJ1Y3Qgc2tf
YnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQoKIAkJaGVhZGVyLmZyYW1lX2N0bCA9
IGNwdV90b19sZTE2KGZjKTsKCi0JCS8qIERldGVybWluZSBmcmFnbWVudGF0aW9uIHNpemUgYmFz
ZWQgb24gZGVzdGluYXRpb24gKG11bHRpY2FzdAorCQkvKgorCQkgKiBEZXRlcm1pbmUgZnJhZ21l
bnRhdGlvbiBzaXplIGJhc2VkIG9uIGRlc3RpbmF0aW9uIChtdWx0aWNhc3QKIAkJICogYW5kIGJy
b2FkY2FzdCBhcmUgbm90IGZyYWdtZW50ZWQpCiAJCSAqLwogCQlpZiAoaXNfbXVsdGljYXN0X2V0
aGVyX2FkZHIoaGVhZGVyLmFkZHIxKSkgewpAQCAtNjkyLDcgKzY5Nyw3IEBAIGludCBpZWVlODAy
MTFfeG1pdChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCQkJ
cW9zX2N0bCB8PSBRT1NfQ1RMX05PVENPTlRBSU5fQUNLOwogCQl9CiAJCWVsc2UgewotCQkJZnJh
Z19zaXplID0gaWVlZS0+ZnRzOy8vZGVmYXVsdDozOTIKKwkJCWZyYWdfc2l6ZSA9IGllZWUtPmZ0
czsvKiBkZWZhdWx0OjM5MiAqLwogCQkJcW9zX2N0bCA9IDA7CiAJCX0KCkBAIC03MDIsMTIgKzcw
NywxMyBAQCBpbnQgaWVlZTgwMjExX3htaXQoc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IG5l
dF9kZXZpY2UgKmRldikKIAkJCWhkcl9sZW4gPSBJRUVFODAyMTFfM0FERFJfTEVOICsgMjsKCiAJ
CQlza2ItPnByaW9yaXR5ID0gaWVlZTgwMjExX2NsYXNzaWZ5KHNrYiwgJmllZWUtPmN1cnJlbnRf
bmV0d29yayk7Ci0JCQlxb3NfY3RsIHw9IHNrYi0+cHJpb3JpdHk7IC8vc2V0IGluIHRoZSBpZWVl
ODAyMTFfY2xhc3NpZnkKKwkJCXFvc19jdGwgfD0gc2tiLT5wcmlvcml0eTsgLyogc2V0IGluIHRo
ZSBpZWVlODAyMTFfY2xhc3NpZnkgKi8KIAkJCWhlYWRlci5xb3NfY3RsID0gY3B1X3RvX2xlMTYo
cW9zX2N0bCAmIElFRUU4MDIxMV9RT1NfVElEKTsKIAkJfSBlbHNlIHsKIAkJCWhkcl9sZW4gPSBJ
RUVFODAyMTFfM0FERFJfTEVOOwogCQl9Ci0JCS8qIERldGVybWluZSBhbW91bnQgb2YgcGF5bG9h
ZCBwZXIgZnJhZ21lbnQuICBSZWdhcmRsZXNzIG9mIGlmCisJCS8qCisJCSAqIERldGVybWluZSBh
bW91bnQgb2YgcGF5bG9hZCBwZXIgZnJhZ21lbnQuICBSZWdhcmRsZXNzIG9mIGlmCiAJCSAqIHRo
aXMgc3RhY2sgaXMgcHJvdmlkaW5nIHRoZSBmdWxsIDgwMi4xMSBoZWFkZXIsIG9uZSB3aWxsCiAJ
CSAqIGV2ZW50dWFsbHkgYmUgYWZmaXhlZCB0byB0aGlzIGZyYWdtZW50IC0tIHNvIHdlIG11c3Qg
YWNjb3VudCBmb3IKIAkJICogaXQgd2hlbiBkZXRlcm1pbmluZyB0aGUgYW1vdW50IG9mIHBheWxv
YWQgc3BhY2UuCkBAIC03MjIsNyArNzI4LDggQEAgaW50IGllZWU4MDIxMV94bWl0KHN0cnVjdCBz
a19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiAJCQlieXRlc19wZXJfZnJhZyAt
PSBjcnlwdC0+b3BzLT5leHRyYV9wcmVmaXhfbGVuICsKIAkJCQljcnlwdC0+b3BzLT5leHRyYV9w
b3N0Zml4X2xlbjsKCi0JCS8qIE51bWJlciBvZiBmcmFnbWVudHMgaXMgdGhlIHRvdGFsIGJ5dGVz
X3Blcl9mcmFnIC8KKwkJLyoKKwkJICogTnVtYmVyIG9mIGZyYWdtZW50cyBpcyB0aGUgdG90YWwg
Ynl0ZXNfcGVyX2ZyYWcgLwogCQkgKiBwYXlsb2FkX3Blcl9mcmFnbWVudAogCQkgKi8KIAkJbnJf
ZnJhZ3MgPSBieXRlcyAvIGJ5dGVzX3Blcl9mcmFnOwpAQCAtNzMyLDcgKzczOSw4IEBAIGludCBp
ZWVlODAyMTFfeG1pdChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
KQogCQllbHNlCiAJCQlieXRlc19sYXN0X2ZyYWcgPSBieXRlc19wZXJfZnJhZzsKCi0JCS8qIFdo
ZW4gd2UgYWxsb2NhdGUgdGhlIFRYQiB3ZSBhbGxvY2F0ZSBlbm91Z2ggc3BhY2UgZm9yIHRoZSBy
ZXNlcnZlCisJCS8qCisJCSAqIFdoZW4gd2UgYWxsb2NhdGUgdGhlIFRYQiB3ZSBhbGxvY2F0ZSBl
bm91Z2ggc3BhY2UgZm9yIHRoZSByZXNlcnZlCiAJCSAqIGFuZCBmdWxsIGZyYWdtZW50IGJ5dGVz
IChieXRlc19wZXJfZnJhZyBkb2Vzbid0IGluY2x1ZGUgcHJlZml4LAogCQkgKiBwb3N0Zml4LCBo
ZWFkZXIsIEZDUywgZXRjLikKIAkJICovCkBAIC03ODAsNyArNzg4LDggQEAgaW50IGllZWU4MDIx
MV94bWl0KHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiAJCQl9
CiAJCQlmcmFnX2hkciA9IHNrYl9wdXRfZGF0YShza2JfZnJhZywgJmhlYWRlciwgaGRyX2xlbik7
CgotCQkJLyogSWYgdGhpcyBpcyBub3QgdGhlIGxhc3QgZnJhZ21lbnQsIHRoZW4gYWRkIHRoZSBN
T1JFRlJBR1MKKwkJCS8qCisJCQkgKiBJZiB0aGlzIGlzIG5vdCB0aGUgbGFzdCBmcmFnbWVudCwg
dGhlbiBhZGQgdGhlIE1PUkVGUkFHUwogCQkJICogYml0IHRvIHRoZSBmcmFtZSBjb250cm9sCiAJ
CQkgKi8KIAkJCWlmIChpICE9IG5yX2ZyYWdzIC0gMSkgewpAQCAtNzk1LDcgKzgwNCw3IEBAIGlu
dCBpZWVlODAyMTFfeG1pdChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAq
ZGV2KQogCQkJLy9pZihpZWVlLT5jdXJyZW50X25ldHdvcmsuUW9TX0VuYWJsZSkKIAkJCWlmKHFv
c19hY3RpdmVkKQogCQkJewotCQkJCS8vIGFkZCAxIG9ubHkgaW5kaWNhdGUgdG8gY29ycmVzcG9u
ZGluZyBzZXEgbnVtYmVyIGNvbnRyb2wgMjAwNi83LzEyCisJCQkJLyogYWRkIDEgb25seSBpbmRp
Y2F0ZSB0byBjb3JyZXNwb25kaW5nIHNlcSBudW1iZXIgY29udHJvbCAyMDA2LzcvMTIgKi8KIAkJ
CQlmcmFnX2hkci0+c2VxX2N0bCA9IGNwdV90b19sZTE2KGllZWUtPnNlcV9jdHJsW1VQMkFDKHNr
Yi0+cHJpb3JpdHkpKzFdPDw0IHwgaSk7CiAJCQl9IGVsc2UgewogCQkJCWZyYWdfaGRyLT5zZXFf
Y3RsID0gY3B1X3RvX2xlMTYoaWVlZS0+c2VxX2N0cmxbMF08PDQgfCBpKTsKQEAgLTgxNCw3ICs4
MjMsOCBAQCBpbnQgaWVlZTgwMjExX3htaXQoc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IG5l
dF9kZXZpY2UgKmRldikKIAkJCS8qIEFkdmFuY2UgdGhlIFNLQi4uLiAqLwogCQkJc2tiX3B1bGwo
c2tiLCBieXRlcyk7CgotCQkJLyogRW5jcnlwdGlvbiByb3V0aW5lIHdpbGwgbW92ZSB0aGUgaGVh
ZGVyIGZvcndhcmQgaW4gb3JkZXIKKwkJCS8qCisJCQkgKiBFbmNyeXB0aW9uIHJvdXRpbmUgd2ls
bCBtb3ZlIHRoZSBoZWFkZXIgZm9yd2FyZCBpbiBvcmRlcgogCQkJICogdG8gaW5zZXJ0IHRoZSBJ
ViBiZXR3ZWVuIHRoZSBoZWFkZXIgYW5kIHRoZSBwYXlsb2FkCiAJCQkgKi8KIAkJCWlmIChlbmNy
eXB0KQpAQCAtODU2LDcgKzg2Niw3IEBAIGludCBpZWVlODAyMTFfeG1pdChzdHJ1Y3Qgc2tfYnVm
ZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCX0KCiAgc3VjY2VzczoKLS8vV0IgYWRk
IHRvIGZpbGwgZGF0YSB0Y2JfZGVzYyBoZXJlLiBvbmx5IGZpcnN0IGZyYWdtZW50IGlzIGNvbnNp
ZGVyZWQsIG5lZWQgdG8gY2hhbmdlLCBhbmQgeW91IG1heSByZW1vdmUgdG8gb3RoZXIgcGxhY2Uu
CisvKiBXQiBhZGQgdG8gZmlsbCBkYXRhIHRjYl9kZXNjIGhlcmUuIG9ubHkgZmlyc3QgZnJhZ21l
bnQgaXMgY29uc2lkZXJlZCwgbmVlZCB0byBjaGFuZ2UsIGFuZCB5b3UgbWF5IHJlbW92ZSB0byBv
dGhlciBwbGFjZS4gKi8KIAlpZiAodHhiKQogCXsKIAkJc3RydWN0IGNiX2Rlc2MgKnRjYl9kZXNj
ID0gKHN0cnVjdCBjYl9kZXNjICopKHR4Yi0+ZnJhZ21lbnRzWzBdLT5jYiArIE1BWF9ERVZfQURE
Ul9TSVpFKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEv
aWVlZTgwMjExX3d4LmMgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4
MDIxMV93eC5jCmluZGV4IGRlYWQxMzRmNmRlMC4uNmNmOWUyNWQ2NjA3IDEwMDY0NAotLS0gYS9k
cml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL2llZWU4MDIxMV93eC5jCisrKyBiL2Ry
aXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvaWVlZTgwMjExX3d4LmMKQEAgLTEzMCw3
ICsxMzAsNyBAQCBzdGF0aWMgaW5saW5lIGNoYXIgKnJ0bDgxOXhfdHJhbnNsYXRlX3NjYW4oc3Ry
dWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCiAJCQltYXhfcmF0ZSA9IHJhdGU7CiAJfQoKLQlp
ZiAobmV0d29yay0+bW9kZSA+PSBJRUVFX05fMjRHKS8vYWRkIE4gcmF0ZSBoZXJlOworCWlmIChu
ZXR3b3JrLT5tb2RlID49IElFRUVfTl8yNEcpLyogYWRkIE4gcmF0ZSBoZXJlOyAqLwogCXsKIAkJ
c3RydWN0IGh0X2NhcGFiaWxpdHlfZWxlICpodF9jYXAgPSBOVUxMOwogCQlib29sIGlzNDBNID0g
ZmFsc2UsIGlzU2hvcnRHSSA9IGZhbHNlOwpAQCAtMjExLDggKzIxMSwxMCBAQCBzdGF0aWMgaW5s
aW5lIGNoYXIgKnJ0bDgxOXhfdHJhbnNsYXRlX3NjYW4oc3RydWN0IGllZWU4MDIxMV9kZXZpY2Ug
KmllZWUsCiAJfQoKCi0JLyogQWRkIEVYVFJBOiBBZ2UgdG8gZGlzcGxheSBzZWNvbmRzIHNpbmNl
IGxhc3QgYmVhY29uL3Byb2JlIHJlc3BvbnNlCi0JICogZm9yIGdpdmVuIG5ldHdvcmsuICovCisJ
LyoKKwkgKiBBZGQgRVhUUkE6IEFnZSB0byBkaXNwbGF5IHNlY29uZHMgc2luY2UgbGFzdCBiZWFj
b24vcHJvYmUgcmVzcG9uc2UKKwkgKiBmb3IgZ2l2ZW4gbmV0d29yay4KKwkgKi8KIAlpd2UuY21k
ID0gSVdFVkNVU1RPTTsKIAlwID0gY3VzdG9tOwogCXAgKz0gc25wcmludGYocCwgTUFYX0NVU1RP
TV9MRU4gLSAocCAtIGN1c3RvbSksCkBAIC0yMzMsNyArMjM1LDcgQEAgaW50IGllZWU4MDIxMV93
eF9nZXRfc2NhbihzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwKCiAJY2hhciAqZXYgPSBl
eHRyYTsKIC8vCWNoYXIgKnN0b3AgPSBldiArIElXX1NDQU5fTUFYX0RBVEE7Ci0JY2hhciAqc3Rv
cCA9IGV2ICsgd3JxdS0+ZGF0YS5sZW5ndGg7Ly9JV19TQ0FOX01BWF9EQVRBOworCWNoYXIgKnN0
b3AgPSBldiArIHdycXUtPmRhdGEubGVuZ3RoOy8qIElXX1NDQU5fTUFYX0RBVEE7ICovCiAJLy9j
aGFyICpzdG9wID0gZXYgKyBJV19TQ0FOX01BWF9EQVRBOwogCWludCBpID0gMDsKIAlpbnQgZXJy
ID0gMDsKQEAgLTMwOSw4ICszMTEsMTAgQEAgaW50IGllZWU4MDIxMV93eF9zZXRfZW5jb2RlKHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAogCQl9IGVsc2UKIAkJCUlFRUU4MDIxMV9ERUJV
R19XWCgiRGlzYWJsaW5nIGVuY3J5cHRpb24uXG4iKTsKCi0JCS8qIENoZWNrIGFsbCB0aGUga2V5
cyB0byBzZWUgaWYgYW55IGFyZSBzdGlsbCBjb25maWd1cmVkLAotCQkgKiBhbmQgaWYgbm8ga2V5
IGluZGV4IHdhcyBwcm92aWRlZCwgZGUtaW5pdCB0aGVtIGFsbCAqLworCQkvKgorCQkgKiBDaGVj
ayBhbGwgdGhlIGtleXMgdG8gc2VlIGlmIGFueSBhcmUgc3RpbGwgY29uZmlndXJlZCwKKwkJICog
YW5kIGlmIG5vIGtleSBpbmRleCB3YXMgcHJvdmlkZWQsIGRlLWluaXQgdGhlbSBhbGwKKwkJICov
CiAJCWZvciAoaSA9IDA7IGkgPCBXRVBfS0VZUzsgaSsrKSB7CiAJCQlpZiAoaWVlZS0+Y3J5cHRb
aV0gIT0gTlVMTCkgewogCQkJCWlmIChrZXlfcHJvdmlkZWQpCkBAIC0zMzYsOCArMzQwLDEwIEBA
IGludCBpZWVlODAyMTFfd3hfc2V0X2VuY29kZShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVl
ZSwKCiAJaWYgKCpjcnlwdCAhPSBOVUxMICYmICgqY3J5cHQpLT5vcHMgIT0gTlVMTCAmJgogCSAg
ICBzdHJjbXAoKCpjcnlwdCktPm9wcy0+bmFtZSwgIldFUCIpICE9IDApIHsKLQkJLyogY2hhbmdp
bmcgdG8gdXNlIFdFUDsgZGVpbml0IHByZXZpb3VzbHkgdXNlZCBhbGdvcml0aG0KLQkJICogb24g
dGhpcyBrZXkgKi8KKwkJLyoKKwkJICogY2hhbmdpbmcgdG8gdXNlIFdFUDsgZGVpbml0IHByZXZp
b3VzbHkgdXNlZCBhbGdvcml0aG0KKwkJICogb24gdGhpcyBrZXkKKwkJICovCiAJCWllZWU4MDIx
MV9jcnlwdF9kZWxheWVkX2RlaW5pdChpZWVlLCBjcnlwdCk7CiAJfQoKQEAgLTM4MCw3ICszODYs
OCBAQCBpbnQgaWVlZTgwMjExX3d4X3NldF9lbmNvZGUoc3RydWN0IGllZWU4MDIxMV9kZXZpY2Ug
KmllZWUsCiAJCSgqY3J5cHQpLT5vcHMtPnNldF9rZXkoc2VjLmtleXNba2V5XSwgbGVuLCBOVUxM
LAogCQkJCSAgICAgICAoKmNyeXB0KS0+cHJpdik7CiAJCXNlYy5mbGFncyB8PSBCSVQoa2V5KTsK
LQkJLyogVGhpcyBlbnN1cmVzIGEga2V5IHdpbGwgYmUgYWN0aXZhdGVkIGlmIG5vIGtleSBpcwor
CQkvKgorCQkgKiBUaGlzIGVuc3VyZXMgYSBrZXkgd2lsbCBiZSBhY3RpdmF0ZWQgaWYgbm8ga2V5
IGlzCiAJCSAqIGV4cGxpY2l0bHkgc2V0CiAJCSAqLwogCQlpZiAoa2V5ID09IHNlYy5hY3RpdmVf
a2V5KQpAQCAtNDIyLDE5ICs0MjksMjMgQEAgaW50IGllZWU4MDIxMV93eF9zZXRfZW5jb2RlKHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAogCUlFRUU4MDIxMV9ERUJVR19XWCgiQXV0aDog
JXNcbiIsIHNlYy5hdXRoX21vZGUgPT0gV0xBTl9BVVRIX09QRU4gPwogCQkJICAgIk9QRU4iIDog
IlNIQVJFRCBLRVkiKTsKCi0JLyogRm9yIG5vdyB3ZSBqdXN0IHN1cHBvcnQgV0VQLCBzbyBvbmx5
IHNldCB0aGF0IHNlY3VyaXR5IGxldmVsLi4uCi0JICogVE9ETzogV2hlbiBXUEEgaXMgYWRkZWQg
dGhpcyBpcyBvbmUgcGxhY2UgdGhhdCBuZWVkcyB0byBjaGFuZ2UgKi8KKwkvKgorCSAqIEZvciBu
b3cgd2UganVzdCBzdXBwb3J0IFdFUCwgc28gb25seSBzZXQgdGhhdCBzZWN1cml0eSBsZXZlbC4u
LgorCSAqIFRPRE86IFdoZW4gV1BBIGlzIGFkZGVkIHRoaXMgaXMgb25lIHBsYWNlIHRoYXQgbmVl
ZHMgdG8gY2hhbmdlCisJICovCiAJc2VjLmZsYWdzIHw9IFNFQ19MRVZFTDsKIAlzZWMubGV2ZWwg
PSBTRUNfTEVWRUxfMTsgLyogNDAgYW5kIDEwNCBiaXQgV0VQICovCgogCWlmIChpZWVlLT5zZXRf
c2VjdXJpdHkpCiAJCWllZWUtPnNldF9zZWN1cml0eShkZXYsICZzZWMpOwoKLQkvKiBEbyBub3Qg
cmVzZXQgcG9ydCBpZiBjYXJkIGlzIGluIE1hbmFnZWQgbW9kZSBzaW5jZSByZXNldHRpbmcgd2ls
bAorCS8qCisJICogRG8gbm90IHJlc2V0IHBvcnQgaWYgY2FyZCBpcyBpbiBNYW5hZ2VkIG1vZGUg
c2luY2UgcmVzZXR0aW5nIHdpbGwKIAkgKiBnZW5lcmF0ZSBuZXcgSUVFRSA4MDIuMTEgYXV0aGVu
dGljYXRpb24gd2hpY2ggbWF5IGVuZCB1cCBpbiBsb29waW5nCiAJICogd2l0aCBJRUVFIDgwMi4x
WC4gIElmIHlvdXIgaGFyZHdhcmUgcmVxdWlyZXMgYSByZXNldCBhZnRlciBXRVAKIAkgKiBjb25m
aWd1cmF0aW9uIChmb3IgZXhhbXBsZS4uLiBQcmlzbTIpLCBpbXBsZW1lbnQgdGhlIHJlc2V0X3Bv
cnQgaW4KLQkgKiB0aGUgY2FsbGJhY2tzIHN0cnVjdHVyZXMgdXNlZCB0byBpbml0aWFsaXplIHRo
ZSA4MDIuMTEgc3RhY2suICovCisJICogdGhlIGNhbGxiYWNrcyBzdHJ1Y3R1cmVzIHVzZWQgdG8g
aW5pdGlhbGl6ZSB0aGUgODAyLjExIHN0YWNrLgorCSAqLwogCWlmIChpZWVlLT5yZXNldF9vbl9r
ZXljaGFuZ2UgJiYKIAkgICAgaWVlZS0+aXdfbW9kZSAhPSBJV19NT0RFX0lORlJBICYmCiAJICAg
IGllZWUtPnJlc2V0X3BvcnQgJiYgaWVlZS0+cmVzZXRfcG9ydChkZXYpKSB7CkBAIC02MTIsNyAr
NjIzLDcgQEAgaW50IGllZWU4MDIxMV93eF9zZXRfZW5jb2RlX2V4dChzdHJ1Y3QgaWVlZTgwMjEx
X2RldmljZSAqaWVlZSwKIAkJcmV0ID0gLUVJTlZBTDsKIAkJZ290byBkb25lOwogCX0KLSAvL3Nr
aXBfaG9zdF9jcnlwdDoKKyAvKiBza2lwX2hvc3RfY3J5cHQ6ICovCiAJaWYgKGV4dC0+ZXh0X2Zs
YWdzICYgSVdfRU5DT0RFX0VYVF9TRVRfVFhfS0VZKSB7CiAJCWllZWUtPnR4X2tleWlkeCA9IGlk
eDsKIAkJc2VjLmFjdGl2ZV9rZXkgPSBpZHg7CkBAIC03MzgsOSArNzQ5LDkgQEAgaW50IGllZWU4
MDIxMV93eF9zZXRfYXV0aChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwKIAljYXNlIElX
X0FVVEhfQ0lQSEVSX0dST1VQOgogCWNhc2UgSVdfQVVUSF9LRVlfTUdNVDoKIAkJLyoKLSAqICAg
ICAgICAgICAgICAgICAgKiBIb3N0IEFQIGRyaXZlciBkb2VzIG5vdCB1c2UgdGhlc2UgcGFyYW1l
dGVycyBhbmQgYWxsb3dzCi0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB3
cGFfc3VwcGxpY2FudCB0byBjb250cm9sIHRoZW0gaW50ZXJuYWxseS4KLSAqICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovCisJCSogSG9zdCBBUCBk
cml2ZXIgZG9lcyBub3QgdXNlIHRoZXNlIHBhcmFtZXRlcnMgYW5kIGFsbG93cworCQkqIHdwYV9z
dXBwbGljYW50IHRvIGNvbnRyb2wgdGhlbSBpbnRlcm5hbGx5LgorCQkqLwogCQlicmVhazsKIAlj
YXNlIElXX0FVVEhfVEtJUF9DT1VOVEVSTUVBU1VSRVM6CiAJCWllZWUtPnRraXBfY291bnRlcm1l
YXN1cmVzID0gZGF0YS0+dmFsdWU7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5
MnUvaWVlZTgwMjExL3J0bDgxOXhfQkEuaCBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVl
ODAyMTEvcnRsODE5eF9CQS5oCmluZGV4IDFhNzI3ODU2YmE1My4uMjE1NzQ4ODk1YzJkIDEwMDY0
NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfQkEuaAor
KysgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfQkEuaApAQCAt
NTEsNCArNTEsNCBAQCBzdHJ1Y3QgYmFfcmVjb3JkIHsKIAl1bmlvbiBzZXF1ZW5jZV9jb250cm9s
CXN0YXJ0X3NlcV9jdHJsOwogfTsKCi0jZW5kaWYgLy9lbmQgX0JBVFlQRV9IXworI2VuZGlmIC8q
IGVuZCBfQkFUWVBFX0hfICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUv
aWVlZTgwMjExL3J0bDgxOXhfQkFQcm9jLmMgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVl
ZTgwMjExL3J0bDgxOXhfQkFQcm9jLmMKaW5kZXggNTM4NjliM2M5ODVjLi5hZGZlMTg3OGYzNmQg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvcnRsODE5eF9C
QVByb2MuYworKysgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhf
QkFQcm9jLmMKQEAgLTQyLDE3ICs0MiwxNyBAQCBzdGF0aWMgdm9pZCBEZUFjdGl2YXRlQkFFbnRy
eShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0IGJhX3JlY29yZCAqcAogICoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
Lwogc3RhdGljIHU4IFR4VHNEZWxldGVCQShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwg
c3RydWN0IHR4X3RzX3JlY29yZCAqcFR4VHMpCiB7Ci0Jc3RydWN0IGJhX3JlY29yZCAqcEFkbWl0
dGVkQmEgPSAmcFR4VHMtPnR4X2FkbWl0dGVkX2JhX3JlY29yZDsgIC8vVGhlc2UgdHdvIEJBIGVu
dHJpZXMgbXVzdCBleGlzdCBpbiBUUyBzdHJ1Y3R1cmUKKwlzdHJ1Y3QgYmFfcmVjb3JkICpwQWRt
aXR0ZWRCYSA9ICZwVHhUcy0+dHhfYWRtaXR0ZWRfYmFfcmVjb3JkOyAgLyogVGhlc2UgdHdvIEJB
IGVudHJpZXMgbXVzdCBleGlzdCBpbiBUUyBzdHJ1Y3R1cmUgKi8KIAlzdHJ1Y3QgYmFfcmVjb3Jk
ICpwUGVuZGluZ0JhID0gJnBUeFRzLT50eF9wZW5kaW5nX2JhX3JlY29yZDsKIAl1OAkJCWJTZW5k
REVMQkEgPSBmYWxzZTsKCi0JLy8gRGVsZXRlIHBlbmRpbmcgQkEKKwkvKiBEZWxldGUgcGVuZGlu
ZyBCQSAqLwogCWlmIChwUGVuZGluZ0JhLT52YWxpZCkgewogCQlEZUFjdGl2YXRlQkFFbnRyeShp
ZWVlLCBwUGVuZGluZ0JhKTsKIAkJYlNlbmRERUxCQSA9IHRydWU7CiAJfQoKLQkvLyBEZWxldGUg
YWRtaXR0ZWQgQkEKKwkvKiBEZWxldGUgYWRtaXR0ZWQgQkEgKi8KIAlpZiAocEFkbWl0dGVkQmEt
PnZhbGlkKSB7CiAJCURlQWN0aXZhdGVCQUVudHJ5KGllZWUsIHBBZG1pdHRlZEJhKTsKIAkJYlNl
bmRERUxCQSA9IHRydWU7CkBAIC05NSw3ICs5NSw3IEBAIHZvaWQgUmVzZXRCYUVudHJ5KHN0cnVj
dCBiYV9yZWNvcmQgKnBCQSkKIAlwQkEtPmRpYWxvZ190b2tlbgkJPSAwOwogCXBCQS0+c3RhcnRf
c2VxX2N0cmwuc2hvcnRfZGF0YQk9IDA7CiB9Ci0vL1RoZXNlIGZ1bmN0aW9ucyBuZWVkIHBvcnRp
bmcgaGVyZSBvciBub3Q/CisvKiBUaGVzZSBmdW5jdGlvbnMgbmVlZCBwb3J0aW5nIGhlcmUgb3Ig
bm90PyAqLwogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioKICAqZnVuY3Rpb246ICBjb25zdHJ1Y3QgQUREQkFSRVEg
YW5kIEFEREJBUlNQIGZyYW1lIGhlcmUgdG9nZXRoZXIuCiAgKiAgIGlucHV0OiAgdTgqCQlEc3QJ
Ly9BRERCQSBmcmFtZSdzIGRlc3RpbmF0aW9uCkBAIC0xMTcsMTEgKzExNywxMSBAQCBzdGF0aWMg
c3RydWN0IHNrX2J1ZmYgKmllZWU4MDIxMV9BRERCQShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAq
aWVlZSwgdTggKkRzdCwgcwogCQlJRUVFODAyMTFfREVCVUcoSUVFRTgwMjExX0RMX0VSUiwgInBC
QSBpcyBOVUxMXG4iKTsKIAkJcmV0dXJuIE5VTEw7CiAJfQotCXNrYiA9IGRldl9hbGxvY19za2Io
bGVuICsgc2l6ZW9mKHN0cnVjdCBydGxfODAyMTFfaGRyXzNhZGRyKSk7IC8vbmVlZCB0byBhZGQg
c29tZXRoaW5nIG90aGVycz8gRklYTUUKKwlza2IgPSBkZXZfYWxsb2Nfc2tiKGxlbiArIHNpemVv
ZihzdHJ1Y3QgcnRsXzgwMjExX2hkcl8zYWRkcikpOyAvKiBuZWVkIHRvIGFkZCBzb21ldGhpbmcg
b3RoZXJzPyBGSVhNRSAqLwogCWlmICghc2tiKQogCQlyZXR1cm4gTlVMTDsKCi0JbWVtc2V0KHNr
Yi0+ZGF0YSwgMCwgc2l6ZW9mKHN0cnVjdCBydGxfODAyMTFfaGRyXzNhZGRyKSk7CS8vSSB3b25k
ZXIgd2hldGhlciBpdCdzIG5lY2Vzc2FyeS4gQXBwYXJlbnRseSBrZXJuZWwgd2lsbCBub3QgZG8g
aXQgd2hlbiBhbGxvYyBhIHNrYi4KKwltZW1zZXQoc2tiLT5kYXRhLCAwLCBzaXplb2Yoc3RydWN0
IHJ0bF84MDIxMV9oZHJfM2FkZHIpKTsJLyogSSB3b25kZXIgd2hldGhlciBpdCdzIG5lY2Vzc2Fy
eS4gQXBwYXJlbnRseSBrZXJuZWwgd2lsbCBub3QgZG8gaXQgd2hlbiBhbGxvYyBhIHNrYi4gKi8K
IAlza2JfcmVzZXJ2ZShza2IsIGllZWUtPnR4X2hlYWRyb29tKTsKCiAJQkFSZXEgPSBza2JfcHV0
KHNrYiwgc2l6ZW9mKHN0cnVjdCBydGxfODAyMTFfaGRyXzNhZGRyKSk7CkBAIC0xMzEsMzMgKzEz
MSwzMyBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYgKmllZWU4MDIxMV9BRERCQShzdHJ1Y3QgaWVl
ZTgwMjExX2RldmljZSAqaWVlZSwgdTggKkRzdCwgcwoKIAltZW1jcHkoQkFSZXEtPmFkZHIzLCBp
ZWVlLT5jdXJyZW50X25ldHdvcmsuYnNzaWQsIEVUSF9BTEVOKTsKCi0JQkFSZXEtPmZyYW1lX2N0
bCA9IGNwdV90b19sZTE2KElFRUU4MDIxMV9TVFlQRV9NQU5BR0VfQUNUKTsgLy9hY3Rpb24gZnJh
bWUKKwlCQVJlcS0+ZnJhbWVfY3RsID0gY3B1X3RvX2xlMTYoSUVFRTgwMjExX1NUWVBFX01BTkFH
RV9BQ1QpOyAvKiBhY3Rpb24gZnJhbWUgKi8KCiAJLy90YWcgKz0gc2l6ZW9mKCBzdHJ1Y3QgcnRs
XzgwMjExX2hkcl8zYWRkcik7IC8vbW92ZSB0byBhY3Rpb24gZmllbGQKIAl0YWcgPSBza2JfcHV0
KHNrYiwgOSk7CiAJKnRhZysrID0gQUNUX0NBVF9CQTsKIAkqdGFnKysgPSB0eXBlOwotCS8vIERp
YWxvZyBUb2tlbgorCS8qIERpYWxvZyBUb2tlbiAqLwogCSp0YWcrKyA9IHBCQS0+ZGlhbG9nX3Rv
a2VuOwoKIAlpZiAoQUNUX0FEREJBUlNQID09IHR5cGUpIHsKLQkJLy8gU3RhdHVzIENvZGUKKwkJ
LyogU3RhdHVzIENvZGUgKi8KIAkJbmV0ZGV2X2luZm8oaWVlZS0+ZGV2LCAiPT09PT0+dG8gc2Vu
ZCBBRERCQVJTUFxuIik7CgogCQlwdXRfdW5hbGlnbmVkX2xlMTYoU3RhdHVzQ29kZSwgdGFnKTsK
IAkJdGFnICs9IDI7CiAJfQotCS8vIEJBIFBhcmFtZXRlciBTZXQKKwkvKiBCQSBQYXJhbWV0ZXIg
U2V0ICovCgogCXB1dF91bmFsaWduZWRfbGUxNihwQkEtPnBhcmFtX3NldC5zaG9ydF9kYXRhLCB0
YWcpOwogCXRhZyArPSAyOwotCS8vIEJBIFRpbWVvdXQgVmFsdWUKKwkvKiBCQSBUaW1lb3V0IFZh
bHVlICovCgogCXB1dF91bmFsaWduZWRfbGUxNihwQkEtPnRpbWVvdXRfdmFsdWUsIHRhZyk7CiAJ
dGFnICs9IDI7CgogCWlmIChBQ1RfQUREQkFSRVEgPT0gdHlwZSkgewotCS8vIEJBIFN0YXJ0IFNl
cUN0cmwKKwkvKiBCQSBTdGFydCBTZXFDdHJsICovCiAJCW1lbWNweSh0YWcsICh1OCAqKSYocEJB
LT5zdGFydF9zZXFfY3RybCksIDIpOwogCQl0YWcgKz0gMjsKIAl9CkBAIC0yMDIsNyArMjAyLDcg
QEAgc3RhdGljIHN0cnVjdCBza19idWZmICppZWVlODAyMTFfREVMQkEoCiAJRGVsYmFQYXJhbVNl
dC5maWVsZC5pbml0aWF0b3IJPSAoVHhSeFNlbGVjdCA9PSBUWF9ESVIpID8gMSA6IDA7CiAJRGVs
YmFQYXJhbVNldC5maWVsZC50aWQJPSBwQkEtPnBhcmFtX3NldC5maWVsZC50aWQ7CgotCXNrYiA9
IGRldl9hbGxvY19za2IobGVuICsgc2l6ZW9mKHN0cnVjdCBydGxfODAyMTFfaGRyXzNhZGRyKSk7
IC8vbmVlZCB0byBhZGQgc29tZXRoaW5nIG90aGVycz8gRklYTUUKKwlza2IgPSBkZXZfYWxsb2Nf
c2tiKGxlbiArIHNpemVvZihzdHJ1Y3QgcnRsXzgwMjExX2hkcl8zYWRkcikpOyAvKiBuZWVkIHRv
IGFkZCBzb21ldGhpbmcgb3RoZXJzPyBGSVhNRSAqLwogCWlmICghc2tiKQogCQlyZXR1cm4gTlVM
TDsKIC8vCW1lbXNldChza2ItPmRhdGEsIDAsIGxlbitzaXplb2YoIHN0cnVjdCBydGxfODAyMTFf
aGRyXzNhZGRyKSk7CkBAIC0yMTMsMTggKzIxMywxOCBAQCBzdGF0aWMgc3RydWN0IHNrX2J1ZmYg
KmllZWU4MDIxMV9ERUxCQSgKIAltZW1jcHkoRGVsYmEtPmFkZHIxLCBkc3QsIEVUSF9BTEVOKTsK
IAltZW1jcHkoRGVsYmEtPmFkZHIyLCBpZWVlLT5kZXYtPmRldl9hZGRyLCBFVEhfQUxFTik7CiAJ
bWVtY3B5KERlbGJhLT5hZGRyMywgaWVlZS0+Y3VycmVudF9uZXR3b3JrLmJzc2lkLCBFVEhfQUxF
Tik7Ci0JRGVsYmEtPmZyYW1lX2N0bCA9IGNwdV90b19sZTE2KElFRUU4MDIxMV9TVFlQRV9NQU5B
R0VfQUNUKTsgLy9hY3Rpb24gZnJhbWUKKwlEZWxiYS0+ZnJhbWVfY3RsID0gY3B1X3RvX2xlMTYo
SUVFRTgwMjExX1NUWVBFX01BTkFHRV9BQ1QpOyAvKiBhY3Rpb24gZnJhbWUgKi8KCiAJdGFnID0g
c2tiX3B1dChza2IsIDYpOwoKIAkqdGFnKysgPSBBQ1RfQ0FUX0JBOwogCSp0YWcrKyA9IEFDVF9E
RUxCQTsKCi0JLy8gREVMQkEgUGFyYW1ldGVyIFNldAorCS8qIERFTEJBIFBhcmFtZXRlciBTZXQg
Ki8KCiAJcHV0X3VuYWxpZ25lZF9sZTE2KERlbGJhUGFyYW1TZXQuc2hvcnRfZGF0YSwgdGFnKTsK
IAl0YWcgKz0gMjsKLQkvLyBSZWFzb24gQ29kZQorCS8qIFJlYXNvbiBDb2RlICovCgogCXB1dF91
bmFsaWduZWRfbGUxNihSZWFzb25Db2RlLCB0YWcpOwogCXRhZyArPSAyOwpAQCAtMjQ3LDEzICsy
NDcsMTUgQEAgc3RhdGljIHZvaWQgaWVlZTgwMjExX3NlbmRfQUREQkFSZXEoc3RydWN0IGllZWU4
MDIxMV9kZXZpY2UgKmllZWUsCiAJCQkJICAgIHU4ICpkc3QsIHN0cnVjdCBiYV9yZWNvcmQgKnBC
QSkKIHsKIAlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwotCXNrYiA9IGllZWU4MDIxMV9BRERCQShpZWVl
LCBkc3QsIHBCQSwgMCwgQUNUX0FEREJBUkVRKTsgLy9jb25zdHJ1Y3QgQUNUX0FEREJBUkVRIGZy
YW1lcyBzbyBzZXQgc3RhdHVzY29kZSB6ZXJvLgorCXNrYiA9IGllZWU4MDIxMV9BRERCQShpZWVl
LCBkc3QsIHBCQSwgMCwgQUNUX0FEREJBUkVRKTsgLyogY29uc3RydWN0IEFDVF9BRERCQVJFUSBm
cmFtZXMgc28gc2V0IHN0YXR1c2NvZGUgemVyby4gKi8KCiAJaWYgKHNrYikgewogCQlzb2Z0bWFj
X21nbXRfeG1pdChza2IsIGllZWUpOwotCQkvL2FkZCBzdGF0aXN0aWMgbmVlZGVkIGhlcmUuCi0J
CS8vYW5kIHNrYiB3aWxsIGJlIGZyZWVkIGluIHNvZnRtYWNfbWdtdF94bWl0KCksIHNvIG9taXQg
YWxsIGRldl9rZnJlZV9za2JfYW55KCkgb3V0c2lkZSBzb2Z0bWFjX21nbXRfeG1pdCgpCi0JCS8v
V0IKKwkJLyoKKwkJICogYWRkIHN0YXRpc3RpYyBuZWVkZWQgaGVyZS4KKwkJICogYW5kIHNrYiB3
aWxsIGJlIGZyZWVkIGluIHNvZnRtYWNfbWdtdF94bWl0KCksIHNvIG9taXQgYWxsIGRldl9rZnJl
ZV9za2JfYW55KCkgb3V0c2lkZSBzb2Z0bWFjX21nbXRfeG1pdCgpCisJCSAqIFdCCisJCSAqLwog
CX0gZWxzZSB7CiAJCUlFRUU4MDIxMV9ERUJVRyhJRUVFODAyMTFfRExfRVJSLCAiYWxsb2Mgc2ti
IGVycm9yIGluIGZ1bmN0aW9uICVzKClcbiIsIF9fZnVuY19fKTsKIAl9CkBAIC0yNzEsMTAgKzI3
MywxMCBAQCBzdGF0aWMgdm9pZCBpZWVlODAyMTFfc2VuZF9BRERCQVJzcChzdHJ1Y3QgaWVlZTgw
MjExX2RldmljZSAqaWVlZSwgdTggKmRzdCwKIAkJCQkgICAgc3RydWN0IGJhX3JlY29yZCAqcEJB
LCB1MTYgU3RhdHVzQ29kZSkKIHsKIAlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwotCXNrYiA9IGllZWU4
MDIxMV9BRERCQShpZWVlLCBkc3QsIHBCQSwgU3RhdHVzQ29kZSwgQUNUX0FEREJBUlNQKTsgLy9j
b25zdHJ1Y3QgQUNUX0FEREJBUlNQIGZyYW1lcworCXNrYiA9IGllZWU4MDIxMV9BRERCQShpZWVl
LCBkc3QsIHBCQSwgU3RhdHVzQ29kZSwgQUNUX0FEREJBUlNQKTsgLyogY29uc3RydWN0IEFDVF9B
RERCQVJTUCBmcmFtZXMgKi8KIAlpZiAoc2tiKSB7CiAJCXNvZnRtYWNfbWdtdF94bWl0KHNrYiwg
aWVlZSk7Ci0JCS8vc2FtZSBhYm92ZQorCQkvKiBzYW1lIGFib3ZlICovCiAJfSBlbHNlIHsKIAkJ
SUVFRTgwMjExX0RFQlVHKElFRUU4MDIxMV9ETF9FUlIsICJhbGxvYyBza2IgZXJyb3IgaW4gZnVu
Y3Rpb24gJXMoKVxuIiwgX19mdW5jX18pOwogCX0KQEAgLTI5NywxMCArMjk5LDEwIEBAIHN0YXRp
YyB2b2lkIGllZWU4MDIxMV9zZW5kX0RFTEJBKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVl
LCB1OCAqZHN0LAogCQkJCSB1MTYgUmVhc29uQ29kZSkKIHsKIAlzdHJ1Y3Qgc2tfYnVmZiAqc2ti
OwotCXNrYiA9IGllZWU4MDIxMV9ERUxCQShpZWVlLCBkc3QsIHBCQSwgVHhSeFNlbGVjdCwgUmVh
c29uQ29kZSk7IC8vY29uc3RydWN0IEFDVF9BRERCQVJTUCBmcmFtZXMKKwlza2IgPSBpZWVlODAy
MTFfREVMQkEoaWVlZSwgZHN0LCBwQkEsIFR4UnhTZWxlY3QsIFJlYXNvbkNvZGUpOyAvKiBjb25z
dHJ1Y3QgQUNUX0FEREJBUlNQIGZyYW1lcyAqLwogCWlmIChza2IpIHsKIAkJc29mdG1hY19tZ210
X3htaXQoc2tiLCBpZWVlKTsKLQkJLy9zYW1lIGFib3ZlCisJCS8qIHNhbWUgYWJvdmUgKi8KIAl9
IGVsc2UgewogCQlJRUVFODAyMTFfREVCVUcoSUVFRTgwMjExX0RMX0VSUiwgImFsbG9jIHNrYiBl
cnJvciBpbiBmdW5jdGlvbiAlcygpXG4iLCBfX2Z1bmNfXyk7CiAJfQpAQCAtMzM3LDEzICszMzks
MTMgQEAgaW50IGllZWU4MDIxMV9yeF9BRERCQVJlcShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAq
aWVlZSwgc3RydWN0IHNrX2J1ZmYgKnNrYikKIAl0YWcgPSAodTggKilyZXE7CiAJZHN0ID0gJnJl
cS0+YWRkcjJbMF07CiAJdGFnICs9IHNpemVvZihzdHJ1Y3QgcnRsXzgwMjExX2hkcl8zYWRkcik7
Ci0JcERpYWxvZ1Rva2VuID0gdGFnICsgMjsgIC8vY2F0ZWdvcnkrYWN0aW9uCi0JcEJhUGFyYW1T
ZXQgPSAodW5pb24gYmFfcGFyYW1fc2V0ICopKHRhZyArIDMpOyAgIC8vK0RpYWxvZ1Rva2VuCisJ
cERpYWxvZ1Rva2VuID0gdGFnICsgMjsgIC8qIGNhdGVnb3J5K2FjdGlvbiAqLworCXBCYVBhcmFt
U2V0ID0gKHVuaW9uIGJhX3BhcmFtX3NldCAqKSh0YWcgKyAzKTsgICAvKiArRGlhbG9nVG9rZW4g
Ki8KIAlwQmFUaW1lb3V0VmFsID0gKHUxNiAqKSh0YWcgKyA1KTsKIAlwQmFTdGFydFNlcUN0cmwg
PSAodW5pb24gc2VxdWVuY2VfY29udHJvbCAqKShyZXEgKyA3KTsKCiAJbmV0ZGV2X2luZm8oaWVl
ZS0+ZGV2LCAiPT09PT09PT09PT09PT09PT09PT0+cnggQUREQkFSRVEgZnJvbSA6JXBNXG4iLCBk
c3QpOwotLy9zb21lIG90aGVyIGNhcGFiaWxpdHkgaXMgbm90IHJlYWR5IG5vdy4KKwkvKiBzb21l
IG90aGVyIGNhcGFiaWxpdHkgaXMgbm90IHJlYWR5IG5vdy4gKi8KIAlpZiAoKGllZWUtPmN1cnJl
bnRfbmV0d29yay5xb3NfZGF0YS5hY3RpdmUgPT0gMCkgfHwKIAkJKCFpZWVlLT5wSFRJbmZvLT5i
Q3VycmVudEhUU3VwcG9ydCkpIC8vfHwKIAkvLwkoIWllZWUtPnBTdGFRb3MtPmJFbmFibGVSeElt
bUJBKQkpCkBAIC0zNTIsOCArMzU0LDggQEAgaW50IGllZWU4MDIxMV9yeF9BRERCQVJlcShzdHJ1
Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0IHNrX2J1ZmYgKnNrYikKIAkJSUVFRTgw
MjExX0RFQlVHKElFRUU4MDIxMV9ETF9FUlIsICJGYWlsZWQgdG8gcmVwbHkgb24gQUREQkFfUkVR
IGFzIHNvbWUgY2FwYWJpbGl0eSBpcyBub3QgcmVhZHkoJWQsICVkKVxuIiwgaWVlZS0+Y3VycmVu
dF9uZXR3b3JrLnFvc19kYXRhLmFjdGl2ZSwgaWVlZS0+cEhUSW5mby0+YkN1cnJlbnRIVFN1cHBv
cnQpOwogCQlnb3RvIE9uQUREQkFSZXFfRmFpbDsKIAl9Ci0JLy8gU2VhcmNoIGZvciByZWxhdGVk
IHRyYWZmaWMgc3RyZWFtLgotCS8vIElmIHRoZXJlIGlzIG5vIG1hdGNoZWQgVFMsIHJlamVjdCB0
aGUgQUREQkEgcmVxdWVzdC4KKwkvKiBTZWFyY2ggZm9yIHJlbGF0ZWQgdHJhZmZpYyBzdHJlYW0u
ICovCisJLyogSWYgdGhlcmUgaXMgbm8gbWF0Y2hlZCBUUywgcmVqZWN0IHRoZSBBRERCQSByZXF1
ZXN0LiAqLwogCWlmICghR2V0VHMoCiAJCQlpZWVlLAogCQkJKHN0cnVjdCB0c19jb21tb25faW5m
byAqKikoJnBUUyksCkBAIC0zNjYsMjMgKzM2OCwyMyBAQCBpbnQgaWVlZTgwMjExX3J4X0FEREJB
UmVxKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQog
CQlnb3RvIE9uQUREQkFSZXFfRmFpbDsKIAl9CiAJcEJBID0gJnBUUy0+cnhfYWRtaXR0ZWRfYmFf
cmVjb3JkOwotCS8vIFRvIERldGVybWluZSB0aGUgQUREQkEgUmVxIGNvbnRlbnQKLQkvLyBXZSBj
YW4gZG8gbXVjaCBtb3JlIGNoZWNrIGhlcmUsIGluY2x1ZGluZyBidWZmZXJfc2l6ZSwgQU1TRFVf
U3VwcG9ydCwgUG9saWN5LCBTdGFydFNlcUN0cmwuLi4KLQkvLyBJIHdhbnQgdG8gY2hlY2sgU3Rh
cnRTZXFDdHJsIHRvIG1ha2Ugc3VyZSB3aGVuIHdlIHN0YXJ0IGFnZ3JlZ2F0aW9uISEhCi0JLy8K
KwkvKgorCSAqIFRvIERldGVybWluZSB0aGUgQUREQkEgUmVxIGNvbnRlbnQKKwkgKiBXZSBjYW4g
ZG8gbXVjaCBtb3JlIGNoZWNrIGhlcmUsIGluY2x1ZGluZyBidWZmZXJfc2l6ZSwgQU1TRFVfU3Vw
cG9ydCwgUG9saWN5LCBTdGFydFNlcUN0cmwuLi4KKwkgKiBJIHdhbnQgdG8gY2hlY2sgU3RhcnRT
ZXFDdHJsIHRvIG1ha2Ugc3VyZSB3aGVuIHdlIHN0YXJ0IGFnZ3JlZ2F0aW9uISEhCisJICovCiAJ
aWYgKHBCYVBhcmFtU2V0LT5maWVsZC5iYV9wb2xpY3kgPT0gQkFfUE9MSUNZX0RFTEFZRUQpIHsK
IAkJcmMgPSBBRERCQV9TVEFUVVNfSU5WQUxJRF9QQVJBTTsKIAkJSUVFRTgwMjExX0RFQlVHKElF
RUU4MDIxMV9ETF9FUlIsICJCQSBQb2xpY3kgaXMgbm90IGNvcnJlY3QgaW4gJXMoKVxuIiwgX19m
dW5jX18pOwogCQlnb3RvIE9uQUREQkFSZXFfRmFpbDsKIAl9Ci0JCS8vIEFkbWl0IHRoZSBBRERC
QSBSZXF1ZXN0Ci0JLy8KKwkJLyogQWRtaXQgdGhlIEFEREJBIFJlcXVlc3QgKi8KIAlEZUFjdGl2
YXRlQkFFbnRyeShpZWVlLCBwQkEpOwogCXBCQS0+ZGlhbG9nX3Rva2VuID0gKnBEaWFsb2dUb2tl
bjsKIAlwQkEtPnBhcmFtX3NldCA9ICpwQmFQYXJhbVNldDsKIAlwQkEtPnRpbWVvdXRfdmFsdWUg
PSAqcEJhVGltZW91dFZhbDsKIAlwQkEtPnN0YXJ0X3NlcV9jdHJsID0gKnBCYVN0YXJ0U2VxQ3Ry
bDsKLQkvL2ZvciBoYWxmIE4gbW9kZSB3ZSBvbmx5IGFnZ3JlZ2F0ZSAxIGZyYW1lCisJLyogZm9y
IGhhbGYgTiBtb2RlIHdlIG9ubHkgYWdncmVnYXRlIDEgZnJhbWUgKi8KIAlpZiAoaWVlZS0+R2V0
SGFsZk5tb2RlU3VwcG9ydEJ5QVBzSGFuZGxlcihpZWVlLT5kZXYpKQogCQlwQkEtPnBhcmFtX3Nl
dC5maWVsZC5idWZmZXJfc2l6ZSA9IDE7CiAJZWxzZQpAQCAtMzkwLDcgKzM5Miw3IEBAIGludCBp
ZWVlODAyMTFfcnhfQUREQkFSZXEoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHN0cnVj
dCBza19idWZmICpza2IpCiAJQWN0aXZhdGVCQUVudHJ5KGllZWUsIHBCQSwgcEJBLT50aW1lb3V0
X3ZhbHVlKTsKIAlpZWVlODAyMTFfc2VuZF9BRERCQVJzcChpZWVlLCBkc3QsIHBCQSwgQUREQkFf
U1RBVFVTX1NVQ0NFU1MpOwoKLQkvLyBFbmQgb2YgcHJvY2VkdXJlLgorCS8qIEVuZCBvZiBwcm9j
ZWR1cmUuICovCiAJcmV0dXJuIDA7CgogT25BRERCQVJlcV9GYWlsOgpAQCAtNDAxLDcgKzQwMyw3
IEBAIGludCBpZWVlODAyMTFfcnhfQUREQkFSZXEoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmll
ZWUsIHN0cnVjdCBza19idWZmICpza2IpCiAJCUJBLmRpYWxvZ190b2tlbiA9ICpwRGlhbG9nVG9r
ZW47CiAJCUJBLnBhcmFtX3NldC5maWVsZC5iYV9wb2xpY3kgPSBCQV9QT0xJQ1lfSU1NRURJQVRF
OwogCQlpZWVlODAyMTFfc2VuZF9BRERCQVJzcChpZWVlLCBkc3QsICZCQSwgcmMpOwotCQlyZXR1
cm4gMDsgLy93ZSBzZW5kIFJTUCBvdXQuCisJCXJldHVybiAwOyAvKiB3ZSBzZW5kIFJTUCBvdXQu
ICovCiAJfQoKIH0KQEAgLTQzOCw4ICs0NDAsMTAgQEAgaW50IGllZWU4MDIxMV9yeF9BRERCQVJz
cChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0IHNrX2J1ZmYgKnNrYikKIAlw
QmFQYXJhbVNldCA9ICh1bmlvbiBiYV9wYXJhbV9zZXQgKikodGFnICsgNSk7CiAJcEJhVGltZW91
dFZhbCA9ICh1MTYgKikodGFnICsgNyk7CgotCS8vIENoZWNrIHRoZSBjYXBhYmlsaXR5Ci0JLy8g
U2luY2Ugd2UgY2FuIGFsd2F5cyByZWNlaXZlIEEtTVBEVSwgd2UganVzdCBjaGVjayBpZiBpdCBp
cyB1bmRlciBIVCBtb2RlLgorCS8qCisJICogQ2hlY2sgdGhlIGNhcGFiaWxpdHkKKwkgKiBTaW5j
ZSB3ZSBjYW4gYWx3YXlzIHJlY2VpdmUgQS1NUERVLCB3ZSBqdXN0IGNoZWNrIGlmIGl0IGlzIHVu
ZGVyIEhUIG1vZGUuCisJICovCiAJaWYgKGllZWUtPmN1cnJlbnRfbmV0d29yay5xb3NfZGF0YS5h
Y3RpdmUgPT0gMCAgfHwKIAkgICAgIWllZWUtPnBIVEluZm8tPmJDdXJyZW50SFRTdXBwb3J0IHx8
CiAJICAgICFpZWVlLT5wSFRJbmZvLT5iQ3VycmVudEFNUERVRW5hYmxlKSB7CkBAIC00NDksMTAg
KzQ1MywxMCBAQCBpbnQgaWVlZTgwMjExX3J4X0FEREJBUnNwKHN0cnVjdCBpZWVlODAyMTFfZGV2
aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQogCX0KCgotCS8vCi0JLy8gU2VhcmNoIGZv
ciByZWxhdGVkIFRTLgotCS8vIElmIHRoZXJlIGlzIG5vIFRTIGZvdW5kLCB3ZSB3aWwgcmVqZWN0
IEFEREJBIFJzcCBieSBzZW5kaW5nIERFTEJBIGZyYW1lLgotCS8vCisJLyoKKwkgKiBTZWFyY2gg
Zm9yIHJlbGF0ZWQgVFMuCisJICogSWYgdGhlcmUgaXMgbm8gVFMgZm91bmQsIHdlIHdpbCByZWpl
Y3QgQUREQkEgUnNwIGJ5IHNlbmRpbmcgREVMQkEgZnJhbWUuCisJICovCiAJaWYgKCFHZXRUcygK
IAkJCWllZWUsCiAJCQkoc3RydWN0IHRzX2NvbW1vbl9pbmZvICoqKSgmcFRTKSwKQEAgLTQ3MCwx
MiArNDc0LDEyIEBAIGludCBpZWVlODAyMTFfcnhfQUREQkFSc3Aoc3RydWN0IGllZWU4MDIxMV9k
ZXZpY2UgKmllZWUsIHN0cnVjdCBza19idWZmICpza2IpCiAJcEFkbWl0dGVkQkEgPSAmcFRTLT50
eF9hZG1pdHRlZF9iYV9yZWNvcmQ7CgoKLQkvLwotCS8vIENoZWNrIGlmIHJlbGF0ZWQgQkEgaXMg
d2FpdGluZyBmb3Igc2V0dXAuCi0JLy8gSWYgbm90LCByZWplY3QgYnkgc2VuZGluZyBERUxCQSBm
cmFtZS4KLQkvLworCS8qCisJICogQ2hlY2sgaWYgcmVsYXRlZCBCQSBpcyB3YWl0aW5nIGZvciBz
ZXR1cC4KKwkgKiBJZiBub3QsIHJlamVjdCBieSBzZW5kaW5nIERFTEJBIGZyYW1lLgorCSAqLwog
CWlmIChwQWRtaXR0ZWRCQS0+dmFsaWQpIHsKLQkJLy8gU2luY2UgQkEgaXMgYWxyZWFkeSBzZXR1
cCwgd2UgaWdub3JlIGFsbCBvdGhlciBBRERCQSBSZXNwb25zZS4KKwkJLyogU2luY2UgQkEgaXMg
YWxyZWFkeSBzZXR1cCwgd2UgaWdub3JlIGFsbCBvdGhlciBBRERCQSBSZXNwb25zZS4gKi8KIAkJ
SUVFRTgwMjExX0RFQlVHKElFRUU4MDIxMV9ETF9CQSwgIk9uQUREQkFSc3AoKTogUmVjdiBBRERC
QSBSc3AuIERyb3AgYmVjYXVzZSBhbHJlYWR5IGFkbWl0IGl0ISBcbiIpOwogCQlyZXR1cm4gLTE7
CiAJfSBlbHNlIGlmICgoIXBQZW5kaW5nQkEtPnZhbGlkKSB8fCAoKnBEaWFsb2dUb2tlbiAhPSBw
UGVuZGluZ0JBLT5kaWFsb2dfdG9rZW4pKSB7CkBAIC00ODksMTMgKzQ5MywxMyBAQCBpbnQgaWVl
ZTgwMjExX3J4X0FEREJBUnNwKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1Y3Qg
c2tfYnVmZiAqc2tiKQoKCiAJaWYgKCpwU3RhdHVzQ29kZSA9PSBBRERCQV9TVEFUVVNfU1VDQ0VT
UykgewotCQkvLwotCQkvLyBEZXRlcm1pbmUgQUREQkEgUnNwIGNvbnRlbnQgaGVyZS4KLQkJLy8g
V2UgY2FuIGNvbXBhcmUgdGhlIHZhbHVlIG9mIEJBIHBhcmFtZXRlciBzZXQgdGhhdCBQZWVyIHJl
dHVybmVkIGFuZCBTZWxmIHNlbnQuCi0JCS8vIElmIGl0IGlzIE9LLCB0aGVuIGFkbWl0dGVkLiBP
ciB3ZSBjYW4gc2VuZCBERUxCQSB0byBjYW5jZWwgQkEgbWVjaGFuaXNtLgotCQkvLworCQkvKgor
CQkgKiBEZXRlcm1pbmUgQUREQkEgUnNwIGNvbnRlbnQgaGVyZS4KKwkJICogV2UgY2FuIGNvbXBh
cmUgdGhlIHZhbHVlIG9mIEJBIHBhcmFtZXRlciBzZXQgdGhhdCBQZWVyIHJldHVybmVkIGFuZCBT
ZWxmIHNlbnQuCisJCSAqIElmIGl0IGlzIE9LLCB0aGVuIGFkbWl0dGVkLiBPciB3ZSBjYW4gc2Vu
ZCBERUxCQSB0byBjYW5jZWwgQkEgbWVjaGFuaXNtLgorCQkgKi8KIAkJaWYgKHBCYVBhcmFtU2V0
LT5maWVsZC5iYV9wb2xpY3kgPT0gQkFfUE9MSUNZX0RFTEFZRUQpIHsKLQkJCS8vIFNpbmNlIHRo
aXMgaXMgYSBraW5kIG9mIEFEREJBIGZhaWxlZCwgd2UgZGVsYXkgbmV4dCBBRERCQSBwcm9jZXNz
LgorCQkJLyogU2luY2UgdGhpcyBpcyBhIGtpbmQgb2YgQUREQkEgZmFpbGVkLCB3ZSBkZWxheSBu
ZXh0IEFEREJBIHByb2Nlc3MuICovCiAJCQlwVFMtPmFkZF9iYV9yZXFfZGVsYXllZCA9IHRydWU7
CiAJCQlEZUFjdGl2YXRlQkFFbnRyeShpZWVlLCBwQWRtaXR0ZWRCQSk7CiAJCQlSZWFzb25Db2Rl
ID0gREVMQkFfUkVBU09OX0VORF9CQTsKQEAgLTUwMyw5ICs1MDcsOSBAQCBpbnQgaWVlZTgwMjEx
X3J4X0FEREJBUnNwKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVm
ZiAqc2tiKQogCQl9CgoKLQkJLy8KLQkJLy8gQWRtaXR0ZWQgY29uZGl0aW9uCi0JCS8vCisJCS8q
CisJCSAqIEFkbWl0dGVkIGNvbmRpdGlvbgorCQkgKi8KIAkJcEFkbWl0dGVkQkEtPmRpYWxvZ190
b2tlbiA9ICpwRGlhbG9nVG9rZW47CiAJCXBBZG1pdHRlZEJBLT50aW1lb3V0X3ZhbHVlID0gKnBC
YVRpbWVvdXRWYWw7CiAJCXBBZG1pdHRlZEJBLT5zdGFydF9zZXFfY3RybCA9IHBQZW5kaW5nQkEt
PnN0YXJ0X3NlcV9jdHJsOwpAQCAtNTEzLDExICs1MTcsMTEgQEAgaW50IGllZWU4MDIxMV9yeF9B
RERCQVJzcChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0IHNrX2J1ZmYgKnNr
YikKIAkJRGVBY3RpdmF0ZUJBRW50cnkoaWVlZSwgcEFkbWl0dGVkQkEpOwogCQlBY3RpdmF0ZUJB
RW50cnkoaWVlZSwgcEFkbWl0dGVkQkEsICpwQmFUaW1lb3V0VmFsKTsKIAl9IGVsc2UgewotCQkv
LyBEZWxheSBuZXh0IEFEREJBIHByb2Nlc3MuCisJCS8qIERlbGF5IG5leHQgQUREQkEgcHJvY2Vz
cy4gKi8KIAkJcFRTLT5hZGRfYmFfcmVxX2RlbGF5ZWQgPSB0cnVlOwogCX0KCi0JLy8gRW5kIG9m
IHByb2NlZHVyZQorCS8qIEVuZCBvZiBwcm9jZWR1cmUgKi8KIAlyZXR1cm4gMDsKCiBPbkFEREJB
UnNwX1JlamVjdDoKQEAgLTYwMCw5ICs2MDQsOSBAQCBpbnQgaWVlZTgwMjExX3J4X0RFTEJBKHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQogCXJldHVy
biAwOwogfQoKLS8vCi0vLyBBRERCQSBpbml0aWF0ZS4gVGhpcyBjYW4gb25seSBiZSBjYWxsZWQg
YnkgVFggc2lkZS4KLS8vCisvKgorICogQUREQkEgaW5pdGlhdGUuIFRoaXMgY2FuIG9ubHkgYmUg
Y2FsbGVkIGJ5IFRYIHNpZGUuCisgKi8KIHZvaWQKIFRzSW5pdEFkZEJBKAogCXN0cnVjdCBpZWVl
ODAyMTFfZGV2aWNlICppZWVlLApAQCAtNjE2LDE3ICs2MjAsMTcgQEAgVHNJbml0QWRkQkEoCiAJ
aWYgKHBCQS0+dmFsaWQgJiYgIWJPdmVyd3JpdGVQZW5kaW5nKQogCQlyZXR1cm47CgotCS8vIFNl
dCBwYXJhbWV0ZXJzIHRvICJQZW5kaW5nIiB2YXJpYWJsZSBzZXQKKwkvKiBTZXQgcGFyYW1ldGVy
cyB0byAiUGVuZGluZyIgdmFyaWFibGUgc2V0ICovCiAJRGVBY3RpdmF0ZUJBRW50cnkoaWVlZSwg
cEJBKTsKCi0JcEJBLT5kaWFsb2dfdG9rZW4rKzsJCQkJCQkvLyBEaWFsb2dUb2tlbjogT25seSBr
ZWVwIHRoZSBsYXRlc3QgZGlhbG9nIHRva2VuCi0JcEJBLT5wYXJhbV9zZXQuZmllbGQuYW1zZHVf
c3VwcG9ydCA9IDA7CS8vIERvIG5vdCBzdXBwb3J0IEEtTVNEVSB3aXRoIEEtTVBEVSBub3chIQot
CXBCQS0+cGFyYW1fc2V0LmZpZWxkLmJhX3BvbGljeSA9IFBvbGljeTsJLy8gUG9saWN5OiBEZWxh
eWVkIG9yIEltbWVkaWF0ZQotCXBCQS0+cGFyYW1fc2V0LmZpZWxkLnRpZCA9IHBUUy0+dHNfY29t
bW9uX2luZm8udF9zcGVjLnRzX2luZm8udWNfdHNpZDsJLy8gVElECi0JLy8gYnVmZmVyX3NpemU6
IFRoaXMgbmVlZCB0byBiZSBzZXQgYWNjb3JkaW5nIHRvIEEtTVBEVSB2ZWN0b3IKLQlwQkEtPnBh
cmFtX3NldC5maWVsZC5idWZmZXJfc2l6ZSA9IDMyOwkJLy8gYnVmZmVyX3NpemU6IFRoaXMgbmVl
ZCB0byBiZSBzZXQgYWNjb3JkaW5nIHRvIEEtTVBEVSB2ZWN0b3IKLQlwQkEtPnRpbWVvdXRfdmFs
dWUgPSAwOwkJCQkJLy8gVGltZW91dCB2YWx1ZTogU2V0IDAgdG8gZGlzYWJsZSBUaW1lcgotCXBC
QS0+c3RhcnRfc2VxX2N0cmwuZmllbGQuc2VxX251bSA9IChwVFMtPnR4X2N1cl9zZXEgKyAzKSAl
IDQwOTY7CS8vIEJsb2NrIEFjayB3aWxsIHN0YXJ0IGFmdGVyIDMgcGFja2V0cyBsYXRlci4KKwlw
QkEtPmRpYWxvZ190b2tlbisrOwkJCQkJCS8qIERpYWxvZ1Rva2VuOiBPbmx5IGtlZXAgdGhlIGxh
dGVzdCBkaWFsb2cgdG9rZW4gKi8KKwlwQkEtPnBhcmFtX3NldC5maWVsZC5hbXNkdV9zdXBwb3J0
ID0gMDsJLyogRG8gbm90IHN1cHBvcnQgQS1NU0RVIHdpdGggQS1NUERVIG5vdyEhICovCisJcEJB
LT5wYXJhbV9zZXQuZmllbGQuYmFfcG9saWN5ID0gUG9saWN5OwkvKiBQb2xpY3k6IERlbGF5ZWQg
b3IgSW1tZWRpYXRlICovCisJcEJBLT5wYXJhbV9zZXQuZmllbGQudGlkID0gcFRTLT50c19jb21t
b25faW5mby50X3NwZWMudHNfaW5mby51Y190c2lkOwkvKiBUSUQgKi8KKwkvKiBidWZmZXJfc2l6
ZTogVGhpcyBuZWVkIHRvIGJlIHNldCBhY2NvcmRpbmcgdG8gQS1NUERVIHZlY3RvciAqLworCXBC
QS0+cGFyYW1fc2V0LmZpZWxkLmJ1ZmZlcl9zaXplID0gMzI7CQkvKiBidWZmZXJfc2l6ZTogVGhp
cyBuZWVkIHRvIGJlIHNldCBhY2NvcmRpbmcgdG8gQS1NUERVIHZlY3RvciAqLworCXBCQS0+dGlt
ZW91dF92YWx1ZSA9IDA7CQkJCQkvKiBUaW1lb3V0IHZhbHVlOiBTZXQgMCB0byBkaXNhYmxlIFRp
bWVyICovCisJcEJBLT5zdGFydF9zZXFfY3RybC5maWVsZC5zZXFfbnVtID0gKHBUUy0+dHhfY3Vy
X3NlcSArIDMpICUgNDA5NjsJLyogQmxvY2sgQWNrIHdpbGwgc3RhcnQgYWZ0ZXIgMyBwYWNrZXRz
IGxhdGVyLiAqLwoKIAlBY3RpdmF0ZUJBRW50cnkoaWVlZSwgcEJBLCBCQV9TRVRVUF9USU1FT1VU
KTsKCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgx
OXhfSFQuaCBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvcnRsODE5eF9IVC5o
CmluZGV4IGI3NzY5YmNhOTc0MC4uNTY5MWRlMDNlNzQwIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0
YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfSFQuaAorKysgYi9kcml2ZXJzL3N0YWdp
bmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfSFQuaApAQCAtMzgsNyArMzgsNyBAQCBlbnVt
IGh0X2V4dGVuc2lvbl9jaGFuX29mZnNldCB7CiB9OwoKIHN0cnVjdCBodF9jYXBhYmlsaXR5X2Vs
ZSB7Ci0JLy9IVCBjYXBhYmlsaXR5IGluZm8KKwkvKiBIVCBjYXBhYmlsaXR5IGluZm8gKi8KIAl1
OAlBZHZDb2Rpbmc6MTsKIAl1OAlDaGxXaWR0aDoxOwogCXU4CU1pbW9Qd3JTYXZlOjI7CkBAIC01
NCwyMSArNTQsMjEgQEAgc3RydWN0IGh0X2NhcGFiaWxpdHlfZWxlIHsKIAl1OAlSc3ZkMToxOwog
CXU4CUxTaWdUeG9wUHJvdGVjdDoxOwoKLQkvL01BQyBIVCBwYXJhbWV0ZXJzIGluZm8KKwkvKiBN
QUMgSFQgcGFyYW1ldGVycyBpbmZvICovCiAJdTgJTWF4UnhBTVBEVUZhY3RvcjoyOwogCXU4CU1Q
RFVEZW5zaXR5OjM7CiAJdTgJUnN2ZDI6MzsKCi0JLy9TdXBwb3J0ZWQgTUNTIHNldAorCS8qIFN1
cHBvcnRlZCBNQ1Mgc2V0ICovCiAJdTgJTUNTWzE2XTsKCi0JLy9FeHRlbmRlZCBIVCBDYXBhYmls
aXR5IEluZm8KKwkvKiBFeHRlbmRlZCBIVCBDYXBhYmlsaXR5IEluZm8gKi8KIAl1MTYJRXh0SFRD
YXBJbmZvOwoKLQkvL1RYQkYgQ2FwYWJpbGl0aWVzCisJLyogVFhCRiBDYXBhYmlsaXRpZXMgKi8K
IAl1OAlUeEJGQ2FwWzRdOwoKLQkvL0FudGVubmEgU2VsZWN0aW9uIENhcGFiaWxpdGllcworCS8q
IEFudGVubmEgU2VsZWN0aW9uIENhcGFiaWxpdGllcyAqLwogCXU4CUFTQ2FwOwoKIH0gX19wYWNr
ZWQ7CkBAIC0xMjQsNDkgKzEyNCw0OSBAQCB0eXBlZGVmIHN0cnVjdCBfUlRfSElHSF9USFJPVUdI
UFVUIHsKIAl1OAkJCQliRW5hYmxlSFQ7CiAJdTgJCQkJYkN1cnJlbnRIVFN1cHBvcnQ7CgotCXU4
CQkJCWJSZWdCVzQwTUh6OwkJCQkvLyBUeCA0ME1IeiBjaGFubmVsIGNhcGFiaWxpdHkKLQl1OAkJ
CQliQ3VyQlc0ME1IejsJCQkJLy8gVHggNDBNSHogY2hhbm5lbCBjYXBhYmlsaXR5CisJdTgJCQkJ
YlJlZ0JXNDBNSHo7CQkJCS8qIFR4IDQwTUh6IGNoYW5uZWwgY2FwYWJpbGl0eSAqLworCXU4CQkJ
CWJDdXJCVzQwTUh6OwkJCQkvKiBUeCA0ME1IeiBjaGFubmVsIGNhcGFiaWxpdHkgKi8KCi0JdTgJ
CQkJYlJlZ1Nob3J0R0k0ME1IejsJCQkvLyBUeCBTaG9ydCBHSSBmb3IgNDBNaHoKLQl1OAkJCQli
Q3VyU2hvcnRHSTQwTUh6OwkJCS8vIFR4IFNob3J0IEdJIGZvciA0ME1IegorCXU4CQkJCWJSZWdT
aG9ydEdJNDBNSHo7CQkJLyogVHggU2hvcnQgR0kgZm9yIDQwTWh6ICovCisJdTgJCQkJYkN1clNo
b3J0R0k0ME1IejsJCQkvKiBUeCBTaG9ydCBHSSBmb3IgNDBNSHogKi8KCi0JdTgJCQkJYlJlZ1No
b3J0R0kyME1IejsJCQkvLyBUeCBTaG9ydCBHSSBmb3IgMjBNSHoKLQl1OAkJCQliQ3VyU2hvcnRH
STIwTUh6OwkJCS8vIFR4IFNob3J0IEdJIGZvciAyME1IegorCXU4CQkJCWJSZWdTaG9ydEdJMjBN
SHo7CQkJLyogVHggU2hvcnQgR0kgZm9yIDIwTUh6ICovCisJdTgJCQkJYkN1clNob3J0R0kyME1I
ejsJCQkvKiBUeCBTaG9ydCBHSSBmb3IgMjBNSHogKi8KCi0JdTgJCQkJYlJlZ1N1cHBDQ0s7CQkJ
CS8vIFR4IENDSyByYXRlIGNhcGFiaWxpdHkKLQl1OAkJCQliQ3VyU3VwcENDSzsJCQkJLy8gVHgg
Q0NLIHJhdGUgY2FwYWJpbGl0eQorCXU4CQkJCWJSZWdTdXBwQ0NLOwkJCQkvKiBUeCBDQ0sgcmF0
ZSBjYXBhYmlsaXR5ICovCisJdTgJCQkJYkN1clN1cHBDQ0s7CQkJCS8qIFR4IENDSyByYXRlIGNh
cGFiaWxpdHkgKi8KCi0JLy8gODAyLjExbiBzcGVjIHZlcnNpb24gZm9yICJwZWVyIgorCS8qIDgw
Mi4xMW4gc3BlYyB2ZXJzaW9uIGZvciAicGVlciIgKi8KIAlIVF9TUEVDX1ZFUgkJCWVQZWVySFRT
cGVjVmVyOwoKLQkvLyBIVCByZWxhdGVkIGluZm9ybWF0aW9uIGZvciAiU2VsZiIKLQlzdHJ1Y3Qg
aHRfY2FwYWJpbGl0eV9lbGUJU2VsZkhUQ2FwOwkJLy8gVGhpcyBpcyBIVCBjYXAgZWxlbWVudCBz
ZW50IHRvIHBlZXIgU1RBLCB3aGljaCBhbHNvIGluZGljYXRlIEhUIFJ4IGNhcGFiaWxpdGllcy4K
LQlIVF9JTkZPUk1BVElPTl9FTEUJU2VsZkhUSW5mbzsJCS8vIFRoaXMgaXMgSFQgaW5mbyBlbGVt
ZW50IHNlbnQgdG8gcGVlciBTVEEsIHdoaWNoIGFsc28gaW5kaWNhdGUgSFQgUnggY2FwYWJpbGl0
aWVzLgorCS8qIEhUIHJlbGF0ZWQgaW5mb3JtYXRpb24gZm9yICJTZWxmIiAqLworCXN0cnVjdCBo
dF9jYXBhYmlsaXR5X2VsZQlTZWxmSFRDYXA7CQkvKiBUaGlzIGlzIEhUIGNhcCBlbGVtZW50IHNl
bnQgdG8gcGVlciBTVEEsIHdoaWNoIGFsc28gaW5kaWNhdGUgSFQgUnggY2FwYWJpbGl0aWVzLiAq
LworCUhUX0lORk9STUFUSU9OX0VMRQlTZWxmSFRJbmZvOwkJLyogVGhpcyBpcyBIVCBpbmZvIGVs
ZW1lbnQgc2VudCB0byBwZWVyIFNUQSwgd2hpY2ggYWxzbyBpbmRpY2F0ZSBIVCBSeCBjYXBhYmls
aXRpZXMuICovCgotCS8vIEhUIHJlbGF0ZWQgaW5mb3JtYXRpb24gZm9yICJQZWVyIgorCS8qIEhU
IHJlbGF0ZWQgaW5mb3JtYXRpb24gZm9yICJQZWVyIiAqLwogCXU4CQkJCVBlZXJIVENhcEJ1Zlsz
Ml07CiAJdTgJCQkJUGVlckhUSW5mb0J1ZlszMl07CgotCS8vIEEtTVNEVSByZWxhdGVkCi0JdTgJ
CQkJYkFNU0RVX1N1cHBvcnQ7CQkJLy8gVGhpcyBpbmRpY2F0ZXMgVHggQS1NU0RVIGNhcGFiaWxp
dHkKLQl1MTYJCQkJbkFNU0RVX01heFNpemU7CQkJLy8gVGhpcyBpbmRpY2F0ZXMgVHggQS1NU0RV
IGNhcGFiaWxpdHkKLQl1OAkJCQliQ3VycmVudF9BTVNEVV9TdXBwb3J0OwkvLyBUaGlzIGluZGlj
YXRlcyBUeCBBLU1TRFUgY2FwYWJpbGl0eQotCXUxNgkJCQluQ3VycmVudF9BTVNEVV9NYXhTaXpl
OwkvLyBUaGlzIGluZGljYXRlcyBUeCBBLU1TRFUgY2FwYWJpbGl0eQotCi0JLy8gQU1QRFUgIHJl
bGF0ZWQgPDIwMDYuMDguMTAgRW1pbHk+Ci0JdTgJCQkJYkFNUERVRW5hYmxlOwkJCQkvLyBUaGlz
IGluZGljYXRlIFR4IEEtTVBEVSBjYXBhYmlsaXR5Ci0JdTgJCQkJYkN1cnJlbnRBTVBEVUVuYWJs
ZTsJCS8vIFRoaXMgaW5kaWNhdGUgVHggQS1NUERVIGNhcGFiaWxpdHkKLQl1OAkJCQlBTVBEVV9G
YWN0b3I7CQkJCS8vIFRoaXMgaW5kaWNhdGUgVHggQS1NUERVIGNhcGFiaWxpdHkKLQl1OAkJCQlD
dXJyZW50QU1QRFVGYWN0b3I7CQkvLyBUaGlzIGluZGljYXRlIFR4IEEtTVBEVSBjYXBhYmlsaXR5
Ci0JdTgJCQkJTVBEVV9EZW5zaXR5OwkJCQkvLyBUaGlzIGluZGljYXRlIFR4IEEtTVBEVSBjYXBh
YmlsaXR5Ci0JdTgJCQkJQ3VycmVudE1QRFVEZW5zaXR5OwkJCS8vIFRoaXMgaW5kaWNhdGUgVHgg
QS1NUERVIGNhcGFiaWxpdHkKLQotCS8vIEZvcmNlZCBBLU1QRFUgZW5hYmxlCisJLyogQS1NU0RV
IHJlbGF0ZWQgKi8KKwl1OAkJCQliQU1TRFVfU3VwcG9ydDsJCQkvKiBUaGlzIGluZGljYXRlcyBU
eCBBLU1TRFUgY2FwYWJpbGl0eSAqLworCXUxNgkJCQluQU1TRFVfTWF4U2l6ZTsJCQkvKiBUaGlz
IGluZGljYXRlcyBUeCBBLU1TRFUgY2FwYWJpbGl0eSAqLworCXU4CQkJCWJDdXJyZW50X0FNU0RV
X1N1cHBvcnQ7CS8qIFRoaXMgaW5kaWNhdGVzIFR4IEEtTVNEVSBjYXBhYmlsaXR5ICovCisJdTE2
CQkJCW5DdXJyZW50X0FNU0RVX01heFNpemU7CS8qIFRoaXMgaW5kaWNhdGVzIFR4IEEtTVNEVSBj
YXBhYmlsaXR5ICovCisKKwkvKiBBTVBEVSAgcmVsYXRlZCA8MjAwNi4wOC4xMCBFbWlseT4gKi8K
Kwl1OAkJCQliQU1QRFVFbmFibGU7CQkJCS8qIFRoaXMgaW5kaWNhdGUgVHggQS1NUERVIGNhcGFi
aWxpdHkgKi8KKwl1OAkJCQliQ3VycmVudEFNUERVRW5hYmxlOwkJLyogVGhpcyBpbmRpY2F0ZSBU
eCBBLU1QRFUgY2FwYWJpbGl0eSAqLworCXU4CQkJCUFNUERVX0ZhY3RvcjsJCQkJLyogVGhpcyBp
bmRpY2F0ZSBUeCBBLU1QRFUgY2FwYWJpbGl0eSAqLworCXU4CQkJCUN1cnJlbnRBTVBEVUZhY3Rv
cjsJCS8qIFRoaXMgaW5kaWNhdGUgVHggQS1NUERVIGNhcGFiaWxpdHkgKi8KKwl1OAkJCQlNUERV
X0RlbnNpdHk7CQkJCS8qIFRoaXMgaW5kaWNhdGUgVHggQS1NUERVIGNhcGFiaWxpdHkgKi8KKwl1
OAkJCQlDdXJyZW50TVBEVURlbnNpdHk7CQkJLyogVGhpcyBpbmRpY2F0ZSBUeCBBLU1QRFUgY2Fw
YWJpbGl0eSAqLworCisJLyogRm9yY2VkIEEtTVBEVSBlbmFibGUgKi8KIAlIVF9BR0dSRV9NT0RF
X0UJRm9yY2VkQU1QRFVNb2RlOwogCXU4CQkJCUZvcmNlZEFNUERVRmFjdG9yOwogCXU4CQkJCUZv
cmNlZE1QRFVEZW5zaXR5OwoKLQkvLyBGb3JjZWQgQS1NU0RVIGVuYWJsZQorCS8qIEZvcmNlZCBB
LU1TRFUgZW5hYmxlICovCiAJSFRfQUdHUkVfTU9ERV9FCUZvcmNlZEFNU0RVTW9kZTsKIAl1MTYJ
CQkJRm9yY2VkQU1TRFVNYXhTaXplOwoKQEAgLTE3NCwyNyArMTc0LDI3IEBAIHR5cGVkZWYgc3Ry
dWN0IF9SVF9ISUdIX1RIUk9VR0hQVVQgewoKIAl1OAkJCQlDdXJyZW50T3BNb2RlOwoKLQkvLyBN
SU1PIFBTIHJlbGF0ZWQKKwkvKiBNSU1PIFBTIHJlbGF0ZWQgKi8KIAl1OAkJCQlTZWxmTWltb1Bz
OwogCXU4CQkJCVBlZXJNaW1vUHM7CgotCS8vIDQwTUh6IENoYW5uZWwgT2Zmc2V0IHNldHRpbmdz
LgorCS8qIDQwTUh6IENoYW5uZWwgT2Zmc2V0IHNldHRpbmdzLiAqLwogCWVudW0gaHRfZXh0ZW5z
aW9uX2NoYW5fb2Zmc2V0CUN1clNUQUV4dENobmxPZmZzZXQ7Ci0JdTgJCQkJYkN1clR4Qlc0ME1I
ejsJLy8gSWYgd2UgdXNlIDQwIE1IeiB0byBUeAorCXU4CQkJCWJDdXJUeEJXNDBNSHo7CS8qIElm
IHdlIHVzZSA0MCBNSHogdG8gVHggKi8KIAl1OAkJCQlQZWVyQmFuZHdpZHRoOwoKLQkvLyBGb3Ig
QmFuZHdpZHRoIFN3aXRjaGluZworCS8qIEZvciBCYW5kd2lkdGggU3dpdGNoaW5nICovCiAJdTgJ
CQkJYlN3QndJblByb2dyZXNzOwogCXU4CQkJCVN3QndTdGVwOwogCS8vc3RydWN0IHRpbWVyX2xp
c3QJCVN3QndUaW1lcjsgIC8vbW92ZWQgdG8gaWVlZTgwMjExX2RldmljZS4gYXMgdGltZXJfbGlz
dCBuZWVkIGluY2x1ZGUgc29tZSBoZWFkZXIgZmlsZSBoZXJlLgoKLQkvLyBGb3IgUmVhbHRlayBw
cm9wcmlldGFyeSBBLU1QRFUgZmFjdG9yIGZvciBhZ2dyZWdhdGlvbgorCS8qIEZvciBSZWFsdGVr
IHByb3ByaWV0YXJ5IEEtTVBEVSBmYWN0b3IgZm9yIGFnZ3JlZ2F0aW9uICovCiAJdTgJCQkJYlJl
Z1JUMlJUQWdncmVnYXRpb247CiAJdTgJCQkJYkN1cnJlbnRSVDJSVEFnZ3JlZ2F0aW9uOwogCXU4
CQkJCWJDdXJyZW50UlQyUlRMb25nU2xvdFRpbWU7CiAJdTgJCQkJc3pSVDJSVEFnZ0J1ZmZlclsx
MF07CgotCS8vIFJ4IFJlb3JkZXIgY29udHJvbAorCS8qIFJ4IFJlb3JkZXIgY29udHJvbCAqLwog
CXU4CQkJCWJSZWdSeFJlb3JkZXJFbmFibGU7CiAJdTgJCQkJYkN1clJ4UmVvcmRlckVuYWJsZTsK
IAl1OAkJCQlSeFJlb3JkZXJXaW5TaXplOwpAQCAtMjExLDEwICsyMTEsMTAgQEAgdHlwZWRlZiBz
dHJ1Y3QgX1JUX0hJR0hfVEhST1VHSFBVVCB7CiAJdTgJCQkJVXNiUnhGd0FnZ3JUaW1lb3V0Owog
I2VuZGlmCgotCS8vIEFkZCBmb3IgQnJvYWRjb20oTGlua3N5cykgSU9ULiBKb3NlcGgKKwkvKiBB
ZGQgZm9yIEJyb2FkY29tKExpbmtzeXMpIElPVC4gSm9zZXBoICovCiAJdTgJCQkJYklzUGVlckJj
bTsKCi0JLy8gRm9yIElPVCBpc3N1ZS4KKwkvKiBGb3IgSU9UIGlzc3VlLiAqLwogCXU4CQkJCUlP
VFBlZXI7CiAJdTMyCQkJCUlPVEFjdGlvbjsKIH0gX19hdHRyaWJ1dGVfXyAoKHBhY2tlZCkpIFJU
X0hJR0hfVEhST1VHSFBVVCwgKlBSVF9ISUdIX1RIUk9VR0hQVVQ7CkBAIC0yMjYsNyArMjI2LDcg
QEAgdHlwZWRlZiBzdHJ1Y3QgX1JUX0hJR0hfVEhST1VHSFBVVCB7CiB0eXBlZGVmIHN0cnVjdCBf
QlNTX0hUIHsKIAl1OAkJCQliZFN1cHBvcnRIVDsKCi0JLy8gSFQgcmVsYXRlZCBlbGVtZW50cwor
CS8qIEhUIHJlbGF0ZWQgZWxlbWVudHMgKi8KIAl1OAkJCQkJYmRIVENhcEJ1ZlszMl07CiAJdTE2
CQkJCQliZEhUQ2FwTGVuOwogCXU4CQkJCQliZEhUSW5mb0J1ZlszMl07CkBAIC0yNTgsOSArMjU4
LDkgQEAgZXh0ZXJuIHU4IE1DU19GSUxURVJfMVNTWzE2XTsKIAkJCQkJCShMZWdhY3lSYXRlKSA6
XAogCQkJCQkJKFBJQ0tfUkFURShMZWdhY3lSYXRlLCBIVFJhdGUpKQoKLS8vIE1DUyBCdyA0MCB7
MX43LCAxMn4xNSwzMn0KKy8qIE1DUyBCdyA0MCB7MX43LCAxMn4xNSwzMn0gKi8KICNkZWZpbmUJ
UkFURV9BRFBUXzFTU19NQVNLCQkweEZGCi0jZGVmaW5lCVJBVEVfQURQVF8yU1NfTUFTSwkJMHhG
MCAvL1NraXAgTUNTOH4xMSBiZWNhdXNlIG1jczcgPiBtY3M2LCA5LCAxMCwgMTEuIDIwMDcuMDEu
MTYgYnkgRW1pbHkKKyNkZWZpbmUJUkFURV9BRFBUXzJTU19NQVNLCQkweEYwIC8qIFNraXAgTUNT
OH4xMSBiZWNhdXNlIG1jczcgPiBtY3M2LCA5LCAxMCwgMTEuIDIwMDcuMDEuMTYgYnkgRW1pbHkg
Ki8KICNkZWZpbmUJUkFURV9BRFBUX01DUzMyX01BU0sJCTB4MDEKCiAjZGVmaW5lCQlJU18xMU5f
TUNTX1JBVEUocmF0ZSkJCShyYXRlICYgMHg4MCkKQEAgLTMwMCw0ICszMDAsNCBAQCB0eXBlZGVm
IGVudW0gX0hUX0lPVF9BQ1RJT04gewogCUhUX0lPVF9BQ1RfRk9SQ0VEX0NUUzJTRUxGID0gMHgw
MDAwMDIwMCwKIH1IVF9JT1RfQUNUSU9OX0UsICpQSFRfSU9UX0FDVElPTl9FOwoKLSNlbmRpZiAv
L19SVEw4MTlYVV9IVFRZUEVfSF8KKyNlbmRpZiAvKiBfUlRMODE5WFVfSFRUWVBFX0hfICovCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfSFRQ
cm9jLmMgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfSFRQcm9j
LmMKaW5kZXggYzczYTgwNThjZjg3Li40MzU5ZDZmNTczNWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
c3RhZ2luZy9ydGw4MTkydS9pZWVlODAyMTEvcnRsODE5eF9IVFByb2MuYworKysgYi9kcml2ZXJz
L3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfSFRQcm9jLmMKQEAgLTE1LDI5ICsx
NSwyOSBAQCB1MTYgTUNTX0RBVEFfUkFURVsyXVsyXVs3N10gPSB7CiAJCSAzOSwgNzgsIDExNywg
MjM0LCAzMTIsIDM1MSwgMzkwLCA1MiwgMTA0LCAxNTYsIDIwOCwgMzEyLCA0MTYsIDQ2OCwgNTIw
LAogCQkgMCwgNzgsIDEwNCwgMTMwLCAxMTcsIDE1NiwgMTk1LCAxMDQsIDEzMCwgMTMwLCAxNTYs
IDE4MiwgMTgyLCAyMDgsIDE1NiwgMTk1LAogCQkgMTk1LCAyMzQsIDI3MywgMjczLCAzMTIsIDEz
MCwgMTU2LCAxODEsIDE1NiwgMTgxLCAyMDgsIDIzNCwgMjA4LCAyMzQsIDI2MCwgMjYwLAotCQkg
Mjg2LCAxOTUsIDIzNCwgMjczLCAyMzQsIDI3MywgMzEyLCAzNTEsIDMxMiwgMzUxLCAzOTAsIDM5
MCwgNDI5fSwJCQkvLyBMb25nIEdJLCAyME1IegorCQkgMjg2LCAxOTUsIDIzNCwgMjczLCAyMzQs
IDI3MywgMzEyLCAzNTEsIDMxMiwgMzUxLCAzOTAsIDM5MCwgNDI5fSwJCQkvKiBMb25nIEdJLCAy
ME1IeiAqLwogCQl7MTQsIDI5LCA0MywgNTgsIDg3LCAxMTYsIDEzMCwgMTQ0LCAyOSwgNTgsIDg3
LCAxMTYsIDE3MywgMjMxLCAyNjAsIDI4OSwKIAkJIDQzLCA4NywgMTMwLCAxNzMsIDI2MCwgMzQ3
LCAzOTAsIDQzMywgNTgsIDExNiwgMTczLCAyMzEsIDM0NywgNDYyLCA1MjAsIDU3OCwKIAkJIDAs
IDg3LCAxMTYsIDE0NCwgMTMwLCAxNzMsIDIxNywgMTE2LCAxNDQsIDE0NCwgMTczLCAyMDIsIDIw
MiwgMjMxLCAxNzMsIDIxNywKIAkJIDIxNywgMjYwLCAzMDMsIDMwMywgMzQ3LCAxNDQsIDE3Mywg
MjAyLCAxNzMsIDIwMiwgMjMxLCAyNjAsIDIzMSwgMjYwLCAyODksIDI4OSwKLQkJIDMxOCwgMjE3
LCAyNjAsIDMwMywgMjYwLCAzMDMsIDM0NywgMzkwLCAzNDcsIDM5MCwgNDMzLCA0MzMsIDQ3N30J
fSwJCS8vIFNob3J0IEdJLCAyME1IegorCQkgMzE4LCAyMTcsIDI2MCwgMzAzLCAyNjAsIDMwMywg
MzQ3LCAzOTAsIDM0NywgMzkwLCA0MzMsIDQzMywgNDc3fQl9LAkJLyogU2hvcnQgR0ksIDIwTUh6
ICovCiAJewl7MjcsIDU0LCA4MSwgMTA4LCAxNjIsIDIxNiwgMjQzLCAyNzAsIDU0LCAxMDgsIDE2
MiwgMjE2LCAzMjQsIDQzMiwgNDg2LCA1NDAsCiAJCSA4MSwgMTYyLCAyNDMsIDMyNCwgNDg2LCA2
NDgsIDcyOSwgODEwLCAxMDgsIDIxNiwgMzI0LCA0MzIsIDY0OCwgODY0LCA5NzIsIDEwODAsCiAJ
CSAxMiwgMTYyLCAyMTYsIDI3MCwgMjQzLCAzMjQsIDQwNSwgMjE2LCAyNzAsIDI3MCwgMzI0LCAz
NzgsIDM3OCwgNDMyLCAzMjQsIDQwNSwKIAkJIDQwNSwgNDg2LCA1NjcsIDU2NywgNjQ4LCAyNzAs
IDMyNCwgMzc4LCAzMjQsIDM3OCwgNDMyLCA0ODYsIDQzMiwgNDg2LCA1NDAsIDU0MCwKLQkJIDU5
NCwgNDA1LCA0ODYsIDU2NywgNDg2LCA1NjcsIDY0OCwgNzI5LCA2NDgsIDcyOSwgODEwLCA4MTAs
IDg5MX0sCS8vIExvbmcgR0ksIDQwTUh6CisJCSA1OTQsIDQwNSwgNDg2LCA1NjcsIDQ4NiwgNTY3
LCA2NDgsIDcyOSwgNjQ4LCA3MjksIDgxMCwgODEwLCA4OTF9LAkvKiBMb25nIEdJLCA0ME1IeiAq
LwogCQl7MzAsIDYwLCA5MCwgMTIwLCAxODAsIDI0MCwgMjcwLCAzMDAsIDYwLCAxMjAsIDE4MCwg
MjQwLCAzNjAsIDQ4MCwgNTQwLCA2MDAsCiAJCSA5MCwgMTgwLCAyNzAsIDM2MCwgNTQwLCA3MjAs
IDgxMCwgOTAwLCAxMjAsIDI0MCwgMzYwLCA0ODAsIDcyMCwgOTYwLCAxMDgwLCAxMjAwLAogCQkg
MTMsIDE4MCwgMjQwLCAzMDAsIDI3MCwgMzYwLCA0NTAsIDI0MCwgMzAwLCAzMDAsIDM2MCwgNDIw
LCA0MjAsIDQ4MCwgMzYwLCA0NTAsCiAJCSA0NTAsIDU0MCwgNjMwLCA2MzAsIDcyMCwgMzAwLCAz
NjAsIDQyMCwgMzYwLCA0MjAsIDQ4MCwgNTQwLCA0ODAsIDU0MCwgNjAwLCA2MDAsCi0JCSA2NjAs
IDQ1MCwgNTQwLCA2MzAsIDU0MCwgNjMwLCA3MjAsIDgxMCwgNzIwLCA4MTAsIDkwMCwgOTAwLCA5
OTB9CX0JLy8gU2hvcnQgR0ksIDQwTUh6CisJCSA2NjAsIDQ1MCwgNTQwLCA2MzAsIDU0MCwgNjMw
LCA3MjAsIDgxMCwgNzIwLCA4MTAsIDkwMCwgOTAwLCA5OTB9CX0JLyogU2hvcnQgR0ksIDQwTUh6
ICovCiB9OwoKIHN0YXRpYyB1OCBVTktOT1dOX0JPUkFEQ09NWzNdID0gezB4MDAsIDB4MTQsIDB4
YmZ9Owogc3RhdGljIHU4IExJTktTWVNXUlQzMzBfTElOS1NZU1dSVDMwMF9CUk9BRENPTVszXSA9
IHsweDAwLCAweDFhLCAweDcwfTsKIHN0YXRpYyB1OCBMSU5LU1lTV1JUMzUwX0xJTktTWVNXUlQx
NTBfQlJPQURDT01bM10gPSB7MHgwMCwgMHgxZCwgMHg3ZX07CiBzdGF0aWMgdTggTkVUR0VBUjgz
NEJ2Ml9CUk9BRENPTVszXSA9IHsweDAwLCAweDFiLCAweDJmfTsKLXN0YXRpYyB1OCBCRUxLSU5G
NUQ4MjMzVjFfUkFMSU5LWzNdID0gezB4MDAsIDB4MTcsIDB4M2Z9OwkvL2Nvc2EgMDMyMDIwMDgK
K3N0YXRpYyB1OCBCRUxLSU5GNUQ4MjMzVjFfUkFMSU5LWzNdID0gezB4MDAsIDB4MTcsIDB4M2Z9
OwkvKiBjb3NhIDAzMjAyMDA4ICovCiBzdGF0aWMgdTggQkVMS0lORjVEODIzMzRWM19SQUxJTktb
M10gPSB7MHgwMCwgMHgxYywgMHhkZn07CiBzdGF0aWMgdTggUENJX1JBTElOS1szXSA9IHsweDAw
LCAweDkwLCAweGNjfTsKIHN0YXRpYyB1OCBFRElNQVhfUkFMSU5LWzNdID0gezB4MDAsIDB4MGUs
IDB4MmV9OwpAQCAtNjMsNDcgKzYzLDQ3IEBAIHZvaWQgSFRVcGRhdGVEZWZhdWx0U2V0dGluZyhz
dHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSkKCiAJLy9wcmludGsoInBIVGluZm86JXAsICZw
SFRpbmZvOiVwLCBtcHRyOiVwLCAgb2Zmc2V0b2Y6JXhcbiIsIHBIVEluZm8sICZwSFRJbmZvLCBf
X21wdHIsIG9mZnNldG9mKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlLCBwSFRJbmZvKSk7CiAJLy9w
cmludGsoIj09PT5pZWVlOiVwLFxuIiwgaWVlZSk7Ci0JLy8gU2hvcnRHSSBzdXBwb3J0CisJLyog
U2hvcnRHSSBzdXBwb3J0ICovCiAJcEhUSW5mby0+YlJlZ1Nob3J0R0kyME1IeiA9IDE7CiAJcEhU
SW5mby0+YlJlZ1Nob3J0R0k0ME1IeiA9IDE7CgotCS8vIDQwTUh6IGNoYW5uZWwgc3VwcG9ydAor
CS8qIDQwTUh6IGNoYW5uZWwgc3VwcG9ydCAqLwogCXBIVEluZm8tPmJSZWdCVzQwTUh6ID0gMTsK
Ci0JLy8gQ0NLIHJhdGUgc3VwcG9ydCBpbiA0ME1IeiBjaGFubmVsCisJLyogQ0NLIHJhdGUgc3Vw
cG9ydCBpbiA0ME1IeiBjaGFubmVsICovCiAJaWYgKHBIVEluZm8tPmJSZWdCVzQwTUh6KQogCQlw
SFRJbmZvLT5iUmVnU3VwcENDSyA9IDE7CiAJZWxzZQogCQlwSFRJbmZvLT5iUmVnU3VwcENDSyA9
IHRydWU7CgotCS8vIEFNU0RVIHJlbGF0ZWQKKwkvKiBBTVNEVSByZWxhdGVkICovCiAJcEhUSW5m
by0+bkFNU0RVX01heFNpemUgPSA3OTM1VUw7CiAJcEhUSW5mby0+YkFNU0RVX1N1cHBvcnQgPSAw
OwoKLQkvLyBBTVBEVSByZWxhdGVkCisJLyogQU1QRFUgcmVsYXRlZCAqLwogCXBIVEluZm8tPmJB
TVBEVUVuYWJsZSA9IDE7Ci0JcEhUSW5mby0+QU1QRFVfRmFjdG9yID0gMjsgLy8vLyAwOiAybjEz
KDhLKSwgMToybjE0KDE2SyksIDI6Mm4xNSgzMkspLCAzOjJuMTYoNjRrKQotCXBIVEluZm8tPk1Q
RFVfRGVuc2l0eSA9IDA7Ly8gMDogTm8gcmVzdHJpY3Rpb24sIDE6IDEvOHVzZWMsIDI6IDEvNHVz
ZWMsIDM6IDEvMnVzZWMsIDQ6IDF1c2VjLCA1OiAydXNlYywgNjogNHVzZWMsIDc6OHVzZWMKKwlw
SFRJbmZvLT5BTVBEVV9GYWN0b3IgPSAyOyAvKiAvLyAwOiAybjEzKDhLKSwgMToybjE0KDE2Syks
IDI6Mm4xNSgzMkspLCAzOjJuMTYoNjRrKSAqLworCXBIVEluZm8tPk1QRFVfRGVuc2l0eSA9IDA7
LyogMDogTm8gcmVzdHJpY3Rpb24sIDE6IDEvOHVzZWMsIDI6IDEvNHVzZWMsIDM6IDEvMnVzZWMs
IDQ6IDF1c2VjLCA1OiAydXNlYywgNjogNHVzZWMsIDc6OHVzZWMgKi8KCi0JLy8gTUlNTyBQb3dl
ciBTYXZlCi0JcEhUSW5mby0+U2VsZk1pbW9QcyA9IDM7Ly8gMDogU3RhdGljIE1pbW8gUHMsIDE6
IER5bmFtaWMgTWltbyBQcywgMzogTm8gTGltaXRhdGlvbiwgMjogUmVzZXJ2ZWQoU2V0IHRvIDMg
YXV0b21hdGljYWxseS4pCisJLyogTUlNTyBQb3dlciBTYXZlICovCisJcEhUSW5mby0+U2VsZk1p
bW9QcyA9IDM7LyogMDogU3RhdGljIE1pbW8gUHMsIDE6IER5bmFtaWMgTWltbyBQcywgMzogTm8g
TGltaXRhdGlvbiwgMjogUmVzZXJ2ZWQoU2V0IHRvIDMgYXV0b21hdGljYWxseS4pICovCiAJaWYg
KHBIVEluZm8tPlNlbGZNaW1vUHMgPT0gMikKIAkJcEhUSW5mby0+U2VsZk1pbW9QcyA9IDM7Ci0J
Ly8gODE5MCBvbmx5LiBBc3NpZ24gcmF0ZSBvcGVyYXRpb24gbW9kZSB0byBmaXJtd2FyZQorCS8q
IDgxOTAgb25seS4gQXNzaWduIHJhdGUgb3BlcmF0aW9uIG1vZGUgdG8gZmlybXdhcmUgKi8KIAlp
ZWVlLT5iVHhEaXNhYmxlUmF0ZUZhbGxCYWNrID0gMDsKIAlpZWVlLT5iVHhVc2VEcml2ZXJBc3Np
bmdlZFJhdGUgPSAwOwoKICNpZmRlZglUT19ET19MSVNUCi0JLy8gODE5MCBvbmx5LiBBc3NpZ24g
ZHVyYXRpb24gb3BlcmF0aW9uIG1vZGUgdG8gZmlybXdhcmUKKwkvKiA4MTkwIG9ubHkuIEFzc2ln
biBkdXJhdGlvbiBvcGVyYXRpb24gbW9kZSB0byBmaXJtd2FyZSAqLwogCXBNZ250SW5mby0+YlR4
RW5hYmxlRndDYWxjRHVyID0gKEJPT0xFQU4pcE5kaXNDb21tb24tPmJSZWdUeEVuYWJsZUZ3Q2Fs
Y0R1cjsKICNlbmRpZgogCS8qCiAJICogODE5MCBvbmx5LCBSZWFsdGVrIHByb3ByaWV0YXJ5IGFn
Z3JlZ2F0aW9uIG1vZGUKIAkgKiBTZXQgTVBEVURlbnNpdHk9MiwgICAxOiBTZXQgTVBEVURlbnNp
dHk9MigzMmspICBmb3IgUmVhbHRlayBBUCBhbmQgc2V0IE1QRFVEZW5zaXR5PTAoOGspIGZvciBv
dGhlcnMKIAkgKi8KLQlwSFRJbmZvLT5iUmVnUlQyUlRBZ2dyZWdhdGlvbiA9IDE7Ly8wOiBTZXQg
TVBEVURlbnNpdHk9MiwgICAxOiBTZXQgTVBEVURlbnNpdHk9MigzMmspICBmb3IgUmVhbHRlayBB
UCBhbmQgc2V0IE1QRFVEZW5zaXR5PTAoOGspIGZvciBvdGhlcnMKKwlwSFRJbmZvLT5iUmVnUlQy
UlRBZ2dyZWdhdGlvbiA9IDE7LyogMDogU2V0IE1QRFVEZW5zaXR5PTIsICAgMTogU2V0IE1QRFVE
ZW5zaXR5PTIoMzJrKSAgZm9yIFJlYWx0ZWsgQVAgYW5kIHNldCBNUERVRGVuc2l0eT0wKDhrKSBm
b3Igb3RoZXJzICovCgotCS8vIEZvciBSeCBSZW9yZGVyIENvbnRyb2wKKwkvKiBGb3IgUnggUmVv
cmRlciBDb250cm9sICovCiAJcEhUSW5mby0+YlJlZ1J4UmVvcmRlckVuYWJsZSA9IDE7CiAJcEhU
SW5mby0+UnhSZW9yZGVyV2luU2l6ZSA9IDY0OwogCXBIVEluZm8tPlJ4UmVvcmRlclBlbmRpbmdU
aW1lID0gMzA7CkBAIC0xMTUsNyArMTE1LDcgQEAgdm9pZCBIVFVwZGF0ZURlZmF1bHRTZXR0aW5n
KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlKQogCXBIVEluZm8tPlVzYlJ4RndBZ2dyRW4g
PSAxOwogCXBIVEluZm8tPlVzYlJ4RndBZ2dyUGFnZU51bSA9IDI0OwogCXBIVEluZm8tPlVzYlJ4
RndBZ2dyUGFja2V0TnVtID0gODsKLQlwSFRJbmZvLT5Vc2JSeEZ3QWdnclRpbWVvdXQgPSAxNjsg
Ly8vL3VzYiByeCBGVyBhZ2dyZWdhdGlvbiB0aW1lb3V0IHRocmVzaG9sZC5JdCdzIGluIHVuaXRz
IG9mIDY0dXMKKwlwSFRJbmZvLT5Vc2JSeEZ3QWdnclRpbWVvdXQgPSAxNjsgLyogdXNiIHJ4IEZX
IGFnZ3JlZ2F0aW9uIHRpbWVvdXQgdGhyZXNob2xkLkl0J3MgaW4gdW5pdHMgb2YgNjR1cyAqLwog
I2VuZGlmCiB9CgpAQCAtMTMwLDExICsxMzAsMTEgQEAgdm9pZCBIVFVwZGF0ZURlZmF1bHRTZXR0
aW5nKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlKQogICovCiB2b2lkIEhURGVidWdIVENh
cGFiaWxpdHkodTggKkNhcElFLCB1OCAqVGl0bGVTdHJpbmcpCiB7Ci0Jc3RhdGljIHU4CSAgICAg
ICAgICBFV0MxMU5IVENhcFtdID0gezB4MDAsIDB4OTAsIDB4NGMsIDB4MzN9OwkvLyBGb3IgMTFu
IEVXQyBkZWZpbml0aW9uLCAyMDA3LjA3LjE3LCBieSBFbWlseQorCXN0YXRpYyB1OAkgICAgICAg
ICAgRVdDMTFOSFRDYXBbXSA9IHsweDAwLCAweDkwLCAweDRjLCAweDMzfTsJLyogRm9yIDExbiBF
V0MgZGVmaW5pdGlvbiwgMjAwNy4wNy4xNywgYnkgRW1pbHkgKi8KIAlzdHJ1Y3QgaHRfY2FwYWJp
bGl0eV9lbGUgKnBDYXBFTEU7CgogCWlmICghbWVtY21wKENhcElFLCBFV0MxMU5IVENhcCwgc2l6
ZW9mKEVXQzExTkhUQ2FwKSkpIHsKLQkJLy9FV0MgSUUKKwkJLyogRVdDIElFICovCiAJCUlFRUU4
MDIxMV9ERUJVRyhJRUVFODAyMTFfRExfSFQsICJFV0MgSUUgaW4gJXMoKVxuIiwgX19mdW5jX18p
OwogCQlwQ2FwRUxFID0gKHN0cnVjdCBodF9jYXBhYmlsaXR5X2VsZSAqKSgmQ2FwSUVbNF0pOwog
CX0gZWxzZSB7CkBAIC0xNjUsMTEgKzE2NSwxMSBAQCB2b2lkIEhURGVidWdIVENhcGFiaWxpdHko
dTggKkNhcElFLCB1OCAqVGl0bGVTdHJpbmcpCiAgKi8KIHZvaWQgSFREZWJ1Z0hUSW5mbyh1OCAq
SW5mb0lFLCB1OCAqVGl0bGVTdHJpbmcpCiB7Ci0Jc3RhdGljIHU4CUVXQzExTkhUSW5mb1tdID0g
ezB4MDAsIDB4OTAsIDB4NGMsIDB4MzR9OwkvLyBGb3IgMTFuIEVXQyBkZWZpbml0aW9uLCAyMDA3
LjA3LjE3LCBieSBFbWlseQorCXN0YXRpYyB1OAlFV0MxMU5IVEluZm9bXSA9IHsweDAwLCAweDkw
LCAweDRjLCAweDM0fTsJLyogRm9yIDExbiBFV0MgZGVmaW5pdGlvbiwgMjAwNy4wNy4xNywgYnkg
RW1pbHkgKi8KIAlQSFRfSU5GT1JNQVRJT05fRUxFCQlwSFRJbmZvRWxlOwoKIAlpZiAoIW1lbWNt
cChJbmZvSUUsIEVXQzExTkhUSW5mbywgc2l6ZW9mKEVXQzExTkhUSW5mbykpKSB7Ci0JCS8vIE5v
dCBFV0MgSUUKKwkJLyogTm90IEVXQyBJRSAqLwogCQlJRUVFODAyMTFfREVCVUcoSUVFRTgwMjEx
X0RMX0hULCAiRVdDIElFIGluICVzKClcbiIsIF9fZnVuY19fKTsKIAkJcEhUSW5mb0VsZSA9IChQ
SFRfSU5GT1JNQVRJT05fRUxFKSgmSW5mb0lFWzRdKTsKIAl9IGVsc2UgewpAQCAtMzY2LDE0ICsz
NjYsMTQgQEAgc3RhdGljIGJvb2wgSFRJT1RBY3RJc0Rpc2FibGVNQ1MxNShzdHJ1Y3QgaWVlZTgw
MjExX2RldmljZSAqaWVlZSkKIAlib29sIHJldFZhbHVlID0gZmFsc2U7CgogI2lmZGVmIFRPRE8K
LQkvLyBBcHBseSBmb3IgODE5dSBvbmx5CisJLyogQXBwbHkgZm9yIDgxOXUgb25seSAqLwogI2lm
IChIQUxfQ09ERV9CQVNFID09IFJUTDgxOTIpCgogI2lmIChERVZfQlVTX1RZUEUgPT0gVVNCX0lO
VEVSRkFDRSkKLQkvLyBBbHdheSBkaXNhYmxlIE1DUzE1IGJ5IEplcnJ5IENoYW5nJ3MgcmVxdWVz
dC5ieSBFbWlseSwgMjAwOC4wNC4xNQorCS8qIEFsd2F5IGRpc2FibGUgTUNTMTUgYnkgSmVycnkg
Q2hhbmcncyByZXF1ZXN0LmJ5IEVtaWx5LCAyMDA4LjA0LjE1ICovCiAJcmV0VmFsdWUgPSB0cnVl
OwogI2VsaWYgKERFVl9CVVNfVFlQRSA9PSBQQ0lfSU5URVJGQUNFKQotCS8vIEVuYWJsZSBNQ1Mx
NSBpZiB0aGUgcGVlciBpcyBDaXNjbyBBUC4gYnkgRW1pbHksIDIwMDguMDUuMTIKKwkvKiBFbmFi
bGUgTUNTMTUgaWYgdGhlIHBlZXIgaXMgQ2lzY28gQVAuIGJ5IEVtaWx5LCAyMDA4LjA1LjEyICov
CiAvLwlpZihwQnNzRGVzYy0+YkNpc2NvQ2FwRXhpc3QpCiAvLwkJcmV0VmFsdWUgPSBmYWxzZTsK
IC8vCWVsc2UKQEAgLTM4MSw3ICszODEsNyBAQCBzdGF0aWMgYm9vbCBIVElPVEFjdElzRGlzYWJs
ZU1DUzE1KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlKQogI2VuZGlmCiAjZW5kaWYKICNl
bmRpZgotCS8vIEplcnJ5IENoYW5nIHN1Z2dlc3QgdGhhdCA4MTkwIDF4MiBkb2VzIG5vdCBuZWVk
IHRvIGRpc2FibGUgTUNTMTUKKwkvKiBKZXJyeSBDaGFuZyBzdWdnZXN0IHRoYXQgODE5MCAxeDIg
ZG9lcyBub3QgbmVlZCB0byBkaXNhYmxlIE1DUzE1ICovCgogCXJldHVybiByZXRWYWx1ZTsKIH0K
QEAgLTQwMyw3ICs0MDMsNyBAQCBzdGF0aWMgYm9vbCBIVElPVEFjdElzRGlzYWJsZU1DU1R3b1Nw
YXRpYWxTdHJlYW0oc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCiAJCQkJCQkgdTggKlBl
ZXJNYWNBZGRyKQogewogI2lmZGVmIFRPRE8KLQkvLyBBcHBseSBmb3IgODE5dSBvbmx5CisJLyog
QXBwbHkgZm9yIDgxOXUgb25seSAqLwogI2VuZGlmCiAJcmV0dXJuIGZhbHNlOwogfQpAQCAtNDMz
LDggKzQzMyw4IEBAIHN0YXRpYyB1OCBIVElPVEFjdElzTWdudFVzZUNDSzZNKHN0cnVjdCBpZWVl
ODAyMTFfbmV0d29yayAqbmV0d29yaykKIHsKIAl1OAlyZXRWYWx1ZSA9IDA7CgotCS8vIDIwMDgv
MDEvMjUgTUggSnVkZWcgaWYgd2UgbmVlZCB0byB1c2UgT0ZETSB0byBzbmVkIE1HTlQgZnJhbWUg
Zm9yIGJyb2FkY29tIEFQLgotCS8vIDIwMDgvMDEvMjggTUggV2UgbXVzdCBwcmV2ZW50IHRoYXQg
d2Ugc2VsZWN0IG51bGwgYnNzaWQgdG8gbGluay4KKwkvKiAyMDA4LzAxLzI1IE1IIEp1ZGVnIGlm
IHdlIG5lZWQgdG8gdXNlIE9GRE0gdG8gc25lZCBNR05UIGZyYW1lIGZvciBicm9hZGNvbSBBUC4g
Ki8KKwkvKiAyMDA4LzAxLzI4IE1IIFdlIG11c3QgcHJldmVudCB0aGF0IHdlIHNlbGVjdCBudWxs
IGJzc2lkIHRvIGxpbmsuICovCgogCWlmIChuZXR3b3JrLT5icm9hZGNvbV9jYXBfZXhpc3QpCiAJ
CXJldFZhbHVlID0gMTsKQEAgLTQ4NCw3ICs0ODQsNyBAQCB2b2lkIEhUQ29uc3RydWN0Q2FwYWJp
bGl0eUVsZW1lbnQoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHU4ICpwb3NIVENhcCwg
dQogCX0KIAltZW1zZXQocG9zSFRDYXAsIDAsICpsZW4pOwogCWlmIChwSFQtPmVQZWVySFRTcGVj
VmVyID09IEhUX1NQRUNfVkVSX0VXQykgewotCQl1OAlFV0MxMU5IVENhcFtdID0gezB4MDAsIDB4
OTAsIDB4NGMsIDB4MzN9OwkvLyBGb3IgMTFuIEVXQyBkZWZpbml0aW9uLCAyMDA3LjA3LjE3LCBi
eSBFbWlseQorCQl1OAlFV0MxMU5IVENhcFtdID0gezB4MDAsIDB4OTAsIDB4NGMsIDB4MzN9Owkv
KiBGb3IgMTFuIEVXQyBkZWZpbml0aW9uLCAyMDA3LjA3LjE3LCBieSBFbWlseSAqLwoKIAkJbWVt
Y3B5KHBvc0hUQ2FwLCBFV0MxMU5IVENhcCwgc2l6ZW9mKEVXQzExTkhUQ2FwKSk7CiAJCXBDYXBF
TEUgPSAoc3RydWN0IGh0X2NhcGFiaWxpdHlfZWxlICopJnBvc0hUQ2FwWzRdOwpAQCAtNDkyLDgg
KzQ5Miw4IEBAIHZvaWQgSFRDb25zdHJ1Y3RDYXBhYmlsaXR5RWxlbWVudChzdHJ1Y3QgaWVlZTgw
MjExX2RldmljZSAqaWVlZSwgdTggKnBvc0hUQ2FwLCB1CiAJCXBDYXBFTEUgPSAoc3RydWN0IGh0
X2NhcGFiaWxpdHlfZWxlICopcG9zSFRDYXA7CiAJfQoKLQkvL0hUIGNhcGFiaWxpdHkgaW5mbwot
CXBDYXBFTEUtPkFkdkNvZGluZwkJPSAwOyAvLyBUaGlzIGZlYXR1cmUgaXMgbm90IHN1cHBvcnRl
ZCBub3chIQorCS8qIEhUIGNhcGFiaWxpdHkgaW5mbyAqLworCXBDYXBFTEUtPkFkdkNvZGluZwkJ
PSAwOyAvKiBUaGlzIGZlYXR1cmUgaXMgbm90IHN1cHBvcnRlZCBub3chISAqLwogCWlmIChpZWVl
LT5HZXRIYWxmTm1vZGVTdXBwb3J0QnlBUHNIYW5kbGVyKGllZWUtPmRldikpCiAJCXBDYXBFTEUt
PkNobFdpZHRoID0gMDsKIAllbHNlCkBAIC01MDEsMTggKzUwMSwxOCBAQCB2b2lkIEhUQ29uc3Ry
dWN0Q2FwYWJpbGl0eUVsZW1lbnQoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHU4ICpw
b3NIVENhcCwgdQoKIC8vCXBDYXBFTEUtPkNobFdpZHRoCQk9IChwSFQtPmJSZWdCVzQwTUh6PzE6
MCk7CiAJcENhcEVMRS0+TWltb1B3clNhdmUJCT0gcEhULT5TZWxmTWltb1BzOwotCXBDYXBFTEUt
PkdyZWVuRmllbGQJCT0gMDsgLy8gVGhpcyBmZWF0dXJlIGlzIG5vdCBzdXBwb3J0ZWQgbm93ISEK
LQlwQ2FwRUxFLT5TaG9ydEdJMjBNaHoJCT0gMTsgLy8gV2UgY2FuIHJlY2VpdmUgU2hvcnQgR0kh
IQotCXBDYXBFTEUtPlNob3J0R0k0ME1oegkJPSAxOyAvLyBXZSBjYW4gcmVjZWl2ZSBTaG9ydCBH
SSEhCisJcENhcEVMRS0+R3JlZW5GaWVsZAkJPSAwOyAvKiBUaGlzIGZlYXR1cmUgaXMgbm90IHN1
cHBvcnRlZCBub3chISAqLworCXBDYXBFTEUtPlNob3J0R0kyME1oegkJPSAxOyAvKiBXZSBjYW4g
cmVjZWl2ZSBTaG9ydCBHSSEhICovCisJcENhcEVMRS0+U2hvcnRHSTQwTWh6CQk9IDE7IC8qIFdl
IGNhbiByZWNlaXZlIFNob3J0IEdJISEgKi8KIAkvL0RiZ1ByaW50KCJUWCBIVCBjYXAvaW5mbyBl
bGUgQlc9JWQgU0cyMD0lZCBTRzQwPSVkXG5cciIsCiAJLy9wQ2FwRUxFLT5DaGxXaWR0aCwgcENh
cEVMRS0+U2hvcnRHSTIwTWh6LCBwQ2FwRUxFLT5TaG9ydEdJNDBNaHopOwogCXBDYXBFTEUtPlR4
U1RCQwkJCT0gMTsKIAlwQ2FwRUxFLT5SeFNUQkMJCQk9IDA7Ci0JcENhcEVMRS0+RGVsYXlCQQkJ
PSAwOwkvLyBEbyBub3Qgc3VwcG9ydCBub3chIQorCXBDYXBFTEUtPkRlbGF5QkEJCT0gMDsJLyog
RG8gbm90IHN1cHBvcnQgbm93ISEgKi8KIAlwQ2FwRUxFLT5NYXhBTVNEVVNpemUJICAgICAgICA9
IChNQVhfUkVDRUlWRV9CVUZGRVJfU0laRSA+PSA3OTM1KSA/IDEgOiAwOwogCXBDYXBFTEUtPkRz
c0NDawkJCT0gKChwSFQtPmJSZWdCVzQwTUh6KSA/IChwSFQtPmJSZWdTdXBwQ0NLID8gMSA6IDAp
IDogMCk7Ci0JcENhcEVMRS0+UFNNUAkJCT0gMDsgLy8gRG8gbm90IHN1cHBvcnQgbm93ISEKLQlw
Q2FwRUxFLT5MU2lnVHhvcFByb3RlY3QJPSAwOyAvLyBEbyBub3Qgc3VwcG9ydCBub3chIQorCXBD
YXBFTEUtPlBTTVAJCQk9IDA7IC8qIERvIG5vdCBzdXBwb3J0IG5vdyEhICovCisJcENhcEVMRS0+
TFNpZ1R4b3BQcm90ZWN0CT0gMDsgLyogRG8gbm90IHN1cHBvcnQgbm93ISEgKi8KCiAJLyoKIAkg
KiBNQUMgSFQgcGFyYW1ldGVycyBpbmZvCkBAIC01MjEsMTQgKzUyMSwxNCBAQCB2b2lkIEhUQ29u
c3RydWN0Q2FwYWJpbGl0eUVsZW1lbnQoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHU4
ICpwb3NIVENhcCwgdQogCUlFRUU4MDIxMV9ERUJVRyhJRUVFODAyMTFfRExfSFQsICJUWCBIVCBj
YXAvaW5mbyBlbGUgQlc9JWQgTWF4QU1TRFVTaXplOiVkIERzc0NDazolZFxuIiwgcENhcEVMRS0+
Q2hsV2lkdGgsIHBDYXBFTEUtPk1heEFNU0RVU2l6ZSwgcENhcEVMRS0+RHNzQ0NrKTsKCiAJaWYg
KElzRW5jcnlwdCkgewotCQlwQ2FwRUxFLT5NUERVRGVuc2l0eQk9IDc7IC8vIDh1cwotCQlwQ2Fw
RUxFLT5NYXhSeEFNUERVRmFjdG9yID0gMjsgLy8gMiBpcyBmb3IgMzIgSyBhbmQgMyBpcyA2NEsK
KwkJcENhcEVMRS0+TVBEVURlbnNpdHkJPSA3OyAvKiA4dXMgKi8KKwkJcENhcEVMRS0+TWF4UnhB
TVBEVUZhY3RvciA9IDI7IC8qIDIgaXMgZm9yIDMyIEsgYW5kIDMgaXMgNjRLICovCiAJfSBlbHNl
IHsKLQkJcENhcEVMRS0+TWF4UnhBTVBEVUZhY3RvciA9IDM7IC8vIDIgaXMgZm9yIDMyIEsgYW5k
IDMgaXMgNjRLCi0JCXBDYXBFTEUtPk1QRFVEZW5zaXR5CT0gMDsgLy8gbm8gZGVuc2l0eQorCQlw
Q2FwRUxFLT5NYXhSeEFNUERVRmFjdG9yID0gMzsgLyogMiBpcyBmb3IgMzIgSyBhbmQgMyBpcyA2
NEsgKi8KKwkJcENhcEVMRS0+TVBEVURlbnNpdHkJPSAwOyAvKiBubyBkZW5zaXR5ICovCiAJfQoK
LQkvL1N1cHBvcnRlZCBNQ1Mgc2V0CisJLyogU3VwcG9ydGVkIE1DUyBzZXQgKi8KIAltZW1jcHko
cENhcEVMRS0+TUNTLCBpZWVlLT5SZWdkb3QxMUhUT3BlcmF0aW9uYWxSYXRlU2V0LCAxNik7CiAJ
aWYgKHBIVC0+SU9UQWN0aW9uICYgSFRfSU9UX0FDVF9ESVNBQkxFX01DUzE1KQogCQlwQ2FwRUxF
LT5NQ1NbMV0gJj0gMHg3ZjsKQEAgLTU1MCwxNSArNTUwLDE1IEBAIHZvaWQgSFRDb25zdHJ1Y3RD
YXBhYmlsaXR5RWxlbWVudChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgdTggKnBvc0hU
Q2FwLCB1CiAJCQlwQ2FwRUxFLT5NQ1NbaV0gPSAwOwogCX0KCi0JLy9FeHRlbmRlZCBIVCBDYXBh
YmlsaXR5IEluZm8KKwkvKiBFeHRlbmRlZCBIVCBDYXBhYmlsaXR5IEluZm8gKi8KIAltZW1zZXQo
JnBDYXBFTEUtPkV4dEhUQ2FwSW5mbywgMCwgMik7CgotCS8vVFhCRiBDYXBhYmlsaXRpZXMKKwkv
KiBUWEJGIENhcGFiaWxpdGllcyAqLwogCW1lbXNldChwQ2FwRUxFLT5UeEJGQ2FwLCAwLCA0KTsK
Ci0JLy9BbnRlbm5hIFNlbGVjdGlvbiBDYXBhYmlsaXRpZXMKKwkvKiBBbnRlbm5hIFNlbGVjdGlv
biBDYXBhYmlsaXRpZXMgKi8KIAlwQ2FwRUxFLT5BU0NhcCA9IDA7Ci0vL2FkZCAyIHRvIGdpdmUg
c3BhY2UgZm9yIGVsZW1lbnQgSUQgYW5kIGxlbiB3aGVuIGNvbnN0cnVjdCBmcmFtZXMKKy8qIGFk
ZCAyIHRvIGdpdmUgc3BhY2UgZm9yIGVsZW1lbnQgSUQgYW5kIGxlbiB3aGVuIGNvbnN0cnVjdCBm
cmFtZXMgKi8KIAlpZiAocEhULT5lUGVlckhUU3BlY1ZlciA9PSBIVF9TUEVDX1ZFUl9FV0MpCiAJ
CSpsZW4gPSAzMCArIDI7CiAJZWxzZQpAQCAtNTk3LDcgKzU5Nyw3IEBAIHZvaWQgSFRDb25zdHJ1
Y3RJbmZvRWxlbWVudChzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgdTggKnBvc0hUSW5m
bywgdTggKmxlCiAJfQoKIAltZW1zZXQocG9zSFRJbmZvLCAwLCAqbGVuKTsKLQlpZiAoKGllZWUt
Pml3X21vZGUgPT0gSVdfTU9ERV9BREhPQykgfHwgKGllZWUtPml3X21vZGUgPT0gSVdfTU9ERV9N
QVNURVIpKSB7IC8vYXAgbW9kZSBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZAorCWlmICgoaWVl
ZS0+aXdfbW9kZSA9PSBJV19NT0RFX0FESE9DKSB8fCAoaWVlZS0+aXdfbW9kZSA9PSBJV19NT0RF
X01BU1RFUikpIHsgLyogYXAgbW9kZSBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCAqLwogCQlw
SFRJbmZvRWxlLT5Db250cm9sQ2hsCQkJPSBpZWVlLT5jdXJyZW50X25ldHdvcmsuY2hhbm5lbDsK
IAkJcEhUSW5mb0VsZS0+RXh0Q2hsT2Zmc2V0CQk9ICgoIXBIVC0+YlJlZ0JXNDBNSHopID8gSFRf
RVhUQ0hOTF9PRkZTRVRfTk9fRVhUIDoKIAkJCQkJCQkJCQkJKGllZWUtPmN1cnJlbnRfbmV0d29y
ay5jaGFubmVsIDw9IDYpID8KQEAgLTYxNiw5ICs2MTYsOSBAQCB2b2lkIEhUQ29uc3RydWN0SW5m
b0VsZW1lbnQoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHU4ICpwb3NIVEluZm8sIHU4
ICpsZQoKIAkJbWVtc2V0KHBIVEluZm9FbGUtPkJhc2ljTVNDLCAwLCAxNik7CgotCQkqbGVuID0g
MjIgKyAyOyAvL3NhbWUgYWJvdmUKKwkJKmxlbiA9IDIyICsgMjsgLyogc2FtZSBhYm92ZSAqLwog
CX0gZWxzZSB7Ci0JCS8vU1RBIHNob3VsZCBub3QgZ2VuZXJhdGUgSGlnaCBUaHJvdWdocHV0IElu
Zm9ybWF0aW9uIEVsZW1lbnQKKwkJLyogU1RBIHNob3VsZCBub3QgZ2VuZXJhdGUgSGlnaCBUaHJv
dWdocHV0IEluZm9ybWF0aW9uIEVsZW1lbnQgKi8KIAkJKmxlbiA9IDA7CiAJfQogCS8vSUVFRTgw
MjExX0RFQlVHX0RBVEEoSUVFRTgwMjExX0RMX0RBVEEgfCBJRUVFODAyMTFfRExfSFQsIHBvc0hU
SW5mbywgKmxlbiAtIDIpOwpAQCAtNjg4LDcgKzY4OCw3IEBAIHZvaWQgSFRDb25zdHJ1Y3RSVDJS
VEFnZ0VsZW1lbnQoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIHU4ICpwb3NSVDJSVEFn
ZywKIAl9CiAJKi8KICNlbHNlCi0JLy8gRG8gTm90aGluZworCS8qIERvIE5vdGhpbmcgKi8KICNl
bmRpZgoKIAlwb3NSVDJSVEFnZy0+TGVuZ3RoID0gNjsKQEAgLTcxNSwyNSArNzE1LDI1IEBAIHN0
YXRpYyB1OCBIVF9QaWNrTUNTUmF0ZShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgdTgg
KnBPcGVyYXRlTUNTKQogCWNhc2UgSUVFRV9BOgogCWNhc2UgSUVFRV9COgogCWNhc2UgSUVFRV9H
OgotCQkvL2xlZ2FjeSByYXRlIHJvdXRpbmUgaGFuZGxlZCBhdCBzZWxlY3RlZHJhdGUKKwkJLyog
bGVnYWN5IHJhdGUgcm91dGluZSBoYW5kbGVkIGF0IHNlbGVjdGVkcmF0ZSAqLwoKLQkJLy9ubyBN
Q1MgcmF0ZQorCQkvKiBubyBNQ1MgcmF0ZSAqLwogCQltZW1zZXQocE9wZXJhdGVNQ1MsIDAsIDE2
KTsKIAkJYnJlYWs7CgotCWNhc2UgSUVFRV9OXzI0RzoJLy9hc3N1bWUgQ0NLIHJhdGUgb2sKKwlj
YXNlIElFRUVfTl8yNEc6CS8qIGFzc3VtZSBDQ0sgcmF0ZSBvayAqLwogCWNhc2UgSUVFRV9OXzVH
OgotCQkvLyBMZWdhY3kgcGFydCB3ZSBvbmx5IHVzZSA2LCA1LjUsMiwxIGZvciBOXzI0RyBhbmQg
NiBmb3IgTl81Ry4KLQkJLy8gTGVnYWN5IHBhcnQgc2hhbGwgYmUgaGFuZGxlZCBhdCBTZWxlY3RS
YXRlU2V0KCkuCisJCS8qIExlZ2FjeSBwYXJ0IHdlIG9ubHkgdXNlIDYsIDUuNSwyLDEgZm9yIE5f
MjRHIGFuZCA2IGZvciBOXzVHLiAqLworCQkvKiBMZWdhY3kgcGFydCBzaGFsbCBiZSBoYW5kbGVk
IGF0IFNlbGVjdFJhdGVTZXQoKS4gKi8KCi0JCS8vSFQgcGFydAotCQkvLyBUT0RPOiBtYXkgYmUg
ZGlmZmVyZW50IGlmIHdlIGhhdmUgZGlmZmVyZW50IG51bWJlciBvZiBhbnRlbm5hCi0JCXBPcGVy
YXRlTUNTWzBdICY9IFJBVEVfQURQVF8xU1NfTUFTSzsJLy9zdXBwb3J0IE1DUyAwfjcKKwkJLyog
SFQgcGFydCAqLworCQkvKiBUT0RPOiBtYXkgYmUgZGlmZmVyZW50IGlmIHdlIGhhdmUgZGlmZmVy
ZW50IG51bWJlciBvZiBhbnRlbm5hICovCisJCXBPcGVyYXRlTUNTWzBdICY9IFJBVEVfQURQVF8x
U1NfTUFTSzsJLyogc3VwcG9ydCBNQ1MgMH43ICovCiAJCXBPcGVyYXRlTUNTWzFdICY9IFJBVEVf
QURQVF8yU1NfTUFTSzsKIAkJcE9wZXJhdGVNQ1NbM10gJj0gUkFURV9BRFBUX01DUzMyX01BU0s7
CiAJCWJyZWFrOwoKLQkvL3Nob3VsZCBuZXZlciByZWFjaCBoZXJlCisJLyogc2hvdWxkIG5ldmVy
IHJlYWNoIGhlcmUgKi8KIAlkZWZhdWx0OgogCQlicmVhazsKIAl9CkBAIC04MTEsMTEgKzgxMSwx
MSBAQCBzdGF0aWMgdTggSFRGaWx0ZXJNQ1NSYXRlKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICpp
ZWVlLCB1OCAqcFN1cHBvcnRNQ1MsCiB7CiAJdTggaSA9IDA7CgotCS8vIGZpbHRlciBvdXQgb3Bl
cmF0aW9uYWwgcmF0ZSBzZXQgbm90IHN1cHBvcnRlZCBieSBBUCwgdGhlIGxlbmd0aCBvZiBpdCBp
cyAxNgorCS8qIGZpbHRlciBvdXQgb3BlcmF0aW9uYWwgcmF0ZSBzZXQgbm90IHN1cHBvcnRlZCBi
eSBBUCwgdGhlIGxlbmd0aCBvZiBpdCBpcyAxNiAqLwogCWZvciAoaSA9IDA7IGkgPD0gMTU7IGkr
KykKIAkJcE9wZXJhdGVNQ1NbaV0gPSBpZWVlLT5SZWdkb3QxMUhUT3BlcmF0aW9uYWxSYXRlU2V0
W2ldICYgcFN1cHBvcnRNQ1NbaV07CgotCS8vIFRPRE86IGFkanVzdCBvdXIgb3BlcmF0aW9uYWwg
cmF0ZSBzZXQgIGFjY29yZGluZyB0byBvdXIgY2hhbm5lbCBiYW5kd2lkdGgsIFNUQkMgYW5kIEFu
dGVubmEgbnVtYmVyCisJLyogVE9ETzogYWRqdXN0IG91ciBvcGVyYXRpb25hbCByYXRlIHNldCAg
YWNjb3JkaW5nIHRvIG91ciBjaGFubmVsIGJhbmR3aWR0aCwgU1RCQyBhbmQgQW50ZW5uYSBudW1i
ZXIgKi8KIAkvKgogCSAqIFRPRE86IGZpbGwgc3VnZ2VzdGVkIHJhdGUgYWRhcHRpdmUgcmF0ZSBp
bmRleCBhbmQgZ2l2ZSBmaXJtd2FyZSBpbmZvCiAJICogdXNpbmcgVHggY29tbWFuZCBwYWNrZXQg
d2UgYWxzbyBzaGFsbCBzdWdnZXN0ZWQgdGhlIGZpcnN0IHN0YXJ0IHJhdGUKQEAgLTgyMyw3ICs4
MjMsNyBAQCBzdGF0aWMgdTggSFRGaWx0ZXJNQ1NSYXRlKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNl
ICppZWVlLCB1OCAqcFN1cHBvcnRNQ1MsCiAJICovCiAJSFRfUGlja01DU1JhdGUoaWVlZSwgcE9w
ZXJhdGVNQ1MpOwoKLQkvLyBGb3IgUlRMODE5WCwgaWYgcGFpcndpc2VrZXkgPSB3ZXAvdGtpcCwg
d2Ugc3VwcG9ydCBvbmx5IE1DUzB+Ny4KKwkvKiBGb3IgUlRMODE5WCwgaWYgcGFpcndpc2VrZXkg
PSB3ZXAvdGtpcCwgd2Ugc3VwcG9ydCBvbmx5IE1DUzB+Ny4gKi8KIAlpZiAoaWVlZS0+R2V0SGFs
Zk5tb2RlU3VwcG9ydEJ5QVBzSGFuZGxlcihpZWVlLT5kZXYpKQogCQlwT3BlcmF0ZU1DU1sxXSA9
IDA7CgpAQCAtODQ1LDggKzg0NSw4IEBAIHZvaWQgSFRPbkFzc29jUnNwKHN0cnVjdCBpZWVlODAy
MTFfZGV2aWNlICppZWVlKQogCXUxNgluTWF4QU1TRFVTaXplID0gMDsKIAl1OAkqcE1jc0ZpbHRl
ciA9IE5VTEw7CgotCXN0YXRpYyB1OAkJCQlFV0MxMU5IVENhcFtdID0gezB4MDAsIDB4OTAsIDB4
NGMsIDB4MzN9OwkJLy8gRm9yIDExbiBFV0MgZGVmaW5pdGlvbiwgMjAwNy4wNy4xNywgYnkgRW1p
bHkKLQlzdGF0aWMgdTgJCQkJRVdDMTFOSFRJbmZvW10gPSB7MHgwMCwgMHg5MCwgMHg0YywgMHgz
NH07CS8vIEZvciAxMW4gRVdDIGRlZmluaXRpb24sIDIwMDcuMDcuMTcsIGJ5IEVtaWx5CisJc3Rh
dGljIHU4CQkJCUVXQzExTkhUQ2FwW10gPSB7MHgwMCwgMHg5MCwgMHg0YywgMHgzM307CQkvKiBG
b3IgMTFuIEVXQyBkZWZpbml0aW9uLCAyMDA3LjA3LjE3LCBieSBFbWlseSAqLworCXN0YXRpYyB1
OAkJCQlFV0MxMU5IVEluZm9bXSA9IHsweDAwLCAweDkwLCAweDRjLCAweDM0fTsJLyogRm9yIDEx
biBFV0MgZGVmaW5pdGlvbiwgMjAwNy4wNy4xNywgYnkgRW1pbHkgKi8KCiAJaWYgKCFwSFRJbmZv
LT5iQ3VycmVudEhUU3VwcG9ydCkgewogCQlJRUVFODAyMTFfREVCVUcoSUVFRTgwMjExX0RMX0VS
UiwKQEAgLTg2MCw3ICs4NjAsNiBAQCB2b2lkIEhUT25Bc3NvY1JzcChzdHJ1Y3QgaWVlZTgwMjEx
X2RldmljZSAqaWVlZSkKCiAvLwlIVERlYnVnSFRDYXBhYmlsaXR5KHBIVEluZm8tPlBlZXJIVENh
cEJ1ZiwiSFRPbkFzc29jUnNwX3dxIik7CiAvLwlIVERlYnVnSFRJbmZvKHBIVEluZm8tPlBlZXJI
VEluZm9CdWYsIkhUT25Bc3NvY1JzcF93cSIpOwotCS8vCiAJaWYgKCFtZW1jbXAocEhUSW5mby0+
UGVlckhUQ2FwQnVmLCBFV0MxMU5IVENhcCwgc2l6ZW9mKEVXQzExTkhUQ2FwKSkpCiAJCXBQZWVy
SFRDYXAgPSAoc3RydWN0IGh0X2NhcGFiaWxpdHlfZWxlICopKCZwSFRJbmZvLT5QZWVySFRDYXBC
dWZbNF0pOwogCWVsc2UKQEAgLTg3MSwxMyArODcwLDEyIEBAIHZvaWQgSFRPbkFzc29jUnNwKHN0
cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlKQogCWVsc2UKIAkJcFBlZXJIVEluZm8gPSAoUEhU
X0lORk9STUFUSU9OX0VMRSkocEhUSW5mby0+UGVlckhUSW5mb0J1Zik7CgotCS8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCi0JLy8gQ29uZmln
dXJhdGlvbnM6Ci0JLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v
Ly8vLy8vLy8vLy8KKwkvKgorCSAqIENvbmZpZ3VyYXRpb25zOgorCSAqLwogCUlFRUU4MDIxMV9E
RUJVR19EQVRBKElFRUU4MDIxMV9ETF9EQVRBIHwgSUVFRTgwMjExX0RMX0hULCBwUGVlckhUQ2Fw
LCBzaXplb2Yoc3RydWN0IGh0X2NhcGFiaWxpdHlfZWxlKSk7CiAvLwlJRUVFODAyMTFfREVCVUdf
REFUQShJRUVFODAyMTFfRExfREFUQXxJRUVFODAyMTFfRExfSFQsIHBQZWVySFRJbmZvLCBzaXpl
b2YoSFRfSU5GT1JNQVRJT05fRUxFKSk7CiAJLy8gQ29uZmlnIFN1cHBvcnRlZCBDaGFubmVsIFdp
ZHRoIHNldHRpbmcKLQkvLwogCUhUU2V0Q29ubmVjdEJ3TW9kZShpZWVlLCAoZW51bSBodF9jaGFu
bmVsX3dpZHRoKShwUGVlckhUQ2FwLT5DaGxXaWR0aCksIChlbnVtIGh0X2V4dGVuc2lvbl9jaGFu
X29mZnNldCkocFBlZXJIVEluZm8tPkV4dENobE9mZnNldCkpOwoKIAlwSFRJbmZvLT5iQ3VyVHhC
VzQwTUh6ID0gKHBQZWVySFRJbmZvLT5SZWNvbW1lbWRlZFR4V2lkdGggPT0gMSk7CkBAIC05Mjcs
NyArOTI1LDcgQEAgdm9pZCBIVE9uQXNzb2NSc3Aoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmll
ZWUpCiAJICogQnkgRW1pbHkKIAkgKi8KIAlpZiAoIXBIVEluZm8tPmJSZWdSVDJSVEFnZ3JlZ2F0
aW9uKSB7Ci0JCS8vIERlY2lkZSBBTVBEVSBGYWN0b3IgYWNjb3JkaW5nIHRvIHByb3RvY29sIGhh
bmRzaGFrZQorCQkvKiBEZWNpZGUgQU1QRFUgRmFjdG9yIGFjY29yZGluZyB0byBwcm90b2NvbCBo
YW5kc2hha2UgKi8KIAkJaWYgKHBIVEluZm8tPkFNUERVX0ZhY3RvciA+IHBQZWVySFRDYXAtPk1h
eFJ4QU1QRFVGYWN0b3IpCiAJCQlwSFRJbmZvLT5DdXJyZW50QU1QRFVGYWN0b3IgPSBwUGVlckhU
Q2FwLT5NYXhSeEFNUERVRmFjdG9yOwogCQllbHNlCkBAIC05MzksNyArOTM3LDcgQEAgdm9pZCBI
VE9uQXNzb2NSc3Aoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpCiAJCSAqLwogCQlpZiAo
aWVlZS0+Y3VycmVudF9uZXR3b3JrLmJzc2h0LmJkUlQyUlRBZ2dyZWdhdGlvbikgewogCQkJaWYg
KGllZWUtPnBhaXJ3aXNlX2tleV90eXBlICE9IEtFWV9UWVBFX05BKQotCQkJCS8vIFJlYWx0ZWsg
bWF5IHNldCAzMmsgaW4gc2VjdXJpdHkgbW9kZSBhbmQgNjRrIGZvciBvdGhlcnMKKwkJCQkvKiBS
ZWFsdGVrIG1heSBzZXQgMzJrIGluIHNlY3VyaXR5IG1vZGUgYW5kIDY0ayBmb3Igb3RoZXJzICov
CiAJCQkJcEhUSW5mby0+Q3VycmVudEFNUERVRmFjdG9yID0gcFBlZXJIVENhcC0+TWF4UnhBTVBE
VUZhY3RvcjsKIAkJCWVsc2UKIAkJCQlwSFRJbmZvLT5DdXJyZW50QU1QRFVGYWN0b3IgPSBIVF9B
R0dfU0laRV82NEs7CkBAIC05NjAsMTAgKzk1OCwxMCBAQCB2b2lkIEhUT25Bc3NvY1JzcChzdHJ1
Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSkKIAllbHNlCiAJCXBIVEluZm8tPkN1cnJlbnRNUERV
RGVuc2l0eSA9IHBQZWVySFRDYXAtPk1QRFVEZW5zaXR5OwogCWlmIChpZWVlLT5wYWlyd2lzZV9r
ZXlfdHlwZSAhPSBLRVlfVFlQRV9OQSkKLQkJcEhUSW5mby0+Q3VycmVudE1QRFVEZW5zaXR5CT0g
NzsgLy8gOHVzCi0JLy8gRm9yY2UgVFggQU1TRFUKKwkJcEhUSW5mby0+Q3VycmVudE1QRFVEZW5z
aXR5CT0gNzsgLyogOHVzICovCisJLyogRm9yY2UgVFggQU1TRFUgKi8KCi0JLy8gTGFuaHNpbjog
bWFyayBmb3IgdG1wIHRvIGF2b2lkIGRlYXV0aCBieSBhcCBmcm9tICBzMworCS8qIExhbmhzaW46
IG1hcmsgZm9yIHRtcCB0byBhdm9pZCBkZWF1dGggYnkgYXAgZnJvbSAgczMgKi8KIAkvL2lmKG1l
bWNtcChwTWdudEluZm8tPkJzc2lkLCBORVRHRUFSODM0QnYyX0JST0FEQ09NLCAzKT09MCkKIAlp
ZiAoMCkgewogCQlwSFRJbmZvLT5iQ3VycmVudEFNUERVRW5hYmxlID0gZmFsc2U7CkBAIC05NzMs
NyArOTcxLDcgQEAgdm9pZCBIVE9uQXNzb2NSc3Aoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmll
ZWUpCiAJCXBIVEluZm8tPklPVEFjdGlvbiB8PSAgSFRfSU9UX0FDVF9UWF9VU0VfQU1TRFVfOEs7
CiAJfQoKLQkvLyBSeCBSZW9yZGVyIFNldHRpbmcKKwkvKiBSeCBSZW9yZGVyIFNldHRpbmcgKi8K
IAlwSFRJbmZvLT5iQ3VyUnhSZW9yZGVyRW5hYmxlID0gcEhUSW5mby0+YlJlZ1J4UmVvcmRlckVu
YWJsZTsKCiAJLyoKQEAgLTEwMDAsNyArOTk4LDcgQEAgdm9pZCBIVE9uQXNzb2NSc3Aoc3RydWN0
IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpCiAJCXBNY3NGaWx0ZXIgPSBNQ1NfRklMVEVSXzFTUzsK
IAllbHNlCiAJCXBNY3NGaWx0ZXIgPSBNQ1NfRklMVEVSX0FMTDsKLQkvL1dCIGFkZCBmb3IgTUNT
OCBidWcKKwkvKiBXQiBhZGQgZm9yIE1DUzggYnVnICovCiAvLwlwTWNzRmlsdGVyID0gTUNTX0ZJ
TFRFUl8xU1M7CiAJaWVlZS0+SFRIaWdoZXN0T3BlcmFSYXRlID0gSFRHZXRIaWdoZXN0TUNTUmF0
ZShpZWVlLCBpZWVlLT5kb3QxMUhUT3BlcmF0aW9uYWxSYXRlU2V0LCBwTWNzRmlsdGVyKTsKIAlp
ZWVlLT5IVEN1cnJlbnRPcGVyYVJhdGUgPSBpZWVlLT5IVEhpZ2hlc3RPcGVyYVJhdGU7CkBAIC0x
MDIwLDcgKzEwMTgsNyBAQCB2b2lkIEhUT25Bc3NvY1JzcChzdHJ1Y3QgaWVlZTgwMjExX2Rldmlj
ZSAqaWVlZSkKICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICgxKSBNUElu
aXRpYWxpemF0aW9uIFBoYXNlCiAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAq
ICAoMikgUmVjZWl2aW5nIG9mIERlYXV0aGVudGljYXRpb24gZnJvbSBBUAogICovCi0vLyBUT0RP
OiBTaG91bGQgdGhpcyBmdW5jaXRvbiBiZSBjYWxsZWQgd2hlbiByZWNlaXZpbmcgb2YgRGlzYXNz
b2NpYXRpb24/CisvKiBUT0RPOiBTaG91bGQgdGhpcyBmdW5jaXRvbiBiZSBjYWxsZWQgd2hlbiBy
ZWNlaXZpbmcgb2YgRGlzYXNzb2NpYXRpb24/ICovCiB2b2lkIEhUSW5pdGlhbGl6ZUhUSW5mbyhz
dHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSkKIHsKIAlQUlRfSElHSF9USFJPVUdIUFVUIHBI
VEluZm8gPSBpZWVlLT5wSFRJbmZvOwpAQCAtMTAzMSwxMSArMTAyOSwxMSBAQCB2b2lkIEhUSW5p
dGlhbGl6ZUhUSW5mbyhzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSkKIAlJRUVFODAyMTFf
REVCVUcoSUVFRTgwMjExX0RMX0hULCAiPT09PT09PT09PT0+JXMoKVxuIiwgX19mdW5jX18pOwog
CXBIVEluZm8tPmJDdXJyZW50SFRTdXBwb3J0ID0gZmFsc2U7CgotCS8vIDQwTUh6IGNoYW5uZWwg
c3VwcG9ydAorCS8qIDQwTUh6IGNoYW5uZWwgc3VwcG9ydCAqLwogCXBIVEluZm8tPmJDdXJCVzQw
TUh6ID0gZmFsc2U7CiAJcEhUSW5mby0+YkN1clR4Qlc0ME1IeiA9IGZhbHNlOwoKLQkvLyBTaG9y
dCBHSSBzdXBwb3J0CisJLyogU2hvcnQgR0kgc3VwcG9ydCAqLwogCXBIVEluZm8tPmJDdXJTaG9y
dEdJMjBNSHogPSBmYWxzZTsKIAlwSFRJbmZvLT5iQ3VyU2hvcnRHSTQwTUh6ID0gZmFsc2U7CiAJ
cEhUSW5mby0+YkZvcmNlZFNob3J0R0kgPSBmYWxzZTsKQEAgLTEwNDgsMTUgKzEwNDYsMTUgQEAg
dm9pZCBIVEluaXRpYWxpemVIVEluZm8oc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUpCiAJ
ICovCiAJcEhUSW5mby0+YkN1clN1cHBDQ0sgPSB0cnVlOwoKLQkvLyBBTVNEVSByZWxhdGVkCisJ
LyogQU1TRFUgcmVsYXRlZCAqLwogCXBIVEluZm8tPmJDdXJyZW50X0FNU0RVX1N1cHBvcnQgPSBm
YWxzZTsKIAlwSFRJbmZvLT5uQ3VycmVudF9BTVNEVV9NYXhTaXplID0gcEhUSW5mby0+bkFNU0RV
X01heFNpemU7CgotCS8vIEFNUFVEIHJlbGF0ZWQKKwkvKiBBTVBVRCByZWxhdGVkICovCiAJcEhU
SW5mby0+Q3VycmVudE1QRFVEZW5zaXR5ID0gcEhUSW5mby0+TVBEVV9EZW5zaXR5OwogCXBIVElu
Zm8tPkN1cnJlbnRBTVBEVUZhY3RvciA9IHBIVEluZm8tPkFNUERVX0ZhY3RvcjsKCi0JLy8gSW5p
dGlhbGl6ZSBhbGwgb2YgdGhlIHBhcmFtZXRlcnMgcmVsYXRlZCB0byAxMW4KKwkvKiBJbml0aWFs
aXplIGFsbCBvZiB0aGUgcGFyYW1ldGVycyByZWxhdGVkIHRvIDExbiAqLwogCW1lbXNldCgmcEhU
SW5mby0+U2VsZkhUQ2FwLCAwLCBzaXplb2YocEhUSW5mby0+U2VsZkhUQ2FwKSk7CiAJbWVtc2V0
KCZwSFRJbmZvLT5TZWxmSFRJbmZvLCAwLCBzaXplb2YocEhUSW5mby0+U2VsZkhUSW5mbykpOwog
CW1lbXNldCgmcEhUSW5mby0+UGVlckhUQ2FwQnVmLCAwLCBzaXplb2YocEhUSW5mby0+UGVlckhU
Q2FwQnVmKSk7CkBAIC0xMDY0LDIyICsxMDYyLDIyIEBAIHZvaWQgSFRJbml0aWFsaXplSFRJbmZv
KHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlKQoKIAlwSFRJbmZvLT5iU3dCd0luUHJvZ3Jl
c3MgPSBmYWxzZTsKCi0JLy8gU2V0IGRlZmF1bHQgSUVFRSBzcGVjIGZvciBEcmFmdCBOCisJLyog
U2V0IGRlZmF1bHQgSUVFRSBzcGVjIGZvciBEcmFmdCBOICovCiAJcEhUSW5mby0+ZVBlZXJIVFNw
ZWNWZXIgPSBIVF9TUEVDX1ZFUl9JRUVFOwoKLQkvLyBSZWFsdGVrIHByb3ByaWV0YXJ5IGFnZ3Jl
Z2F0aW9uIG1vZGUKKwkvKiBSZWFsdGVrIHByb3ByaWV0YXJ5IGFnZ3JlZ2F0aW9uIG1vZGUgKi8K
IAlwSFRJbmZvLT5iQ3VycmVudFJUMlJUQWdncmVnYXRpb24gPSBmYWxzZTsKIAlwSFRJbmZvLT5i
Q3VycmVudFJUMlJUTG9uZ1Nsb3RUaW1lID0gZmFsc2U7CiAJcEhUSW5mby0+SU9UUGVlciA9IDA7
CiAJcEhUSW5mby0+SU9UQWN0aW9uID0gMDsKCi0JLy9NQ1MgcmF0ZSBpbml0aWFsaXplZCBoZXJl
CisJLyogTUNTIHJhdGUgaW5pdGlhbGl6ZWQgaGVyZSAqLwogCXsKIAkJdTggKlJlZ0hUU3VwcFJh
dGVTZXRzID0gJmllZWUtPlJlZ0hUU3VwcFJhdGVTZXRbMF07CgotCQlSZWdIVFN1cHBSYXRlU2V0
c1swXSA9IDB4RkY7CS8vc3VwcG9ydCBNQ1MgMH43Ci0JCVJlZ0hUU3VwcFJhdGVTZXRzWzFdID0g
MHhGRjsJLy9zdXBwb3J0IE1DUyA4fjE1Ci0JCVJlZ0hUU3VwcFJhdGVTZXRzWzRdID0gMHgwMTsJ
Ly9zdXBwb3J0IE1DUyAzMgorCQlSZWdIVFN1cHBSYXRlU2V0c1swXSA9IDB4RkY7CS8qIHN1cHBv
cnQgTUNTIDB+NyAqLworCQlSZWdIVFN1cHBSYXRlU2V0c1sxXSA9IDB4RkY7CS8qIHN1cHBvcnQg
TUNTIDh+MTUgKi8KKwkJUmVnSFRTdXBwUmF0ZVNldHNbNF0gPSAweDAxOwkvKiBzdXBwb3J0IE1D
UyAzMiAqLwogCX0KIH0KCkBAIC0xMTIyLDkgKzExMjAsOSBAQCB2b2lkIEhUUmVzZXRTZWxmQW5k
U2F2ZVBlZXJTZXR0aW5nKHN0cnVjdCBpZWVlODAyMTFfZGV2aWNlICppZWVlLAlzdHJ1Y3QgaWVl
ZTgwMgogLy8JdTgqCXBNY3NGaWx0ZXI7CiAJdTgJYklPVEFjdGlvbiA9IDA7CgotCS8vCi0JLy8g
IFNhdmUgUGVlciBTZXR0aW5nIGJlZm9yZSBBc3NvY2lhdGlvbgotCS8vCisJLyoKKwkgKiAgU2F2
ZSBQZWVyIFNldHRpbmcgYmVmb3JlIEFzc29jaWF0aW9uCisJICovCiAJSUVFRTgwMjExX0RFQlVH
KElFRUU4MDIxMV9ETF9IVCwgIj09PT09PT09PT09PT09PiVzKClcbiIsIF9fZnVuY19fKTsKIAkv
KnVubWFyayBiRW5hYmxlSFQgZmxhZyBoZXJlIGlzIHRoZSBzYW1lIHJlYXNvbiB3aHkgdW5tYXJr
ZWQgaW4gZnVuY3Rpb24gaWVlZTgwMjExX3NvZnRtYWNfbmV3X25ldC4gV0IgMjAwOC4wOS4xMCov
CiAvLwlpZiggcEhUSW5mby0+YkVuYWJsZUhUICYmICBwTmV0d29yay0+YnNzaHQuYmRTdXBwb3J0
SFQpCkBAIC0xMTMyLDE0ICsxMTMwLDE0IEBAIHZvaWQgSFRSZXNldFNlbGZBbmRTYXZlUGVlclNl
dHRpbmcoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsCXN0cnVjdCBpZWVlODAyCiAJCXBI
VEluZm8tPmJDdXJyZW50SFRTdXBwb3J0ID0gdHJ1ZTsKIAkJcEhUSW5mby0+ZVBlZXJIVFNwZWNW
ZXIgPSBwTmV0d29yay0+YnNzaHQuYmRIVFNwZWNWZXI7CgotCQkvLyBTYXZlIEhUQ2FwIGFuZCBI
VEluZm8gaW5mb3JtYXRpb24gRWxlbWVudAorCQkvKiBTYXZlIEhUQ2FwIGFuZCBIVEluZm8gaW5m
b3JtYXRpb24gRWxlbWVudCAqLwogCQlpZiAocE5ldHdvcmstPmJzc2h0LmJkSFRDYXBMZW4gPiAw
ICYmCXBOZXR3b3JrLT5ic3NodC5iZEhUQ2FwTGVuIDw9IHNpemVvZihwSFRJbmZvLT5QZWVySFRD
YXBCdWYpKQogCQkJbWVtY3B5KHBIVEluZm8tPlBlZXJIVENhcEJ1ZiwgcE5ldHdvcmstPmJzc2h0
LmJkSFRDYXBCdWYsIHBOZXR3b3JrLT5ic3NodC5iZEhUQ2FwTGVuKTsKCiAJCWlmIChwTmV0d29y
ay0+YnNzaHQuYmRIVEluZm9MZW4gPiAwICYmIHBOZXR3b3JrLT5ic3NodC5iZEhUSW5mb0xlbiA8
PSBzaXplb2YocEhUSW5mby0+UGVlckhUSW5mb0J1ZikpCiAJCQltZW1jcHkocEhUSW5mby0+UGVl
ckhUSW5mb0J1ZiwgcE5ldHdvcmstPmJzc2h0LmJkSFRJbmZvQnVmLCBwTmV0d29yay0+YnNzaHQu
YmRIVEluZm9MZW4pOwoKLQkJLy8gQ2hlY2sgd2hldGhlciBSVCB0byBSVCBhZ2dyZWdhdGlvbiBt
b2RlIGlzIGVuYWJsZWQKKwkJLyogQ2hlY2sgd2hldGhlciBSVCB0byBSVCBhZ2dyZWdhdGlvbiBt
b2RlIGlzIGVuYWJsZWQgKi8KIAkJaWYgKHBIVEluZm8tPmJSZWdSVDJSVEFnZ3JlZ2F0aW9uKSB7
CiAJCQlwSFRJbmZvLT5iQ3VycmVudFJUMlJUQWdncmVnYXRpb24gPSBwTmV0d29yay0+YnNzaHQu
YmRSVDJSVEFnZ3JlZ2F0aW9uOwogCQkJcEhUSW5mby0+YkN1cnJlbnRSVDJSVExvbmdTbG90VGlt
ZSA9IHBOZXR3b3JrLT5ic3NodC5iZFJUMlJUTG9uZ1Nsb3RUaW1lOwpAQCAtMTE0OCw3ICsxMTQ2
LDcgQEAgdm9pZCBIVFJlc2V0U2VsZkFuZFNhdmVQZWVyU2V0dGluZyhzdHJ1Y3QgaWVlZTgwMjEx
X2RldmljZSAqaWVlZSwJc3RydWN0IGllZWU4MDIKIAkJCXBIVEluZm8tPmJDdXJyZW50UlQyUlRM
b25nU2xvdFRpbWUgPSBmYWxzZTsKIAkJfQoKLQkJLy8gRGV0ZXJtaW5lIHRoZSBJT1QgUGVlciBW
ZW5kb3IuCisJCS8qIERldGVybWluZSB0aGUgSU9UIFBlZXIgVmVuZG9yLiAqLwogCQlIVElPVFBl
ZXJEZXRlcm1pbmUoaWVlZSk7CgogCQkvKgpAQCAtMTI2MSw3ICsxMjU5LDcgQEAgdm9pZCBIVFNl
dENvbm5lY3RCd01vZGUoc3RydWN0IGllZWU4MDIxMV9kZXZpY2UgKmllZWUsIGVudW0gaHRfY2hh
bm5lbF93aWR0aCBCYW4KIAlpZiAoIXBIVEluZm8tPmJSZWdCVzQwTUh6KQogCQlyZXR1cm47Cgot
CS8vIFRvIHJlZHVjZSBkdW1teSBvcGVyYXRpb24KKwkvKiBUbyByZWR1Y2UgZHVtbXkgb3BlcmF0
aW9uICovCiAvLwlpZigocEhUSW5mby0+YkN1ckJXNDBNSHo9PWZhbHNlICYmIEJhbmR3aWR0aD09
SFRfQ0hBTk5FTF9XSURUSF8yMCkgfHwKIC8vCSAgIChwSFRJbmZvLT5iQ3VyQlc0ME1Iej09dHJ1
ZSAmJiBCYW5kd2lkdGg9PUhUX0NIQU5ORUxfV0lEVEhfMjBfNDAgJiYgT2Zmc2V0PT1wSFRJbmZv
LT5DdXJTVEFFeHRDaG5sT2Zmc2V0KSkKIC8vCQlyZXR1cm47CkBAIC0xMjcxLDkgKzEyNjksOSBA
QCB2b2lkIEhUU2V0Q29ubmVjdEJ3TW9kZShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwg
ZW51bSBodF9jaGFubmVsX3dpZHRoIEJhbgogLy8JCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJihp
ZWVlLT5id19zcGlubG9jayksIGZsYWdzKTsKIAkJcmV0dXJuOwogCX0KLQkvL2lmIGluIGhhbGYg
TiBtb2RlLCBzZXQgdG8gMjBNIGJhbmR3aWR0aCBwbGVhc2UgMDkuMDguMjAwOCBXQi4KKwkvKiBp
ZiBpbiBoYWxmIE4gbW9kZSwgc2V0IHRvIDIwTSBiYW5kd2lkdGggcGxlYXNlIDA5LjA4LjIwMDgg
V0IuICovCiAJaWYgKEJhbmR3aWR0aCA9PSBIVF9DSEFOTkVMX1dJRFRIXzIwXzQwICYmICghaWVl
ZS0+R2V0SGFsZk5tb2RlU3VwcG9ydEJ5QVBzSGFuZGxlcihpZWVlLT5kZXYpKSkgewotCQkJLy8g
SGFuZGxlIElsbGVnYWwgZXh0ZW5zaW9uIGNoYW5uZWwgb2Zmc2V0ISEKKwkJCS8qIEhhbmRsZSBJ
bGxlZ2FsIGV4dGVuc2lvbiBjaGFubmVsIG9mZnNldCEhICovCiAJCWlmIChpZWVlLT5jdXJyZW50
X25ldHdvcmsuY2hhbm5lbCA8IDIgJiYgT2Zmc2V0ID09IEhUX0VYVENITkxfT0ZGU0VUX0xPV0VS
KQogCQkJT2Zmc2V0ID0gSFRfRVhUQ0hOTF9PRkZTRVRfTk9fRVhUOwogCQlpZiAoT2Zmc2V0ID09
IEhUX0VYVENITkxfT0ZGU0VUX1VQUEVSIHx8IE9mZnNldCA9PSBIVF9FWFRDSE5MX09GRlNFVF9M
T1dFUikgewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9y
dGw4MTl4X1Fvcy5oIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9ydGw4MTl4
X1Fvcy5oCmluZGV4IDMwNTJmNTNkMmU3ZS4uNDQ0MThhMjg0ZmU5IDEwMDY0NAotLS0gYS9kcml2
ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgxOXhfUW9zLmgKKysrIGIvZHJpdmVy
cy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9ydGw4MTl4X1Fvcy5oCkBAIC0xOSwxMCArMTks
MTAgQEAgc3RydWN0IGFjaV9haWZzbiB7CiAgKiBSZWY6IFdNTSBzcGVjIDIuMi4xMTogV01FIFRT
UEVDIEVsZW1lbnQsIHAuMTguCiAgKi8KIGVudW0gZGlyZWN0aW9uX3ZhbHVlIHsKLQlESVJfVVAJ
CQk9IDAsCQkvLyAweDAwCS8vIFVwTGluawotCURJUl9ET1dOCQk9IDEsCQkvLyAweDAxCS8vIERv
d25MaW5rCi0JRElSX0RJUkVDVAkJPSAyLAkJLy8gMHgxMAkvLyBEaXJlY3RMaW5rCi0JRElSX0JJ
X0RJUgkJPSAzLAkJLy8gMHgxMQkvLyBCaS1EaXJlY3Rpb24KKwlESVJfVVAJCQk9IDAsCQkvKiAw
eDAwIFVwTGluayAqLworCURJUl9ET1dOCQk9IDEsCQkvKiAweDAxCURvd25MaW5rICovCisJRElS
X0RJUkVDVAkJPSAyLAkJLyogMHgxMAlEaXJlY3RMaW5rICovCisJRElSX0JJX0RJUgkJPSAzLAkJ
LyogMHgxMQlCaS1EaXJlY3Rpb24gKi8KIH07CgogLyoKQEAgLTMzLDE1ICszMywxNSBAQCBlbnVt
IGRpcmVjdGlvbl92YWx1ZSB7CiAgKiBOb3RlOiBzaXplb2YgMyBCeXRlcwogICovCiBzdHJ1Y3Qg
cW9zX3RzaW5mbyB7Ci0JdTE2CQl1Y190cmFmZmljX3R5cGU6MTsJICAgICAgICAvL1dNTSBpcyBy
ZXNlcnZlZAorCXUxNgkJdWNfdHJhZmZpY190eXBlOjE7CSAgICAgICAgLyogV01NIGlzIHJlc2Vy
dmVkICovCiAJdTE2CQl1Y190c2lkOjQ7CiAJdTE2CQl1Y19kaXJlY3Rpb246MjsKLQl1MTYJCXVj
X2FjY2Vzc19wb2xpY3k6MjsJICAgICAgICAvL1dNTTogYml0OD0wLCBiaXQ3PTEKLQl1MTYJCXVj
X2FnZ3JlZ2F0aW9uOjE7CSAgICAgICAgLy9XTU0gaXMgcmVzZXJ2ZWQKLQl1MTYJCXVjX3BzYjox
OwkJICAgICAgICAvL1dNTVNBIGlzIEFQU0QKKwl1MTYJCXVjX2FjY2Vzc19wb2xpY3k6MjsJICAg
ICAgICAvKiBXTU06IGJpdDg9MCwgYml0Nz0xICovCisJdTE2CQl1Y19hZ2dyZWdhdGlvbjoxOwkg
ICAgICAgIC8qIFdNTSBpcyByZXNlcnZlZCAqLworCXUxNgkJdWNfcHNiOjE7CQkgICAgICAgIC8q
IFdNTVNBIGlzIEFQU0QgKi8KIAl1MTYJCXVjX3VwOjM7Ci0JdTE2CQl1Y190c19pbmZvX2Fja19w
b2xpY3k6MjsJLy9XTU0gaXMgcmVzZXJ2ZWQKLQl1OAkJdWNfc2NoZWR1bGU6MTsJCSAgICAgICAg
Ly9XTU0gaXMgcmVzZXJ2ZWQKKwl1MTYJCXVjX3RzX2luZm9fYWNrX3BvbGljeToyOwkvKiBXTU0g
aXMgcmVzZXJ2ZWQgKi8KKwl1OAkJdWNfc2NoZWR1bGU6MTsJCSAgICAgICAgLyogV01NIGlzIHJl
c2VydmVkICovCiAJdTg6NzsKIH07CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3J0bDgx
OTJ1L2llZWU4MDIxMS9ydGw4MTl4X1RTUHJvYy5jIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1
L2llZWU4MDIxMS9ydGw4MTl4X1RTUHJvYy5jCmluZGV4IDdjYWM2NjhiZmIwYi4uNDY5ZDZhYjNk
YzhlIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvaWVlZTgwMjExL3J0bDgx
OXhfVFNQcm9jLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L2llZWU4MDIxMS9ydGw4
MTl4X1RTUHJvYy5jCkBAIC02LDE1ICs2LDE1IEBACgogc3RhdGljIHZvaWQgVHNTZXR1cFRpbWVP
dXQoc3RydWN0IHRpbWVyX2xpc3QgKnVudXNlZCkKIHsKLQkvLyBOb3QgaW1wbGVtZW50IHlldAot
CS8vIFRoaXMgaXMgdXNlZCBmb3IgV01NU0EgYW5kIEFDTSAsIHRoYXQgd291bGQgc2VuZCBBRERU
U1JlcSBmcmFtZS4KKwkvKiBOb3QgaW1wbGVtZW50IHlldCAqLworCS8qIFRoaXMgaXMgdXNlZCBm
b3IgV01NU0EgYW5kIEFDTSAsIHRoYXQgd291bGQgc2VuZCBBRERUU1JlcSBmcmFtZS4gKi8KIH0K
CiBzdGF0aWMgdm9pZCBUc0luYWN0VGltZW91dChzdHJ1Y3QgdGltZXJfbGlzdCAqdW51c2VkKQog
ewotCS8vIE5vdCBpbXBsZW1lbnQgeWV0Ci0JLy8gVGhpcyBpcyB1c2VkIGZvciBXTU1TQSBhbmQg
QUNNLgotCS8vIFRoaXMgZnVuY3Rpb24gd291bGQgYmUgY2FsbCB3aGVuIFRTIGlzIG5vIFR4L1J4
IGZvciBzb21lIHBlcmlvZCBvZiB0aW1lLgorCS8qIE5vdCBpbXBsZW1lbnQgeWV0ICovCisJLyog
VGhpcyBpcyB1c2VkIGZvciBXTU1TQSBhbmQgQUNNLiAqLworCS8qIFRoaXMgZnVuY3Rpb24gd291
bGQgYmUgY2FsbCB3aGVuIFRTIGlzIG5vIFR4L1J4IGZvciBzb21lIHBlcmlvZCBvZiB0aW1lLiAq
LwogfQoKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKgpAQCAtMzgsNyArMzgsNyBAQCBzdGF0aWMgdm9pZCBSeFBrdFBlbmRpbmdUaW1l
b3V0KHN0cnVjdCB0aW1lcl9saXN0ICp0KQogCXNwaW5fbG9ja19pcnFzYXZlKCYoaWVlZS0+cmVv
cmRlcl9zcGlubG9jayksIGZsYWdzKTsKIAlJRUVFODAyMTFfREVCVUcoSUVFRTgwMjExX0RMX1JF
T1JERVIsICI9PT09PT09PT09PT09PT09PT0+JXMoKVxuIiwgX19mdW5jX18pOwogCWlmIChwUnhU
cy0+cnhfdGltZW91dF9pbmRpY2F0ZV9zZXEgIT0gMHhmZmZmKSB7Ci0JCS8vIEluZGljYXRlIHRo
ZSBwZW5kaW5nIHBhY2tldHMgc2VxdWVudGlhbGx5IGFjY29yZGluZyB0byBTZXFOdW0gdW50aWwg
bWVldCB0aGUgZ2FwLgorCQkvKiBJbmRpY2F0ZSB0aGUgcGVuZGluZyBwYWNrZXRzIHNlcXVlbnRp
YWxseSBhY2NvcmRpbmcgdG8gU2VxTnVtIHVudGlsIG1lZXQgdGhlIGdhcC4gKi8KIAkJd2hpbGUg
KCFsaXN0X2VtcHR5KCZwUnhUcy0+cnhfcGVuZGluZ19wa3RfbGlzdCkpIHsKIAkJCXBSZW9yZGVy
RW50cnkgPSBsaXN0X2VudHJ5KHBSeFRzLT5yeF9wZW5kaW5nX3BrdF9saXN0LnByZXYsIHN0cnVj
dCByeF9yZW9yZGVyX2VudHJ5LCBMaXN0KTsKIAkJCWlmIChpbmRleCA9PSAwKQpAQCAtNjQsMTAg
KzY0LDEwIEBAIHN0YXRpYyB2b2lkIFJ4UGt0UGVuZGluZ1RpbWVvdXQoc3RydWN0IHRpbWVyX2xp
c3QgKnQpCiAJfQoKIAlpZiAoaW5kZXggPiAwKSB7Ci0JCS8vIFNldCByeF90aW1lb3V0X2luZGlj
YXRlX3NlcSB0byAweGZmZmYgdG8gaW5kaWNhdGUgbm8gcGVuZGluZyBwYWNrZXRzIGluIGJ1ZmZl
ciBub3cuCisJCS8qIFNldCByeF90aW1lb3V0X2luZGljYXRlX3NlcSB0byAweGZmZmYgdG8gaW5k
aWNhdGUgbm8gcGVuZGluZyBwYWNrZXRzIGluIGJ1ZmZlciBub3cuICovCiAJCXBSeFRzLT5yeF90
aW1lb3V0X2luZGljYXRlX3NlcSA9IDB4ZmZmZjsKCi0JCS8vIEluZGljYXRlIHBhY2tldHMKKwkJ
LyogSW5kaWNhdGUgcGFja2V0cyAqLwogCQlpZiAoaW5kZXggPiBSRU9SREVSX1dJTl9TSVpFKSB7
CiAJCQlJRUVFODAyMTFfREVCVUcoSUVFRTgwMjExX0RMX0VSUiwgIlJ4UmVvcmRlckluZGljYXRl
UGFja2V0KCk6IFJ4IFJlb3JkZXIgYnVmZmVyIGZ1bGwhISBcbiIpOwogCQkJc3Bpbl91bmxvY2tf
aXJxcmVzdG9yZSgmKGllZWUtPnJlb3JkZXJfc3BpbmxvY2spLCBmbGFncyk7CkBAIC0xMTcsMTYg
KzExNywxNiBAQCBzdGF0aWMgdm9pZCBSZXNldFR4VHNFbnRyeShzdHJ1Y3QgdHhfdHNfcmVjb3Jk
ICpwVFMpCiAJcFRTLT5hZGRfYmFfcmVxX2luX3Byb2dyZXNzID0gZmFsc2U7CiAJcFRTLT5hZGRf
YmFfcmVxX2RlbGF5ZWQgPSBmYWxzZTsKIAlwVFMtPnVzaW5nX2JhID0gZmFsc2U7Ci0JUmVzZXRC
YUVudHJ5KCZwVFMtPnR4X2FkbWl0dGVkX2JhX3JlY29yZCk7IC8vRm9yIEJBIE9yaWdpbmF0b3IK
KwlSZXNldEJhRW50cnkoJnBUUy0+dHhfYWRtaXR0ZWRfYmFfcmVjb3JkKTsgLyogRm9yIEJBIE9y
aWdpbmF0b3IgKi8KIAlSZXNldEJhRW50cnkoJnBUUy0+dHhfcGVuZGluZ19iYV9yZWNvcmQpOwog
fQoKIHN0YXRpYyB2b2lkIFJlc2V0UnhUc0VudHJ5KHN0cnVjdCByeF90c19yZWNvcmQgKnBUUykK
IHsKIAlSZXNldFRzQ29tbW9uSW5mbygmcFRTLT50c19jb21tb25faW5mbyk7Ci0JcFRTLT5yeF9p
bmRpY2F0ZV9zZXEgPSAweGZmZmY7IC8vIFRoaXMgaW5kaWNhdGUgdGhlIHJ4X2luZGljYXRlX3Nl
cSBpcyBub3QgdXNlZCBub3chIQotCXBUUy0+cnhfdGltZW91dF9pbmRpY2F0ZV9zZXEgPSAweGZm
ZmY7IC8vIFRoaXMgaW5kaWNhdGUgdGhlIHJ4X3RpbWVvdXRfaW5kaWNhdGVfc2VxIGlzIG5vdCB1
c2VkIG5vdyEhCi0JUmVzZXRCYUVudHJ5KCZwVFMtPnJ4X2FkbWl0dGVkX2JhX3JlY29yZCk7CSAg
Ly8gRm9yIEJBIFJlY2lwaWVudAorCXBUUy0+cnhfaW5kaWNhdGVfc2VxID0gMHhmZmZmOyAvKiBU
aGlzIGluZGljYXRlIHRoZSByeF9pbmRpY2F0ZV9zZXEgaXMgbm90IHVzZWQgbm93ISEgKi8KKwlw
VFMtPnJ4X3RpbWVvdXRfaW5kaWNhdGVfc2VxID0gMHhmZmZmOyAvKiBUaGlzIGluZGljYXRlIHRo
ZSByeF90aW1lb3V0X2luZGljYXRlX3NlcSBpcyBub3QgdXNlZCBub3chISAqLworCVJlc2V0QmFF
bnRyeSgmcFRTLT5yeF9hZG1pdHRlZF9iYV9yZWNvcmQpOwkgIC8qIEZvciBCQSBSZWNpcGllbnQg
Ki8KIH0KCiB2b2lkIFRTSW5pdGlhbGl6ZShzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSkK
QEAgLTEzNiwxNiArMTM2LDE1IEBAIHZvaWQgVFNJbml0aWFsaXplKHN0cnVjdCBpZWVlODAyMTFf
ZGV2aWNlICppZWVlKQogCXN0cnVjdCByeF9yZW9yZGVyX2VudHJ5CSpwUnhSZW9yZGVyRW50cnkg
PSBpZWVlLT5SeFJlb3JkZXJFbnRyeTsKIAl1OAkJCQljb3VudCA9IDA7CiAJSUVFRTgwMjExX0RF
QlVHKElFRUU4MDIxMV9ETF9UUywgIj09PT09PT09PT0+JXMoKVxuIiwgX19mdW5jX18pOwotCS8v
IEluaXRpYWxpemUgVHggVFMgcmVsYXRlZCBpbmZvLgorCS8qIEluaXRpYWxpemUgVHggVFMgcmVs
YXRlZCBpbmZvLiAqLwogCUlOSVRfTElTVF9IRUFEKCZpZWVlLT5UeF9UU19BZG1pdF9MaXN0KTsK
IAlJTklUX0xJU1RfSEVBRCgmaWVlZS0+VHhfVFNfUGVuZGluZ19MaXN0KTsKIAlJTklUX0xJU1Rf
SEVBRCgmaWVlZS0+VHhfVFNfVW51c2VkX0xpc3QpOwoKIAlmb3IgKGNvdW50ID0gMDsgY291bnQg
PCBUT1RBTF9UU19OVU07IGNvdW50KyspIHsKLQkJLy8KIAkJcFR4VFMtPm51bSA9IGNvdW50Owot
CQkvLyBUaGUgdGltZXJzIGZvciB0aGUgb3BlcmF0aW9uIG9mIFRyYWZmaWMgU3RyZWFtIGFuZCBC
bG9jayBBY2suCi0JCS8vIERMUyByZWxhdGVkIHRpbWVyIHdpbGwgYmUgYWRkIGhlcmUgaW4gdGhl
IGZ1dHVyZSEhCisJCS8qIFRoZSB0aW1lcnMgZm9yIHRoZSBvcGVyYXRpb24gb2YgVHJhZmZpYyBT
dHJlYW0gYW5kIEJsb2NrIEFjay4gKi8KKwkJLyogRExTIHJlbGF0ZWQgdGltZXIgd2lsbCBiZSBh
ZGQgaGVyZSBpbiB0aGUgZnV0dXJlISEgKi8KIAkJdGltZXJfc2V0dXAoJnBUeFRTLT50c19jb21t
b25faW5mby5zZXR1cF90aW1lciwgVHNTZXR1cFRpbWVPdXQsCiAJCQkgICAgMCk7CiAJCXRpbWVy
X3NldHVwKCZwVHhUUy0+dHNfY29tbW9uX2luZm8uaW5hY3RfdGltZXIsIFRzSW5hY3RUaW1lb3V0
LApAQCAtMTYwLDcgKzE1OSw3IEBAIHZvaWQgVFNJbml0aWFsaXplKHN0cnVjdCBpZWVlODAyMTFf
ZGV2aWNlICppZWVlKQogCQlwVHhUUysrOwogCX0KCi0JLy8gSW5pdGlhbGl6ZSBSeCBUUyByZWxh
dGVkIGluZm8uCisJLyogSW5pdGlhbGl6ZSBSeCBUUyByZWxhdGVkIGluZm8uICovCiAJSU5JVF9M
SVNUX0hFQUQoJmllZWUtPlJ4X1RTX0FkbWl0X0xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZpZWVl
LT5SeF9UU19QZW5kaW5nX0xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZpZWVlLT5SeF9UU19VbnVz
ZWRfTGlzdCk7CkBAIC0xNzgsNyArMTc3LDcgQEAgdm9pZCBUU0luaXRpYWxpemUoc3RydWN0IGll
ZWU4MDIxMV9kZXZpY2UgKmllZWUpCiAJCWxpc3RfYWRkX3RhaWwoJnBSeFRTLT50c19jb21tb25f
aW5mby5saXN0LCAmaWVlZS0+UnhfVFNfVW51c2VkX0xpc3QpOwogCQlwUnhUUysrOwogCX0KLQkv
LyBJbml0aWFsaXplIHVudXNlZCBSeCBSZW9yZGVyIExpc3QuCisJLyogSW5pdGlhbGl6ZSB1bnVz
ZWQgUnggUmVvcmRlciBMaXN0LiAqLwogCUlOSVRfTElTVF9IRUFEKCZpZWVlLT5SeFJlb3JkZXJf
VW51c2VkX0xpc3QpOwogLy8jaWZkZWYgVE9fRE9fTElTVAogCWZvciAoY291bnQgPSAwOyBjb3Vu
dCA8IFJFT1JERVJfRU5UUllfTlVNOyBjb3VudCsrKSB7CkBAIC0yMDksOSArMjA4LDkgQEAgc3Rh
dGljIHN0cnVjdCB0c19jb21tb25faW5mbyAqU2VhcmNoQWRtaXRUUlN0cmVhbShzdHJ1Y3QgaWVl
ZTgwMjExX2RldmljZSAqaWVlZSwKIAkvL0RJUkVDVElPTl9WQUxVRQlkaXI7CiAJdTgJZGlyOwog
CWJvb2wJCQkJc2VhcmNoX2Rpcls0XSA9IHswfTsKLQlzdHJ1Y3QgbGlzdF9oZWFkCQkqcHNlYXJj
aF9saXN0OyAvL0ZJWE1FCisJc3RydWN0IGxpc3RfaGVhZAkJKnBzZWFyY2hfbGlzdDsgLyogRklY
TUUgKi8KIAlzdHJ1Y3QgdHNfY29tbW9uX2luZm8JKnBSZXQgPSBOVUxMOwotCWlmIChpZWVlLT5p
d19tb2RlID09IElXX01PREVfTUFTVEVSKSB7IC8vYXAgbW9kZQorCWlmIChpZWVlLT5pd19tb2Rl
ID09IElXX01PREVfTUFTVEVSKSB7IC8qIGFwIG1vZGUgKi8KIAkJaWYgKFR4UnhTZWxlY3QgPT0g
VFhfRElSKSB7CiAJCQlzZWFyY2hfZGlyW0RJUl9ET1dOXSA9IHRydWU7CiAJCQlzZWFyY2hfZGly
W0RJUl9CSV9ESVJdID0gdHJ1ZTsKQEAgLTI5MSwxNSArMjkwLDE1IEBAIGJvb2wgR2V0VHMoCiAJ
c3RydWN0IHRzX2NvbW1vbl9pbmZvCQkqKnBwVFMsCiAJdTgJCQkJKkFkZHIsCiAJdTgJCQkJVElE
LAotCWVudW0gdHJfc2VsZWN0CQkJVHhSeFNlbGVjdCwgIC8vUng6MSwgVHg6MAorCWVudW0gdHJf
c2VsZWN0CQkJVHhSeFNlbGVjdCwgIC8qIFJ4OjEsIFR4OjAgKi8KIAlib29sCQkJCWJBZGROZXdU
cwogCSkKIHsKIAl1OAlVUCA9IDA7Ci0JLy8KLQkvLyBXZSBkbyBub3QgYnVpbGQgYW55IFRTIGZv
ciBCcm9hZGNhc3Qgb3IgTXVsdGljYXN0IHN0cmVhbS4KLQkvLyBTbyByZWplY3QgdGhlc2Uga2lu
ZHMgb2Ygc2VhcmNoIGhlcmUuCi0JLy8KKwkvKgorCSAqIFdlIGRvIG5vdCBidWlsZCBhbnkgVFMg
Zm9yIEJyb2FkY2FzdCBvciBNdWx0aWNhc3Qgc3RyZWFtLgorCSAqIFNvIHJlamVjdCB0aGVzZSBr
aW5kcyBvZiBzZWFyY2ggaGVyZS4KKwkgKi8KIAlpZiAoaXNfbXVsdGljYXN0X2V0aGVyX2FkZHIo
QWRkcikpIHsKIAkJSUVFRTgwMjExX0RFQlVHKElFRUU4MDIxMV9ETF9FUlIsICJnZXQgVFMgZm9y
IEJyb2FkY2FzdCBvciBNdWx0aWNhc3RcbiIpOwogCQlyZXR1cm4gZmFsc2U7CkBAIC0zMDgsNyAr
MzA3LDcgQEAgYm9vbCBHZXRUcygKIAlpZiAoaWVlZS0+Y3VycmVudF9uZXR3b3JrLnFvc19kYXRh
LnN1cHBvcnRlZCA9PSAwKSB7CiAJCVVQID0gMDsKIAl9IGVsc2UgewotCQkvLyBJbiBXTU0gY2Fz
ZTogd2UgdXNlIDQgVElEIG9ubHkKKwkJLyogSW4gV01NIGNhc2U6IHdlIHVzZSA0IFRJRCBvbmx5
ICovCiAJCWlmICghaXNfYWNfdmFsaWQoVElEKSkgewogCQkJSUVFRTgwMjExX0RFQlVHKElFRUU4
MDIxMV9ETF9FUlIsICIgaW4gJXMoKSwgVElEKCVkKSBpcyBub3QgdmFsaWRcbiIsIF9fZnVuY19f
LCBUSUQpOwogCQkJcmV0dXJuIGZhbHNlOwpAQCAtMzQ5LDExICszNDgsMTEgQEAgYm9vbCBHZXRU
cygKIAkJCUlFRUU4MDIxMV9ERUJVRyhJRUVFODAyMTFfRExfVFMsICJhZGQgbmV3IFRTIGZhaWxl
ZCh0aWQ6JWQpXG4iLCBVUCk7CiAJCQlyZXR1cm4gZmFsc2U7CiAJCX0gZWxzZSB7Ci0JCQkvLwot
CQkJLy8gQ3JlYXRlIGEgbmV3IFRyYWZmaWMgc3RyZWFtIGZvciBjdXJyZW50IFR4L1J4Ci0JCQkv
LyBUaGlzIGlzIGZvciBFRENBIGFuZCBXTU0gdG8gYWRkIGEgbmV3IFRTLgotCQkJLy8gRm9yIEhD
Q0Egb3IgV01NU0EsIFRTIGNhbm5vdCBiZSBhZGRtaXQgd2l0aG91dCBuZWdvdGlhdGlvbi4KLQkJ
CS8vCisJCQkvKgorCQkJICogQ3JlYXRlIGEgbmV3IFRyYWZmaWMgc3RyZWFtIGZvciBjdXJyZW50
IFR4L1J4CisJCQkgKiBUaGlzIGlzIGZvciBFRENBIGFuZCBXTU0gdG8gYWRkIGEgbmV3IFRTLgor
CQkJICogRm9yIEhDQ0Egb3IgV01NU0EsIFRTIGNhbm5vdCBiZSBhZGRtaXQgd2l0aG91dCBuZWdv
dGlhdGlvbi4KKwkJCSAqLwogCQkJc3RydWN0IHRzcGVjX2JvZHkJVFNwZWM7CiAJCQlzdHJ1Y3Qg
cW9zX3RzaW5mbwkqcFRTSW5mbyA9ICZUU3BlYy50c19pbmZvOwogCQkJc3RydWN0IGxpc3RfaGVh
ZAkqcFVudXNlZExpc3QgPQpAQCAtMzgyLDIxICszODEsMjEgQEAgYm9vbCBHZXRUcygKIAkJCQl9
CgogCQkJCUlFRUU4MDIxMV9ERUJVRyhJRUVFODAyMTFfRExfVFMsICJ0byBpbml0IGN1cnJlbnQg
VFMsIFVQOiVkLCBEaXI6JWQsIGFkZHI6JXBNXG4iLCBVUCwgRGlyLCBBZGRyKTsKLQkJCQkvLyBQ
cmVwYXJlIFRTIEluZm8gcmVsZWF0ZWQgZmllbGQKLQkJCQlwVFNJbmZvLT51Y190cmFmZmljX3R5
cGUgPSAwOwkJLy8gVHJhZmZpYyB0eXBlOiBXTU0gaXMgcmVzZXJ2ZWQgaW4gdGhpcyBmaWVsZAot
CQkJCXBUU0luZm8tPnVjX3RzaWQgPSBVUDsJCQkvLyBUU0lECi0JCQkJcFRTSW5mby0+dWNfZGly
ZWN0aW9uID0gRGlyOwkJLy8gRGlyZWN0aW9uOiBpZiB0aGVyZSBpcyBEaXJlY3RMaW5rLCB0aGlz
IG5lZWQgYWRkaXRpb25hbCBjb25zaWRlcmF0aW9uLgotCQkJCXBUU0luZm8tPnVjX2FjY2Vzc19w
b2xpY3kgPSAxOwkJLy8gQWNjZXNzIHBvbGljeQotCQkJCXBUU0luZm8tPnVjX2FnZ3JlZ2F0aW9u
ID0gMDsJCS8vIEFnZ3JlZ2F0aW9uCi0JCQkJcFRTSW5mby0+dWNfcHNiID0gMDsJCQkvLyBBZ2dy
ZWdhdGlvbgotCQkJCXBUU0luZm8tPnVjX3VwID0gVVA7CQkJLy8gVXNlciBwcmlvcml0eQotCQkJ
CXBUU0luZm8tPnVjX3RzX2luZm9fYWNrX3BvbGljeSA9IDA7CS8vIEFjayBwb2xpY3kKLQkJCQlw
VFNJbmZvLT51Y19zY2hlZHVsZSA9IDA7CQkvLyBTY2hlZHVsZQorCQkJCS8qIFByZXBhcmUgVFMg
SW5mbyByZWxlYXRlZCBmaWVsZCAqLworCQkJCXBUU0luZm8tPnVjX3RyYWZmaWNfdHlwZSA9IDA7
CQkvKiBUcmFmZmljIHR5cGU6IFdNTSBpcyByZXNlcnZlZCBpbiB0aGlzIGZpZWxkICovCisJCQkJ
cFRTSW5mby0+dWNfdHNpZCA9IFVQOwkJCS8qIFRTSUQgKi8KKwkJCQlwVFNJbmZvLT51Y19kaXJl
Y3Rpb24gPSBEaXI7CQkvKiBEaXJlY3Rpb246IGlmIHRoZXJlIGlzIERpcmVjdExpbmssIHRoaXMg
bmVlZCBhZGRpdGlvbmFsIGNvbnNpZGVyYXRpb24uICovCisJCQkJcFRTSW5mby0+dWNfYWNjZXNz
X3BvbGljeSA9IDE7CQkvKiBBY2Nlc3MgcG9saWN5ICovCisJCQkJcFRTSW5mby0+dWNfYWdncmVn
YXRpb24gPSAwOwkJLyogQWdncmVnYXRpb24gKi8KKwkJCQlwVFNJbmZvLT51Y19wc2IgPSAwOwkJ
CS8qIEFnZ3JlZ2F0aW9uICovCisJCQkJcFRTSW5mby0+dWNfdXAgPSBVUDsJCQkvKiBVc2VyIHBy
aW9yaXR5ICovCisJCQkJcFRTSW5mby0+dWNfdHNfaW5mb19hY2tfcG9saWN5ID0gMDsJLyogQWNr
IHBvbGljeSAqLworCQkJCXBUU0luZm8tPnVjX3NjaGVkdWxlID0gMDsJCS8qIFNjaGVkdWxlICov
CgogCQkJCU1ha2VUU0VudHJ5KCpwcFRTLCBBZGRyLCAmVFNwZWMsIE5VTEwsIDAsIDApOwogCQkJ
CUFkbWl0VFMoaWVlZSwgKnBwVFMsIDApOwogCQkJCWxpc3RfYWRkX3RhaWwoJigoKnBwVFMpLT5s
aXN0KSwgcEFkZG1pdExpc3QpOwotCQkJCS8vIGlmIHRoZXJlIGlzIERpcmVjdExpbmssIHdlIG5l
ZWQgdG8gZG8gYWRkaXRpb25hbCBvcGVyYXRpb24gaGVyZSEhCisJCQkJLyogaWYgdGhlcmUgaXMg
RGlyZWN0TGluaywgd2UgbmVlZCB0byBkbyBhZGRpdGlvbmFsIG9wZXJhdGlvbiBoZXJlISEgKi8K
CiAJCQkJcmV0dXJuIHRydWU7CiAJCQl9IGVsc2UgewpAQCAtNTMwLDcgKzUyOSw3IEBAIHZvaWQg
VHNTdGFydEFkZEJhUHJvY2VzcyhzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSwgc3RydWN0
IHR4X3RzX3JlY29yZCAqcFR4CiAJCQkJICBqaWZmaWVzICsgbXNlY3NfdG9famlmZmllcyhUU19B
RERCQV9ERUxBWSkpOwogCQl9IGVsc2UgewogCQkJSUVFRTgwMjExX0RFQlVHKElFRUU4MDIxMV9E
TF9CQSwgIlRzU3RhcnRBZGRCYVByb2Nlc3MoKTogSW1tZWRpYXRlbHkgU3RhcnQgQUREQkEgbm93
ISFcbiIpOwotCQkJbW9kX3RpbWVyKCZwVHhUUy0+dHNfYWRkX2JhX3RpbWVyLCBqaWZmaWVzKzEw
KTsgLy9zZXQgMTAgdGlja3MKKwkJCW1vZF90aW1lcigmcFR4VFMtPnRzX2FkZF9iYV90aW1lciwg
amlmZmllcysxMCk7IC8qIHNldCAxMCB0aWNrcyAqLwogCQl9CiAJfSBlbHNlIHsKIAkJSUVFRTgw
MjExX0RFQlVHKElFRUU4MDIxMV9ETF9FUlIsICIlcygpPT0+QkEgdGltZXIgaXMgYWxyZWFkeSBh
ZGRlZFxuIiwgX19mdW5jX18pOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1
L3I4MTgwXzkzY3g2LmMgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxODBfOTNjeDYuYwpp
bmRleCBkZTgzZGFhMGM5ZWQuLmU3NmYxYjJlYTJlMCAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFn
aW5nL3J0bDgxOTJ1L3I4MTgwXzkzY3g2LmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1
L3I4MTgwXzkzY3g2LmMKQEAgLTE1NCw3ICsxNTQsOCBAQCBpbnQgZXByb21fcmVhZChzdHJ1Y3Qg
bmV0X2RldmljZSAqZGV2LCB1MzIgYWRkcikKIAllcHJvbV93KGRldiwgMCk7CgogCWZvciAoaSA9
IDA7IGkgPCAxNjsgaSsrKSB7Ci0JCS8qIGVlcHJvbSBuZWVkcyBhIGNsayBjeWNsZSBiZXR3ZWVu
IHdyaXRpbmcgb3Bjb2RlJmFkcgorCQkvKgorCQkgKiBlZXByb20gbmVlZHMgYSBjbGsgY3ljbGUg
YmV0d2VlbiB3cml0aW5nIG9wY29kZSZhZHIKIAkJICogYW5kIHJlYWRpbmcgZGF0YS4gKGVlcHJv
bSBvdXRzIGEgZHVtbXkgMCkKIAkJICovCiAJCWVwcm9tX2NrX2N5Y2xlKGRldik7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxODBfOTNjeDYuaCBiL2RyaXZlcnMvc3Rh
Z2luZy9ydGw4MTkydS9yODE4MF85M2N4Ni5oCmluZGV4IDBjZGQwMGE0ZjdiOC4uM2RjM2NkYjIx
OTRlIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxODBfOTNjeDYuaAor
KysgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxODBfOTNjeDYuaApAQCAtMTQsOCArMTQs
OCBAQAogICoJcHJvamVjdCBBdXRob3JzLgogICovCgotLypUaGlzIGZpbGVzIGNvbnRhaW5zIGNh
cmQgZWVwcm9tICg5M2M0NiBvciA5M2M1NikgcHJvZ3JhbW1pbmcgcm91dGluZXMqLwotLyptZW1v
cnkgaXMgYWRkcmVzc2VkIGJ5IFdPUkRTKi8KKy8qIFRoaXMgZmlsZXMgY29udGFpbnMgY2FyZCBl
ZXByb20gKDkzYzQ2IG9yIDkzYzU2KSBwcm9ncmFtbWluZyByb3V0aW5lcyAqLworLyogbWVtb3J5
IGlzIGFkZHJlc3NlZCBieSBXT1JEUyAqLwoKICNpbmNsdWRlICJyODE5MlUuaCIKICNpbmNsdWRl
ICJyODE5MlVfaHcuaCIKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5
MF9ydGw4MjU2LmMgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOTBfcnRsODI1Ni5jCmlu
ZGV4IDkyZGU5MmEzMzI1YS4uNzE2YmUyNGJhY2U2IDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdp
bmcvcnRsODE5MnUvcjgxOTBfcnRsODI1Ni5jCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTky
dS9yODE5MF9ydGw4MjU2LmMKQEAgLTE5LDE0ICsxOSwxNSBAQAogICovCiBzdGF0aWMgdm9pZCBw
aHlfcmY4MjU2X2NvbmZpZ19wYXJhX2ZpbGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldik7CgotLyot
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQorLyoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBPdmVydmlldzoJ
c2V0IFJGIGJhbmQgd2lkdGggKDIwTSBvciA0ME0pCiAgKiBJbnB1dDogICAgICAgc3RydWN0IG5l
dF9kZXZpY2UqCWRldgogICoJCVdJUkVMRVNTX0JBTkRXSURUSF9FCUJhbmR3aWR0aAkvLzIwTSBv
ciA0ME0KICAqIE91dHB1dDogICAgICBOT05FCiAgKiBSZXR1cm46ICAgICAgTk9ORQogICogTm90
ZToJODIyNiBzdXBwb3J0IGJvdGggMjBNICBhbmQgNDAgTUh6Ci0gKi0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICovCiB2b2lkIHBoeV9zZXRfcmY4MjU2X2JhbmR3aWR0
aChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBlbnVtIGh0X2NoYW5uZWxfd2lkdGggQmFuZHdpZHRo
KQogewpAQCAtODMsMTcgKzg0LDE5IEBAIHZvaWQgcGh5X3NldF9yZjgyNTZfYmFuZHdpZHRoKHN0
cnVjdCBuZXRfZGV2aWNlICpkZXYsIGVudW0gaHRfY2hhbm5lbF93aWR0aCBCYW5kCiAJCX0KIAl9
CiB9Ci0vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisvKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIE92
ZXJ2aWV3OiAgICBJbnRlcmZhY2UgdG8gY29uZmlnIDgyNTYKICAqIElucHV0OiAgICAgICBzdHJ1
Y3QgbmV0X2RldmljZSoJZGV2CiAgKiBPdXRwdXQ6ICAgICAgTk9ORQogICogUmV0dXJuOiAgICAg
IE5PTkUKLSAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKi8KIHZv
aWQgcGh5X3JmODI1Nl9jb25maWcoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3Qg
cjgxOTJfcHJpdiAqcHJpdiA9IGllZWU4MDIxMV9wcml2KGRldik7Ci0JLyogSW5pdGlhbGl6ZSBn
ZW5lcmFsIGdsb2JhbCB2YWx1ZQorCS8qCisJICogSW5pdGlhbGl6ZSBnZW5lcmFsIGdsb2JhbCB2
YWx1ZQogCSAqCiAJICogVE9ETzogRXh0ZW5kIFJGX1BBVEhfQyBhbmQgUkZfUEFUSF9EIGluIHRo
ZSBmdXR1cmUKIAkgKi8KQEAgLTEwMSwxMiArMTA0LDEzIEBAIHZvaWQgcGh5X3JmODI1Nl9jb25m
aWcoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAkvKiBDb25maWcgQkIgYW5kIFJGICovCiAJcGh5
X3JmODI1Nl9jb25maWdfcGFyYV9maWxlKGRldik7CiB9Ci0vKi0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisv
KgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIE92ZXJ2aWV3OiAgICBJbnRlcmZhY2UgdG8gY29u
ZmlnIDgyNTYKICAqIElucHV0OiAgICAgICBzdHJ1Y3QgbmV0X2RldmljZSoJZGV2CiAgKiBPdXRw
dXQ6ICAgICAgTk9ORQogICogUmV0dXJuOiAgICAgIE5PTkUKLSAqLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
KyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKi8KIHN0YXRpYyB2b2lkIHBoeV9yZjgyNTZfY29uZmln
X3BhcmFfZmlsZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogewpAQCAtMTI2LDcgKzEzMCw4IEBA
IHN0YXRpYyB2b2lkIHBoeV9yZjgyNTZfY29uZmlnX3BhcmFfZmlsZShzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2KQoKIAkJcFBoeVJlZyA9ICZwcml2LT5QSFlSZWdEZWZbZVJGUGF0aF07CgotCQkvKiBK
b3NlcGggdGVzdCBmb3Igc2hvcnRlbiBSRiBjb25maWcKKwkJLyoKKwkJICogSm9zZXBoIHRlc3Qg
Zm9yIHNob3J0ZW4gUkYgY29uZmlnCiAJCSAqIHBIYWxEYXRhLT5SZlJlZzBWYWx1ZVtlUkZQYXRo
XSA9ICBydGw4MTkyX3BoeV9RdWVyeVJGUmVnKGRldiwgKGVudW0gcmY5MF9yYWRpb19wYXRoX2Up
ZVJGUGF0aCwgckdsb2JhbEN0cmwsIGJNYXNrRFdvcmQpOwogCQkgKiAtLS0tU3RvcmUgb3JpZ2lu
YWwgUkZFTlYgY29udHJvbCB0eXBlCiAJCSAqLwpAQCAtMTUzLDcgKzE1OCw4IEBAIHN0YXRpYyB2
b2lkIHBoeV9yZjgyNTZfY29uZmlnX3BhcmFfZmlsZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQoK
IAkJcnRsODE5Ml9waHlfU2V0UkZSZWcoZGV2LCAoZW51bSByZjkwX3JhZGlvX3BhdGhfZSkgZVJG
UGF0aCwgMHgwLCBiTWFzazEyQml0cywgMHhiZik7CgotCQkvKiBDaGVjayBSRiBibG9jayAoZm9y
IEZQR0EgcGxhdGZvcm0gb25seSktLS0tCisJCS8qCisJCSAqIENoZWNrIFJGIGJsb2NrIChmb3Ig
RlBHQSBwbGF0Zm9ybSBvbmx5KS0tLS0KIAkJICogVE9ETzogdGhpcyBmdW5jdGlvbiBzaG91bGQg
YmUgcmVtb3ZlZCBvbiBBU0lDICwgRW1pbHkgMjAwNy4yLjIKIAkJICovCiAJCWlmIChydGw4MTky
X3BoeV9jaGVja0JCQW5kUkYoZGV2LCBIVzkwX0JMT0NLX1JGLCAoZW51bSByZjkwX3JhZGlvX3Bh
dGhfZSllUkZQYXRoKSkgewpAQCAtMTYzLDcgKzE2OSw3IEBAIHN0YXRpYyB2b2lkIHBoeV9yZjgy
NTZfY29uZmlnX3BhcmFfZmlsZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQoKIAkJUmV0cnlUaW1l
cyA9IENvbnN0UmV0cnlUaW1lczsKIAkJUkYzX0ZpbmFsX1ZhbHVlID0gMDsKLQkJLyotLS0tSW5p
dGlhbGl6ZSBSRiBmb20gY29ubmZpZ3VyYXRpb24gZmlsZS0tLS0qLworCQkvKiAtLS0tSW5pdGlh
bGl6ZSBSRiBmb20gY29ubmZpZ3VyYXRpb24gZmlsZS0tLS0gKi8KIAkJc3dpdGNoIChlUkZQYXRo
KSB7CiAJCWNhc2UgUkY5MF9QQVRIX0E6CiAJCQl3aGlsZSAoUkYzX0ZpbmFsX1ZhbHVlICE9IFJl
Z1ZhbHVlVG9CZUNoZWNrICYmIFJldHJ5VGltZXMgIT0gMCkgewpAQCAtMTk5LDcgKzIwNSw3IEBA
IHN0YXRpYyB2b2lkIHBoeV9yZjgyNTZfY29uZmlnX3BhcmFfZmlsZShzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2KQogCQkJYnJlYWs7CiAJCX0KCi0JCS8qLS0tLVJlc3RvcmUgUkZFTlYgY29udHJvbCB0
eXBlLS0tLSovCisJCS8qIC0tLS1SZXN0b3JlIFJGRU5WIGNvbnRyb2wgdHlwZS0tLS0gKi8KIAkJ
c3dpdGNoIChlUkZQYXRoKSB7CiAJCWNhc2UgUkY5MF9QQVRIX0E6CiAJCWNhc2UgUkY5MF9QQVRI
X0M6CkBAIC0yODMsOCArMjg5LDkgQEAgdm9pZCBwaHlfc2V0X3JmODI1Nl9vZmRtX3R4X3Bvd2Vy
KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHU4IHBvd2VybGV2ZWwpCiAJCX0KCiAJCWlmIChwcml2
LT5iRHluYW1pY1R4SGlnaFBvd2VyKSB7Ci0JCQkvKkFkZCBieSBKYWNrZW4gMjAwOC8wMy8wNgot
CQkJICpFbWlseSwgMjAwODA2MTMuIFNldCBsb3cgdHggcG93ZXIgZm9yIGJvdGggTUNTIGFuZCBs
ZWdhY3kgT0ZETQorCQkJLyoKKwkJCSAqIEFkZCBieSBKYWNrZW4gMjAwOC8wMy8wNgorCQkJICog
RW1pbHksIDIwMDgwNjEzLiBTZXQgbG93IHR4IHBvd2VyIGZvciBib3RoIE1DUyBhbmQgbGVnYWN5
IE9GRE0KIAkJCSAqLwogCQkJd3JpdGVWYWwgPSAweDAzMDMwMzAzOwogCQl9IGVsc2UgewpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTkyVS5oIGIvZHJpdmVycy9zdGFn
aW5nL3J0bDgxOTJ1L3I4MTkyVS5oCmluZGV4IGVjMzNmYjkxMjJlOS4uNjEwYzIzMzY0ZTU4IDEw
MDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOTJVLmgKKysrIGIvZHJpdmVy
cy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTkyVS5oCkBAIC01NzAsNyArNTcwLDggQEAgdHlwZWRlZiBz
dHJ1Y3QgU3RhdHMgewogCWxvbmcgc2lnbmFsX3N0cmVuZ3RoOwogCWxvbmcgc2lnbmFsX3F1YWxp
dHk7CiAJbG9uZyBsYXN0X3NpZ25hbF9zdHJlbmd0aF9pbnBlcmNlbnQ7Ci0JLyogQ29ycmVjdCBz
bW9vdGhlZCBzcyBpbiBkYm0sIG9ubHkgdXNlZCBpbiBkcml2ZXIKKwkvKgorCSAqIENvcnJlY3Qg
c21vb3RoZWQgc3MgaW4gZGJtLCBvbmx5IHVzZWQgaW4gZHJpdmVyCiAJICogdG8gcmVwb3J0IHJl
YWwgcG93ZXIgbm93CiAJICovCiAJbG9uZyByZWN2X3NpZ25hbF9wb3dlcjsKQEAgLTYxNSwzOCAr
NjE2LDQ2IEBAIHR5cGVkZWYgc3RydWN0IF9CQl9SRUdJU1RFUl9ERUZJTklUSU9OIHsKIAl1MzIg
cmZMU1NJX1NlbGVjdDsKIAkvKiBUeCBnYWluIHN0YWdlOiAgICAgICAgICAgICAgIDB4ODBjfjB4
ODBmIFs0IGJ5dGVzXSAgKi8KIAl1MzIgcmZUeEdhaW5TdGFnZTsKLQkvKiB3aXJlIHBhcmFtZXRl
ciBjb250cm9sMTogICAgIDB4ODIwfjB4ODIzLCAweDgyOH4weDgyYiwKKwkvKgorCSAqIHdpcmUg
cGFyYW1ldGVyIGNvbnRyb2wxOiAgICAgMHg4MjB+MHg4MjMsIDB4ODI4fjB4ODJiLAogCSAqICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgMHg4MzB+MHg4MzMsIDB4ODM4fjB4ODNiIFsxNiBi
eXRlc10KIAkgKi8KIAl1MzIgcmZIU1NJUGFyYTE7Ci0JLyogd2lyZSBwYXJhbWV0ZXIgY29udHJv
bDI6ICAgICAweDgyNH4weDgyNywgMHg4MmN+MHg4MmYsCisJLyoKKwkgKiB3aXJlIHBhcmFtZXRl
ciBjb250cm9sMjogICAgIDB4ODI0fjB4ODI3LCAweDgyY34weDgyZiwKIAkgKiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIDB4ODM0fjB4ODM3LCAweDgzY34weDgzZiBbMTYgYnl0ZXNdCiAJ
ICovCiAJdTMyIHJmSFNTSVBhcmEyOwogCS8qIFR4IFJ4IGFudGVubmEgY29udHJvbDogICAgICAg
MHg4NTh+MHg4NWYgWzE2IGJ5dGVzXSAqLwogCXUzMiByZlN3aXRjaENvbnRyb2w7Ci0JLyogQUdD
IHBhcmFtZXRlciBjb250cm9sMToJMHhjNTB+MHhjNTMsIDB4YzU4fjB4YzViLAorCS8qCisJICog
QUdDIHBhcmFtZXRlciBjb250cm9sMToJMHhjNTB+MHhjNTMsIDB4YzU4fjB4YzViLAogCSAqICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgMHhjNjB+MHhjNjMsIDB4YzY4fjB4YzZiIFsxNiBi
eXRlc10KIAkgKi8KIAl1MzIgcmZBR0NDb250cm9sMTsKLQkvKiBBR0MgcGFyYW1ldGVyIGNvbnRy
b2wyOiAgICAgIDB4YzU0fjB4YzU3LCAweGM1Y34weGM1ZiwKKwkvKgorCSAqIEFHQyBwYXJhbWV0
ZXIgY29udHJvbDI6ICAgICAgMHhjNTR+MHhjNTcsIDB4YzVjfjB4YzVmLAogCSAqICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgMHhjNjR+MHhjNjcsIDB4YzZjfjB4YzZmIFsxNiBieXRlc10K
IAkgKi8KIAl1MzIgcmZBR0NDb250cm9sMjsKLQkvKiBPRkRNIFJ4IElRIGltYmFsYW5jZSBtYXRy
aXg6CTB4YzE0fjB4YzE3LCAweGMxY34weGMxZiwKKwkvKgorCSAqIE9GRE0gUnggSVEgaW1iYWxh
bmNlIG1hdHJpeDoJMHhjMTR+MHhjMTcsIDB4YzFjfjB4YzFmLAogCSAqICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgMHhjMjR+MHhjMjcsIDB4YzJjfjB4YzJmIFsxNiBieXRlc10KIAkgKi8K
IAl1MzIgcmZSeElRSW1iYWxhbmNlOwotCS8qIFJ4IElRIERDIG9mZnNldCBhbmQgUnggZGlnaXRh
bCBmaWx0ZXIsIFJ4IERDIG5vdGNoIGZpbHRlcjoKKwkvKgorCSAqIFJ4IElRIERDIG9mZnNldCBh
bmQgUnggZGlnaXRhbCBmaWx0ZXIsIFJ4IERDIG5vdGNoIGZpbHRlcjoKIAkgKiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIDB4YzEwfjB4YzEzLCAweGMxOH4weGMxYiwKIAkgKiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDB4YzIwfjB4YzIzLCAweGMyOH4weGMyYiBbMTYgYnl0ZXNd
CiAJICovCiAJdTMyIHJmUnhBRkU7Ci0JLyogT0ZETSBUeCBJUSBpbWJhbGFuY2UgbWF0cml4Ogkw
eGM4MH4weGM4MywgMHhjODh+MHhjOGIsCisJLyoKKwkgKiBPRkRNIFR4IElRIGltYmFsYW5jZSBt
YXRyaXg6CTB4YzgwfjB4YzgzLCAweGM4OH4weGM4YiwKIAkgKiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIDB4YzkwfjB4YzkzLCAweGM5OH4weGM5YiBbMTYgYnl0ZXNdCiAJICovCiAJdTMy
IHJmVHhJUUltYmFsYW5jZTsKLQkvKiBUeCBJUSBEQyBPZmZzZXQgYW5kIFR4IERGSVIgdHlwZToK
KwkvKgorCSAqIFR4IElRIERDIE9mZnNldCBhbmQgVHggREZJUiB0eXBlOgogCSAqICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgMHhjODR+MHhjODcsIDB4YzhjfjB4YzhmLAogCSAqICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgMHhjOTR+MHhjOTcsIDB4YzljfjB4YzlmIFsxNiBieXRl
c10KIAkgKi8KQEAgLTczMyw3ICs3NDIsOCBAQCB0eXBlZGVmIHN0cnVjdCBfcGh5X29mZG1fcnhf
c3RhdHVzX3JlcG9ydF84MTl4dXNiIHsKIH0gcGh5X3N0c19vZmRtXzgxOXh1c2JfdDsKCiB0eXBl
ZGVmIHN0cnVjdCBfcGh5X2Nja19yeF9zdGF0dXNfcmVwb3J0XzgxOXh1c2IgewotCS8qIEZvciBD
Q0sgcmF0ZSBkZXNjcmlwdG9yLiBUaGlzIGlzIGFuIHVuc2lnbmVkIDg6MSB2YXJpYWJsZS4KKwkv
KgorCSAqIEZvciBDQ0sgcmF0ZSBkZXNjcmlwdG9yLiBUaGlzIGlzIGFuIHVuc2lnbmVkIDg6MSB2
YXJpYWJsZS4KIAkgKiBMU0IgYml0IHByZXNlbmQgMC41LiBBbmQgTVNCIDcgYnRzIHByZXNlbmQg
YSBzaWduZWQgdmFsdWUuCiAJICogUmFuZ2UgZnJvbSAtNjR+KzYzLjUuCiAJICovCkBAIC04MDAs
MTIgKzgxMCwxMiBAQCB0eXBlZGVmIGVudW0gX3RhZ19UeENtZF9Db25maWdfSW5kZXggewogfSBE
Q01EX1RYQ01EX09QOwoKIGVudW0gdmVyc2lvbl84MTl4dSB7Ci0JVkVSU0lPTl84MTlYVV9BLCAv
LyBBLWN1dAotCVZFUlNJT05fODE5WFVfQiwgLy8gQi1jdXQKLQlWRVJTSU9OXzgxOVhVX0MsLy8g
Qy1jdXQKKwlWRVJTSU9OXzgxOVhVX0EsIC8qIEEtY3V0ICovCisJVkVSU0lPTl84MTlYVV9CLCAv
KiBCLWN1dCAqLworCVZFUlNJT05fODE5WFVfQywvKiBDLWN1dCAqLwogfTsKCi0vL2FkZGVkIGZv
ciBkaWZmZXJlbnQgUkYgdHlwZQorLyogYWRkZWQgZm9yIGRpZmZlcmVudCBSRiB0eXBlICovCiBl
bnVtIHJ0X3JmX3R5cGUgewogCVJGXzFUMlIgPSAwLAogCVJGXzJUNFIsCkBAIC05NTgsNyArOTY4
LDggQEAgdHlwZWRlZiBzdHJ1Y3QgcjgxOTJfcHJpdiB7CiAJLyogODE5MCA0ME1IeiBtb2RlICov
CiAJLyogQ29udHJvbCBjaGFubmVsIHN1Yi1jYXJyaWVyICovCiAJdTgJbkN1cjQwTWh6UHJpbWVT
QzsKLQkvKiBUZXN0IGZvciBzaG9ydGVuIFJGIGNvbmZpZ3VyYXRpb24gdGltZS4KKwkvKgorCSAq
IFRlc3QgZm9yIHNob3J0ZW4gUkYgY29uZmlndXJhdGlvbiB0aW1lLgogCSAqIFdlIHNhdmUgUkYg
cmVnMCBpbiB0aGlzIHZhcmlhYmxlIHRvIHJlZHVjZSBSRiByZWFkaW5nLgogCSAqLwogCXUzMgkJ
CQkJUmZSZWcwVmFsdWVbNF07CkBAIC05NzcsMTIgKzk4OCwxNCBAQCB0eXBlZGVmIHN0cnVjdCBy
ODE5Ml9wcml2IHsKIAlib29sCWJMYXN0RFRQRmxhZ19Mb3c7CgogCWJvb2wJYnN0b3JlX2xhc3Rf
ZHRwZmxhZzsKLQkvKiBEZWZpbmUgdG8gZGlzY3JpbWluYXRlIG9uIEhpZ2ggcG93ZXIgU3RhdGUg
b3IKKwkvKgorCSAqIERlZmluZSB0byBkaXNjcmltaW5hdGUgb24gSGlnaCBwb3dlciBTdGF0ZSBv
cgogCSAqIG9uIHNpdGVzdXJ2ZXkgdG8gY2hhbmdlIFR4IGdhaW4gaW5kZXgKIAkgKi8KIAlib29s
CWJzdGFydF90eGN0cmxfYnlkdHA7CiAJcmF0ZV9hZGFwdGl2ZSByYXRlX2FkYXB0aXZlOwotCS8q
IFRYIHBvd2VyIHRyYWNraW5nCisJLyoKKwkgKiBUWCBwb3dlciB0cmFja2luZwogCSAqIE9QRU4v
Q0xPU0UgVFggUE9XRVIgVFJBQ0tJTkcKIAkgKi8KIAl0eGJiZ2Fpbl9zdHJ1Y3QgdHhiYmdhaW5f
dGFibGVbVHhCQkdhaW5UYWJsZUxlbmd0aF07CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcv
cnRsODE5MnUvcjgxOTJVX2NvcmUuYyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5MlVf
Y29yZS5jCmluZGV4IDQwNjVhNDcxMDE0Mi4uNDEwYzhhM2U1NmQ3IDEwMDY0NAotLS0gYS9kcml2
ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOTJVX2NvcmUuYworKysgYi9kcml2ZXJzL3N0YWdpbmcv
cnRsODE5MnUvcjgxOTJVX2NvcmUuYwpAQCAtMTk0LDcgKzE5NCw4IEBAIHN0YXRpYyB2b2lkIHJ0
bDgxOXhfc2V0X2NoYW5uZWxfbWFwKHU4IGNoYW5uZWxfcGxhbiwgc3RydWN0IHI4MTkyX3ByaXYg
KnByaXYpCiAJCWJyZWFrOwoKIAljYXNlIENPVU5UUllfQ09ERV9HTE9CQUxfRE9NQUlOOgotCQkv
KiB0aGlzIGZsYWcgZW5hYmxlZCB0byBmb2xsb3cgMTFkIGNvdW50cnkgSUUgc2V0dGluZywKKwkJ
LyoKKwkJICogdGhpcyBmbGFnIGVuYWJsZWQgdG8gZm9sbG93IDExZCBjb3VudHJ5IElFIHNldHRp
bmcsCiAJCSAqIG90aGVyd2lzZSwgaXQgc2hhbGwgZm9sbG93IGdsb2JhbCBkb21haW4gc2V0dGlu
Z3MuCiAJCSAqLwogCQlHRVRfRE9UMTFEX0lORk8oaWVlZSktPmRvdDExZF9lbmFibGVkID0gMDsK
QEAgLTIxMyw3ICsyMTQsOCBAQCBzdGF0aWMgdm9pZCBydGw4MTl4X3NldF9jaGFubmVsX21hcCh1
OCBjaGFubmVsX3BsYW4sIHN0cnVjdCByODE5Ml9wcml2ICpwcml2KQogc3RhdGljIHZvaWQgQ2Ft
UmVzZXRBbGxFbnRyeShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogewogCXUzMiB1bGNvbW1hbmQg
PSAwOwotCS8qIEluIHN0YXRpYyBXRVAsIE9JRF9BRERfS0VZIG9yIE9JRF9BRERfV0VQIGFyZSBz
ZXQgYmVmb3JlIFNUQQorCS8qCisJICogSW4gc3RhdGljIFdFUCwgT0lEX0FERF9LRVkgb3IgT0lE
X0FERF9XRVAgYXJlIHNldCBiZWZvcmUgU1RBCiAJICogYXNzb2NpYXRlIHRvIEFQLiBIb3dldmVy
LCBSZXNldEtleSBpcyBjYWxsZWQgb24KIAkgKiBPSURfODAyXzExX0lORlJBU1RSVUNUVVJFX01P
REUgYW5kIE1sbWVBc3NvY2lhdGVSZXF1ZXN0LiBJbiB0aGlzCiAJICogY29uZGl0aW9uLCBDYW0g
Y2FuIG5vdCBiZSByZXNldCBiZWNhdXNlIHVwcGVyIGxheWVyIHdpbGwgbm90IHNldApAQCAtNDU4
LDcgKzQ2MCw4IEBAIGludCByZWFkX25pY19kd29yZChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBp
bnQgaW5keCwgdTMyICpkYXRhKQoKIC8qIHU4IHJlYWRfcGh5X2NjayhzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2LCB1OCBhZHIpOyAqLwogLyogdTggcmVhZF9waHlfb2ZkbShzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2LCB1OCBhZHIpOyAqLwotLyogdGhpcyBtaWdodCBzdGlsbCBjYWxsZWQgaW4gd2hhdCB3
YXMgdGhlIFBIWSBydGw4MTg1L3J0bDgxOTIgY29tbW9uIGNvZGUKKy8qCisgKiB0aGlzIG1pZ2h0
IHN0aWxsIGNhbGxlZCBpbiB3aGF0IHdhcyB0aGUgUEhZIHJ0bDgxODUvcnRsODE5MiBjb21tb24g
Y29kZQogICogcGxhbnMgYXJlIHRvIHBvc3NpYmlsaXR5IHR1cm4gaXQgYWdhaW4gaW4gb25lIGNv
bW1vbiBjb2RlLi4uCiAgKi8KIGlubGluZSB2b2lkIGZvcmNlX3BjaV9wb3N0aW5nKHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYpCkBAIC02NjksNyArNjcyLDggQEAgdm9pZCBydGw4MTkyX3VwZGF0ZV9t
c3Ioc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAlyZWFkX25pY19ieXRlKGRldiwgTVNSLCAmbXNy
KTsKIAltc3IgJj0gfk1TUl9MSU5LX01BU0s7CgotCS8qIGRvIG5vdCBjaGFuZ2UgaW4gbGlua19z
dGF0ZSAhPSBXTEFOX0xJTktfQVNTT0NJQVRFRC4KKwkvKgorCSAqIGRvIG5vdCBjaGFuZ2UgaW4g
bGlua19zdGF0ZSAhPSBXTEFOX0xJTktfQVNTT0NJQVRFRC4KIAkgKiBtc3IgbXVzdCBiZSB1cGRh
dGVkIGlmIHRoZSBzdGF0ZSBpcyBBU1NPQ0lBVElORy4KIAkgKiB0aGlzIGlzIGludGVudGlvbmFs
IGFuZCBtYWtlIHNlbnNlIGZvciBhZC1ob2MgYW5kCiAJICogbWFzdGVyIChzZWUgdGhlIGNyZWF0
ZSBCU1MvSUJTUyBmdW5jKQpAQCAtOTIxLDcgKzkyNSw4IEBAIHN0YXRpYyB2b2lkIHJ0bDgxOTJf
ZGF0YV9oYXJkX3Jlc3VtZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCS8qIEZJWE1FICEhICov
CiB9CgotLyogdGhpcyBmdW5jdGlvbiBUWCBkYXRhIGZyYW1lcyB3aGVuIHRoZSBpZWVlODAyMTEg
c3RhY2sgcmVxdWlyZXMgdGhpcy4KKy8qCisgKiB0aGlzIGZ1bmN0aW9uIFRYIGRhdGEgZnJhbWVz
IHdoZW4gdGhlIGllZWU4MDIxMSBzdGFjayByZXF1aXJlcyB0aGlzLgogICogSXQgY2hlY2tzIGFs
c28gaWYgd2UgbmVlZCB0byBzdG9wIHRoZSBpZWVlIHR4IHF1ZXVlLCBldmVudHVhbGx5IGRvIGl0
CiAgKi8KIHN0YXRpYyB2b2lkIHJ0bDgxOTJfaGFyZF9kYXRhX3htaXQoc3RydWN0IHNrX2J1ZmYg
KnNrYiwgc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKQEAgLTk0Niw3ICs5NTEsOCBAQCBzdGF0aWMg
dm9pZCBydGw4MTkyX2hhcmRfZGF0YV94bWl0KHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYsCiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmcHJpdi0+dHhfbG9jaywg
ZmxhZ3MpOwogfQoKLS8qIFRoaXMgaXMgYSByb3VnaCBhdHRlbXB0IHRvIFRYIGEgZnJhbWUKKy8q
CisgKiBUaGlzIGlzIGEgcm91Z2ggYXR0ZW1wdCB0byBUWCBhIGZyYW1lCiAgKiBUaGlzIGlzIGNh
bGxlZCBieSB0aGUgaWVlZSA4MDIxMSBzdGFjayB0byBUWCBtYW5hZ2VtZW50IGZyYW1lcy4KICAq
IElmIHRoZSByaW5nIGlzIGZ1bGwgcGFja2V0IGFyZSBkcm9wcGVkIChmb3IgZGF0YSBmcmFtZSB0
aGUgcXVldWUKICAqIGlzIHN0b3BwZWQgYmVmb3JlIHRoaXMgY2FuIGhhcHBlbikuCkBAIC0xMTkx
LDcgKzExOTcsOCBAQCBzdGF0aWMgdm9pZCBydGw4MTkyX25ldF91cGRhdGUoc3RydWN0IG5ldF9k
ZXZpY2UgKmRldikKIAl9CiB9CgotLyogdGVtcG9yYXJ5IGh3IGJlYWNvbiBpcyBub3QgdXNlZCBh
bnkgbW9yZS4KKy8qCisgKiB0ZW1wb3JhcnkgaHcgYmVhY29uIGlzIG5vdCB1c2VkIGFueSBtb3Jl
LgogICogb3BlbiBpdCB3aGVuIG5lY2Vzc2FyeQogICovCiB2b2lkIHJ0bDgxOXh1c2JfYmVhY29u
X3R4KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHUxNiAgdHhfcmF0ZSkKQEAgLTEyMjUsOSArMTIz
MiwxMCBAQCBzaG9ydCBydGw4MTl4VV90eF9jbWQoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgc3Ry
dWN0IHNrX2J1ZmYgKnNrYikKIAlwZGVzYy0+T1dOID0gMTsKIAlwZGVzYy0+TElOSVAgPSB0Y2Jf
ZGVzYy0+Ykxhc3RJbmlQa3Q7CgotCS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisJLyoKKwkgKiAtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0KIAkgKiBGaWxsIHVwIFVTQl9PVVRfQ09OVEVYVC4KLQkgKi0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCSAqIC0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQogCSAqLwogCWlkeF9waXBlID0gMHgwNDsKIAl1c2JfZmlsbF9idWxrX3VyYih0
eF91cmIsIHByaXYtPnVkZXYsCkBAIC0xNDM1LDcgKzE0NDMsOCBAQCBzaG9ydCBydGw4MTkyX3R4
KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHN0cnVjdCBza19idWZmICpza2IpCiAJdW5zaWduZWQg
aW50IGlkeF9waXBlOwoKIAlwZW5kID0gYXRvbWljX3JlYWQoJnByaXYtPnR4X3BlbmRpbmdbdGNi
X2Rlc2MtPnF1ZXVlX2luZGV4XSk7Ci0JLyogd2UgYXJlIGxvY2tlZCBoZXJlIHNvIHRoZSB0d28g
YXRvbWljX3JlYWQgYW5kIGluYyBhcmUgZXhlY3V0ZWQKKwkvKgorCSAqIHdlIGFyZSBsb2NrZWQg
aGVyZSBzbyB0aGUgdHdvIGF0b21pY19yZWFkIGFuZCBpbmMgYXJlIGV4ZWN1dGVkCiAJICogd2l0
aG91dCBpbnRlcmxlYXZlcwogCSAqICEhISBGb3IgZGVidWcgcHVycG9zZQogCSAqLwpAQCAtMTUw
NSw3ICsxNTE0LDcgQEAgc2hvcnQgcnRsODE5Ml90eChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBz
dHJ1Y3Qgc2tfYnVmZiAqc2tiKQogCXR4X2Rlc2MtPk9mZnNldCA9ICBzaXplb2Yoc3RydWN0IHR4
X2Z3aW5mb184MTl4X3VzYikgKyA4OwogCXR4X2Rlc2MtPlBrdFNpemUgPSAoc2tiLT5sZW4gLSBU
WF9QQUNLRVRfU0hJRlRfQllURVMpICYgMHhmZmZmOwoKLQkvKkRXT1JEIDEqLworCS8qIERXT1JE
IDEgKi8KIAl0eF9kZXNjLT5TZWNDQU1JRCA9IDA7CiAJdHhfZGVzYy0+UkFUaWQgPSB0Y2JfZGVz
Yy0+UkFUUkluZGV4OwogCXR4X2Rlc2MtPk5vRW5jID0gMTsKQEAgLTE1MzgsNyArMTU0Nyw4IEBA
IHNob3J0IHJ0bDgxOTJfdHgoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgc3RydWN0IHNrX2J1ZmYg
KnNrYikKIAl0eF9kZXNjLT5ESVNGQiA9IHRjYl9kZXNjLT5iVHhEaXNhYmxlUmF0ZUZhbGxCYWNr
OwogCXR4X2Rlc2MtPlVTRVJBVEUgPSB0Y2JfZGVzYy0+YlR4VXNlRHJpdmVyQXNzaW5nZWRSYXRl
OwoKLQkvKiBGaWxsIGZpZWxkcyB0aGF0IGFyZSByZXF1aXJlZCB0byBiZSBpbml0aWFsaXplZCBp
bgorCS8qCisJICogRmlsbCBmaWVsZHMgdGhhdCBhcmUgcmVxdWlyZWQgdG8gYmUgaW5pdGlhbGl6
ZWQgaW4KIAkgKiBhbGwgb2YgdGhlIGRlc2NyaXB0b3JzCiAJICovCiAJLyogRFdPUkQgMCAqLwpA
QCAtMTU1Nyw3ICsxNTY3LDggQEAgc2hvcnQgcnRsODE5Ml90eChzdHJ1Y3QgbmV0X2RldmljZSAq
ZGV2LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQoKIAlzdGF0dXMgPSB1c2Jfc3VibWl0X3VyYih0eF91
cmIsIEdGUF9BVE9NSUMpOwogCWlmICghc3RhdHVzKSB7Ci0JCS8qIFdlIG5lZWQgdG8gc2VuZCAw
IGJ5dGUgcGFja2V0IHdoZW5ldmVyCisJCS8qCisJCSAqIFdlIG5lZWQgdG8gc2VuZCAwIGJ5dGUg
cGFja2V0IHdoZW5ldmVyCiAJCSAqIDUxMk4gYnl0ZXMvNjROKEhJR04gU1BFRUQvTk9STUFMIFNQ
RUVEKSBieXRlcyBwYWNrZXQgaGFzCiAJCSAqIGJlZW4gdHJhbnNtaXR0ZWQuIE90aGVyd2lzZSwg
aXQgd2lsbCBiZSBoYWx0IHRvIHdhaXQgZm9yCiAJCSAqIGFub3RoZXIgcGFja2V0LgpAQCAtMTcy
MSw3ICsxNzMyLDggQEAgc3RhdGljIHZvaWQgcnRsODE5Ml9saW5rX2NoYW5nZShzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2KQogCWlmIChpZWVlLT5zdGF0ZSA9PSBJRUVFODAyMTFfTElOS0VEKSB7CiAJ
CXJ0bDgxOTJfbmV0X3VwZGF0ZShkZXYpOwogCQlydGw4MTkyX3VwZGF0ZV9yYXRyX3RhYmxlKGRl
dik7Ci0JCS8qIEFkZCB0aGlzIGFzIGluIHB1cmUgTiBtb2RlLCB3ZXAgZW5jcnlwdGlvbiB3aWxs
IHVzZSBzb2Z0d2FyZQorCQkvKgorCQkgKiBBZGQgdGhpcyBhcyBpbiBwdXJlIE4gbW9kZSwgd2Vw
IGVuY3J5cHRpb24gd2lsbCB1c2Ugc29mdHdhcmUKIAkJICogd2F5LCBidXQgdGhlcmUgaXMgbm8g
Y2hhbmNlIHRvIHNldCB0aGlzIGFzIHdlcCB3aWxsIG5vdCBzZXQKIAkJICogZ3JvdXAga2V5IGlu
IHdleHQuCiAJCSAqLwpAQCAtMTcyOSw3ICsxNzQxLDcgQEAgc3RhdGljIHZvaWQgcnRsODE5Ml9s
aW5rX2NoYW5nZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCQkgICAgaWVlZS0+cGFpcndpc2Vf
a2V5X3R5cGUgPT0gS0VZX1RZUEVfV0VQMTA0KQogCQkJRW5hYmxlSFdTZWN1cml0eUNvbmZpZzgx
OTIoZGV2KTsKIAl9Ci0JLyp1cGRhdGUgdGltaW5nIHBhcmFtcyovCisJLyogdXBkYXRlIHRpbWlu
ZyBwYXJhbXMgKi8KIAlpZiAoaWVlZS0+aXdfbW9kZSA9PSBJV19NT0RFX0lORlJBIHx8IGllZWUt
Pml3X21vZGUgPT0gSVdfTU9ERV9BREhPQykgewogCQl1MzIgcmVnID0gMDsKCkBAIC0xNzkxLDcg
KzE4MDMsOCBAQCBzdGF0aWMgdm9pZCBydGw4MTkyX3Fvc19hY3RpdmF0ZShzdHJ1Y3Qgd29ya19z
dHJ1Y3QgKndvcmspCiAJCWdvdG8gc3VjY2VzczsKIAlSVF9UUkFDRShDT01QX1FPUywKIAkJICJx
b3MgYWN0aXZlIHByb2Nlc3Mgd2l0aCBhc3NvY2lhdGUgcmVzcG9uc2UgcmVjZWl2ZWRcbiIpOwot
CS8qIEl0IGJldHRlciBzZXQgc2xvdCB0aW1lIGF0IGZpcnN0CisJLyoKKwkgKiBJdCBiZXR0ZXIg
c2V0IHNsb3QgdGltZSBhdCBmaXJzdAogCSAqCiAJICogRm9yIHdlIGp1c3Qgc3VwcG9ydCBiL2cg
bW9kZSBhdCBwcmVzZW50LCBsZXQgdGhlIHNsb3QgdGltZSBhdAogCSAqIDkvMjAgc2VsZWN0aW9u
CkBAIC0xOTk0LDcgKzIwMDcsOCBAQCBzdGF0aWMgYm9vbCBHZXRObW9kZVN1cHBvcnRCeVNlY0Nm
ZzgxOTIoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAlpbnQgZW5jcnlwdDsKCiAJY3J5cHQgPSBp
ZWVlLT5jcnlwdFtpZWVlLT50eF9rZXlpZHhdOwotCS8qIHdlIHVzZSBjb25uZWN0aW5nIEFQJ3Mg
Y2FwYWJpbGl0eSBpbnN0ZWFkIG9mIG9ubHkgc2VjdXJpdHkgY29uZmlnCisJLyoKKwkgKiB3ZSB1
c2UgY29ubmVjdGluZyBBUCdzIGNhcGFiaWxpdHkgaW5zdGVhZCBvZiBvbmx5IHNlY3VyaXR5IGNv
bmZpZwogCSAqIG9uIG91ciBkcml2ZXIgdG8gZGlzdGluZ3Vpc2ggd2hldGhlciBpdCBzaG91bGQg
dXNlIE4gbW9kZSBvciBHIG1vZGUKIAkgKi8KIAllbmNyeXB0ID0gKG5ldHdvcmstPmNhcGFiaWxp
dHkgJiBXTEFOX0NBUEFCSUxJVFlfUFJJVkFDWSkgfHwKQEAgLTIwMjgsNyArMjA0Miw4IEBAIHN0
YXRpYyBib29sIEdldEhhbGZObW9kZVN1cHBvcnRCeUFQczgxOXhVc2Ioc3RydWN0IG5ldF9kZXZp
Y2UgKmRldikKIHN0YXRpYyB2b2lkIHJ0bDgxOTJfcmVmcmVzaF9zdXBwb3J0cmF0ZShzdHJ1Y3Qg
cjgxOTJfcHJpdiAqcHJpdikKIHsKIAlzdHJ1Y3QgaWVlZTgwMjExX2RldmljZSAqaWVlZSA9IHBy
aXYtPmllZWU4MDIxMTsKLQkvKiBXZSBkbyBub3QgY29uc2lkZXIgc2V0IHN1cHBvcnQgcmF0ZSBm
b3IgQUJHIG1vZGUsIG9ubHkKKwkvKgorCSAqIFdlIGRvIG5vdCBjb25zaWRlciBzZXQgc3VwcG9y
dCByYXRlIGZvciBBQkcgbW9kZSwgb25seQogCSAqIEhUIE1DUyByYXRlIGlzIHNldCBoZXJlLgog
CSAqLwogCWlmIChpZWVlLT5tb2RlID09IFdJUkVMRVNTX01PREVfTl8yNEcgfHwKQEAgLTIwODUs
NyArMjEwMCw4IEBAIHN0YXRpYyB2b2lkIHJ0bDgxOTJfU2V0V2lyZWxlc3NNb2RlKHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYsIHU4IHdpcmVsZXNzX21vZGUpCiAJCX0KIAl9CiAjaWZkZWYgVE9fRE9f
TElTVAotCS8qIFRPRE86IHRoaXMgZnVuY3Rpb24gZG9lc24ndCB3b3JrIHdlbGwgYXQgdGhpcyB0
aW1lLAorCS8qCisJICogVE9ETzogdGhpcyBmdW5jdGlvbiBkb2Vzbid0IHdvcmsgd2VsbCBhdCB0
aGlzIHRpbWUsCiAJICogd2Ugc2hvdWxkIHdhaXQgZm9yIEZQR0EKIAkgKi8KIAlBY3RVcGRhdGVD
aGFubmVsQWNjZXNzU2V0dGluZygKQEAgLTIxOTQsMjEgKzIyMTAsMjUgQEAgc3RhdGljIHZvaWQg
cnRsODE5Ml9pbml0X3ByaXZfdmFyaWFibGUoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAkJCXBI
YWxEYXRhLT5DU01ldGhvZCB8CiAJCQkvKiBhY2NlcHQgbWFuYWdlbWVudC9kYXRhICovCiAJCQlS
Q1JfQU1GIHwgUkNSX0FERiB8Ci0JCQkvKiBhY2NlcHQgY29udHJvbCBmcmFtZSBmb3IgU1cKKwkJ
CS8qCisJCQkgKiBhY2NlcHQgY29udHJvbCBmcmFtZSBmb3IgU1cKIAkJCSAqIEFQIG5lZWRzIFBT
LXBvbGwKIAkJCSAqLwogCQkJUkNSX0FDRiB8CiAJCQkvKiBhY2NlcHQgQkMvTUMvVUMgKi8KIAkJ
CVJDUl9BQiB8IFJDUl9BTSB8IFJDUl9BUE0gfAotCQkJLyogYWNjZXB0IElDVi9DUkMgZXJyb3IK
KwkJCS8qCisJCQkgKiBhY2NlcHQgSUNWL0NSQyBlcnJvcgogCQkJICogcGFja2V0CiAJCQkgKi8K
IAkJCVJDUl9BSUNWIHwgUkNSX0FDUkMzMiB8Ci0JCQkvKiBNYXggRE1BIEJ1cnN0IFNpemUgcGVy
IFR4CisJCQkvKgorCQkJICogTWF4IERNQSBCdXJzdCBTaXplIHBlciBUeAogCQkJICogRE1BIEJ1
cnN0LCA3OiB1bmxpbWl0ZWQuCiAJCQkgKi8KIAkJCSgodTMyKTcgPDwgUkNSX01YRE1BX09GRlNF
VCkgfAotCQkJLyogUnggRklGTyBUaHJlc2hvbGQsCisJCQkvKgorCQkJICogUnggRklGTyBUaHJl
c2hvbGQsCiAJCQkgKiA3OiBObyBSeCB0aHJlc2hvbGQuCiAJCQkgKi8KIAkJCShwSGFsRGF0YS0+
RWFybHlSeFRocmVzaG9sZCA8PCBSQ1JfRklGT19PRkZTRVQpIHwKQEAgLTIzMDAsNyArMjMyMCw4
IEBAIHN0YXRpYyB2b2lkIHJ0bDgxOTJfZ2V0X2VlcHJvbV9zaXplKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYpCiAJCSAiPD09PT09PT09PT09JXMoKSwgZXByb210eXBlOiVkXG4iLCBfX2Z1bmNfXywg
cHJpdi0+ZXByb210eXBlKTsKIH0KCi0vKiB1c2VkIHRvIHN3YXAgZW5kaWFuLiBhcyBudG9obCAm
IGh0b25sIGFyZSBub3QgbmVjZXNzYXJ5CisvKgorICogdXNlZCB0byBzd2FwIGVuZGlhbi4gYXMg
bnRvaGwgJiBodG9ubCBhcmUgbm90IG5lY2Vzc2FyeQogICogdG8gc3dhcCBlbmRpYW4sIHNvIHVz
ZSB0aGlzIGluc3RlYWQuCiAgKi8KIHN0YXRpYyBpbmxpbmUgdTE2IGVuZGlhbl9zd2FwKHUxNiAq
ZGF0YSkKQEAgLTI1MjYsNyArMjU0Nyw4IEBAIHN0YXRpYyBpbnQgcnRsODE5Ml9yZWFkX2VlcHJv
bV9pbmZvKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiAJCQkocHJpdi0+RUVQUk9NVHhQb3dlckRp
ZmYgJiAweGYwKSA+PiA0OwogCQkvKiBDcnlzdGFsQ2FwLCBiaXQxMn4xNSAqLwogCQlwcml2LT5D
cnlzdGFsQ2FwID0gcHJpdi0+RUVQUk9NQ3J5c3RhbENhcDsKLQkJLyogVGhlcm1hbE1ldGVyLCBi
aXQwfjMgZm9yIFJGSUMxLCBiaXQ0fjcgZm9yIFJGSUMyCisJCS8qCisJCSAqIFRoZXJtYWxNZXRl
ciwgYml0MH4zIGZvciBSRklDMSwgYml0NH43IGZvciBSRklDMgogCQkgKiA5MlUgZG9lcyBub3Qg
ZW5hYmxlIFRYIHBvd2VyIHRyYWNraW5nLgogCQkgKi8KIAkJcHJpdi0+VGhlcm1hbE1ldGVyWzBd
ID0gcHJpdi0+RUVQUk9NVGhlcm1hbE1ldGVyOwpAQCAtMjU2Nyw3ICsyNTg5LDggQEAgc3RhdGlj
IGludCBydGw4MTkyX3JlYWRfZWVwcm9tX2luZm8oc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAll
bHNlCiAJCVJUX1RSQUNFKENPTVBfRVBST00sICJcbjJUNFIgY29uZmlnXG4iKTsKCi0JLyogV2Ug
Y2FuIG9ubHkga25vdyBSRiB0eXBlIGluIHRoZSBmdW5jdGlvbi4gU28gd2UgaGF2ZSB0byBpbml0
CisJLyoKKwkgKiBXZSBjYW4gb25seSBrbm93IFJGIHR5cGUgaW4gdGhlIGZ1bmN0aW9uLiBTbyB3
ZSBoYXZlIHRvIGluaXQKIAkgKiBESUcgUkFUUiB0YWJsZSBhZ2Fpbi4KIAkgKi8KIAlpbml0X3Jh
dGVfYWRhcHRpdmUoZGV2KTsKQEAgLTI2ODEsNyArMjcwNCw4IEBAIHN0YXRpYyB2b2lkIHJ0bDgx
OTJfaHdjb25maWcoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAkJfQogCQlicmVhazsKIAljYXNl
IFdJUkVMRVNTX01PREVfTl8yNEc6Ci0JCS8qIEl0IHN1cHBvcnQgQ0NLIHJhdGUgYnkgZGVmYXVs
dC4gQ0NLIHJhdGUgd2lsbCBiZSBmaWx0ZXJlZAorCQkvKgorCQkgKiBJdCBzdXBwb3J0IENDSyBy
YXRlIGJ5IGRlZmF1bHQuIENDSyByYXRlIHdpbGwgYmUgZmlsdGVyZWQKIAkJICogb3V0IG9ubHkg
d2hlbiBhc3NvY2lhdGVkIEFQIGRvZXMgbm90IHN1cHBvcnQgaXQuCiAJCSAqLwogCQlyZWdCd09w
TW9kZSA9IEJXX09QTU9ERV8yME1IWjsKQEAgLTI4NTUsNyArMjg3OSw4IEBAIHN0YXRpYyBib29s
IHJ0bDgxOTJfYWRhcHRlcl9zdGFydChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCQkJUlRfVFJB
Q0UoKENPTVBfSU5JVCB8IENPTVBfUkYpLCBEQkdfTE9VRCwKIAkJCQkgKCJJbml0aWFsaXplQWRh
cHRlcjgxOXhVc2IoKTogVHVybiBvZmYgUkYgZm9yIFJlZ1JmT2ZmIC0tLS0tLS0tLS1cbiIpKTsK
IAkJCU1nbnRBY3RTZXRfUkZfU3RhdGUoQWRhcHRlciwgZVJmT2ZmLCBSRl9DSEFOR0VfQllfU1cp
OwotCQkJLyogVGhvc2UgYWN0aW9ucyB3aWxsIGJlIGRpc2NhcmQgaW4gTWdudEFjdFNldF9SRl9T
dGF0ZQorCQkJLyoKKwkJCSAqIFRob3NlIGFjdGlvbnMgd2lsbCBiZSBkaXNjYXJkIGluIE1nbnRB
Y3RTZXRfUkZfU3RhdGUKIAkJCSAqIGJlY2F1c2Ugb2YgdGhlIHNhbWUgc3RhdGUKIAkJCSAqLwog
CQkJZm9yIChlUkZQYXRoID0gMDsgZVJGUGF0aCA8IHBIYWxEYXRhLT5OdW1Ub3RhbFJGUGF0aDsg
ZVJGUGF0aCsrKQpAQCAtMjg4MSw3ICsyOTA2LDggQEAgc3RhdGljIGJvb2wgcnRsODE5Ml9hZGFw
dGVyX3N0YXJ0KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiAJCQlNZ250QWN0U2V0X1JGX1N0YXRl
KEFkYXB0ZXIsCiAJCQkJCSAgICBlUmZPZmYsCiAJCQkJCSAgICBwTWdudEluZm8tPlJmT2ZmUmVh
c29uKTsKLQkJCS8qIFRob3NlIGFjdGlvbnMgd2lsbCBiZSBkaXNjYXJkIGluIE1nbnRBY3RTZXRf
UkZfU3RhdGUKKwkJCS8qCisJCQkgKiBUaG9zZSBhY3Rpb25zIHdpbGwgYmUgZGlzY2FyZCBpbiBN
Z250QWN0U2V0X1JGX1N0YXRlCiAJCQkgKiBiZWNhdXNlIG9mIHRoZSBzYW1lIHN0YXRlCiAJCQkg
Ki8KIAkJCWZvciAoZVJGUGF0aCA9IDA7IGVSRlBhdGggPCBwSGFsRGF0YS0+TnVtVG90YWxSRlBh
dGg7IGVSRlBhdGgrKykKQEAgLTI5MDYsNyArMjkzMiw3IEBAIHN0YXRpYyBib29sIHJ0bDgxOTJf
YWRhcHRlcl9zdGFydChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQoKCiAJcnRsODE5Ml9waHlfdXBk
YXRlSW5pdEdhaW4oZGV2KTsKLQkvKi0tc2V0IENDSyBhbmQgT0ZETSBCbG9jayAiT04iLS0qLwor
CS8qIC0tc2V0IENDSyBhbmQgT0ZETSBCbG9jayAiT04iLS0gKi8KIAlydGw4MTkyX3NldEJCcmVn
KGRldiwgckZQR0EwX1JGTU9ELCBiQ0NLRW4sIDB4MSk7CiAJcnRsODE5Ml9zZXRCQnJlZyhkZXYs
IHJGUEdBMF9SRk1PRCwgYk9GRE1FbiwgMHgxKTsKCkBAIC0yOTYzLDcgKzI5ODksOCBAQCBzdGF0
aWMgYm9vbCBydGw4MTkyX2FkYXB0ZXJfc3RhcnQoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAly
ZXR1cm4gaW5pdF9zdGF0dXM7CiB9CgotLyogdGhpcyBjb25maWd1cmVzIHJlZ2lzdGVycyBmb3Ig
YmVhY29uIHR4IGFuZCBlbmFibGVzIGl0IHZpYQorLyoKKyAqIHRoaXMgY29uZmlndXJlcyByZWdp
c3RlcnMgZm9yIGJlYWNvbiB0eCBhbmQgZW5hYmxlcyBpdCB2aWEKICAqIHJ0bDgxOTJfYmVhY29u
X3R4X2VuYWJsZSgpLiBydGw4MTkyX2JlYWNvbl90eF9kaXNhYmxlKCkgbWlnaHQKICAqIGJlIHVz
ZWQgdG8gc3RvcCBiZWFjb24gdHJhbnNtaXNzaW9uCiAgKi8KQEAgLTMwMzgsNyArMzA2NSw4IEBA
IHN0YXRpYyBib29sIEhhbFJ4Q2hlY2tTdHVjazgxOXhVc2Ioc3RydWN0IG5ldF9kZXZpY2UgKmRl
dikKIAlSVF9UUkFDRShDT01QX1JFU0VULAogCQkgIiVzKCk6IFJlZ1J4Q291bnRlciBpcyAlZCxS
eENvdW50ZXIgaXMgJWRcbiIsIF9fZnVuY19fLAogCQkgUmVnUnhDb3VudGVyLCBwcml2LT5SeENv
dW50ZXIpOwotCS8qIElmIHJzc2kgaXMgc21hbGwsIHdlIHNob3VsZCBjaGVjayByeCBmb3IgbG9u
ZyB0aW1lIGJlY2F1c2Ugb2YgYmFkIHJ4LgorCS8qCisJICogSWYgcnNzaSBpcyBzbWFsbCwgd2Ug
c2hvdWxkIGNoZWNrIHJ4IGZvciBsb25nIHRpbWUgYmVjYXVzZSBvZiBiYWQgcnguCiAJICogb3Ig
bWF5YmUgaXQgd2lsbCBjb250aW51b3VzIHNpbGVudCByZXNldCBldmVyeSAyIHNlY29uZHMuCiAJ
ICovCiAJcnhfY2hrX2NudCsrOwpAQCAtMzExNiw3ICszMTQ0LDggQEAgc3RhdGljIFJFU0VUX1RZ
UEUgcnRsODE5eF9pZmNoZWNrX3Jlc2V0b3Jub3Qoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAlU
eFJlc2V0VHlwZSA9IFR4Q2hlY2tTdHVjayhkZXYpOwogCWlmIChyZlN0YXRlICE9IGVSZk9mZiB8
fAogCSAgICAocHJpdi0+aWVlZTgwMjExLT5pd19tb2RlICE9IElXX01PREVfQURIT0MpKSB7Ci0J
CS8qIElmIGRyaXZlciBpcyBpbiB0aGUgc3RhdHVzIG9mIGZpcm13YXJlIGRvd25sb2FkIGZhaWx1
cmUsCisJCS8qCisJCSAqIElmIGRyaXZlciBpcyBpbiB0aGUgc3RhdHVzIG9mIGZpcm13YXJlIGRv
d25sb2FkIGZhaWx1cmUsCiAJCSAqIGRyaXZlciBza2lwcyBSRiBpbml0aWFsaXphdGlvbiBhbmQg
UkYgaXMgaW4gdHVybmVkIG9mZgogCQkgKiBzdGF0ZS4gRHJpdmVyIHNob3VsZCBjaGVjayB3aGV0
aGVyIFJ4IHN0dWNrIGFuZCBkbyBzaWxlbnQKIAkJICogcmVzZXQuIEFuZCBpZiBkcml2ZXIgaXMg
aW4gZmlybXdhcmUgZG93bmxvYWQgZmFpbHVyZSBzdGF0dXMsCkBAIC0zMjE2LDcgKzMyNDUsOCBA
QCBzdGF0aWMgdm9pZCBDYW1SZXN0b3JlQWxsRW50cnkoc3RydWN0IG5ldF9kZXZpY2UgKmRldikK
IAl9CiB9CgotLyogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHRvIGZpeCBUeC9SeCBzdG9wIGJ1ZyB0
ZW1wb3JhcmlseS4KKy8qCisgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgdG8gZml4IFR4L1J4IHN0
b3AgYnVnIHRlbXBvcmFyaWx5LgogICogVGhpcyBmdW5jdGlvbiB3aWxsIGRvICJzeXN0ZW0gcmVz
ZXQiIHRvIE5JQyB3aGVuIFR4IG9yIFJ4IGlzIHN0dWNrLgogICogVGhlIG1ldGhvZCBjaGVja2lu
ZyBUeC9SeCBzdHVjayBvZiB0aGlzIGZ1bmN0aW9uIGlzIHN1cHBvcnRlZCBieSBGVywKICAqIHdo
aWNoIHJlcG9ydHMgVHggYW5kIFJ4IGNvdW50ZXIgdG8gcmVnaXN0ZXIgMHgxMjggYW5kIDB4MTMw
LgpAQCAtMzUyNyw3ICszNTU3LDggQEAgaW50IHJ0bDgxOTJfZG93bihzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2KQogCWZvciAoaSA9IDA7IGkgPCBNQVhfUVVFVUVfU0laRTsgaSsrKQogCQlza2JfcXVl
dWVfcHVyZ2UoJnByaXYtPmllZWU4MDIxMS0+c2tiX2Rydl9hZ2dRW2ldKTsKCi0JLyogYXMgY2Fu
Y2VsX2RlbGF5ZWRfd29yayB3aWxsIGRlbCB3b3JrLT50aW1lciwgc28gaWYgd29yayBpcyBub3QK
KwkvKgorCSAqIGFzIGNhbmNlbF9kZWxheWVkX3dvcmsgd2lsbCBkZWwgd29yay0+dGltZXIsIHNv
IGlmIHdvcmsgaXMgbm90CiAJICogZGVmaW5lZCBhcyBzdHJ1Y3QgZGVsYXllZF93b3JrLCBpdCB3
aWxsIGNvcnJ1cHQKIAkgKi8KIAlydGw4MTkyX2NhbmNlbF9kZWZlcnJlZF93b3JrKHByaXYpOwpA
QCAtMzY1Miw3ICszNjgzLDggQEAgc3RhdGljIGludCBydGw4MTkyX2lvY3RsKHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYsIHN0cnVjdCBpZnJlcSAqcnEsIGludCBjbWQpCiAJCQkJaWYgKGllZWUtPnBh
aXJ3aXNlX2tleV90eXBlKSB7CiAJCQkJCW1lbWNweSgodTggKilrZXksIGlwdy0+dS5jcnlwdC5r
ZXksIDE2KTsKIAkJCQkJRW5hYmxlSFdTZWN1cml0eUNvbmZpZzgxOTIoZGV2KTsKLQkJCQkJLyog
V2UgZmlsbCBib3RoIGluZGV4IGVudHJ5IGFuZCA0dGgKKwkJCQkJLyoKKwkJCQkJICogV2UgZmls
bCBib3RoIGluZGV4IGVudHJ5IGFuZCA0dGgKIAkJCQkJICogZW50cnkgZm9yIHBhaXJ3aXNlIGtl
eSBhcyBpbiBJUFcKIAkJCQkJICogaW50ZXJmYWNlLCBhZGhvYyB3aWxsIG9ubHkgZ2V0IGhlcmUs
CiAJCQkJCSAqIHNvIHdlIG5lZWQgaW5kZXggZW50cnkgZm9yIGl0cwpAQCAtMzg3Myw3ICszOTA1
LDggQEAgc3RhdGljIGxvbmcgcnRsODE5eF90cmFuc2xhdGVfdG9kYm0odTggc2lnbmFsX3N0cmVu
Z3RoX2luZGV4KQogfQoKCi0vKiBXZSBjYW4gbm90IGRlY2xhcmUgUlNTSS9FVk0gdG90YWwgdmFs
dWUgb2Ygc2xpZGluZyB3aW5kb3cgdG8KKy8qCisgKiBXZSBjYW4gbm90IGRlY2xhcmUgUlNTSS9F
Vk0gdG90YWwgdmFsdWUgb2Ygc2xpZGluZyB3aW5kb3cgdG8KICAqIGJlIGEgbG9jYWwgc3RhdGlj
LiBPdGhlcndpc2UsIGl0IG1heSBpbmNyZWFzZSB3aGVuIHdlIHJldHVybiBmcm9tIFMzL1M0LiBU
aGUKICAqIHZhbHVlIHdpbGwgYmUga2VwdCBpbiBtZW1vcnkgb3IgZGlzay4gRGVjbGFyZSB0aGUg
dmFsdWUgaW4gdGhlIGFkYXB0b3IKICAqIGFuZCBpdCB3aWxsIGJlIHJlaW5pdGlhbGl6ZWQgd2hl
biByZXR1cm5lZCBmcm9tIFMzL1M0LgpAQCAtMzkzNiw3ICszOTY5LDggQEAgc3RhdGljIHZvaWQg
cnRsODE5Ml9wcm9jZXNzX3BoeWluZm8oc3RydWN0IHI4MTkyX3ByaXYgKnByaXYsIHU4ICpidWZm
ZXIsCiAJCXJldHVybjsKCgotCS8qIG9ubHkgcnRsODE5MCBzdXBwb3J0ZWQKKwkvKgorCSAqIG9u
bHkgcnRsODE5MCBzdXBwb3J0ZWQKIAkgKiBydGw4MTkwX3Byb2Nlc3NfY2NrX3J4cGF0aHNlbChw
cml2LHBwcmV2aW91c19zdGF0cyk7CiAJICovCgpAQCAtMzk0Niw3ICszOTgwLDggQEAgc3RhdGlj
IHZvaWQgcnRsODE5Ml9wcm9jZXNzX3BoeWluZm8oc3RydWN0IHI4MTkyX3ByaXYgKnByaXYsIHU4
ICpidWZmZXIsCiAJLyogcmVjb3JkIHRoZSBnZW5lcmFsIHNpZ25hbCBzdHJlbmd0aCB0byB0aGUg
c2xpZGluZyB3aW5kb3cuICovCgoKLQkvKiA8Mj4gU2hvd2VkIG9uIFVJIGZvciBlbmdpbmVlcmlu
ZworCS8qCisJICogPDI+IFNob3dlZCBvbiBVSSBmb3IgZW5naW5lZXJpbmcKIAkgKiBoYXJkd2Fy
ZSBkb2VzIG5vdCBwcm92aWRlIHJzc2kgaW5mb3JtYXRpb24gZm9yIGVhY2ggcmYgcGF0aCBpbiBD
Q0sKIAkgKi8KIAlpZiAoIXBwcmV2aW91c19zdGF0cy0+YklzQ0NLICYmCkBAIC00MDY5LDcgKzQx
MDQsOCBAQCBzdGF0aWMgdm9pZCBydGw4MTkyX3Byb2Nlc3NfcGh5aW5mbyhzdHJ1Y3QgcjgxOTJf
cHJpdiAqcHJpdiwgdTggKmJ1ZmZlciwKIAl9CiB9CgotLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQor
LyoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBGdW5jdGlvbjoJcnRsODE5eF9xdWVyeV9y
eHB3cnBlcmNlbnRhZ2UoKQogICoKICAqIE92ZXJ2aWV3OgpAQCAtNDA3OSw3ICs0MTE1LDcgQEAg
c3RhdGljIHZvaWQgcnRsODE5Ml9wcm9jZXNzX3BoeWluZm8oc3RydWN0IHI4MTkyX3ByaXYgKnBy
aXYsIHU4ICpidWZmZXIsCiAgKiBPdXRwdXQ6CQlOT05FCiAgKgogICogUmV0dXJuOgkJMC0xMDAg
cGVyY2VudGFnZQotICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQog
ICovCiBzdGF0aWMgdTggcnRsODE5eF9xdWVyeV9yeHB3cnBlcmNlbnRhZ2UoczggYW50cG93ZXIp
CiB7CkBAIC00MjA4LDcgKzQyNDQsOCBAQCBzdGF0aWMgdm9pZCBydGw4MTkyX3F1ZXJ5X3J4cGh5
c3RhdHVzKHN0cnVjdCByODE5Ml9wcml2ICpwcml2LAogCWlmIChpc19jY2tfcmF0ZSkgewogCQkv
KiAoMSlIYXJkd2FyZSBkb2VzIG5vdCBwcm92aWRlIFJTU0kgZm9yIENDSyAqLwoKLQkJLyogKDIp
UFdEQiwgQXZlcmFnZSBQV0RCIGNhbGN1bGF0ZWQgYnkgaGFyZHdhcmUKKwkJLyoKKwkJICogKDIp
UFdEQiwgQXZlcmFnZSBQV0RCIGNhbGN1bGF0ZWQgYnkgaGFyZHdhcmUKIAkJICogKGZvciByYXRl
IGFkYXB0aXZlKQogCQkgKi8KIAkJdTggcmVwb3J0OwpAQCAtNDMwOSw3ICs0MzQ2LDggQEAgc3Rh
dGljIHZvaWQgcnRsODE5Ml9xdWVyeV9yeHBoeXN0YXR1cyhzdHJ1Y3QgcjgxOTJfcHJpdiAqcHJp
diwKIAkJfQoKCi0JCS8qICgyKVBXREIsIEF2ZXJhZ2UgUFdEQiBjYWxjdWxhdGVkIGJ5IGhhcmR3
YXJlCisJCS8qCisJCSAqICgyKVBXREIsIEF2ZXJhZ2UgUFdEQiBjYWxjdWxhdGVkIGJ5IGhhcmR3
YXJlCiAJCSAqIChmb3IgcmF0ZSBhZGFwdGl2ZSkKIAkJICovCiAJCXJ4X3B3cl9hbGwgPSAoKChw
b2ZkbV9idWYtPnB3ZGJfYWxsKSA+PiAxKSAmIDB4N2YpIC0gMTA2OwpAQCAtNDMzMSw3ICs0MzY5
LDggQEAgc3RhdGljIHZvaWQgcnRsODE5Ml9xdWVyeV9yeHBoeXN0YXR1cyhzdHJ1Y3QgcjgxOTJf
cHJpdiAqcHJpdiwKIAkJCXRtcF9yeGV2bSA9CXBvZmRtX2J1Zi0+cnhldm1fWFtpXTsKIAkJCXJ4
X2V2bVggPSAoczgpKHRtcF9yeGV2bSk7CgotCQkJLyogRG8gbm90IHVzZSBzaGlmdCBvcGVyYXRp
b24gbGlrZSAicnhfZXZtWCA+Pj0gMSIKKwkJCS8qCisJCQkgKiBEbyBub3QgdXNlIHNoaWZ0IG9w
ZXJhdGlvbiBsaWtlICJyeF9ldm1YID4+PSAxIgogCQkJICogYmVjYXVzZSB0aGUgY29tcGlsZXIg
b2YgZnJlZSBidWlsZCBlbnZpcm9ubWVudCB3aWxsCiAJCQkgKiBzZXQgdGhlIG1vc3Qgc2lnbmlm
aWNhbnQgYml0IHRvICJ6ZXJvIiB3aGVuIGRvaW5nCiAJCQkgKiBzaGlmdGluZyBvcGVyYXRpb24g
d2hpY2ggbWF5IGNoYW5nZSBhIG5lZ2F0aXZlIHZhbHVlCkBAIC00MzQyLDcgKzQzODEsOCBAQCBz
dGF0aWMgdm9pZCBydGw4MTkyX3F1ZXJ5X3J4cGh5c3RhdHVzKHN0cnVjdCByODE5Ml9wcml2ICpw
cml2LAoKIAkJCWV2bSA9IHJ0bDgxOXhfZXZtX2RidG9wZXJjZW50YWdlKHJ4X2V2bVgpOwogCQkJ
aWYgKGkgPT0gMCkKLQkJCQkvKiBGaWxsIHZhbHVlIGluIFJGRCwgR2V0IHRoZSBmaXJzdCBzcGF0
aWFsCisJCQkJLyoKKwkJCQkgKiBGaWxsIHZhbHVlIGluIFJGRCwgR2V0IHRoZSBmaXJzdCBzcGF0
aWFsCiAJCQkJICogc3RyZWFtIG9ubHkKIAkJCQkgKi8KIAkJCQlwc3RhdHMtPlNpZ25hbFF1YWxp
dHkgPQpAQCAtNDM2NCw3ICs0NDA0LDggQEAgc3RhdGljIHZvaWQgcnRsODE5Ml9xdWVyeV9yeHBo
eXN0YXR1cyhzdHJ1Y3QgcjgxOTJfcHJpdiAqcHJpdiwKIAkJCXByaXYtPnN0YXRzLnJlY2VpdmVk
X2J3dHlwZVswXSsrOwogCX0KCi0JLyogVUkgQlNTIExpc3Qgc2lnbmFsIHN0cmVuZ3RoKGluIHBl
cmNlbnRhZ2UpLCBtYWtlIGl0IGdvb2QgbG9va2luZywKKwkvKgorCSAqIFVJIEJTUyBMaXN0IHNp
Z25hbCBzdHJlbmd0aChpbiBwZXJjZW50YWdlKSwgbWFrZSBpdCBnb29kIGxvb2tpbmcsCiAJICog
ZnJvbSAwfjEwMC4gSXQgaXMgYXNzaWduZWQgdG8gdGhlIEJTUyBMaXN0IGluCiAJICogR2V0VmFs
dWVGcm9tQmVhY29uT3JQcm9iZVJzcCgpLgogCSAqLwpAQCAtNDM5Niw3ICs0NDM3LDggQEAgc3Rh
dGljIHZvaWQgVHJhbnNsYXRlUnhTaWduYWxTdHVmZjgxOXhVc2Ioc3RydWN0IHNrX2J1ZmYgKnNr
YiwKIAkJCQkJICBzdHJ1Y3QgaWVlZTgwMjExX3J4X3N0YXRzICpwc3RhdHMsCiAJCQkJCSAgc3Ry
dWN0IHJ4X2RydmluZm9fODE5eF91c2IgICpwZHJ2aW5mbykKIHsKLQkvKiBUT0RPOiBXZSBtdXN0
IG9ubHkgY2hlY2sgcGFja2V0IGZvciBjdXJyZW50IE1BQyBhZGRyZXNzLgorCS8qCisJICogVE9E
TzogV2UgbXVzdCBvbmx5IGNoZWNrIHBhY2tldCBmb3IgY3VycmVudCBNQUMgYWRkcmVzcy4KIAkg
KiBOb3QgZmluaXNoCiAJICovCiAJc3RydWN0IHJ0bDgxOTJfcnhfaW5mbyAqaW5mbyA9IChzdHJ1
Y3QgcnRsODE5Ml9yeF9pbmZvICopc2tiLT5jYjsKQEAgLTQ0NDEsNyArNDQ4Myw4IEBAIHN0YXRp
YyB2b2lkIFRyYW5zbGF0ZVJ4U2lnbmFsU3R1ZmY4MTl4VXNiKHN0cnVjdCBza19idWZmICpza2Is
CiAJCXByaXYtPnN0YXRzLm51bXBhY2tldF9tYXRjaGJzc2lkKys7CiAJaWYgKGJwYWNrZXRfdG9z
ZWxmKQogCQlwcml2LT5zdGF0cy5udW1wYWNrZXRfdG9zZWxmKys7Ci0JLyogUHJvY2VzcyBQSFkg
aW5mb3JtYXRpb24gZm9yIHByZXZpb3VzIHBhY2tldCAoUlNTSS9QV0RCL0VWTSkKKwkvKgorCSAq
IFByb2Nlc3MgUEhZIGluZm9ybWF0aW9uIGZvciBwcmV2aW91cyBwYWNrZXQgKFJTU0kvUFdEQi9F
Vk0pCiAJICogQmVjYXVzZSBwaHkgaW5mb3JtYXRpb24gaXMgY29udGFpbmVkIGluIHRoZSBsYXN0
IHBhY2tldCBvZiBBTVBEVQogCSAqIG9ubHksIHNvIGRyaXZlciBzaG91bGQgcHJvY2VzcyBwaHkg
aW5mb3JtYXRpb24gb2YgcHJldmlvdXMgcGFja2V0CiAJICovCkBAIC00NjE2LDcgKzQ2NTksOCBA
QCBzdGF0aWMgdm9pZCBxdWVyeV9yeGRlc2Nfc3RhdHVzKHN0cnVjdCBza19idWZmICpza2IsCiAJ
aWYgKHN0YXRzLT5MZW5ndGggPCAyNCB8fCBzdGF0cy0+TGVuZ3RoID4gTUFYXzgxOTJVX1JYX1NJ
WkUpCiAJCXN0YXRzLT5iSHdFcnJvciB8PSAxOwogCS8qIEdldCBEcml2ZXIgSW5mbyAqLwotCS8q
IFRPRE86IE5lZWQgdG8gdmVyaWZ5IGl0IG9uIEZHUEEgcGxhdGZvcm0KKwkvKgorCSAqIFRPRE86
IE5lZWQgdG8gdmVyaWZ5IGl0IG9uIEZHUEEgcGxhdGZvcm0KIAkgKiBEcml2ZXIgaW5mbyBhcmUg
d3JpdHRlbiB0byB0aGUgUnhCdWZmZXIgZm9sbG93aW5nIHJ4IGRlc2MKIAkgKi8KIAlpZiAoc3Rh
dHMtPlJ4RHJ2SW5mb1NpemUgIT0gMCkgewpAQCAtNDYzMyw3ICs0Njc3LDggQEAgc3RhdGljIHZv
aWQgcXVlcnlfcnhkZXNjX3N0YXR1cyhzdHJ1Y3Qgc2tfYnVmZiAqc2tiLAogCQkJcmV0X3JhdGUg
PSBId1JhdGVUb01SYXRlOTAoZHJpdmVyX2luZm8tPlJ4SFQsCiAJCQkJCQkgICBkcml2ZXJfaW5m
by0+UnhSYXRlKTsKIAkJCWlmIChyZXRfcmF0ZSA9PSAweGZmKSB7Ci0JCQkJLyogQWJub3JtYWwg
Q2FzZTogUmVjZWl2ZSBDUkMgT0sgcGFja2V0IHdpdGggUngKKwkJCQkvKgorCQkJCSAqIEFibm9y
bWFsIENhc2U6IFJlY2VpdmUgQ1JDIE9LIHBhY2tldCB3aXRoIFJ4CiAJCQkJICogZGVzY3JpcHRv
ciBpbmRpY2F0aW5nIG5vbiBzdXBwb3J0ZWQgcmF0ZS4KIAkJCQkgKiBTcGVjaWFsIEVycm9yIEhh
bmRsaW5nIGhlcmUKIAkJCQkgKi8KQEAgLTQ3NDQsNyArNDc4OSw4IEBAIHN0YXRpYyB2b2lkIHJ0
bDgxOXh1c2JfcHJvY2Vzc19yZWNlaXZlZF9wYWNrZXQoCiAjZW5kaWYKICNpZmRlZiBFTkFCTEVf
UFMgIC8qIGZvciBhZGRpbmcgcHMgZnVuY3Rpb24gaW4gZnV0dXJlICovCiAJUlRfUkZfUE9XRVJf
U1RBVEUgcnRTdGF0ZTsKLQkvKiBXaGVuIFJGIGlzIG9mZiwgd2Ugc2hvdWxkIG5vdCBjb3VudCB0
aGUgcGFja2V0IGZvciBody9zdyBzeW5jaHJvbml6ZQorCS8qCisJICogV2hlbiBSRiBpcyBvZmYs
IHdlIHNob3VsZCBub3QgY291bnQgdGhlIHBhY2tldCBmb3IgaHcvc3cgc3luY2hyb25pemUKIAkg
KiByZWFzb24sIGllLiB0aGVyZSBtYXkgYmUgYSBkdXJhdGlvbiB3aGlsZSBzdyBzd2l0Y2ggaXMg
Y2hhbmdlZCBhbmQKIAkgKiBodyBzd2l0Y2ggaXMgYmVpbmcgY2hhbmdlZC4KIAkgKi8KQEAgLTQ5
MjYsNyArNDk3Miw4IEBAIHN0YXRpYyBpbnQgcnRsODE5Ml91c2JfcHJvYmUoc3RydWN0IHVzYl9p
bnRlcmZhY2UgKmludGYsCiAJcmV0dXJuIHJldDsKIH0KCi0vKiBkZXRhY2ggYWxsIHRoZSB3b3Jr
IGFuZCB0aW1lciBzdHJ1Y3R1cmUgZGVjbGFyZWQgb3IgaW5pdGl0aWFsaXplCisvKgorICogZGV0
YWNoIGFsbCB0aGUgd29yayBhbmQgdGltZXIgc3RydWN0dXJlIGRlY2xhcmVkIG9yIGluaXRpdGlh
bGl6ZQogICogaW4gcjgxOTJVX2luaXQgZnVuY3Rpb24uCiAgKi8KIHN0YXRpYyB2b2lkIHJ0bDgx
OTJfY2FuY2VsX2RlZmVycmVkX3dvcmsoc3RydWN0IHI4MTkyX3ByaXYgKnByaXYpCkBAIC01MDIz
LDcgKzUwNzAsOCBAQCB2b2lkIEVuYWJsZUhXU2VjdXJpdHlDb25maWc4MTkyKHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYpCiAJCVNFQ1JfdmFsdWUgfD0gU0NSX1J4VXNlREs7CiAJCVNFQ1JfdmFsdWUg
fD0gU0NSX1R4VXNlREs7CiAJfQotCS8qIGFkZCBIV1NlYyBhY3RpdmUgZW5hYmxlIGhlcmUuCisJ
LyoKKwkgKiBhZGQgSFdTZWMgYWN0aXZlIGVuYWJsZSBoZXJlLgogCSAqIGRlZmF1bHQgdXNpbmcg
aHdzZWMuIHdoZW4gcGVlciBBUCBpcyBpbiBOIG1vZGUgb25seSBhbmQKIAkgKiBwYWlyd2lzZV9r
ZXlfdHlwZSBpcyBub25lX2Flcyh3aGljaCBIVF9JT1RfQUNUX1BVUkVfTl9NT0RFIGluZGljYXRl
cwogCSAqIGl0KSwgdXNlIHNvZnR3YXJlIHNlY3VyaXR5LiB3aGVuIHBlZXIgQVAgaXMgaW4gYixn
LG4gbW9kZSBtaXhlZCBhbmQKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9y
ODE5MlVfZG0uYyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5MlVfZG0uYwppbmRleCAy
YmEwMTA0MTQwNmIuLmIxNWNmOTgyODFkZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3J0
bDgxOTJ1L3I4MTkyVV9kbS5jCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5MlVf
ZG0uYwpAQCAtMjEsNyArMjEsNyBAQCBNYWpvciBDaGFuZ2UgSGlzdG9yeToKICNpbmNsdWRlICJy
ODE5eFVfcGh5cmVnLmgiCiAjaW5jbHVkZSAicjgxOTBfcnRsODI1Ni5oIgogI2luY2x1ZGUgInI4
MTl4VV9jbWRwa3QuaCIKLS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRGVmaW5lIExvY2Fs
IENvbnN0YW50LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKy8qIC0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLURlZmluZSBMb2NhbCBDb25zdGFudC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLSAqLwogLyogSW5kaWNhdGUgZGlmZmVyZW50IEFQIHZlbmRvciBmb3IgSU9UIGlzc3VlLiAq
Lwogc3RhdGljIHUzMiBlZGNhX3NldHRpbmdfRExbSFRfSU9UX1BFRVJfTUFYXSA9IHsKIAkweDVl
NDMyMiwgMHg1ZTQzMjIsIDB4NWU0MzIyLCAweDYwNDMyMiwgMHgwMGE0NGYsIDB4NWVhNDRmCkBA
IC0zMiwxMCArMzIsMTAgQEAgc3RhdGljIHUzMiBlZGNhX3NldHRpbmdfVUxbSFRfSU9UX1BFRVJf
TUFYXSA9IHsKCiAjZGVmaW5lIFJUS19VTF9FRENBIDB4YTQ0ZgogI2RlZmluZSBSVEtfRExfRURD
QSAweDVlNDMyMgotLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1EZWZpbmUgTG9jYWwgQ29u
c3RhbnQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLworLyogLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tRGVmaW5lIExvY2FsIENvbnN0YW50LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
ICovCgoKLS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRGVmaW5lIGdsb2JhbCB2YXJpYWJsZS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LURlZmluZSBnbG9iYWwgdmFyaWFibGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwog
LyogRGVidWcgdmFyaWFibGUgPyAqLwogc3RydWN0IGRpZyBkbV9kaWd0YWJsZTsKIC8qIFN0b3Jl
IGN1cnJlbnQgc29mdHdhcmUgd3JpdGUgcmVnaXN0ZXIgY29udGVudCBmb3IgTUFDIFBIWS4gKi8K
QEAgLTUzLDExICs1MywxMSBAQCBzdGF0aWMJdm9pZAlkbV9pbml0X2JhbmR3aWR0aF9hdXRvc3dp
dGNoKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpOwogc3RhdGljCXZvaWQJZG1fYmFuZHdpZHRoX2F1
dG9zd2l0Y2goc3RydWN0IG5ldF9kZXZpY2UgKmRldik7CgogLyogRE0gLS0+IFRYIHBvd2VyIGNv
bnRyb2wgKi8KLS8qc3RhdGljCXZvaWQJZG1faW5pdGlhbGl6ZV90eHBvd2VyX3RyYWNraW5nKHN0
cnVjdCBuZXRfZGV2aWNlICpkZXYpOyovCisvKiBzdGF0aWMJdm9pZAlkbV9pbml0aWFsaXplX3R4
cG93ZXJfdHJhY2tpbmcoc3RydWN0IG5ldF9kZXZpY2UgKmRldik7ICovCgogc3RhdGljCXZvaWQJ
ZG1fY2hlY2tfdHhwb3dlcl90cmFja2luZyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KTsKCi0vKnN0
YXRpYwl2b2lkCWRtX3R4cG93ZXJfcmVzZXRfcmVjb3Zlcnkoc3RydWN0IG5ldF9kZXZpY2UgKmRl
dik7Ki8KKy8qIHN0YXRpYwl2b2lkCWRtX3R4cG93ZXJfcmVzZXRfcmVjb3Zlcnkoc3RydWN0IG5l
dF9kZXZpY2UgKmRldik7ICovCgogLyogRE0gLS0+IER5bmFtaWMgSW5pdCBHYWluIGJ5IFJTU0kg
Ki8KIHN0YXRpYwl2b2lkCWRtX2RpZ19pbml0KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpOwpAQCAt
ODksMTYgKzg5LDE2IEBAIHN0YXRpYyB2b2lkIGRtX2RlSW5pdF9mc3luYyhzdHJ1Y3QgbmV0X2Rl
dmljZSAqZGV2KTsKIC8qIEFkZGVkIGJ5IHZpdmksIDIwMDgwNTIyICovCiBzdGF0aWMJdm9pZAlk
bV9jaGVja190eHJhdGVhbmRyZXRyeWNvdW50KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpOwoKLS8q
LS0tLS0tLS0tLS0tLS0tLS0tLS0tRGVmaW5lIGxvY2FsIGZ1bmN0aW9uIHByb3RvdHlwZS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tKi8KKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLURlZmluZSBsb2Nh
bCBmdW5jdGlvbiBwcm90b3R5cGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKLS8qLS0tLS0t
LS0tLS0tLS0tLS0tLS0tRGVmaW5lIG9mIFR4IFBvd2VyIENvbnRyb2wgRm9yIE5lYXIvRmFyIFJh
bmdlIC0tLS0tLS0tKi8gICAvKkFkZCBieSBKYWNrZW4gMjAwOC8wMi8xOCAqLworLyogLS0tLS0t
LS0tLS0tLS0tLS0tLS0tRGVmaW5lIG9mIFR4IFBvd2VyIENvbnRyb2wgRm9yIE5lYXIvRmFyIFJh
bmdlIC0tLS0tLS0tICovICAgLyogQWRkIGJ5IEphY2tlbiAyMDA4LzAyLzE4ICovCiBzdGF0aWMJ
dm9pZAlkbV9pbml0X2R5bmFtaWNfdHhwb3dlcihzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KTsKIHN0
YXRpYwl2b2lkCWRtX2R5bmFtaWNfdHhwb3dlcihzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KTsKCiAv
KiBETSAtLT4gRm9yIHJhdGUgYWRhcHRpdmUgYW5kIERJRywgd2UgbXVzdCBzZW5kIFJTU0kgdG8g
ZmlybXdhcmUgKi8KIHN0YXRpYwl2b2lkIGRtX3NlbmRfcnNzaV90b2Z3KHN0cnVjdCBuZXRfZGV2
aWNlICpkZXYpOwogc3RhdGljCXZvaWQJZG1fY3RzdG9zZWxmKHN0cnVjdCBuZXRfZGV2aWNlICpk
ZXYpOwotLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1EZWZpbmUgZnVuY3Rpb24gcHJvdG90
eXBlLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLURlZmluZSBmdW5jdGlvbiBwcm90b3R5cGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8K
IC8qCiAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICoJSFcgRHluYW1pYyBtZWNoYW5pc20g
aW50ZXJmYWNlLgpAQCAtMTIxLDcgKzEyMSw3IEBAIHZvaWQgaW5pdF9oYWxfZG0oc3RydWN0IG5l
dF9kZXZpY2UgKmRldikKIAkvKiBJbml0aWFsIFRYIFBvd2VyIENvbnRyb2wgZm9yIG5lYXIvZmFy
IHJhbmdlICwgYWRkIGJ5IGFteSAyMDA4LzA1LzE1LCBwb3J0aW5nIGZyb20gd2luZG93cyBjb2Rl
LiAqLwogCWRtX2luaXRfZHluYW1pY190eHBvd2VyKGRldik7CiAJaW5pdF9yYXRlX2FkYXB0aXZl
KGRldik7Ci0JLypkbV9pbml0aWFsaXplX3R4cG93ZXJfdHJhY2tpbmcoZGV2KTsqLworCS8qIGRt
X2luaXRpYWxpemVfdHhwb3dlcl90cmFja2luZyhkZXYpOyAqLwogCWRtX2RpZ19pbml0KGRldik7
CiAJZG1faW5pdF9lZGNhX3R1cmJvKGRldik7CiAJZG1faW5pdF9iYW5kd2lkdGhfYXV0b3N3aXRj
aChkZXYpOwpAQCAtMTk1LDExICsxOTUsMTEgQEAgdm9pZCBkbV9DaGVja1J4QWdncmVnYXRpb24o
c3RydWN0IG5ldF9kZXZpY2UgKmRldikKCiB2b2lkIGhhbF9kbV93YXRjaGRvZyhzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2KQogewotCS8qc3RydWN0IHI4MTkyX3ByaXYgKnByaXYgPSBpZWVlODAyMTFf
cHJpdihkZXYpOyovCisJLyogc3RydWN0IHI4MTkyX3ByaXYgKnByaXYgPSBpZWVlODAyMTFfcHJp
dihkZXYpOyAqLwoKLQkvKnN0YXRpYyB1OAlwcmV2aW91c19ic3NpZFs2XSA9ezB9OyovCisJLyog
c3RhdGljIHU4CXByZXZpb3VzX2Jzc2lkWzZdID17MH07ICovCgotCS8qQWRkIGJ5IGFteSAyMDA4
LzA1LzE1ICxwb3J0aW5nIGZyb20gd2luZG93cyBjb2RlLiovCisJLyogQWRkIGJ5IGFteSAyMDA4
LzA1LzE1ICxwb3J0aW5nIGZyb20gd2luZG93cyBjb2RlLiAqLwogCWRtX2NoZWNrX3JhdGVfYWRh
cHRpdmUoZGV2KTsKIAlkbV9keW5hbWljX3R4cG93ZXIoZGV2KTsKIAlkbV9jaGVja190eHJhdGVh
bmRyZXRyeWNvdW50KGRldik7CkBAIC0yNjcsNyArMjY3LDggQEAgdm9pZCBpbml0X3JhdGVfYWRh
cHRpdmUoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKCiB9CS8qIEluaXRSYXRlQWRhcHRpdmUgKi8K
Ci0vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisvKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAq
IEZ1bmN0aW9uOglkbV9jaGVja19yYXRlX2FkYXB0aXZlKCkKICAqCiAgKiBPdmVydmlldzoKQEAg
LTI4Miw3ICsyODMsOCBAQCB2b2lkIGluaXRfcmF0ZV9hZGFwdGl2ZShzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2KQogICoJV2hlbgkJV2hvCQlSZW1hcmsKICAqCTA1LzI2LzA4CWFteQlDcmVhdGUgdmVy
c2lvbiAwIHBvcnRpbmcgZnJvbSB3aW5kb3dzIGNvZGUuCiAgKgotICotLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0qLworICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKi8KIHN0YXRpYyB2b2lkIGRtX2NoZWNrX3Jh
dGVfYWRhcHRpdmUoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgcjgxOTJfcHJp
diAqcHJpdiA9IGllZWU4MDIxMV9wcml2KGRldik7CkBAIC0zMzUsMTAgKzMzNywxMyBAQCBzdGF0
aWMgdm9pZCBkbV9jaGVja19yYXRlX2FkYXB0aXZlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiAJ
CQkJKHByYS0+cGluZ19yc3NpX3JhdHIgJiAofkJJVCgzMSkpKSB8CiAJCQkJKChic2hvcnRfZ2lf
ZW5hYmxlZCkgPyBCSVQoMzEpIDogMCk7CgotCQkvKiAyMDA3LzEwLzA4IE1IIFdlIHN1cHBvcnQg
UkEgc21vb3RoIHNjaGVtZSBub3cuIFdoZW4gaXQgaXMgdGhlIGZpcnN0Ci0JCSAgIHRpbWUgdG8g
bGluayB3aXRoIEFQLiBXZSB3aWxsIG5vdCBjaGFuZ2UgdXBwZXIvbG93ZXIgdGhyZXNob2xkLiBJ
ZgotCQkgICBTVEEgc3RheSBpbiBoaWdoIG9yIGxvdyBsZXZlbCwgd2UgbXVzdCBjaGFuZ2UgdHdv
IGRpZmZlcmVudCB0aHJlc2hvbGQKLQkJICAgdG8gcHJldmVudCBqdW1waW5nIGZyZXF1ZW50bHku
ICovCisJCS8qCisJCSAqIDIwMDcvMTAvMDggTUggV2Ugc3VwcG9ydCBSQSBzbW9vdGggc2NoZW1l
IG5vdy4gV2hlbiBpdCBpcyB0aGUgZmlyc3QKKwkJICogdGltZSB0byBsaW5rIHdpdGggQVAuIFdl
IHdpbGwgbm90IGNoYW5nZSB1cHBlci9sb3dlciB0aHJlc2hvbGQuIElmCisJCSAqIFNUQSBzdGF5
IGluIGhpZ2ggb3IgbG93IGxldmVsLCB3ZSBtdXN0IGNoYW5nZSB0d28gZGlmZmVyZW50IHRocmVz
aG9sZAorCQkgKiB0byBwcmV2ZW50IGp1bXBpbmcgZnJlcXVlbnRseS4KKwkJICoKKwkJICovCiAJ
CWlmIChwcmEtPnJhdHJfc3RhdGUgPT0gRE1fUkFUUl9TVEFfSElHSCkgewogCQkJSGlnaFJTU0lU
aHJlc2hGb3JSQQk9IHByYS0+aGlnaDJsb3dfcnNzaV90aHJlc2hfZm9yX3JhOwogCQkJTG93UlNT
SVRocmVzaEZvclJBCT0gKHByaXYtPkN1cnJlbnRDaGFubmVsQlcgIT0gSFRfQ0hBTk5FTF9XSURU
SF8yMCkgPwpAQCAtMTYwMSw3ICsxNjA2LDggQEAgc3RhdGljIHZvaWQgZG1fYmJfaW5pdGlhbGdh
aW5fYmFja3VwKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiB9ICAgLyogZG1fQkJJbml0aWFsR2Fp
bkJha2N1cCAqLwoKICNlbmRpZgotLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLyoKKyAqIC0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tCiAgKiBGdW5jdGlvbjoJZG1fZGlnX2luaXQoKQogICoKICAqIE92ZXJ2
aWV3OglTZXQgRElHIHNjaGVtZSBpbml0IHZhbHVlLgpAQCAtMTYxNiw3ICsxNjIyLDggQEAgc3Rh
dGljIHZvaWQgZG1fYmJfaW5pdGlhbGdhaW5fYmFja3VwKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYp
CiAgKglXaGVuCQlXaG8JCVJlbWFyawogICoJMDUvMTUvMjAwOAlhbXkJCUNyZWF0ZSBWZXJzaW9u
IDAgcG9ydGluZyBmcm9tIHdpbmRvd3MgY29kZS4KICAqCi0gKi0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSov
CisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqLwogc3RhdGljIHZvaWQgZG1fZGlnX2luaXQoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgcjgxOTJfcHJpdiAqcHJpdiA9IGllZWU4
MDIxMV9wcml2KGRldik7CkBAIC0xNjQ0LDcgKzE2NTEsOCBAQCBzdGF0aWMgdm9pZCBkbV9kaWdf
aW5pdChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQoKIH0JLyogZG1fZGlnX2luaXQgKi8KCi0vKi0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCisvKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIEZ1bmN0
aW9uOglkbV9jdHJsX2luaXRnYWluX2J5cnNzaSgpCiAgKgogICogT3ZlcnZpZXc6CURyaXZlciBt
dXN0IG1vbml0b3IgUlNTSSBhbmQgbm90aWZ5IGZpcm13YXJlIHRvIGNoYW5nZSBpbml0aWFsCkBA
IC0xNjYwLDcgKzE2NjgsOCBAQCBzdGF0aWMgdm9pZCBkbV9kaWdfaW5pdChzdHJ1Y3QgbmV0X2Rl
dmljZSAqZGV2KQogICogUmV2aXNlZCBIaXN0b3J5OgogICoJV2hlbgkJV2hvCQlSZW1hcmsKICAq
CTA1LzI3LzIwMDgJYW15CQlDcmVhdGUgVmVyc2lvbiAwIHBvcnRpbmcgZnJvbSB3aW5kb3dzIGNv
ZGUuCi0gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqLwog
c3RhdGljIHZvaWQgZG1fY3RybF9pbml0Z2Fpbl9ieXJzc2koc3RydWN0IG5ldF9kZXZpY2UgKmRl
dikKIHsKIAlpZiAoIWRtX2RpZ3RhYmxlLmRpZ19lbmFibGVfZmxhZykKQEAgLTE3NDcsMTEgKzE3
NTYsMTUgQEAgc3RhdGljIHZvaWQgZG1fY3RybF9pbml0Z2Fpbl9ieXJzc2lfYnlfZndmYWxzZV9h
bGFybSgKIAkvKkRiZ1ByaW50KCJESUcgQ2hlY2tcblxyIFJTU0k9JWQgTE9XPSVkIEhJR0g9JWQg
U1RBVEU9JWQiLAogCXBIYWxEYXRhLT5VbmRlY29yYXRlZFNtb290aGVkUFdEQiwgRE1fRGlnVGFi
bGUuUnNzaUxvd1RocmVzaCwKIAlETV9EaWdUYWJsZS5Sc3NpSGlnaFRocmVzaCwgRE1fRGlnVGFi
bGUuRGlnX1N0YXRlKTsqLwotCS8qIDEuIFdoZW4gUlNTSSBkZWNyZWFzZSwgV2UgaGF2ZSB0byBq
dWRnZSBpZiBpdCBpcyBzbWFsbGVyIHRoYW4gYSB0aHJlc2hvbGQKLQkJICBhbmQgdGhlbiBleGVj
dXRlIHRoZSBzdGVwIGJlbG93LiAqLworCS8qCisJICogMS4gV2hlbiBSU1NJIGRlY3JlYXNlLCBX
ZSBoYXZlIHRvIGp1ZGdlIGlmIGl0IGlzIHNtYWxsZXIgdGhhbiBhIHRocmVzaG9sZAorCSAqIGFu
ZCB0aGVuIGV4ZWN1dGUgdGhlIHN0ZXAgYmVsb3cuCisJICovCiAJaWYgKHByaXYtPnVuZGVjb3Jh
dGVkX3Ntb290aGVkX3B3ZGIgPD0gZG1fZGlndGFibGUucnNzaV9sb3dfdGhyZXNoKSB7Ci0JCS8q
IDIwMDgvMDIvMDUgTUggV2hlbiB3ZSBleGVjdXRlIHNpbGVudCByZXNldCwgdGhlIERJRyBQSFkg
cGFyYW1ldGVycwotCQkgICB3aWxsIGJlIHJlc2V0IHRvIGluaXQgdmFsdWUuIFdlIG11c3QgcHJl
dmVudCB0aGUgY29uZGl0aW9uLiAqLworCQkvKgorCQkgKiAyMDA4LzAyLzA1IE1IIFdoZW4gd2Ug
ZXhlY3V0ZSBzaWxlbnQgcmVzZXQsIHRoZSBESUcgUEhZIHBhcmFtZXRlcnMKKwkJICogd2lsbCBi
ZSByZXNldCB0byBpbml0IHZhbHVlLiBXZSBtdXN0IHByZXZlbnQgdGhlIGNvbmRpdGlvbi4KKwkJ
ICovCiAJCWlmIChkbV9kaWd0YWJsZS5kaWdfc3RhdGUgPT0gRE1fU1RBX0RJR19PRkYgJiYKIAkJ
ICAgIChwcml2LT5yZXNldF9jb3VudCA9PSByZXNldF9jbnQpKSB7CiAJCQlyZXR1cm47CkBAIC0x
Nzk2LDggKzE4MDksMTAgQEAgc3RhdGljIHZvaWQgZG1fY3RybF9pbml0Z2Fpbl9ieXJzc2lfYnlf
ZndmYWxzZV9hbGFybSgKCiAJfQoKLQkvKiAyLiBXaGVuIFJTU0kgaW5jcmVhc2UsIFdlIGhhdmUg
dG8ganVkZ2UgaWYgaXQgaXMgbGFyZ2VyIHRoYW4gYSB0aHJlc2hvbGQKLQkJICBhbmQgdGhlbiBl
eGVjdXRlIHRoZSBzdGVwIGJlbG93LiAgKi8KKwkvKgorCSAqIDIuIFdoZW4gUlNTSSBpbmNyZWFz
ZSwgV2UgaGF2ZSB0byBqdWRnZSBpZiBpdCBpcyBsYXJnZXIgdGhhbiBhIHRocmVzaG9sZAorCSAq
IGFuZCB0aGVuIGV4ZWN1dGUgdGhlIHN0ZXAgYmVsb3cuCisJICovCiAJaWYgKHByaXYtPnVuZGVj
b3JhdGVkX3Ntb290aGVkX3B3ZGIgPj0gZG1fZGlndGFibGUucnNzaV9oaWdoX3RocmVzaCkgewog
CQl1OCByZXNldF9mbGFnID0gMDsKCkBAIC0xODY1LDcgKzE4ODAsOCBAQCBzdGF0aWMgdm9pZCBk
bV9jdHJsX2luaXRnYWluX2J5cnNzaV9ieV9md2ZhbHNlX2FsYXJtKAoKIH0JLyogZG1fQ3RybElu
aXRHYWluQnlSc3NpICovCgotLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLyoKKyAqIC0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCiAgKiBGdW5jdGlvbjoJZG1fY3RybF9pbml0Z2Fpbl9ieXJzc2lfaGlnaHB3
cigpCiAgKgogICogT3ZlcnZpZXc6CkBAIC0xODgwLDcgKzE4OTYsOCBAQCBzdGF0aWMgdm9pZCBk
bV9jdHJsX2luaXRnYWluX2J5cnNzaV9ieV9md2ZhbHNlX2FsYXJtKAogICoJV2hlbgkJV2hvCQlS
ZW1hcmsKICAqCTA1LzI4LzIwMDgJYW15CQlDcmVhdGUgVmVyc2lvbiAwIHBvcnRpbmcgZnJvbSB3
aW5kb3dzIGNvZGUuCiAgKgotICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLworICogLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCisgKi8KIHN0YXRpYyB2b2lkIGRtX2N0cmxfaW5pdGdhaW5fYnlyc3NpX2hpZ2hwd3Io
CiAJc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIHsKQEAgLTIxNDcsNyArMjE2NCw3IEBAIHN0YXRp
YyB2b2lkIGRtX2NoZWNrX2VkY2FfdHVyYm8oCiB7CiAJc3RydWN0IHI4MTkyX3ByaXYgKnByaXYg
PSBpZWVlODAyMTFfcHJpdihkZXYpOwogCVBSVF9ISUdIX1RIUk9VR0hQVVQJcEhUSW5mbyA9IHBy
aXYtPmllZWU4MDIxMS0+cEhUSW5mbzsKLQkvKlBTVEFfUU9TCQkJcFN0YVFvcyA9IHBNZ250SW5m
by0+cFN0YVFvczsqLworCS8qIFBTVEFfUU9TCQkJcFN0YVFvcyA9IHBNZ250SW5mby0+cFN0YVFv
czsgKi8KCiAJLyogS2VlcCBwYXN0IFR4L1J4IHBhY2tldCBjb3VudCBmb3IgUlQtdG8tUlQgRURD
QSB0dXJiby4gKi8KIAlzdGF0aWMgdW5zaWduZWQgbG9uZwkJCWxhc3RUeE9rQ250OwpAQCAtMjIy
NCw3ICsyMjQxLDcgQEAgc3RhdGljIHZvaWQgZG1fY2hlY2tfZWRjYV90dXJibygKIAkJCSAqIElm
IGl0IGlzIHNldCwgaW1tZWRpYXRlbHkgc2V0IEFDTSBjb250cm9sIGJpdCB0byBkb3duZ3JhZGlu
ZyBBQyBmb3IgcGFzc2luZyBXTU0gdGVzdHBsYW4uIEFubmllLCAyMDA1LTEyLTEzLgogCQkJICov
CiAJCQl7Ci0JCQkJLyogIFRPRE86ICBNb2RpZmllZCB0aGlzIHBhcnQgYW5kIHRyeSB0byBzZXQg
YWNtIGNvbnRyb2wgaW4gb25seSAxIElPIHByb2Nlc3NpbmchISAqLworCQkJCS8qIFRPRE86IE1v
ZGlmaWVkIHRoaXMgcGFydCBhbmQgdHJ5IHRvIHNldCBhY20gY29udHJvbCBpbiBvbmx5IDEgSU8g
cHJvY2Vzc2luZyEhICovCgogCQkJCXN0cnVjdCBhY2lfYWlmc24gKnBBY2lBaWZzbiA9IChzdHJ1
Y3QgYWNpX2FpZnNuICopJihxb3NfcGFyYW1ldGVycy0+YWlmc1swXSk7CiAJCQkJdTgJCUFjbUN0
cmw7CkBAIC0yMjczLDEwICsyMjkwLDEwIEBAIHN0YXRpYyB2b2lkIGRtX2N0c3Rvc2VsZihzdHJ1
Y3QgbmV0X2RldmljZSAqZGV2KQogCQlyZXR1cm47CiAJfQogCS8qCi0JMS4gVXBsaW5rCi0JMi4g
TGlua3N5czM1MC9MaW5rc3lzMzAwTgotCTMuIDw1MCBkaXNhYmxlLCA+NTUgZW5hYmxlCi0JKi8K
KwkgKiAxLiBVcGxpbmsKKwkgKiAyLiBMaW5rc3lzMzUwL0xpbmtzeXMzMDBOCisJICogMy4gPDUw
IGRpc2FibGUsID41NSBlbmFibGUKKwkgKi8KCiAJaWYgKHBIVEluZm8tPklPVFBlZXIgPT0gSFRf
SU9UX1BFRVJfQlJPQURDT00pIHsKIAkJY3VyVHhPa0NudCA9IHByaXYtPnN0YXRzLnR4Ynl0ZXN1
bmljYXN0IC0gbGFzdFR4T2tDbnQ7CkBAIC0yMjkzLDcgKzIzMTAsOCBAQCBzdGF0aWMgdm9pZCBk
bV9jdHN0b3NlbGYoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAl9CiB9CgotLyotLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQorLyoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBGdW5jdGlvbjoJZG1f
Y2hlY2tfcGJjX2dwaW8oKQogICoKICAqIE92ZXJ2aWV3OglDaGVjayBpZiBQQkMgYnV0dG9uIGlz
IHByZXNzZWQuCkBAIC0yMzA4LDcgKzIzMjYsOCBAQCBzdGF0aWMgdm9pZCBkbV9jdHN0b3NlbGYo
c3RydWN0IG5ldF9kZXZpY2UgKmRldikKICAqCVdoZW4JCVdobwkJUmVtYXJrCiAgKgkwNS8yOC8y
MDA4CWFteQlDcmVhdGUgVmVyc2lvbiAwIHBvcnRpbmcgZnJvbSB3aW5kb3dzIGNvZGUuCiAgKgot
ICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0qLworICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKi8KIHN0YXRp
Ywl2b2lkCWRtX2NoZWNrX3BiY19ncGlvKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiB7CiAJc3Ry
dWN0IHI4MTkyX3ByaXYgKnByaXYgPSBpZWVlODAyMTFfcHJpdihkZXYpOwpAQCAtMjMyOSw3ICsy
MzQ4LDggQEAgc3RhdGljCXZvaWQJZG1fY2hlY2tfcGJjX2dwaW8oc3RydWN0IG5ldF9kZXZpY2Ug
KmRldikKCiB9CgotLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLyoKKyAqIC0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCiAgKiBGdW5jdGlvbjoJRE1fUkZQYXRoQ2hlY2tXb3JrSXRlbUNhbGxCYWNrKCkKICAq
CiAgKiBPdmVydmlldzoJQ2hlY2sgaWYgQ3VycmVudCBSRiBSWCBwYXRoIGlzIGVuYWJsZWQKQEAg
LTIzNDQsNyArMjM2NCw4IEBAIHN0YXRpYwl2b2lkCWRtX2NoZWNrX3BiY19ncGlvKHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYpCiAgKglXaGVuCQlXaG8JCVJlbWFyawogICoJMDEvMzAvMjAwOAlNSEMJ
CUNyZWF0ZSBWZXJzaW9uIDAuCiAgKgotICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLworICogLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCisgKi8KIHZvaWQgZG1fcmZfcGF0aGNoZWNrX3dvcmtpdGVtY2FsbGJhY2so
c3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQogewogCXN0cnVjdCBkZWxheWVkX3dvcmsgKmR3b3Jr
ID0gdG9fZGVsYXllZF93b3JrKHdvcmspOwpAQCAtMjM1Myw4ICsyMzc0LDEwIEBAIHZvaWQgZG1f
cmZfcGF0aGNoZWNrX3dvcmtpdGVtY2FsbGJhY2soc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQog
CS8qYm9vbCBiYWN0dWFsbHlfc2V0ID0gZmFsc2U7Ki8KIAl1OCByZnBhdGggPSAwLCBpOwoKLQkv
KiAyMDA4LzAxLzMwIE1IIEFmdGVyIGRpc2N1c3Npbmcgd2l0aCBTRDMgSmVycnksIDB4YzA0LzB4
ZDA0IHJlZ2lzdGVyIHdpbGwKLQkgICBhbHdheXMgYmUgdGhlIHNhbWUuIFdlIG9ubHkgcmVhZCAw
eGMwNCBub3cuICovCisJLyoKKwkgKiAyMDA4LzAxLzMwIE1IIEFmdGVyIGRpc2N1c3Npbmcgd2l0
aCBTRDMgSmVycnksIDB4YzA0LzB4ZDA0IHJlZ2lzdGVyIHdpbGwKKwkgKiBhbHdheXMgYmUgdGhl
IHNhbWUuIFdlIG9ubHkgcmVhZCAweGMwNCBub3cuCisJICovCiAJcmVhZF9uaWNfYnl0ZShkZXYs
IDB4YzA0LCAmcmZwYXRoKTsKCiAJLyogQ2hlY2sgQml0IDAtMywgaXQgbWVhbnMgaWYgUkYgQS1E
IGlzIGVuYWJsZWQuICovCkBAIC0yNTc5LDcgKzI2MDIsOCBAQCBzdGF0aWMgdm9pZCBkbV9yeHBh
dGhfc2VsX2J5cnNzaShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCX0KIH0KCi0vKi0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCisvKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIEZ1bmN0aW9uOglk
bV9jaGVja19yeF9wYXRoX3NlbGVjdGlvbigpCiAgKgogICogT3ZlcnZpZXc6CUNhbGwgYSB3b3Jr
aXRlbSB0byBjaGVjayBjdXJyZW50IFJYUkYgcGF0aCBhbmQgUnggUGF0aCBzZWxlY3Rpb24gYnkg
UlNTSS4KQEAgLTI1OTQsNyArMjYxOCw4IEBAIHN0YXRpYyB2b2lkIGRtX3J4cGF0aF9zZWxfYnly
c3NpKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiAgKglXaGVuCQlXaG8JCVJlbWFyawogICoJMDUv
MjgvMjAwOAlhbXkJCUNyZWF0ZSBWZXJzaW9uIDAgcG9ydGluZyBmcm9tIHdpbmRvd3MgY29kZS4K
ICAqCi0gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqLwog
c3RhdGljIHZvaWQgZG1fY2hlY2tfcnhfcGF0aF9zZWxlY3Rpb24oc3RydWN0IG5ldF9kZXZpY2Ug
KmRldikKIHsKIAlzdHJ1Y3QgcjgxOTJfcHJpdiAqcHJpdiA9IGllZWU4MDIxMV9wcml2KGRldik7
CkBAIC0yOTAxLDcgKzI5MjYsOCBAQCB2b2lkIGRtX2NoZWNrX2ZzeW5jKHN0cnVjdCBuZXRfZGV2
aWNlICpkZXYpCiAJfQogfQoKLS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKy8qCisgKiAtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQogICogRnVuY3Rpb246CWRtX3NoYWRvd19pbml0KCkKICAqCiAgKiBPdmVy
dmlldzoJU3RvcmUgYWxsIE5JQyBNQUMvQkIgcmVnaXN0ZXIgY29udGVudC4KQEAgLTI5MTYsNyAr
Mjk0Miw4IEBAIHZvaWQgZG1fY2hlY2tfZnN5bmMoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKICAq
CVdoZW4JCVdobwkJUmVtYXJrCiAgKgkwNS8yOS8yMDA4CWFteQkJQ3JlYXRlIFZlcnNpb24gMCBw
b3J0aW5nIGZyb20gd2luZG93cyBjb2RlLgogICoKLSAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKyAq
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQorICovCiB2b2lkIGRtX3NoYWRvd19pbml0KHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYpCiB7CiAJdTgJcGFnZTsKQEAgLTI5MzgsMTIgKzI5NjUsMTMgQEAgdm9pZCBk
bV9zaGFkb3dfaW5pdChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQoKIH0gICAvKiBkbV9zaGFkb3df
aW5pdCAqLwoKLS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRGVmaW5lIGZ1bmN0aW9uIHBy
b3RvdHlwZS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCi0vKi0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CisvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1EZWZpbmUgZnVuY3Rpb24gcHJvdG90eXBl
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCisvKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0K
ICAqIEZ1bmN0aW9uOglETV9EeW5hbWljVHhQb3dlcigpCiAgKgogICogT3ZlcnZpZXc6CURldGVj
dCBTaWduYWwgc3RyZW5ndGggdG8gY29udHJvbCBUWCBSZWdpc3RyeQotCQkJVHggUG93ZXIgQ29u
dHJvbCBGb3IgTmVhci9GYXIgUmFuZ2UKKyAqCQkJVHggUG93ZXIgQ29udHJvbCBGb3IgTmVhci9G
YXIgUmFuZ2UKICAqCiAgKiBJbnB1dDoJCU5PTkUKICAqCkBAIC0yOTU1LDcgKzI5ODMsOCBAQCB2
b2lkIGRtX3NoYWRvd19pbml0KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiAgKglXaGVuCQlXaG8J
CVJlbWFyawogICoJMDMvMDYvMjAwOAlKYWNrZW4JQ3JlYXRlIFZlcnNpb24gMC4KICAqCi0gKi0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLSovCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqLwogc3RhdGljIHZv
aWQgZG1faW5pdF9keW5hbWljX3R4cG93ZXIoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIHsKIAlz
dHJ1Y3QgcjgxOTJfcHJpdiAqcHJpdiA9IGllZWU4MDIxMV9wcml2KGRldik7CkBAIC0zMDU3LDQg
KzMwODYsNCBAQCBzdGF0aWMgdm9pZCBkbV9zZW5kX3Jzc2lfdG9mdyhzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2KQogCXdyaXRlX25pY19ieXRlKGRldiwgRFJJVkVSX1JTU0ksICh1OClwcml2LT51bmRl
Y29yYXRlZF9zbW9vdGhlZF9wd2RiKTsKIH0KCi0vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LURlZmluZSBmdW5jdGlvbiBwcm90b3R5cGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLworLyog
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRGVmaW5lIGZ1bmN0aW9uIHByb3RvdHlwZS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLSAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL3J0bDgx
OTJ1L3I4MTkyVV9kbS5oIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTkyVV9kbS5oCmlu
ZGV4IDBkZTAzMzI5MDZiZC4uZDdlZDBlYjJmZWRiIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdp
bmcvcnRsODE5MnUvcjgxOTJVX2RtLmgKKysrIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4
MTkyVV9kbS5oCkBAIC0yMSw3ICsyMSw3IEBACiAjaWZuZGVmCV9fUjgxOTJVRE1fSF9fCiAjZGVm
aW5lIF9fUjgxOTJVRE1fSF9fCgotLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLURlZmluZSBQ
YXJhbWV0ZXJzLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCisvKiAtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLURlZmluZSBQYXJhbWV0ZXJzLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLSAqLwogI2RlZmluZSAgICAgICAgIERNX0RJR19USFJFU0hfSElHSCAgICAgICAgICAg
ICAgICAgICAgICA0MAogI2RlZmluZSAgICAgICAgIERNX0RJR19USFJFU0hfTE9XICAgICAgICAg
ICAgICAgICAgICAgICAzNQoKQEAgLTU5LDkgKzU5LDkgQEAKICNkZWZpbmUgICAgICAgICBJTklU
SUFMX1RYX1JBVEVfUkVHICAgICAgICAgICAgICAgICAgMHgxYjkKICNkZWZpbmUgICAgICAgICBU
WF9SRVRSWV9DT1VOVF9SRUcgICAgICAgICAgICAgICAgICAgMHgxYWMKICNkZWZpbmUgICAgICAg
ICBSRUdfQzM4X1RIICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMjAKLS8qLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS1EZWZpbmUgUGFyYW1ldGVycy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0qLworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1EZWZpbmUgUGFyYW1ldGVy
cy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCi0vKi0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLURlZmluZSBzdHJ1Y3R1cmUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
Ki8KKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLURlZmluZSBzdHJ1Y3R1cmUtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCgogZW51bSBkaWdfYWxnb3JpdGhtIHsKIAlESUdf
QUxHT19CWV9GQUxTRV9BTEFSTSA9IDAsCkBAIC0xNDMsMTggKzE0MywxOCBAQCBzdHJ1Y3QgdHhf
Y29uZmlnX2NtZCB7CiAJdTMyICAgICBjbWRfdmFsdWU7CiB9OwoKLS8qLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tRGVmaW5lIHN0cnVjdHVyZS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0qLworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRGVmaW5lIHN0cnVjdHVyZS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCi0vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LUV4cG9ydCBnbG9iYWwgdmFyaWFibGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKy8q
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUV4cG9ydCBnbG9iYWwgdmFyaWFibGUtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tICovCiBleHRlcm4gc3RydWN0IGRpZyBkbV9kaWd0YWJsZTsKIGV4
dGVybiB1OCBkbV9zaGFkb3dbMTZdWzI1Nl07Ci0vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLUV4
cG9ydCBnbG9iYWwgdmFyaWFibGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKy8qIC0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLUV4cG9ydCBnbG9iYWwgdmFyaWFibGUtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tICovCgotLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1FeHBvcnQgTWFy
Y28gRGVmaW5pdGlvbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCisvKiAtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS1FeHBvcnQgTWFyY28gRGVmaW5pdGlvbi0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLSAqLwoKLS8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRXhwb3J0IE1hcmNvIERlZmlu
aXRpb24tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLworLyogLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tRXhwb3J0IE1hcmNvIERlZmluaXRpb24tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0g
Ki8KCi0vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tRXhwb3J0ZWQgRnVuY3Rpb24gcHJvdG90
eXBlLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
RXhwb3J0ZWQgRnVuY3Rpb24gcHJvdG90eXBlLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCiB2b2lk
IGluaXRfaGFsX2RtKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpOwogdm9pZCBkZWluaXRfaGFsX2Rt
KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpOwogdm9pZCBoYWxfZG1fd2F0Y2hkb2coc3RydWN0IG5l
dF9kZXZpY2UgKmRldik7CkBAIC0xNzEsOCArMTcxLDggQEAgdm9pZCBkbV9mc3luY190aW1lcl9j
YWxsYmFjayhzdHJ1Y3QgdGltZXJfbGlzdCAqdCk7CiB2b2lkIGRtX2Nja190eHBvd2VyX2FkanVz
dChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBib29sICBiaW5jaDE0KTsKIHZvaWQgZG1fc2hhZG93
X2luaXQoc3RydWN0IG5ldF9kZXZpY2UgKmRldik7CiB2b2lkIGRtX2luaXRpYWxpemVfdHhwb3dl
cl90cmFja2luZyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KTsKLS8qLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS1FeHBvcnRlZCBGdW5jdGlvbiBwcm90b3R5cGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0q
LworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1FeHBvcnRlZCBGdW5jdGlvbiBwcm90b3R5
cGUtLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCi0jZW5kaWYJLypfX1I4MTkyVURNX0hfXyAqLwor
I2VuZGlmCS8qIF9fUjgxOTJVRE1fSF9fICovCgogLyogRW5kIG9mIHI4MTkyVV9kbS5oICovCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOTJVX2h3LmggYi9kcml2ZXJz
L3N0YWdpbmcvcnRsODE5MnUvcjgxOTJVX2h3LmgKaW5kZXggOTVhMmQyZWUzYzY1Li43OWQ0NjI4
OTRmMWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5MlVfaHcuaAor
KysgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOTJVX2h3LmgKQEAgLTM5LDIxICszOSwy
MSBAQAoKICNkZWZpbmUgRUVQUk9NX1RYX1BPV0VSX0RJRkYJMHgxRgogI2RlZmluZSBFRVBST01f
VEhFUk1BTF9NRVRFUgkweDIwCi0jZGVmaW5lIEVFUFJPTV9QV19ESUZGCQkweDIxCS8vMHgyMQot
I2RlZmluZSBFRVBST01fQ1JZU1RBTF9DQVAJMHgyMgkvLzB4MjIKKyNkZWZpbmUgRUVQUk9NX1BX
X0RJRkYJCTB4MjEJLyogMHgyMSAqLworI2RlZmluZSBFRVBST01fQ1JZU1RBTF9DQVAJMHgyMgkv
KiAweDIyICovCgotI2RlZmluZSBFRVBST01fVFhfUFdfSU5ERVhfQ0NLCTB4MjMJLy8weDIzCi0j
ZGVmaW5lIEVFUFJPTV9UWF9QV19JTkRFWF9PRkRNXzI0RwkweDI0CS8vMHgyNH4weDI2Ci0jZGVm
aW5lIEVFUFJPTV9UWF9QV19JTkRFWF9DQ0tfVjEJMHgyOQkvLzB4Mjl+MHgyQgotI2RlZmluZSBF
RVBST01fVFhfUFdfSU5ERVhfT0ZETV8yNEdfVjEJMHgyQwkvLzB4MkN+MHgyRQotI2RlZmluZSBF
RVBST01fVFhfUFdfSU5ERVhfVkVSCQkweDI3CS8vMHgyNworI2RlZmluZSBFRVBST01fVFhfUFdf
SU5ERVhfQ0NLCTB4MjMJLyogMHgyMyAqLworI2RlZmluZSBFRVBST01fVFhfUFdfSU5ERVhfT0ZE
TV8yNEcJMHgyNAkvKiAweDI0fjB4MjYgKi8KKyNkZWZpbmUgRUVQUk9NX1RYX1BXX0lOREVYX0ND
S19WMQkweDI5CS8qIDB4Mjl+MHgyQiAqLworI2RlZmluZSBFRVBST01fVFhfUFdfSU5ERVhfT0ZE
TV8yNEdfVjEJMHgyQwkvKiAweDJDfjB4MkUgKi8KKyNkZWZpbmUgRUVQUk9NX1RYX1BXX0lOREVY
X1ZFUgkJMHgyNwkvKiAweDI3ICovCgogI2RlZmluZSBFRVBST01fREVGQVVMVF9USEVSTkFMX01F
VEVSCQkweDcKICNkZWZpbmUgRUVQUk9NX0RFRkFVTFRfUFdfRElGRgkJCTB4NAogI2RlZmluZSBF
RVBST01fREVGQVVMVF9DUllTVEFMX0NBUAkJMHg1CiAjZGVmaW5lIEVFUFJPTV9ERUZBVUxUX1RY
X1BPV0VSCQkweDEwMTAKLSNkZWZpbmUgRUVQUk9NX0NVU1RPTUVSX0lECQkJMHg3QgkvLzB4N0I6
Q3VzdG9tZXJJRAotI2RlZmluZSBFRVBST01fQ0hBTk5FTF9QTEFOCQkJMHgxNgkvLzB4N0MKKyNk
ZWZpbmUgRUVQUk9NX0NVU1RPTUVSX0lECQkJMHg3QgkvKiAweDdCOkN1c3RvbWVySUQgKi8KKyNk
ZWZpbmUgRUVQUk9NX0NIQU5ORUxfUExBTgkJCTB4MTYJLyogMHg3QyAqLwoKICNkZWZpbmUgRUVQ
Uk9NX0NJRF9SVU5UT1AJCQkJMHgyCiAjZGVmaW5lIEVFUFJPTV9DSURfRExJTksJCQkJMHg4CkBA
IC02MywyNSArNjMsMjQgQEAKICNkZWZpbmUgQUNfUEFSQU1fRUNXX01JTl9PRkZTRVQJCTgKICNk
ZWZpbmUgQUNfUEFSQU1fQUlGU19PRkZTRVQJCTAKCi0vLyNlbmRpZgogZW51bSBfUlRMODE5MlVz
Yl9IVyB7CiAJTUFDMAkJCT0gMHgwMDAsCiAJTUFDNAkJCT0gMHgwMDQsCgogI2RlZmluZQlCQl9H
TE9CQUxfUkVTRVRfQklUCTB4MQotCUJCX0dMT0JBTF9SRVNFVAkJPSAweDAyMCwgLy8gQmFzZWJh
bmRHbG9iYWwgUmVzZXQgUmVnaXN0ZXIKLQlCU1NJRFIJCQk9IDB4MDJFLCAvLyBCU1NJRCBSZWdp
c3RlcgotCUNNRFIJCQk9IDB4MDM3LCAvLyBDb21tYW5kIHJlZ2lzdGVyCisJQkJfR0xPQkFMX1JF
U0VUCQk9IDB4MDIwLCAvKiBCYXNlYmFuZEdsb2JhbCBSZXNldCBSZWdpc3RlciAqLworCUJTU0lE
UgkJCT0gMHgwMkUsIC8qIEJTU0lEIFJlZ2lzdGVyICovCisJQ01EUgkJCT0gMHgwMzcsIC8qIENv
bW1hbmQgcmVnaXN0ZXIgKi8KICNkZWZpbmUgQ1JfUkUJCQkweDA4CiAjZGVmaW5lIENSX1RFCQkJ
MHgwNAotCVNJRlMJCQk9IDB4MDNFLCAvLyBTSUZTIHJlZ2lzdGVyCisJU0lGUwkJCT0gMHgwM0Us
IC8qIFNJRlMgcmVnaXN0ZXIgKi8KCiAjZGVmaW5lIFRDUl9NWERNQV8yMDQ4CQk3CiAjZGVmaW5l
IFRDUl9MUkxfT0ZGU0VUCQkwCiAjZGVmaW5lIFRDUl9TUkxfT0ZGU0VUCQk4CiAjZGVmaW5lIFRD
Ul9NWERNQV9PRkZTRVQJMjEKLSNkZWZpbmUgVENSX1NBVAkJCUJJVCgyNCkJLy8gRW5hYmxlIFJh
dGUgZGVwZWRlbnQgYWNrIHRpbWVvdXQgdGltZXIKLQlSQ1IJCQk9IDB4MDQ0LCAvLyBSZWNlaXZl
IENvbmZpZ3VyYXRpb24gUmVnaXN0ZXIKKyNkZWZpbmUgVENSX1NBVAkJCUJJVCgyNCkJLyogRW5h
YmxlIFJhdGUgZGVwZWRlbnQgYWNrIHRpbWVvdXQgdGltZXIgKi8KKwlSQ1IJCQk9IDB4MDQ0LCAv
KiBSZWNlaXZlIENvbmZpZ3VyYXRpb24gUmVnaXN0ZXIgKi8KICNkZWZpbmUgTUFDX0ZJTFRFUl9N
QVNLIChCSVQoMCkgfCBCSVQoMSkgfCBCSVQoMikgfCBCSVQoMykgfCBCSVQoNSkgfCBcCiAJCQkg
QklUKDEyKSB8IEJJVCgxOCkgfCBCSVQoMTkpIHwgQklUKDIwKSB8IEJJVCgyMSkgfCBcCiAJCQkg
QklUKDIyKSB8IEJJVCgyMykpCkBAIC05MSw0NSArOTAsNDcgQEAgZW51bSBfUlRMODE5MlVzYl9I
VyB7CiAjZGVmaW5lIE1BWF9SWF9ETUFfTUFTSyAJKEJJVCg4KSB8IEJJVCg5KSB8IEJJVCgxMCkp
CiAjZGVmaW5lIFJDUl9NWERNQV9PRkZTRVQJOAogI2RlZmluZSBSQ1JfRklGT19PRkZTRVQJCTEz
Ci0jZGVmaW5lIFJDUl9PTkxZRVJMUEtUCQlCSVQoMzEpCQkJLy8gRWFybHkgUmVjZWl2aW5nIGJh
c2VkIG9uIFBhY2tldCBTaXplLgotI2RlZmluZSBSQ1JfQ0JTU0lECQlCSVQoMjMpCQkJLy8gQWNj
ZXB0IEJTU0lEIG1hdGNoIHBhY2tldAotI2RlZmluZSBSQ1JfQVBXUk1HVAkJQklUKDIyKQkJCS8v
IEFjY2VwdCBwb3dlciBtYW5hZ2VtZW50IHBhY2tldAotI2RlZmluZSBSQ1JfQU1GCQkJQklUKDIw
KQkJCS8vIEFjY2VwdCBtYW5hZ2VtZW50IHR5cGUgZnJhbWUKLSNkZWZpbmUgUkNSX0FDRgkJCUJJ
VCgxOSkJCQkvLyBBY2NlcHQgY29udHJvbCB0eXBlIGZyYW1lCi0jZGVmaW5lIFJDUl9BREYJCQlC
SVQoMTgpCQkJLy8gQWNjZXB0IGRhdGEgdHlwZSBmcmFtZQotI2RlZmluZSBSQ1JfQUlDVgkJQklU
KDEyKQkJCS8vIEFjY2VwdCBJQ1YgZXJyb3IgcGFja2V0Ci0jZGVmaW5lCVJDUl9BQ1JDMzIJCUJJ
VCg1KQkJCS8vIEFjY2VwdCBDUkMzMiBlcnJvciBwYWNrZXQKLSNkZWZpbmUJUkNSX0FCCQkJQklU
KDMpCQkJLy8gQWNjZXB0IGJyb2FkY2FzdCBwYWNrZXQKLSNkZWZpbmUJUkNSX0FNCQkJQklUKDIp
CQkJLy8gQWNjZXB0IG11bHRpY2FzdCBwYWNrZXQKLSNkZWZpbmUJUkNSX0FQTQkJCUJJVCgxKQkJ
CS8vIEFjY2VwdCBwaHlzaWNhbCBtYXRjaCBwYWNrZXQKLSNkZWZpbmUJUkNSX0FBUAkJCUJJVCgw
KQkJCS8vIEFjY2VwdCBhbGwgdW5pY2FzdCBwYWNrZXQKLQlTTE9UX1RJTUUJCT0gMHgwNDksIC8v
IFNsb3QgVGltZSBSZWdpc3RlcgotCUFDS19USU1FT1VUCQk9IDB4MDRjLCAvLyBBY2sgVGltZW91
dCBSZWdpc3RlcgotCUVEQ0FQQVJBX0JFCQk9IDB4MDUwLCAvLyBFRENBIFBhcmFtZXRlciBvZiBB
QyBCRQotCUVEQ0FQQVJBX0JLCQk9IDB4MDU0LCAvLyBFRENBIFBhcmFtZXRlciBvZiBBQyBCSwot
CUVEQ0FQQVJBX1ZPCQk9IDB4MDU4LCAvLyBFRENBIFBhcmFtZXRlciBvZiBBQyBWTwotCUVEQ0FQ
QVJBX1ZJCQk9IDB4MDVDLCAvLyBFRENBIFBhcmFtZXRlciBvZiBBQyBWSQotCUJDTl9UQ0ZHCQk9
IDB4MDYyLCAvLyBCZWFjb24gVGltZSBDb25maWd1cmF0aW9uCisjZGVmaW5lIFJDUl9PTkxZRVJM
UEtUCQlCSVQoMzEpCQkJLyogRWFybHkgUmVjZWl2aW5nIGJhc2VkIG9uIFBhY2tldCBTaXplLiAq
LworI2RlZmluZSBSQ1JfQ0JTU0lECQlCSVQoMjMpCQkJLyogQWNjZXB0IEJTU0lEIG1hdGNoIHBh
Y2tldCAqLworI2RlZmluZSBSQ1JfQVBXUk1HVAkJQklUKDIyKQkJCS8qIEFjY2VwdCBwb3dlciBt
YW5hZ2VtZW50IHBhY2tldCAqLworI2RlZmluZSBSQ1JfQU1GCQkJQklUKDIwKQkJCS8qIEFjY2Vw
dCBtYW5hZ2VtZW50IHR5cGUgZnJhbWUgKi8KKyNkZWZpbmUgUkNSX0FDRgkJCUJJVCgxOSkJCQkv
KiBBY2NlcHQgY29udHJvbCB0eXBlIGZyYW1lICovCisjZGVmaW5lIFJDUl9BREYJCQlCSVQoMTgp
CQkJLyogQWNjZXB0IGRhdGEgdHlwZSBmcmFtZSAqLworI2RlZmluZSBSQ1JfQUlDVgkJQklUKDEy
KQkJCS8qIEFjY2VwdCBJQ1YgZXJyb3IgcGFja2V0ICovCisjZGVmaW5lCVJDUl9BQ1JDMzIJCUJJ
VCg1KQkJCS8qIEFjY2VwdCBDUkMzMiBlcnJvciBwYWNrZXQgKi8KKyNkZWZpbmUJUkNSX0FCCQkJ
QklUKDMpCQkJLyogQWNjZXB0IGJyb2FkY2FzdCBwYWNrZXQgKi8KKyNkZWZpbmUJUkNSX0FNCQkJ
QklUKDIpCQkJLyogQWNjZXB0IG11bHRpY2FzdCBwYWNrZXQgKi8KKyNkZWZpbmUJUkNSX0FQTQkJ
CUJJVCgxKQkJCS8qIEFjY2VwdCBwaHlzaWNhbCBtYXRjaCBwYWNrZXQgKi8KKyNkZWZpbmUJUkNS
X0FBUAkJCUJJVCgwKQkJCS8qIEFjY2VwdCBhbGwgdW5pY2FzdCBwYWNrZXQgKi8KKwlTTE9UX1RJ
TUUJCT0gMHgwNDksIC8qIFNsb3QgVGltZSBSZWdpc3RlciAqLworCUFDS19USU1FT1VUCQk9IDB4
MDRjLCAvKiBBY2sgVGltZW91dCBSZWdpc3RlciAqLworCUVEQ0FQQVJBX0JFCQk9IDB4MDUwLCAv
KiBFRENBIFBhcmFtZXRlciBvZiBBQyBCRSAqLworCUVEQ0FQQVJBX0JLCQk9IDB4MDU0LCAvKiBF
RENBIFBhcmFtZXRlciBvZiBBQyBCSyAqLworCUVEQ0FQQVJBX1ZPCQk9IDB4MDU4LCAvKiBFRENB
IFBhcmFtZXRlciBvZiBBQyBWTyAqLworCUVEQ0FQQVJBX1ZJCQk9IDB4MDVDLCAvKiBFRENBIFBh
cmFtZXRlciBvZiBBQyBWSSAqLworCUJDTl9UQ0ZHCQk9IDB4MDYyLCAvKiBCZWFjb24gVGltZSBD
b25maWd1cmF0aW9uICovCiAjZGVmaW5lIEJDTl9UQ0ZHX0NXX1NISUZUCQk4CiAjZGVmaW5lIEJD
Tl9UQ0ZHX0lGUwkJCTAKLQlCQ05fSU5URVJWQUwJCT0gMHgwNzAsIC8vIEJlYWNvbiBJbnRlcnZh
bCAoVFUpCi0JQVRJTVdORAkJCT0gMHgwNzIsIC8vIEFUSU0gV2luZG93IFNpemUgKFRVKQotCUJD
Tl9EUlZfRUFSTFlfSU5UCT0gMHgwNzQsIC8vIERyaXZlciBFYXJseSBJbnRlcnJ1cHQgVGltZSAo
VFUpLiBUaW1lIHRvIHNlbmQgaW50ZXJydXB0IHRvIG5vdGlmeSB0byBjaGFuZ2UgYmVhY29uIGNv
bnRlbnQgYmVmb3JlIFRCVFQKLQlCQ05fRE1BVElNRQkJPSAweDA3NiwgLy8gQmVhY29uIERNQSBh
bmQgQVRJTSBpbnRlcnJ1cHQgdGltZSAoVVMpLiBJbmRpY2F0ZXMgdGhlIHRpbWUgYmVmb3JlIFRC
VFQgdG8gcGVyZm9ybSBiZWFjb24gcXVldWUgRE1BCi0JQkNOX0VSUl9USFJFU0gJCT0gMHgwNzgs
IC8vIEJlYWNvbiBFcnJvciBUaHJlc2hvbGQKLQlSV0NBTQkJCT0gMHgwQTAsIC8vSU4gODE5MCBE
YXRhIFNoZWV0IGlzIGNhbGxlZCBDQU1jbWQKLQlXQ0FNSQkJCT0gMHgwQTQsIC8vIFNvZnR3YXJl
IHdyaXRlIENBTSBpbnB1dCBjb250ZW50Ci0JU0VDUgkJCT0gMHgwQjAsIC8vU2VjdXJpdHkgQ29u
ZmlndXJhdGlvbiBSZWdpc3RlcgotI2RlZmluZQlTQ1JfVHhVc2VESwkJQklUKDApCQkJLy9Gb3Jj
ZSBUeCBVc2UgRGVmYXVsdCBLZXkKLSNkZWZpbmUgU0NSX1J4VXNlREsJCUJJVCgxKQkJCS8vRm9y
Y2UgUnggVXNlIERlZmF1bHQgS2V5Ci0jZGVmaW5lIFNDUl9UeEVuY0VuYWJsZQkJQklUKDIpCQkJ
Ly9FbmFibGUgVHggRW5jcnlwdGlvbgotI2RlZmluZSBTQ1JfUnhEZWNFbmFibGUJCUJJVCgzKQkJ
CS8vRW5hYmxlIFJ4IERlY3J5cHRpb24KLSNkZWZpbmUgU0NSX1NLQnlBMgkJQklUKDQpCQkJLy9T
ZWFyY2gga0VZIEJZIEEyCi0jZGVmaW5lIFNDUl9Ob1NLTUMJCUJJVCg1KQkJCS8vTm8gS2V5IFNl
YXJjaCBmb3IgTXVsdGljYXN0Ci0KLS8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLy8gICAgICAgODE5
MCBDUFUgR2VuZXJhbCBSZWdpc3RlcgkJKG9mZnNldCAweDEwMCwgNCBieXRlKQotLy8tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCisJQkNOX0lOVEVSVkFMCQk9IDB4MDcwLCAvKiBCZWFjb24gSW50ZXJ2YWwg
KFRVKSAqLworCUFUSU1XTkQJCQk9IDB4MDcyLCAvKiBBVElNIFdpbmRvdyBTaXplIChUVSkgKi8K
KwlCQ05fRFJWX0VBUkxZX0lOVAk9IDB4MDc0LCAvKiBEcml2ZXIgRWFybHkgSW50ZXJydXB0IFRp
bWUgKFRVKS4gVGltZSB0byBzZW5kIGludGVycnVwdCB0byBub3RpZnkgdG8gY2hhbmdlIGJlYWNv
biBjb250ZW50IGJlZm9yZSBUQlRUICovCisJQkNOX0RNQVRJTUUJCT0gMHgwNzYsIC8qIEJlYWNv
biBETUEgYW5kIEFUSU0gaW50ZXJydXB0IHRpbWUgKFVTKS4gSW5kaWNhdGVzIHRoZSB0aW1lIGJl
Zm9yZSBUQlRUIHRvIHBlcmZvcm0gYmVhY29uIHF1ZXVlIERNQSAqLworCUJDTl9FUlJfVEhSRVNI
CQk9IDB4MDc4LCAvKiBCZWFjb24gRXJyb3IgVGhyZXNob2xkICovCisJUldDQU0JCQk9IDB4MEEw
LCAvKiBJTiA4MTkwIERhdGEgU2hlZXQgaXMgY2FsbGVkIENBTWNtZCAqLworCVdDQU1JCQkJPSAw
eDBBNCwgLyogU29mdHdhcmUgd3JpdGUgQ0FNIGlucHV0IGNvbnRlbnQgKi8KKwlTRUNSCQkJPSAw
eDBCMCwgLyogU2VjdXJpdHkgQ29uZmlndXJhdGlvbiBSZWdpc3RlciAqLworI2RlZmluZQlTQ1Jf
VHhVc2VESwkJQklUKDApCQkJLyogRm9yY2UgVHggVXNlIERlZmF1bHQgS2V5ICovCisjZGVmaW5l
IFNDUl9SeFVzZURLCQlCSVQoMSkJCQkvKiBGb3JjZSBSeCBVc2UgRGVmYXVsdCBLZXkgKi8KKyNk
ZWZpbmUgU0NSX1R4RW5jRW5hYmxlCQlCSVQoMikJCQkvKiBFbmFibGUgVHggRW5jcnlwdGlvbiAq
LworI2RlZmluZSBTQ1JfUnhEZWNFbmFibGUJCUJJVCgzKQkJCS8qIEVuYWJsZSBSeCBEZWNyeXB0
aW9uICovCisjZGVmaW5lIFNDUl9TS0J5QTIJCUJJVCg0KQkJCS8qIFNlYXJjaCBrRVkgQlkgQTIg
Ki8KKyNkZWZpbmUgU0NSX05vU0tNQwkJQklUKDUpCQkJLyogTm8gS2V5IFNlYXJjaCBmb3IgTXVs
dGljYXN0ICovCisKKy8qCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiAgICAgICA4MTkwIENQ
VSBHZW5lcmFsIFJlZ2lzdGVyCQkob2Zmc2V0IDB4MTAwLCA0IGJ5dGUpCisgKiAtLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCisgKi8KICNkZWZpbmUJQ1BVX0NDS19MT09QQkFDSwkweDAwMDMwMDAwCiAjZGVm
aW5lCUNQVV9HRU5fU1lTVEVNX1JFU0VUCTB4MDAwMDAwMDEKICNkZWZpbmUJQ1BVX0dFTl9GSVJN
V0FSRV9SRVNFVAkweDAwMDAwMDA4CkBAIC0xMzgsMzcgKzEzOSwzOCBAQCBlbnVtIF9SVEw4MTky
VXNiX0hXIHsKICNkZWZpbmUJQ1BVX0dFTl9QVVRfQ09ERV9PSwkweDAwMDAwMDgwCiAjZGVmaW5l
CUNQVV9HRU5fQkJfUlNUCQkweDAwMDAwMTAwCiAjZGVmaW5lCUNQVV9HRU5fUFdSX1NUQl9DUFUJ
MHgwMDAwMDAwNAotI2RlZmluZSBDUFVfR0VOX05PX0xPT1BCQUNLX01TSwkweEZGRjhGRkZGIC8v
IFNldCBiaXQxOCwxNywxNiB0byAwLiBTZXQgYml0MTkKLSNkZWZpbmUgQ1BVX0dFTl9OT19MT09Q
QkFDS19TRVQJMHgwMDA4MDAwMCAvLyBTZXQgQklUMTkgdG8gMQotCUNQVV9HRU4JCQk9IDB4MTAw
LCAvLyBDUFUgUmVzZXQgUmVnaXN0ZXIKLQotCUFjbUh3Q3RybAkJPSAweDE3MSwgLy8gQUNNIEhh
cmR3YXJlIENvbnRyb2wgUmVnaXN0ZXIKLS8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLy8vLwotLy8v
LyAgICAgICA4MTkwIEFjbUh3Q3RybCBiaXRzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKG9mZnNldCAweDE3MSwgMSBieXRlKQotLy8vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS8v
CisjZGVmaW5lIENQVV9HRU5fTk9fTE9PUEJBQ0tfTVNLCTB4RkZGOEZGRkYgLyogU2V0IGJpdDE4
LDE3LDE2IHRvIDAuIFNldCBiaXQxOSAqLworI2RlZmluZSBDUFVfR0VOX05PX0xPT1BCQUNLX1NF
VAkweDAwMDgwMDAwIC8qIFNldCBCSVQxOSB0byAxICovCisJQ1BVX0dFTgkJCT0gMHgxMDAsIC8q
IENQVSBSZXNldCBSZWdpc3RlciAqLworCisJQWNtSHdDdHJsCQk9IDB4MTcxLCAvKiBBQ00gSGFy
ZHdhcmUgQ29udHJvbCBSZWdpc3RlciAqLworLyoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAq
CisgKiAgICAgICAgIDgxOTAgQWNtSHdDdHJsIGJpdHMgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAob2Zmc2V0IDB4MTcxLCAxIGJ5dGUpCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CisgKi8KICNkZWZpbmUgQWNtSHdfQmVxRW4gICAgICAgICAgICAgQklUKDEpCgotCVJRUE4xCQkJ
PSAweDE4MCwgLy8gUmVzZXJ2ZWQgUXVldWUgUGFnZSBOdW1iZXIgLCBWbyBWaSwgQmUsIEJrCi0J
UlFQTjIJCQk9IDB4MTg0LCAvLyBSZXNlcnZlZCBRdWV1ZSBQYWdlIE51bWJlciwgSENDQSwgQ21k
LCBNZ250LCBIaWdoCi0JUlFQTjMJCQk9IDB4MTg4LCAvLyBSZXNlcnZlZCBRdWV1ZSBQYWdlIE51
bWJlciwgQmNuLCBQdWJsaWMsCi0JUVBOUgkJCT0gMHgxRDAsIC8vMHgxRjAsIC8vIFF1ZXVlIFBh
Y2tldCBOdW1iZXIgcmVwb3J0IHBlciBUSUQKKwlSUVBOMQkJCT0gMHgxODAsIC8qIFJlc2VydmVk
IFF1ZXVlIFBhZ2UgTnVtYmVyICwgVm8gVmksIEJlLCBCayAqLworCVJRUE4yCQkJPSAweDE4NCwg
LyogUmVzZXJ2ZWQgUXVldWUgUGFnZSBOdW1iZXIsIEhDQ0EsIENtZCwgTWdudCwgSGlnaCAqLwor
CVJRUE4zCQkJPSAweDE4OCwgLyogUmVzZXJ2ZWQgUXVldWUgUGFnZSBOdW1iZXIsIEJjbiwgUHVi
bGljLCAqLworCVFQTlIJCQk9IDB4MUQwLCAvKiAweDFGMCwgUXVldWUgUGFja2V0IE51bWJlciBy
ZXBvcnQgcGVyIFRJRCAqLwoKICNkZWZpbmUJQldfT1BNT0RFXzVHCQkJQklUKDEpCiAjZGVmaW5l
CUJXX09QTU9ERV8yME1IWgkJCUJJVCgyKQotCUJXX09QTU9ERQkJPSAweDMwMCwgLy8gQmFuZHdp
ZHRoIG9wZXJhdGlvbiBtb2RlCi0JTVNSCQkJPSAweDMwMywgLy8gTWVkaWEgU3RhdHVzIHJlZ2lz
dGVyCisJQldfT1BNT0RFCQk9IDB4MzAwLCAvKiBCYW5kd2lkdGggb3BlcmF0aW9uIG1vZGUgKi8K
KwlNU1IJCQk9IDB4MzAzLCAvKiBNZWRpYSBTdGF0dXMgcmVnaXN0ZXIgKi8KICNkZWZpbmUgTVNS
X0xJTktfTUFTSyAgICAgIChCSVQoMCl8QklUKDEpKQogI2RlZmluZSBNU1JfTElOS19NQU5BR0VE
ICAgMgogI2RlZmluZSBNU1JfTElOS19OT05FICAgICAgMAogI2RlZmluZSBNU1JfTElOS19TSElG
VCAgICAgMAogI2RlZmluZSBNU1JfTElOS19BREhPQyAgICAgMQogI2RlZmluZSBNU1JfTElOS19N
QVNURVIgICAgMwotCVJFVFJZX0xJTUlUCQk9IDB4MzA0LCAvLyBSZXRyeSBMaW1pdCBbMTU6OF0t
c2hvcnQsIFs3OjBdLWxvbmcKKwlSRVRSWV9MSU1JVAkJPSAweDMwNCwgLyogUmV0cnkgTGltaXQg
WzE1OjhdLXNob3J0LCBbNzowXS1sb25nICovCiAjZGVmaW5lIFJFVFJZX0xJTUlUX1NIT1JUX1NI
SUZUIDgKICNkZWZpbmUgUkVUUllfTElNSVRfTE9OR19TSElGVCAwCi0JUlJTUgkJCT0gMHgzMTAs
IC8vIFJlc3BvbnNlIFJhdGUgU2V0CisJUlJTUgkJCT0gMHgzMTAsIC8qIFJlc3BvbnNlIFJhdGUg
U2V0ICovCiAjZGVmaW5lIFJSU1JfMU0JCQkJCQlCSVQoMCkKICNkZWZpbmUgUlJTUl8yTQkJCQkJ
CUJJVCgxKQogI2RlZmluZSBSUlNSXzVfNU0JCQkJCUJJVCgyKQpAQCAtMTgxLDE5ICsxODMsMjEg
QEAgZW51bSBfUlRMODE5MlVzYl9IVyB7CiAjZGVmaW5lIFJSU1JfMzZNCQkJCQlCSVQoOSkKICNk
ZWZpbmUgUlJTUl80OE0JCQkJCUJJVCgxMCkKICNkZWZpbmUgUlJTUl81NE0JCQkJCUJJVCgxMSkK
LSNkZWZpbmUgQlJTUl9BY2tTaG9ydFBtYgkJCUJJVCgyMykJCS8vIENDSyBBQ0s6IHVzZSBTaG9y
dCBQcmVhbWJsZSBvciBub3QuCisjZGVmaW5lIEJSU1JfQWNrU2hvcnRQbWIJCQlCSVQoMjMpCQkv
KiBDQ0sgQUNLOiB1c2UgU2hvcnQgUHJlYW1ibGUgb3Igbm90LiAqLwogCVVGV1AJCQk9IDB4MzE4
LAotCVJBVFIwCQkJPSAweDMyMCwgLy8gUmF0ZSBBZGFwdGl2ZSBUYWJsZSByZWdpc3RlcjEKLQlE
UklWRVJfUlNTSQkJPSAweDMyYywJCQkJCS8vIERyaXZlciB0ZWxsIEZpcm13YXJlIGN1cnJlbnQg
UlNTSQotLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0vLyAgICAgICA4MTkwIFJhdGUgQWRhcHRpdmUg
VGFibGUgUmVnaXN0ZXIJKG9mZnNldCAweDMyMCwgNCBieXRlKQotLy8tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCi0vL0NDSworCVJBVFIwCQkJPSAweDMyMCwgLyogUmF0ZSBBZGFwdGl2ZSBUYWJsZSByZWdp
c3RlcjEgKi8KKwlEUklWRVJfUlNTSQkJPSAweDMyYywJCQkJCS8qIERyaXZlciB0ZWxsIEZpcm13
YXJlIGN1cnJlbnQgUlNTSSAqLworLyoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqICAgICAg
ICA4MTkwIFJhdGUgQWRhcHRpdmUgVGFibGUgUmVnaXN0ZXIJKG9mZnNldCAweDMyMCwgNCBieXRl
KQorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICovCisvKiBDQ0sgKi8KICNkZWZpbmUJUkFUUl8x
TQkJCTB4MDAwMDAwMDEKICNkZWZpbmUJUkFUUl8yTQkJCTB4MDAwMDAwMDIKICNkZWZpbmUJUkFU
Ul81NU0JCTB4MDAwMDAwMDQKICNkZWZpbmUJUkFUUl8xMU0JCTB4MDAwMDAwMDgKLS8vT0ZETQor
LyogT0ZETSAqLwogI2RlZmluZQlSQVRSXzZNCQkJMHgwMDAwMDAxMAogI2RlZmluZQlSQVRSXzlN
CQkJMHgwMDAwMDAyMAogI2RlZmluZQlSQVRSXzEyTQkJMHgwMDAwMDA0MApAQCAtMjAyLDcgKzIw
Niw3IEBAIGVudW0gX1JUTDgxOTJVc2JfSFcgewogI2RlZmluZQlSQVRSXzM2TQkJMHgwMDAwMDIw
MAogI2RlZmluZQlSQVRSXzQ4TQkJMHgwMDAwMDQwMAogI2RlZmluZQlSQVRSXzU0TQkJMHgwMDAw
MDgwMAotLy9NQ1MgMSBTcGF0aWFsIFN0cmVhbQorLyogTUNTIDEgU3BhdGlhbCBTdHJlYW0gKi8K
ICNkZWZpbmUJUkFUUl9NQ1MwCQkweDAwMDAxMDAwCiAjZGVmaW5lCVJBVFJfTUNTMQkJMHgwMDAw
MjAwMAogI2RlZmluZQlSQVRSX01DUzIJCTB4MDAwMDQwMDAKQEAgLTIxMSw3ICsyMTUsNyBAQCBl
bnVtIF9SVEw4MTkyVXNiX0hXIHsKICNkZWZpbmUJUkFUUl9NQ1M1CQkweDAwMDIwMDAwCiAjZGVm
aW5lCVJBVFJfTUNTNgkJMHgwMDA0MDAwMAogI2RlZmluZQlSQVRSX01DUzcJCTB4MDAwODAwMDAK
LS8vTUNTIDIgU3BhdGlhbCBTdHJlYW0KKy8qIE1DUyAyIFNwYXRpYWwgU3RyZWFtICovCiAjZGVm
aW5lCVJBVFJfTUNTOAkJMHgwMDEwMDAwMAogI2RlZmluZQlSQVRSX01DUzkJCTB4MDAyMDAwMDAK
ICNkZWZpbmUJUkFUUl9NQ1MxMAkJMHgwMDQwMDAwMApAQCAtMjIwLDcgKzIyNCw3IEBAIGVudW0g
X1JUTDgxOTJVc2JfSFcgewogI2RlZmluZQlSQVRSX01DUzEzCQkweDAyMDAwMDAwCiAjZGVmaW5l
CVJBVFJfTUNTMTQJCTB4MDQwMDAwMDAKICNkZWZpbmUJUkFUUl9NQ1MxNQkJMHgwODAwMDAwMAot
Ly8gQUxMIENDSyBSYXRlCisvKiBBTEwgQ0NLIFJhdGUgKi8KICNkZWZpbmUgUkFURV9BTExfQ0NL
CQlSQVRSXzFNfFJBVFJfMk18UkFUUl81NU18UkFUUl8xMU0KICNkZWZpbmUgUkFURV9BTExfT0ZE
TV9BRwlSQVRSXzZNfFJBVFJfOU18UkFUUl8xMk18UkFUUl8xOE18UkFUUl8yNE1cCiAJCQkJCQkJ
fFJBVFJfMzZNfFJBVFJfNDhNfFJBVFJfNTRNCkBAIC0yMzksOCArMjQzLDEwIEBAIGVudW0gX1JU
TDgxOTJVc2JfSFcgewogI2RlZmluZSBFUFJPTV9XX0JJVCAgQklUKDEpCiAjZGVmaW5lIEVQUk9N
X1JfQklUICBCSVQoMCkKIH07Ci0vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS8vICAgICAgIDgxOHhC
IEFuYVBhcm0gJiBBbmFQYXJtMiBSZWdpc3RlcgotLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisvKgor
ICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogICAgICAgODE4eEIgQW5hUGFybSAmIEFuYVBhcm0y
IFJlZ2lzdGVyCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKi8KICNkZWZpbmUgR1BJIDB4MTA4
CiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5MlVfd3gu
YyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5MlVfd3guYwppbmRleCA1ODIyYmI3OTg0
YjkuLmFkYjlmZThhNzlkYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4
MTkyVV93eC5jCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5MlVfd3guYwpAQCAt
MjAwLDcgKzIwMCw4IEBAIHN0YXRpYyBpbnQgcjgxOTJfd3hfc2V0X21vZGUoc3RydWN0IG5ldF9k
ZXZpY2UgKmRldiwgc3RydWN0IGl3X3JlcXVlc3RfaW5mbyAqYSwKIHN0cnVjdCAgaXdfcmFuZ2Vf
d2l0aF9zY2FuX2NhcGEgewogCS8qIEluZm9ybWF0aXZlIHN0dWZmICh0byBjaG9vc2UgYmV0d2Vl
biBkaWZmZXJlbnQgaW50ZXJmYWNlKSAqLwogCV9fdTMyICAgICAgICAgICB0aHJvdWdocHV0OyAg
ICAgLyogVG8gZ2l2ZSBhbiBpZGVhLi4uICovCi0JLyogSW4gdGhlb3J5IHRoaXMgdmFsdWUgc2hv
dWxkIGJlIHRoZSBtYXhpbXVtIGJlbmNobWFya2VkCisJLyoKKwkgKiBJbiB0aGVvcnkgdGhpcyB2
YWx1ZSBzaG91bGQgYmUgdGhlIG1heGltdW0gYmVuY2htYXJrZWQKIAkgKiBUQ1AvSVAgdGhyb3Vn
aHB1dCwgYmVjYXVzZSB3aXRoIG1vc3Qgb2YgdGhlc2UgZGV2aWNlcyB0aGUKIAkgKiBiaXQgcmF0
ZSBpcyBtZWFuaW5nbGVzcyAob3ZlcmhlYWQgYW4gY28pIHRvIGVzdGltYXRlIGhvdwogCSAqIGZh
c3QgdGhlIGNvbm5lY3Rpb24gd2lsbCBnbyBhbmQgcGljayB0aGUgZmFzdGVzdCBvbmUuCkBAIC0y
MzEsMTEgKzIzMiwxMyBAQCBzdGF0aWMgaW50IHJ0bDgxODBfd3hfZ2V0X3JhbmdlKHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYsCiAJd3JxdS0+ZGF0YS5sZW5ndGggPSBzaXplb2YoKnJhbmdlKTsKIAlt
ZW1zZXQocmFuZ2UsIDAsIHNpemVvZigqcmFuZ2UpKTsKCi0JLyogTGV0J3MgdHJ5IHRvIGtlZXAg
dGhpcyBzdHJ1Y3QgaW4gdGhlIHNhbWUgb3JkZXIgYXMgaW4KKwkvKgorCSAqIExldCdzIHRyeSB0
byBrZWVwIHRoaXMgc3RydWN0IGluIHRoZSBzYW1lIG9yZGVyIGFzIGluCiAJICogbGludXgvaW5j
bHVkZS93aXJlbGVzcy5oCiAJICovCgotCS8qIFRPRE86IFNlZSB3aGF0IHZhbHVlcyB3ZSBjYW4g
c2V0LCBhbmQgcmVtb3ZlIHRoZSBvbmVzIHdlIGNhbid0CisJLyoKKwkgKiBUT0RPOiBTZWUgd2hh
dCB2YWx1ZXMgd2UgY2FuIHNldCwgYW5kIHJlbW92ZSB0aGUgb25lcyB3ZSBjYW4ndAogCSAqIHNl
dCwgb3IgZmlsbCB0aGVtIHdpdGggc29tZSBkZWZhdWx0IGRhdGEuCiAJICovCgpAQCAtNjQ0LDcg
KzY0Nyw4IEBAIHN0YXRpYyBpbnQgcjgxOTJfd3hfc2V0X3JldHJ5KHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsCiAJCURNRVNHKCJTZXR0aW5nIHJldHJ5IGZvciBub24gUlRTL0NUUyBkYXRhIHRvICVk
Iiwgd3JxdS0+cmV0cnkudmFsdWUpOwogCX0KCi0JLyogRklYTUUgIQorCS8qCisJICogRklYTUUg
IQogCSAqIFdlIG1pZ2h0IHRyeSB0byB3cml0ZSBkaXJlY3RseSB0aGUgVFggY29uZmlnIHJlZ2lz
dGVyCiAJICogb3IgdG8gcmVzdGFydCBqdXN0IHRoZSAoUilUWCBwcm9jZXNzLgogCSAqIEknbSB1
bnN1cmUgaWYgd2hvbGUgcmVzZXQgaXMgcmVhbGx5IG5lZWRlZApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTl4VV9jbWRwa3QuYyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4
MTkydS9yODE5eFVfY21kcGt0LmMKaW5kZXggZTA2NGY0M2ZkOGI2Li4xZmQ1OTZmMDkyNDEgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5eFVfY21kcGt0LmMKKysrIGIv
ZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTl4VV9jbWRwa3QuYwpAQCAtMzMsNyArMzMsOCBA
QCBydF9zdGF0dXMgU2VuZFR4Q29tbWFuZFBhY2tldChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB2
b2lkICpwRGF0YSwgdTMyIERhdGFMZW4pCiAJc3RydWN0IHNrX2J1ZmYJICAgICpza2I7CiAJc3Ry
dWN0IGNiX2Rlc2MJICAgICp0Y2JfZGVzYzsKCi0JLyogR2V0IFRDQiBhbmQgbG9jYWwgYnVmZmVy
IGZyb20gY29tbW9uIHBvb2wuCisJLyoKKwkgKiBHZXQgVENCIGFuZCBsb2NhbCBidWZmZXIgZnJv
bSBjb21tb24gcG9vbC4KIAkgKiAoSXQgaXMgc2hhcmVkIGJ5IENtZFEsIE1nbnRRLCBhbmQgVVNC
IGNvYWxlc2NlIERhdGFRKQogCSAqLwogCXNrYiAgPSBkZXZfYWxsb2Nfc2tiKFVTQl9IV0RFU0Nf
SEVBREVSX0xFTiArIERhdGFMZW4gKyA0KTsKQEAgLTY5LDcgKzcwLDggQEAgc3RhdGljIHZvaWQg
Y21wa19jb3VudF90eHN0YXRpc3RpYyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3QgY21k
X3BrdF90eF9mZWUKIAlwQWRhcHRlci0+SGFsRnVuYy5HZXRId1JlZ0hhbmRsZXIocEFkYXB0ZXIs
IEhXX1ZBUl9SRl9TVEFURSwKIAkJCQkJICAocHUxQnl0ZSkoJnJ0U3RhdGUpKTsKCi0JLyogV2hl
biBSRiBpcyBvZmYsIHdlIHNob3VsZCBub3QgY291bnQgdGhlIHBhY2tldCBmb3IgaHcvc3cgc3lu
Y2hyb25pemUKKwkvKgorCSAqIFdoZW4gUkYgaXMgb2ZmLCB3ZSBzaG91bGQgbm90IGNvdW50IHRo
ZSBwYWNrZXQgZm9yIGh3L3N3IHN5bmNocm9uaXplCiAJICogcmVhc29uLCBpZS4gdGhlcmUgbWF5
IGJlIGEgZHVyYXRpb24gd2hpbGUgc3cgc3dpdGNoIGlzIGNoYW5nZWQgYW5kCiAJICogaHcgc3dp
dGNoIGlzIGJlaW5nIGNoYW5nZWQuCiAJICovCkBAIC04MSw3ICs4Myw4IEBAIHN0YXRpYyB2b2lk
IGNtcGtfY291bnRfdHhzdGF0aXN0aWMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgc3RydWN0IGNt
ZF9wa3RfdHhfZmVlCiAJaWYgKHBBZGFwdGVyLT5iSW5IY3RUZXN0KQogCQlyZXR1cm47CiAjZW5k
aWYKLQkvKiBXZSBjYW4gbm90IGtub3cgdGhlIHBhY2tldCBsZW5ndGggYW5kIHRyYW5zbWl0IHR5
cGU6CisJLyoKKwkgKiBXZSBjYW4gbm90IGtub3cgdGhlIHBhY2tldCBsZW5ndGggYW5kIHRyYW5z
bWl0IHR5cGU6CiAJICogYnJvYWRjYXN0IG9yIHVuaSBvciBtdWx0aWNhc3QuIFNvIHRoZSByZWxh
dGl2ZSBzdGF0aXN0aWNzCiAJICogbXVzdCBiZSBjb2xsZWN0ZWQgaW4gdHggZmVlZGJhY2sgaW5m
by4KIAkgKi8KQEAgLTEyMCw3ICsxMjMsOCBAQCBzdGF0aWMgdm9pZCBjbXBrX2NvdW50X3R4c3Rh
dGlzdGljKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHN0cnVjdCBjbWRfcGt0X3R4X2ZlZQogCXBy
aXYtPnN0YXRzLnR4ZmVlZGJhY2tyZXRyeSArPSBwc3R4X2ZiLT5yZXRyeV9jbnQ7CiB9CgotLyot
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQorLyoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBGdW5j
dGlvbjogICAgY21wa19oYW5kbGVfdHhfZmVlZGJhY2soKQogICoKICAqIE92ZXJ2aWV3OglUaGUg
ZnVuY3Rpb24gaXMgcmVzcG9uc2libGUgZm9yIGV4dHJhY3QgdGhlIG1lc3NhZ2UgaW5zaWRlIFRY
CkBAIC0xNDAsNyArMTQ0LDcgQEAgc3RhdGljIHZvaWQgY21wa19jb3VudF90eHN0YXRpc3RpYyhz
dHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3QgY21kX3BrdF90eF9mZWUKICAqICBXaGVuCQlX
aG8JUmVtYXJrCiAgKiAgMDUvMDgvMjAwOAkJYW15CUNyZWF0ZSBWZXJzaW9uIDAgcG9ydGluZyBm
cm9tIHdpbmRvd3MgY29kZS4KICAqCi0gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCiAgKi8KIHN0YXRpYyB2b2lkIGNtcGtfaGFuZGxlX3R4X2ZlZWRiYWNrKHN0cnVj
dCBuZXRfZGV2aWNlICpkZXYsIHU4ICpwbXNnKQogewpAQCAtMTUwLDcgKzE1NCw4IEBAIHN0YXRp
YyB2b2lkIGNtcGtfaGFuZGxlX3R4X2ZlZWRiYWNrKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHU4
ICpwbXNnKQogCXByaXYtPnN0YXRzLnR4ZmVlZGJhY2srKzsKCiAJLyogMS4gRXh0cmFjdCBUWCBm
ZWVkYmFjayBpbmZvIGZyb20gUkZEIHRvIHRlbXAgc3RydWN0dXJlIGJ1ZmZlci4gKi8KLQkvKiBJ
dCBzZWVtcyB0aGF0IEZXIHVzZSBiaWcgZW5kaWFuKE1JUFMpIGFuZCBEUlYgdXNlIGxpdHRsZSBl
bmRpYW4gaW4KKwkvKgorCSAqIEl0IHNlZW1zIHRoYXQgRlcgdXNlIGJpZyBlbmRpYW4oTUlQUykg
YW5kIERSViB1c2UgbGl0dGxlIGVuZGlhbiBpbgogCSAqIHdpbmRvd3MgT1MuIFNvIHdlIGhhdmUg
dG8gcmVhZCB0aGUgY29udGVudCBieXRlIGJ5IGJ5dGUgb3IgdHJhbnNmZXIKIAkgKiBlbmRpYW4g
dHlwZSBiZWZvcmUgY29weSB0aGUgbWVzc2FnZSBjb3B5LgogCSAqLwpAQCAtMTYwLDcgKzE2NSw4
IEBAIHN0YXRpYyB2b2lkIGNtcGtfaGFuZGxlX3R4X2ZlZWRiYWNrKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsIHU4ICpwbXNnKQogCWNtcGtfY291bnRfdHhzdGF0aXN0aWMoZGV2LCAmcnhfdHhfZmIp
OwogCS8qIENvbW1lbnQgcHJldmlvdXMgbWV0aG9kIGZvciBUWCBzdGF0aXN0aWMgZnVuY3Rpb24u
ICovCiAJLyogQ29sbGVjdCBpbmZvIFRYIGZlZWRiYWNrIHBhY2tldCB0byBmaWxsIFRDQi4gKi8K
LQkvKiBXZSBjYW4gbm90IGtub3cgdGhlIHBhY2tldCBsZW5ndGggYW5kIHRyYW5zbWl0IHR5cGU6
IGJyb2FkY2FzdCBvciB1bmkKKwkvKgorCSAqIFdlIGNhbiBub3Qga25vdyB0aGUgcGFja2V0IGxl
bmd0aCBhbmQgdHJhbnNtaXQgdHlwZTogYnJvYWRjYXN0IG9yIHVuaQogCSAqIG9yIG11bHRpY2Fz
dC4KIAkgKi8KIH0KQEAgLTE4NCw3ICsxOTAsOCBAQCBzdGF0aWMgdm9pZCBjbWRwa3RfYmVhY29u
dGltZXJpbnRlcnJ1cHRfODE5eHVzYihzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCQlydGw4MTl4
dXNiX2JlYWNvbl90eChkZXYsIHR4X3JhdGUpOyAvKiBIVyBCZWFjb24gKi8KIH0KCi0vKi0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tCisvKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIEZ1bmN0aW9u
OiAgICBjbXBrX2hhbmRsZV9pbnRlcnJ1cHRfc3RhdHVzKCkKICAqCiAgKiBPdmVydmlldzogICAg
VGhlIGZ1bmN0aW9uIGlzIHJlc3BvbnNpYmxlIGZvciBleHRyYWN0IHRoZSBtZXNzYWdlIGZyb20K
QEAgLTIwMyw3ICsyMTAsNyBAQCBzdGF0aWMgdm9pZCBjbWRwa3RfYmVhY29udGltZXJpbnRlcnJ1
cHRfODE5eHVzYihzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogICogIFdoZW4JCVdobwlSZW1hcmsK
ICAqICAwNS8xMi8yMDA4CQlhbXkJQWRkIHRoaXMgZm9yIHJ0bDgxOTIgcG9ydGluZyBmcm9tIHdp
bmRvd3MgY29kZS4KICAqCi0gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCiAgKi8KIHN0YXRpYyB2b2lkIGNtcGtfaGFuZGxlX2ludGVycnVwdF9zdGF0dXMoc3RydWN0
IG5ldF9kZXZpY2UgKmRldiwgdTggKnBtc2cpCiB7CkBAIC0yMTMsNyArMjIwLDggQEAgc3RhdGlj
IHZvaWQgY21wa19oYW5kbGVfaW50ZXJydXB0X3N0YXR1cyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
LCB1OCAqcG1zZykKIAlETUVTRygiLS0tPiBjbXBrX0hhbmRsZV9JbnRlcnJ1cHRfU3RhdHVzKClc
biIpOwoKIAkvKiAxLiBFeHRyYWN0IFRYIGZlZWRiYWNrIGluZm8gZnJvbSBSRkQgdG8gdGVtcCBz
dHJ1Y3R1cmUgYnVmZmVyLiAqLwotCS8qIEl0IHNlZW1zIHRoYXQgRlcgdXNlIGJpZyBlbmRpYW4o
TUlQUykgYW5kIERSViB1c2UgbGl0dGxlIGVuZGlhbiBpbgorCS8qCisJICogSXQgc2VlbXMgdGhh
dCBGVyB1c2UgYmlnIGVuZGlhbihNSVBTKSBhbmQgRFJWIHVzZSBsaXR0bGUgZW5kaWFuIGluCiAJ
ICogd2luZG93cyBPUy4gU28gd2UgaGF2ZSB0byByZWFkIHRoZSBjb250ZW50IGJ5dGUgYnkgYnl0
ZSBvciB0cmFuc2ZlcgogCSAqIGVuZGlhbiB0eXBlIGJlZm9yZSBjb3B5IHRoZSBtZXNzYWdlIGNv
cHkuCiAJICovCkBAIC0yNDgsNyArMjU2LDggQEAgc3RhdGljIHZvaWQgY21wa19oYW5kbGVfaW50
ZXJydXB0X3N0YXR1cyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB1OCAqcG1zZykKIAlETUVTRygi
PC0tLS0gY21wa19oYW5kbGVfaW50ZXJydXB0X3N0YXR1cygpXG4iKTsKIH0KCi0vKi0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tCisvKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIEZ1bmN0aW9uOiAg
ICBjbXBrX2hhbmRsZV9xdWVyeV9jb25maWdfcngoKQogICoKICAqIE92ZXJ2aWV3OiAgICBUaGUg
ZnVuY3Rpb24gaXMgcmVzcG9uc2libGUgZm9yIGV4dHJhY3QgdGhlIG1lc3NhZ2UgZnJvbQpAQCAt
MjY2LDE0ICsyNzUsMTUgQEAgc3RhdGljIHZvaWQgY21wa19oYW5kbGVfaW50ZXJydXB0X3N0YXR1
cyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB1OCAqcG1zZykKICAqICBXaGVuCQlXaG8JUmVtYXJr
CiAgKiAgMDUvMTIvMjAwOAkJYW15CUNyZWF0ZSBWZXJzaW9uIDAgcG9ydGluZyBmcm9tIHdpbmRv
d3MgY29kZS4KICAqCi0gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CiAgKi8KIHN0YXRpYyB2b2lkIGNtcGtfaGFuZGxlX3F1ZXJ5X2NvbmZpZ19yeChzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2LCB1OCAqcG1zZykKIHsKIAlzdHJ1Y3QgY21wa19xdWVyeV9jZmcJcnhfcXVl
cnlfY2ZnOwoKIAkvKiAxLiBFeHRyYWN0IFRYIGZlZWRiYWNrIGluZm8gZnJvbSBSRkQgdG8gdGVt
cCBzdHJ1Y3R1cmUgYnVmZmVyLiAqLwotCS8qIEl0IHNlZW1zIHRoYXQgRlcgdXNlIGJpZyBlbmRp
YW4oTUlQUykgYW5kIERSViB1c2UgbGl0dGxlIGVuZGlhbiBpbgorCS8qCisJICogSXQgc2VlbXMg
dGhhdCBGVyB1c2UgYmlnIGVuZGlhbihNSVBTKSBhbmQgRFJWIHVzZSBsaXR0bGUgZW5kaWFuIGlu
CiAJICogd2luZG93cyBPUy4gU28gd2UgaGF2ZSB0byByZWFkIHRoZSBjb250ZW50IGJ5dGUgYnkg
Ynl0ZSBvciB0cmFuc2ZlcgogCSAqIGVuZGlhbiB0eXBlIGJlZm9yZSBjb3B5IHRoZSBtZXNzYWdl
IGNvcHkuCiAJICovCkBAIC0yODgsNyArMjk4LDggQEAgc3RhdGljIHZvaWQgY21wa19oYW5kbGVf
cXVlcnlfY29uZmlnX3J4KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHU4ICpwbXNnKQogCQkJCQkg
IChwbXNnWzE0XSA8PCAgOCkgfCAocG1zZ1sxNV0gPDwgIDApOwogfQoKLS8qLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0KKy8qCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICogRnVuY3Rpb246CWNtcGtf
Y291bnRfdHhfc3RhdHVzKCkKICAqCiAgKiBPdmVydmlldzoJQ291bnQgYWdncmVnYXRlZCB0eCBz
dGF0dXMgZnJvbSBmaXJtd2FyIG9mIG9uZSB0eXBlIHJ4IGNvbW1hbmQKQEAgLTMwNCw3ICszMTUs
NyBAQCBzdGF0aWMgdm9pZCBjbXBrX2hhbmRsZV9xdWVyeV9jb25maWdfcngoc3RydWN0IG5ldF9k
ZXZpY2UgKmRldiwgdTggKnBtc2cpCiAgKglXaGVuCQlXaG8JUmVtYXJrCiAgKgkwNS8xMi8yMDA4
CWFteQlDcmVhdGUgVmVyc2lvbiAwIHBvcnRpbmcgZnJvbSB3aW5kb3dzIGNvZGUuCiAgKgotICot
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICovCiBzdGF0aWMgdm9p
ZCBjbXBrX2NvdW50X3R4X3N0YXR1cyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCQkJCSBjbXBr
X3R4X3N0YXR1c190ICpwc3R4X3N0YXR1cykKQEAgLTMxOCw3ICszMjksOCBAQCBzdGF0aWMgdm9p
ZCBjbXBrX2NvdW50X3R4X3N0YXR1cyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCXBBZGFwdGVy
LT5IYWxGdW5jLkdldEh3UmVnSGFuZGxlcihwQWRhcHRlciwgSFdfVkFSX1JGX1NUQVRFLAogCQkJ
CQkgIChwdTFCeXRlKSgmcnRTdGF0ZSkpOwoKLQkvKiBXaGVuIFJGIGlzIG9mZiwgd2Ugc2hvdWxk
IG5vdCBjb3VudCB0aGUgcGFja2V0IGZvciBody9zdyBzeW5jaHJvbml6ZQorCS8qCisJICogV2hl
biBSRiBpcyBvZmYsIHdlIHNob3VsZCBub3QgY291bnQgdGhlIHBhY2tldCBmb3IgaHcvc3cgc3lu
Y2hyb25pemUKIAkgKiByZWFzb24sIGllLiB0aGVyZSBtYXkgYmUgYSBkdXJhdGlvbiB3aGlsZSBz
dyBzd2l0Y2ggaXMgY2hhbmdlZCBhbmQKIAkgKiBodyBzd2l0Y2ggaXMgYmVpbmcgY2hhbmdlZC4K
IAkgKi8KQEAgLTM1MSw3ICszNjMsOCBAQCBzdGF0aWMgdm9pZCBjbXBrX2NvdW50X3R4X3N0YXR1
cyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCXByaXYtPnN0YXRzLmxhc3RfcGFja2V0X3JhdGUJ
PSBwc3R4X3N0YXR1cy0+cmF0ZTsKIH0KCi0vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisvKgorICog
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIEZ1bmN0aW9uOgljbXBrX2hhbmRsZV90eF9zdGF0dXMo
KQogICoKICAqIE92ZXJ2aWV3OglGaXJtd2FyZSBhZGQgYSBuZXcgdHggZmVlZGJhY2sgc3RhdHVz
IHRvIHJlZHVjZSByeCBjb21tYW5kCkBAIC0zNjcsNyArMzgwLDcgQEAgc3RhdGljIHZvaWQgY21w
a19jb3VudF90eF9zdGF0dXMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKICAqCVdoZW4JCVdobwlS
ZW1hcmsKICAqCTA1LzEyLzIwMDgJYW15CUNyZWF0ZSBWZXJzaW9uIDAgcG9ydGluZyBmcm9tIHdp
bmRvd3MgY29kZS4KICAqCi0gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCiAgKi8KIHN0YXRpYyB2b2lkIGNtcGtfaGFuZGxlX3R4X3N0YXR1cyhzdHJ1Y3QgbmV0X2Rl
dmljZSAqZGV2LCB1OCAqcG1zZykKIHsKQEAgLTM3OCw3ICszOTEsOCBAQCBzdGF0aWMgdm9pZCBj
bXBrX2hhbmRsZV90eF9zdGF0dXMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgdTggKnBtc2cpCiAJ
Y21wa19jb3VudF90eF9zdGF0dXMoZGV2LCAmcnhfdHhfc3RzKTsKIH0KCi0vKi0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCisvKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAqIEZ1bmN0aW9uOgljbXBr
X2hhbmRsZV90eF9yYXRlX2hpc3RvcnkoKQogICoKICAqIE92ZXJ2aWV3OglGaXJtd2FyZSBhZGQg
YSBuZXcgdHggcmF0ZSBoaXN0b3J5CkBAIC0zOTMsNyArNDA3LDcgQEAgc3RhdGljIHZvaWQgY21w
a19oYW5kbGVfdHhfc3RhdHVzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHU4ICpwbXNnKQogICoJ
V2hlbgkJV2hvCVJlbWFyawogICoJMDUvMTIvMjAwOAlhbXkJQ3JlYXRlIFZlcnNpb24gMCBwb3J0
aW5nIGZyb20gd2luZG93cyBjb2RlLgogICoKLSAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKiAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0KICAqLwogc3RhdGljIHZvaWQgY21wa19oYW5kbGVfdHhfcmF0ZV9oaXN0
b3J5KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHU4ICpwbXNnKQogewpAQCAtNDA3LDcgKzQyMSw4
IEBAIHN0YXRpYyB2b2lkIGNtcGtfaGFuZGxlX3R4X3JhdGVfaGlzdG9yeShzdHJ1Y3QgbmV0X2Rl
dmljZSAqZGV2LCB1OCAqcG1zZykKIAlwQWRhcHRlci0+SGFsRnVuYy5HZXRId1JlZ0hhbmRsZXIo
cEFkYXB0ZXIsIEhXX1ZBUl9SRl9TVEFURSwKIAkJCQkJICAocHUxQnl0ZSkoJnJ0U3RhdGUpKTsK
Ci0JLyogV2hlbiBSRiBpcyBvZmYsIHdlIHNob3VsZCBub3QgY291bnQgdGhlIHBhY2tldCBmb3Ig
aHcvc3cgc3luY2hyb25pemUKKwkvKgorCSAqIFdoZW4gUkYgaXMgb2ZmLCB3ZSBzaG91bGQgbm90
IGNvdW50IHRoZSBwYWNrZXQgZm9yIGh3L3N3IHN5bmNocm9uaXplCiAJICogcmVhc29uLCBpZS4g
dGhlcmUgbWF5IGJlIGEgZHVyYXRpb24gd2hpbGUgc3cgc3dpdGNoIGlzIGNoYW5nZWQgYW5kCiAJ
ICogaHcgc3dpdGNoIGlzIGJlaW5nIGNoYW5nZWQuCiAJICovCkBAIC00MTcsNyArNDMyLDggQEAg
c3RhdGljIHZvaWQgY21wa19oYW5kbGVfdHhfcmF0ZV9oaXN0b3J5KHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsIHU4ICpwbXNnKQoKIAlwdGVtcCA9ICh1MzIgKilwbXNnOwoKLQkvKiBEbyBlbmRpYW4g
dHJhbnNmZXIgdG8gd29yZCBhbGlnbm1lbnQoMTYgYml0cykgZm9yIHdpbmRvd3Mgc3lzdGVtLgor
CS8qCisJICogRG8gZW5kaWFuIHRyYW5zZmVyIHRvIHdvcmQgYWxpZ25tZW50KDE2IGJpdHMpIGZv
ciB3aW5kb3dzIHN5c3RlbS4KIAkgKiBZb3UgbXVzdCBkbyBkaWZmZXJlbnQgZW5kaWFuIHRyYW5z
ZmVyIGZvciBsaW51eCBhbmQgTUFDIE9TCiAJICovCiAJZm9yIChpID0gMDsgaSA8IChsZW5ndGgv
NCk7IGkrKykgewpAQCAtNDQ3LDcgKzQ2Myw4IEBAIHN0YXRpYyB2b2lkIGNtcGtfaGFuZGxlX3R4
X3JhdGVfaGlzdG9yeShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB1OCAqcG1zZykKIAl9CiB9Cgot
LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorLyoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgKiBG
dW5jdGlvbjogICAgY21wa19tZXNzYWdlX2hhbmRsZV9yeCgpCiAgKgogICogT3ZlcnZpZXc6ICAg
IEluIHRoZSBmdW5jdGlvbiwgd2Ugd2lsbCBjYXB0dXJlIGRpZmZlcmVudCBSWCBjb21tYW5kIHBh
Y2tldApAQCAtNDY2LDcgKzQ4Myw3IEBAIHN0YXRpYyB2b2lkIGNtcGtfaGFuZGxlX3R4X3JhdGVf
aGlzdG9yeShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB1OCAqcG1zZykKICAqICBXaGVuCQlXaG8J
UmVtYXJrCiAgKiAgMDUvMDYvMjAwOAkJYW15CUNyZWF0ZSBWZXJzaW9uIDAgcG9ydGluZyBmcm9t
IHdpbmRvd3MgY29kZS4KICAqCi0gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICogLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tCiAgKi8KIHUzMiBjbXBrX21lc3NhZ2VfaGFuZGxlX3J4KHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYsCiAJCQkgICBzdHJ1Y3QgaWVlZTgwMjExX3J4X3N0YXRzICpwc3RhdHMpCkBAIC00NzYs
NyArNDkzLDggQEAgdTMyIGNtcGtfbWVzc2FnZV9oYW5kbGVfcngoc3RydWN0IG5ldF9kZXZpY2Ug
KmRldiwKIAl1OAkJCWVsZW1lbnRfaWQ7CiAJdTgJCQkqcGNtZF9idWZmOwoKLQkvKiAwLiBDaGVj
ayBpbnB0IGFyZ3VtZW50cy4gSXQgaXMgYSBjb21tYW5kIHF1ZXVlIG1lc3NhZ2Ugb3IKKwkvKgor
CSAqIDAuIENoZWNrIGlucHQgYXJndW1lbnRzLiBJdCBpcyBhIGNvbW1hbmQgcXVldWUgbWVzc2Fn
ZSBvcgogCSAqIHBvaW50ZXIgaXMgbnVsbC4KIAkgKi8KIAlpZiAocHN0YXRzID09IE5VTEwpCkBA
IC00OTEsMTEgKzUwOSwxMyBAQCB1MzIgY21wa19tZXNzYWdlX2hhbmRsZV9yeChzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2LAogCS8qIDMuIFJlYWQgY29tbWFuZCBwYWNrZXQgZWxlbWVudCBpZCBhbmQg
bGVuZ3RoLiAqLwogCWVsZW1lbnRfaWQgPSBwY21kX2J1ZmZbMF07CgotCS8qIDQuIENoZWNrIGV2
ZXJ5IHJlY2VpdmVkIGNvbW1hbmQgcGFja2V0IGNvbnRlbnQgYWNjb3JkaW5nIHRvIGRpZmZlcmVu
dAorCS8qCisJICogNC4gQ2hlY2sgZXZlcnkgcmVjZWl2ZWQgY29tbWFuZCBwYWNrZXQgY29udGVu
dCBhY2NvcmRpbmcgdG8gZGlmZmVyZW50CiAJICogICAgZWxlbWVudCB0eXBlLiBCZWNhdXNlIEZX
IG1heSBhZ2dyZWdhdGUgUlggY29tbWFuZCBwYWNrZXQgdG8KIAkgKiAgICBtaW5pbWl6ZSB0cmFu
c21pdCB0aW1lIGJldHdlZW4gRFJWIGFuZCBGVy4KIAkgKi8KLQkvKiBBZGQgYSBjb3VudGVyIHRv
IHByZXZlbnQgdGhlIGxvY2sgaW4gdGhlIGxvb3AgZnJvbSBiZWluZyBoZWxkIHRvbworCS8qCisJ
ICogQWRkIGEgY291bnRlciB0byBwcmV2ZW50IHRoZSBsb2NrIGluIHRoZSBsb29wIGZyb20gYmVp
bmcgaGVsZCB0b28KIAkgKiBsb25nCiAJICovCiAJd2hpbGUgKHRvdGFsX2xlbmd0aCA+IDAgJiYg
ZXhlX2NudCsrIDwgMTAwKSB7CkBAIC01MjQsNyArNTQ0LDggQEAgdTMyIGNtcGtfbWVzc2FnZV9o
YW5kbGVfcngoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKIAkJCWJyZWFrOwoKIAkJY2FzZSBSWF9U
WF9QRVJfUEtUX0ZFRURCQUNLOgotCQkJLyogWW91IG11c3QgYXQgbGVhc2UgYWRkIGEgc3dpdGNo
IGNhc2UgZWxlbWVudCBoZXJlLAorCQkJLyoKKwkJCSAqIFlvdSBtdXN0IGF0IGxlYXNlIGFkZCBh
IHN3aXRjaCBjYXNlIGVsZW1lbnQgaGVyZSwKIAkJCSAqIE90aGVyd2lzZSwgd2Ugd2lsbCBqdW1w
IHRvIGRlZmF1bHQgY2FzZS4KIAkJCSAqLwogCQkJY21kX2xlbmd0aCA9IENNUEtfUlhfVFhfRkJf
U0laRTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5eFVfY21kcGt0
LmggYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX2NtZHBrdC5oCmluZGV4IGJlNDVj
ZDYwOWQ2Ny4uNjQ5OGI0NjI1MjU0IDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5
MnUvcjgxOXhVX2NtZHBrdC5oCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ydGw4MTkydS9yODE5eFVf
Y21kcGt0LmgKQEAgLTUyLDcgKzUyLDggQEAgc3RydWN0IGNtZF9wa3RfdHhfZmVlZGJhY2sgewog
CXUxNglkdXJhdGlvbjsKIH07CgotLyogMi4gUlggc2lkZTogSW50ZXJydXB0IHN0YXR1cyBwYWNr
ZXQuIEl0IGluY2x1ZGVzIEJlYWNvbiBTdGF0ZSwKKy8qCisgKiAyLiBSWCBzaWRlOiBJbnRlcnJ1
cHQgc3RhdHVzIHBhY2tldC4gSXQgaW5jbHVkZXMgQmVhY29uIFN0YXRlLAogICogQmVhY29uIFRp
bWVyIEludGVycnVwdCBhbmQgb3RoZXIgdXNlZnVsIGluZm9ybWF0aW9uIGluIE1BQyBJU1IgUmVn
LgogICovCiBzdHJ1Y3QgY21kX3BrdF9pbnRlcnJ1cHRfc3RhdHVzIHsKQEAgLTgwLDE1ICs4MSwx
NyBAQCBzdHJ1Y3QgY21kX3BrdF9zZXRfY29uZmlndXJhdGlvbiB7CiAJdTMyCW1hc2s7CiB9OwoK
LS8qIDQuIEJvdGggc2lkZSA6IFRYL1JYIHF1ZXJ5IGNvbmZpZ3VyYXRpb24gcGFja2V0LiBUaGUg
cXVlcnkgc3RydWN0dXJlIGlzIHRoZQorLyoKKyAqIDQuIEJvdGggc2lkZSA6IFRYL1JYIHF1ZXJ5
IGNvbmZpZ3VyYXRpb24gcGFja2V0LiBUaGUgcXVlcnkgc3RydWN0dXJlIGlzIHRoZQogICogICAg
c2FtZSBhcyBzZXQgY29uZmlndXJhdGlvbi4KICAqLwogI2RlZmluZQkJY21wa19xdWVyeV9jZmcJ
Y21kX3BrdF9zZXRfY29uZmlndXJhdGlvbgoKIC8qIDUuIE11bHRpIHBhY2tldCBmZWVkYmFjayBz
dGF0dXMuICovCiB0eXBlZGVmIHN0cnVjdCB0YWdfdHhfc3RhdHNfZmVlZGJhY2sgewotCS8qIEZv
ciBlbmRpYW4gdHJhbnNmZXIgLS0+IERyaXZlciB3aWxsIG5vdCB0aGUgc2FtZSBhcwotCSAqICBm
aXJtd2FyZSBzdHJ1Y3R1cmUuCisJLyoKKwkgKiBGb3IgZW5kaWFuIHRyYW5zZmVyIC0tPiBEcml2
ZXIgd2lsbCBub3QgdGhlIHNhbWUgYXMKKwkgKiBmaXJtd2FyZSBzdHJ1Y3R1cmUuCiAJICovCiAJ
LyogRFcgMCAqLwogCXUxNglyZXNlcnZlMTsKQEAgLTE1NCw3ICsxNTcsOCBAQCB0eXBlZGVmIHN0
cnVjdCB0YWdfdHhfcmF0ZV9oaXN0b3J5IHsKIAkvKiBEVyAzLTYgKi8KIAl1MTYJb2ZkbVs4XTsK
Ci0JLyogRFcgNy0xNAlCVz0wIFNHPTAKKwkvKgorCSAqIERXIDctMTQJQlc9MCBTRz0wCiAJICog
RFcgMTUtMjIJQlc9MSBTRz0wCiAJICogRFcgMjMtMzAJQlc9MCBTRz0xCiAJICogRFcgMzEtMzgJ
Qlc9MSBTRz0xCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX2Zp
cm13YXJlLmMgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX2Zpcm13YXJlLmMKaW5k
ZXggMTUzZDRlZTBlYzA3Li5lOTUxMWI4MjliMDUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2lu
Zy9ydGw4MTkydS9yODE5eFVfZmlybXdhcmUuYworKysgYi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5
MnUvcjgxOXhVX2Zpcm13YXJlLmMKQEAgLTYxLDcgKzYxLDggQEAgc3RhdGljIGJvb2wgZndfZG93
bmxvYWRfY29kZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB1OCAqY29kZV92aXJ0dWFsX2FkZHJl
c3MsCgogCQl9CgotCQkvKiBBbGxvY2F0ZSBza2IgYnVmZmVyIHRvIGNvbnRhaW4gZmlybXdhcmUg
aW5mbyBhbmQgdHggZGVzY3JpcHRvciBpbmZvCisJCS8qCisJCSAqIEFsbG9jYXRlIHNrYiBidWZm
ZXIgdG8gY29udGFpbiBmaXJtd2FyZSBpbmZvIGFuZCB0eCBkZXNjcmlwdG9yIGluZm8KIAkJICog
YWRkIDQgdG8gYXZvaWQgcGFja2V0IGFwcGVuZGluZyBvdmVyZmxvdy4KIAkJICovCiAJCXNrYiAg
PSBkZXZfYWxsb2Nfc2tiKFVTQl9IV0RFU0NfSEVBREVSX0xFTiArIGZyYWdfbGVuZ3RoICsgNCk7
CkBAIC0yNzMsNyArMjc0LDggQEAgYm9vbCBpbml0X2Zpcm13YXJlKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYpCiAJCX0KCiAJCS8qIERvd25sb2FkIGltYWdlIGZpbGUgKi8KLQkJLyogVGhlIGZpcm13
YXJlIGRvd25sb2FkIHByb2Nlc3MgaXMganVzdCBhcyBmb2xsb3dpbmcsCisJCS8qCisJCSAqIFRo
ZSBmaXJtd2FyZSBkb3dubG9hZCBwcm9jZXNzIGlzIGp1c3QgYXMgZm9sbG93aW5nLAogCQkgKiAx
LiB0aGF0IGlzIGVhY2ggcGFja2V0IHdpbGwgYmUgc2VnbWVudGVkIGFuZCBpbnNlcnRlZCB0byB0
aGUgd2FpdCBxdWV1ZS4KIAkJICogMi4gZWFjaCBwYWNrZXQgc2VnbWVudCB3aWxsIGJlIHB1dCBp
biB0aGUgc2tiX2J1ZmYgcGFja2V0LgogCQkgKiAzLiBlYWNoIHNrYl9idWZmIHBhY2tldCBkYXRh
IGNvbnRlbnQgd2lsbCBhbHJlYWR5IGluY2x1ZGUgdGhlIGZpcm13YXJlIGluZm8KQEAgLTI4OCw3
ICsyOTAsOCBAQCBib29sIGluaXRfZmlybXdhcmUoc3RydWN0IG5ldF9kZXZpY2UgKmRldikKCiAJ
CXN3aXRjaCAoaW5pdF9zdGVwKSB7CiAJCWNhc2UgRldfSU5JVF9TVEVQMF9CT09UOgotCQkJLyog
RG93bmxvYWQgYm9vdAorCQkJLyoKKwkJCSAqIERvd25sb2FkIGJvb3QKIAkJCSAqIGluaXRpYWxp
emUgY29tbWFuZCBkZXNjcmlwdG9yLgogCQkJICogd2lsbCBzZXQgcG9sbGluZyBiaXQgd2hlbiBm
aXJtd2FyZSBjb2RlIGlzIGFsc28gY29uZmlndXJlZAogCQkJICovCmRpZmYgLS1naXQgYS9kcml2
ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX3BoeS5jIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgx
OTJ1L3I4MTl4VV9waHkuYwppbmRleCA1ZjA0YWZlNTNkNjkuLjU0NDVlYTA5MjEzMCAxMDA2NDQK
LS0tIGEvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTl4VV9waHkuYworKysgYi9kcml2ZXJz
L3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX3BoeS5jCkBAIC00MjYsNyArNDI2LDggQEAgc3RhdGlj
IHZvaWQgcGh5X0Z3UkZTZXJpYWxXcml0ZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCXU4CXRp
bWUgPSAwOwogCXUzMgl0bXA7CgotCS8qIEZpcm13YXJlIFJGIFdyaXRlIGNvbnRyb2wuCisJLyoK
KwkgKiBGaXJtd2FyZSBSRiBXcml0ZSBjb250cm9sLgogCSAqIFdlIGNhbiBub3QgZXhlY3V0ZSB0
aGUgc2NoZW1lIGluIHRoZSBpbml0aWFsIHN0ZXAuCiAJICogT3RoZXJ3aXNlLCBSRi1SL1cgd2ls
bCB3YXN0ZSBtdWNoIHRpbWUuCiAJICogVGhpcyBpcyBvbmx5IGZvciBzaXRlIHN1cnZleS4KQEAg
LTQ0NSw3ICs0NDYsOCBAQCBzdGF0aWMgdm9pZCBwaHlfRndSRlNlcmlhbFdyaXRlKHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYsCiAJLyogNi4gV3JpdGUgb3BlcmF0aW9uLiBXZSBjYW4gbm90IHdyaXRl
IGlmIGJpdCAzMSBpcyAxLiAqLwogCXJlYWRfbmljX2R3b3JkKGRldiwgUVBOUiwgJnRtcCk7CiAJ
d2hpbGUgKHRtcCAmIDB4ODAwMDAwMDApIHsKLQkJLyogSWYgRlcgY2FuIG5vdCBmaW5pc2ggUkYt
Ui9XIGZvciBtb3JlIHRoYW4gPz8gdGltZXMuCisJCS8qCisJCSAqIElmIEZXIGNhbiBub3QgZmlu
aXNoIFJGLVIvVyBmb3IgbW9yZSB0aGFuID8/IHRpbWVzLgogCQkgKiBXZSBtdXN0IHJlc2V0IEZX
LgogCQkgKi8KIAkJaWYgKHRpbWUrKyA8IDEwMCkgewpAQCAtNDU1LDExICs0NTcsMTMgQEAgc3Rh
dGljIHZvaWQgcGh5X0Z3UkZTZXJpYWxXcml0ZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCQkJ
YnJlYWs7CiAJCX0KIAl9Ci0JLyogNy4gTm8gbWF0dGVyIGNoZWNrIGJpdC4gV2UgYWx3YXlzIGZv
cmNlIHRoZSB3cml0ZS4KKwkvKgorCSAqIDcuIE5vIG1hdHRlciBjaGVjayBiaXQuIFdlIGFsd2F5
cyBmb3JjZSB0aGUgd3JpdGUuCiAJICogQmVjYXVzZSBGVyB3aWxsIG5vdCBhY2NlcHQgdGhlIGNv
bW1hbmQuCiAJICovCiAJd3JpdGVfbmljX2R3b3JkKGRldiwgUVBOUiwgZGF0YSk7Ci0JLyogQWNj
b3JkaW5nIHRvIHRlc3QsIHdlIG11c3QgZGVsYXkgMjB1cyB0byB3YWl0IGZpcm13YXJlCisJLyoK
KwkgKiBBY2NvcmRpbmcgdG8gdGVzdCwgd2UgbXVzdCBkZWxheSAyMHVzIHRvIHdhaXQgZmlybXdh
cmUKIAkgKiB0byBmaW5pc2ggUkYgd3JpdGUgb3BlcmF0aW9uLgogCSAqLwogCS8qIFdlIHN1cHBv
cnQgZGVsYXkgaW4gZmlybXdhcmUgc2lkZSBub3cuICovCkBAIC04MjgsNyArODMyLDggQEAgc3Rh
dGljIHZvaWQgcnRsODE5Ml9CQl9Db25maWdfUGFyYUZpbGUoc3RydWN0IG5ldF9kZXZpY2UgKmRl
dikKIAkJCQkgcmVnX3UzMik7CiAJfQoKLQkvKiBDaGVjayBpZiB0aGUgQ0NLIEhpZ2hQb3dlciBp
cyB0dXJuZWQgT04uCisJLyoKKwkgKiBDaGVjayBpZiB0aGUgQ0NLIEhpZ2hQb3dlciBpcyB0dXJu
ZWQgT04uCiAJICogVGhpcyBpcyB1c2VkIHRvIGNhbGN1bGF0ZSBQV0RCLgogCSAqLwogCXByaXYt
PmJDY2tIaWdoUG93ZXIgPSAodTgpcnRsODE5Ml9RdWVyeUJCUmVnKGRldiwKQEAgLTg0Nyw3ICs4
NTIsOCBAQCBzdGF0aWMgdm9pZCBydGw4MTkyX0JCX0NvbmZpZ19QYXJhRmlsZShzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2KQogdm9pZCBydGw4MTkyX0JCQ29uZmlnKHN0cnVjdCBuZXRfZGV2aWNlICpk
ZXYpCiB7CiAJcnRsODE5Ml9Jbml0QkJSRlJlZ0RlZihkZXYpOwotCS8qIGNvbmZpZyBCQiZSRi4g
QXMgaGFyZENvZGUgYmFzZWQgaW5pdGlhbGl6YXRpb24gaGFzIG5vdCBiZWVuIHdlbGwKKwkvKgor
CSAqIGNvbmZpZyBCQiZSRi4gQXMgaGFyZENvZGUgYmFzZWQgaW5pdGlhbGl6YXRpb24gaGFzIG5v
dCBiZWVuIHdlbGwKIAkgKiBpbXBsZW1lbnRlZCwgc28gdXNlIGZpbGUgZmlyc3QuCiAJICogRklY
TUU6IHNob3VsZCBpbXBsZW1lbnQgaXQgZm9yIGhhcmRjb2RlPwogCSAqLwpAQCAtMTE2OCw3ICsx
MTc0LDggQEAgYm9vbCBydGw4MTkyX1NldFJGUG93ZXJTdGF0ZShzdHJ1Y3QgbmV0X2RldmljZSAq
ZGV2LAogCQljYXNlIFJGXzgyNTY6CiAJCQlzd2l0Y2ggKHBIYWxEYXRhLT5lUkZQb3dlclN0YXRl
KSB7CiAJCQljYXNlIGVSZk9mZjoKLQkJCQkvKiBJZiBSZiBvZmYgcmVhc29uIGlzIGZyb20gSVBT
LAorCQkJCS8qCisJCQkJICogSWYgUmYgb2ZmIHJlYXNvbiBpcyBmcm9tIElQUywKIAkJCQkgKiBM
RUQgc2hvdWxkIGJsaW5rIHdpdGggbm8gbGluawogCQkJCSAqLwogCQkJCWlmIChwTWdudEluZm8t
PlJmT2ZmUmVhc29uID09IFJGX0NIQU5HRV9CWV9JUFMpCkBAIC0xMTc5LDcgKzExODYsOCBAQCBi
b29sIHJ0bDgxOTJfU2V0UkZQb3dlclN0YXRlKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCiAJCQkJ
YnJlYWs7CgogCQkJY2FzZSBlUmZPbjoKLQkJCQkvKiBUdXJuIG9uIFJGIHdlIGFyZSBzdGlsbCBs
aW5rZWQsIHdoaWNoIG1pZ2h0CisJCQkJLyoKKwkJCQkgKiBUdXJuIG9uIFJGIHdlIGFyZSBzdGls
bCBsaW5rZWQsIHdoaWNoIG1pZ2h0CiAJCQkJICogaGFwcGVuIHdoZW4gd2UgcXVpY2tseSB0dXJu
IG9mZiBhbmQgb24gSFcgUkYuCiAJCQkJICovCiAJCQkJaWYgKHBNZ250SW5mby0+Yk1lZGlhQ29u
bmVjdCkKQEAgLTEyNzQsNyArMTI4Miw4IEBAIHN0YXRpYyB1OCBydGw4MTkyX3BoeV9Td0NobmxT
dGVwQnlTdGVwKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHU4IGNoYW5uZWwsCiAJCSBfX2Z1bmNf
XywgKnN0YWdlLCAqc3RlcCwgY2hhbm5lbCk7CiAJaWYgKCFpc19sZWdhbF9jaGFubmVsKHByaXYt
PmllZWU4MDIxMSwgY2hhbm5lbCkpIHsKIAkJUlRfVFJBQ0UoQ09NUF9FUlIsICJzZXQgdG8gaWxs
ZWdhbCBjaGFubmVsOiAlZFxuIiwgY2hhbm5lbCk7Ci0JCS8qIHJldHVybiB0cnVlIHRvIHRlbGwg
dXBwZXIgY2FsbGVyIGZ1bmN0aW9uIHRoaXMgY2hhbm5lbAorCQkvKgorCQkgKiByZXR1cm4gdHJ1
ZSB0byB0ZWxsIHVwcGVyIGNhbGxlciBmdW5jdGlvbiB0aGlzIGNoYW5uZWwKIAkJICogc2V0dGlu
ZyBpcyBmaW5pc2hlZCEgT3IgaXQgd2lsbCBpbiB3aGlsZSBsb29wLgogCQkgKi8KIAkJcmV0dXJu
IHRydWU7CkBAIC0xNjIxLDcgKzE2MzAsOCBAQCB2b2lkIHJ0bDgxOTJfU2V0QldNb2RlV29ya0l0
ZW0oc3RydWN0IG5ldF9kZXZpY2UgKmRldikKIAkJYnJlYWs7CgogCX0KLQkvKiBTa2lwIG92ZXIg
c2V0dGluZyBvZiBKLW1vZGUgaW4gQkIgcmVnaXN0ZXIgaGVyZS4KKwkvKgorCSAqIFNraXAgb3Zl
ciBzZXR0aW5nIG9mIEotbW9kZSBpbiBCQiByZWdpc3RlciBoZXJlLgogCSAqIERlZmF1bHQgdmFs
dWUgaXMgIk5vbmUgSiBtb2RlIi4KIAkgKi8KCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcv
cnRsODE5MnUvcjgxOXhVX3BoeS5oIGIvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTl4VV9w
aHkuaAppbmRleCA4YzI5MzMyNjQ0MDcuLmIxOTc0NjcxZmRjOSAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTl4VV9waHkuaAorKysgYi9kcml2ZXJzL3N0YWdpbmcvcnRs
ODE5MnUvcjgxOXhVX3BoeS5oCkBAIC04LDggKzgsOCBAQAogI2RlZmluZSBNQVhfUE9TVENNRF9D
TlQgMTYKCiBlbnVtIGJhc2ViYW5kX2NvbmZpZ190eXBlIHsKLQlCQVNFQkFORF9DT05GSUdfUEhZ
X1JFRyA9IDAsCQkJLy9SYWRpbyBQYXRoIEEKLQlCQVNFQkFORF9DT05GSUdfQUdDX1RBQiA9IDEs
CQkJLy9SYWRpbyBQYXRoIEIKKwlCQVNFQkFORF9DT05GSUdfUEhZX1JFRyA9IDAsCQkJLyogUmFk
aW8gUGF0aCBBICovCisJQkFTRUJBTkRfQ09ORklHX0FHQ19UQUIgPSAxLAkJCS8qIFJhZGlvIFBh
dGggQiAqLwogfTsKCiBlbnVtIHN3aXRjaF9jaGFuX2NtZF9pZCB7CmRpZmYgLS1naXQgYS9kcml2
ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX3BoeXJlZy5oIGIvZHJpdmVycy9zdGFnaW5nL3J0
bDgxOTJ1L3I4MTl4VV9waHlyZWcuaAppbmRleCBkYzlkZGYxMDBlYWIuLmFmN2Q5YjhmZWU3ZiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL3J0bDgxOTJ1L3I4MTl4VV9waHlyZWcuaAorKysg
Yi9kcml2ZXJzL3N0YWdpbmcvcnRsODE5MnUvcjgxOXhVX3BoeXJlZy5oCkBAIC05Niw3ICs5Niw4
IEBACiAjZGVmaW5lIHJUeEFHQ19NY3MxNV9NY3MxMgkJCTB4ZTFjCgoKLS8qIFJGCisvKgorICog
UkYKICAqIFplYnJhMQogICovCiAjZGVmaW5lIHJaZWJyYTFfQ2hhbm5lbAkJCQkweDcKQEAgLTEw
NCw3ICsxMDUsOCBAQAogLyogWmVicmE0ICovCiAjZGVmaW5lIHJHbG9iYWxDdHJsCQkJCTAKCi0v
KiBCaXQgTWFzaworLyoKKyAqIEJpdCBNYXNrCiAgKiBwYWdlLTgKICAqLwogI2RlZmluZSBiUkZN
T0QJCQkJCQkweDEKQEAgLTEyNiw3ICsxMjgsOCBAQAogLyogcGFnZSBlICovCiAjZGVmaW5lIGJU
eEFHQ1JhdGVDQ0sJCQkweDdmMDAKCi0vKiBSRgorLyoKKyAqIFJGCiAgKiBaZWJyYTEKICAqLwog
I2RlZmluZSBiWmVicmExX0NoYW5uZWxOdW0gICAgICAgIDB4ZjgwCi0tCjIuMTcuMQoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZGV2ZWwgbWFpbGluZyBs
aXN0CmRldmVsQGxpbnV4ZHJpdmVycHJvamVjdC5vcmcKaHR0cDovL2RyaXZlcmRldi5saW51eGRy
aXZlcnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8vZHJpdmVyZGV2LWRldmVsCg==
