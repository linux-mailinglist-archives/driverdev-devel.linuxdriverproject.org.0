Return-Path: <driverdev-devel-bounces@linuxdriverproject.org>
X-Original-To: lists+driverdev-devel@lfdr.de
Delivered-To: lists+driverdev-devel@lfdr.de
Received: from whitealder.osuosl.org (smtp1.osuosl.org [140.211.166.138])
	by mail.lfdr.de (Postfix) with ESMTPS id E5EC0279129
	for <lists+driverdev-devel@lfdr.de>; Fri, 25 Sep 2020 20:53:54 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by whitealder.osuosl.org (Postfix) with ESMTP id 82C5D86BAC;
	Fri, 25 Sep 2020 18:53:52 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from whitealder.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 8qQV+NGpjHTL; Fri, 25 Sep 2020 18:53:51 +0000 (UTC)
Received: from ash.osuosl.org (ash.osuosl.org [140.211.166.34])
	by whitealder.osuosl.org (Postfix) with ESMTP id 81BCA86D06;
	Fri, 25 Sep 2020 18:53:10 +0000 (UTC)
X-Original-To: devel@linuxdriverproject.org
Delivered-To: driverdev-devel@osuosl.org
Received: from silver.osuosl.org (smtp3.osuosl.org [140.211.166.136])
 by ash.osuosl.org (Postfix) with ESMTP id DE5F61BF330
 for <devel@linuxdriverproject.org>; Fri, 25 Sep 2020 18:53:08 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by silver.osuosl.org (Postfix) with ESMTP id B892320452
 for <devel@linuxdriverproject.org>; Fri, 25 Sep 2020 18:53:08 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from silver.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id BfM31j4OFWe8 for <devel@linuxdriverproject.org>;
 Fri, 25 Sep 2020 18:52:46 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mail-oi1-f195.google.com (mail-oi1-f195.google.com
 [209.85.167.195])
 by silver.osuosl.org (Postfix) with ESMTPS id 3570B2E176
 for <devel@driverdev.osuosl.org>; Fri, 25 Sep 2020 18:52:46 +0000 (UTC)
Received: by mail-oi1-f195.google.com with SMTP id a3so3834613oib.4
 for <devel@driverdev.osuosl.org>; Fri, 25 Sep 2020 11:52:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=baylibre-com.20150623.gappssmtp.com; s=20150623;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=7Y5RxXp0iaV5YzPgj8bZQ+BGveh8M95rtiqfjTgddEs=;
 b=IZ2FVDZvDeO99Hv8BHXMix/EiP0XjTzYu7waGOeZWFpovdc2elAqbSTMTbJgFXuDwP
 czKObHAsqhSpHX2OlaUjqsCjJWxCpNTWPKnd+OKrXFRT1MS2xrR1ckmZHgm9d7FY5vdF
 qGyz0BNTXNbuzpAKHGlME7vqn5lwt7lmQZFXJlwrtNEvDZlzWGtUBI5CV6ZSS+1L1CCK
 +5ZGdggPA04BYt0kyMXgQYdCphdSDloBSh/wxCcqia8FMIUIEDbmypxHo0ISmMmtaJqV
 N8T91TtmwfSC37x/SCmx48Gpy9r9OZSpAxn+zWeGE3+bfxtL6pWfrSBcS4Z9y5zGALVJ
 hZPA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=7Y5RxXp0iaV5YzPgj8bZQ+BGveh8M95rtiqfjTgddEs=;
 b=Kf0kdD3ZFP8Nvmo2N8lDlWD6a2MzSA2FIyC7CeJJgCKH4PTAlwX73u8Jzy5tItnP4s
 5fdQYKO4g8P4RMTt5xUfsIqDu5A1wqgnzjS0rjImagGjP5zFMYe9ho//Ed9jCkSasS0j
 w7GpjTJxXYss+auGOV+IyQhIIMBbuqcvgS2Ogivcj3htJcmQFhhs+2fgoN97ZnyRY+KH
 AlTt+re9ilqiet4cjcuDFr3QgnHLVSUIyQ9UWTklL9yOf23T+KQYdU4XDxS+cZBkE6TI
 qcv5ePsmsw3I5OtrI20vNx/17ICwTBa0H8MszwhrniB8FerC6eINwxqlw4zoXDHcOcc5
 fj2g==
X-Gm-Message-State: AOAM533gnLhn9M1y+jBEHCbyV20Rtb/nc7ylBM8Z0+WNRtym3cD9Ampc
 4379JNQk3VDoZhHbuHXcjHVI040dCHWfZQ==
X-Google-Smtp-Source: ABdhPJwItDZKuOc6gZncOey8m9ivCtJWoxn1tzczA/NO7gOpUtIPN5FyFH4Tx41K+pAF8tsB3QfN+Q==
X-Received: by 2002:a17:90a:d986:: with SMTP id
 d6mr804928pjv.108.1601058683636; 
 Fri, 25 Sep 2020 11:31:23 -0700 (PDT)
Received: from localhost.localdomain ([51.15.160.169])
 by smtp.googlemail.com with ESMTPSA id r16sm2554546pjo.19.2020.09.25.11.31.15
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Fri, 25 Sep 2020 11:31:22 -0700 (PDT)
From: Corentin Labbe <clabbe@baylibre.com>
To: gregkh@linuxfoundation.org, mchehab@kernel.org, hverkuil@xs4all.nl,
 laurent.pinchart@ideasonboard.com
Subject: [PATCH RFT/RFC v2 01/47] staging: media: Revert "media: zoran: remove
 deprecated driver"
Date: Fri, 25 Sep 2020 18:30:11 +0000
Message-Id: <1601058657-14042-2-git-send-email-clabbe@baylibre.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1601058657-14042-1-git-send-email-clabbe@baylibre.com>
References: <1601058657-14042-1-git-send-email-clabbe@baylibre.com>
MIME-Version: 1.0
X-BeenThere: driverdev-devel@linuxdriverproject.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux Driver Project Developer List
 <driverdev-devel.linuxdriverproject.org>
List-Unsubscribe: <http://driverdev.linuxdriverproject.org/mailman/options/driverdev-devel>, 
 <mailto:driverdev-devel-request@linuxdriverproject.org?subject=unsubscribe>
List-Archive: <http://driverdev.linuxdriverproject.org/pipermail/driverdev-devel/>
List-Post: <mailto:driverdev-devel@linuxdriverproject.org>
List-Help: <mailto:driverdev-devel-request@linuxdriverproject.org?subject=help>
List-Subscribe: <http://driverdev.linuxdriverproject.org/mailman/listinfo/driverdev-devel>, 
 <mailto:driverdev-devel-request@linuxdriverproject.org?subject=subscribe>
Cc: devel@driverdev.osuosl.org, Corentin Labbe <clabbe@baylibre.com>,
 linux-kernel@vger.kernel.org, linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: driverdev-devel-bounces@linuxdriverproject.org
Sender: "devel" <driverdev-devel-bounces@linuxdriverproject.org>

VGhpcyByZXZlcnRzIGNvbW1pdCA4ZGNlNGIyNjVhNTM1NzczMTA1OGY2OTY0NTg0MGRhYmM3MThj
Njg3LgpUaGUgcmV2ZXJ0IGlzIHNsaWdobHkgbW9kaWZpZWQ6Ci0gRG9jdW1lbnRhdGlvbi9tZWRp
YS92NGwtZHJpdmVycy9pbmRleC5yc3QgaXMgLG90IHJlc3RvcmVkIHNpbmNlIHJlbW92ZWQgZnJv
bSB0cmVlCi0gZHJpdmVycy9zdGFnaW5nL21lZGlhL01ha2VmaWxlIGlzIG5vdCByZXN0b3JlZCBz
aW5jZSB0aGUgem9yYW4gZHJpdmVyCiAgaXMgbm90IGNvbXBpbGFibGUgeWV0LgoKU2lnbmVkLW9m
Zi1ieTogQ29yZW50aW4gTGFiYmUgPGNsYWJiZUBiYXlsaWJyZS5jb20+Ci0tLQogRG9jdW1lbnRh
dGlvbi9tZWRpYS92NGwtZHJpdmVycy96b3Jhbi5yc3QgIHwgIDU4MyArKysrCiBkcml2ZXJzL3N0
YWdpbmcvbWVkaWEvS2NvbmZpZyAgICAgICAgICAgICAgfCAgICAyICsKIGRyaXZlcnMvc3RhZ2lu
Zy9tZWRpYS96b3Jhbi9LY29uZmlnICAgICAgICB8ICAgNzUgKwogZHJpdmVycy9zdGFnaW5nL21l
ZGlhL3pvcmFuL01ha2VmaWxlICAgICAgIHwgICAgNyArCiBkcml2ZXJzL3N0YWdpbmcvbWVkaWEv
em9yYW4vVE9ETyAgICAgICAgICAgfCAgICA0ICsKIGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jh
bi92aWRlb2NvZGVjLmMgICB8ICAzOTEgKysrCiBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4v
dmlkZW9jb2RlYy5oICAgfCAgMzQ5ICsrKwogZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pv
cmFuLmggICAgICAgIHwgIDQwMiArKysKIGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96b3Jh
bl9jYXJkLmMgICB8IDE1MjQgKysrKysrKysrKysKIGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jh
bi96b3Jhbl9jYXJkLmggICB8ICAgNTAgKwogZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pv
cmFuX2RldmljZS5jIHwgMTYxOSArKysrKysrKysrKwogZHJpdmVycy9zdGFnaW5nL21lZGlhL3pv
cmFuL3pvcmFuX2RldmljZS5oIHwgICA5MSArCiBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4v
em9yYW5fZHJpdmVyLmMgfCAyODUwICsrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL3N0YWdp
bmcvbWVkaWEvem9yYW4vem9yYW5fcHJvY2ZzLmMgfCAgMjIxICsrCiBkcml2ZXJzL3N0YWdpbmcv
bWVkaWEvem9yYW4vem9yYW5fcHJvY2ZzLmggfCAgIDMyICsKIGRyaXZlcnMvc3RhZ2luZy9tZWRp
YS96b3Jhbi96cjM2MDE2LmMgICAgICB8ICA1MTYgKysrKwogZHJpdmVycy9zdGFnaW5nL21lZGlh
L3pvcmFuL3pyMzYwMTYuaCAgICAgIHwgIDEwNyArCiBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9y
YW4venIzNjA1MC5jICAgICAgfCAgODk2ICsrKysrKwogZHJpdmVycy9zdGFnaW5nL21lZGlhL3pv
cmFuL3pyMzYwNTAuaCAgICAgIHwgIDE3OSArKwogZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFu
L3pyMzYwNTcuaCAgICAgIHwgIDE2NCArKwogZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3py
MzYwNjAuYyAgICAgIHwgMTAwNiArKysrKysrCiBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4v
enIzNjA2MC5oICAgICAgfCAgMjE2ICsrCiAyMiBmaWxlcyBjaGFuZ2VkLCAxMTI4NCBpbnNlcnRp
b25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgRG9jdW1lbnRhdGlvbi9tZWRpYS92NGwtZHJpdmVy
cy96b3Jhbi5yc3QKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9y
YW4vS2NvbmZpZwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jh
bi9NYWtlZmlsZQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jh
bi9UT0RPCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3Zp
ZGVvY29kZWMuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jh
bi92aWRlb2NvZGVjLmgKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvbWVkaWEv
em9yYW4vem9yYW4uaAogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96
b3Jhbi96b3Jhbl9jYXJkLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvbWVk
aWEvem9yYW4vem9yYW5fY2FyZC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5n
L21lZGlhL3pvcmFuL3pvcmFuX2RldmljZS5jCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9z
dGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX2RldmljZS5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX2RyaXZlci5jCiBjcmVhdGUgbW9kZSAxMDA2
NDQgZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX3Byb2Nmcy5jCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX3Byb2Nmcy5oCiBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pyMzYwMTYuYwogY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDE2LmgKIGNy
ZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4venIzNjA1MC5jCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pyMzYwNTAuaAog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDU3LmgK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4venIzNjA2MC5j
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pyMzYwNjAu
aAoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vbWVkaWEvdjRsLWRyaXZlcnMvem9yYW4ucnN0
IGIvRG9jdW1lbnRhdGlvbi9tZWRpYS92NGwtZHJpdmVycy96b3Jhbi5yc3QKbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5kMjcyNGE4NjNkMWQKLS0tIC9kZXYvbnVsbAor
KysgYi9Eb2N1bWVudGF0aW9uL21lZGlhL3Y0bC1kcml2ZXJzL3pvcmFuLnJzdApAQCAtMCwwICsx
LDU4MyBAQAorLi4gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKworVGhlIFpvcmFu
IGRyaXZlcgorPT09PT09PT09PT09PT09PQorCit1bmlmaWVkIHpvcmFuIGRyaXZlciAoenIzNjB4
Nywgem9yYW4sIGJ1eiwgZGMxMCgrKSwgZGMzMCgrKSwgbG1sMzMpCisKK3dlYnNpdGU6IGh0dHA6
Ly9tanBlZy5zb3VyY2Vmb3JnZS5uZXQvZHJpdmVyLXpvcmFuLworCisKK0ZyZXF1ZW50bHkgQXNr
ZWQgUXVlc3Rpb25zCistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCitXaGF0IGNhcmRzIGFy
ZSBzdXBwb3J0ZWQKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCitJb21lZ2EgQnV6LCBMaW51
eCBNZWRpYSBMYWJzIExNTDMzL0xNTDMzUjEwLCBQaW5uYWNsZS9NaXJvCitEQzEwL0RDMTArL0RD
MzAvREMzMCsgYW5kIHJlbGF0ZWQgYm9hcmRzIChhdmFpbGFibGUgdW5kZXIgdmFyaW91cyBuYW1l
cykuCisKK0lvbWVnYSBCdXoKK35+fn5+fn5+fn4KKworKiBab3JhbiB6cjM2MDY3IFBDSSBjb250
cm9sbGVyCisqIFpvcmFuIHpyMzYwNjAgTUpQRUcgY29kZWMKKyogUGhpbGlwcyBzYWE3MTExIFRW
IGRlY29kZXIKKyogUGhpbGlwcyBzYWE3MTg1IFRWIGVuY29kZXIKKworRHJpdmVycyB0byB1c2U6
IHZpZGVvZGV2LCBpMmMtY29yZSwgaTJjLWFsZ28tYml0LAordmlkZW9jb2RlYywgc2FhNzExMSwg
c2FhNzE4NSwgenIzNjA2MCwgenIzNjA2NworCitJbnB1dHMvb3V0cHV0czogQ29tcG9zaXRlIGFu
ZCBTLXZpZGVvCisKK05vcm1zOiBQQUwsIFNFQ0FNICg3MjB4NTc2IEAgMjUgZnBzKSwgTlRTQyAo
NzIweDQ4MCBAIDI5Ljk3IGZwcykKKworQ2FyZCBudW1iZXI6IDcKKworQXZlck1lZGlhIDYgRXll
cyBBVlM2RVlFUworfn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fgorCisqIFpvcmFuIHpyMzYwNjcg
UENJIGNvbnRyb2xsZXIKKyogWm9yYW4genIzNjA2MCBNSlBFRyBjb2RlYworKiBTYW1zdW5nIGtz
MDEyNyBUViBkZWNvZGVyCisqIENvbmV4YW50IGJ0ODY2ICBUViBlbmNvZGVyCisKK0RyaXZlcnMg
dG8gdXNlOiB2aWRlb2RldiwgaTJjLWNvcmUsIGkyYy1hbGdvLWJpdCwKK3ZpZGVvY29kZWMsIGtz
MDEyNywgYnQ4NjYsIHpyMzYwNjAsIHpyMzYwNjcKKworSW5wdXRzL291dHB1dHM6CisJU2l4IHBo
eXNpY2FsIGlucHV0cy4gMS02IGFyZSBjb21wb3NpdGUsCisJMS0yLCAzLTQsIDUtNiBkb3VibGVz
IGFzIFMtdmlkZW8sCisJMS0zIHRyaXBsZXMgYXMgY29tcG9uZW50LgorCU9uZSBjb21wb3NpdGUg
b3V0cHV0LgorCitOb3JtczogUEFMLCBTRUNBTSAoNzIweDU3NiBAIDI1IGZwcyksIE5UU0MgKDcy
MHg0ODAgQCAyOS45NyBmcHMpCisKK0NhcmQgbnVtYmVyOiA4CisKKy4uIG5vdGU6OgorCisgICBO
b3QgYXV0b2RldGVjdGVkLCBjYXJkPTggaXMgbmVjZXNzYXJ5LgorCitMaW51eCBNZWRpYSBMYWJz
IExNTDMzCit+fn5+fn5+fn5+fn5+fn5+fn5+fn5+CisKKyogWm9yYW4genIzNjA2NyBQQ0kgY29u
dHJvbGxlcgorKiBab3JhbiB6cjM2MDYwIE1KUEVHIGNvZGVjCisqIEJyb29rdHJlZSBidDgxOSBU
ViBkZWNvZGVyCisqIEJyb29rdHJlZSBidDg1NiBUViBlbmNvZGVyCisKK0RyaXZlcnMgdG8gdXNl
OiB2aWRlb2RldiwgaTJjLWNvcmUsIGkyYy1hbGdvLWJpdCwKK3ZpZGVvY29kZWMsIGJ0ODE5LCBi
dDg1NiwgenIzNjA2MCwgenIzNjA2NworCitJbnB1dHMvb3V0cHV0czogQ29tcG9zaXRlIGFuZCBT
LXZpZGVvCisKK05vcm1zOiBQQUwgKDcyMHg1NzYgQCAyNSBmcHMpLCBOVFNDICg3MjB4NDgwIEAg
MjkuOTcgZnBzKQorCitDYXJkIG51bWJlcjogNQorCitMaW51eCBNZWRpYSBMYWJzIExNTDMzUjEw
Cit+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+CisKKyogWm9yYW4genIzNjA2NyBQQ0kgY29udHJv
bGxlcgorKiBab3JhbiB6cjM2MDYwIE1KUEVHIGNvZGVjCisqIFBoaWxpcHMgc2FhNzExNCBUViBk
ZWNvZGVyCisqIEFuYWxvZyBEZXZpY2VzIGFkdjcxNzAgVFYgZW5jb2RlcgorCitEcml2ZXJzIHRv
IHVzZTogdmlkZW9kZXYsIGkyYy1jb3JlLCBpMmMtYWxnby1iaXQsCit2aWRlb2NvZGVjLCBzYWE3
MTE0LCBhZHY3MTcwLCB6cjM2MDYwLCB6cjM2MDY3CisKK0lucHV0cy9vdXRwdXRzOiBDb21wb3Np
dGUgYW5kIFMtdmlkZW8KKworTm9ybXM6IFBBTCAoNzIweDU3NiBAIDI1IGZwcyksIE5UU0MgKDcy
MHg0ODAgQCAyOS45NyBmcHMpCisKK0NhcmQgbnVtYmVyOiA2CisKK1Bpbm5hY2xlL01pcm8gREMx
MChuZXcpCit+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fgorCisqIFpvcmFuIHpyMzYwNTcgUENJIGNv
bnRyb2xsZXIKKyogWm9yYW4genIzNjA2MCBNSlBFRyBjb2RlYworKiBQaGlsaXBzIHNhYTcxMTBh
IFRWIGRlY29kZXIKKyogQW5hbG9nIERldmljZXMgYWR2NzE3NiBUViBlbmNvZGVyCisKK0RyaXZl
cnMgdG8gdXNlOiB2aWRlb2RldiwgaTJjLWNvcmUsIGkyYy1hbGdvLWJpdCwKK3ZpZGVvY29kZWMs
IHNhYTcxMTAsIGFkdjcxNzUsIHpyMzYwNjAsIHpyMzYwNjcKKworSW5wdXRzL291dHB1dHM6IENv
bXBvc2l0ZSwgUy12aWRlbyBhbmQgSW50ZXJuYWwKKworTm9ybXM6IFBBTCwgU0VDQU0gKDc2OHg1
NzYgQCAyNSBmcHMpLCBOVFNDICg2NDB4NDgwIEAgMjkuOTcgZnBzKQorCitDYXJkIG51bWJlcjog
MQorCitQaW5uYWNsZS9NaXJvIERDMTArCit+fn5+fn5+fn5+fn5+fn5+fn5+CisKKyogWm9yYW4g
enIzNjA2NyBQQ0kgY29udHJvbGxlcgorKiBab3JhbiB6cjM2MDYwIE1KUEVHIGNvZGVjCisqIFBo
aWxpcHMgc2FhNzExMGEgVFYgZGVjb2RlcgorKiBBbmFsb2cgRGV2aWNlcyBhZHY3MTc2IFRWIGVu
Y29kZXIKKworRHJpdmVycyB0byB1c2U6IHZpZGVvZGV2LCBpMmMtY29yZSwgaTJjLWFsZ28tYml0
LAordmlkZW9jb2RlYywgc2E3MTEwLCBhZHY3MTc1LCB6cjM2MDYwLCB6cjM2MDY3CisKK0lucHV0
cy9vdXRwdXRzOiBDb21wb3NpdGUsIFMtdmlkZW8gYW5kIEludGVybmFsCisKK05vcm1zOiBQQUws
IFNFQ0FNICg3Njh4NTc2IEAgMjUgZnBzKSwgTlRTQyAoNjQweDQ4MCBAIDI5Ljk3IGZwcykKKwor
Q2FyZCBudW1iZXI6IDIKKworUGlubmFjbGUvTWlybyBEQzEwKG9sZCkKK35+fn5+fn5+fn5+fn5+
fn5+fn5+fn5+CisKKyogWm9yYW4genIzNjA1NyBQQ0kgY29udHJvbGxlcgorKiBab3JhbiB6cjM2
MDUwIE1KUEVHIGNvZGVjCisqIFpvcmFuIHpyMzYwMTYgVmlkZW8gRnJvbnQgRW5kIG9yIEZ1amkg
bWQwMjExIFZpZGVvIEZyb250IEVuZCAoY2xvbmU/KQorKiBNaWNyb25hcyB2cHgzMjIwYSBUViBk
ZWNvZGVyCisqIG1zZTMwMDAgVFYgZW5jb2RlciBvciBBbmFsb2cgRGV2aWNlcyBhZHY3MTc2IFRW
IGVuY29kZXIKKworRHJpdmVycyB0byB1c2U6IHZpZGVvZGV2LCBpMmMtY29yZSwgaTJjLWFsZ28t
Yml0LAordmlkZW9jb2RlYywgdnB4MzIyMCwgbXNlMzAwMC9hZHY3MTc1LCB6cjM2MDUwLCB6cjM2
MDE2LCB6cjM2MDY3CisKK0lucHV0cy9vdXRwdXRzOiBDb21wb3NpdGUsIFMtdmlkZW8gYW5kIElu
dGVybmFsCisKK05vcm1zOiBQQUwsIFNFQ0FNICg3Njh4NTc2IEAgMjUgZnBzKSwgTlRTQyAoNjQw
eDQ4MCBAIDI5Ljk3IGZwcykKKworQ2FyZCBudW1iZXI6IDAKKworUGlubmFjbGUvTWlybyBEQzMw
Cit+fn5+fn5+fn5+fn5+fn5+fn4KKworKiBab3JhbiB6cjM2MDU3IFBDSSBjb250cm9sbGVyCisq
IFpvcmFuIHpyMzYwNTAgTUpQRUcgY29kZWMKKyogWm9yYW4genIzNjAxNiBWaWRlbyBGcm9udCBF
bmQKKyogTWljcm9uYXMgdnB4MzIyNWQvdnB4MzIyMGEvdnB4MzIxNmIgVFYgZGVjb2RlcgorKiBB
bmFsb2cgRGV2aWNlcyBhZHY3MTc2IFRWIGVuY29kZXIKKworRHJpdmVycyB0byB1c2U6IHZpZGVv
ZGV2LCBpMmMtY29yZSwgaTJjLWFsZ28tYml0LAordmlkZW9jb2RlYywgdnB4MzIyMC92cHgzMjI0
LCBhZHY3MTc1LCB6cjM2MDUwLCB6cjM2MDE2LCB6cjM2MDY3CisKK0lucHV0cy9vdXRwdXRzOiBD
b21wb3NpdGUsIFMtdmlkZW8gYW5kIEludGVybmFsCisKK05vcm1zOiBQQUwsIFNFQ0FNICg3Njh4
NTc2IEAgMjUgZnBzKSwgTlRTQyAoNjQweDQ4MCBAIDI5Ljk3IGZwcykKKworQ2FyZCBudW1iZXI6
IDMKKworUGlubmFjbGUvTWlybyBEQzMwKworfn5+fn5+fn5+fn5+fn5+fn5+fgorCisqIFpvcmFu
IHpyMzYwNjcgUENJIGNvbnRyb2xsZXIKKyogWm9yYW4genIzNjA1MCBNSlBFRyBjb2RlYworKiBa
b3JhbiB6cjM2MDE2IFZpZGVvIEZyb250IEVuZAorKiBNaWNyb25hcyB2cHgzMjI1ZC92cHgzMjIw
YS92cHgzMjE2YiBUViBkZWNvZGVyCisqIEFuYWxvZyBEZXZpY2VzIGFkdjcxNzYgVFYgZW5jb2Rl
cgorCitEcml2ZXJzIHRvIHVzZTogdmlkZW9kZXYsIGkyYy1jb3JlLCBpMmMtYWxnby1iaXQsCit2
aWRlb2NvZGVjLCB2cHgzMjIwL3ZweDMyMjQsIGFkdjcxNzUsIHpyMzYwNTAsIHpyMzYwMTUsIHpy
MzYwNjcKKworSW5wdXRzL291dHB1dHM6IENvbXBvc2l0ZSwgUy12aWRlbyBhbmQgSW50ZXJuYWwK
KworTm9ybXM6IFBBTCwgU0VDQU0gKDc2OHg1NzYgQCAyNSBmcHMpLCBOVFNDICg2NDB4NDgwIEAg
MjkuOTcgZnBzKQorCitDYXJkIG51bWJlcjogNAorCisuLiBub3RlOjoKKworICAgIykgTm8gbW9k
dWxlIGZvciB0aGUgbXNlMzAwMCBpcyBhdmFpbGFibGUgeWV0CisgICAjKSBObyBtb2R1bGUgZm9y
IHRoZSB2cHgzMjI0IGlzIGF2YWlsYWJsZSB5ZXQKKworMS4xIFdoYXQgdGhlIFRWIGRlY29kZXIg
Y2FuIGRvIGFuIHdoYXQgbm90CistLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KKworVGhlIGJlc3Qga25vdyBUViBzdGFuZGFyZHMgYXJlIE5UU0MvUEFML1NFQ0FNLiBi
dXQgZm9yIGRlY29kaW5nIGEgZnJhbWUgdGhhdAoraW5mb3JtYXRpb24gaXMgbm90IGVub3VnaC4g
VGhlcmUgYXJlIHNldmVyYWwgZm9ybWF0cyBvZiB0aGUgVFYgc3RhbmRhcmRzLgorQW5kIG5vdCBl
dmVyeSBUViBkZWNvZGVyIGlzIGFibGUgdG8gaGFuZGxlIGV2ZXJ5IGZvcm1hdC4gQWxzbyB0aGUg
ZXZlcnkKK2NvbWJpbmF0aW9uIGlzIHN1cHBvcnRlZCBieSB0aGUgZHJpdmVyLiBUaGVyZSBhcmUg
Y3VycmVudGx5IDExIGRpZmZlcmVudAordHYgYnJvYWRjYXN0IGZvcm1hdHMgYWxsIGF2ZXIgdGhl
IHdvcmxkLgorCitUaGUgQ0NJUiBkZWZpbmVzIHBhcmFtZXRlcnMgbmVlZGVkIGZvciBicm9hZGNh
c3RpbmcgdGhlIHNpZ25hbC4KK1RoZSBDQ0lSIGhhcyBkZWZpbmVkIGRpZmZlcmVudCBzdGFuZGFy
ZHM6IEEsQixELEUsRixHLEQsSCxJLEssSzEsTCxNLE4sLi4uCitUaGUgQ0NJUiBzYXlzIG5vdCBt
dWNoIGFib3V0IHRoZSBjb2xvcnN5c3RlbSB1c2VkICEhIQorQW5kIHRhbGtpbmcgYWJvdXQgYSBj
b2xvcnN5c3RlbSBzYXlzIG5vdCB0byBtdWNoIGFib3V0IGhvdyBpdCBpcyBicm9hZGNhc3QuCisK
K1RoZSBDQ0lSIHN0YW5kYXJkcyBBLEUsRiBhcmUgbm90IHVzZWQgYW55IG1vcmUuCisKK1doZW4g
eW91IHNwZWFrIGFib3V0IE5UU0MsIHlvdSB1c3VhbGx5IG1lYW4gdGhlIHN0YW5kYXJkOiBDQ0lS
IC0gTSB1c2luZwordGhlIE5UU0MgY29sb3JzeXN0ZW0gd2hpY2ggaXMgdXNlZCBpbiB0aGUgVVNB
LCBKYXBhbiwgTWV4aWNvLCBDYW5hZGEKK2FuZCBhIGZldyBvdGhlcnMuCisKK1doZW4geW91IHRh
bGsgYWJvdXQgUEFMLCB5b3UgdXN1YWxseSBtZWFuOiBDQ0lSIC0gQi9HIHVzaW5nIHRoZSBQQUwK
K2NvbG9yc3lzdGVtIHdoaWNoIGlzIHVzZWQgaW4gbWFueSBDb3VudHJpZXMuCisKK1doZW4geW91
IHRhbGsgYWJvdXQgU0VDQU0sIHlvdSBtZWFuOiBDQ0lSIC0gTCB1c2luZyB0aGUgU0VDQU0gQ29s
b3JzeXN0ZW0KK3doaWNoIGlzIHVzZWQgaW4gRnJhbmNlLCBhbmQgYSBmZXcgb3RoZXJzLgorCitU
aGVyZSB0aGUgb3RoZXIgdmVyc2lvbiBvZiBTRUNBTSwgQ0NJUiAtIEQvSyBpcyB1c2VkIGluIEJ1
bGdhcmlhLCBDaGluYSwKK1Nsb3Zha2FpLCBIdW5nYXJ5LCBLb3JlYSAoUmVwLiksIFBvbGFuZCwg
UnVtYW5pYSBhbmQgYSBvdGhlcnMuCisKK1RoZSBDQ0lSIC0gSCB1c2VzIHRoZSBQQUwgY29sb3Jz
eXN0ZW0gKHNvbWV0aW1lcyBTRUNBTSkgYW5kIGlzIHVzZWQgaW4KK0VneXB0LCBMaWJ5YSwgU3Jp
IExhbmthLCBTeXJhaW4gQXJhYi4gUmVwLgorCitUaGUgQ0NJUiAtIEkgdXNlcyB0aGUgUEFMIGNv
bG9yc3lzdGVtLCBhbmQgaXMgdXNlZCBpbiBHcmVhdCBCcml0YWluLCBIb25nIEtvbmcsCitJcmVs
YW5kLCBOaWdlcmlhLCBTb3V0aCBBZnJpY2EuCisKK1RoZSBDQ0lSIC0gTiB1c2VzIHRoZSBQQUwg
Y29sb3JzeXN0ZW0gYW5kIFBBTCBmcmFtZSBzaXplIGJ1dCB0aGUgTlRTQyBmcmFtZXJhdGUsCith
bmQgaXMgdXNlZCBpbiBBcmdlbnRpbmlhLCBVcnVndWF5LCBhbiBhIGZldyBvdGhlcnMKKworV2Ug
ZG8gbm90IHRhbGsgYWJvdXQgaG93IHRoZSBhdWRpbyBpcyBicm9hZGNhc3QgIQorCitBIHJhdGhl
ciBnb29kIHNpdGVzIGFib3V0IHRoZSBUViBzdGFuZGFyZHMgYXJlOgoraHR0cDovL3d3dy5zb255
LmpwL3N1cHBvcnQvCitodHRwOi8vaW5mby5lbGVjdHJvbmljd2Vya3N0YXR0LmRlL2JlcmVpY2hl
L2Zlcm5zZWh0ZWNobmlrL2ZyZXF1ZW56ZW5fdW5kX25vcm1lbi9GZXJuc2Vobm9ybWVuLworYW5k
IGh0dHA6Ly93d3cuY2FibC5jb20vcmVzdGF1cmFudC9jaGFubmVsLmh0bWwKKworT3RoZXIgd2Vp
cmQgdGhpbmdzIGFyb3VuZDogTlRTQyA0LjQzIGlzIGEgbW9kaWZpY2F0ZWQgTlRTQywgd2hpY2gg
aXMgbWFpbmx5Cit1c2VkIGluIFBBTCBWQ1IncyB0aGF0IGFyZSBhYmxlIHRvIHBsYXkgYmFjayBO
VFNDLiBQQUwgNjAgc2VlbXMgdG8gYmUgdGhlIHNhbWUKK2FzIE5UU0MgNC40MyAuIFRoZSBEYXRh
c2hlZXRzIGFsc28gdGFsayBhYm91dCBOVFNDIDQ0LCBJdCBzZWVtcyBhcyBpZiBpdCB3b3VsZAor
YmUgdGhlIHNhbWUgYXMgTlRTQyA0LjQzLgorTlRTQyBDb21icyBzZWVtcyB0byBiZSBhIGRlY29k
ZXIgbW9kZSB3aGVyZSB0aGUgZGVjb2RlciB1c2VzIGEgY29tYiBmaWx0ZXIKK3RvIHNwbGl0IGNv
bWEgYW5kIGx1bWEgaW5zdGVhZCBvZiBhIERlbGF5IGxpbmUuCisKK0J1dCBJIGRpZCBub3QgZGVm
aWFudGx5IGZpbmQgb3V0IHdoYXQgTlRTQyBDb21iIGlzLgorCitQaGlsaXBzIHNhYTcxMTEgVFYg
ZGVjb2Rlcgorfn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn4KKworLSB3YXMgaW50cm9kdWNlZCBp
biAxOTk3LCBpcyB1c2VkIGluIHRoZSBCVVogYW5kCistIGNhbiBoYW5kbGU6IFBBTCBCL0cvSC9J
LCBQQUwgTiwgUEFMIE0sIE5UU0MgTSwgTlRTQyBOLCBOVFNDIDQuNDMgYW5kIFNFQ0FNCisKK1Bo
aWxpcHMgc2FhNzExMGEgVFYgZGVjb2Rlcgorfn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+CisK
Ky0gd2FzIGludHJvZHVjZWQgaW4gMTk5NSwgaXMgdXNlZCBpbiB0aGUgUGlubmFjbGUvTWlybyBE
QzEwKG5ldyksIERDMTArIGFuZAorLSBjYW4gaGFuZGxlOiBQQUwgQi9HLCBOVFNDIE0gYW5kIFNF
Q0FNCisKK1BoaWxpcHMgc2FhNzExNCBUViBkZWNvZGVyCit+fn5+fn5+fn5+fn5+fn5+fn5+fn5+
fn5+fgorCistIHdhcyBpbnRyb2R1Y2VkIGluIDIwMDAsIGlzIHVzZWQgaW4gdGhlIExNTDMzUjEw
IGFuZAorLSBjYW4gaGFuZGxlOiBQQUwgQi9HL0QvSC9JL04sIFBBTCBOLCBQQUwgTSwgTlRTQyBN
LCBOVFNDIDQuNDMgYW5kIFNFQ0FNCisKK0Jyb29rdHJlZSBidDgxOSBUViBkZWNvZGVyCit+fn5+
fn5+fn5+fn5+fn5+fn5+fn5+fn5+fgorCistIHdhcyBpbnRyb2R1Y2VkIGluIDE5OTYsIGFuZCBp
cyB1c2VkIGluIHRoZSBMTUwzMyBhbmQKKy0gY2FuIGhhbmRsZTogUEFMIEIvRC9HL0gvSSwgTlRT
QyBNCisKK01pY3JvbmFzIHZweDMyMjBhIFRWIGRlY29kZXIKK35+fn5+fn5+fn5+fn5+fn5+fn5+
fn5+fn5+fn4KKworLSB3YXMgaW50cm9kdWNlZCBpbiAxOTk2LCBpcyB1c2VkIGluIHRoZSBEQzMw
IGFuZCBEQzMwKyBhbmQKKy0gY2FuIGhhbmRsZTogUEFMIEIvRy9IL0ksIFBBTCBOLCBQQUwgTSwg
TlRTQyBNLCBOVFNDIDQ0LCBQQUwgNjAsIFNFQ0FNLE5UU0MgQ29tYgorCitTYW1zdW5nIGtzMDEy
NyBUViBkZWNvZGVyCit+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+CisKKy0gaXMgdXNlZCBpbiB0
aGUgQVZTNkVZRVMgY2FyZCBhbmQKKy0gY2FuIGhhbmRsZTogTlRTQy1NL04vNDQsIFBBTC1NL04v
Qi9HL0gvSS9EL0svTCBhbmQgU0VDQU0KKworCitXaGF0IHRoZSBUViBlbmNvZGVyIGNhbiBkbyBh
biB3aGF0IG5vdAorLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKworVGhl
IFRWIGVuY29kZXIgYXJlIGRvaW5nIHRoZSAic2FtZSIgYXMgdGhlIGRlY29kZXIsIGJ1dCBpbiB0
aGUgb2RlciBkaXJlY3Rpb24uCitZb3UgZmVlZCB0aGVtIGRpZ2l0YWwgZGF0YSBhbmQgdGhlIGdl
bmVyYXRlIGEgQ29tcG9zaXRlIG9yIFNWSFMgc2lnbmFsLgorRm9yIGluZm9ybWF0aW9uIGFib3V0
IHRoZSBjb2xvcnN5c3RlbXMgYW5kIFRWIG5vcm0gdGFrZSBhIGxvb2sgaW4gdGhlCitUViBkZWNv
ZGVyIHNlY3Rpb24uCisKK1BoaWxpcHMgc2FhNzE4NSBUViBFbmNvZGVyCit+fn5+fn5+fn5+fn5+
fn5+fn5+fn5+fn5+fgorCistIHdhcyBpbnRyb2R1Y2VkIGluIDE5OTYsIGlzIHVzZWQgaW4gdGhl
IEJVWgorLSBjYW4gZ2VuZXJhdGU6IFBBTCBCL0csIE5UU0MgTQorCitCcm9va3RyZWUgYnQ4NTYg
VFYgRW5jb2Rlcgorfn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn4KKworLSB3YXMgaW50cm9kdWNl
ZCBpbiAxOTk0LCBpcyB1c2VkIGluIHRoZSBMTUwzMworLSBjYW4gZ2VuZXJhdGU6IFBBTCBCL0Qv
Ry9IL0kvTiwgUEFMIE0sIE5UU0MgTSwgUEFMLU4gKEFyZ2VudGluYSkKKworQW5hbG9nIERldmlj
ZXMgYWR2NzE3MCBUViBFbmNvZGVyCit+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn4K
KworLSB3YXMgaW50cm9kdWNlZCBpbiAyMDAwLCBpcyB1c2VkIGluIHRoZSBMTUwzMDBSMTAKKy0g
Y2FuIGdlbmVyYXRlOiBQQUwgQi9EL0cvSC9JL04sIFBBTCBNLCBOVFNDIE0sIFBBTCA2MAorCitB
bmFsb2cgRGV2aWNlcyBhZHY3MTc1IFRWIEVuY29kZXIKK35+fn5+fn5+fn5+fn5+fn5+fn5+fn5+
fn5+fn5+fn5+fgorCistIHdhcyBpbnRyb2R1Y2VkIGluIDE5OTYsIGlzIHVzZWQgaW4gdGhlIERD
MTAsIERDMTArLCBEQzEwIG9sZCwgREMzMCwgREMzMCsKKy0gY2FuIGdlbmVyYXRlOiBQQUwgQi9E
L0cvSC9JL04sIFBBTCBNLCBOVFNDIE0KKworSVRUIG1zZTMwMDAgVFYgZW5jb2Rlcgorfn5+fn5+
fn5+fn5+fn5+fn5+fn5+fgorCistIHdhcyBpbnRyb2R1Y2VkIGluIDE5OTEsIGlzIHVzZWQgaW4g
dGhlIERDMTAgb2xkCistIGNhbiBnZW5lcmF0ZTogUEFMICwgTlRTQyAsIFNFQ0FNCisKK0NvbmV4
YW50IGJ0ODY2IFRWIGVuY29kZXIKK35+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn4KKworLSBpcyB1
c2VkIGluIEFWUzZFWUVTLCBhbmQKKy0gY2FuIGdlbmVyYXRlOiBOVFNDL1BBTCwgUEFMwq1NLCBQ
QUzCrU4KKworVGhlIGFkdjcxN3gsIHNob3VsZCBiZSBhYmxlIHRvIHByb2R1Y2UgUEFMIE4uIEJ1
dCB5b3UgZmluZCBub3RoaW5nIFBBTCBOCitzcGVjaWZpYyBpbiB0aGUgcmVnaXN0ZXJzLiBTZWVt
IHRoYXQgeW91IGhhdmUgdG8gcmV1c2UgYSBvdGhlciBzdGFuZGFyZAordG8gZ2VuZXJhdGUgUEFM
IE4sIG1heWJlIGl0IHdvdWxkIHdvcmsgaWYgeW91IHVzZSB0aGUgUEFMIE0gc2V0dGluZ3MuCisK
K0hvdyBkbyBJIGdldCB0aGlzIGRhbW4gdGhpbmcgdG8gd29yaworLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCisKK0xvYWQgenIzNjA2Ny5vLiBJZiBpdCBjYW4ndCBhdXRvZGV0
ZWN0IHlvdXIgY2FyZCwgdXNlIHRoZSBjYXJkPVggaW5zbW9kCitvcHRpb24gd2l0aCBYIGJlaW5n
IHRoZSBjYXJkIG51bWJlciBhcyBnaXZlbiBpbiB0aGUgcHJldmlvdXMgc2VjdGlvbi4KK1RvIGhh
dmUgbW9yZSB0aGFuIG9uZSBjYXJkLCB1c2UgY2FyZD1YMVssWDJbLFgzLFtYNFsuLl1dXV0KKwor
VG8gYXV0b21hdGUgdGhpcywgYWRkIHRoZSBmb2xsb3dpbmcgdG8geW91ciAvZXRjL21vZHByb2Jl
LmQvem9yYW4uY29uZjoKKworb3B0aW9ucyB6cjM2MDY3IGNhcmQ9WDFbLFgyWyxYM1ssWDRbLi5d
XV1dCithbGlhcyBjaGFyLW1ham9yLTgxLTAgenIzNjA2NworCitPbmUgdGhpbmcgdG8ga2VlcCBp
biBtaW5kIGlzIHRoYXQgdGhpcyBkb2Vzbid0IGxvYWQgenIzNjA2Ny5vIGl0c2VsZiB5ZXQuIEl0
CitqdXN0IGF1dG9tYXRlcyBsb2FkaW5nLiBJZiB5b3Ugc3RhcnQgdXNpbmcgeGF3dHYsIHRoZSBk
ZXZpY2Ugd29uJ3QgbG9hZCBvbgorc29tZSBzeXN0ZW1zLCBzaW5jZSB5b3UncmUgdHJ5aW5nIHRv
IGxvYWQgbW9kdWxlcyBhcyBhIHVzZXIsIHdoaWNoIGlzIG5vdAorYWxsb3dlZCAoInBlcm1pc3Np
b24gZGVuaWVkIikuIEEgcXVpY2sgd29ya2Fyb3VuZCBpcyB0byBhZGQgJ0xvYWQgInY0bCInIHRv
CitYRjg2Q29uZmlnLTQgd2hlbiB5b3UgdXNlIFggYnkgZGVmYXVsdCwgb3IgdG8gcnVuICd2NGwt
Y29uZiAtYyA8ZGV2aWNlPicgaW4KK29uZSBvZiB5b3VyIHN0YXJ0dXAgc2NyaXB0cyAobm9ybWFs
bHkgcmMubG9jYWwpIGlmIHlvdSBkb24ndCB1c2UgWC4gQm90aAorbWFrZSBzdXJlIHRoYXQgdGhl
IG1vZHVsZXMgYXJlIGxvYWRlZCBvbiBzdGFydHVwLCB1bmRlciB0aGUgcm9vdCBhY2NvdW50Lgor
CitXaGF0IG1haW5ib2FyZCBzaG91bGQgSSB1c2UgKG9yIHdoeSBkb2Vzbid0IG15IGNhcmQgd29y
aykKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQorCisKKzxpbnNlcnQgbG91c3kgZGlzY2xhaW1lciBoZXJlPi4gSW4gc2hvcnQ6IGdvb2Q9
U2lTL0ludGVsLCBiYWQ9VklBLgorCitFeHBlcmllbmNlIHRlbGxzIHVzIHRoYXQgcGVvcGxlIHdp
dGggYSBCdXosIG9uIGF2ZXJhZ2UsIGhhdmUgbW9yZSBwcm9ibGVtcwordGhhbiB1c2VycyB3aXRo
IGEgREMxMCsvTE1MMzMuIEFsc28sIGl0IHRlbGxzIHVzIHRoYXQgcGVvcGxlIG93bmluZyBhIFZJ
QS0KK2Jhc2VkIG1haW5ib2FyZCAoa3RYWFgsIE1WUDMpIGhhdmUgbW9yZSBwcm9ibGVtcyB0aGFu
IHVzZXJzIHdpdGggYSBtYWluYm9hcmQKK2Jhc2VkIG9uIGEgZGlmZmVyZW50IGNoaXBzZXQuIEhl
cmUncyBzb21lIG5vdGVzIGZyb20gQW5kcmV3IFN0ZXZlbnM6CisKK0hlcmUncyBteSBleHBlcmll
bmNlIG9mIHVzaW5nIExNTDMzIGFuZCBCdXogb24gdmFyaW91cyBtb3RoZXJib2FyZHM6CisKKy0g
VklBIE1WUDMKKwktIEZvcmdldCBpdC4gUG9pbnRsZXNzLiBEb2Vzbid0IHdvcmsuCistIEludGVs
IDQzMEZYIChQZW50aXVtIDIwMCkKKwktIExNTDMzIHBlcmZlY3QsIEJ1eiB0b2xlcmFibGUgKDMg
b3IgNCBmcmFtZXMgZHJvcHBlZCBwZXIgbW92aWUpCistIEludGVsIDQ0MEJYIChlYXJseSBzdGVw
cGluZykKKwktIExNTDMzIHRvbGVyYWJsZS4gQnV6IHN0YXJ0aW5nIHRvIGdldCBhbm5veWluZyAo
Ni0xMCBmcmFtZXMvaG91cikKKy0gSW50ZWwgNDQwQlggKGxhdGUgc3RlcHBpbmcpCisJLSBCdXog
dG9sZXJhYmxlLCBMTUwzIGFsbW9zdCBwZXJmZWN0IChvY2Nhc2lvbmFsIHNpbmdsZSBmcmFtZSBk
cm9wcykKKy0gU2lTNzM1CisJLSBMTUwzMyBwZXJmZWN0LCBCdXogdG9sZXJhYmxlLgorLSBWSUEg
S1QxMzMoKikKKwktIExNTDMzIHN0YXJ0aW5nIHRvIGdldCBhbm5veWluZywgQnV6IHBvb3IgZW5v
dWdoIHRoYXQgSSBoYXZlIHVwLgorCistIEJvdGggNDQwQlggYm9hcmRzIHdlcmUgZHVhbCBDUFUg
dmVyc2lvbnMuCisKK0Jlcm5oYXJkIFByYXNjaGluZ2VyIGxhdGVyIGFkZGVkOgorCistIEFNRCA3
NTEKKwktIEJ1eiBwZXJmZWN0LXRvbGVyYWJsZQorLSBBTUQgNzYwCisJLSBCdXogcGVyZmVjdC10
b2xlcmFibGUKKworSW4gZ2VuZXJhbCwgcGVvcGxlIG9uIHRoZSB1c2VyIG1haWxpbmdsaXN0IHdv
bid0IGdpdmUgeW91IG11Y2ggb2YgYSBjaGFuY2UKK2lmIHlvdSBoYXZlIGEgVklBLWJhc2VkIG1v
dGhlcmJvYXJkLiBUaGV5IG1heSBiZSBjaGVhcCwgYnV0IHNvbWV0aW1lcywgeW91J2QKK3JhdGhl
ciB3YW50IHRvIHNwZW5kIHNvbWUgbW9yZSBtb25leSBvbiBiZXR0ZXIgYm9hcmRzLiBJbiBnZW5l
cmFsLCBWSUEKK21haW5ib2FyZCdzIElERS9QQ0kgcGVyZm9ybWFuY2Ugd2lsbCBhbHNvIHN1Y2sg
YmFkbHkgY29tcGFyZWQgdG8gb3RoZXJzLgorWW91J2xsIG5vdGljZWQgdGhlIERDMTArL0RDMzAr
IGFyZW4ndCBtZW50aW9uZWQgYW55d2hlcmUgaW4gdGhlIG92ZXJ2aWV3LgorQmFzaWNhbGx5LCB5
b3UgY2FuIGFzc3VtZSB0aGF0IGlmIHRoZSBCdXogd29ya3MsIHRoZSBMTUwzMyB3aWxsIHdvcmsg
dG9vLiBJZgordGhlIExNTDMzIHdvcmtzLCB0aGUgREMxMCsvREMzMCsgd2lsbCB3b3JrIHRvby4g
VGhleSdyZSBtb3N0IHRvbGVyYW50IHRvCitkaWZmZXJlbnQgbWFpbmJvYXJkIGNoaXBzZXRzIGZy
b20gYWxsIG9mIHRoZSBzdXBwb3J0ZWQgY2FyZHMuCisKK0lmIHlvdSBleHBlcmllbmNlIHRpbWVv
dXRzIGR1cmluZyBjYXB0dXJlLCBidXkgYSBiZXR0ZXIgbWFpbmJvYXJkIG9yIGxvd2VyCit0aGUg
cXVhbGl0eS9idWZmZXJzaXplIGR1cmluZyBjYXB0dXJlIChzZWUgJ0NvbmNlcm5pbmcgYnVmZmVy
IHNpemVzLCBxdWFsaXR5LAorb3V0cHV0IHNpemUgZXRjLicpLiBJZiBpdCBoYW5ncywgdGhlcmUn
cyBsaXR0bGUgd2UgY2FuIGRvIGFzIG9mIG5vdy4gQ2hlY2sKK3lvdXIgSVJRcyBhbmQgbWFrZSBz
dXJlIHRoZSBjYXJkIGhhcyBpdHMgb3duIGludGVycnVwdHMuCisKK1Byb2dyYW1taW5nIGludGVy
ZmFjZQorLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisKK1RoaXMgZHJpdmVyIGNvbmZvcm1zIHRvIHZp
ZGVvNGxpbnV4Mi4gU3VwcG9ydCBmb3IgVjRMMSBhbmQgZm9yIHRoZSBjdXN0b20KK3pvcmFuIGlv
Y3RscyBoYXMgYmVlbiByZW1vdmVkIGluIGtlcm5lbCAyLjYuMzguCisKK0ZvciBwcm9ncmFtbWlu
ZyBleGFtcGxlLCBwbGVhc2UsIGxvb2sgYXQgbGF2cmVjLmMgYW5kIGxhdnBsYXkuYyBjb2RlIGlu
Cit0aGUgTUpQRUctdG9vbHMgKGh0dHA6Ly9tanBlZy5zZi5uZXQvKS4KKworQWRkaXRpb25hbCBu
b3RlcyBmb3Igc29mdHdhcmUgZGV2ZWxvcGVyczoKKworICAgVGhlIGRyaXZlciByZXR1cm5zIG1h
eHdpZHRoIGFuZCBtYXhoZWlnaHQgcGFyYW1ldGVycyBhY2NvcmRpbmcgdG8KKyAgIHRoZSBjdXJy
ZW50IFRWIHN0YW5kYXJkIChub3JtKS4gVGhlcmVmb3JlLCB0aGUgc29mdHdhcmUgd2hpY2gKKyAg
IGNvbW11bmljYXRlcyB3aXRoIHRoZSBkcml2ZXIgYW5kICJhc2tzIiBmb3IgdGhlc2UgcGFyYW1l
dGVycyBzaG91bGQKKyAgIGZpcnN0IHNldCB0aGUgY29ycmVjdCBub3JtLiBXZWxsLCBpdCBzZWVt
cyBsb2dpY2FsbHkgY29ycmVjdDogVFYKKyAgIHN0YW5kYXJkIGlzICJtb3JlIGNvbnN0YW50IiBm
b3IgY3VycmVudCBjb3VudHJ5IHRoYW4gZ2VvbWV0cnkKKyAgIHNldHRpbmdzIG9mIGEgdmFyaWV0
eSBvZiBUViBjYXB0dXJlIGNhcmRzIHdoaWNoIG1heSB3b3JrIGluIElUVSBvcgorICAgc3F1YXJl
IHBpeGVsIGZvcm1hdC4KKworQXBwbGljYXRpb25zCistLS0tLS0tLS0tLS0KKworQXBwbGljYXRp
b25zIGtub3duIHRvIHdvcmsgd2l0aCB0aGlzIGRyaXZlcjoKKworVFYgdmlld2luZzoKKworKiB4
YXd0dgorKiBrd2ludHYKKyogcHJvYmFibHkgYW55IFRWIGFwcGxpY2F0aW9uIHRoYXQgc3VwcG9y
dHMgdmlkZW80bGludXggb3IgdmlkZW80bGludXgyLgorCitNSlBFRyBjYXB0dXJlL3BsYXliYWNr
OgorCisqIG1qcGVndG9vbHMvbGF2dG9vbHMgKG9yIExpbnV4IFZpZGVvIFN0dWRpbykKKyogZ3N0
cmVhbWVyCisqIG1wbGF5ZXIKKworR2VuZXJhbCByYXcgY2FwdHVyZToKKworKiB4YXd0dgorKiBn
c3RyZWFtZXIKKyogcHJvYmFibHkgYW55IGFwcGxpY2F0aW9uIHRoYXQgc3VwcG9ydHMgdmlkZW80
bGludXggb3IgdmlkZW80bGludXgyCisKK1ZpZGVvIGVkaXRpbmc6CisKKyogQ2luZWxlcnJhCisq
IE1haW5BY3RvcgorKiBtanBlZ3Rvb2xzIChvciBMaW51eCBWaWRlbyBTdHVkaW8pCisKKworQ29u
Y2VybmluZyBidWZmZXIgc2l6ZXMsIHF1YWxpdHksIG91dHB1dCBzaXplIGV0Yy4KKy0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisKKworVGhlIHpyMzYw
NjAgY2FuIGRvIDE6MiBKUEVHIGNvbXByZXNzaW9uLiBUaGlzIGlzIHJlYWxseSB0aGUgdGhlb3Jl
dGljYWwKK21heGltdW0gdGhhdCB0aGUgY2hpcHNldCBjYW4gcmVhY2guIFRoZSBkcml2ZXIgY2Fu
LCBob3dldmVyLCBsaW1pdCBjb21wcmVzc2lvbgordG8gYSBtYXhpbXVtIChzaXplKSBvZiAxOjQu
IFRoZSByZWFzb24gZm9yIHRoaXMgaXMgdGhhdCBzb21lIGNhcmRzIChlLmcuIEJ1eikKK2Nhbid0
IGhhbmRsZSAxOjIgY29tcHJlc3Npb24gd2l0aG91dCBzdG9wcGluZyBjYXB0dXJlIGFmdGVyIG9u
bHkgYSBmZXcgbWludXRlcy4KK1dpdGggMTo0LCBpdCdsbCBtb3N0bHkgd29yay4gSWYgeW91IGhh
dmUgYSBCdXosIHVzZSAnbG93X2JpdHJhdGU9MScgdG8gZ28gaW50bworMTo0IG1heC4gY29tcHJl
c3Npb24gbW9kZS4KKworMTAwJSBKUEVHIHF1YWxpdHkgaXMgdGh1cyAxOjIgY29tcHJlc3Npb24g
aW4gcHJhY3RpY2UuIFNvIGZvciBhIGZ1bGwgUEFMIGZyYW1lCisoc2l6ZSA3MjB4NTc2KS4gVGhl
IEpQRUcgZmllbGRzIGFyZSBzdG9yZWQgaW4gWVVZMiBmb3JtYXQsIHNvIHRoZSBzaXplIG9mIHRo
ZQorZmllbGRzIGFyZSA3MjB4Mjg4eDE2LzIgYml0cy9maWVsZCAoMiBmaWVsZHMvZnJhbWUpID0g
MjA3MzYwIGJ5dGVzL2ZpZWxkIHggMiA9Cis0MTQ3MjAgYnl0ZXMvZnJhbWUgKGFkZCBzb21lIG1v
cmUgYnl0ZXMgZm9yIGhlYWRlcnMgYW5kIERIVCAoaHVmZm1hbikvRFFUCisocXVhbnRpemF0aW9u
KSB0YWJsZXMsIGFuZCB5b3UnbGwgZ2V0IHRvIHNvbWV0aGluZyBsaWtlIDUxMmtCIHBlciBmcmFt
ZSBmb3IKKzE6MiBjb21wcmVzc2lvbi4gRm9yIDE6NCBjb21wcmVzc2lvbiwgeW91J2QgaGF2ZSBm
cmFtZXMgb2YgaGFsZiB0aGlzIHNpemUuCisKK1NvbWUgYWRkaXRpb25hbCBleHBsYW5hdGlvbiBi
eSBNYXJ0aW4gU2FtdWVsc3Nvbiwgd2hpY2ggYWxzbyBleHBsYWlucyB0aGUKK2ltcG9ydGFuY2Ug
b2YgYnVmZmVyIHNpemVzOgorLS0KKz4gSG1tLCBJIGRvIG5vdCB0aGluayBpdCBpcyByZWFsbHkg
dGhhdCB3YXkuIFdpdGggdGhlIGN1cnJlbnQgKGRvd25sb2FkZWQKKz4gYXQgMTg6MDAgTW9uZGF5
KSBkcml2ZXIgSSBnZXQgdGhhdCBvdXRwdXQgc2l6ZXMgZm9yIDEwIHNlYzoKKz4gLXEgNTAgLWIg
MTI4IDogMjQuMjgzLjMzMiBCeXRlcworPiAtcSA1MCAtYiAyNTYgOiA0OC40NDIuMzY4Cis+IC1x
IDI1IC1iIDEyOCA6IDI0LjY1NS45OTIKKz4gLXEgMjUgLWIgMjU2IDogMjUuODU5LjgyMAorCitJ
IHdva2UgdXAsIGFuZCBjYW4ndCBnbyB0byBzbGVlcCBhZ2Fpbi4gSSdsbCBraWxsIHNvbWUgdGlt
ZSBleHBsYWluaW5nIHdoeQordGhpcyBkb2Vzbid0IGxvb2sgc3RyYW5nZSB0byBtZS4KKworTGV0
J3MgZG8gc29tZSBtYXRoIHVzaW5nIGEgd2lkdGggb2YgNzA0IHBpeGVscy4gSSdtIG5vdCBzdXJl
IHdoZXRoZXIgdGhlIEJ1egorYWN0dWFsbHkgdXNlIHRoYXQgbnVtYmVyIG9yIG5vdCwgYnV0IHRo
YXQncyBub3QgdG9vIGltcG9ydGFudCByaWdodCBub3cuCisKKzcwNHgyODggcGl4ZWxzLCBvbmUg
ZmllbGQsIGlzIDIwMjc1MiBwaXhlbHMuIERpdmlkZWQgYnkgNjQgcGl4ZWxzIHBlciBibG9jazsK
KzMxNjggYmxvY2tzIHBlciBmaWVsZC4gRWFjaCBwaXhlbCBjb25zaXN0IG9mIHR3byBieXRlczsg
MTI4IGJ5dGVzIHBlciBibG9jazsKKzEwMjQgYml0cyBwZXIgYmxvY2suIDEwMCUgaW4gdGhlIG5l
dyBkcml2ZXIgbWVhbiAxOjIgY29tcHJlc3Npb247IHRoZSBtYXhpbXVtCitvdXRwdXQgYmVjb21l
cyA1MTIgYml0cyBwZXIgYmxvY2suIEFjdHVhbGx5IDUxMCwgYnV0IDUxMiBpcyBzaW1wbGVyIHRv
IHVzZQorZm9yIGNhbGN1bGF0aW9ucy4KKworTGV0J3Mgc2F5IHRoYXQgd2Ugc3BlY2lmeSBkMXE1
MC4gV2UgdGh1cyB3YW50IDI1NiBiaXRzIHBlciBibG9jazsgdGltZXMgMzE2OAorYmVjb21lcyA4
MTEwMDggYml0czsgMTAxMzc2IGJ5dGVzIHBlciBmaWVsZC4gV2UncmUgdGFsa2luZyByYXcgYml0
cyBhbmQgYnl0ZXMKK2hlcmUsIHNvIHdlIGRvbid0IG5lZWQgdG8gZG8gYW55IGZhbmN5IGNvcnJl
Y3Rpb25zIGZvciBiaXRzLXBlci1waXhlbCBvciBzdWNoCit0aGluZ3MuIDEwMTM3NiBieXRlcyBw
ZXIgZmllbGQuCisKK2QxIHZpZGVvIGNvbnRhaW5zIHR3byBmaWVsZHMgcGVyIGZyYW1lLiBUaG9z
ZSBzdW0gdXAgdG8gMjAyNzUyIGJ5dGVzIHBlcgorZnJhbWUsIGFuZCBvbmUgb2YgdGhvc2UgZnJh
bWVzIGdvZXMgaW50byBlYWNoIGJ1ZmZlci4KKworQnV0IHdhaXQgYSBzZWNvbmQhIC1iMTI4IGdp
dmVzIDEyOGtCIGJ1ZmZlcnMhIEl0J3Mgbm90IHBvc3NpYmxlIHRvIGNyYW0KKzIwMjc1MiBieXRl
cyBvZiBKUEVHIGRhdGEgaW50byAxMjhrQiEKKworVGhpcyBpcyB3aGF0IHRoZSBkcml2ZXIgbm90
aWNlIGFuZCBhdXRvbWF0aWNhbGx5IGNvbXBlbnNhdGUgZm9yIGluIHlvdXIKK2V4YW1wbGVzLiBM
ZXQncyBkbyBzb21lIG1hdGggdXNpbmcgdGhpcyBpbmZvcm1hdGlvbjoKKworMTI4a0IgaXMgMTMx
MDcyIGJ5dGVzLiBJbiB0aGlzIGJ1ZmZlciwgd2Ugd2FudCB0byBzdG9yZSB0d28gZmllbGRzLCB3
aGljaAorbGVhdmVzIDY1NTM2IGJ5dGVzIGZvciBlYWNoIGZpZWxkLiBVc2luZyAzMTY4IGJsb2Nr
cyBwZXIgZmllbGQsIHdlIGdldAorMjAuNjg2ODY4NjguLi4gYXZhaWxhYmxlIGJ5dGVzIHBlciBi
bG9jazsgMTY1IGJpdHMuIFdlIGNhbid0IGFsbG93IHRoZQorcmVxdWVzdCBmb3IgMjU2IGJpdHMg
cGVyIGJsb2NrIHdoZW4gdGhlcmUncyBvbmx5IDE2NSBiaXRzIGF2YWlsYWJsZSEgVGhlIC1xNTAK
K29wdGlvbiBpcyBzaWxlbnRseSBvdmVycmlkZGVuLCBhbmQgdGhlIC1iMTI4IG9wdGlvbiB0YWtl
cyBwcmVjZWRlbmNlLCBsZWF2aW5nCit1cyB3aXRoIHRoZSBlcXVpdmFsZW5jZSBvZiAtcTMyLgor
CitUaGlzIGdpdmVzIHVzIGEgZGF0YSByYXRlIG9mIDE2NSBiaXRzIHBlciBibG9jaywgd2hpY2gs
IHRpbWVzIDMxNjgsIHN1bXMgdXAKK3RvIDY1MzQwIGJ5dGVzIHBlciBmaWVsZCwgb3V0IG9mIHRo
ZSBhbGxvd2VkIDY1NTM2LiBUaGUgY3VycmVudCBkcml2ZXIgaGFzCithbm90aGVyIGxldmVsIG9m
IHJhdGUgbGltaXRpbmc7IGl0IHdvbid0IGFjY2VwdCAtcSB2YWx1ZXMgdGhhdCBmaWxsIG1vcmUg
dGhhbgorNi84IG9mIHRoZSBzcGVjaWZpZWQgYnVmZmVycy4gKEknbSBub3Qgc3VyZSB3aHkuICJQ
bGF5aW5nIGl0IHNhZmUiIHNlZW0gdG8gYmUKK2Egc2FmZSBiZXQuIFBlcnNvbmFsbHksIEkgdGhp
bmsgSSB3b3VsZCBoYXZlIGxvd2VyZWQgcmVxdWVzdGVkLWJpdHMtcGVyLWJsb2NrCitieSBvbmUs
IG9yIHNvbWV0aGluZyBsaWtlIHRoYXQuKSBXZSBjYW4ndCB1c2UgMTY1IGJpdHMgcGVyIGJsb2Nr
LCBidXQgaGF2ZSB0bworbG93ZXIgaXQgYWdhaW4sIHRvIDYvOCBvZiB0aGUgYXZhaWxhYmxlIGJ1
ZmZlciBzcGFjZTogV2UgZW5kIHVwIHdpdGggMTI0IGJpdHMKK3BlciBibG9jaywgdGhlIGVxdWl2
YWxlbmNlIG9mIC1xMjQuIFdpdGggMTI4a0IgYnVmZmVycywgeW91IGNhbid0IHVzZSBncmVhdGVy
Cit0aGFuIC1xMjQgYXQgLWQxLiAoQW5kIFBBTCwgYW5kIDcwNCBwaXhlbHMgd2lkdGguLi4pCisK
K1RoZSB0aGlyZCBleGFtcGxlIGlzIGxpbWl0ZWQgdG8gLXEyNCB0aHJvdWdoIHRoZSBzYW1lIHBy
b2Nlc3MuIFRoZSBzZWNvbmQKK2V4YW1wbGUsIHVzaW5nIHZlcnkgc2ltaWxhciBjYWxjdWxhdGlv
bnMsIGlzIGxpbWl0ZWQgdG8gLXE0OC4gVGhlIG9ubHkKK2V4YW1wbGUgdGhhdCBhY3R1YWxseSBn
cmFiIGF0IHRoZSBzcGVjaWZpZWQgLXEgdmFsdWUgaXMgdGhlIGxhc3Qgb25lLCB3aGljaAoraXMg
Y2xlYXJseSB2aXNpYmxlLCBsb29raW5nIGF0IHRoZSBmaWxlIHNpemUuCistLQorCitDb25jbHVz
aW9uOiB0aGUgcXVhbGl0eSBvZiB0aGUgcmVzdWx0aW5nIG1vdmllIGRlcGVuZHMgb24gYnVmZmVy
IHNpemUsIHF1YWxpdHksCit3aGV0aGVyIG9yIG5vdCB5b3UgdXNlICdsb3dfYml0cmF0ZT0xJyBh
cyBpbnNtb2Qgb3B0aW9uIGZvciB0aGUgenIzNjA2MC5jCittb2R1bGUgdG8gZG8gMTo0IGluc3Rl
YWQgb2YgMToyIGNvbXByZXNzaW9uLCBldGMuCisKK0lmIHlvdSBleHBlcmllbmNlIHRpbWVvdXRz
LCBsb3dlcmluZyB0aGUgcXVhbGl0eS9idWZmZXJzaXplIG9yIHVzaW5nCisnbG93X2JpdHJhdGU9
MSBhcyBpbnNtb2Qgb3B0aW9uIGZvciB6cjM2MDYwLm8gbWlnaHQgYWN0dWFsbHkgaGVscCwgYXMg
aXMKK3Byb3ZlbiBieSB0aGUgQnV6LgorCitJdCBoYW5ncy9jcmFzaGVzL2ZhaWxzL3doYXRldmVy
cyEgSGVscCEKKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCitNYWtl
IHN1cmUgdGhhdCB0aGUgY2FyZCBoYXMgaXRzIG93biBpbnRlcnJ1cHRzIChzZWUgL3Byb2MvaW50
ZXJydXB0cyksIGNoZWNrCit0aGUgb3V0cHV0IG9mIGRtZXNnIGF0IGhpZ2ggdmVyYm9zaXR5IChs
b2FkIHpyMzYwNjcubyB3aXRoIGRlYnVnPTIsCitsb2FkIGFsbCBvdGhlciBtb2R1bGVzIHdpdGgg
ZGVidWc9MSkuIENoZWNrIHRoYXQgeW91ciBtYWluYm9hcmQgaXMgZmF2b3JhYmxlCisoc2VlIHF1
ZXN0aW9uIDIpIGFuZCBpZiBub3QsIHRlc3QgdGhlIGNhcmQgaW4gYW5vdGhlciBjb21wdXRlci4g
QWxzbyBzZWUgdGhlCitub3RlcyBnaXZlbiBpbiBxdWVzdGlvbiAzIGFuZCB0cnkgbG93ZXJpbmcg
cXVhbGl0eS9idWZmZXJzaXplL2NhcHR1cmVzaXplCitpZiByZWNvcmRpbmcgZmFpbHMgYWZ0ZXIg
YSBwZXJpb2Qgb2YgdGltZS4KKworSWYgYWxsIHRoaXMgZG9lc24ndCBoZWxwLCBnaXZlIGEgY2xl
YXIgZGVzY3JpcHRpb24gb2YgdGhlIHByb2JsZW0gaW5jbHVkaW5nCitkZXRhaWxlZCBoYXJkd2Fy
ZSBpbmZvcm1hdGlvbiAobWVtb3J5K2JyYW5kLCBtYWluYm9hcmQrY2hpcHNldCticmFuZCwgd2hp
Y2gKK01KUEVHIGNhcmQsIHByb2Nlc3Nvciwgb3RoZXIgUENJIGNhcmRzIHRoYXQgbWlnaHQgYmUg
b2YgaW50ZXJlc3QpLCBnaXZlIHRoZQorc3lzdGVtIFBuUCBpbmZvcm1hdGlvbiAoL3Byb2MvaW50
ZXJydXB0cywgL3Byb2MvZG1hLCAvcHJvYy9kZXZpY2VzKSwgYW5kIGdpdmUKK3RoZSBrZXJuZWwg
dmVyc2lvbiwgZHJpdmVyIHZlcnNpb24sIGdsaWJjIHZlcnNpb24sIGdjYyB2ZXJzaW9uIGFuZCBh
bnkgb3RoZXIKK2luZm9ybWF0aW9uIHRoYXQgbWlnaHQgcG9zc2libHkgYmUgb2YgaW50ZXJlc3Qu
IEFsc28gcHJvdmlkZSB0aGUgZG1lc2cgb3V0cHV0CithdCBoaWdoIHZlcmJvc2l0eS4gU2VlICdD
b250YWN0aW5nJyBvbiBob3cgdG8gY29udGFjdCB0aGUgZGV2ZWxvcGVycy4KKworTWFpbnRhaW5l
cnMvQ29udGFjdGluZworLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorCitUaGUgZHJpdmVyIGlzIGN1
cnJlbnRseSBtYWludGFpbmVkIGJ5IExhdXJlbnQgUGluY2hhcnQgYW5kIFJvbmFsZCBCdWx0amUK
Kyg8bGF1cmVudC5waW5jaGFydEBza3luZXQuYmU+IGFuZCA8cmJ1bHRqZUByb25hbGQuYml0ZnJl
YWsubmV0PikuIEZvciBidWcKK3JlcG9ydHMgb3IgcXVlc3Rpb25zLCBwbGVhc2UgY29udGFjdCB0
aGUgbWFpbGluZ2xpc3QgaW5zdGVhZCBvZiB0aGUgZGV2ZWxvcGVycworaW5kaXZpZHVhbGx5LiBG
b3IgdXNlciBxdWVzdGlvbnMgKGkuZS4gYnVnIHJlcG9ydHMgb3IgaG93LXRvIHF1ZXN0aW9ucyks
IHNlbmQKK2FuIGVtYWlsIHRvIDxtanBlZy11c2Vyc0BsaXN0cy5zZi5uZXQ+LCBmb3IgZGV2ZWxv
cGVycyAoaS5lLiBpZiB5b3Ugd2FudCB0bworaGVscCBwcm9ncmFtbWluZyksIHNlbmQgYW4gZW1h
aWwgdG8gPG1qcGVnLWRldmVsb3BlckBsaXN0cy5zZi5uZXQ+LiBTZWUKK2h0dHA6Ly93d3cuc2Yu
bmV0L3Byb2plY3RzL21qcGVnLyBmb3Igc3Vic2NyaXB0aW9uIGluZm9ybWF0aW9uLgorCitGb3Ig
YnVnIHJlcG9ydHMsIGJlIHN1cmUgdG8gaW5jbHVkZSBhbGwgdGhlIGluZm9ybWF0aW9uIGFzIGRl
c2NyaWJlZCBpbgordGhlIHNlY3Rpb24gJ0l0IGhhbmdzL2NyYXNoZXMvZmFpbHMvd2hhdGV2ZXJz
ISBIZWxwIScuIFBsZWFzZSBtYWtlIHN1cmUKK3lvdSdyZSB1c2luZyB0aGUgbGF0ZXN0IHZlcnNp
b24gKGh0dHA6Ly9tanBlZy5zZi5uZXQvZHJpdmVyLXpvcmFuLykuCisKK1ByZXZpb3VzIG1haW50
YWluZXJzL2RldmVsb3BlcnMgb2YgdGhpcyBkcml2ZXIgaW5jbHVkZSBTZXJndWVpIE1pcmlkb25v
dgorPG1pcnNldkBjaWNlc2UubXg+LCBXb2xmZ2FuZyBTY2hlcnIgPHNjaGVyckBuZXQ0eW91Lm5l
dD4sIERhdmUgUGVya3MKKzxkcGVya3NAaWJtLm5ldD4gYW5kIFJhaW5lciBKb2hhbm5pIDxSYWlu
ZXJASm9oYW5uaS5kZT4uCisKK0RyaXZlcidzIExpY2Vuc2UKKy0tLS0tLS0tLS0tLS0tLS0KKwor
ICAgIFRoaXMgZHJpdmVyIGlzIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR2Vu
ZXJhbCBQdWJsaWMgTGljZW5zZS4KKworICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJl
OyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgICAgaXQgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkK
KyAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRo
ZSBMaWNlbnNlLCBvcgorICAgIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisK
KyAgICBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxs
IGJlIHVzZWZ1bCwKKyAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0
aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZP
UiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAgICBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorCitTZWUgaHR0cDovL3d3dy5nbnUub3JnLyBmb3Ig
bW9yZSBpbmZvcm1hdGlvbi4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9LY29u
ZmlnIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL0tjb25maWcKaW5kZXggNWQzM2Q1ZDk4ODFlLi4w
ZjlkMTU5YTE0NzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9LY29uZmlnCisr
KyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS9LY29uZmlnCkBAIC0zOCw2ICszOCw4IEBAIHNvdXJj
ZSAiZHJpdmVycy9zdGFnaW5nL21lZGlhL3N1bnhpL0tjb25maWciCiAKIHNvdXJjZSAiZHJpdmVy
cy9zdGFnaW5nL21lZGlhL3RlZ3JhLXZkZS9LY29uZmlnIgogCitzb3VyY2UgImRyaXZlcnMvc3Rh
Z2luZy9tZWRpYS96b3Jhbi9LY29uZmlnIgorCiBzb3VyY2UgImRyaXZlcnMvc3RhZ2luZy9tZWRp
YS90ZWdyYS12aWRlby9LY29uZmlnIgogCiBzb3VyY2UgImRyaXZlcnMvc3RhZ2luZy9tZWRpYS9p
cHUzL0tjb25maWciCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4vS2Nv
bmZpZyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi9LY29uZmlnCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMzRhMTgxMzVlZGUwCi0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL0tjb25maWcKQEAgLTAsMCArMSw3NSBAQAor
Y29uZmlnIFZJREVPX1pPUkFOCisJdHJpc3RhdGUgIlpvcmFuIFpSMzYwNTcvMzYwNjcgVmlkZW8g
Rm9yIExpbnV4IChEZXByZWNhdGVkKSIKKwlkZXBlbmRzIG9uIFBDSSAmJiBJMkNfQUxHT0JJVCAm
JiBWSURFT19WNEwyICYmIFZJUlRfVE9fQlVTCisJZGVwZW5kcyBvbiAhQUxQSEEKKwloZWxwCisJ
ICBTYXkgWSBmb3Igc3VwcG9ydCBmb3IgTUpQRUcgY2FwdHVyZSBjYXJkcyBiYXNlZCBvbiB0aGUg
Wm9yYW4KKwkgIDM2MDU3LzM2MDY3IFBDSSBjb250cm9sbGVyIGNoaXBzZXQuIFRoaXMgaW5jbHVk
ZXMgdGhlIElvbWVnYQorCSAgQnV6LCBQaW5uYWNsZSBEQzEwKyBhbmQgdGhlIExpbnV4IE1lZGlh
IExhYnMgTE1MMzMuIFRoZXJlIGlzCisJICBhIGRyaXZlciBob21lcGFnZSBhdCA8aHR0cDovL21q
cGVnLnNmLm5ldC9kcml2ZXItem9yYW4vPi4gRm9yCisJICBtb3JlIGluZm9ybWF0aW9uLCBjaGVj
ayA8ZmlsZTpEb2N1bWVudGF0aW9uL21lZGlhL3Y0bC1kcml2ZXJzL3pvcmFuLnJzdD4uCisKKwkg
IFRvIGNvbXBpbGUgdGhpcyBkcml2ZXIgYXMgYSBtb2R1bGUsIGNob29zZSBNIGhlcmU6IHRoZQor
CSAgbW9kdWxlIHdpbGwgYmUgY2FsbGVkIHpyMzYwNjcuCisKK2NvbmZpZyBWSURFT19aT1JBTl9E
QzMwCisJdHJpc3RhdGUgIlBpbm5hY2xlL01pcm8gREMzMCgrKSBzdXBwb3J0IgorCWRlcGVuZHMg
b24gVklERU9fWk9SQU4KKwlzZWxlY3QgVklERU9fQURWNzE3NSBpZiBNRURJQV9TVUJEUlZfQVVU
T1NFTEVDVAorCXNlbGVjdCBWSURFT19WUFgzMjIwIGlmIE1FRElBX1NVQkRSVl9BVVRPU0VMRUNU
CisJaGVscAorCSAgU3VwcG9ydCBmb3IgdGhlIFBpbm5hY2xlL01pcm8gREMzMCgrKSBNSlBFRyBj
YXB0dXJlL3BsYXliYWNrCisJICBjYXJkLiBUaGlzIGFsc28gc3VwcG9ydHMgcmVhbGx5IG9sZCBE
QzEwIGNhcmRzIGJhc2VkIG9uIHRoZQorCSAgenIzNjA1MCBNSlBFRyBjb2RlYyBhbmQgenIzNjAx
NiBWRkUuCisKK2NvbmZpZyBWSURFT19aT1JBTl9aUjM2MDYwCisJdHJpc3RhdGUgIlpvcmFuIFpS
MzYwNjAiCisJZGVwZW5kcyBvbiBWSURFT19aT1JBTgorCWhlbHAKKwkgIFNheSBZIHRvIHN1cHBv
cnQgWm9yYW4gYm9hcmRzIGJhc2VkIG9uIDM2MDYwIGNoaXBzLgorCSAgVGhpcyBpbmNsdWRlcyBJ
b21lZ2EgQnV6LCBQaW5uYWNsZSBEQzEwLCBMaW51eCBtZWRpYSBMYWJzIDMzCisJICBhbmQgMzMg
UjEwIGFuZCBBdmVyTWVkaWEgNiBib2FyZHMuCisKK2NvbmZpZyBWSURFT19aT1JBTl9CVVoKKwl0
cmlzdGF0ZSAiSW9tZWdhIEJ1eiBzdXBwb3J0IgorCWRlcGVuZHMgb24gVklERU9fWk9SQU5fWlIz
NjA2MAorCXNlbGVjdCBWSURFT19TQUE3MTFYIGlmIE1FRElBX1NVQkRSVl9BVVRPU0VMRUNUCisJ
c2VsZWN0IFZJREVPX1NBQTcxODUgaWYgTUVESUFfU1VCRFJWX0FVVE9TRUxFQ1QKKwloZWxwCisJ
ICBTdXBwb3J0IGZvciB0aGUgSW9tZWdhIEJ1eiBNSlBFRyBjYXB0dXJlL3BsYXliYWNrIGNhcmQu
CisKK2NvbmZpZyBWSURFT19aT1JBTl9EQzEwCisJdHJpc3RhdGUgIlBpbm5hY2xlL01pcm8gREMx
MCgrKSBzdXBwb3J0IgorCWRlcGVuZHMgb24gVklERU9fWk9SQU5fWlIzNjA2MAorCXNlbGVjdCBW
SURFT19TQUE3MTEwIGlmIE1FRElBX1NVQkRSVl9BVVRPU0VMRUNUCisJc2VsZWN0IFZJREVPX0FE
VjcxNzUgaWYgTUVESUFfU1VCRFJWX0FVVE9TRUxFQ1QKKwloZWxwCisJICBTdXBwb3J0IGZvciB0
aGUgUGlubmFjbGUvTWlybyBEQzEwKCspIE1KUEVHIGNhcHR1cmUvcGxheWJhY2sKKwkgIGNhcmQu
CisKK2NvbmZpZyBWSURFT19aT1JBTl9MTUwzMworCXRyaXN0YXRlICJMaW51eCBNZWRpYSBMYWJz
IExNTDMzIHN1cHBvcnQiCisJZGVwZW5kcyBvbiBWSURFT19aT1JBTl9aUjM2MDYwCisJc2VsZWN0
IFZJREVPX0JUODE5IGlmIE1FRElBX1NVQkRSVl9BVVRPU0VMRUNUCisJc2VsZWN0IFZJREVPX0JU
ODU2IGlmIE1FRElBX1NVQkRSVl9BVVRPU0VMRUNUCisJaGVscAorCSAgU3VwcG9ydCBmb3IgdGhl
IExpbnV4IE1lZGlhIExhYnMgTE1MMzMgTUpQRUcgY2FwdHVyZS9wbGF5YmFjaworCSAgY2FyZC4K
KworY29uZmlnIFZJREVPX1pPUkFOX0xNTDMzUjEwCisJdHJpc3RhdGUgIkxpbnV4IE1lZGlhIExh
YnMgTE1MMzNSMTAgc3VwcG9ydCIKKwlkZXBlbmRzIG9uIFZJREVPX1pPUkFOX1pSMzYwNjAKKwlz
ZWxlY3QgVklERU9fU0FBNzExWCBpZiBNRURJQV9TVUJEUlZfQVVUT1NFTEVDVAorCXNlbGVjdCBW
SURFT19BRFY3MTcwIGlmIE1FRElBX1NVQkRSVl9BVVRPU0VMRUNUCisJaGVscAorCSAgc3VwcG9y
dCBmb3IgdGhlIExpbnV4IE1lZGlhIExhYnMgTE1MMzNSMTAgTUpQRUcgY2FwdHVyZS9wbGF5YmFj
aworCSAgY2FyZC4KKworY29uZmlnIFZJREVPX1pPUkFOX0FWUzZFWUVTCisJdHJpc3RhdGUgIkF2
ZXJNZWRpYSA2IEV5ZXMgc3VwcG9ydCIKKwlkZXBlbmRzIG9uIFZJREVPX1pPUkFOX1pSMzYwNjAK
KwlzZWxlY3QgVklERU9fQlQ4NTYgaWYgTUVESUFfU1VCRFJWX0FVVE9TRUxFQ1QKKwlzZWxlY3Qg
VklERU9fQlQ4NjYgaWYgTUVESUFfU1VCRFJWX0FVVE9TRUxFQ1QKKwlzZWxlY3QgVklERU9fS1Mw
MTI3IGlmIE1FRElBX1NVQkRSVl9BVVRPU0VMRUNUCisJaGVscAorCSAgU3VwcG9ydCBmb3IgdGhl
IEF2ZXJNZWRpYSA2IEV5ZXMgdmlkZW8gc3VydmVpbGxhbmNlIGNhcmQuCmRpZmYgLS1naXQgYS9k
cml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4vTWFrZWZpbGUgYi9kcml2ZXJzL3N0YWdpbmcvbWVk
aWEvem9yYW4vTWFrZWZpbGUKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li4yMWFjMjlhNzE0NTgKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEv
em9yYW4vTWFrZWZpbGUKQEAgLTAsMCArMSw3IEBACisjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wCit6cjM2MDY3LW9ianMJOj0Jem9yYW5fcHJvY2ZzLm8gem9yYW5fZGV2aWNlLm8g
XAorCQkJem9yYW5fZHJpdmVyLm8gem9yYW5fY2FyZC5vCisKK29iai0kKENPTkZJR19WSURFT19a
T1JBTikgKz0genIzNjA2Ny5vIHZpZGVvY29kZWMubworb2JqLSQoQ09ORklHX1ZJREVPX1pPUkFO
X0RDMzApICs9IHpyMzYwNTAubyB6cjM2MDE2Lm8KK29iai0kKENPTkZJR19WSURFT19aT1JBTl9a
UjM2MDYwKSArPSB6cjM2MDYwLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96
b3Jhbi9UT0RPIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL1RPRE8KbmV3IGZpbGUgbW9k
ZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi41NDQ2NDA5NWQwZDcKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4vVE9ETwpAQCAtMCwwICsxLDQgQEAKK1Ro
ZSB6b3JhbiBkcml2ZXIgaXMgbWFya2VkIGRlcHJlY2F0ZWQuIEl0IHdpbGwgYmUgcmVtb3ZlZAor
YXJvdW5kIE1heSAyMDE5IHVubGVzcyBzb21lb25lIGlzIHdpbGxpbmcgdG8gdXBkYXRlIHRoaXMK
K2RyaXZlciB0byB0aGUgbGF0ZXN0IFY0TDIgZnJhbWV3b3JrcyAoZXNwZWNpYWxseSB0aGUgdmIy
CitmcmFtZXdvcmspLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3Zp
ZGVvY29kZWMuYyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi92aWRlb2NvZGVjLmMKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4wNDRlZjg0NTViYTgKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4vdmlkZW9jb2RlYy5jCkBA
IC0wLDAgKzEsMzkxIEBACisvKgorICogVklERU8gTU9USU9OIENPREVDcyBpbnRlcm5hbCBBUEkg
Zm9yIHZpZGVvIGRldmljZXMKKyAqCisgKiBJbnRlcmZhY2UgZm9yIE1KUEVHIChhbmQgbWF5YmUg
bGF0ZXIgTVBFRy9XQVZFTEVUUykgY29kZWMncworICogYm91bmQgdG8gYSBtYXN0ZXIgZGV2aWNl
LgorICoKKyAqIChjKSAyMDAyIFdvbGZnYW5nIFNjaGVyciA8c2NoZXJyQG5ldDR5b3UuYXQ+Cisg
KgorICogJElkOiB2aWRlb2NvZGVjLmMsdiAxLjEuMi44IDIwMDMvMDMvMjkgMDc6MTY6MDQgcmJ1
bHRqZSBFeHAgJAorICoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICoKKyAqIFRoaXMgcHJvZ3JhbSBp
cyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5Cisg
KiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFz
IHB1Ymxpc2hlZCBieQorICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZl
cnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVy
IHZlcnNpb24uCisgKgorICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3Bl
IHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdp
dGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogTUVSQ0hBTlRBQklMSVRZIG9y
IEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogR05VIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0KKyAqLworCisjZGVmaW5lIFZJREVPQ09ERUNfVkVSU0lPTiAidjAuMiIKKworI2luY2x1ZGUg
PGxpbnV4L2tlcm5lbC5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxp
bnV4L2luaXQuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L3Ns
YWIuaD4KKworLy8ga2VybmVsIGNvbmZpZyBpcyBoZXJlIChwcm9jZnMgZmxhZykKKworI2lmZGVm
IENPTkZJR19QUk9DX0ZTCisjaW5jbHVkZSA8bGludXgvcHJvY19mcy5oPgorI2luY2x1ZGUgPGxp
bnV4L3NlcV9maWxlLmg+CisjaW5jbHVkZSA8bGludXgvdWFjY2Vzcy5oPgorI2VuZGlmCisKKyNp
bmNsdWRlICJ2aWRlb2NvZGVjLmgiCisKK3N0YXRpYyBpbnQgZGVidWc7Cittb2R1bGVfcGFyYW0o
ZGVidWcsIGludCwgMCk7CitNT0RVTEVfUEFSTV9ERVNDKGRlYnVnLCAiRGVidWcgbGV2ZWwgKDAt
NCkiKTsKKworI2RlZmluZSBkcHJpbnRrKG51bSwgZm9ybWF0LCBhcmdzLi4uKSBcCisJZG8geyBc
CisJCWlmIChkZWJ1ZyA+PSBudW0pIFwKKwkJCXByaW50ayhmb3JtYXQsICMjYXJncyk7IFwKKwl9
IHdoaWxlICgwKQorCitzdHJ1Y3QgYXR0YWNoZWRfbGlzdCB7CisJc3RydWN0IHZpZGVvY29kZWMg
KmNvZGVjOworCXN0cnVjdCBhdHRhY2hlZF9saXN0ICpuZXh0OworfTsKKworc3RydWN0IGNvZGVj
X2xpc3QgeworCWNvbnN0IHN0cnVjdCB2aWRlb2NvZGVjICpjb2RlYzsKKwlpbnQgYXR0YWNoZWQ7
CisJc3RydWN0IGF0dGFjaGVkX2xpc3QgKmxpc3Q7CisJc3RydWN0IGNvZGVjX2xpc3QgKm5leHQ7
Cit9OworCitzdGF0aWMgc3RydWN0IGNvZGVjX2xpc3QgKmNvZGVjbGlzdF90b3A7CisKKy8qID09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKy8qIGZ1
bmN0aW9uIHByb3RvdHlwZXMgb2YgdGhlIG1hc3Rlci9zbGF2ZSBpbnRlcmZhY2UgKi8KKy8qID09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKworc3Ry
dWN0IHZpZGVvY29kZWMgKgordmlkZW9jb2RlY19hdHRhY2ggKHN0cnVjdCB2aWRlb2NvZGVjX21h
c3RlciAqbWFzdGVyKQoreworCXN0cnVjdCBjb2RlY19saXN0ICpoID0gY29kZWNsaXN0X3RvcDsK
KwlzdHJ1Y3QgYXR0YWNoZWRfbGlzdCAqYSwgKnB0cjsKKwlzdHJ1Y3QgdmlkZW9jb2RlYyAqY29k
ZWM7CisJaW50IHJlczsKKworCWlmICghbWFzdGVyKSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIg
InZpZGVvY29kZWNfYXR0YWNoOiBubyBkYXRhXG4iKTsKKwkJcmV0dXJuIE5VTEw7CisJfQorCisJ
ZHByaW50aygyLAorCQkidmlkZW9jb2RlY19hdHRhY2g6ICclcycsIGZsYWdzICVseCwgbWFnaWMg
JWx4XG4iLAorCQltYXN0ZXItPm5hbWUsIG1hc3Rlci0+ZmxhZ3MsIG1hc3Rlci0+bWFnaWMpOwor
CisJaWYgKCFoKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJSCisJCQkidmlkZW9jb2RlY19h
dHRhY2g6IG5vIGRldmljZSBhdmFpbGFibGVcbiIpOworCQlyZXR1cm4gTlVMTDsKKwl9CisKKwl3
aGlsZSAoaCkgeworCQkvLyBhdHRhY2ggb25seSBpZiB0aGUgc2xhdmUgaGFzIGF0IGxlYXN0IHRo
ZSBmbGFncworCQkvLyBleHBlY3RlZCBieSB0aGUgbWFzdGVyCisJCWlmICgobWFzdGVyLT5mbGFn
cyAmIGgtPmNvZGVjLT5mbGFncykgPT0gbWFzdGVyLT5mbGFncykgeworCQkJZHByaW50ayg0LCAi
dmlkZW9jb2RlY19hdHRhY2g6IHRyeSAnJXMnXG4iLAorCQkJCWgtPmNvZGVjLT5uYW1lKTsKKwor
CQkJaWYgKCF0cnlfbW9kdWxlX2dldChoLT5jb2RlYy0+b3duZXIpKQorCQkJCXJldHVybiBOVUxM
OworCisJCQljb2RlYyA9IGttZW1kdXAoaC0+Y29kZWMsIHNpemVvZihzdHJ1Y3QgdmlkZW9jb2Rl
YyksCisJCQkJCUdGUF9LRVJORUwpOworCQkJaWYgKCFjb2RlYykgeworCQkJCWRwcmludGsoMSwK
KwkJCQkJS0VSTl9FUlIKKwkJCQkJInZpZGVvY29kZWNfYXR0YWNoOiBubyBtZW1cbiIpOworCQkJ
CWdvdG8gb3V0X21vZHVsZV9wdXQ7CisJCQl9CisKKwkJCXJlcyA9IHN0cmxlbihjb2RlYy0+bmFt
ZSk7CisJCQlzbnByaW50Zihjb2RlYy0+bmFtZSArIHJlcywgc2l6ZW9mKGNvZGVjLT5uYW1lKSAt
IHJlcywKKwkJCQkgIlslZF0iLCBoLT5hdHRhY2hlZCk7CisJCQljb2RlYy0+bWFzdGVyX2RhdGEg
PSBtYXN0ZXI7CisJCQlyZXMgPSBjb2RlYy0+c2V0dXAoY29kZWMpOworCQkJaWYgKHJlcyA9PSAw
KSB7CisJCQkJZHByaW50aygzLCAidmlkZW9jb2RlY19hdHRhY2ggJyVzJ1xuIiwKKwkJCQkJY29k
ZWMtPm5hbWUpOworCQkJCXB0ciA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBhdHRhY2hlZF9saXN0
KSwgR0ZQX0tFUk5FTCk7CisJCQkJaWYgKCFwdHIpIHsKKwkJCQkJZHByaW50aygxLAorCQkJCQkJ
S0VSTl9FUlIKKwkJCQkJCSJ2aWRlb2NvZGVjX2F0dGFjaDogbm8gbWVtb3J5XG4iKTsKKwkJCQkJ
Z290byBvdXRfa2ZyZWU7CisJCQkJfQorCQkJCXB0ci0+Y29kZWMgPSBjb2RlYzsKKworCQkJCWEg
PSBoLT5saXN0OworCQkJCWlmICghYSkgeworCQkJCQloLT5saXN0ID0gcHRyOworCQkJCQlkcHJp
bnRrKDQsCisJCQkJCQkidmlkZW9jb2RlYzogZmlyc3QgZWxlbWVudFxuIik7CisJCQkJfSBlbHNl
IHsKKwkJCQkJd2hpbGUgKGEtPm5leHQpCisJCQkJCQlhID0gYS0+bmV4dDsJLy8gZmluZCBlbmQK
KwkJCQkJYS0+bmV4dCA9IHB0cjsKKwkJCQkJZHByaW50ayg0LAorCQkJCQkJInZpZGVvY29kZWM6
IGluIGFmdGVyICclcydcbiIsCisJCQkJCQloLT5jb2RlYy0+bmFtZSk7CisJCQkJfQorCisJCQkJ
aC0+YXR0YWNoZWQgKz0gMTsKKwkJCQlyZXR1cm4gY29kZWM7CisJCQl9IGVsc2UgeworCQkJCWtm
cmVlKGNvZGVjKTsKKwkJCX0KKwkJfQorCQloID0gaC0+bmV4dDsKKwl9CisKKwlkcHJpbnRrKDEs
IEtFUk5fRVJSICJ2aWRlb2NvZGVjX2F0dGFjaDogbm8gY29kZWMgZm91bmQhXG4iKTsKKwlyZXR1
cm4gTlVMTDsKKworIG91dF9tb2R1bGVfcHV0OgorCW1vZHVsZV9wdXQoaC0+Y29kZWMtPm93bmVy
KTsKKyBvdXRfa2ZyZWU6CisJa2ZyZWUoY29kZWMpOworCXJldHVybiBOVUxMOworfQorCitpbnQK
K3ZpZGVvY29kZWNfZGV0YWNoIChzdHJ1Y3QgdmlkZW9jb2RlYyAqY29kZWMpCit7CisJc3RydWN0
IGNvZGVjX2xpc3QgKmggPSBjb2RlY2xpc3RfdG9wOworCXN0cnVjdCBhdHRhY2hlZF9saXN0ICph
LCAqcHJldjsKKwlpbnQgcmVzOworCisJaWYgKCFjb2RlYykgeworCQlkcHJpbnRrKDEsIEtFUk5f
RVJSICJ2aWRlb2NvZGVjX2RldGFjaDogbm8gZGF0YVxuIik7CisJCXJldHVybiAtRUlOVkFMOwor
CX0KKworCWRwcmludGsoMiwKKwkJInZpZGVvY29kZWNfZGV0YWNoOiAnJXMnLCB0eXBlOiAleCwg
ZmxhZ3MgJWx4LCBtYWdpYyAlbHhcbiIsCisJCWNvZGVjLT5uYW1lLCBjb2RlYy0+dHlwZSwgY29k
ZWMtPmZsYWdzLCBjb2RlYy0+bWFnaWMpOworCisJaWYgKCFoKSB7CisJCWRwcmludGsoMSwKKwkJ
CUtFUk5fRVJSICJ2aWRlb2NvZGVjX2RldGFjaDogbm8gZGV2aWNlIGxlZnQuLi5cbiIpOworCQly
ZXR1cm4gLUVOWElPOworCX0KKworCXdoaWxlIChoKSB7CisJCWEgPSBoLT5saXN0OworCQlwcmV2
ID0gTlVMTDsKKwkJd2hpbGUgKGEpIHsKKwkJCWlmIChjb2RlYyA9PSBhLT5jb2RlYykgeworCQkJ
CXJlcyA9IGEtPmNvZGVjLT51bnNldChhLT5jb2RlYyk7CisJCQkJaWYgKHJlcyA+PSAwKSB7CisJ
CQkJCWRwcmludGsoMywKKwkJCQkJCSJ2aWRlb2NvZGVjX2RldGFjaDogJyVzJ1xuIiwKKwkJCQkJ
CWEtPmNvZGVjLT5uYW1lKTsKKwkJCQkJYS0+Y29kZWMtPm1hc3Rlcl9kYXRhID0gTlVMTDsKKwkJ
CQl9IGVsc2UgeworCQkJCQlkcHJpbnRrKDEsCisJCQkJCQlLRVJOX0VSUgorCQkJCQkJInZpZGVv
Y29kZWNfZGV0YWNoOiAnJXMnXG4iLAorCQkJCQkJYS0+Y29kZWMtPm5hbWUpOworCQkJCQlhLT5j
b2RlYy0+bWFzdGVyX2RhdGEgPSBOVUxMOworCQkJCX0KKwkJCQlpZiAocHJldiA9PSBOVUxMKSB7
CisJCQkJCWgtPmxpc3QgPSBhLT5uZXh0OworCQkJCQlkcHJpbnRrKDQsCisJCQkJCQkidmlkZW9j
b2RlYzogZGVsZXRlIGZpcnN0XG4iKTsKKwkJCQl9IGVsc2UgeworCQkJCQlwcmV2LT5uZXh0ID0g
YS0+bmV4dDsKKwkJCQkJZHByaW50ayg0LAorCQkJCQkJInZpZGVvY29kZWM6IGRlbGV0ZSBtaWRk
bGVcbiIpOworCQkJCX0KKwkJCQltb2R1bGVfcHV0KGEtPmNvZGVjLT5vd25lcik7CisJCQkJa2Zy
ZWUoYS0+Y29kZWMpOworCQkJCWtmcmVlKGEpOworCQkJCWgtPmF0dGFjaGVkIC09IDE7CisJCQkJ
cmV0dXJuIDA7CisJCQl9CisJCQlwcmV2ID0gYTsKKwkJCWEgPSBhLT5uZXh0OworCQl9CisJCWgg
PSBoLT5uZXh0OworCX0KKworCWRwcmludGsoMSwgS0VSTl9FUlIgInZpZGVvY29kZWNfZGV0YWNo
OiBnaXZlbiBjb2RlYyBub3QgZm91bmQhXG4iKTsKKwlyZXR1cm4gLUVJTlZBTDsKK30KKworaW50
Cit2aWRlb2NvZGVjX3JlZ2lzdGVyIChjb25zdCBzdHJ1Y3QgdmlkZW9jb2RlYyAqY29kZWMpCit7
CisJc3RydWN0IGNvZGVjX2xpc3QgKnB0ciwgKmggPSBjb2RlY2xpc3RfdG9wOworCisJaWYgKCFj
b2RlYykgeworCQlkcHJpbnRrKDEsIEtFUk5fRVJSICJ2aWRlb2NvZGVjX3JlZ2lzdGVyOiBubyBk
YXRhIVxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWRwcmludGsoMiwKKwkJInZpZGVv
Y29kZWM6IHJlZ2lzdGVyICclcycsIHR5cGU6ICV4LCBmbGFncyAlbHgsIG1hZ2ljICVseFxuIiwK
KwkJY29kZWMtPm5hbWUsIGNvZGVjLT50eXBlLCBjb2RlYy0+ZmxhZ3MsIGNvZGVjLT5tYWdpYyk7
CisKKwlwdHIgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgY29kZWNfbGlzdCksIEdGUF9LRVJORUwp
OworCWlmICghcHRyKSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIgInZpZGVvY29kZWNfcmVnaXN0
ZXI6IG5vIG1lbW9yeVxuIik7CisJCXJldHVybiAtRU5PTUVNOworCX0KKwlwdHItPmNvZGVjID0g
Y29kZWM7CisKKwlpZiAoIWgpIHsKKwkJY29kZWNsaXN0X3RvcCA9IHB0cjsKKwkJZHByaW50ayg0
LCAidmlkZW9jb2RlYzogaG9va2VkIGluIGFzIGZpcnN0IGVsZW1lbnRcbiIpOworCX0gZWxzZSB7
CisJCXdoaWxlIChoLT5uZXh0KQorCQkJaCA9IGgtPm5leHQ7CS8vIGZpbmQgdGhlIGVuZAorCQlo
LT5uZXh0ID0gcHRyOworCQlkcHJpbnRrKDQsICJ2aWRlb2NvZGVjOiBob29rZWQgaW4gYWZ0ZXIg
JyVzJ1xuIiwKKwkJCWgtPmNvZGVjLT5uYW1lKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworaW50
Cit2aWRlb2NvZGVjX3VucmVnaXN0ZXIgKGNvbnN0IHN0cnVjdCB2aWRlb2NvZGVjICpjb2RlYykK
K3sKKwlzdHJ1Y3QgY29kZWNfbGlzdCAqcHJldiA9IE5VTEwsICpoID0gY29kZWNsaXN0X3RvcDsK
KworCWlmICghY29kZWMpIHsKKwkJZHByaW50aygxLCBLRVJOX0VSUiAidmlkZW9jb2RlY191bnJl
Z2lzdGVyOiBubyBkYXRhIVxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWRwcmludGso
MiwKKwkJInZpZGVvY29kZWM6IHVucmVnaXN0ZXIgJyVzJywgdHlwZTogJXgsIGZsYWdzICVseCwg
bWFnaWMgJWx4XG4iLAorCQljb2RlYy0+bmFtZSwgY29kZWMtPnR5cGUsIGNvZGVjLT5mbGFncywg
Y29kZWMtPm1hZ2ljKTsKKworCWlmICghaCkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgor
CQkJInZpZGVvY29kZWNfdW5yZWdpc3Rlcjogbm8gZGV2aWNlIGxlZnQuLi5cbiIpOworCQlyZXR1
cm4gLUVOWElPOworCX0KKworCXdoaWxlIChoKSB7CisJCWlmIChjb2RlYyA9PSBoLT5jb2RlYykg
eworCQkJaWYgKGgtPmF0dGFjaGVkKSB7CisJCQkJZHByaW50aygxLAorCQkJCQlLRVJOX0VSUgor
CQkJCQkidmlkZW9jb2RlYzogJyVzJyBpcyB1c2VkXG4iLAorCQkJCQloLT5jb2RlYy0+bmFtZSk7
CisJCQkJcmV0dXJuIC1FQlVTWTsKKwkJCX0KKwkJCWRwcmludGsoMywgInZpZGVvY29kZWM6IHVu
cmVnaXN0ZXIgJyVzJyBpcyBvay5cbiIsCisJCQkJaC0+Y29kZWMtPm5hbWUpOworCQkJaWYgKHBy
ZXYgPT0gTlVMTCkgeworCQkJCWNvZGVjbGlzdF90b3AgPSBoLT5uZXh0OworCQkJCWRwcmludGso
NCwKKwkJCQkJInZpZGVvY29kZWM6IGRlbGV0ZSBmaXJzdCBlbGVtZW50XG4iKTsKKwkJCX0gZWxz
ZSB7CisJCQkJcHJldi0+bmV4dCA9IGgtPm5leHQ7CisJCQkJZHByaW50ayg0LAorCQkJCQkidmlk
ZW9jb2RlYzogZGVsZXRlIG1pZGRsZSBlbGVtZW50XG4iKTsKKwkJCX0KKwkJCWtmcmVlKGgpOwor
CQkJcmV0dXJuIDA7CisJCX0KKwkJcHJldiA9IGg7CisJCWggPSBoLT5uZXh0OworCX0KKworCWRw
cmludGsoMSwKKwkJS0VSTl9FUlIKKwkJInZpZGVvY29kZWNfdW5yZWdpc3RlcjogZ2l2ZW4gY29k
ZWMgbm90IGZvdW5kIVxuIik7CisJcmV0dXJuIC1FSU5WQUw7Cit9CisKKyNpZmRlZiBDT05GSUdf
UFJPQ19GUworc3RhdGljIGludCBwcm9jX3ZpZGVvY29kZWNzX3Nob3coc3RydWN0IHNlcV9maWxl
ICptLCB2b2lkICp2KQoreworCXN0cnVjdCBjb2RlY19saXN0ICpoID0gY29kZWNsaXN0X3RvcDsK
KwlzdHJ1Y3QgYXR0YWNoZWRfbGlzdCAqYTsKKworCXNlcV9wcmludGYobSwgIjxTPmxhdmUgb3Ig
YXR0YWNoZWQgPE0+YXN0ZXIgbmFtZSAgdHlwZSBmbGFncyAgICBtYWdpYyAgICAiKTsKKwlzZXFf
cHJpbnRmKG0sICIoY29ubmVjdGVkIGFzKVxuIik7CisKKwl3aGlsZSAoaCkgeworCQlzZXFfcHJp
bnRmKG0sICJTICUzMnMgJTA0eCAlMDhseCAlMDhseCAoVEVNUExBVEUpXG4iLAorCQkJICAgICAg
aC0+Y29kZWMtPm5hbWUsIGgtPmNvZGVjLT50eXBlLAorCQkJICAgICAgaC0+Y29kZWMtPmZsYWdz
LCBoLT5jb2RlYy0+bWFnaWMpOworCQlhID0gaC0+bGlzdDsKKwkJd2hpbGUgKGEpIHsKKwkJCXNl
cV9wcmludGYobSwgIk0gJTMycyAlMDR4ICUwOGx4ICUwOGx4ICglcylcbiIsCisJCQkJICAgICAg
YS0+Y29kZWMtPm1hc3Rlcl9kYXRhLT5uYW1lLAorCQkJCSAgICAgIGEtPmNvZGVjLT5tYXN0ZXJf
ZGF0YS0+dHlwZSwKKwkJCQkgICAgICBhLT5jb2RlYy0+bWFzdGVyX2RhdGEtPmZsYWdzLAorCQkJ
CSAgICAgIGEtPmNvZGVjLT5tYXN0ZXJfZGF0YS0+bWFnaWMsCisJCQkJICAgICAgYS0+Y29kZWMt
Pm5hbWUpOworCQkJYSA9IGEtPm5leHQ7CisJCX0KKwkJaCA9IGgtPm5leHQ7CisJfQorCisJcmV0
dXJuIDA7Cit9CisjZW5kaWYKKworLyogPT09PT09PT09PT09PT09PT09PT09ICovCisvKiBob29r
IGluIGRyaXZlciBtb2R1bGUgKi8KKy8qID09PT09PT09PT09PT09PT09PT09PSAqLworc3RhdGlj
IGludCBfX2luaXQKK3ZpZGVvY29kZWNfaW5pdCAodm9pZCkKK3sKKyNpZmRlZiBDT05GSUdfUFJP
Q19GUworCXN0YXRpYyBzdHJ1Y3QgcHJvY19kaXJfZW50cnkgKnZpZGVvY29kZWNfcHJvY19lbnRy
eTsKKyNlbmRpZgorCisJcHJpbnRrKEtFUk5fSU5GTyAiTGludXggdmlkZW8gY29kZWMgaW50ZXJt
ZWRpYXRlIGxheWVyOiAlc1xuIiwKKwkgICAgICAgVklERU9DT0RFQ19WRVJTSU9OKTsKKworI2lm
ZGVmIENPTkZJR19QUk9DX0ZTCisJdmlkZW9jb2RlY19wcm9jX2VudHJ5ID0gcHJvY19jcmVhdGVf
c2luZ2xlKCJ2aWRlb2NvZGVjcyIsIDAsIE5VTEwsCisJCQlwcm9jX3ZpZGVvY29kZWNzX3Nob3cp
OworCWlmICghdmlkZW9jb2RlY19wcm9jX2VudHJ5KSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIg
InZpZGVvY29kZWM6IGNhbid0IGluaXQgcHJvY2ZzLlxuIik7CisJfQorI2VuZGlmCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyB2b2lkIF9fZXhpdAordmlkZW9jb2RlY19leGl0ICh2b2lkKQorewor
I2lmZGVmIENPTkZJR19QUk9DX0ZTCisJcmVtb3ZlX3Byb2NfZW50cnkoInZpZGVvY29kZWNzIiwg
TlVMTCk7CisjZW5kaWYKK30KKworRVhQT1JUX1NZTUJPTCh2aWRlb2NvZGVjX2F0dGFjaCk7CitF
WFBPUlRfU1lNQk9MKHZpZGVvY29kZWNfZGV0YWNoKTsKK0VYUE9SVF9TWU1CT0wodmlkZW9jb2Rl
Y19yZWdpc3Rlcik7CitFWFBPUlRfU1lNQk9MKHZpZGVvY29kZWNfdW5yZWdpc3Rlcik7CisKK21v
ZHVsZV9pbml0KHZpZGVvY29kZWNfaW5pdCk7Cittb2R1bGVfZXhpdCh2aWRlb2NvZGVjX2V4aXQp
OworCitNT0RVTEVfQVVUSE9SKCJXb2xmZ2FuZyBTY2hlcnIgPHNjaGVyckBuZXQ0eW91LmF0PiIp
OworTU9EVUxFX0RFU0NSSVBUSU9OKCJJbnRlcm1lZGlhdGUgQVBJIG1vZHVsZSBmb3IgdmlkZW8g
Y29kZWNzICIKKwkJICAgVklERU9DT0RFQ19WRVJTSU9OKTsKK01PRFVMRV9MSUNFTlNFKCJHUEwi
KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi92aWRlb2NvZGVjLmgg
Yi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4vdmlkZW9jb2RlYy5oCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uOGVkNWEwZjdhYzAxCi0tLSAvZGV2L251bGwKKysr
IGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3ZpZGVvY29kZWMuaApAQCAtMCwwICsxLDM0
OSBAQAorLyoKKyAqIFZJREVPIE1PVElPTiBDT0RFQ3MgaW50ZXJuYWwgQVBJIGZvciB2aWRlbyBk
ZXZpY2VzCisgKgorICogSW50ZXJmYWNlIGZvciBNSlBFRyAoYW5kIG1heWJlIGxhdGVyIE1QRUcv
V0FWRUxFVFMpIGNvZGVjJ3MKKyAqIGJvdW5kIHRvIGEgbWFzdGVyIGRldmljZS4KKyAqCisgKiAo
YykgMjAwMiBXb2xmZ2FuZyBTY2hlcnIgPHNjaGVyckBuZXQ0eW91LmF0PgorICoKKyAqICRJZDog
dmlkZW9jb2RlYy5oLHYgMS4xLjIuNCAyMDAzLzAxLzE0IDIxOjE1OjAzIHJidWx0amUgRXhwICQK
KyAqCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0
d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogaXQgdW5kZXIg
dGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQg
YnkKKyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2Yg
dGhlIExpY2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgor
ICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdp
bGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4g
dGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZP
UiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBM
aWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKi8KKwor
LyogPT09PT09PT09PT09PT09PT09PSAqLworLyogZ2VuZXJhbCBkZXNjcmlwdGlvbiAqLworLyog
PT09PT09PT09PT09PT09PT09PSAqLworCisvKiBTaG91bGQgZWFzZSB0aGUgKHJlLSl1c2FnZSBv
ZiBkcml2ZXJzIHN1cHBvcnRpbmcgY2FyZHMgd2l0aCAoZGlmZmVyZW50KQorICAgdmlkZW8gY29k
ZWNzLiBUaGUgY29kZWNzIHJlZ2lzdGVyIHRvIHRoaXMgbW9kdWxlIHRoZWlyIGZ1bmN0aW9uYWxp
dHksCisgICBhbmQgdGhlIHByb2Nlc3NvcnMgKG1hc3RlcnMpIGNhbiBhdHRhY2ggdG8gdGhlbSBp
ZiB0aGV5IGZpdC4KKworICAgVGhlIGNvZGVjcyBhcmUgdHlwaWNhbGx5IGhhdmUgYSAic3Ryb25n
IiBiaW5kaW5nIHRvIHRoZWlyIG1hc3RlciAtIHNvIEkKKyAgIGRvbid0IHRoaW5rIGl0IG1ha2Vz
IHNlbnNlIHRvIGhhdmUgYSBmdWxsIGJsb3duIGludGVyZmFjaW5nIGFzIHdpdGggZS5nLgorICAg
aTJjLiBJZiB5b3UgaGF2ZSBhbiBvdGhlciBvcGluaW9uLCBsZXQncyBkaXNjdXNzICYgaW1wbGVt
ZW50IGl0IDotKSkpCisKKyAgIFVzYWdlOgorCisgICBUaGUgc2xhdmUgaGFzIGp1c3QgdG8gc2V0
dXAgdGhlIHZpZGVvY29kZWMgc3RydWN0dXJlIGFuZCB1c2UgdHdvIGZ1bmN0aW9uczoKKyAgIHZp
ZGVvY29kZWNfcmVnaXN0ZXIoY29kZWNkYXRhKTsKKyAgIHZpZGVvY29kZWNfdW5yZWdpc3Rlcihj
b2RlY2RhdGEpOworICAgVGhlIGJlc3QgaXMganVzdCBjYWxsaW5nIHRoZW0gYXQgbW9kdWxlIChk
ZS0paW5pdGlhbGlzYXRpb24uCisKKyAgIFRoZSBtYXN0ZXIgc2V0cyB1cCB0aGUgc3RydWN0dXJl
IHZpZGVvY29kZWNfbWFzdGVyIGFuZCBjYWxsczoKKyAgIGNvZGVjZGF0YT12aWRlb2NvZGVjX2F0
dGFjaChtYXN0ZXJfY29kZWNkYXRhKTsKKyAgIHZpZGVvY29kZWNfZGV0YWNoKGNvZGVjZGF0YSk7
CisKKyAgIFRoZSBzbGF2ZSBpcyBjYWxsZWQgZHVyaW5nIGF0dGFjaC9kZXRhY2ggdmlhIGZ1bmN0
aW9ucyBzZXR1cCBwcmV2aW91c2x5CisgICBkdXJpbmcgcmVnaXN0ZXIuIEF0IHRoYXQgdGltZSwg
dGhlIG1hc3Rlcl9kYXRhIHBvaW50ZXIgaXMgc2V0IHVwCisgICBhbmQgdGhlIHNsYXZlIGNhbiBh
Y2Nlc3MgYW55IGlvIHJlZ2lzdGVycyBvZiB0aGUgbWFzdGVyIGRldmljZSAoaW4gdGhlIGNhc2UK
KyAgIHRoZSBzbGF2ZSBpcyBib3VuZCB0byBpdCkuIE90aGVyd2lzZSBpdCBkb2Vzbid0IG5lZWQg
dGhpcyBmdW5jdGlvbnMgYW5kCisgICB0aGVyZm9yIHRoZXkgbWF5IG5vdCBiZSBpbml0aWFsaXpl
ZC4KKworICAgVGhlIG90aGVyIGZ1bmN0aW9ucyBhcmUganVzdCBmb3IgY29udmVuaWVuY2UsIGFz
IHRoZXkgYXJlIGZvciBzdXJlIHVzZWQgYnkKKyAgIG1vc3QvYWxsIG9mIHRoZSBjb2RlY3MuIFRo
ZSBsYXN0IG9uZXMgbWF5IGJlIG9taXR0ZWQsIHRvby4KKworICAgU2VlIHRoZSBzdHJ1Y3R1cmUg
ZGVjbGFyYXRpb24gYmVsb3cgZm9yIG1vcmUgaW5mb3JtYXRpb24gYW5kIHdoaWNoIGRhdGEgaGFz
CisgICB0byBiZSBzZXQgdXAgZm9yIHRoZSBtYXN0ZXIgYW5kIHRoZSBzbGF2ZS4KKworICAgLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLQorICAgVGhlIG1hc3RlciBzaG91bGQgaGF2ZSAia25vd2xlZGdlIiBv
ZiB0aGUgc2xhdmUgYW5kIHZpY2UgdmVyc2EuICBTbyB0aGUgZGF0YQorICAgc3RydWN0dXJlcyBz
ZW50IHRvL2Zyb20gc2xhdmUgdmlhIHNldF9kYXRhL2dldF9kYXRhIHNldF9pbWFnZS9nZXRfaW1h
Z2UgYXJlCisgICBkZXZpY2UgZGVwZW5kZW50IGFuZCB2YXJ5IGJldHdlZW4gTUpQRUcvTVBFRy9X
QVZFTEVULy4uLiBkZXZpY2VzLiAoISEhISkKKyAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyovCisM
CisKKy8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLworLyog
ZGVzY3JpcHRpb24gb2YgdGhlIHZpZGVvY29kZWNfaW8gc3RydWN0dXJlICovCisvKiA9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKworLyoKKyAgID09PT0gbWFz
dGVyIHNldHVwID09PT0KKyAgIG5hbWUgLT4gbmFtZSBvZiB0aGUgZGV2aWNlIHN0cnVjdHVyZSBm
b3IgcmVmZXJlbmNlIGFuZCBkZWJ1Z2dpbmcKKyAgIG1hc3Rlcl9kYXRhIC0+ICBkYXRhIHJlZi4g
Zm9yIHRoZSBtYXN0ZXIgKGUuZy4gdGhlIHpyMzYwNTUsNTcsNjcpCisgICByZWFkcmVnIC0+IHJl
Zi4gdG8gcmVhZC1mbiBmcm9tIHJlZ2lzdGVyIChzZXR1cCBieSBtYXN0ZXIsIHVzZWQgYnkgc2xh
dmUpCisgICB3cml0ZXJlZyAtPiByZWYuIHRvIHdyaXRlLWZuIHRvIHJlZ2lzdGVyIChzZXR1cCBi
eSBtYXN0ZXIsIHVzZWQgYnkgc2xhdmUpCisJICAgICAgIHRoaXMgdHdvIGZ1bmN0aW9ucyBkbyB0
aGUgbG93bGV2ZWwgSS9PIGpvYgorCisgICA9PT09IHNsYXZlIGZ1bmN0aW9uYWxpdHkgc2V0dXAg
PT09PQorICAgc2xhdmVfZGF0YSAtPiBkYXRhIHJlZi4gZm9yIHRoZSBzbGF2ZSAoZS5nLiB0aGUg
enIzNjA1MCw2MCkKKyAgIGNoZWNrIC0+IGZuLXJlZi4gY2hlY2tzIGF2YWlsYWJpbGl0eSBvZiBh
biBkZXZpY2UsIHJldHVybnMgLUVJTyBvbiBmYWlsdXJlIG9yCisJICAgIHRoZSB0eXBlIG9uIHN1
Y2Nlc3MKKwkgICAgdGhpcyBtYWtlcyBlc3BjZWNpYWxseSBzZW5zZSBpZiBhIGRyaXZlciBtb2R1
bGUgc3VwcG9ydHMgbW9yZSB0aGFuCisJICAgIG9uZSBjb2RlYyB3aGljaCBtYXkgYmUgcXVpdGUg
c2ltaWxhciB0byBhY2Nlc3MsIG5ldmVydGhlbGVzcyBpdAorCSAgICBpcyBnb29kIGZvciBhIGZp
cnN0IGZ1bmN0aW9uYWxpdHkgY2hlY2sKKworICAgLS0gbWFpbiBmdW5jdGlvbnMgeW91IGFsd2F5
cyBuZWVkIGZvciBjb21wcmVzc2lvbi9kZWNvbXByZXNzaW9uIC0tCisKKyAgIHNldF9tb2RlIC0+
IHRoaXMgZm4tcmVmLiByZXNldHMgdGhlIGVudGlyZSBjb2RlYywgYW5kIHNldHMgdXAgdGhlIG1v
ZGUKKwkgICAgICAgd2l0aCB0aGUgbGFzdCBkZWZpbmVkIG5vcm0vc2l6ZSAob3IgZGV2aWNlIGRl
ZmF1bHQgaWYgbm90CisJICAgICAgIGF2YWlsYWJsZSkgLSBpdCByZXR1cm5zIDAgaWYgdGhlIG1v
ZGUgaXMgcG9zc2libGUKKyAgIHNldF9zaXplIC0+IHRoaXMgZm4tcmVmLiBzZXRzIHRoZSBub3Jt
IGFuZCBpbWFnZSBzaXplIGZvcgorCSAgICAgICBjb21wcmVzc2lvbi9kZWNvbXByZXNzaW9uIChy
ZXR1cm5zIDAgb24gc3VjY2VzcykKKwkgICAgICAgdGhlIG5vcm0gcGFyYW0gaXMgZGVmaW5lZCBp
biB2aWRlb2RldjIuaCAoVjRMMl9TVERfKikKKworICAgYWRkaXRpb25hbCBzZXR1cCBtYXkgYmUg
YXZhaWxhYmxlLCB0b28gLSBidXQgdGhlIGNvZGVjIHNob3VsZCB3b3JrIHdpdGgKKyAgIHNvbWUg
ZGVmYXVsdCB2YWx1ZXMgZXZlbiB3aXRob3V0IHRoaXMKKworICAgc2V0X2RhdGEgLT4gc2V0cyBk
ZXZpY2Utc3BlY2lmaWMgZGF0YSAodGFibGVzLCBxdWFsaXR5IGV0Yy4pCisgICBnZXRfZGF0YSAt
PiBxdWVyeSBkZXZpY2Utc3BlY2lmaWMgZGF0YSAodGFibGVzLCBxdWFsaXR5IGV0Yy4pCisKKyAg
IGlmIHRoZSBkZXZpY2UgZGVsaXZlcnMgaW50ZXJydXB0cywgdGhleSBtYXkgYmUgc2V0dXAvaGFu
ZGxlZCBoZXJlCisgICBzZXR1cF9pbnRlcnJ1cHQgLT4gY29kZWMgaXJxIHNldHVwIChub3QgbmVl
ZGVkIGZvciAzNjA1MC82MCkKKyAgIGhhbmRsZV9pbnRlcnJ1cHQgLT4gY29kZWMgaXJxIGhhbmRs
aW5nIChub3QgbmVlZGVkIGZvciAzNjA1MC82MCkKKworICAgaWYgdGhlIGRldmljZSBkZWxpdmVy
cyBwaWN0dXJlcywgdGhleSBtYXkgYmUgaGFuZGxlZCBoZXJlCisgICBwdXRfaW1hZ2UgLT4gcHV0
cyBpbWFnZSBkYXRhIHRvIHRoZSBjb2RlYyAobm90IG5lZWRlZCBmb3IgMzYwNTAvNjApCisgICBn
ZXRfaW1hZ2UgLT4gZ2V0cyBpbWFnZSBkYXRhIGZyb20gdGhlIGNvZGVjIChub3QgbmVlZGVkIGZv
ciAzNjA1MC82MCkKKwkJdGhlIGNhbGxzIGluY2x1ZGUgZnJhbWUgbnVtYmVycyBhbmQgZmxhZ3Mg
KGV2ZW4vb2RkLy4uLikKKwkJaWYgbmVlZGVkIGFuZCBhIGZsYWcgd2hpY2ggYWxsb3dzIGJsb2Nr
aW5nIHVudGlsIGl0cyByZWFkeQorKi8KKwwKKy8qID09PT09PT09PT09PT09ICovCisvKiB1c2Vy
IGludGVyZmFjZSAqLworLyogPT09PT09PT09PT09PT0gKi8KKworLyoKKyAgIEN1cnJlbnRseSB0
aGVyZSBpcyBvbmx5IGEgaW5mb3JtYXRpb24gZGlzcGxheSBwbGFubmVkLCBhcyB0aGUgbGF5ZXIK
KyAgIGlzIG5vdCB2aXNpYmxlIGZvciB0aGUgdXNlciBzcGFjZSBhdCBhbGwuCisKKyAgIEluZm9y
bWF0aW9uIGlzIGF2YWlsYWJsZSB2aWEgcHJvY2ZzLiBUaGUgY3VycmVudCBlbnRyeSBpcyAiL3By
b2MvdmlkZW9jb2RlY3MiCisgICBidXQgaXQgbWFrZXMgc2Vuc2UgdG8gImhpZGUiIGl0IGluIHRo
ZSAvcHJvYy92aWRlbyB0cmVlIG9mIHY0bCgyKSAtLVRPRE8tLS4KKworQSBleGFtcGxlIGZvciBz
dWNoIGFuIG91dHB1dCBpczoKKworPFM+bGF2ZSBvciBhdHRhY2hlZCA8TT5hc3RlciBuYW1lICB0
eXBlIGZsYWdzICAgIG1hZ2ljICAgIChjb25uZWN0ZWQgYXMpCitTICAgICAgICAgICAgICAgICAg
ICAgICAgICB6cjM2MDUwIDAwMDIgMDAwMGQwMDEgMDAwMDAwMDAgKFRFTVBMQVRFKQorTSAgICAg
ICAgICAgICAgICAgICAgICAgenIzNjA1NVswXSAwMDAxIDAwMDBjMDAxIDAwMDAwMDAwICh6cjM2
MDUwWzBdKQorTSAgICAgICAgICAgICAgICAgICAgICAgenIzNjA1NVsxXSAwMDAxIDAwMDBjMDAx
IDAwMDAwMDAwICh6cjM2MDUwWzFdKQorCisqLworDAorCisvKiA9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLworLyogc3BlY2lhbCBkZWZpbmVzIGZvciB0
aGUgdmlkZW9jb2RlY19pbyBzdHJ1Y3R1cmUgKi8KKy8qID09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ICovCisKKyNpZm5kZWYgX19MSU5VWF9WSURFT0NPREVD
X0gKKyNkZWZpbmUgX19MSU5VWF9WSURFT0NPREVDX0gKKworI2luY2x1ZGUgPGxpbnV4L3ZpZGVv
ZGV2Mi5oPgorCisjZGVmaW5lIENPREVDX0RPX0NPTVBSRVNTSU9OIDAKKyNkZWZpbmUgQ09ERUNf
RE9fRVhQQU5TSU9OICAgMQorCisvKiB0aGlzIGFyZSB0aGUgY3VycmVudCBjb2RlYyBmbGFncyBJ
IHRoaW5rIHRoZXkgYXJlIG5lZWRlZCAqLworLyogIC0+IHR5cGUgdmFsdWUgaW4gc3RydWN0dXJl
ICovCisjZGVmaW5lIENPREVDX0ZMQUdfSlBFRyAgICAgIDB4MDAwMDAwMDFMCS8vIEpQRUcgY29k
ZWMKKyNkZWZpbmUgQ09ERUNfRkxBR19NUEVHICAgICAgMHgwMDAwMDAwMkwJLy8gTVBFRzEvMi80
IGNvZGVjCisjZGVmaW5lIENPREVDX0ZMQUdfRElWWCAgICAgIDB4MDAwMDAwMDRMCS8vIERJVlgg
Y29kZWMKKyNkZWZpbmUgQ09ERUNfRkxBR19XQVZFTEVUICAgMHgwMDAwMDAwOEwJLy8gV0FWRUxF
VCBjb2RlYworCQkJCQkgIC8vIHJvb20gZm9yIG90aGVyIHR5cGVzCisKKyNkZWZpbmUgQ09ERUNf
RkxBR19NQUdJQyAgICAgMHgwMDAwMDgwMEwJLy8gbWFnaWMga2V5IG11c3QgbWF0Y2gKKyNkZWZp
bmUgQ09ERUNfRkxBR19IQVJEV0FSRSAgMHgwMDAwMTAwMEwJLy8gaXMgYSBoYXJkd2FyZSBjb2Rl
YworI2RlZmluZSBDT0RFQ19GTEFHX1ZGRSAgICAgICAweDAwMDAyMDAwTAkvLyBoYXMgZGlyZWN0
IHZpZGVvIGZyb250ZW5kCisjZGVmaW5lIENPREVDX0ZMQUdfRU5DT0RFUiAgIDB4MDAwMDQwMDBM
CS8vIGNvbXByZXNzaW9uIGNhcGFiaWxpdHkKKyNkZWZpbmUgQ09ERUNfRkxBR19ERUNPREVSICAg
MHgwMDAwODAwMEwJLy8gZGVjb21wcmVzc2lvbiBjYXBhYmlsaXR5CisjZGVmaW5lIENPREVDX0ZM
QUdfTkVFRElSUSAgIDB4MDAwMTAwMDBMCS8vIG5lZWRzIGlycSBoYW5kbGluZworI2RlZmluZSBD
T0RFQ19GTEFHX1JEV1JQSUMgICAweDAwMDIwMDAwTAkvLyBoYW5kbGVzIHBpY3R1cmUgSS9PCisK
Ky8qIGEgbGlzdCBvZiBtb2Rlcywgc29tZSBhcmUganVzdCBleGFtcGxlcyAoaXMgdGhlcmUgYW55
IEhXPykgKi8KKyNkZWZpbmUgQ09ERUNfTU9ERV9CSlBHICAgICAgMHgwMDAxCS8vIEJhc2VsaW5l
IEpQRUcKKyNkZWZpbmUgQ09ERUNfTU9ERV9MSlBHICAgICAgMHgwMDAyCS8vIExvc3NsZXNzIEpQ
RUcKKyNkZWZpbmUgQ09ERUNfTU9ERV9NUEVHMSAgICAgMHgwMDAzCS8vIE1QRUcgMQorI2RlZmlu
ZSBDT0RFQ19NT0RFX01QRUcyICAgICAweDAwMDQJLy8gTVBFRyAyCisjZGVmaW5lIENPREVDX01P
REVfTVBFRzQgICAgIDB4MDAwNQkvLyBNUEVHIDQKKyNkZWZpbmUgQ09ERUNfTU9ERV9NU0RJVlgg
ICAgMHgwMDA2CS8vIE1TIERpdlgKKyNkZWZpbmUgQ09ERUNfTU9ERV9PRElWWCAgICAgMHgwMDA3
CS8vIE9wZW4gRGl2WAorI2RlZmluZSBDT0RFQ19NT0RFX1dBVkVMRVQgICAweDAwMDgJLy8gV2F2
ZWxldAorCisvKiB0aGlzIGFyZSB0aGUgY3VycmVudCBjb2RlYyB0eXBlcyBJIHdhbnQgdG8gaW1w
bGVtZW50ICovCisvKiAgLT4gdHlwZSB2YWx1ZSBpbiBzdHJ1Y3R1cmUgKi8KKyNkZWZpbmUgQ09E
RUNfVFlQRV9OT05FICAgIDAKKyNkZWZpbmUgQ09ERUNfVFlQRV9MNjQ3MDIgIDEKKyNkZWZpbmUg
Q09ERUNfVFlQRV9aUjM2MDUwIDIKKyNkZWZpbmUgQ09ERUNfVFlQRV9aUjM2MDE2IDMKKyNkZWZp
bmUgQ09ERUNfVFlQRV9aUjM2MDYwIDQKKworLyogdGhlIHR5cGUgb2YgZGF0YSBtYXkgYmUgZW5o
YW5jZWQgYnkgZnV0dXJlIGltcGxlbWVudGF0aW9ucyAoZGF0YS1mbi4ncykgKi8KKy8qICAtPiB1
c2VkIGluIGNvbW1hbmQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICovCisjZGVmaW5lIENPREVDX0dfU1RBVFVTICAgICAgICAgMHgwMDAwCS8qIGNv
ZGVjIHN0YXR1cyAocXVlcnkgb25seSkgKi8KKyNkZWZpbmUgQ09ERUNfU19DT0RFQ19NT0RFICAg
ICAweDAwMDEJLyogY29kZWMgbW9kZSAoYmFzZWxpbmUgSlBFRywgTVBFRzEsLi4uICovCisjZGVm
aW5lIENPREVDX0dfQ09ERUNfTU9ERSAgICAgMHg4MDAxCisjZGVmaW5lIENPREVDX1NfVkZFICAg
ICAgICAgICAgMHgwMDAyCS8qIGFkZGl0aW9uYWwgdmlkZW8gZnJvbnRlbmQgc2V0dXAgKi8KKyNk
ZWZpbmUgQ09ERUNfR19WRkUgICAgICAgICAgICAweDgwMDIKKyNkZWZpbmUgQ09ERUNfU19NTUFQ
ICAgICAgICAgICAweDAwMDMJLyogTU1BUCBzZXR1cCAoaWYgYXZhaWxhYmxlKSAqLworCisjZGVm
aW5lIENPREVDX1NfSlBFR19URFNfQllURSAgMHgwMDEwCS8qIHRhcmdldCBkYXRhIHNpemUgaW4g
Ynl0ZXMgKi8KKyNkZWZpbmUgQ09ERUNfR19KUEVHX1REU19CWVRFICAweDgwMTAKKyNkZWZpbmUg
Q09ERUNfU19KUEVHX1NDQUxFICAgICAweDAwMTEJLyogc2NhbGluZyBmYWN0b3IgZm9yIHF1YW50
LiB0YWJsZXMgKi8KKyNkZWZpbmUgQ09ERUNfR19KUEVHX1NDQUxFICAgICAweDgwMTEKKyNkZWZp
bmUgQ09ERUNfU19KUEVHX0hEVF9EQVRBICAweDAwMTgJLyogaHVmZm1hbi10YWJsZXMgKi8KKyNk
ZWZpbmUgQ09ERUNfR19KUEVHX0hEVF9EQVRBICAweDgwMTgKKyNkZWZpbmUgQ09ERUNfU19KUEVH
X1FEVF9EQVRBICAweDAwMTkJLyogcXVhbnRpemluZy10YWJsZXMgKi8KKyNkZWZpbmUgQ09ERUNf
R19KUEVHX1FEVF9EQVRBICAweDgwMTkKKyNkZWZpbmUgQ09ERUNfU19KUEVHX0FQUF9EQVRBICAw
eDAwMUEJLyogQVBQIG1hcmtlciAqLworI2RlZmluZSBDT0RFQ19HX0pQRUdfQVBQX0RBVEEgIDB4
ODAxQQorI2RlZmluZSBDT0RFQ19TX0pQRUdfQ09NX0RBVEEgIDB4MDAxQgkvKiBDT00gbWFya2Vy
ICovCisjZGVmaW5lIENPREVDX0dfSlBFR19DT01fREFUQSAgMHg4MDFCCisKKyNkZWZpbmUgQ09E
RUNfU19QUklWQVRFICAgICAgICAweDEwMDAJLyogInByaXZhdGUiIGNvbW1hbmRzIHN0YXJ0IGhl
cmUgKi8KKyNkZWZpbmUgQ09ERUNfR19QUklWQVRFICAgICAgICAweDkwMDAKKworI2RlZmluZSBD
T0RFQ19HX0ZMQUcgICAgICAgICAgIDB4ODAwMAkvKiB0aGlzIGlzIGhvdyAnZ2V0JyBpcyBkZXRl
Y3RlZCAqLworCisvKiB0eXBlcyBvZiB0cmFuc2ZlciwgZGlyZWN0bHkgdXNlciBzcGFjZSBvciBh
IGtlcm5lbCBidWZmZXIgKGltYWdlLWZuLidzKSAqLworLyogIC0+IHVzZWQgaW4gZ2V0X2ltYWdl
LCBwdXRfaW1hZ2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KKyNk
ZWZpbmUgQ09ERUNfVFJBTlNGRVJfS0VSTkVMIDAJLyogdXNlICJtZW1jb3B5IiAqLworI2RlZmlu
ZSBDT0RFQ19UUkFOU0ZFUl9VU0VSICAgMQkvKiB1c2UgInRvL2Zyb21fdXNlciIgKi8KKwwKKwor
LyogPT09PT09PT09PT09PT09PT09PT09PT09PSAqLworLyogdGhlIHN0cnVjdHVyZXMgaXRzZWxm
IC4uLiAqLworLyogPT09PT09PT09PT09PT09PT09PT09PT09PSAqLworCitzdHJ1Y3QgdmZlX3Bv
bGFyaXR5IHsKKwl1bnNpZ25lZCBpbnQgdnN5bmNfcG9sOjE7CisJdW5zaWduZWQgaW50IGhzeW5j
X3BvbDoxOworCXVuc2lnbmVkIGludCBmaWVsZF9wb2w6MTsKKwl1bnNpZ25lZCBpbnQgYmxhbmtf
cG9sOjE7CisJdW5zaWduZWQgaW50IHN1YmltZ19wb2w6MTsKKwl1bnNpZ25lZCBpbnQgcG9lX3Bv
bDoxOworCXVuc2lnbmVkIGludCBwdmFsaWRfcG9sOjE7CisJdW5zaWduZWQgaW50IHZjbGtfcG9s
OjE7Cit9OworCitzdHJ1Y3QgdmZlX3NldHRpbmdzIHsKKwlfX3UzMiB4LCB5OwkJLyogT2Zmc2V0
cyBpbnRvIGltYWdlICovCisJX191MzIgd2lkdGgsIGhlaWdodDsJLyogQXJlYSB0byBjYXB0dXJl
ICovCisJX191MTYgZGVjaW1hdGlvbjsJLyogRGVjaW1hdGlvbiBkaXZpZGVyICovCisJX191MTYg
ZmxhZ3M7CQkvKiBGbGFncyBmb3IgY2FwdHVyZSAqLworCV9fdTE2IHF1YWxpdHk7CQkvKiBxdWFs
aXR5IG9mIHRoZSB2aWRlbyAqLworfTsKKworc3RydWN0IHR2bm9ybSB7CisJdTE2IFd0LCBXYSwg
SFN0YXJ0LCBIU3luY1N0YXJ0LCBIdCwgSGEsIFZTdGFydDsKK307CisKK3N0cnVjdCBqcGVnX2Nv
bV9tYXJrZXIgeworCWludCBsZW47IC8qIG51bWJlciBvZiB1c2FibGUgYnl0ZXMgaW4gZGF0YSAq
LworCWNoYXIgZGF0YVs2MF07Cit9OworCitzdHJ1Y3QganBlZ19hcHBfbWFya2VyIHsKKwlpbnQg
YXBwbjsgLyogbnVtYmVyIGFwcCBzZWdtZW50ICovCisJaW50IGxlbjsgLyogbnVtYmVyIG9mIHVz
YWJsZSBieXRlcyBpbiBkYXRhICovCisJY2hhciBkYXRhWzYwXTsKK307CisKK3N0cnVjdCB2aWRl
b2NvZGVjIHsKKwlzdHJ1Y3QgbW9kdWxlICpvd25lcjsKKwkvKiAtLSBmaWxsZWQgaW4gYnkgc2xh
dmUgZGV2aWNlIGR1cmluZyByZWdpc3RlciAtLSAqLworCWNoYXIgbmFtZVszMl07CisJdW5zaWdu
ZWQgbG9uZyBtYWdpYzsJLyogbWF5IGJlIHVzZWQgZm9yIGNsaWVudDwtPm1hc3RlciBhdHRhY2hp
bmcgKi8KKwl1bnNpZ25lZCBsb25nIGZsYWdzOwkvKiBmdW5jdGlvbmFsaXR5IGZsYWdzICovCisJ
dW5zaWduZWQgaW50IHR5cGU7CS8qIGNvZGVjIHR5cGUgKi8KKworCS8qIC0tIHRoZXNlIGlzIGZp
bGxlZCBpbiBsYXRlciBkdXJpbmcgbWFzdGVyIGRldmljZSBhdHRhY2ggLS0gKi8KKworCXN0cnVj
dCB2aWRlb2NvZGVjX21hc3RlciAqbWFzdGVyX2RhdGE7CisKKwkvKiAtLSB0aGVzZSBhcmUgZmls
bGVkIGluIGJ5IHRoZSBzbGF2ZSBkZXZpY2UgZHVyaW5nIHJlZ2lzdGVyIC0tICovCisKKwl2b2lk
ICpkYXRhOwkJLyogcHJpdmF0ZSBzbGF2ZSBkYXRhICovCisKKwkvKiBhdHRhY2gvZGV0YWNoIGNs
aWVudCBmdW5jdGlvbnMgKGluZGlyZWN0IGNhbGwpICovCisJaW50ICgqc2V0dXApIChzdHJ1Y3Qg
dmlkZW9jb2RlYyAqIGNvZGVjKTsKKwlpbnQgKCp1bnNldCkgKHN0cnVjdCB2aWRlb2NvZGVjICog
Y29kZWMpOworCisJLyogbWFpbiBmdW5jdGlvbnMsIGV2ZXJ5IGNsaWVudCBuZWVkcyB0aGVtIGZv
ciBzdXJlISAqLworCS8vIHNldCBjb21wcmVzc2lvbiBvciBkZWNvbXByZXNzaW9uIChvciBmcmVl
emUsIHN0b3AsIHN0YW5kYnksIGV0YykKKwlpbnQgKCpzZXRfbW9kZSkgKHN0cnVjdCB2aWRlb2Nv
ZGVjICogY29kZWMsCisJCQkgaW50IG1vZGUpOworCS8vIHNldHVwIHBpY3R1cmUgc2l6ZSBhbmQg
bm9ybSAoZm9yIHRoZSBjb2RlYydzIHZpZGVvIGZyb250ZW5kKQorCWludCAoKnNldF92aWRlbykg
KHN0cnVjdCB2aWRlb2NvZGVjICogY29kZWMsCisJCQkgIHN0cnVjdCB0dm5vcm0gKiBub3JtLAor
CQkJICBzdHJ1Y3QgdmZlX3NldHRpbmdzICogY2FwLAorCQkJICBzdHJ1Y3QgdmZlX3BvbGFyaXR5
ICogcG9sKTsKKwkvLyBvdGhlciBjb250cm9sIGNvbW1hbmRzLCBhbHNvIG1tYXAgc2V0dXAgZXRj
LgorCWludCAoKmNvbnRyb2wpIChzdHJ1Y3QgdmlkZW9jb2RlYyAqIGNvZGVjLAorCQkJaW50IHR5
cGUsCisJCQlpbnQgc2l6ZSwKKwkJCXZvaWQgKmRhdGEpOworCisJLyogYWRkaXRpb25hbCBzZXR1
cC9xdWVyeS9wcm9jZXNzaW5nIChtYXkgYmUgTlVMTCBwb2ludGVyKSAqLworCS8vIGludGVycnVw
dCBzZXR1cCAvIGhhbmRsaW5nIChmb3IgaXJxJ3MgZGVsaXZlcmVkIGJ5IG1hc3RlcikKKwlpbnQg
KCpzZXR1cF9pbnRlcnJ1cHQpIChzdHJ1Y3QgdmlkZW9jb2RlYyAqIGNvZGVjLAorCQkJCWxvbmcg
bW9kZSk7CisJaW50ICgqaGFuZGxlX2ludGVycnVwdCkgKHN0cnVjdCB2aWRlb2NvZGVjICogY29k
ZWMsCisJCQkJIGludCBzb3VyY2UsCisJCQkJIGxvbmcgZmxhZyk7CisJLy8gcGljdHVyZSBpbnRl
cmZhY2UgKGlmIGFueSkKKwlsb25nICgqcHV0X2ltYWdlKSAoc3RydWN0IHZpZGVvY29kZWMgKiBj
b2RlYywKKwkJCSAgIGludCB0cl90eXBlLAorCQkJICAgaW50IGJsb2NrLAorCQkJICAgbG9uZyAq
ZnJfbnVtLAorCQkJICAgbG9uZyAqZmxhZywKKwkJCSAgIGxvbmcgc2l6ZSwKKwkJCSAgIHZvaWQg
KmJ1Zik7CisJbG9uZyAoKmdldF9pbWFnZSkgKHN0cnVjdCB2aWRlb2NvZGVjICogY29kZWMsCisJ
CQkgICBpbnQgdHJfdHlwZSwKKwkJCSAgIGludCBibG9jaywKKwkJCSAgIGxvbmcgKmZyX251bSwK
KwkJCSAgIGxvbmcgKmZsYWcsCisJCQkgICBsb25nIHNpemUsCisJCQkgICB2b2lkICpidWYpOwor
fTsKKworc3RydWN0IHZpZGVvY29kZWNfbWFzdGVyIHsKKwkvKiAtLSBmaWxsZWQgaW4gYnkgbWFz
dGVyIGRldmljZSBmb3IgcmVnaXN0cmF0aW9uIC0tICovCisJY2hhciBuYW1lWzMyXTsKKwl1bnNp
Z25lZCBsb25nIG1hZ2ljOwkvKiBtYXkgYmUgdXNlZCBmb3IgY2xpZW50PC0+bWFzdGVyIGF0dGFj
aGluZyAqLworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CS8qIGZ1bmN0aW9uYWxpdHkgZmxhZ3MgKi8K
Kwl1bnNpZ25lZCBpbnQgdHlwZTsJLyogbWFzdGVyIHR5cGUgKi8KKworCXZvaWQgKmRhdGE7CQkv
KiBwcml2YXRlIG1hc3RlciBkYXRhICovCisKKwkgX191MzIoKnJlYWRyZWcpIChzdHJ1Y3Qgdmlk
ZW9jb2RlYyAqIGNvZGVjLAorCQkJICBfX3UxNiByZWcpOworCXZvaWQgKCp3cml0ZXJlZykgKHN0
cnVjdCB2aWRlb2NvZGVjICogY29kZWMsCisJCQkgIF9fdTE2IHJlZywKKwkJCSAgX191MzIgdmFs
dWUpOworfTsKKwwKKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PSAqLworLyogZnVuY3Rpb24gcHJvdG90eXBlcyBvZiB0aGUgbWFzdGVyL3NsYXZl
IGludGVyZmFjZSAqLworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PSAqLworCisvKiBhdHRhY2ggYW5kIGRldGFjaCBjb21tYW5kcyBmb3IgdGhlIG1h
c3RlciAqLworLy8gKiBtYXN0ZXIgc3RydWN0dXJlIG5lZWRzIHRvIGJlIGttYWxsb2MnZWQgYmVm
b3JlIGNhbGxpbmcgYXR0YWNoCisvLyAgIGFuZCBmcmVlJ2QgYWZ0ZXIgY2FsbGluZyBkZXRhY2gK
Ky8vICogcmV0dXJucyBwb2ludGVyIG9uIHN1Y2Nlc3MsIE5VTEwgb24gZmFpbHVyZQorZXh0ZXJu
IHN0cnVjdCB2aWRlb2NvZGVjICp2aWRlb2NvZGVjX2F0dGFjaChzdHJ1Y3QgdmlkZW9jb2RlY19t
YXN0ZXIgKik7CisvLyAqIDAgb24gc3VjY2VzcywgPDAgKGVycm5vKSBvbiBmYWlsdXJlCitleHRl
cm4gaW50IHZpZGVvY29kZWNfZGV0YWNoKHN0cnVjdCB2aWRlb2NvZGVjICopOworCisvKiByZWdp
c3RlciBhbmQgdW5yZWdpc3RlciBjb21tYW5kcyBmb3IgdGhlIHNsYXZlcyAqLworLy8gKiAwIG9u
IHN1Y2Nlc3MsIDwwIChlcnJubykgb24gZmFpbHVyZQorZXh0ZXJuIGludCB2aWRlb2NvZGVjX3Jl
Z2lzdGVyKGNvbnN0IHN0cnVjdCB2aWRlb2NvZGVjICopOworLy8gKiAwIG9uIHN1Y2Nlc3MsIDww
IChlcnJubykgb24gZmFpbHVyZQorZXh0ZXJuIGludCB2aWRlb2NvZGVjX3VucmVnaXN0ZXIoY29u
c3Qgc3RydWN0IHZpZGVvY29kZWMgKik7CisKKy8qIHRoZSBvdGhlciBjYWxscyBhcmUgZGlyZWN0
bHkgZG9uZSB2aWEgdGhlIHZpZGVvY29kZWMgc3RydWN0dXJlISAqLworCisjZW5kaWYJCQkJLypp
Zm5kZWYgX19MSU5VWF9WSURFT0NPREVDX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2lu
Zy9tZWRpYS96b3Jhbi96b3Jhbi5oIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFu
LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5lODRmYjYwNGE2ODkK
LS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4vem9yYW4uaApA
QCAtMCwwICsxLDQwMiBAQAorLyoKKyAqIHpvcmFuIC0gSW9tZWdhIEJ1eiBkcml2ZXIKKyAqCisg
KiBDb3B5cmlnaHQgKEMpIDE5OTkgUmFpbmVyIEpvaGFubmkgPFJhaW5lckBKb2hhbm5pLmRlPgor
ICoKKyAqIGJhc2VkIG9uCisgKgorICogem9yYW4uMC4wLjMgQ29weXJpZ2h0IChDKSAxOTk4IERh
dmUgUGVya3MgPGRwZXJrc0BpYm0ubmV0PgorICoKKyAqIGFuZAorICoKKyAqIGJ0dHYgLSBCdDg0
OCBmcmFtZSBncmFiYmVyIGRyaXZlcgorICogQ29weXJpZ2h0IChDKSAxOTk2LDk3LDk4IFJhbHBo
ICBNZXR6bGVyIChyamttQHRocC51bmkta29lbG4uZGUpCisgKiAgICAgICAgICAgICAgICAgICAg
ICAgICYgTWFyY3VzIE1ldHpsZXIgKG1vY21AdGhwLnVuaS1rb2Vsbi5kZSkKKyAqCisgKiBUaGlz
IHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29y
IG1vZGlmeQorICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMg
TGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247
IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24p
IGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBp
biB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdB
UlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5U
QUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAq
IEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKi8KKworI2lm
bmRlZiBfQlVaX0hfCisjZGVmaW5lIF9CVVpfSF8KKworI2luY2x1ZGUgPG1lZGlhL3Y0bDItZGV2
aWNlLmg+CisjaW5jbHVkZSA8bWVkaWEvdjRsMi1jdHJscy5oPgorI2luY2x1ZGUgPG1lZGlhL3Y0
bDItZmguaD4KKworc3RydWN0IHpvcmFuX3N5bmMgeworCXVuc2lnbmVkIGxvbmcgZnJhbWU7CS8q
IG51bWJlciBvZiBidWZmZXIgdGhhdCBoYXMgYmVlbiBmcmVlJ2QgKi8KKwl1bnNpZ25lZCBsb25n
IGxlbmd0aDsJLyogbnVtYmVyIG9mIGNvZGUgYnl0ZXMgaW4gYnVmZmVyIChjYXB0dXJlIG9ubHkp
ICovCisJdW5zaWduZWQgbG9uZyBzZXE7CS8qIGZyYW1lIHNlcXVlbmNlIG51bWJlciAqLworCXU2
NCB0czsJCQkvKiB0aW1lc3RhbXAgKi8KK307CisKKworI2RlZmluZSBaT1JBTl9OQU1FICAgICJa
T1JBTiIJLyogbmFtZSBvZiB0aGUgZGV2aWNlICovCisKKyNkZWZpbmUgWlJfREVWTkFNRSh6cikg
KCh6ciktPm5hbWUpCisKKyNkZWZpbmUgICBCVVpfTUFYX1dJRFRIICAgKHpyLT50aW1pbmctPldh
KQorI2RlZmluZSAgIEJVWl9NQVhfSEVJR0hUICAoenItPnRpbWluZy0+SGEpCisjZGVmaW5lICAg
QlVaX01JTl9XSURUSCAgICAzMgkvKiBuZXZlciBkaXNwbGF5IGxlc3MgdGhhbiAzMiBwaXhlbHMg
Ki8KKyNkZWZpbmUgICBCVVpfTUlOX0hFSUdIVCAgIDI0CS8qIG5ldmVyIGRpc3BsYXkgbGVzcyB0
aGFuIDI0IHJvd3MgKi8KKworI2RlZmluZSBCVVpfTlVNX1NUQVRfQ09NICAgIDQKKyNkZWZpbmUg
QlVaX01BU0tfU1RBVF9DT00gICAzCisKKyNkZWZpbmUgQlVaX01BWF9GUkFNRSAgICAgMjU2CS8q
IE11c3QgYmUgYSBwb3dlciBvZiAyICovCisjZGVmaW5lIEJVWl9NQVNLX0ZSQU1FICAgIDI1NQkv
KiBNdXN0IGJlIEJVWl9NQVhfRlJBTUUtMSAqLworCisjZGVmaW5lIEJVWl9NQVhfSU5QVVQgICAg
ICAgMTYKKworI2lmIFZJREVPX01BWF9GUkFNRSA8PSAzMgorIyAgIGRlZmluZSAgIFY0TF9NQVhf
RlJBTUUgICAzMgorI2VsaWYgVklERU9fTUFYX0ZSQU1FIDw9IDY0CisjICAgZGVmaW5lICAgVjRM
X01BWF9GUkFNRSAgIDY0CisjZWxzZQorIyAgIGVycm9yICAgIlRvbyBtYW55IHZpZGVvIGZyYW1l
IGJ1ZmZlcnMgdG8gaGFuZGxlIgorI2VuZGlmCisjZGVmaW5lICAgVjRMX01BU0tfRlJBTUUgICAo
VjRMX01BWF9GUkFNRSAtIDEpCisKKyNkZWZpbmUgTUFYX0ZSQU1FIChCVVpfTUFYX0ZSQU1FID4g
VklERU9fTUFYX0ZSQU1FID8gQlVaX01BWF9GUkFNRSA6IFZJREVPX01BWF9GUkFNRSkKKworI2lu
Y2x1ZGUgInpyMzYwNTcuaCIKKworZW51bSBjYXJkX3R5cGUgeworCVVOS05PV04gPSAtMSwKKwor
CS8qIFBpbm5hY2xlL01pcm8gKi8KKwlEQzEwX29sZCwJCS8qIERDMzAgbGlrZSAqLworCURDMTBf
bmV3LAkJLyogREMxMHBsdXMgbGlrZSAqLworCURDMTBwbHVzLAorCURDMzAsCisJREMzMHBsdXMs
CisKKwkvKiBMaW51eCBNZWRpYSBMYWJzICovCisJTE1MMzMsCisJTE1MMzNSMTAsCisKKwkvKiBJ
b21lZ2EgKi8KKwlCVVosCisKKwkvKiBBdmVyTWVkaWEgKi8KKwlBVlM2RVlFUywKKworCS8qIHRv
dGFsIG51bWJlciBvZiBjYXJkcyAqLworCU5VTV9DQVJEUworfTsKKworZW51bSB6b3Jhbl9jb2Rl
Y19tb2RlIHsKKwlCVVpfTU9ERV9JRExFLAkJLyogbm90aGluZyBnb2luZyBvbiAqLworCUJVWl9N
T0RFX01PVElPTl9DT01QUkVTUywJLyogZ3JhYmJpbmcgZnJhbWVzICovCisJQlVaX01PREVfTU9U
SU9OX0RFQ09NUFJFU1MsCS8qIHBsYXlpbmcgZnJhbWVzICovCisJQlVaX01PREVfU1RJTExfQ09N
UFJFU1MsCS8qIHN0aWxsIGZyYW1lIGNvbnZlcnNpb24gKi8KKwlCVVpfTU9ERV9TVElMTF9ERUNP
TVBSRVNTCS8qIHN0aWxsIGZyYW1lIGNvbnZlcnNpb24gKi8KK307CisKK2VudW0gem9yYW5fYnVm
ZmVyX3N0YXRlIHsKKwlCVVpfU1RBVEVfVVNFUiwJCS8qIGJ1ZmZlciBpcyBvd25lZCBieSBhcHBs
aWNhdGlvbiAqLworCUJVWl9TVEFURV9QRU5ELAkJLyogYnVmZmVyIGlzIHF1ZXVlZCBpbiBwZW5k
W10gcmVhZHkgdG8gZmVlZCB0byBJL08gKi8KKwlCVVpfU1RBVEVfRE1BLAkJLyogYnVmZmVyIGlz
IHF1ZXVlZCBpbiBkbWFbXSBmb3IgSS9PICovCisJQlVaX1NUQVRFX0RPTkUJCS8qIGJ1ZmZlciBp
cyByZWFkeSB0byByZXR1cm4gdG8gYXBwbGljYXRpb24gKi8KK307CisKK2VudW0gem9yYW5fbWFw
X21vZGUgeworCVpPUkFOX01BUF9NT0RFX1JBVywKKwlaT1JBTl9NQVBfTU9ERV9KUEdfUkVDLAor
I2RlZmluZSBaT1JBTl9NQVBfTU9ERV9KUEcgWk9SQU5fTUFQX01PREVfSlBHX1JFQworCVpPUkFO
X01BUF9NT0RFX0pQR19QTEFZLAorfTsKKworZW51bSBncGlvX3R5cGUgeworCVpSX0dQSU9fSlBF
R19TTEVFUCA9IDAsCisJWlJfR1BJT19KUEVHX1JFU0VULAorCVpSX0dQSU9fSlBFR19GUkFNRSwK
KwlaUl9HUElPX1ZJRF9ESVIsCisJWlJfR1BJT19WSURfRU4sCisJWlJfR1BJT19WSURfUkVTRVQs
CisJWlJfR1BJT19DTEtfU0VMMSwKKwlaUl9HUElPX0NMS19TRUwyLAorCVpSX0dQSU9fTUFYLAor
fTsKKworZW51bSBncGNzX3R5cGUgeworCUdQQ1NfSlBFR19SRVNFVCA9IDAsCisJR1BDU19KUEVH
X1NUQVJULAorCUdQQ1NfTUFYLAorfTsKKworc3RydWN0IHpvcmFuX2Zvcm1hdCB7CisJY2hhciAq
bmFtZTsKKwlfX3UzMiBmb3VyY2M7CisJaW50IGNvbG9yc3BhY2U7CisJaW50IGRlcHRoOworCV9f
dTMyIGZsYWdzOworCV9fdTMyIHZmZXNwZnI7Cit9OworLyogZmxhZ3MgKi8KKyNkZWZpbmUgWk9S
QU5fRk9STUFUX0NPTVBSRVNTRUQgMTw8MAorI2RlZmluZSBaT1JBTl9GT1JNQVRfT1ZFUkxBWSAg
ICAxPDwxCisjZGVmaW5lIFpPUkFOX0ZPUk1BVF9DQVBUVVJFCTE8PDIKKyNkZWZpbmUgWk9SQU5f
Rk9STUFUX1BMQVlCQUNLCTE8PDMKKworLyogb3ZlcmxheS1zZXR0aW5ncyAqLworc3RydWN0IHpv
cmFuX292ZXJsYXlfc2V0dGluZ3MgeworCWludCBpc19zZXQ7CisJaW50IHgsIHksIHdpZHRoLCBo
ZWlnaHQ7CS8qIHBvc2l0aW9uICovCisJaW50IGNsaXBjb3VudDsJCS8qIHBvc2l0aW9uIGFuZCBu
dW1iZXIgb2YgY2xpcHMgKi8KKwljb25zdCBzdHJ1Y3Qgem9yYW5fZm9ybWF0ICpmb3JtYXQ7CS8q
IG92ZXJsYXkgZm9ybWF0ICovCit9OworCisvKiB2NGwtY2FwdHVyZSBzZXR0aW5ncyAqLworc3Ry
dWN0IHpvcmFuX3Y0bF9zZXR0aW5ncyB7CisJaW50IHdpZHRoLCBoZWlnaHQsIGJ5dGVzcGVybGlu
ZTsJLyogY2FwdHVyZSBzaXplICovCisJY29uc3Qgc3RydWN0IHpvcmFuX2Zvcm1hdCAqZm9ybWF0
OwkvKiBjYXB0dXJlIGZvcm1hdCAqLworfTsKKworLyoganBnLWNhcHR1cmUvLXBsYXliYWNrIHNl
dHRpbmdzICovCitzdHJ1Y3Qgem9yYW5fanBnX3NldHRpbmdzIHsKKwlpbnQgZGVjaW1hdGlvbjsJ
CS8qIHRoaXMgYml0IGlzIHVzZWQgdG8gc2V0IGV2ZXJ5dGhpbmcgdG8gZGVmYXVsdCAqLworCWlu
dCBIb3JEY20sIFZlckRjbSwgVG1wRGNtOwkvKiBjYXB0dXJlIGRlY2ltYXRpb24gc2V0dGluZ3Mg
KFRtcERjbT0xIG1lYW5zIGJvdGggZmllbGRzKSAqLworCWludCBmaWVsZF9wZXJfYnVmZiwgb2Rk
X2V2ZW47CS8qIGZpZWxkLXNldHRpbmdzIChvZGRfZXZlbj0xICgrVG1wRGNtPTEpIG1lYW5zIHRv
cC1maWVsZC1maXJzdCkgKi8KKwlpbnQgaW1nX3gsIGltZ195LCBpbWdfd2lkdGgsIGltZ19oZWln
aHQ7CS8qIGNyb3Agc2V0dGluZ3MgKHN1YmZyYW1lIGNhcHR1cmUpICovCisJc3RydWN0IHY0bDJf
anBlZ2NvbXByZXNzaW9uIGpwZ19jb21wOwkvKiBKUEVHLXNwZWNpZmljIGNhcHR1cmUgc2V0dGlu
Z3MgKi8KK307CisKK3N0cnVjdCB6b3Jhbl9maDsKKworc3RydWN0IHpvcmFuX21hcHBpbmcgewor
CXN0cnVjdCB6b3Jhbl9maCAqZmg7CisJYXRvbWljX3QgY291bnQ7Cit9OworCitzdHJ1Y3Qgem9y
YW5fYnVmZmVyIHsKKwlzdHJ1Y3Qgem9yYW5fbWFwcGluZyAqbWFwOworCWVudW0gem9yYW5fYnVm
ZmVyX3N0YXRlIHN0YXRlOwkvKiBzdGF0ZTogdW51c2VkL3BlbmRpbmcvZG1hL2RvbmUgKi8KKwlz
dHJ1Y3Qgem9yYW5fc3luYyBiczsJCS8qIERPTkU6IGluZm8gdG8gcmV0dXJuIHRvIGFwcGxpY2F0
aW9uICovCisJdW5pb24geworCQlzdHJ1Y3QgeworCQkJX19sZTMyICpmcmFnX3RhYjsJLyogYWRk
cmVzc2VzIG9mIGZyYWcgdGFibGUgKi8KKwkJCXUzMiBmcmFnX3RhYl9idXM7CS8qIHNhbWUgdmFs
dWUgY2FjaGVkIHRvIHNhdmUgdGltZSBpbiBJU1IgKi8KKwkJfSBqcGc7CisJCXN0cnVjdCB7CisJ
CQljaGFyICpmYnVmZmVyOwkJLyogdmlydHVhbCBhZGRyZXNzIG9mIGZyYW1lIGJ1ZmZlciAqLwor
CQkJdW5zaWduZWQgbG9uZyBmYnVmZmVyX3BoeXM7LyogcGh5c2ljYWwgYWRkcmVzcyBvZiBmcmFt
ZSBidWZmZXIgKi8KKwkJCXVuc2lnbmVkIGxvbmcgZmJ1ZmZlcl9idXM7LyogYnVzIGFkZHJlc3Mg
b2YgZnJhbWUgYnVmZmVyICovCisJCX0gdjRsOworCX07Cit9OworCitlbnVtIHpvcmFuX2xvY2tf
YWN0aXZpdHkgeworCVpPUkFOX0ZSRUUsCQkvKiBmcmVlIGZvciB1c2UgKi8KKwlaT1JBTl9BQ1RJ
VkUsCQkvKiBhY3RpdmUgYnV0IHVubG9ja2VkICovCisJWk9SQU5fTE9DS0VELAkJLyogbG9ja2Vk
ICovCit9OworCisvKiBidWZmZXIgY29sbGVjdGlvbnMgKi8KK3N0cnVjdCB6b3Jhbl9idWZmZXJf
Y29sIHsKKwllbnVtIHpvcmFuX2xvY2tfYWN0aXZpdHkgYWN0aXZlOwkvKiBmZWF0dXJlIGN1cnJl
bnRseSBpbiB1c2U/ICovCisJdW5zaWduZWQgaW50IG51bV9idWZmZXJzLCBidWZmZXJfc2l6ZTsK
KwlzdHJ1Y3Qgem9yYW5fYnVmZmVyIGJ1ZmZlcltNQVhfRlJBTUVdOwkvKiBidWZmZXJzICovCisJ
dTggYWxsb2NhdGVkOwkJLyogRmxhZyBpZiBidWZmZXJzIGFyZSBhbGxvY2F0ZWQgICovCisJdTgg
bmVlZF9jb250aWd1b3VzOwkvKiBGbGFnIGlmIGNvbnRpZ3VvdXMgYnVmZmVycyBhcmUgbmVlZGVk
ICovCisJLyogb25seSBhcHBsaWVzIHRvIGpwZyBidWZmZXJzLCByYXcgYnVmZmVycyBhcmUgYWx3
YXlzIGNvbnRpZ3VvdXMgKi8KK307CisKK3N0cnVjdCB6b3JhbjsKKworLyogem9yYW5fZmggY29u
dGFpbnMgcGVyLW9wZW4oKSBzZXR0aW5ncyAqLworc3RydWN0IHpvcmFuX2ZoIHsKKwlzdHJ1Y3Qg
djRsMl9maCBmaDsKKwlzdHJ1Y3Qgem9yYW4gKnpyOworCisJZW51bSB6b3Jhbl9tYXBfbW9kZSBt
YXBfbW9kZTsJCS8qIEZsYWcgd2hpY2ggYnVmZmVyc2V0IHdpbGwgbWFwIGJ5IG5leHQgbW1hcCgp
ICovCisKKwlzdHJ1Y3Qgem9yYW5fb3ZlcmxheV9zZXR0aW5ncyBvdmVybGF5X3NldHRpbmdzOwor
CXUzMiAqb3ZlcmxheV9tYXNrOwkJCS8qIG92ZXJsYXkgbWFzayAqLworCWVudW0gem9yYW5fbG9j
a19hY3Rpdml0eSBvdmVybGF5X2FjdGl2ZTsvKiBmZWF0dXJlIGN1cnJlbnRseSBpbiB1c2U/ICov
CisKKwlzdHJ1Y3Qgem9yYW5fYnVmZmVyX2NvbCBidWZmZXJzOwkvKiBidWZmZXJzJyBpbmZvICov
CisKKwlzdHJ1Y3Qgem9yYW5fdjRsX3NldHRpbmdzIHY0bF9zZXR0aW5nczsJLyogc3RydWN0dXJl
IHdpdGggYSBsb3Qgb2YgdGhpbmdzIHRvIHBsYXkgd2l0aCAqLworCXN0cnVjdCB6b3Jhbl9qcGdf
c2V0dGluZ3MganBnX3NldHRpbmdzOwkvKiBzdHJ1Y3R1cmUgd2l0aCBhIGxvdCBvZiB0aGluZ3Mg
dG8gcGxheSB3aXRoICovCit9OworCitzdHJ1Y3QgY2FyZF9pbmZvIHsKKwllbnVtIGNhcmRfdHlw
ZSB0eXBlOworCWNoYXIgbmFtZVszMl07CisJY29uc3QgY2hhciAqaTJjX2RlY29kZXI7CS8qIGky
YyBkZWNvZGVyIGRldmljZSAqLworCWNvbnN0IHVuc2lnbmVkIHNob3J0ICphZGRyc19kZWNvZGVy
OworCWNvbnN0IGNoYXIgKmkyY19lbmNvZGVyOwkvKiBpMmMgZW5jb2RlciBkZXZpY2UgKi8KKwlj
b25zdCB1bnNpZ25lZCBzaG9ydCAqYWRkcnNfZW5jb2RlcjsKKwl1MTYgdmlkZW9fdmZlLCB2aWRl
b19jb2RlYzsJCQkvKiB2aWRlb2NvZGVjIHR5cGVzICovCisJdTE2IGF1ZGlvX2NoaXA7CQkJCQkv
KiBhdWRpbyB0eXBlICovCisKKwlpbnQgaW5wdXRzOwkJLyogbnVtYmVyIG9mIHZpZGVvIGlucHV0
cyAqLworCXN0cnVjdCBpbnB1dCB7CisJCWludCBtdXhzZWw7CisJCWNoYXIgbmFtZVszMl07CisJ
fSBpbnB1dFtCVVpfTUFYX0lOUFVUXTsKKworCXY0bDJfc3RkX2lkIG5vcm1zOworCXN0cnVjdCB0
dm5vcm0gKnR2blszXTsJLyogc3VwcG9ydGVkIFRWIG5vcm1zICovCisKKwl1MzIganBlZ19pbnQ7
CQkvKiBKUEVHIGludGVycnVwdCAqLworCXUzMiB2c3luY19pbnQ7CQkvKiBWU1lOQyBpbnRlcnJ1
cHQgKi8KKwlzOCBncGlvW1pSX0dQSU9fTUFYXTsKKwl1OCBncGNzW0dQQ1NfTUFYXTsKKworCXN0
cnVjdCB2ZmVfcG9sYXJpdHkgdmZlX3BvbDsKKwl1OCBncGlvX3BvbFtaUl9HUElPX01BWF07CisK
KwkvKiBpcyB0aGUgL0dXUyBsaW5lIGNvbm5lY3RlZD8gKi8KKwl1OCBnd3Nfbm90X2Nvbm5lY3Rl
ZDsKKworCS8qIGF2czZleWVzIG11eCBzZXR0aW5nICovCisJdTggaW5wdXRfbXV4OworCisJdm9p
ZCAoKmluaXQpIChzdHJ1Y3Qgem9yYW4gKiB6cik7Cit9OworCitzdHJ1Y3Qgem9yYW4geworCXN0
cnVjdCB2NGwyX2RldmljZSB2NGwyX2RldjsKKwlzdHJ1Y3QgdjRsMl9jdHJsX2hhbmRsZXIgaGRs
OworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZpZGVvX2RldjsKKworCXN0cnVjdCBpMmNfYWRhcHRl
ciBpMmNfYWRhcHRlcjsJLyogKi8KKwlzdHJ1Y3QgaTJjX2FsZ29fYml0X2RhdGEgaTJjX2FsZ287
CS8qICovCisJdTMyIGkyY2JyOworCisJc3RydWN0IHY0bDJfc3ViZGV2ICpkZWNvZGVyOwkvKiB2
aWRlbyBkZWNvZGVyIHN1Yi1kZXZpY2UgKi8KKwlzdHJ1Y3QgdjRsMl9zdWJkZXYgKmVuY29kZXI7
CS8qIHZpZGVvIGVuY29kZXIgc3ViLWRldmljZSAqLworCisJc3RydWN0IHZpZGVvY29kZWMgKmNv
ZGVjOwkvKiB2aWRlbyBjb2RlYyAqLworCXN0cnVjdCB2aWRlb2NvZGVjICp2ZmU7CS8qIHZpZGVv
IGZyb250IGVuZCAqLworCisJc3RydWN0IG11dGV4IGxvY2s7CS8qIGZpbGUgb3BzIHNlcmlhbGl6
ZSBsb2NrICovCisKKwl1OCBpbml0aWFsaXplZDsJCS8qIGZsYWcgaWYgem9yYW4gaGFzIGJlZW4g
Y29ycmVjdGx5IGluaXRpYWxpemVkICovCisJaW50IHVzZXI7CQkvKiBudW1iZXIgb2YgY3VycmVu
dCB1c2VycyAqLworCXN0cnVjdCBjYXJkX2luZm8gY2FyZDsKKwlzdHJ1Y3QgdHZub3JtICp0aW1p
bmc7CisKKwl1bnNpZ25lZCBzaG9ydCBpZDsJLyogbnVtYmVyIG9mIHRoaXMgZGV2aWNlICovCisJ
Y2hhciBuYW1lWzMyXTsJCS8qIG5hbWUgb2YgdGhpcyBkZXZpY2UgKi8KKwlzdHJ1Y3QgcGNpX2Rl
diAqcGNpX2RldjsJLyogUENJIGRldmljZSAqLworCXVuc2lnbmVkIGNoYXIgcmV2aXNpb247CS8q
IHJldmlzaW9uIG9mIHpyMzYwNTcgKi8KKwl1bnNpZ25lZCBjaGFyIF9faW9tZW0gKnpyMzYwNTdf
bWVtOy8qIHBvaW50ZXIgdG8gbWFwcGVkIElPIG1lbW9yeSAqLworCisJc3BpbmxvY2tfdCBzcGlu
bG9jazsJLyogU3BpbmxvY2sgKi8KKworCS8qIFZpZGVvIGZvciBMaW51eCBwYXJhbWV0ZXJzICov
CisJaW50IGlucHV0OwkvKiBjYXJkJ3Mgbm9ybSBhbmQgaW5wdXQgKi8KKwl2NGwyX3N0ZF9pZCBu
b3JtOworCisJLyogQ3VycmVudCBidWZmZXIgcGFyYW1zICovCisJdm9pZCAgICAqdmJ1Zl9iYXNl
OworCWludCAgICAgdmJ1Zl9oZWlnaHQsIHZidWZfd2lkdGg7CisJaW50ICAgICB2YnVmX2RlcHRo
OworCWludCAgICAgdmJ1Zl9ieXRlc3BlcmxpbmU7CisKKwlzdHJ1Y3Qgem9yYW5fb3ZlcmxheV9z
ZXR0aW5ncyBvdmVybGF5X3NldHRpbmdzOworCXUzMiAqb3ZlcmxheV9tYXNrOwkvKiBvdmVybGF5
IG1hc2sgKi8KKwllbnVtIHpvcmFuX2xvY2tfYWN0aXZpdHkgb3ZlcmxheV9hY3RpdmU7CS8qIGZl
YXR1cmUgY3VycmVudGx5IGluIHVzZT8gKi8KKworCXdhaXRfcXVldWVfaGVhZF90IHY0bF9jYXBx
OworCisJaW50IHY0bF9vdmVybGF5X2FjdGl2ZTsJLyogT3ZlcmxheSBncmFiIGlzIGFjdGl2YXRl
ZCAqLworCWludCB2NGxfbWVtZ3JhYl9hY3RpdmU7CS8qIE1lbW9yeSBncmFiIGlzIGFjdGl2YXRl
ZCAqLworCisJaW50IHY0bF9ncmFiX2ZyYW1lOwkvKiBGcmFtZSBudW1iZXIgYmVpbmcgY3VycmVu
dGx5IGdyYWJiZWQgKi8KKyNkZWZpbmUgTk9fR1JBQl9BQ1RJVkUgKC0xKQorCXVuc2lnbmVkIGxv
bmcgdjRsX2dyYWJfc2VxOwkvKiBOdW1iZXIgb2YgZnJhbWVzIGdyYWJiZWQgKi8KKwlzdHJ1Y3Qg
em9yYW5fdjRsX3NldHRpbmdzIHY0bF9zZXR0aW5nczsJLyogc3RydWN0dXJlIHdpdGggYSBsb3Qg
b2YgdGhpbmdzIHRvIHBsYXkgd2l0aCAqLworCisJLyogVjRMIGdyYWIgcXVldWUgb2YgZnJhbWVz
IHBlbmRpbmcgKi8KKwl1bnNpZ25lZCBsb25nIHY0bF9wZW5kX2hlYWQ7CisJdW5zaWduZWQgbG9u
ZyB2NGxfcGVuZF90YWlsOworCXVuc2lnbmVkIGxvbmcgdjRsX3N5bmNfdGFpbDsKKwlpbnQgdjRs
X3BlbmRbVjRMX01BWF9GUkFNRV07CisJc3RydWN0IHpvcmFuX2J1ZmZlcl9jb2wgdjRsX2J1ZmZl
cnM7CS8qIFY0TCBidWZmZXJzJyBpbmZvICovCisKKwkvKiBCdXogTUpQRUcgcGFyYW1ldGVycyAq
LworCWVudW0gem9yYW5fY29kZWNfbW9kZSBjb2RlY19tb2RlOwkvKiBzdGF0dXMgb2YgY29kZWMg
Ki8KKwlzdHJ1Y3Qgem9yYW5fanBnX3NldHRpbmdzIGpwZ19zZXR0aW5nczsJLyogc3RydWN0dXJl
IHdpdGggYSBsb3Qgb2YgdGhpbmdzIHRvIHBsYXkgd2l0aCAqLworCisJd2FpdF9xdWV1ZV9oZWFk
X3QganBnX2NhcHE7CS8qIHdhaXQgaGVyZSBmb3IgZ3JhYiB0byBmaW5pc2ggKi8KKworCS8qIGdy
YWIgcXVldWUgY291bnRzL2luZGljZXMsIG1hc2sgd2l0aCBCVVpfTUFTS19TVEFUX0NPTSBiZWZv
cmUgdXNpbmcgYXMgaW5kZXggKi8KKwkvKiAoZG1hX2hlYWQgLSBkbWFfdGFpbCkgaXMgbnVtYmVy
IGFjdGl2ZSBpbiBETUEsIG11c3QgYmUgPD0gQlVaX05VTV9TVEFUX0NPTSAqLworCS8qICh2YWx1
ZSAmIEJVWl9NQVNLX1NUQVRfQ09NKSBjb3JyZXNwb25kcyB0byBpbmRleCBpbiBzdGF0X2NvbSB0
YWJsZSAqLworCXVuc2lnbmVkIGxvbmcganBnX3F1ZV9oZWFkOwkvKiBJbmRleCB3aGVyZSB0byBw
dXQgbmV4dCBidWZmZXIgd2hpY2ggaXMgcXVldWVkICovCisJdW5zaWduZWQgbG9uZyBqcGdfZG1h
X2hlYWQ7CS8qIEluZGV4IG9mIG5leHQgYnVmZmVyIHdoaWNoIGdvZXMgaW50byBzdGF0X2NvbSAg
Ki8KKwl1bnNpZ25lZCBsb25nIGpwZ19kbWFfdGFpbDsJLyogSW5kZXggb2YgbGFzdCBidWZmZXIg
aW4gc3RhdF9jb20gICAgICAgICAgICAgICAqLworCXVuc2lnbmVkIGxvbmcganBnX3F1ZV90YWls
OwkvKiBJbmRleCBvZiBsYXN0IGJ1ZmZlciBpbiBxdWV1ZSAgICAgICAgICAgICAgICAgICovCisJ
dW5zaWduZWQgbG9uZyBqcGdfc2VxX251bTsJLyogY291bnQgb2YgZnJhbWVzIHNpbmNlIGdyYWIv
cGxheSBzdGFydGVkICAgICAgICAqLworCXVuc2lnbmVkIGxvbmcganBnX2Vycl9zZXE7CS8qIGxh
c3Qgc2VxX251bSBiZWZvcmUgZXJyb3IgICAgICAgICAgICAgICAgICAgICAgKi8KKwl1bnNpZ25l
ZCBsb25nIGpwZ19lcnJfc2hpZnQ7CisJdW5zaWduZWQgbG9uZyBqcGdfcXVldWVkX251bTsJLyog
Y291bnQgb2YgZnJhbWVzIHF1ZXVlZCBzaW5jZSBncmFiL3BsYXkgc3RhcnRlZCAqLworCisJLyog
enIzNjA1NydzIGNvZGUgYnVmZmVyIHRhYmxlICovCisJX19sZTMyICpzdGF0X2NvbTsJCS8qIHN0
YXRfY29tW2ldIGlzIGluZGV4ZWQgYnkgZG1hX2hlYWQvdGFpbCAmIEJVWl9NQVNLX1NUQVRfQ09N
ICovCisKKwkvKiAodmFsdWUgJiBCVVpfTUFTS19GUkFNRSkgY29ycmVzcG9uZHMgdG8gaW5kZXgg
aW4gcGVuZFtdIHF1ZXVlICovCisJaW50IGpwZ19wZW5kW0JVWl9NQVhfRlJBTUVdOworCisJLyog
YXJyYXkgaW5kZXhlZCBieSBmcmFtZSBudW1iZXIgKi8KKwlzdHJ1Y3Qgem9yYW5fYnVmZmVyX2Nv
bCBqcGdfYnVmZmVyczsJLyogTUpQRUcgYnVmZmVycycgaW5mbyAqLworCisJLyogQWRkaXRpb25h
bCBzdHVmZiBmb3IgdGVzdGluZyAqLworI2lmZGVmIENPTkZJR19QUk9DX0ZTCisJc3RydWN0IHBy
b2NfZGlyX2VudHJ5ICp6b3Jhbl9wcm9jOworI2Vsc2UKKwl2b2lkICp6b3Jhbl9wcm9jOworI2Vu
ZGlmCisJaW50IHRlc3Rpbmc7CisJaW50IGpwZWdfZXJyb3I7CisJaW50IGludHJfY291bnRlcl9H
SVJRMTsKKwlpbnQgaW50cl9jb3VudGVyX0dJUlEwOworCWludCBpbnRyX2NvdW50ZXJfQ29kUmVw
SVJROworCWludCBpbnRyX2NvdW50ZXJfSlBFR1JlcElSUTsKKwlpbnQgZmllbGRfY291bnRlcjsK
KwlpbnQgSVJRMV9pbjsKKwlpbnQgSVJRMV9vdXQ7CisJaW50IEpQRUdfaW47CisJaW50IEpQRUdf
b3V0OworCWludCBKUEVHXzA7CisJaW50IEpQRUdfMTsKKwlpbnQgRU5EX2V2ZW50X21pc3NlZDsK
KwlpbnQgSlBFR19taXNzZWQ7CisJaW50IEpQRUdfZXJyb3I7CisJaW50IG51bV9lcnJvcnM7CisJ
aW50IEpQRUdfbWF4X21pc3NlZDsKKwlpbnQgSlBFR19taW5fbWlzc2VkOworCisJdTMyIGxhc3Rf
aXNyOworCXVuc2lnbmVkIGxvbmcgZnJhbWVfbnVtOworCisJd2FpdF9xdWV1ZV9oZWFkX3QgdGVz
dF9xOworfTsKKworc3RhdGljIGlubGluZSBzdHJ1Y3Qgem9yYW4gKnRvX3pvcmFuKHN0cnVjdCB2
NGwyX2RldmljZSAqdjRsMl9kZXYpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZih2NGwyX2Rldiwg
c3RydWN0IHpvcmFuLCB2NGwyX2Rldik7Cit9CisKKy8qIFRoZXJlIHdhcyBzb21ldGhpbmcgY2Fs
bGVkIF9BTFBIQV9CVVogdGhhdCB1c2VkIHRoZSBQQ0kgYWRkcmVzcyBpbnN0ZWFkIG9mCisgKiB0
aGUga2VybmVsIGlvbWFwcGVkIGFkZHJlc3MgZm9yIGJ0cmVhZC9idHdyaXRlLiAgKi8KKyNkZWZp
bmUgYnR3cml0ZShkYXQsYWRyKSAgICB3cml0ZWwoKGRhdCksIHpyLT56cjM2MDU3X21lbSsoYWRy
KSkKKyNkZWZpbmUgYnRyZWFkKGFkcikgICAgICAgICByZWFkbCh6ci0+enIzNjA1N19tZW0rKGFk
cikpCisKKyNkZWZpbmUgYnRhbmQoZGF0LGFkcikgICAgICBidHdyaXRlKChkYXQpICYgYnRyZWFk
KGFkciksIGFkcikKKyNkZWZpbmUgYnRvcihkYXQsYWRyKSAgICAgICBidHdyaXRlKChkYXQpIHwg
YnRyZWFkKGFkciksIGFkcikKKyNkZWZpbmUgYnRhb3IoZGF0LG1hc2ssYWRyKSBidHdyaXRlKChk
YXQpIHwgKChtYXNrKSAmIGJ0cmVhZChhZHIpKSwgYWRyKQorCisjZW5kaWYKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96b3Jhbl9jYXJkLmMgYi9kcml2ZXJzL3N0YWdp
bmcvbWVkaWEvem9yYW4vem9yYW5fY2FyZC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAw
MDAwMDAwMDAwMC4uZWExMDUyMzE5NGU4Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9zdGFn
aW5nL21lZGlhL3pvcmFuL3pvcmFuX2NhcmQuYwpAQCAtMCwwICsxLDE1MjQgQEAKKy8qCisgKiBa
b3JhbiB6cjM2MDU3L3pyMzYwNjcgUENJIGNvbnRyb2xsZXIgZHJpdmVyLCBmb3IgdGhlCisgKiBQ
aW5uYWNsZS9NaXJvIERDMTAvREMxMCsvREMzMC9EQzMwKywgSW9tZWdhIEJ1eiwgTGludXgKKyAq
IE1lZGlhIExhYnMgTE1MMzMvTE1MMzNSMTAuCisgKgorICogVGhpcyBwYXJ0IGhhbmRsZXMgY2Fy
ZC1zcGVjaWZpYyBkYXRhIGFuZCBkZXRlY3Rpb24KKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMDAg
U2VyZ3VlaSBNaXJpZG9ub3YgPG1pcnNldkBjaWNlc2UubXg+CisgKgorICogQ3VycmVudGx5IG1h
aW50YWluZWQgYnk6CisgKiAgIFJvbmFsZCBCdWx0amUgICAgPHJidWx0amVAcm9uYWxkLmJpdGZy
ZWFrLm5ldD4KKyAqICAgTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBza3luZXQu
YmU+CisgKiAgIE1haWxpbmdsaXN0ICAgICAgPG1qcGVnLXVzZXJzQGxpc3RzLnNmLm5ldD4KKyAq
CisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUg
aXQgYW5kL29yIG1vZGlmeQorICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJh
bCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZv
dW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAoYXQgeW91
ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0
cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhP
VVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAq
IE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNl
ZSB0aGUKKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisg
Ki8KKworI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5o
PgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgor
I2luY2x1ZGUgPGxpbnV4L2luaXQuaD4KKyNpbmNsdWRlIDxsaW51eC92bWFsbG9jLmg+CisjaW5j
bHVkZSA8bGludXgvc2xhYi5oPgorCisjaW5jbHVkZSA8bGludXgvcHJvY19mcy5oPgorI2luY2x1
ZGUgPGxpbnV4L2kyYy5oPgorI2luY2x1ZGUgPGxpbnV4L2kyYy1hbGdvLWJpdC5oPgorI2luY2x1
ZGUgPGxpbnV4L3ZpZGVvZGV2Mi5oPgorI2luY2x1ZGUgPGxpbnV4L3NwaW5sb2NrLmg+CisjaW5j
bHVkZSA8bGludXgvc2VtLmg+CisjaW5jbHVkZSA8bGludXgva21vZC5oPgorI2luY2x1ZGUgPGxp
bnV4L3dhaXQuaD4KKworI2luY2x1ZGUgPGxpbnV4L3BjaS5oPgorI2luY2x1ZGUgPGxpbnV4L2lu
dGVycnVwdC5oPgorI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvaW8u
aD4KKyNpbmNsdWRlIDxtZWRpYS92NGwyLWNvbW1vbi5oPgorI2luY2x1ZGUgPG1lZGlhL2kyYy9i
dDgxOS5oPgorCisjaW5jbHVkZSAidmlkZW9jb2RlYy5oIgorI2luY2x1ZGUgInpvcmFuLmgiCisj
aW5jbHVkZSAiem9yYW5fY2FyZC5oIgorI2luY2x1ZGUgInpvcmFuX2RldmljZS5oIgorI2luY2x1
ZGUgInpvcmFuX3Byb2Nmcy5oIgorCitleHRlcm4gY29uc3Qgc3RydWN0IHpvcmFuX2Zvcm1hdCB6
b3Jhbl9mb3JtYXRzW107CisKK3N0YXRpYyBpbnQgY2FyZFtCVVpfTUFYXSA9IHsgWzAgLi4uIChC
VVpfTUFYLTEpXSA9IC0xIH07Cittb2R1bGVfcGFyYW1fYXJyYXkoY2FyZCwgaW50LCBOVUxMLCAw
NDQ0KTsKK01PRFVMRV9QQVJNX0RFU0MoY2FyZCwgIkNhcmQgdHlwZSIpOworCisvKgorICAgVGhl
IHZpZGVvIG1lbSBhZGRyZXNzIG9mIHRoZSB2aWRlbyBjYXJkLgorICAgVGhlIGRyaXZlciBoYXMg
YSBsaXR0bGUgZGF0YWJhc2UgZm9yIHNvbWUgdmlkZW9jYXJkcworICAgdG8gZGV0ZXJtaW5lIGl0
IGZyb20gdGhlcmUuIElmIHlvdXIgdmlkZW8gY2FyZCBpcyBub3QgaW4gdGhlcmUKKyAgIHlvdSBo
YXZlIGVpdGhlciB0byBnaXZlIGl0IHRvIHRoZSBkcml2ZXIgYXMgYSBwYXJhbWV0ZXIKKyAgIG9y
IHNldCBpbiBpbiBhIFZJRElPQ1NGQlVGIGlvY3RsCisgKi8KKworc3RhdGljIHVuc2lnbmVkIGxv
bmcgdmlkbWVtOwkvKiBkZWZhdWx0ID0gMCAtIFZpZGVvIG1lbW9yeSBiYXNlIGFkZHJlc3MgKi8K
K21vZHVsZV9wYXJhbV9odyh2aWRtZW0sIHVsb25nLCBpb21lbSwgMDQ0NCk7CitNT0RVTEVfUEFS
TV9ERVNDKHZpZG1lbSwgIkRlZmF1bHQgdmlkZW8gbWVtb3J5IGJhc2UgYWRkcmVzcyIpOworCisv
KgorICAgRGVmYXVsdCBpbnB1dCBhbmQgdmlkZW8gbm9ybSBhdCBzdGFydHVwIG9mIHRoZSBkcml2
ZXIuCisqLworCitzdGF0aWMgdW5zaWduZWQgaW50IGRlZmF1bHRfaW5wdXQ7CS8qIGRlZmF1bHQg
MCA9IENvbXBvc2l0ZSwgMSA9IFMtVmlkZW8gKi8KK21vZHVsZV9wYXJhbShkZWZhdWx0X2lucHV0
LCB1aW50LCAwNDQ0KTsKK01PRFVMRV9QQVJNX0RFU0MoZGVmYXVsdF9pbnB1dCwKKwkJICJEZWZh
dWx0IGlucHV0ICgwPUNvbXBvc2l0ZSwgMT1TLVZpZGVvLCAyPUludGVybmFsKSIpOworCitzdGF0
aWMgaW50IGRlZmF1bHRfbXV4ID0gMTsJLyogNiBFeWVzIGlucHV0IHNlbGVjdGlvbiAqLworbW9k
dWxlX3BhcmFtKGRlZmF1bHRfbXV4LCBpbnQsIDA2NDQpOworTU9EVUxFX1BBUk1fREVTQyhkZWZh
dWx0X211eCwKKwkJICJEZWZhdWx0IDYgRXllcyBtdXggc2V0dGluZyAoSW5wdXQgc2VsZWN0aW9u
KSIpOworCitzdGF0aWMgaW50IGRlZmF1bHRfbm9ybTsJLyogZGVmYXVsdCAwID0gUEFMLCAxID0g
TlRTQyAyID0gU0VDQU0gKi8KK21vZHVsZV9wYXJhbShkZWZhdWx0X25vcm0sIGludCwgMDQ0NCk7
CitNT0RVTEVfUEFSTV9ERVNDKGRlZmF1bHRfbm9ybSwgIkRlZmF1bHQgbm9ybSAoMD1QQUwsIDE9
TlRTQywgMj1TRUNBTSkiKTsKKworLyogL2Rldi92aWRlb04sIC0xIGZvciBhdXRvZGV0ZWN0ICov
CitzdGF0aWMgaW50IHZpZGVvX25yW0JVWl9NQVhdID0geyBbMCAuLi4gKEJVWl9NQVgtMSldID0g
LTEgfTsKK21vZHVsZV9wYXJhbV9hcnJheSh2aWRlb19uciwgaW50LCBOVUxMLCAwNDQ0KTsKK01P
RFVMRV9QQVJNX0RFU0ModmlkZW9fbnIsICJWaWRlbyBkZXZpY2UgbnVtYmVyICgtMT1BdXRvKSIp
OworCitpbnQgdjRsX25idWZzID0gNDsKK2ludCB2NGxfYnVmc2l6ZSA9IDg2NDsJCS8qIEV2ZXJ5
Ym9keSBzaG91bGQgYmUgYWJsZSB0byB3b3JrIHdpdGggdGhpcyBzZXR0aW5nICovCittb2R1bGVf
cGFyYW0odjRsX25idWZzLCBpbnQsIDA2NDQpOworTU9EVUxFX1BBUk1fREVTQyh2NGxfbmJ1ZnMs
ICJNYXhpbXVtIG51bWJlciBvZiBWNEwgYnVmZmVycyB0byB1c2UiKTsKK21vZHVsZV9wYXJhbSh2
NGxfYnVmc2l6ZSwgaW50LCAwNjQ0KTsKK01PRFVMRV9QQVJNX0RFU0ModjRsX2J1ZnNpemUsICJN
YXhpbXVtIHNpemUgcGVyIFY0TCBidWZmZXIgKGluIGtCKSIpOworCitpbnQganBnX25idWZzID0g
MzI7CitpbnQganBnX2J1ZnNpemUgPSA1MTI7CQkvKiBtYXggc2l6ZSBmb3IgMTAwJSBxdWFsaXR5
IGZ1bGwtUEFMIGZyYW1lICovCittb2R1bGVfcGFyYW0oanBnX25idWZzLCBpbnQsIDA2NDQpOwor
TU9EVUxFX1BBUk1fREVTQyhqcGdfbmJ1ZnMsICJNYXhpbXVtIG51bWJlciBvZiBKUEcgYnVmZmVy
cyB0byB1c2UiKTsKK21vZHVsZV9wYXJhbShqcGdfYnVmc2l6ZSwgaW50LCAwNjQ0KTsKK01PRFVM
RV9QQVJNX0RFU0MoanBnX2J1ZnNpemUsICJNYXhpbXVtIHNpemUgcGVyIEpQRyBidWZmZXIgKGlu
IGtCKSIpOworCitpbnQgcGFzc190aHJvdWdoID0gMDsJCS8qIDE9UGFzcyB0aHJvdWdoIFRWIHNp
Z25hbCB3aGVuIGRldmljZSBpcyBub3QgdXNlZCAqLworCQkJCS8qIDA9U2hvdyBjb2xvciBiYXIg
d2hlbiBkZXZpY2UgaXMgbm90IHVzZWQgKExNTDMzOiBvbmx5IGlmIGxtbDMzZHBhdGg9MSkgKi8K
K21vZHVsZV9wYXJhbShwYXNzX3Rocm91Z2gsIGludCwgMDY0NCk7CitNT0RVTEVfUEFSTV9ERVND
KHBhc3NfdGhyb3VnaCwKKwkJICJQYXNzIFRWIHNpZ25hbCB0aHJvdWdoIHRvIFRWLW91dCB3aGVu
IGlkbGluZyIpOworCitpbnQgenIzNjA2N19kZWJ1ZyA9IDE7Cittb2R1bGVfcGFyYW1fbmFtZWQo
ZGVidWcsIHpyMzYwNjdfZGVidWcsIGludCwgMDY0NCk7CitNT0RVTEVfUEFSTV9ERVNDKGRlYnVn
LCAiRGVidWcgbGV2ZWwgKDAtNSkiKTsKKworI2RlZmluZSBaT1JBTl9WRVJTSU9OICIwLjEwLjEi
CisKK01PRFVMRV9ERVNDUklQVElPTigiWm9yYW4tMzYwNTcvMzYwNjcgSlBFRyBjb2RlYyBkcml2
ZXIiKTsKK01PRFVMRV9BVVRIT1IoIlNlcmd1ZWkgTWlyaWRvbm92Iik7CitNT0RVTEVfTElDRU5T
RSgiR1BMIik7CitNT0RVTEVfVkVSU0lPTihaT1JBTl9WRVJTSU9OKTsKKworI2RlZmluZSBaUl9E
RVZJQ0Uoc3VidmVuLCBzdWJkZXYsIGRhdGEpCXsgXAorCS52ZW5kb3IgPSBQQ0lfVkVORE9SX0lE
X1pPUkFOLCAuZGV2aWNlID0gUENJX0RFVklDRV9JRF9aT1JBTl8zNjA1NywgXAorCS5zdWJ2ZW5k
b3IgPSAoc3VidmVuKSwgLnN1YmRldmljZSA9IChzdWJkZXYpLCAuZHJpdmVyX2RhdGEgPSAoZGF0
YSkgfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgenIzNjA2N19wY2lfdGJs
W10gPSB7CisJWlJfREVWSUNFKFBDSV9WRU5ET1JfSURfTUlSTywgUENJX0RFVklDRV9JRF9NSVJP
X0RDMTBQTFVTLCBEQzEwcGx1cyksCisJWlJfREVWSUNFKFBDSV9WRU5ET1JfSURfTUlSTywgUENJ
X0RFVklDRV9JRF9NSVJPX0RDMzBQTFVTLCBEQzMwcGx1cyksCisJWlJfREVWSUNFKFBDSV9WRU5E
T1JfSURfRUxFQ1RST05JQ0RFU0lHTkdNQkgsIFBDSV9ERVZJQ0VfSURfTE1MXzMzUjEwLCBMTUwz
M1IxMCksCisJWlJfREVWSUNFKFBDSV9WRU5ET1JfSURfSU9NRUdBLCBQQ0lfREVWSUNFX0lEX0lP
TUVHQV9CVVosIEJVWiksCisJWlJfREVWSUNFKFBDSV9BTllfSUQsIFBDSV9BTllfSUQsIE5VTV9D
QVJEUyksCisJezB9Cit9OworTU9EVUxFX0RFVklDRV9UQUJMRShwY2ksIHpyMzYwNjdfcGNpX3Ri
bCk7CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgem9yYW5fbnVtOwkJLyogbnVtYmVyIG9mIGNhcmRz
IGZvdW5kICovCisKKy8qIHZpZGVvY29kZWMgYnVzIGZ1bmN0aW9ucyBaUjM2MDYwICovCitzdGF0
aWMgdTMyCit6cjM2MDYwX3JlYWQgKHN0cnVjdCB2aWRlb2NvZGVjICpjb2RlYywKKwkgICAgICB1
MTYgICAgICAgICAgICAgICAgcmVnKQoreworCXN0cnVjdCB6b3JhbiAqenIgPSAoc3RydWN0IHpv
cmFuICopIGNvZGVjLT5tYXN0ZXJfZGF0YS0+ZGF0YTsKKwlfX3UzMiBkYXRhOworCisJaWYgKHBv
c3Rfb2ZmaWNlX3dhaXQoenIpCisJICAgIHx8IHBvc3Rfb2ZmaWNlX3dyaXRlKHpyLCAwLCAxLCBy
ZWcgPj4gOCkKKwkgICAgfHwgcG9zdF9vZmZpY2Vfd3JpdGUoenIsIDAsIDIsIHJlZyAmIDB4ZmYp
KSB7CisJCXJldHVybiAtMTsKKwl9CisKKwlkYXRhID0gcG9zdF9vZmZpY2VfcmVhZCh6ciwgMCwg
MykgJiAweGZmOworCXJldHVybiBkYXRhOworfQorCitzdGF0aWMgdm9pZAorenIzNjA2MF93cml0
ZSAoc3RydWN0IHZpZGVvY29kZWMgKmNvZGVjLAorCSAgICAgICB1MTYgICAgICAgICAgICAgICAg
cmVnLAorCSAgICAgICB1MzIgICAgICAgICAgICAgICAgdmFsKQoreworCXN0cnVjdCB6b3JhbiAq
enIgPSAoc3RydWN0IHpvcmFuICopIGNvZGVjLT5tYXN0ZXJfZGF0YS0+ZGF0YTsKKworCWlmIChw
b3N0X29mZmljZV93YWl0KHpyKQorCSAgICB8fCBwb3N0X29mZmljZV93cml0ZSh6ciwgMCwgMSwg
cmVnID4+IDgpCisJICAgIHx8IHBvc3Rfb2ZmaWNlX3dyaXRlKHpyLCAwLCAyLCByZWcgJiAweGZm
KSkgeworCQlyZXR1cm47CisJfQorCisJcG9zdF9vZmZpY2Vfd3JpdGUoenIsIDAsIDMsIHZhbCAm
IDB4ZmYpOworfQorCisvKiB2aWRlb2NvZGVjIGJ1cyBmdW5jdGlvbnMgWlIzNjA1MCAqLworc3Rh
dGljIHUzMgorenIzNjA1MF9yZWFkIChzdHJ1Y3QgdmlkZW9jb2RlYyAqY29kZWMsCisJICAgICAg
dTE2ICAgICAgICAgICAgICAgIHJlZykKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gKHN0cnVjdCB6
b3JhbiAqKSBjb2RlYy0+bWFzdGVyX2RhdGEtPmRhdGE7CisJX191MzIgZGF0YTsKKworCWlmIChw
b3N0X29mZmljZV93YWl0KHpyKQorCSAgICB8fCBwb3N0X29mZmljZV93cml0ZSh6ciwgMSwgMCwg
cmVnID4+IDIpKSB7CS8vIHJlZy4gSElHSEJZVEVTCisJCXJldHVybiAtMTsKKwl9CisKKwlkYXRh
ID0gcG9zdF9vZmZpY2VfcmVhZCh6ciwgMCwgcmVnICYgMHgwMykgJiAweGZmOwkvLyByZWcuIExP
V0JZVEVTICsgcmVhZAorCXJldHVybiBkYXRhOworfQorCitzdGF0aWMgdm9pZAorenIzNjA1MF93
cml0ZSAoc3RydWN0IHZpZGVvY29kZWMgKmNvZGVjLAorCSAgICAgICB1MTYgICAgICAgICAgICAg
ICAgcmVnLAorCSAgICAgICB1MzIgICAgICAgICAgICAgICAgdmFsKQoreworCXN0cnVjdCB6b3Jh
biAqenIgPSAoc3RydWN0IHpvcmFuICopIGNvZGVjLT5tYXN0ZXJfZGF0YS0+ZGF0YTsKKworCWlm
IChwb3N0X29mZmljZV93YWl0KHpyKQorCSAgICB8fCBwb3N0X29mZmljZV93cml0ZSh6ciwgMSwg
MCwgcmVnID4+IDIpKSB7CS8vIHJlZy4gSElHSEJZVEVTCisJCXJldHVybjsKKwl9CisKKwlwb3N0
X29mZmljZV93cml0ZSh6ciwgMCwgcmVnICYgMHgwMywgdmFsICYgMHhmZik7CS8vIHJlZy4gTE9X
QllURVMgKyB3ci4gZGF0YQorfQorCisvKiB2aWRlb2NvZGVjIGJ1cyBmdW5jdGlvbnMgWlIzNjAx
NiAqLworc3RhdGljIHUzMgorenIzNjAxNl9yZWFkIChzdHJ1Y3QgdmlkZW9jb2RlYyAqY29kZWMs
CisJICAgICAgdTE2ICAgICAgICAgICAgICAgIHJlZykKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0g
KHN0cnVjdCB6b3JhbiAqKSBjb2RlYy0+bWFzdGVyX2RhdGEtPmRhdGE7CisJX191MzIgZGF0YTsK
KworCWlmIChwb3N0X29mZmljZV93YWl0KHpyKSkgeworCQlyZXR1cm4gLTE7CisJfQorCisJZGF0
YSA9IHBvc3Rfb2ZmaWNlX3JlYWQoenIsIDIsIHJlZyAmIDB4MDMpICYgMHhmZjsJLy8gcmVhZAor
CXJldHVybiBkYXRhOworfQorCisvKiBoYWNrIGZvciBpbiB6b3Jhbl9kZXZpY2UuYyAqLwordm9p
ZAorenIzNjAxNl93cml0ZSAoc3RydWN0IHZpZGVvY29kZWMgKmNvZGVjLAorCSAgICAgICB1MTYg
ICAgICAgICAgICAgICAgcmVnLAorCSAgICAgICB1MzIgICAgICAgICAgICAgICAgdmFsKQorewor
CXN0cnVjdCB6b3JhbiAqenIgPSAoc3RydWN0IHpvcmFuICopIGNvZGVjLT5tYXN0ZXJfZGF0YS0+
ZGF0YTsKKworCWlmIChwb3N0X29mZmljZV93YWl0KHpyKSkgeworCQlyZXR1cm47CisJfQorCisJ
cG9zdF9vZmZpY2Vfd3JpdGUoenIsIDIsIHJlZyAmIDB4MDMsIHZhbCAmIDB4MGZmKTsJLy8gd3Iu
IGRhdGEKK30KKworLyoKKyAqIEJvYXJkIHNwZWNpZmljIGluZm9ybWF0aW9uCisgKi8KKworc3Rh
dGljIHZvaWQKK2RjMTBfaW5pdCAoc3RydWN0IHpvcmFuICp6cikKK3sKKwlkcHJpbnRrKDMsIEtF
Uk5fREVCVUcgIiVzOiAlc1xuIiwgWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKworCS8qIFBp
eGVsIGNsb2NrIHNlbGVjdGlvbiAqLworCUdQSU8oenIsIDQsIDApOworCUdQSU8oenIsIDUsIDEp
OworCS8qIEVuYWJsZSB0aGUgdmlkZW8gYnVzIHN5bmMgc2lnbmFscyAqLworCUdQSU8oenIsIDcs
IDApOworfQorCitzdGF0aWMgdm9pZAorZGMxMHBsdXNfaW5pdCAoc3RydWN0IHpvcmFuICp6cikK
K3sKKwlkcHJpbnRrKDMsIEtFUk5fREVCVUcgIiVzOiAlc1xuIiwgWlJfREVWTkFNRSh6ciksIF9f
ZnVuY19fKTsKK30KKworc3RhdGljIHZvaWQKK2J1el9pbml0IChzdHJ1Y3Qgem9yYW4gKnpyKQor
eworCWRwcmludGsoMywgS0VSTl9ERUJVRyAiJXM6ICVzXG4iLCBaUl9ERVZOQU1FKHpyKSwgX19m
dW5jX18pOworCisJLyogc29tZSBzdHVmZiBmcm9tIElvbWVnYSAqLworCXBjaV93cml0ZV9jb25m
aWdfZHdvcmQoenItPnBjaV9kZXYsIDB4ZmMsIDB4OTA2ODBmMTUpOworCXBjaV93cml0ZV9jb25m
aWdfZHdvcmQoenItPnBjaV9kZXYsIDB4MGMsIDB4MDAwMTIwMjApOworCXBjaV93cml0ZV9jb25m
aWdfZHdvcmQoenItPnBjaV9kZXYsIDB4ZTgsIDB4YzAyMDAwMDApOworfQorCitzdGF0aWMgdm9p
ZAorbG1sMzNfaW5pdCAoc3RydWN0IHpvcmFuICp6cikKK3sKKwlkcHJpbnRrKDMsIEtFUk5fREVC
VUcgIiVzOiAlc1xuIiwgWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKworCUdQSU8oenIsIDIs
IDEpOwkJLy8gU2V0IENvbXBvc2l0ZSBpbnB1dC9vdXRwdXQKK30KKworc3RhdGljIHZvaWQKK2F2
czZleWVzX2luaXQgKHN0cnVjdCB6b3JhbiAqenIpCit7CisJLy8gQXZlck1lZGlhIDYtRXllcyBv
cmlnaW5hbCBkcml2ZXIgYnkgQ2hyaXN0ZXIgV2VpbmlnZWwKKworCS8vIExpZnRlZCBzdHJhaWdo
dCBmcm9tIENocmlzdGVyJ3Mgb2xkIGRyaXZlciBhbmQKKwkvLyBtb2RpZmllZCBzbGlnaHRseSBi
eSBNYXJ0aW4gU2FtdWVsc3Nvbi4KKworCWludCBtdXggPSBkZWZhdWx0X211eDsgLyogMSA9IEJU
ODY2LCA3ID0gVklEMSAqLworCisJR1BJTyh6ciwgNCwgMSk7IC8qIEJ0ODY2IFNMRUVQIG9uICov
CisJdWRlbGF5KDIpOworCisJR1BJTyh6ciwgMCwgMSk7IC8qIFpSMzYwNjAgL1JFU0VUIG9uICov
CisJR1BJTyh6ciwgMSwgMCk7IC8qIFpSMzYwNjAgL1NMRUVQIG9uICovCisJR1BJTyh6ciwgMiwg
bXV4ICYgMSk7ICAgLyogTVVYIFMwICovCisJR1BJTyh6ciwgMywgMCk7IC8qIC9GUkFNRSBvbiAq
LworCUdQSU8oenIsIDQsIDApOyAvKiBCdDg2NiBTTEVFUCBvZmYgKi8KKwlHUElPKHpyLCA1LCBt
dXggJiAyKTsgICAvKiBNVVggUzEgKi8KKwlHUElPKHpyLCA2LCAwKTsgLyogPyAqLworCUdQSU8o
enIsIDcsIG11eCAmIDQpOyAgIC8qIE1VWCBTMiAqLworCit9CisKK3N0YXRpYyBjaGFyICoKK2Nv
ZGVjaWRfdG9fbW9kdWxlbmFtZSAodTE2IGNvZGVjaWQpCit7CisJY2hhciAqbmFtZSA9IE5VTEw7
CisKKwlzd2l0Y2ggKGNvZGVjaWQpIHsKKwljYXNlIENPREVDX1RZUEVfWlIzNjA2MDoKKwkJbmFt
ZSA9ICJ6cjM2MDYwIjsKKwkJYnJlYWs7CisJY2FzZSBDT0RFQ19UWVBFX1pSMzYwNTA6CisJCW5h
bWUgPSAienIzNjA1MCI7CisJCWJyZWFrOworCWNhc2UgQ09ERUNfVFlQRV9aUjM2MDE2OgorCQlu
YW1lID0gInpyMzYwMTYiOworCQlicmVhazsKKwl9CisKKwlyZXR1cm4gbmFtZTsKK30KKworLy8g
c3RydWN0IHR2bm9ybSB7CisvLyAgICAgIHUxNiBXdCwgV2EsIEhTdGFydCwgSFN5bmNTdGFydCwg
SHQsIEhhLCBWU3RhcnQ7CisvLyB9OworCitzdGF0aWMgc3RydWN0IHR2bm9ybSBmNTBzcXBpeGVs
ID0geyA5NDQsIDc2OCwgODMsIDg4MCwgNjI1LCA1NzYsIDE2IH07CitzdGF0aWMgc3RydWN0IHR2
bm9ybSBmNjBzcXBpeGVsID0geyA3ODAsIDY0MCwgNTEsIDcxNiwgNTI1LCA0ODAsIDEyIH07Citz
dGF0aWMgc3RydWN0IHR2bm9ybSBmNTBjY2lyNjAxID0geyA4NjQsIDcyMCwgNzUsIDgwNCwgNjI1
LCA1NzYsIDE4IH07CitzdGF0aWMgc3RydWN0IHR2bm9ybSBmNjBjY2lyNjAxID0geyA4NTgsIDcy
MCwgNTcsIDc4OCwgNTI1LCA0ODAsIDE2IH07CisKK3N0YXRpYyBzdHJ1Y3QgdHZub3JtIGY1MGNj
aXI2MDFfbG1sMzMgPSB7IDg2NCwgNzIwLCA3NSszNCwgODA0LCA2MjUsIDU3NiwgMTggfTsKK3N0
YXRpYyBzdHJ1Y3QgdHZub3JtIGY2MGNjaXI2MDFfbG1sMzMgPSB7IDg1OCwgNzIwLCA1NyszNCwg
Nzg4LCA1MjUsIDQ4MCwgMTYgfTsKKworLyogVGhlIERDMTAgKDU3LzE2LzUwKSB1c2VzIFZBY3Rp
dmUgYXMgSFN5bmMsIHNvIEhTdGFydCBtdXN0IGJlIDAgKi8KK3N0YXRpYyBzdHJ1Y3QgdHZub3Jt
IGY1MHNxcGl4ZWxfZGMxMCA9IHsgOTQ0LCA3NjgsIDAsIDg4MCwgNjI1LCA1NzYsIDAgfTsKK3N0
YXRpYyBzdHJ1Y3QgdHZub3JtIGY2MHNxcGl4ZWxfZGMxMCA9IHsgNzgwLCA2NDAsIDAsIDcxNiwg
NTI1LCA0ODAsIDEyIH07CisKKy8qIEZJWE1FOiBJIGNhbm5vdCBzd2FwIFUgYW5kIFYgaW4gc2Fh
NzExNCwgc28gaSBkbyBvbmUKKyAqIHBpeGVsIGxlZnQgc2hpZnQgaW4gem9yYW4gKDc1IC0+IDc0
KQorICogKE1heGltIFlldnR5dXNoa2luIDxtYXhAbGludXhtZWRpYWxhYnMuY29tPikgKi8KK3N0
YXRpYyBzdHJ1Y3QgdHZub3JtIGY1MGNjaXI2MDFfbG0zM3IxMCA9IHsgODY0LCA3MjAsIDc0KzU0
LCA4MDQsIDYyNSwgNTc2LCAxOCB9Oworc3RhdGljIHN0cnVjdCB0dm5vcm0gZjYwY2NpcjYwMV9s
bTMzcjEwID0geyA4NTgsIDcyMCwgNTYrNTQsIDc4OCwgNTI1LCA0ODAsIDE2IH07CisKKy8qIEZJ
WE1FOiBUaGUga3MwMTI3IHNlZW0gaW5jYXBhYmxlIG9mIHN3YXBwaW5nIFUgYW5kIFYsIHRvbywg
d2hpY2ggaXMgd2h5IEkKKyAqIGNvcHkgTWF4aW0ncyBsZWZ0IHNoaWZ0IGhhY2sgZm9yIHRoZSA2
IEV5ZXMuCisgKgorICogQ2hyaXN0ZXIncyBkcml2ZXIgdXNlZCB0aGUgdW5zaGlmdGVkIG5vcm1z
LCB0aG91Z2guLi4KKyAqIC9TYW0gICovCitzdGF0aWMgc3RydWN0IHR2bm9ybSBmNTBjY2lyNjAx
X2F2czZleWVzID0geyA4NjQsIDcyMCwgNzQsIDgwNCwgNjI1LCA1NzYsIDE4IH07CitzdGF0aWMg
c3RydWN0IHR2bm9ybSBmNjBjY2lyNjAxX2F2czZleWVzID0geyA4NTgsIDcyMCwgNTYsIDc4OCwg
NTI1LCA0ODAsIDE2IH07CisKK3N0YXRpYyBjb25zdCB1bnNpZ25lZCBzaG9ydCB2cHgzMjIwX2Fk
ZHJzW10gPSB7IDB4NDMsIDB4NDcsIEkyQ19DTElFTlRfRU5EIH07CitzdGF0aWMgY29uc3QgdW5z
aWduZWQgc2hvcnQgc2FhNzExMF9hZGRyc1tdID0geyAweDRlLCAweDRmLCBJMkNfQ0xJRU5UX0VO
RCB9Oworc3RhdGljIGNvbnN0IHVuc2lnbmVkIHNob3J0IHNhYTcxMTFfYWRkcnNbXSA9IHsgMHgy
NSwgMHgyNCwgSTJDX0NMSUVOVF9FTkQgfTsKK3N0YXRpYyBjb25zdCB1bnNpZ25lZCBzaG9ydCBz
YWE3MTE0X2FkZHJzW10gPSB7IDB4MjEsIDB4MjAsIEkyQ19DTElFTlRfRU5EIH07CitzdGF0aWMg
Y29uc3QgdW5zaWduZWQgc2hvcnQgYWR2NzE3eF9hZGRyc1tdID0geyAweDZhLCAweDZiLCAweDJh
LCAweDJiLCBJMkNfQ0xJRU5UX0VORCB9Oworc3RhdGljIGNvbnN0IHVuc2lnbmVkIHNob3J0IGtz
MDEyN19hZGRyc1tdID0geyAweDZjLCAweDZkLCBJMkNfQ0xJRU5UX0VORCB9Oworc3RhdGljIGNv
bnN0IHVuc2lnbmVkIHNob3J0IHNhYTcxODVfYWRkcnNbXSA9IHsgMHg0NCwgSTJDX0NMSUVOVF9F
TkQgfTsKK3N0YXRpYyBjb25zdCB1bnNpZ25lZCBzaG9ydCBidDgxOV9hZGRyc1tdID0geyAweDQ1
LCBJMkNfQ0xJRU5UX0VORCB9Oworc3RhdGljIGNvbnN0IHVuc2lnbmVkIHNob3J0IGJ0ODU2X2Fk
ZHJzW10gPSB7IDB4NDQsIEkyQ19DTElFTlRfRU5EIH07CitzdGF0aWMgY29uc3QgdW5zaWduZWQg
c2hvcnQgYnQ4NjZfYWRkcnNbXSA9IHsgMHg0NCwgSTJDX0NMSUVOVF9FTkQgfTsKKworc3RhdGlj
IHN0cnVjdCBjYXJkX2luZm8gem9yYW5fY2FyZHNbTlVNX0NBUkRTXSA9IHsKKwl7CisJCS50eXBl
ID0gREMxMF9vbGQsCisJCS5uYW1lID0gIkRDMTAob2xkKSIsCisJCS5pMmNfZGVjb2RlciA9ICJ2
cHgzMjIwYSIsCisJCS5hZGRyc19kZWNvZGVyID0gdnB4MzIyMF9hZGRycywKKwkJLnZpZGVvX2Nv
ZGVjID0gQ09ERUNfVFlQRV9aUjM2MDUwLAorCQkudmlkZW9fdmZlID0gQ09ERUNfVFlQRV9aUjM2
MDE2LAorCisJCS5pbnB1dHMgPSAzLAorCQkuaW5wdXQgPSB7CisJCQl7IDEsICJDb21wb3NpdGUi
IH0sCisJCQl7IDIsICJTLVZpZGVvIiB9LAorCQkJeyAwLCAiSW50ZXJuYWwvY29tcCIgfQorCQl9
LAorCQkubm9ybXMgPSBWNEwyX1NURF9OVFNDfFY0TDJfU1REX1BBTHxWNEwyX1NURF9TRUNBTSwK
KwkJLnR2biA9IHsKKwkJCSZmNTBzcXBpeGVsX2RjMTAsCisJCQkmZjYwc3FwaXhlbF9kYzEwLAor
CQkJJmY1MHNxcGl4ZWxfZGMxMAorCQl9LAorCQkuanBlZ19pbnQgPSAwLAorCQkudnN5bmNfaW50
ID0gWlIzNjA1N19JU1JfR0lSUTEsCisJCS5ncGlvID0geyAyLCAxLCAtMSwgMywgNywgMCwgNCwg
NSB9LAorCQkuZ3Bpb19wb2wgPSB7IDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAgfSwKKwkJLmdwY3Mg
PSB7IC0xLCAwIH0sCisJCS52ZmVfcG9sID0geyAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwIH0sCisJ
CS5nd3Nfbm90X2Nvbm5lY3RlZCA9IDAsCisJCS5pbnB1dF9tdXggPSAwLAorCQkuaW5pdCA9ICZk
YzEwX2luaXQsCisJfSwgeworCQkudHlwZSA9IERDMTBfbmV3LAorCQkubmFtZSA9ICJEQzEwKG5l
dykiLAorCQkuaTJjX2RlY29kZXIgPSAic2FhNzExMCIsCisJCS5hZGRyc19kZWNvZGVyID0gc2Fh
NzExMF9hZGRycywKKwkJLmkyY19lbmNvZGVyID0gImFkdjcxNzUiLAorCQkuYWRkcnNfZW5jb2Rl
ciA9IGFkdjcxN3hfYWRkcnMsCisJCS52aWRlb19jb2RlYyA9IENPREVDX1RZUEVfWlIzNjA2MCwK
KworCQkuaW5wdXRzID0gMywKKwkJLmlucHV0ID0geworCQkJCXsgMCwgIkNvbXBvc2l0ZSIgfSwK
KwkJCQl7IDcsICJTLVZpZGVvIiB9LAorCQkJCXsgNSwgIkludGVybmFsL2NvbXAiIH0KKwkJCX0s
CisJCS5ub3JtcyA9IFY0TDJfU1REX05UU0N8VjRMMl9TVERfUEFMfFY0TDJfU1REX1NFQ0FNLAor
CQkudHZuID0geworCQkJCSZmNTBzcXBpeGVsLAorCQkJCSZmNjBzcXBpeGVsLAorCQkJCSZmNTBz
cXBpeGVsfSwKKwkJLmpwZWdfaW50ID0gWlIzNjA1N19JU1JfR0lSUTAsCisJCS52c3luY19pbnQg
PSBaUjM2MDU3X0lTUl9HSVJRMSwKKwkJLmdwaW8gPSB7IDMsIDAsIDYsIDEsIDIsIC0xLCA0LCA1
IH0sCisJCS5ncGlvX3BvbCA9IHsgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCB9LAorCQkuZ3BjcyA9
IHsgLTEsIDF9LAorCQkudmZlX3BvbCA9IHsgMSwgMSwgMSwgMSwgMCwgMCwgMCwgMCB9LAorCQku
Z3dzX25vdF9jb25uZWN0ZWQgPSAwLAorCQkuaW5wdXRfbXV4ID0gMCwKKwkJLmluaXQgPSAmZGMx
MHBsdXNfaW5pdCwKKwl9LCB7CisJCS50eXBlID0gREMxMHBsdXMsCisJCS5uYW1lID0gIkRDMTBw
bHVzIiwKKwkJLmkyY19kZWNvZGVyID0gInNhYTcxMTAiLAorCQkuYWRkcnNfZGVjb2RlciA9IHNh
YTcxMTBfYWRkcnMsCisJCS5pMmNfZW5jb2RlciA9ICJhZHY3MTc1IiwKKwkJLmFkZHJzX2VuY29k
ZXIgPSBhZHY3MTd4X2FkZHJzLAorCQkudmlkZW9fY29kZWMgPSBDT0RFQ19UWVBFX1pSMzYwNjAs
CisKKwkJLmlucHV0cyA9IDMsCisJCS5pbnB1dCA9IHsKKwkJCXsgMCwgIkNvbXBvc2l0ZSIgfSwK
KwkJCXsgNywgIlMtVmlkZW8iIH0sCisJCQl7IDUsICJJbnRlcm5hbC9jb21wIiB9CisJCX0sCisJ
CS5ub3JtcyA9IFY0TDJfU1REX05UU0N8VjRMMl9TVERfUEFMfFY0TDJfU1REX1NFQ0FNLAorCQku
dHZuID0geworCQkJJmY1MHNxcGl4ZWwsCisJCQkmZjYwc3FwaXhlbCwKKwkJCSZmNTBzcXBpeGVs
CisJCX0sCisJCS5qcGVnX2ludCA9IFpSMzYwNTdfSVNSX0dJUlEwLAorCQkudnN5bmNfaW50ID0g
WlIzNjA1N19JU1JfR0lSUTEsCisJCS5ncGlvID0geyAzLCAwLCA2LCAxLCAyLCAtMSwgNCwgNSB9
LAorCQkuZ3Bpb19wb2wgPSB7IDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAgfSwKKwkJLmdwY3MgPSB7
IC0xLCAxIH0sCisJCS52ZmVfcG9sID0geyAxLCAxLCAxLCAxLCAwLCAwLCAwLCAwIH0sCisJCS5n
d3Nfbm90X2Nvbm5lY3RlZCA9IDAsCisJCS5pbnB1dF9tdXggPSAwLAorCQkuaW5pdCA9ICZkYzEw
cGx1c19pbml0LAorCX0sIHsKKwkJLnR5cGUgPSBEQzMwLAorCQkubmFtZSA9ICJEQzMwIiwKKwkJ
LmkyY19kZWNvZGVyID0gInZweDMyMjBhIiwKKwkJLmFkZHJzX2RlY29kZXIgPSB2cHgzMjIwX2Fk
ZHJzLAorCQkuaTJjX2VuY29kZXIgPSAiYWR2NzE3NSIsCisJCS5hZGRyc19lbmNvZGVyID0gYWR2
NzE3eF9hZGRycywKKwkJLnZpZGVvX2NvZGVjID0gQ09ERUNfVFlQRV9aUjM2MDUwLAorCQkudmlk
ZW9fdmZlID0gQ09ERUNfVFlQRV9aUjM2MDE2LAorCisJCS5pbnB1dHMgPSAzLAorCQkuaW5wdXQg
PSB7CisJCQl7IDEsICJDb21wb3NpdGUiIH0sCisJCQl7IDIsICJTLVZpZGVvIiB9LAorCQkJeyAw
LCAiSW50ZXJuYWwvY29tcCIgfQorCQl9LAorCQkubm9ybXMgPSBWNEwyX1NURF9OVFNDfFY0TDJf
U1REX1BBTHxWNEwyX1NURF9TRUNBTSwKKwkJLnR2biA9IHsKKwkJCSZmNTBzcXBpeGVsX2RjMTAs
CisJCQkmZjYwc3FwaXhlbF9kYzEwLAorCQkJJmY1MHNxcGl4ZWxfZGMxMAorCQl9LAorCQkuanBl
Z19pbnQgPSAwLAorCQkudnN5bmNfaW50ID0gWlIzNjA1N19JU1JfR0lSUTEsCisJCS5ncGlvID0g
eyAyLCAxLCAtMSwgMywgNywgMCwgNCwgNSB9LAorCQkuZ3Bpb19wb2wgPSB7IDAsIDAsIDAsIDEs
IDAsIDAsIDAsIDAgfSwKKwkJLmdwY3MgPSB7IC0xLCAwIH0sCisJCS52ZmVfcG9sID0geyAwLCAw
LCAwLCAwLCAwLCAwLCAwLCAwIH0sCisJCS5nd3Nfbm90X2Nvbm5lY3RlZCA9IDAsCisJCS5pbnB1
dF9tdXggPSAwLAorCQkuaW5pdCA9ICZkYzEwX2luaXQsCisJfSwgeworCQkudHlwZSA9IERDMzBw
bHVzLAorCQkubmFtZSA9ICJEQzMwcGx1cyIsCisJCS5pMmNfZGVjb2RlciA9ICJ2cHgzMjIwYSIs
CisJCS5hZGRyc19kZWNvZGVyID0gdnB4MzIyMF9hZGRycywKKwkJLmkyY19lbmNvZGVyID0gImFk
djcxNzUiLAorCQkuYWRkcnNfZW5jb2RlciA9IGFkdjcxN3hfYWRkcnMsCisJCS52aWRlb19jb2Rl
YyA9IENPREVDX1RZUEVfWlIzNjA1MCwKKwkJLnZpZGVvX3ZmZSA9IENPREVDX1RZUEVfWlIzNjAx
NiwKKworCQkuaW5wdXRzID0gMywKKwkJLmlucHV0ID0geworCQkJeyAxLCAiQ29tcG9zaXRlIiB9
LAorCQkJeyAyLCAiUy1WaWRlbyIgfSwKKwkJCXsgMCwgIkludGVybmFsL2NvbXAiIH0KKwkJfSwK
KwkJLm5vcm1zID0gVjRMMl9TVERfTlRTQ3xWNEwyX1NURF9QQUx8VjRMMl9TVERfU0VDQU0sCisJ
CS50dm4gPSB7CisJCQkmZjUwc3FwaXhlbF9kYzEwLAorCQkJJmY2MHNxcGl4ZWxfZGMxMCwKKwkJ
CSZmNTBzcXBpeGVsX2RjMTAKKwkJfSwKKwkJLmpwZWdfaW50ID0gMCwKKwkJLnZzeW5jX2ludCA9
IFpSMzYwNTdfSVNSX0dJUlExLAorCQkuZ3BpbyA9IHsgMiwgMSwgLTEsIDMsIDcsIDAsIDQsIDUg
fSwKKwkJLmdwaW9fcG9sID0geyAwLCAwLCAwLCAxLCAwLCAwLCAwLCAwIH0sCisJCS5ncGNzID0g
eyAtMSwgMCB9LAorCQkudmZlX3BvbCA9IHsgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCB9LAorCQku
Z3dzX25vdF9jb25uZWN0ZWQgPSAwLAorCQkuaW5wdXRfbXV4ID0gMCwKKwkJLmluaXQgPSAmZGMx
MF9pbml0LAorCX0sIHsKKwkJLnR5cGUgPSBMTUwzMywKKwkJLm5hbWUgPSAiTE1MMzMiLAorCQku
aTJjX2RlY29kZXIgPSAiYnQ4MTlhIiwKKwkJLmFkZHJzX2RlY29kZXIgPSBidDgxOV9hZGRycywK
KwkJLmkyY19lbmNvZGVyID0gImJ0ODU2IiwKKwkJLmFkZHJzX2VuY29kZXIgPSBidDg1Nl9hZGRy
cywKKwkJLnZpZGVvX2NvZGVjID0gQ09ERUNfVFlQRV9aUjM2MDYwLAorCisJCS5pbnB1dHMgPSAy
LAorCQkuaW5wdXQgPSB7CisJCQl7IDAsICJDb21wb3NpdGUiIH0sCisJCQl7IDcsICJTLVZpZGVv
IiB9CisJCX0sCisJCS5ub3JtcyA9IFY0TDJfU1REX05UU0N8VjRMMl9TVERfUEFMLAorCQkudHZu
ID0geworCQkJJmY1MGNjaXI2MDFfbG1sMzMsCisJCQkmZjYwY2NpcjYwMV9sbWwzMywKKwkJCU5V
TEwKKwkJfSwKKwkJLmpwZWdfaW50ID0gWlIzNjA1N19JU1JfR0lSUTEsCisJCS52c3luY19pbnQg
PSBaUjM2MDU3X0lTUl9HSVJRMCwKKwkJLmdwaW8gPSB7IDEsIC0xLCAzLCA1LCA3LCAtMSwgLTEs
IC0xIH0sCisJCS5ncGlvX3BvbCA9IHsgMCwgMCwgMCwgMCwgMSwgMCwgMCwgMCB9LAorCQkuZ3Bj
cyA9IHsgMywgMSB9LAorCQkudmZlX3BvbCA9IHsgMSwgMSwgMCwgMCwgMCwgMSwgMCwgMCB9LAor
CQkuZ3dzX25vdF9jb25uZWN0ZWQgPSAxLAorCQkuaW5wdXRfbXV4ID0gMCwKKwkJLmluaXQgPSAm
bG1sMzNfaW5pdCwKKwl9LCB7CisJCS50eXBlID0gTE1MMzNSMTAsCisJCS5uYW1lID0gIkxNTDMz
UjEwIiwKKwkJLmkyY19kZWNvZGVyID0gInNhYTcxMTQiLAorCQkuYWRkcnNfZGVjb2RlciA9IHNh
YTcxMTRfYWRkcnMsCisJCS5pMmNfZW5jb2RlciA9ICJhZHY3MTcwIiwKKwkJLmFkZHJzX2VuY29k
ZXIgPSBhZHY3MTd4X2FkZHJzLAorCQkudmlkZW9fY29kZWMgPSBDT0RFQ19UWVBFX1pSMzYwNjAs
CisKKwkJLmlucHV0cyA9IDIsCisJCS5pbnB1dCA9IHsKKwkJCXsgMCwgIkNvbXBvc2l0ZSIgfSwK
KwkJCXsgNywgIlMtVmlkZW8iIH0KKwkJfSwKKwkJLm5vcm1zID0gVjRMMl9TVERfTlRTQ3xWNEwy
X1NURF9QQUwsCisJCS50dm4gPSB7CisJCQkmZjUwY2NpcjYwMV9sbTMzcjEwLAorCQkJJmY2MGNj
aXI2MDFfbG0zM3IxMCwKKwkJCU5VTEwKKwkJfSwKKwkJLmpwZWdfaW50ID0gWlIzNjA1N19JU1Jf
R0lSUTEsCisJCS52c3luY19pbnQgPSBaUjM2MDU3X0lTUl9HSVJRMCwKKwkJLmdwaW8gPSB7IDEs
IC0xLCAzLCA1LCA3LCAtMSwgLTEsIC0xIH0sCisJCS5ncGlvX3BvbCA9IHsgMCwgMCwgMCwgMCwg
MSwgMCwgMCwgMCB9LAorCQkuZ3BjcyA9IHsgMywgMSB9LAorCQkudmZlX3BvbCA9IHsgMSwgMSwg
MCwgMCwgMCwgMSwgMCwgMCB9LAorCQkuZ3dzX25vdF9jb25uZWN0ZWQgPSAxLAorCQkuaW5wdXRf
bXV4ID0gMCwKKwkJLmluaXQgPSAmbG1sMzNfaW5pdCwKKwl9LCB7CisJCS50eXBlID0gQlVaLAor
CQkubmFtZSA9ICJCdXoiLAorCQkuaTJjX2RlY29kZXIgPSAic2FhNzExMSIsCisJCS5hZGRyc19k
ZWNvZGVyID0gc2FhNzExMV9hZGRycywKKwkJLmkyY19lbmNvZGVyID0gInNhYTcxODUiLAorCQku
YWRkcnNfZW5jb2RlciA9IHNhYTcxODVfYWRkcnMsCisJCS52aWRlb19jb2RlYyA9IENPREVDX1RZ
UEVfWlIzNjA2MCwKKworCQkuaW5wdXRzID0gMiwKKwkJLmlucHV0ID0geworCQkJeyAzLCAiQ29t
cG9zaXRlIiB9LAorCQkJeyA3LCAiUy1WaWRlbyIgfQorCQl9LAorCQkubm9ybXMgPSBWNEwyX1NU
RF9OVFNDfFY0TDJfU1REX1BBTHxWNEwyX1NURF9TRUNBTSwKKwkJLnR2biA9IHsKKwkJCSZmNTBj
Y2lyNjAxLAorCQkJJmY2MGNjaXI2MDEsCisJCQkmZjUwY2NpcjYwMQorCQl9LAorCQkuanBlZ19p
bnQgPSBaUjM2MDU3X0lTUl9HSVJRMSwKKwkJLnZzeW5jX2ludCA9IFpSMzYwNTdfSVNSX0dJUlEw
LAorCQkuZ3BpbyA9IHsgMSwgLTEsIDMsIC0xLCAtMSwgLTEsIC0xLCAtMSB9LAorCQkuZ3Bpb19w
b2wgPSB7IDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAgfSwKKwkJLmdwY3MgPSB7IDMsIDEgfSwKKwkJ
LnZmZV9wb2wgPSB7IDEsIDEsIDAsIDAsIDAsIDEsIDAsIDAgfSwKKwkJLmd3c19ub3RfY29ubmVj
dGVkID0gMSwKKwkJLmlucHV0X211eCA9IDAsCisJCS5pbml0ID0gJmJ1el9pbml0LAorCX0sIHsK
KwkJLnR5cGUgPSBBVlM2RVlFUywKKwkJLm5hbWUgPSAiNi1FeWVzIiwKKwkJLyogQXZlck1lZGlh
IGNob3NlIG5vdCB0byBicmFuZCB0aGUgNi1FeWVzLiBUaHVzIGl0CisJCSAgIGNhbid0IGJlIGF1
dG9kZXRlY3RlZCwgYW5kIHJlcXVpcmVzIGNhcmQ9eC4gKi8KKwkJLmkyY19kZWNvZGVyID0gImtz
MDEyNyIsCisJCS5hZGRyc19kZWNvZGVyID0ga3MwMTI3X2FkZHJzLAorCQkuaTJjX2VuY29kZXIg
PSAiYnQ4NjYiLAorCQkuYWRkcnNfZW5jb2RlciA9IGJ0ODY2X2FkZHJzLAorCQkudmlkZW9fY29k
ZWMgPSBDT0RFQ19UWVBFX1pSMzYwNjAsCisKKwkJLmlucHV0cyA9IDEwLAorCQkuaW5wdXQgPSB7
CisJCQl7IDAsICJDb21wb3NpdGUgMSIgfSwKKwkJCXsgMSwgIkNvbXBvc2l0ZSAyIiB9LAorCQkJ
eyAyLCAiQ29tcG9zaXRlIDMiIH0sCisJCQl7IDQsICJDb21wb3NpdGUgNCIgfSwKKwkJCXsgNSwg
IkNvbXBvc2l0ZSA1IiB9LAorCQkJeyA2LCAiQ29tcG9zaXRlIDYiIH0sCisJCQl7IDgsICJTLVZp
ZGVvIDEiIH0sCisJCQl7IDksICJTLVZpZGVvIDIiIH0sCisJCQl7MTAsICJTLVZpZGVvIDMiIH0s
CisJCQl7MTUsICJZQ2JDciIgfQorCQl9LAorCQkubm9ybXMgPSBWNEwyX1NURF9OVFNDfFY0TDJf
U1REX1BBTCwKKwkJLnR2biA9IHsKKwkJCSZmNTBjY2lyNjAxX2F2czZleWVzLAorCQkJJmY2MGNj
aXI2MDFfYXZzNmV5ZXMsCisJCQlOVUxMCisJCX0sCisJCS5qcGVnX2ludCA9IFpSMzYwNTdfSVNS
X0dJUlExLAorCQkudnN5bmNfaW50ID0gWlIzNjA1N19JU1JfR0lSUTAsCisJCS5ncGlvID0geyAx
LCAwLCAzLCAtMSwgLTEsIC0xLCAtMSwgLTEgfSwvLyBWYWxpZGl0eSB1bmtub3duIC9TYW0KKwkJ
LmdwaW9fcG9sID0geyAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwIH0sIC8vIFZhbGlkaXR5IHVua25v
d24gL1NhbQorCQkuZ3BjcyA9IHsgMywgMSB9LAkJCS8vIFZhbGlkaXR5IHVua25vd24gL1NhbQor
CQkudmZlX3BvbCA9IHsgMSwgMCwgMCwgMCwgMCwgMSwgMCwgMCB9LCAgLy8gVmFsaWRpdHkgdW5r
bm93biAvU2FtCisJCS5nd3Nfbm90X2Nvbm5lY3RlZCA9IDEsCisJCS5pbnB1dF9tdXggPSAxLAor
CQkuaW5pdCA9ICZhdnM2ZXllc19pbml0LAorCX0KKworfTsKKworLyoKKyAqIEkyQyBmdW5jdGlv
bnMKKyAqLworLyogc29mdHdhcmUgSTJDIGZ1bmN0aW9ucyAqLworc3RhdGljIGludAorem9yYW5f
aTJjX2dldHNkYSAodm9pZCAqZGF0YSkKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gKHN0cnVjdCB6
b3JhbiAqKSBkYXRhOworCisJcmV0dXJuIChidHJlYWQoWlIzNjA1N19JMkNCUikgPj4gMSkgJiAx
OworfQorCitzdGF0aWMgaW50Cit6b3Jhbl9pMmNfZ2V0c2NsICh2b2lkICpkYXRhKQoreworCXN0
cnVjdCB6b3JhbiAqenIgPSAoc3RydWN0IHpvcmFuICopIGRhdGE7CisKKwlyZXR1cm4gYnRyZWFk
KFpSMzYwNTdfSTJDQlIpICYgMTsKK30KKworc3RhdGljIHZvaWQKK3pvcmFuX2kyY19zZXRzZGEg
KHZvaWQgKmRhdGEsCisJCSAgaW50ICAgc3RhdGUpCit7CisJc3RydWN0IHpvcmFuICp6ciA9IChz
dHJ1Y3Qgem9yYW4gKikgZGF0YTsKKworCWlmIChzdGF0ZSkKKwkJenItPmkyY2JyIHw9IDI7CisJ
ZWxzZQorCQl6ci0+aTJjYnIgJj0gfjI7CisJYnR3cml0ZSh6ci0+aTJjYnIsIFpSMzYwNTdfSTJD
QlIpOworfQorCitzdGF0aWMgdm9pZAorem9yYW5faTJjX3NldHNjbCAodm9pZCAqZGF0YSwKKwkJ
ICBpbnQgICBzdGF0ZSkKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gKHN0cnVjdCB6b3JhbiAqKSBk
YXRhOworCisJaWYgKHN0YXRlKQorCQl6ci0+aTJjYnIgfD0gMTsKKwllbHNlCisJCXpyLT5pMmNi
ciAmPSB+MTsKKwlidHdyaXRlKHpyLT5pMmNiciwgWlIzNjA1N19JMkNCUik7Cit9CisKK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgaTJjX2FsZ29fYml0X2RhdGEgem9yYW5faTJjX2JpdF9kYXRhX3RlbXBs
YXRlID0geworCS5zZXRzZGEgPSB6b3Jhbl9pMmNfc2V0c2RhLAorCS5zZXRzY2wgPSB6b3Jhbl9p
MmNfc2V0c2NsLAorCS5nZXRzZGEgPSB6b3Jhbl9pMmNfZ2V0c2RhLAorCS5nZXRzY2wgPSB6b3Jh
bl9pMmNfZ2V0c2NsLAorCS51ZGVsYXkgPSAxMCwKKwkudGltZW91dCA9IDEwMCwKK307CisKK3N0
YXRpYyBpbnQKK3pvcmFuX3JlZ2lzdGVyX2kyYyAoc3RydWN0IHpvcmFuICp6cikKK3sKKwl6ci0+
aTJjX2FsZ28gPSB6b3Jhbl9pMmNfYml0X2RhdGFfdGVtcGxhdGU7CisJenItPmkyY19hbGdvLmRh
dGEgPSB6cjsKKwlzdHJzY3B5KHpyLT5pMmNfYWRhcHRlci5uYW1lLCBaUl9ERVZOQU1FKHpyKSwK
KwkJc2l6ZW9mKHpyLT5pMmNfYWRhcHRlci5uYW1lKSk7CisJaTJjX3NldF9hZGFwZGF0YSgmenIt
PmkyY19hZGFwdGVyLCAmenItPnY0bDJfZGV2KTsKKwl6ci0+aTJjX2FkYXB0ZXIuYWxnb19kYXRh
ID0gJnpyLT5pMmNfYWxnbzsKKwl6ci0+aTJjX2FkYXB0ZXIuZGV2LnBhcmVudCA9ICZ6ci0+cGNp
X2Rldi0+ZGV2OworCXJldHVybiBpMmNfYml0X2FkZF9idXMoJnpyLT5pMmNfYWRhcHRlcik7Cit9
CisKK3N0YXRpYyB2b2lkCit6b3Jhbl91bnJlZ2lzdGVyX2kyYyAoc3RydWN0IHpvcmFuICp6cikK
K3sKKwlpMmNfZGVsX2FkYXB0ZXIoJnpyLT5pMmNfYWRhcHRlcik7Cit9CisKKy8qIENoZWNrIGEg
em9yYW5fcGFyYW1zIHN0cnVjdCBmb3IgY29ycmVjdG5lc3MsIGluc2VydCBkZWZhdWx0IHBhcmFt
cyAqLworCitpbnQKK3pvcmFuX2NoZWNrX2pwZ19zZXR0aW5ncyAoc3RydWN0IHpvcmFuICAgICAg
ICAgICAgICAqenIsCisJCQkgIHN0cnVjdCB6b3Jhbl9qcGdfc2V0dGluZ3MgKnNldHRpbmdzLAor
CQkJICBpbnQgdHJ5KQoreworCWludCBlcnIgPSAwLCBlcnIwID0gMDsKKworCWRwcmludGsoNCwK
KwkJS0VSTl9ERUJVRworCQkiJXM6ICVzIC0gZGVjOiAlZCwgSGRjbTogJWQsIFZkY206ICVkLCBU
ZGNtOiAlZFxuIiwKKwkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBzZXR0aW5ncy0+ZGVjaW1h
dGlvbiwgc2V0dGluZ3MtPkhvckRjbSwKKwkJc2V0dGluZ3MtPlZlckRjbSwgc2V0dGluZ3MtPlRt
cERjbSk7CisJZHByaW50ayg0LAorCQlLRVJOX0RFQlVHCisJCSIlczogJXMgLSB4OiAlZCwgeTog
JWQsIHc6ICVkLCB5OiAlZFxuIiwKKwkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBzZXR0aW5n
cy0+aW1nX3gsIHNldHRpbmdzLT5pbWdfeSwKKwkJc2V0dGluZ3MtPmltZ193aWR0aCwgc2V0dGlu
Z3MtPmltZ19oZWlnaHQpOworCS8qIENoZWNrIGRlY2ltYXRpb24sIHNldCBkZWZhdWx0IHZhbHVl
cyBmb3IgZGVjaW1hdGlvbiA9IDEsIDIsIDQgKi8KKwlzd2l0Y2ggKHNldHRpbmdzLT5kZWNpbWF0
aW9uKSB7CisJY2FzZSAxOgorCisJCXNldHRpbmdzLT5Ib3JEY20gPSAxOworCQlzZXR0aW5ncy0+
VmVyRGNtID0gMTsKKwkJc2V0dGluZ3MtPlRtcERjbSA9IDE7CisJCXNldHRpbmdzLT5maWVsZF9w
ZXJfYnVmZiA9IDI7CisJCXNldHRpbmdzLT5pbWdfeCA9IDA7CisJCXNldHRpbmdzLT5pbWdfeSA9
IDA7CisJCXNldHRpbmdzLT5pbWdfd2lkdGggPSBCVVpfTUFYX1dJRFRIOworCQlzZXR0aW5ncy0+
aW1nX2hlaWdodCA9IEJVWl9NQVhfSEVJR0hUIC8gMjsKKwkJYnJlYWs7CisJY2FzZSAyOgorCisJ
CXNldHRpbmdzLT5Ib3JEY20gPSAyOworCQlzZXR0aW5ncy0+VmVyRGNtID0gMTsKKwkJc2V0dGlu
Z3MtPlRtcERjbSA9IDI7CisJCXNldHRpbmdzLT5maWVsZF9wZXJfYnVmZiA9IDE7CisJCXNldHRp
bmdzLT5pbWdfeCA9IChCVVpfTUFYX1dJRFRIID09IDcyMCkgPyA4IDogMDsKKwkJc2V0dGluZ3Mt
PmltZ195ID0gMDsKKwkJc2V0dGluZ3MtPmltZ193aWR0aCA9CisJCSAgICAoQlVaX01BWF9XSURU
SCA9PSA3MjApID8gNzA0IDogQlVaX01BWF9XSURUSDsKKwkJc2V0dGluZ3MtPmltZ19oZWlnaHQg
PSBCVVpfTUFYX0hFSUdIVCAvIDI7CisJCWJyZWFrOworCWNhc2UgNDoKKworCQlpZiAoenItPmNh
cmQudHlwZSA9PSBEQzEwX25ldykgeworCQkJZHByaW50aygxLAorCQkJCUtFUk5fREVCVUcKKwkJ
CQkiJXM6ICVzIC0gSERlYyBieSA0IGlzIG5vdCBzdXBwb3J0ZWQgb24gdGhlIERDMTBcbiIsCisJ
CQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJCWVycjArKzsKKwkJCWJyZWFrOworCQl9
CisKKwkJc2V0dGluZ3MtPkhvckRjbSA9IDQ7CisJCXNldHRpbmdzLT5WZXJEY20gPSAyOworCQlz
ZXR0aW5ncy0+VG1wRGNtID0gMjsKKwkJc2V0dGluZ3MtPmZpZWxkX3Blcl9idWZmID0gMTsKKwkJ
c2V0dGluZ3MtPmltZ194ID0gKEJVWl9NQVhfV0lEVEggPT0gNzIwKSA/IDggOiAwOworCQlzZXR0
aW5ncy0+aW1nX3kgPSAwOworCQlzZXR0aW5ncy0+aW1nX3dpZHRoID0KKwkJICAgIChCVVpfTUFY
X1dJRFRIID09IDcyMCkgPyA3MDQgOiBCVVpfTUFYX1dJRFRIOworCQlzZXR0aW5ncy0+aW1nX2hl
aWdodCA9IEJVWl9NQVhfSEVJR0hUIC8gMjsKKwkJYnJlYWs7CisJY2FzZSAwOgorCisJCS8qIFdl
IGhhdmUgdG8gY2hlY2sgdGhlIGRhdGEgdGhlIHVzZXIgaGFzIHNldCAqLworCisJCWlmIChzZXR0
aW5ncy0+SG9yRGNtICE9IDEgJiYgc2V0dGluZ3MtPkhvckRjbSAhPSAyICYmCisJCSAgICAoenIt
PmNhcmQudHlwZSA9PSBEQzEwX25ldyB8fCBzZXR0aW5ncy0+SG9yRGNtICE9IDQpKSB7CisJCQlz
ZXR0aW5ncy0+SG9yRGNtID0gY2xhbXAoc2V0dGluZ3MtPkhvckRjbSwgMSwgMik7CisJCQllcnIw
Kys7CisJCX0KKwkJaWYgKHNldHRpbmdzLT5WZXJEY20gIT0gMSAmJiBzZXR0aW5ncy0+VmVyRGNt
ICE9IDIpIHsKKwkJCXNldHRpbmdzLT5WZXJEY20gPSBjbGFtcChzZXR0aW5ncy0+VmVyRGNtLCAx
LCAyKTsKKwkJCWVycjArKzsKKwkJfQorCQlpZiAoc2V0dGluZ3MtPlRtcERjbSAhPSAxICYmIHNl
dHRpbmdzLT5UbXBEY20gIT0gMikgeworCQkJc2V0dGluZ3MtPlRtcERjbSA9IGNsYW1wKHNldHRp
bmdzLT5UbXBEY20sIDEsIDIpOworCQkJZXJyMCsrOworCQl9CisJCWlmIChzZXR0aW5ncy0+Zmll
bGRfcGVyX2J1ZmYgIT0gMSAmJgorCQkgICAgc2V0dGluZ3MtPmZpZWxkX3Blcl9idWZmICE9IDIp
IHsKKwkJCXNldHRpbmdzLT5maWVsZF9wZXJfYnVmZiA9IGNsYW1wKHNldHRpbmdzLT5maWVsZF9w
ZXJfYnVmZiwgMSwgMik7CisJCQllcnIwKys7CisJCX0KKwkJaWYgKHNldHRpbmdzLT5pbWdfeCA8
IDApIHsKKwkJCXNldHRpbmdzLT5pbWdfeCA9IDA7CisJCQllcnIwKys7CisJCX0KKwkJaWYgKHNl
dHRpbmdzLT5pbWdfeSA8IDApIHsKKwkJCXNldHRpbmdzLT5pbWdfeSA9IDA7CisJCQllcnIwKys7
CisJCX0KKwkJaWYgKHNldHRpbmdzLT5pbWdfd2lkdGggPCAwIHx8IHNldHRpbmdzLT5pbWdfd2lk
dGggPiBCVVpfTUFYX1dJRFRIKSB7CisJCQlzZXR0aW5ncy0+aW1nX3dpZHRoID0gY2xhbXAoc2V0
dGluZ3MtPmltZ193aWR0aCwgMCwgKGludClCVVpfTUFYX1dJRFRIKTsKKwkJCWVycjArKzsKKwkJ
fQorCQlpZiAoc2V0dGluZ3MtPmltZ19oZWlnaHQgPCAwIHx8IHNldHRpbmdzLT5pbWdfaGVpZ2h0
ID4gQlVaX01BWF9IRUlHSFQgLyAyKSB7CisJCQlzZXR0aW5ncy0+aW1nX2hlaWdodCA9IGNsYW1w
KHNldHRpbmdzLT5pbWdfaGVpZ2h0LCAwLCBCVVpfTUFYX0hFSUdIVCAvIDIpOworCQkJZXJyMCsr
OworCQl9CisJCWlmIChzZXR0aW5ncy0+aW1nX3ggKyBzZXR0aW5ncy0+aW1nX3dpZHRoID4gQlVa
X01BWF9XSURUSCkgeworCQkJc2V0dGluZ3MtPmltZ194ID0gQlVaX01BWF9XSURUSCAtIHNldHRp
bmdzLT5pbWdfd2lkdGg7CisJCQllcnIwKys7CisJCX0KKwkJaWYgKHNldHRpbmdzLT5pbWdfeSAr
IHNldHRpbmdzLT5pbWdfaGVpZ2h0ID4gQlVaX01BWF9IRUlHSFQgLyAyKSB7CisJCQlzZXR0aW5n
cy0+aW1nX3kgPSBCVVpfTUFYX0hFSUdIVCAvIDIgLSBzZXR0aW5ncy0+aW1nX2hlaWdodDsKKwkJ
CWVycjArKzsKKwkJfQorCQlpZiAoc2V0dGluZ3MtPmltZ193aWR0aCAlICgxNiAqIHNldHRpbmdz
LT5Ib3JEY20pICE9IDApIHsKKwkJCXNldHRpbmdzLT5pbWdfd2lkdGggLT0gc2V0dGluZ3MtPmlt
Z193aWR0aCAlICgxNiAqIHNldHRpbmdzLT5Ib3JEY20pOworCQkJaWYgKHNldHRpbmdzLT5pbWdf
d2lkdGggPT0gMCkKKwkJCQlzZXR0aW5ncy0+aW1nX3dpZHRoID0gMTYgKiBzZXR0aW5ncy0+SG9y
RGNtOworCQkJZXJyMCsrOworCQl9CisJCWlmIChzZXR0aW5ncy0+aW1nX2hlaWdodCAlICg4ICog
c2V0dGluZ3MtPlZlckRjbSkgIT0gMCkgeworCQkJc2V0dGluZ3MtPmltZ19oZWlnaHQgLT0gc2V0
dGluZ3MtPmltZ19oZWlnaHQgJSAoOCAqIHNldHRpbmdzLT5WZXJEY20pOworCQkJaWYgKHNldHRp
bmdzLT5pbWdfaGVpZ2h0ID09IDApCisJCQkJc2V0dGluZ3MtPmltZ19oZWlnaHQgPSA4ICogc2V0
dGluZ3MtPlZlckRjbTsKKwkJCWVycjArKzsKKwkJfQorCisJCWlmICghdHJ5ICYmIGVycjApIHsK
KwkJCWRwcmludGsoMSwKKwkJCQlLRVJOX0VSUgorCQkJCSIlczogJXMgLSBlcnJvciBpbiBwYXJh
bXMgZm9yIGRlY2ltYXRpb24gPSAwXG4iLAorCQkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXyk7
CisJCQllcnIrKzsKKwkJfQorCQlicmVhazsKKwlkZWZhdWx0OgorCQlkcHJpbnRrKDEsCisJCQlL
RVJOX0VSUgorCQkJIiVzOiAlcyAtIGRlY2ltYXRpb24gPSAlZCwgbXVzdCBiZSAwLCAxLCAyIG9y
IDRcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18sIHNldHRpbmdzLT5kZWNpbWF0aW9u
KTsKKwkJZXJyKys7CisJCWJyZWFrOworCX0KKworCWlmIChzZXR0aW5ncy0+anBnX2NvbXAucXVh
bGl0eSA+IDEwMCkKKwkJc2V0dGluZ3MtPmpwZ19jb21wLnF1YWxpdHkgPSAxMDA7CisJaWYgKHNl
dHRpbmdzLT5qcGdfY29tcC5xdWFsaXR5IDwgNSkKKwkJc2V0dGluZ3MtPmpwZ19jb21wLnF1YWxp
dHkgPSA1OworCWlmIChzZXR0aW5ncy0+anBnX2NvbXAuQVBQbiA8IDApCisJCXNldHRpbmdzLT5q
cGdfY29tcC5BUFBuID0gMDsKKwlpZiAoc2V0dGluZ3MtPmpwZ19jb21wLkFQUG4gPiAxNSkKKwkJ
c2V0dGluZ3MtPmpwZ19jb21wLkFQUG4gPSAxNTsKKwlpZiAoc2V0dGluZ3MtPmpwZ19jb21wLkFQ
UF9sZW4gPCAwKQorCQlzZXR0aW5ncy0+anBnX2NvbXAuQVBQX2xlbiA9IDA7CisJaWYgKHNldHRp
bmdzLT5qcGdfY29tcC5BUFBfbGVuID4gNjApCisJCXNldHRpbmdzLT5qcGdfY29tcC5BUFBfbGVu
ID0gNjA7CisJaWYgKHNldHRpbmdzLT5qcGdfY29tcC5DT01fbGVuIDwgMCkKKwkJc2V0dGluZ3Mt
PmpwZ19jb21wLkNPTV9sZW4gPSAwOworCWlmIChzZXR0aW5ncy0+anBnX2NvbXAuQ09NX2xlbiA+
IDYwKQorCQlzZXR0aW5ncy0+anBnX2NvbXAuQ09NX2xlbiA9IDYwOworCWlmIChlcnIpCisJCXJl
dHVybiAtRUlOVkFMOworCXJldHVybiAwOworfQorCit2b2lkCit6b3Jhbl9vcGVuX2luaXRfcGFy
YW1zIChzdHJ1Y3Qgem9yYW4gKnpyKQoreworCWludCBpOworCisJLyogVXNlciBtdXN0IGV4cGxp
Y2l0bHkgc2V0IGEgd2luZG93ICovCisJenItPm92ZXJsYXlfc2V0dGluZ3MuaXNfc2V0ID0gMDsK
Kwl6ci0+b3ZlcmxheV9tYXNrID0gTlVMTDsKKwl6ci0+b3ZlcmxheV9hY3RpdmUgPSBaT1JBTl9G
UkVFOworCisJenItPnY0bF9tZW1ncmFiX2FjdGl2ZSA9IDA7CisJenItPnY0bF9vdmVybGF5X2Fj
dGl2ZSA9IDA7CisJenItPnY0bF9ncmFiX2ZyYW1lID0gTk9fR1JBQl9BQ1RJVkU7CisJenItPnY0
bF9ncmFiX3NlcSA9IDA7CisJenItPnY0bF9zZXR0aW5ncy53aWR0aCA9IDE5MjsKKwl6ci0+djRs
X3NldHRpbmdzLmhlaWdodCA9IDE0NDsKKwl6ci0+djRsX3NldHRpbmdzLmZvcm1hdCA9ICZ6b3Jh
bl9mb3JtYXRzWzddOwkvKiBZVVkyIC0gWVVWLTQ6MjoyIHBhY2tlZCAqLworCXpyLT52NGxfc2V0
dGluZ3MuYnl0ZXNwZXJsaW5lID0KKwkgICAgenItPnY0bF9zZXR0aW5ncy53aWR0aCAqCisJICAg
ICgoenItPnY0bF9zZXR0aW5ncy5mb3JtYXQtPmRlcHRoICsgNykgLyA4KTsKKworCS8qIERNQSBy
aW5nIHN0dWZmIGZvciBWNEwgKi8KKwl6ci0+djRsX3BlbmRfdGFpbCA9IDA7CisJenItPnY0bF9w
ZW5kX2hlYWQgPSAwOworCXpyLT52NGxfc3luY190YWlsID0gMDsKKwl6ci0+djRsX2J1ZmZlcnMu
YWN0aXZlID0gWk9SQU5fRlJFRTsKKwlmb3IgKGkgPSAwOyBpIDwgVklERU9fTUFYX0ZSQU1FOyBp
KyspIHsKKwkJenItPnY0bF9idWZmZXJzLmJ1ZmZlcltpXS5zdGF0ZSA9IEJVWl9TVEFURV9VU0VS
OwkvKiBub3RoaW5nIGdvaW5nIG9uICovCisJfQorCXpyLT52NGxfYnVmZmVycy5hbGxvY2F0ZWQg
PSAwOworCisJZm9yIChpID0gMDsgaSA8IEJVWl9NQVhfRlJBTUU7IGkrKykgeworCQl6ci0+anBn
X2J1ZmZlcnMuYnVmZmVyW2ldLnN0YXRlID0gQlVaX1NUQVRFX1VTRVI7CS8qIG5vdGhpbmcgZ29p
bmcgb24gKi8KKwl9CisJenItPmpwZ19idWZmZXJzLmFjdGl2ZSA9IFpPUkFOX0ZSRUU7CisJenIt
PmpwZ19idWZmZXJzLmFsbG9jYXRlZCA9IDA7CisJLyogU2V0IG5lY2Vzc2FyeSBwYXJhbXMgYW5k
IGNhbGwgem9yYW5fY2hlY2tfanBnX3NldHRpbmdzIHRvIHNldCB0aGUgZGVmYXVsdHMgKi8KKwl6
ci0+anBnX3NldHRpbmdzLmRlY2ltYXRpb24gPSAxOworCXpyLT5qcGdfc2V0dGluZ3MuanBnX2Nv
bXAucXVhbGl0eSA9IDUwOwkvKiBkZWZhdWx0IGNvbXByZXNzaW9uIGZhY3RvciA4ICovCisJaWYg
KHpyLT5jYXJkLnR5cGUgIT0gQlVaKQorCQl6ci0+anBnX3NldHRpbmdzLm9kZF9ldmVuID0gMTsK
KwllbHNlCisJCXpyLT5qcGdfc2V0dGluZ3Mub2RkX2V2ZW4gPSAwOworCXpyLT5qcGdfc2V0dGlu
Z3MuanBnX2NvbXAuQVBQbiA9IDA7CisJenItPmpwZ19zZXR0aW5ncy5qcGdfY29tcC5BUFBfbGVu
ID0gMDsJLyogTm8gQVBQbiBtYXJrZXIgKi8KKwltZW1zZXQoenItPmpwZ19zZXR0aW5ncy5qcGdf
Y29tcC5BUFBfZGF0YSwgMCwKKwkgICAgICAgc2l6ZW9mKHpyLT5qcGdfc2V0dGluZ3MuanBnX2Nv
bXAuQVBQX2RhdGEpKTsKKwl6ci0+anBnX3NldHRpbmdzLmpwZ19jb21wLkNPTV9sZW4gPSAwOwkv
KiBObyBDT00gbWFya2VyICovCisJbWVtc2V0KHpyLT5qcGdfc2V0dGluZ3MuanBnX2NvbXAuQ09N
X2RhdGEsIDAsCisJICAgICAgIHNpemVvZih6ci0+anBnX3NldHRpbmdzLmpwZ19jb21wLkNPTV9k
YXRhKSk7CisJenItPmpwZ19zZXR0aW5ncy5qcGdfY29tcC5qcGVnX21hcmtlcnMgPQorCSAgICBW
NEwyX0pQRUdfTUFSS0VSX0RIVCB8IFY0TDJfSlBFR19NQVJLRVJfRFFUOworCWkgPSB6b3Jhbl9j
aGVja19qcGdfc2V0dGluZ3MoenIsICZ6ci0+anBnX3NldHRpbmdzLCAwKTsKKwlpZiAoaSkKKwkJ
ZHByaW50aygxLCBLRVJOX0VSUiAiJXM6ICVzIGludGVybmFsIGVycm9yXG4iLAorCQkJWlJfREVW
TkFNRSh6ciksIF9fZnVuY19fKTsKKworCWNsZWFyX2ludGVycnVwdF9jb3VudGVycyh6cik7CisJ
enItPnRlc3RpbmcgPSAwOworfQorCitzdGF0aWMgdm9pZCB0ZXN0X2ludGVycnVwdHMgKHN0cnVj
dCB6b3JhbiAqenIpCit7CisJREVGSU5FX1dBSVQod2FpdCk7CisJaW50IHRpbWVvdXQsIGljcjsK
KworCWNsZWFyX2ludGVycnVwdF9jb3VudGVycyh6cik7CisKKwl6ci0+dGVzdGluZyA9IDE7CisJ
aWNyID0gYnRyZWFkKFpSMzYwNTdfSUNSKTsKKwlidHdyaXRlKDB4NzgwMDAwMDAgfCBaUjM2MDU3
X0lDUl9JbnRQaW5FbiwgWlIzNjA1N19JQ1IpOworCXByZXBhcmVfdG9fd2FpdCgmenItPnRlc3Rf
cSwgJndhaXQsIFRBU0tfSU5URVJSVVBUSUJMRSk7CisJdGltZW91dCA9IHNjaGVkdWxlX3RpbWVv
dXQoSFopOworCWZpbmlzaF93YWl0KCZ6ci0+dGVzdF9xLCAmd2FpdCk7CisJYnR3cml0ZSgwLCBa
UjM2MDU3X0lDUik7CisJYnR3cml0ZSgweDc4MDAwMDAwLCBaUjM2MDU3X0lTUik7CisJenItPnRl
c3RpbmcgPSAwOworCWRwcmludGsoNSwgS0VSTl9JTkZPICIlczogVGVzdGluZyBpbnRlcnJ1cHRz
Li4uXG4iLCBaUl9ERVZOQU1FKHpyKSk7CisJaWYgKHRpbWVvdXQpIHsKKwkJZHByaW50aygxLCAi
OiB0aW1lIHNwZW50OiAlZFxuIiwgMSAqIEhaIC0gdGltZW91dCk7CisJfQorCWlmICh6cjM2MDY3
X2RlYnVnID4gMSkKKwkJcHJpbnRfaW50ZXJydXB0cyh6cik7CisJYnR3cml0ZShpY3IsIFpSMzYw
NTdfSUNSKTsKK30KKworc3RhdGljIGludCB6cjM2MDU3X2luaXQgKHN0cnVjdCB6b3JhbiAqenIp
Cit7CisJaW50IGosIGVycjsKKworCWRwcmludGsoMSwKKwkJS0VSTl9JTkZPCisJCSIlczogJXMg
LSBpbml0aWFsaXppbmcgY2FyZFslZF0sIHpyPSVwXG4iLAorCQlaUl9ERVZOQU1FKHpyKSwgX19m
dW5jX18sIHpyLT5pZCwgenIpOworCisJLyogZGVmYXVsdCBzZXR1cCBvZiBhbGwgcGFyYW1ldGVy
cyB3aGljaCB3aWxsIHBlcnNpc3QgYmV0d2VlbiBvcGVucyAqLworCXpyLT51c2VyID0gMDsKKwor
CWluaXRfd2FpdHF1ZXVlX2hlYWQoJnpyLT52NGxfY2FwcSk7CisJaW5pdF93YWl0cXVldWVfaGVh
ZCgmenItPmpwZ19jYXBxKTsKKwlpbml0X3dhaXRxdWV1ZV9oZWFkKCZ6ci0+dGVzdF9xKTsKKwl6
ci0+anBnX2J1ZmZlcnMuYWxsb2NhdGVkID0gMDsKKwl6ci0+djRsX2J1ZmZlcnMuYWxsb2NhdGVk
ID0gMDsKKworCXpyLT52YnVmX2Jhc2UgPSAodm9pZCAqKSB2aWRtZW07CisJenItPnZidWZfd2lk
dGggPSAwOworCXpyLT52YnVmX2hlaWdodCA9IDA7CisJenItPnZidWZfZGVwdGggPSAwOworCXpy
LT52YnVmX2J5dGVzcGVybGluZSA9IDA7CisKKwkvKiBBdm9pZCBub25zZW5zZSBzZXR0aW5ncyBm
cm9tIHVzZXIgZm9yIGRlZmF1bHQgaW5wdXQvbm9ybSAqLworCWlmIChkZWZhdWx0X25vcm0gPCAw
IHx8IGRlZmF1bHRfbm9ybSA+IDIpCisJCWRlZmF1bHRfbm9ybSA9IDA7CisJaWYgKGRlZmF1bHRf
bm9ybSA9PSAwKSB7CisJCXpyLT5ub3JtID0gVjRMMl9TVERfUEFMOworCQl6ci0+dGltaW5nID0g
enItPmNhcmQudHZuWzBdOworCX0gZWxzZSBpZiAoZGVmYXVsdF9ub3JtID09IDEpIHsKKwkJenIt
Pm5vcm0gPSBWNEwyX1NURF9OVFNDOworCQl6ci0+dGltaW5nID0genItPmNhcmQudHZuWzFdOwor
CX0gZWxzZSB7CisJCXpyLT5ub3JtID0gVjRMMl9TVERfU0VDQU07CisJCXpyLT50aW1pbmcgPSB6
ci0+Y2FyZC50dm5bMl07CisJfQorCWlmICh6ci0+dGltaW5nID09IE5VTEwpIHsKKwkJZHByaW50
aygxLAorCQkJS0VSTl9XQVJOSU5HCisJCQkiJXM6ICVzIC0gZGVmYXVsdCBUViBzdGFuZGFyZCBu
b3Qgc3VwcG9ydGVkIGJ5IGhhcmR3YXJlLiBQQUwgd2lsbCBiZSB1c2VkLlxuIiwKKwkJCVpSX0RF
Vk5BTUUoenIpLCBfX2Z1bmNfXyk7CisJCXpyLT5ub3JtID0gVjRMMl9TVERfUEFMOworCQl6ci0+
dGltaW5nID0genItPmNhcmQudHZuWzBdOworCX0KKworCWlmIChkZWZhdWx0X2lucHV0ID4genIt
PmNhcmQuaW5wdXRzLTEpIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9XQVJOSU5HCisJCQkiJXM6
IGRlZmF1bHRfaW5wdXQgdmFsdWUgJWQgb3V0IG9mIHJhbmdlICgwLSVkKVxuIiwKKwkJCVpSX0RF
Vk5BTUUoenIpLCBkZWZhdWx0X2lucHV0LCB6ci0+Y2FyZC5pbnB1dHMtMSk7CisJCWRlZmF1bHRf
aW5wdXQgPSAwOworCX0KKwl6ci0+aW5wdXQgPSBkZWZhdWx0X2lucHV0OworCisJLyogZGVmYXVs
dCBzZXR1cCAod2lsbCBiZSByZXBlYXRlZCBhdCBldmVyeSBvcGVuKSAqLworCXpvcmFuX29wZW5f
aW5pdF9wYXJhbXMoenIpOworCisJLyogYWxsb2NhdGUgbWVtb3J5ICpiZWZvcmUqIGRvaW5nIGFu
eXRoaW5nIHRvIHRoZSBoYXJkd2FyZQorCSAqIGluIGNhc2UgYWxsb2NhdGlvbiBmYWlscyAqLwor
CXpyLT5zdGF0X2NvbSA9IGt6YWxsb2MoQlVaX05VTV9TVEFUX0NPTSAqIDQsIEdGUF9LRVJORUwp
OworCXpyLT52aWRlb19kZXYgPSB2aWRlb19kZXZpY2VfYWxsb2MoKTsKKwlpZiAoIXpyLT5zdGF0
X2NvbSB8fCAhenItPnZpZGVvX2RldikgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgorCQkJ
IiVzOiAlcyAtIGttYWxsb2MgKFNUQVRfQ09NKSBmYWlsZWRcbiIsCisJCQlaUl9ERVZOQU1FKHpy
KSwgX19mdW5jX18pOworCQllcnIgPSAtRU5PTUVNOworCQlnb3RvIGV4aXRfZnJlZTsKKwl9CisJ
Zm9yIChqID0gMDsgaiA8IEJVWl9OVU1fU1RBVF9DT007IGorKykgeworCQl6ci0+c3RhdF9jb21b
al0gPSBjcHVfdG9fbGUzMigxKTsgLyogbWFyayBhcyB1bmF2YWlsYWJsZSB0byB6cjM2MDU3ICov
CisJfQorCisJLyoKKwkgKiAgIE5vdyBhZGQgdGhlIHRlbXBsYXRlIGFuZCByZWdpc3RlciB0aGUg
ZGV2aWNlIHVuaXQuCisJICovCisJKnpyLT52aWRlb19kZXYgPSB6b3Jhbl90ZW1wbGF0ZTsKKwl6
ci0+dmlkZW9fZGV2LT52NGwyX2RldiA9ICZ6ci0+djRsMl9kZXY7CisJenItPnZpZGVvX2Rldi0+
bG9jayA9ICZ6ci0+bG9jazsKKwlzdHJzY3B5KHpyLT52aWRlb19kZXYtPm5hbWUsIFpSX0RFVk5B
TUUoenIpLCBzaXplb2YoenItPnZpZGVvX2Rldi0+bmFtZSkpOworCS8qIEl0J3Mgbm90IGEgbWVt
Mm1lbSBkZXZpY2UsIGJ1dCB5b3UgY2FuIGJvdGggY2FwdHVyZSBhbmQgb3V0cHV0IGZyb20KKwkg
ICBvbmUgYW5kIHRoZSBzYW1lIGRldmljZS4gVGhpcyBzaG91bGQgcmVhbGx5IGJlIHNwbGl0IHVw
IGludG8gdHdvCisJICAgZGV2aWNlIG5vZGVzLCBidXQgdGhhdCdzIGEgam9iIGZvciBhbm90aGVy
IGRheS4gKi8KKwl6ci0+dmlkZW9fZGV2LT52ZmxfZGlyID0gVkZMX0RJUl9NMk07CisJZXJyID0g
dmlkZW9fcmVnaXN0ZXJfZGV2aWNlKHpyLT52aWRlb19kZXYsIFZGTF9UWVBFX0dSQUJCRVIsIHZp
ZGVvX25yW3pyLT5pZF0pOworCWlmIChlcnIgPCAwKQorCQlnb3RvIGV4aXRfZnJlZTsKKwl2aWRl
b19zZXRfZHJ2ZGF0YSh6ci0+dmlkZW9fZGV2LCB6cik7CisKKwl6b3Jhbl9pbml0X2hhcmR3YXJl
KHpyKTsKKwlpZiAoenIzNjA2N19kZWJ1ZyA+IDIpCisJCWRldGVjdF9ndWVzdF9hY3Rpdml0eSh6
cik7CisJdGVzdF9pbnRlcnJ1cHRzKHpyKTsKKwlpZiAoIXBhc3NfdGhyb3VnaCkgeworCQlkZWNv
ZGVyX2NhbGwoenIsIHZpZGVvLCBzX3N0cmVhbSwgMCk7CisJCWVuY29kZXJfY2FsbCh6ciwgdmlk
ZW8sIHNfcm91dGluZywgMiwgMCwgMCk7CisJfQorCisJenItPnpvcmFuX3Byb2MgPSBOVUxMOwor
CXpyLT5pbml0aWFsaXplZCA9IDE7CisJcmV0dXJuIDA7CisKK2V4aXRfZnJlZToKKwlrZnJlZSh6
ci0+c3RhdF9jb20pOworCWtmcmVlKHpyLT52aWRlb19kZXYpOworCXJldHVybiBlcnI7Cit9CisK
K3N0YXRpYyB2b2lkIHpvcmFuX3JlbW92ZShzdHJ1Y3QgcGNpX2RldiAqcGRldikKK3sKKwlzdHJ1
Y3QgdjRsMl9kZXZpY2UgKnY0bDJfZGV2ID0gZGV2X2dldF9kcnZkYXRhKCZwZGV2LT5kZXYpOwor
CXN0cnVjdCB6b3JhbiAqenIgPSB0b196b3Jhbih2NGwyX2Rldik7CisKKwlpZiAoIXpyLT5pbml0
aWFsaXplZCkKKwkJZ290byBleGl0X2ZyZWU7CisKKwkvKiB1bnJlZ2lzdGVyIHZpZGVvY29kZWMg
YnVzICovCisJaWYgKHpyLT5jb2RlYykgeworCQlzdHJ1Y3QgdmlkZW9jb2RlY19tYXN0ZXIgKm1h
c3RlciA9IHpyLT5jb2RlYy0+bWFzdGVyX2RhdGE7CisKKwkJdmlkZW9jb2RlY19kZXRhY2goenIt
PmNvZGVjKTsKKwkJa2ZyZWUobWFzdGVyKTsKKwl9CisJaWYgKHpyLT52ZmUpIHsKKwkJc3RydWN0
IHZpZGVvY29kZWNfbWFzdGVyICptYXN0ZXIgPSB6ci0+dmZlLT5tYXN0ZXJfZGF0YTsKKworCQl2
aWRlb2NvZGVjX2RldGFjaCh6ci0+dmZlKTsKKwkJa2ZyZWUobWFzdGVyKTsKKwl9CisKKwkvKiB1
bnJlZ2lzdGVyIGkyYyBidXMgKi8KKwl6b3Jhbl91bnJlZ2lzdGVyX2kyYyh6cik7CisJLyogZGlz
YWJsZSBQQ0kgYnVzLW1hc3RlcmluZyAqLworCXpvcmFuX3NldF9wY2lfbWFzdGVyKHpyLCAwKTsK
KwkvKiBwdXQgY2hpcCBpbnRvIHJlc2V0ICovCisJYnR3cml0ZSgwLCBaUjM2MDU3X1NQR1BQQ1Ip
OworCWZyZWVfaXJxKHpyLT5wY2lfZGV2LT5pcnEsIHpyKTsKKwkvKiB1bm1hcCBhbmQgZnJlZSBt
ZW1vcnkgKi8KKwlrZnJlZSh6ci0+c3RhdF9jb20pOworCXpvcmFuX3Byb2NfY2xlYW51cCh6cik7
CisJaW91bm1hcCh6ci0+enIzNjA1N19tZW0pOworCXBjaV9kaXNhYmxlX2RldmljZSh6ci0+cGNp
X2Rldik7CisJdmlkZW9fdW5yZWdpc3Rlcl9kZXZpY2UoenItPnZpZGVvX2Rldik7CitleGl0X2Zy
ZWU6CisJdjRsMl9jdHJsX2hhbmRsZXJfZnJlZSgmenItPmhkbCk7CisJdjRsMl9kZXZpY2VfdW5y
ZWdpc3RlcigmenItPnY0bDJfZGV2KTsKKwlrZnJlZSh6cik7Cit9CisKK3ZvaWQKK3pvcmFuX3Zk
ZXZfcmVsZWFzZSAoc3RydWN0IHZpZGVvX2RldmljZSAqdmRldikKK3sKKwlrZnJlZSh2ZGV2KTsK
K30KKworc3RhdGljIHN0cnVjdCB2aWRlb2NvZGVjX21hc3RlciAqem9yYW5fc2V0dXBfdmlkZW9j
b2RlYyhzdHJ1Y3Qgem9yYW4gKnpyLAorCQkJCQkJCWludCB0eXBlKQoreworCXN0cnVjdCB2aWRl
b2NvZGVjX21hc3RlciAqbSA9IE5VTEw7CisKKwltID0ga21hbGxvYyhzaXplb2Yoc3RydWN0IHZp
ZGVvY29kZWNfbWFzdGVyKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFtKSB7CisJCWRwcmludGsoMSwg
S0VSTl9FUlIgIiVzOiAlcyAtIG5vIG1lbW9yeVxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1
bmNfXyk7CisJCXJldHVybiBtOworCX0KKworCS8qIG1hZ2ljIGFuZCB0eXBlIGFyZSB1bnVzZWQg
Zm9yIG1hc3RlciBzdHJ1Y3QuIE1ha2VzIHNlbnNlIG9ubHkgYXQKKwkgICBjb2RlYyBzdHJ1Y3Rz
LgorCSAgIEluIHRoZSBwYXN0LCAudHlwZSB3ZXJlIGluaXRpYWxpemVkIHRvIHRoZSBvbGQgVjRM
MSAuaGFyZHdhcmUKKwkgICB2YWx1ZSwgYXMgVklEX0hBUkRXQVJFX1pSMzYwNjcKKwkgKi8KKwlt
LT5tYWdpYyA9IDBMOworCW0tPnR5cGUgPSAwOworCisJbS0+ZmxhZ3MgPSBDT0RFQ19GTEFHX0VO
Q09ERVIgfCBDT0RFQ19GTEFHX0RFQ09ERVI7CisJc3Ryc2NweShtLT5uYW1lLCBaUl9ERVZOQU1F
KHpyKSwgc2l6ZW9mKG0tPm5hbWUpKTsKKwltLT5kYXRhID0genI7CisKKwlzd2l0Y2ggKHR5cGUp
CisJeworCWNhc2UgQ09ERUNfVFlQRV9aUjM2MDYwOgorCQltLT5yZWFkcmVnID0genIzNjA2MF9y
ZWFkOworCQltLT53cml0ZXJlZyA9IHpyMzYwNjBfd3JpdGU7CisJCW0tPmZsYWdzIHw9IENPREVD
X0ZMQUdfSlBFRyB8IENPREVDX0ZMQUdfVkZFOworCQlicmVhazsKKwljYXNlIENPREVDX1RZUEVf
WlIzNjA1MDoKKwkJbS0+cmVhZHJlZyA9IHpyMzYwNTBfcmVhZDsKKwkJbS0+d3JpdGVyZWcgPSB6
cjM2MDUwX3dyaXRlOworCQltLT5mbGFncyB8PSBDT0RFQ19GTEFHX0pQRUc7CisJCWJyZWFrOwor
CWNhc2UgQ09ERUNfVFlQRV9aUjM2MDE2OgorCQltLT5yZWFkcmVnID0genIzNjAxNl9yZWFkOwor
CQltLT53cml0ZXJlZyA9IHpyMzYwMTZfd3JpdGU7CisJCW0tPmZsYWdzIHw9IENPREVDX0ZMQUdf
VkZFOworCQlicmVhazsKKwl9CisKKwlyZXR1cm4gbTsKK30KKworc3RhdGljIHZvaWQgem9yYW5f
c3ViZGV2X25vdGlmeShzdHJ1Y3QgdjRsMl9zdWJkZXYgKnNkLCB1bnNpZ25lZCBpbnQgY21kLCB2
b2lkICphcmcpCit7CisJc3RydWN0IHpvcmFuICp6ciA9IHRvX3pvcmFuKHNkLT52NGwyX2Rldik7
CisKKwkvKiBCdDgxOSBuZWVkcyB0byByZXNldCBpdHMgRklGTyBidWZmZXIgdXNpbmcgI0ZSU1Qg
cGluIGFuZAorCSAgIExNTDMzIGNhcmQgdXNlcyBHUElPKDcpIGZvciB0aGF0LiAqLworCWlmIChj
bWQgPT0gQlQ4MTlfRklGT19SRVNFVF9MT1cpCisJCUdQSU8oenIsIDcsIDApOworCWVsc2UgaWYg
KGNtZCA9PSBCVDgxOV9GSUZPX1JFU0VUX0hJR0gpCisJCUdQSU8oenIsIDcsIDEpOworfQorCisv
KgorICogICBTY2FuIGZvciBhIEJ1eiBjYXJkIChhY3R1YWxseSBmb3IgdGhlIFBDSSBjb250cm9s
bGVyIFpSMzYwNTcpLAorICogICByZXF1ZXN0IHRoZSBpcnEgYW5kIG1hcCB0aGUgaW8gbWVtb3J5
CisgKi8KK3N0YXRpYyBpbnQgem9yYW5fcHJvYmUoc3RydWN0IHBjaV9kZXYgKnBkZXYsIGNvbnN0
IHN0cnVjdCBwY2lfZGV2aWNlX2lkICplbnQpCit7CisJdW5zaWduZWQgY2hhciBsYXRlbmN5LCBu
ZWVkX2xhdGVuY3k7CisJc3RydWN0IHpvcmFuICp6cjsKKwlpbnQgcmVzdWx0OworCXN0cnVjdCB2
aWRlb2NvZGVjX21hc3RlciAqbWFzdGVyX3ZmZSA9IE5VTEw7CisJc3RydWN0IHZpZGVvY29kZWNf
bWFzdGVyICptYXN0ZXJfY29kZWMgPSBOVUxMOworCWludCBjYXJkX251bTsKKwljaGFyICpjb2Rl
Y19uYW1lLCAqdmZlX25hbWU7CisJdW5zaWduZWQgaW50IG5yOworCisKKwluciA9IHpvcmFuX251
bSsrOworCWlmIChuciA+PSBCVVpfTUFYKSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIgIiVzOiBk
cml2ZXIgbGltaXRlZCB0byAlZCBjYXJkKHMpIG1heGltdW1cbiIsCisJCQlaT1JBTl9OQU1FLCBC
VVpfTUFYKTsKKwkJcmV0dXJuIC1FTk9FTlQ7CisJfQorCisJenIgPSBremFsbG9jKHNpemVvZihz
dHJ1Y3Qgem9yYW4pLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXpyKSB7CisJCWRwcmludGsoMSwgS0VS
Tl9FUlIgIiVzOiAlcyAtIGt6YWxsb2MgZmFpbGVkXG4iLAorCQkJWk9SQU5fTkFNRSwgX19mdW5j
X18pOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisJenItPnY0bDJfZGV2Lm5vdGlmeSA9IHpvcmFu
X3N1YmRldl9ub3RpZnk7CisJaWYgKHY0bDJfZGV2aWNlX3JlZ2lzdGVyKCZwZGV2LT5kZXYsICZ6
ci0+djRsMl9kZXYpKQorCQlnb3RvIHpyX2ZyZWVfbWVtOworCXpyLT5wY2lfZGV2ID0gcGRldjsK
Kwl6ci0+aWQgPSBucjsKKwlzbnByaW50ZihaUl9ERVZOQU1FKHpyKSwgc2l6ZW9mKFpSX0RFVk5B
TUUoenIpKSwgIk1KUEVHWyV1XSIsIHpyLT5pZCk7CisJaWYgKHY0bDJfY3RybF9oYW5kbGVyX2lu
aXQoJnpyLT5oZGwsIDEwKSkKKwkJZ290byB6cl91bnJlZzsKKwl6ci0+djRsMl9kZXYuY3RybF9o
YW5kbGVyID0gJnpyLT5oZGw7CisJc3Bpbl9sb2NrX2luaXQoJnpyLT5zcGlubG9jayk7CisJbXV0
ZXhfaW5pdCgmenItPmxvY2spOworCWlmIChwY2lfZW5hYmxlX2RldmljZShwZGV2KSkKKwkJZ290
byB6cl91bnJlZzsKKwl6ci0+cmV2aXNpb24gPSB6ci0+cGNpX2Rldi0+cmV2aXNpb247CisKKwlk
cHJpbnRrKDEsCisJCUtFUk5fSU5GTworCQkiJXM6IFpvcmFuIFpSMzYwJWM3IChyZXYgJWQpLCBp
cnE6ICVkLCBtZW1vcnk6IDB4JTA4bGx4XG4iLAorCQlaUl9ERVZOQU1FKHpyKSwgenItPnJldmlz
aW9uIDwgMiA/ICc1JyA6ICc2JywgenItPnJldmlzaW9uLAorCQl6ci0+cGNpX2Rldi0+aXJxLCAo
dWludDY0X3QpcGNpX3Jlc291cmNlX3N0YXJ0KHpyLT5wY2lfZGV2LCAwKSk7CisJaWYgKHpyLT5y
ZXZpc2lvbiA+PSAyKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fSU5GTworCQkJIiVzOiBTdWJz
eXN0ZW0gdmVuZG9yPTB4JTA0eCBpZD0weCUwNHhcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgenIt
PnBjaV9kZXYtPnN1YnN5c3RlbV92ZW5kb3IsCisJCQl6ci0+cGNpX2Rldi0+c3Vic3lzdGVtX2Rl
dmljZSk7CisJfQorCisJLyogVXNlIGF1dG8tZGV0ZWN0ZWQgY2FyZCB0eXBlPyAqLworCWlmIChj
YXJkW25yXSA9PSAtMSkgeworCQlpZiAoenItPnJldmlzaW9uIDwgMikgeworCQkJZHByaW50aygx
LAorCQkJCUtFUk5fRVJSCisJCQkJIiVzOiBObyBjYXJkIHR5cGUgc3BlY2lmaWVkLCBwbGVhc2Ug
dXNlIHRoZSBjYXJkPVggbW9kdWxlIHBhcmFtZXRlclxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSk7
CisJCQlkcHJpbnRrKDEsCisJCQkJS0VSTl9FUlIKKwkJCQkiJXM6IEl0IGlzIG5vdCBwb3NzaWJs
ZSB0byBhdXRvLWRldGVjdCBaUjM2MDU3IGJhc2VkIGNhcmRzXG4iLAorCQkJCVpSX0RFVk5BTUUo
enIpKTsKKwkJCWdvdG8genJfdW5yZWc7CisJCX0KKworCQljYXJkX251bSA9IGVudC0+ZHJpdmVy
X2RhdGE7CisJCWlmIChjYXJkX251bSA+PSBOVU1fQ0FSRFMpIHsKKwkJCWRwcmludGsoMSwKKwkJ
CQlLRVJOX0VSUgorCQkJCSIlczogVW5rbm93biBjYXJkLCB0cnkgc3BlY2lmeWluZyBjYXJkPVgg
bW9kdWxlIHBhcmFtZXRlclxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSk7CisJCQlnb3RvIHpyX3Vu
cmVnOworCQl9CisJCWRwcmludGsoMywKKwkJCUtFUk5fREVCVUcKKwkJCSIlczogJXMoKSAtIGNh
cmQgJXMgZGV0ZWN0ZWRcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18sIHpvcmFuX2Nh
cmRzW2NhcmRfbnVtXS5uYW1lKTsKKwl9IGVsc2UgeworCQljYXJkX251bSA9IGNhcmRbbnJdOwor
CQlpZiAoY2FyZF9udW0gPj0gTlVNX0NBUkRTIHx8IGNhcmRfbnVtIDwgMCkgeworCQkJZHByaW50
aygxLAorCQkJCUtFUk5fRVJSCisJCQkJIiVzOiBVc2VyIHNwZWNpZmllZCBjYXJkIHR5cGUgJWQg
b3V0IG9mIHJhbmdlICgwIC4uICVkKVxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgY2FyZF9udW0s
IE5VTV9DQVJEUyAtIDEpOworCQkJZ290byB6cl91bnJlZzsKKwkJfQorCX0KKworCS8qIGV2ZW4g
dGhvdWdoIHdlIG1ha2UgdGhpcyBhIG5vbiBwb2ludGVyIGFuZCB0aHVzCisJICogdGhlb3JldGlj
YWxseSBhbGxvdyBmb3IgbWFraW5nIGNoYW5nZXMgdG8gdGhpcyBzdHJ1Y3QKKwkgKiBvbiBhIHBl
ci1pbmRpdmlkdWFsIGNhcmQgYmFzaXMgYXQgcnVudGltZSwgdGhpcyBpcworCSAqIHN0cm9uZ2x5
IGRpc2NvdXJhZ2VkLiBUaGlzIHN0cnVjdHVyZSBpcyBpbnRlbmRlZCB0bworCSAqIGtlZXAgZ2Vu
ZXJhbCBjYXJkIGluZm9ybWF0aW9uLCBubyBzZXR0aW5ncyBvciBhbnl0aGluZyAqLworCXpyLT5j
YXJkID0gem9yYW5fY2FyZHNbY2FyZF9udW1dOworCXNucHJpbnRmKFpSX0RFVk5BTUUoenIpLCBz
aXplb2YoWlJfREVWTkFNRSh6cikpLAorCQkgIiVzWyV1XSIsIHpyLT5jYXJkLm5hbWUsIHpyLT5p
ZCk7CisKKwl6ci0+enIzNjA1N19tZW0gPSBwY2lfaW9yZW1hcF9iYXIoenItPnBjaV9kZXYsIDAp
OworCWlmICghenItPnpyMzYwNTdfbWVtKSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIgIiVzOiAl
cygpIC0gaW9yZW1hcCBmYWlsZWRcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOwor
CQlnb3RvIHpyX3VucmVnOworCX0KKworCXJlc3VsdCA9IHJlcXVlc3RfaXJxKHpyLT5wY2lfZGV2
LT5pcnEsIHpvcmFuX2lycSwKKwkJCSAgICAgSVJRRl9TSEFSRUQsIFpSX0RFVk5BTUUoenIpLCB6
cik7CisJaWYgKHJlc3VsdCA8IDApIHsKKwkJaWYgKHJlc3VsdCA9PSAtRUlOVkFMKSB7CisJCQlk
cHJpbnRrKDEsCisJCQkJS0VSTl9FUlIKKwkJCQkiJXM6ICVzIC0gYmFkIGlycSBudW1iZXIgb3Ig
aGFuZGxlclxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQl9IGVsc2UgaWYg
KHJlc3VsdCA9PSAtRUJVU1kpIHsKKwkJCWRwcmludGsoMSwKKwkJCQlLRVJOX0VSUgorCQkJCSIl
czogJXMgLSBJUlEgJWQgYnVzeSwgY2hhbmdlIHlvdXIgUG5QIGNvbmZpZyBpbiBCSU9TXG4iLAor
CQkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXywgenItPnBjaV9kZXYtPmlycSk7CisJCX0gZWxz
ZSB7CisJCQlkcHJpbnRrKDEsCisJCQkJS0VSTl9FUlIKKwkJCQkiJXM6ICVzIC0gY2FuJ3QgYXNz
aWduIGlycSwgZXJyb3IgY29kZSAlZFxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18s
IHJlc3VsdCk7CisJCX0KKwkJZ290byB6cl91bm1hcDsKKwl9CisKKwkvKiBzZXQgUENJIGxhdGVu
Y3kgdGltZXIgKi8KKwlwY2lfcmVhZF9jb25maWdfYnl0ZSh6ci0+cGNpX2RldiwgUENJX0xBVEVO
Q1lfVElNRVIsCisJCQkgICAgICZsYXRlbmN5KTsKKwluZWVkX2xhdGVuY3kgPSB6ci0+cmV2aXNp
b24gPiAxID8gMzIgOiA0ODsKKwlpZiAobGF0ZW5jeSAhPSBuZWVkX2xhdGVuY3kpIHsKKwkJZHBy
aW50aygyLCBLRVJOX0lORk8gIiVzOiBDaGFuZ2luZyBQQ0kgbGF0ZW5jeSBmcm9tICVkIHRvICVk
XG4iLAorCQkJWlJfREVWTkFNRSh6ciksIGxhdGVuY3ksIG5lZWRfbGF0ZW5jeSk7CisJCXBjaV93
cml0ZV9jb25maWdfYnl0ZSh6ci0+cGNpX2RldiwgUENJX0xBVEVOQ1lfVElNRVIsCisJCQkJICAg
ICAgbmVlZF9sYXRlbmN5KTsKKwl9CisKKwl6cjM2MDU3X3Jlc3RhcnQoenIpOworCS8qIGkyYyAq
LworCWRwcmludGsoMiwgS0VSTl9JTkZPICIlczogSW5pdGlhbGl6aW5nIGkyYyBidXMuLi5cbiIs
CisJCVpSX0RFVk5BTUUoenIpKTsKKworCWlmICh6b3Jhbl9yZWdpc3Rlcl9pMmMoenIpIDwgMCkg
eworCQlkcHJpbnRrKDEsIEtFUk5fRVJSICIlczogJXMgLSBjYW4ndCBpbml0aWFsaXplIGkyYyBi
dXNcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQlnb3RvIHpyX2ZyZWVfaXJx
OworCX0KKworCXpyLT5kZWNvZGVyID0gdjRsMl9pMmNfbmV3X3N1YmRldigmenItPnY0bDJfZGV2
LAorCQkmenItPmkyY19hZGFwdGVyLCB6ci0+Y2FyZC5pMmNfZGVjb2RlciwKKwkJMCwgenItPmNh
cmQuYWRkcnNfZGVjb2Rlcik7CisKKwlpZiAoenItPmNhcmQuaTJjX2VuY29kZXIpCisJCXpyLT5l
bmNvZGVyID0gdjRsMl9pMmNfbmV3X3N1YmRldigmenItPnY0bDJfZGV2LAorCQkJJnpyLT5pMmNf
YWRhcHRlciwgenItPmNhcmQuaTJjX2VuY29kZXIsCisJCQkwLCB6ci0+Y2FyZC5hZGRyc19lbmNv
ZGVyKTsKKworCWRwcmludGsoMiwKKwkJS0VSTl9JTkZPICIlczogSW5pdGlhbGl6aW5nIHZpZGVv
Y29kZWMgYnVzLi4uXG4iLAorCQlaUl9ERVZOQU1FKHpyKSk7CisKKwlpZiAoenItPmNhcmQudmlk
ZW9fY29kZWMpIHsKKwkJY29kZWNfbmFtZSA9IGNvZGVjaWRfdG9fbW9kdWxlbmFtZSh6ci0+Y2Fy
ZC52aWRlb19jb2RlYyk7CisJCWlmIChjb2RlY19uYW1lKSB7CisJCQlyZXN1bHQgPSByZXF1ZXN0
X21vZHVsZShjb2RlY19uYW1lKTsKKwkJCWlmIChyZXN1bHQpIHsKKwkJCQlkcHJpbnRrKDEsCisJ
CQkJCUtFUk5fRVJSCisJCQkJCSIlczogZmFpbGVkIHRvIGxvYWQgbW9kdWxlcyAlczogJWRcbiIs
CisJCQkJCVpSX0RFVk5BTUUoenIpLCBjb2RlY19uYW1lLCByZXN1bHQpOworCQkJfQorCQl9CisJ
fQorCWlmICh6ci0+Y2FyZC52aWRlb192ZmUpIHsKKwkJdmZlX25hbWUgPSBjb2RlY2lkX3RvX21v
ZHVsZW5hbWUoenItPmNhcmQudmlkZW9fdmZlKTsKKwkJaWYgKHZmZV9uYW1lKSB7CisJCQlyZXN1
bHQgPSByZXF1ZXN0X21vZHVsZSh2ZmVfbmFtZSk7CisJCQlpZiAocmVzdWx0IDwgMCkgeworCQkJ
CWRwcmludGsoMSwKKwkJCQkJS0VSTl9FUlIKKwkJCQkJIiVzOiBmYWlsZWQgdG8gbG9hZCBtb2R1
bGVzICVzOiAlZFxuIiwKKwkJCQkJWlJfREVWTkFNRSh6ciksIHZmZV9uYW1lLCByZXN1bHQpOwor
CQkJfQorCQl9CisJfQorCisJLyogcmVzZXQgSlBFRyBjb2RlYyAqLworCWpwZWdfY29kZWNfc2xl
ZXAoenIsIDEpOworCWpwZWdfY29kZWNfcmVzZXQoenIpOworCS8qIHZpZGVvIGJ1cyBlbmFibGVk
ICovCisJLyogZGlzcGxheSBjb2RlYyByZXZpc2lvbiAqLworCWlmICh6ci0+Y2FyZC52aWRlb19j
b2RlYyAhPSAwKSB7CisJCW1hc3Rlcl9jb2RlYyA9IHpvcmFuX3NldHVwX3ZpZGVvY29kZWMoenIs
IHpyLT5jYXJkLnZpZGVvX2NvZGVjKTsKKwkJaWYgKCFtYXN0ZXJfY29kZWMpCisJCQlnb3RvIHpy
X3VucmVnX2kyYzsKKwkJenItPmNvZGVjID0gdmlkZW9jb2RlY19hdHRhY2gobWFzdGVyX2NvZGVj
KTsKKwkJaWYgKCF6ci0+Y29kZWMpIHsKKwkJCWRwcmludGsoMSwgS0VSTl9FUlIgIiVzOiAlcyAt
IG5vIGNvZGVjIGZvdW5kXG4iLAorCQkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXyk7CisJCQln
b3RvIHpyX2ZyZWVfY29kZWM7CisJCX0KKwkJaWYgKHpyLT5jb2RlYy0+dHlwZSAhPSB6ci0+Y2Fy
ZC52aWRlb19jb2RlYykgeworCQkJZHByaW50aygxLCBLRVJOX0VSUiAiJXM6ICVzIC0gd3Jvbmcg
Y29kZWNcbiIsCisJCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJCWdvdG8genJfZGV0
YWNoX2NvZGVjOworCQl9CisJfQorCWlmICh6ci0+Y2FyZC52aWRlb192ZmUgIT0gMCkgeworCQlt
YXN0ZXJfdmZlID0gem9yYW5fc2V0dXBfdmlkZW9jb2RlYyh6ciwgenItPmNhcmQudmlkZW9fdmZl
KTsKKwkJaWYgKCFtYXN0ZXJfdmZlKQorCQkJZ290byB6cl9kZXRhY2hfY29kZWM7CisJCXpyLT52
ZmUgPSB2aWRlb2NvZGVjX2F0dGFjaChtYXN0ZXJfdmZlKTsKKwkJaWYgKCF6ci0+dmZlKSB7CisJ
CQlkcHJpbnRrKDEsIEtFUk5fRVJSICIlczogJXMgLSBubyBWRkUgZm91bmRcbiIsCisJCQkJWlJf
REVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJCWdvdG8genJfZnJlZV92ZmU7CisJCX0KKwkJaWYg
KHpyLT52ZmUtPnR5cGUgIT0genItPmNhcmQudmlkZW9fdmZlKSB7CisJCQlkcHJpbnRrKDEsIEtF
Uk5fRVJSICIlczogJXMgPSB3cm9uZyBWRkVcbiIsCisJCQkJWlJfREVWTkFNRSh6ciksIF9fZnVu
Y19fKTsKKwkJCWdvdG8genJfZGV0YWNoX3ZmZTsKKwkJfQorCX0KKworCS8qIHRha2UgY2FyZSBv
ZiBOYXRvbWEgY2hpcHNldCBhbmQgYSByZXZpc2lvbiAxIHpyMzYwNTcgKi8KKwlpZiAoKHBjaV9w
Y2lfcHJvYmxlbXMgJiBQQ0lQQ0lfTkFUT01BKSAmJiB6ci0+cmV2aXNpb24gPD0gMSkgeworCQl6
ci0+anBnX2J1ZmZlcnMubmVlZF9jb250aWd1b3VzID0gMTsKKwkJZHByaW50aygxLCBLRVJOX0lO
Rk8KKwkJCSIlczogWlIzNjA1Ny9OYXRvbWEgYnVnLCBtYXguIGJ1ZmZlciBzaXplIGlzIDEyOEtc
biIsCisJCQlaUl9ERVZOQU1FKHpyKSk7CisJfQorCisJaWYgKHpyMzYwNTdfaW5pdCh6cikgPCAw
KQorCQlnb3RvIHpyX2RldGFjaF92ZmU7CisKKwl6b3Jhbl9wcm9jX2luaXQoenIpOworCisJcmV0
dXJuIDA7CisKK3pyX2RldGFjaF92ZmU6CisJdmlkZW9jb2RlY19kZXRhY2goenItPnZmZSk7Cit6
cl9mcmVlX3ZmZToKKwlrZnJlZShtYXN0ZXJfdmZlKTsKK3pyX2RldGFjaF9jb2RlYzoKKwl2aWRl
b2NvZGVjX2RldGFjaCh6ci0+Y29kZWMpOworenJfZnJlZV9jb2RlYzoKKwlrZnJlZShtYXN0ZXJf
Y29kZWMpOworenJfdW5yZWdfaTJjOgorCXpvcmFuX3VucmVnaXN0ZXJfaTJjKHpyKTsKK3pyX2Zy
ZWVfaXJxOgorCWJ0d3JpdGUoMCwgWlIzNjA1N19TUEdQUENSKTsKKwlmcmVlX2lycSh6ci0+cGNp
X2Rldi0+aXJxLCB6cik7Cit6cl91bm1hcDoKKwlpb3VubWFwKHpyLT56cjM2MDU3X21lbSk7Cit6
cl91bnJlZzoKKwl2NGwyX2N0cmxfaGFuZGxlcl9mcmVlKCZ6ci0+aGRsKTsKKwl2NGwyX2Rldmlj
ZV91bnJlZ2lzdGVyKCZ6ci0+djRsMl9kZXYpOworenJfZnJlZV9tZW06CisJa2ZyZWUoenIpOwor
CisJcmV0dXJuIC1FTk9ERVY7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgcGNpX2RyaXZlciB6b3Jhbl9k
cml2ZXIgPSB7CisJLm5hbWUgPSAienIzNjA2NyIsCisJLmlkX3RhYmxlID0genIzNjA2N19wY2lf
dGJsLAorCS5wcm9iZSA9IHpvcmFuX3Byb2JlLAorCS5yZW1vdmUgPSB6b3Jhbl9yZW1vdmUsCit9
OworCitzdGF0aWMgaW50IF9faW5pdCB6b3Jhbl9pbml0KHZvaWQpCit7CisJaW50IHJlczsKKwor
CXByaW50ayhLRVJOX0lORk8gIlpvcmFuIE1KUEVHIGJvYXJkIGRyaXZlciB2ZXJzaW9uICVzXG4i
LAorCSAgICAgICBaT1JBTl9WRVJTSU9OKTsKKworCS8qIGNoZWNrIHRoZSBwYXJhbWV0ZXJzIHdl
IGhhdmUgYmVlbiBnaXZlbiwgYWRqdXN0IGlmIG5lY2Vzc2FyeSAqLworCWlmICh2NGxfbmJ1ZnMg
PCAyKQorCQl2NGxfbmJ1ZnMgPSAyOworCWlmICh2NGxfbmJ1ZnMgPiBWSURFT19NQVhfRlJBTUUp
CisJCXY0bF9uYnVmcyA9IFZJREVPX01BWF9GUkFNRTsKKwkvKiBUaGUgdXNlciBzcGVjaWZpZXMg
dGhlIGluIEtCLCB3ZSB3YW50IHRoZW0gaW4gYnl0ZQorCSAqIChhbmQgcGFnZSBhbGlnbmVkKSAq
LworCXY0bF9idWZzaXplID0gUEFHRV9BTElHTih2NGxfYnVmc2l6ZSAqIDEwMjQpOworCWlmICh2
NGxfYnVmc2l6ZSA8IDMyNzY4KQorCQl2NGxfYnVmc2l6ZSA9IDMyNzY4OworCS8qIDIgTUIgaXMg
YXJiaXRyYXJ5IGJ1dCBzdWZmaWNpZW50IGZvciB0aGUgbWF4aW11bSBwb3NzaWJsZSBpbWFnZXMg
Ki8KKwlpZiAodjRsX2J1ZnNpemUgPiAyMDQ4ICogMTAyNCkKKwkJdjRsX2J1ZnNpemUgPSAyMDQ4
ICogMTAyNDsKKwlpZiAoanBnX25idWZzIDwgNCkKKwkJanBnX25idWZzID0gNDsKKwlpZiAoanBn
X25idWZzID4gQlVaX01BWF9GUkFNRSkKKwkJanBnX25idWZzID0gQlVaX01BWF9GUkFNRTsKKwlq
cGdfYnVmc2l6ZSA9IFBBR0VfQUxJR04oanBnX2J1ZnNpemUgKiAxMDI0KTsKKwlpZiAoanBnX2J1
ZnNpemUgPCA4MTkyKQorCQlqcGdfYnVmc2l6ZSA9IDgxOTI7CisJaWYgKGpwZ19idWZzaXplID4g
KDUxMiAqIDEwMjQpKQorCQlqcGdfYnVmc2l6ZSA9IDUxMiAqIDEwMjQ7CisJLyogVXNlIHBhcmFt
ZXRlciBmb3IgdmlkbWVtIG9yIHRyeSB0byBmaW5kIGEgdmlkZW8gY2FyZCAqLworCWlmICh2aWRt
ZW0pIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9JTkZPCisJCQkiJXM6IFVzaW5nIHN1cHBsaWVk
IHZpZGVvIG1lbW9yeSBiYXNlIGFkZHJlc3MgQCAweCVseFxuIiwKKwkJCVpPUkFOX05BTUUsIHZp
ZG1lbSk7CisJfQorCisJLyogc29tZSBtYWluYm9hcmRzIG1pZ2h0IG5vdCBkbyBQQ0ktUENJIGRh
dGEgdHJhbnNmZXIgd2VsbCAqLworCWlmIChwY2lfcGNpX3Byb2JsZW1zICYgKFBDSVBDSV9GQUlM
fFBDSUFHUF9GQUlMfFBDSVBDSV9BTElNQUdJSykpIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9X
QVJOSU5HCisJCQkiJXM6IGNoaXBzZXQgZG9lcyBub3Qgc3VwcG9ydCByZWxpYWJsZSBQQ0ktUENJ
IERNQVxuIiwKKwkJCVpPUkFOX05BTUUpOworCX0KKworCXJlcyA9IHBjaV9yZWdpc3Rlcl9kcml2
ZXIoJnpvcmFuX2RyaXZlcik7CisJaWYgKHJlcykgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VS
UgorCQkJIiVzOiBVbmFibGUgdG8gcmVnaXN0ZXIgWlIzNjA1NyBkcml2ZXJcbiIsCisJCQlaT1JB
Tl9OQU1FKTsKKwkJcmV0dXJuIHJlczsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZv
aWQgX19leGl0IHpvcmFuX2V4aXQodm9pZCkKK3sKKwlwY2lfdW5yZWdpc3Rlcl9kcml2ZXIoJnpv
cmFuX2RyaXZlcik7Cit9CisKK21vZHVsZV9pbml0KHpvcmFuX2luaXQpOworbW9kdWxlX2V4aXQo
em9yYW5fZXhpdCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4vem9y
YW5fY2FyZC5oIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX2NhcmQuaApuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjBjZGI3ZDM0OTI2ZAotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96b3Jhbl9jYXJkLmgKQEAg
LTAsMCArMSw1MCBAQAorLyoKKyAqIFpvcmFuIHpyMzYwNTcvenIzNjA2NyBQQ0kgY29udHJvbGxl
ciBkcml2ZXIsIGZvciB0aGUKKyAqIFBpbm5hY2xlL01pcm8gREMxMC9EQzEwKy9EQzMwL0RDMzAr
LCBJb21lZ2EgQnV6LCBMaW51eAorICogTWVkaWEgTGFicyBMTUwzMy9MTUwzM1IxMC4KKyAqCisg
KiBUaGlzIHBhcnQgaGFuZGxlcyBjYXJkLXNwZWNpZmljIGRhdGEgYW5kIGRldGVjdGlvbgorICoK
KyAqIENvcHlyaWdodCAoQykgMjAwMCBTZXJndWVpIE1pcmlkb25vdiA8bWlyc2V2QGNpY2VzZS5t
eD4KKyAqCisgKiBDdXJyZW50bHkgbWFpbnRhaW5lZCBieToKKyAqICAgUm9uYWxkIEJ1bHRqZSAg
ICA8cmJ1bHRqZUByb25hbGQuYml0ZnJlYWsubmV0PgorICogICBMYXVyZW50IFBpbmNoYXJ0IDxs
YXVyZW50LnBpbmNoYXJ0QHNreW5ldC5iZT4KKyAqICAgTWFpbGluZ2xpc3QgICAgICA8bWpwZWct
dXNlcnNAbGlzdHMuc2YubmV0PgorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJl
OyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiBpdCB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQor
ICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUg
TGljZW5zZSwgb3IKKyAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgor
ICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBi
ZSB1c2VmdWwsCisgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUg
aW1wbGllZCB3YXJyYW50eSBvZgorICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEg
UEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vu
c2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqLworCisjaWZuZGVmIF9fWk9SQU5fQ0FSRF9IX18KKyNk
ZWZpbmUgX19aT1JBTl9DQVJEX0hfXworCitleHRlcm4gaW50IHpyMzYwNjdfZGVidWc7CisKKyNk
ZWZpbmUgZHByaW50ayhudW0sIGZvcm1hdCwgYXJncy4uLikgXAorCWRvIHsgXAorCQlpZiAoenIz
NjA2N19kZWJ1ZyA+PSBudW0pIFwKKwkJCXByaW50ayhmb3JtYXQsICMjYXJncyk7IFwKKwl9IHdo
aWxlICgwKQorCisvKiBBbnlib2R5IHdobyB1c2VzIG1vcmUgdGhhbiBmb3VyPyAqLworI2RlZmlu
ZSBCVVpfTUFYIDQKKworZXh0ZXJuIGNvbnN0IHN0cnVjdCB2aWRlb19kZXZpY2Ugem9yYW5fdGVt
cGxhdGU7CisKK2V4dGVybiBpbnQgem9yYW5fY2hlY2tfanBnX3NldHRpbmdzKHN0cnVjdCB6b3Jh
biAqenIsCisJCQkJICAgIHN0cnVjdCB6b3Jhbl9qcGdfc2V0dGluZ3MgKnNldHRpbmdzLAorCQkJ
CSAgICBpbnQgdHJ5KTsKK2V4dGVybiB2b2lkIHpvcmFuX29wZW5faW5pdF9wYXJhbXMoc3RydWN0
IHpvcmFuICp6cik7CitleHRlcm4gdm9pZCB6b3Jhbl92ZGV2X3JlbGVhc2Uoc3RydWN0IHZpZGVv
X2RldmljZSAqdmRldik7CisKK3ZvaWQgenIzNjAxNl93cml0ZShzdHJ1Y3QgdmlkZW9jb2RlYyAq
Y29kZWMsIHUxNiByZWcsIHUzMiB2YWwpOworCisjZW5kaWYJCQkJLyogX19aT1JBTl9DQVJEX0hf
XyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX2Rldmlj
ZS5jIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX2RldmljZS5jCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMjJiMjc2MzI3NjJkCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX2RldmljZS5jCkBAIC0w
LDAgKzEsMTYxOSBAQAorLyoKKyAqIFpvcmFuIHpyMzYwNTcvenIzNjA2NyBQQ0kgY29udHJvbGxl
ciBkcml2ZXIsIGZvciB0aGUKKyAqIFBpbm5hY2xlL01pcm8gREMxMC9EQzEwKy9EQzMwL0RDMzAr
LCBJb21lZ2EgQnV6LCBMaW51eAorICogTWVkaWEgTGFicyBMTUwzMy9MTUwzM1IxMC4KKyAqCisg
KiBUaGlzIHBhcnQgaGFuZGxlcyBkZXZpY2UgYWNjZXNzIChQQ0kvSTJDL2NvZGVjLy4uLikKKyAq
CisgKiBDb3B5cmlnaHQgKEMpIDIwMDAgU2VyZ3VlaSBNaXJpZG9ub3YgPG1pcnNldkBjaWNlc2Uu
bXg+CisgKgorICogQ3VycmVudGx5IG1haW50YWluZWQgYnk6CisgKiAgIFJvbmFsZCBCdWx0amUg
ICAgPHJidWx0amVAcm9uYWxkLmJpdGZyZWFrLm5ldD4KKyAqICAgTGF1cmVudCBQaW5jaGFydCA8
bGF1cmVudC5waW5jaGFydEBza3luZXQuYmU+CisgKiAgIE1haWxpbmdsaXN0ICAgICAgPG1qcGVn
LXVzZXJzQGxpc3RzLnNmLm5ldD4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2Fy
ZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogaXQgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkK
KyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhl
IExpY2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoK
KyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwg
YmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhl
IGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBB
IFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGZvciBtb3JlIGRldGFpbHMuCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cisj
aW5jbHVkZSA8bGludXgva2VybmVsLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5j
bHVkZSA8bGludXgvdm1hbGxvYy5oPgorI2luY2x1ZGUgPGxpbnV4L2t0aW1lLmg+CisjaW5jbHVk
ZSA8bGludXgvc2NoZWQvc2lnbmFsLmg+CisKKyNpbmNsdWRlIDxsaW51eC9pbnRlcnJ1cHQuaD4K
KyNpbmNsdWRlIDxsaW51eC9wcm9jX2ZzLmg+CisjaW5jbHVkZSA8bGludXgvaTJjLmg+CisjaW5j
bHVkZSA8bGludXgvaTJjLWFsZ28tYml0Lmg+CisjaW5jbHVkZSA8bGludXgvdmlkZW9kZXYyLmg+
CisjaW5jbHVkZSA8bWVkaWEvdjRsMi1jb21tb24uaD4KKyNpbmNsdWRlIDxsaW51eC9zcGlubG9j
ay5oPgorI2luY2x1ZGUgPGxpbnV4L3NlbS5oPgorCisjaW5jbHVkZSA8bGludXgvcGNpLmg+Cisj
aW5jbHVkZSA8bGludXgvZGVsYXkuaD4KKyNpbmNsdWRlIDxsaW51eC93YWl0Lmg+CisKKyNpbmNs
dWRlIDxhc20vYnl0ZW9yZGVyLmg+CisjaW5jbHVkZSA8YXNtL2lvLmg+CisKKyNpbmNsdWRlICJ2
aWRlb2NvZGVjLmgiCisjaW5jbHVkZSAiem9yYW4uaCIKKyNpbmNsdWRlICJ6b3Jhbl9kZXZpY2Uu
aCIKKyNpbmNsdWRlICJ6b3Jhbl9jYXJkLmgiCisKKyNkZWZpbmUgSVJRX01BU0sgKCBaUjM2MDU3
X0lTUl9HSVJRMCB8IFwKKwkJICAgWlIzNjA1N19JU1JfR0lSUTEgfCBcCisJCSAgIFpSMzYwNTdf
SVNSX0pQRUdSZXBJUlEgKQorCitzdGF0aWMgYm9vbCBsbWwzM2RwYXRoOwkJLyogZGVmYXVsdCA9
IDAKKwkJCQkgKiAxIHdpbGwgdXNlIGRpZ2l0YWwgcGF0aCBpbiBjYXB0dXJlCisJCQkJICogbW9k
ZSBpbnN0ZWFkIG9mIGFuYWxvZy4gSXQgY2FuIGJlCisJCQkJICogdXNlZCBmb3IgcGljdHVyZSBh
ZGp1c3RtZW50cyB1c2luZworCQkJCSAqIHRvb2wgbGlrZSB4YXd0diB3aGlsZSB3YXRjaGluZyBp
bWFnZQorCQkJCSAqIG9uIFRWIG1vbml0b3IgY29ubmVjdGVkIHRvIHRoZSBvdXRwdXQuCisJCQkJ
ICogSG93ZXZlciwgZHVlIHRvIGFic2VuY2Ugb2YgNzUgT2htCisJCQkJICogbG9hZCBvbiBCdDgx
OSBpbnB1dCwgdGhlcmUgd2lsbCBiZQorCQkJCSAqIHNvbWUgaW1hZ2UgaW1wZXJmZWN0aW9ucyAq
LworCittb2R1bGVfcGFyYW0obG1sMzNkcGF0aCwgYm9vbCwgMDY0NCk7CitNT0RVTEVfUEFSTV9E
RVNDKGxtbDMzZHBhdGgsCisJCSAiVXNlIGRpZ2l0YWwgcGF0aCBjYXB0dXJlIG1vZGUgKG9uIExN
TDMzIGNhcmRzKSIpOworCitzdGF0aWMgdm9pZAorenIzNjA1N19pbml0X3ZmZSAoc3RydWN0IHpv
cmFuICp6cik7CisKKy8qCisgKiBHZW5lcmFsIFB1cnBvc2UgSS9PIGFuZCBHdWVzdCBidXMgYWNj
ZXNzCisgKi8KKworLyoKKyAqIFRoaXMgaXMgYSBiaXQgdHJpY2t5LiBXaGVuIGEgYm9hcmQgbGFj
a3MgYSBHUElPIGZ1bmN0aW9uLCB0aGUgY29ycmVzcG9uZGluZworICogR1BJTyBiaXQgbnVtYmVy
IGluIHRoZSBjYXJkX2luZm8gc3RydWN0dXJlIGlzIHNldCB0byAwLgorICovCisKK3ZvaWQKK0dQ
SU8gKHN0cnVjdCB6b3JhbiAqenIsCisgICAgICBpbnQgICAgICAgICAgIGJpdCwKKyAgICAgIHVu
c2lnbmVkIGludCAgdmFsdWUpCit7CisJdTMyIHJlZzsKKwl1MzIgbWFzazsKKworCS8qIE1ha2Ug
c3VyZSB0aGUgYml0IG51bWJlciBpcyBsZWdhbAorCSAqIEEgYml0IG51bWJlciBvZiAtMSAobGFj
a2luZykgZ2l2ZXMgYSBtYXNrIG9mIDAsCisJICogbWFraW5nIGl0IGhhcm1sZXNzICovCisJbWFz
ayA9ICgxIDw8ICgyNCArIGJpdCkpICYgMHhmZjAwMDAwMDsKKwlyZWcgPSBidHJlYWQoWlIzNjA1
N19HUFBHQ1IxKSAmIH5tYXNrOworCWlmICh2YWx1ZSkgeworCQlyZWcgfD0gbWFzazsKKwl9CisJ
YnR3cml0ZShyZWcsIFpSMzYwNTdfR1BQR0NSMSk7CisJdWRlbGF5KDEpOworfQorCisvKgorICog
V2FpdCB0aWwgcG9zdCBvZmZpY2UgaXMgbm8gbG9uZ2VyIGJ1c3kKKyAqLworCitpbnQKK3Bvc3Rf
b2ZmaWNlX3dhaXQgKHN0cnVjdCB6b3JhbiAqenIpCit7CisJdTMyIHBvcjsKKworLy8gICAgICB3
aGlsZSAoKChwb3IgPSBidHJlYWQoWlIzNjA1N19QT1IpKSAmIChaUjM2MDU3X1BPUl9QT1BlbiB8
IFpSMzYwNTdfUE9SX1BPVGltZSkpID09IFpSMzYwNTdfUE9SX1BPUGVuKSB7CisJd2hpbGUgKChw
b3IgPSBidHJlYWQoWlIzNjA1N19QT1IpKSAmIFpSMzYwNTdfUE9SX1BPUGVuKSB7CisJCS8qIHdh
aXQgZm9yIHNvbWV0aGluZyB0byBoYXBwZW4gKi8KKwl9CisJaWYgKChwb3IgJiBaUjM2MDU3X1BP
Ul9QT1RpbWUpICYmICF6ci0+Y2FyZC5nd3Nfbm90X2Nvbm5lY3RlZCkgeworCQkvKiBJbiBMTUwz
My9CVVogXEdXUyBsaW5lIGlzIG5vdCBjb25uZWN0ZWQsIHNvIGl0IGhhcyBhbHdheXMgdGltZW91
dCBzZXQgKi8KKwkJZHByaW50aygxLCBLRVJOX0lORk8gIiVzOiBwb3AgdGltZW91dCAlMDh4XG4i
LCBaUl9ERVZOQU1FKHpyKSwKKwkJCXBvcik7CisJCXJldHVybiAtMTsKKwl9CisKKwlyZXR1cm4g
MDsKK30KKworaW50Citwb3N0X29mZmljZV93cml0ZSAoc3RydWN0IHpvcmFuICp6ciwKKwkJICAg
dW5zaWduZWQgaW50ICBndWVzdCwKKwkJICAgdW5zaWduZWQgaW50ICByZWcsCisJCSAgIHVuc2ln
bmVkIGludCAgdmFsdWUpCit7CisJdTMyIHBvcjsKKworCXBvciA9CisJICAgIFpSMzYwNTdfUE9S
X1BPRGlyIHwgWlIzNjA1N19QT1JfUE9UaW1lIHwgKChndWVzdCAmIDcpIDw8IDIwKSB8CisJICAg
ICgocmVnICYgNykgPDwgMTYpIHwgKHZhbHVlICYgMHhGRik7CisJYnR3cml0ZShwb3IsIFpSMzYw
NTdfUE9SKTsKKworCXJldHVybiBwb3N0X29mZmljZV93YWl0KHpyKTsKK30KKworaW50Citwb3N0
X29mZmljZV9yZWFkIChzdHJ1Y3Qgem9yYW4gKnpyLAorCQkgIHVuc2lnbmVkIGludCAgZ3Vlc3Qs
CisJCSAgdW5zaWduZWQgaW50ICByZWcpCit7CisJdTMyIHBvcjsKKworCXBvciA9IFpSMzYwNTdf
UE9SX1BPVGltZSB8ICgoZ3Vlc3QgJiA3KSA8PCAyMCkgfCAoKHJlZyAmIDcpIDw8IDE2KTsKKwli
dHdyaXRlKHBvciwgWlIzNjA1N19QT1IpOworCWlmIChwb3N0X29mZmljZV93YWl0KHpyKSA8IDAp
IHsKKwkJcmV0dXJuIC0xOworCX0KKworCXJldHVybiBidHJlYWQoWlIzNjA1N19QT1IpICYgMHhG
RjsKK30KKworLyoKKyAqIGRldGVjdCBndWVzdHMKKyAqLworCitzdGF0aWMgdm9pZAorZHVtcF9n
dWVzdHMgKHN0cnVjdCB6b3JhbiAqenIpCit7CisJaWYgKHpyMzYwNjdfZGVidWcgPiAyKSB7CisJ
CWludCBpLCBndWVzdFs4XTsKKworCQlmb3IgKGkgPSAxOyBpIDwgODsgaSsrKSB7CS8vIERvbid0
IHJlYWQganBlZyBjb2RlYyBoZXJlCisJCQlndWVzdFtpXSA9IHBvc3Rfb2ZmaWNlX3JlYWQoenIs
IGksIDApOworCQl9CisKKwkJcHJpbnRrKEtFUk5fSU5GTyAiJXM6IEd1ZXN0czogJSpwaFxuIiwK
KwkJICAgICAgIFpSX0RFVk5BTUUoenIpLCA4LCBndWVzdCk7CisJfQorfQorCit2b2lkCitkZXRl
Y3RfZ3Vlc3RfYWN0aXZpdHkgKHN0cnVjdCB6b3JhbiAqenIpCit7CisJaW50IHRpbWVvdXQsIGks
IGosIHJlcywgZ3Vlc3RbOF0sIGd1ZXN0MFs4XSwgY2hhbmdlWzhdWzNdOworCWt0aW1lX3QgdDAs
IHQxOworCisJZHVtcF9ndWVzdHMoenIpOworCXByaW50ayhLRVJOX0lORk8gIiVzOiBEZXRlY3Rp
bmcgZ3Vlc3RzIGFjdGl2aXR5LCBwbGVhc2Ugd2FpdC4uLlxuIiwKKwkgICAgICAgWlJfREVWTkFN
RSh6cikpOworCWZvciAoaSA9IDE7IGkgPCA4OyBpKyspIHsJLy8gRG9uJ3QgcmVhZCBqcGVnIGNv
ZGVjIGhlcmUKKwkJZ3Vlc3QwW2ldID0gZ3Vlc3RbaV0gPSBwb3N0X29mZmljZV9yZWFkKHpyLCBp
LCAwKTsKKwl9CisKKwl0aW1lb3V0ID0gMDsKKwlqID0gMDsKKwl0MCA9IGt0aW1lX2dldCgpOwor
CXdoaWxlICh0aW1lb3V0IDwgMTAwMDApIHsKKwkJdWRlbGF5KDEwKTsKKwkJdGltZW91dCsrOwor
CQlmb3IgKGkgPSAxOyAoaSA8IDgpICYmIChqIDwgOCk7IGkrKykgeworCQkJcmVzID0gcG9zdF9v
ZmZpY2VfcmVhZCh6ciwgaSwgMCk7CisJCQlpZiAocmVzICE9IGd1ZXN0W2ldKSB7CisJCQkJdDEg
PSBrdGltZV9nZXQoKTsKKwkJCQljaGFuZ2Vbal1bMF0gPSBrdGltZV90b191cyhrdGltZV9zdWIo
dDEsIHQwKSk7CisJCQkJdDAgPSB0MTsKKwkJCQljaGFuZ2Vbal1bMV0gPSBpOworCQkJCWNoYW5n
ZVtqXVsyXSA9IHJlczsKKwkJCQlqKys7CisJCQkJZ3Vlc3RbaV0gPSByZXM7CisJCQl9CisJCX0K
KwkJaWYgKGogPj0gOCkKKwkJCWJyZWFrOworCX0KKworCXByaW50ayhLRVJOX0lORk8gIiVzOiBH
dWVzdHM6ICUqcGhcbiIsIFpSX0RFVk5BTUUoenIpLCA4LCBndWVzdDApOworCisJaWYgKGogPT0g
MCkgeworCQlwcmludGsoS0VSTl9JTkZPICIlczogTm8gYWN0aXZpdHkgZGV0ZWN0ZWQuXG4iLCBa
Ul9ERVZOQU1FKHpyKSk7CisJCXJldHVybjsKKwl9CisJZm9yIChpID0gMDsgaSA8IGo7IGkrKykg
eworCQlwcmludGsoS0VSTl9JTkZPICIlczogJTZkOiAlZCA9PiAweCUwMnhcbiIsIFpSX0RFVk5B
TUUoenIpLAorCQkgICAgICAgY2hhbmdlW2ldWzBdLCBjaGFuZ2VbaV1bMV0sIGNoYW5nZVtpXVsy
XSk7CisJfQorfQorCisvKgorICogSlBFRyBDb2RlYyBhY2Nlc3MKKyAqLworCit2b2lkCitqcGVn
X2NvZGVjX3NsZWVwIChzdHJ1Y3Qgem9yYW4gKnpyLAorCQkgIGludCAgICAgICAgICAgc2xlZXAp
Cit7CisJR1BJTyh6ciwgenItPmNhcmQuZ3Bpb1taUl9HUElPX0pQRUdfU0xFRVBdLCAhc2xlZXAp
OworCWlmICghc2xlZXApIHsKKwkJZHByaW50aygzLAorCQkJS0VSTl9ERUJVRworCQkJIiVzOiBq
cGVnX2NvZGVjX3NsZWVwKCkgLSB3YWtlIEdQSU89MHglMDh4XG4iLAorCQkJWlJfREVWTkFNRSh6
ciksIGJ0cmVhZChaUjM2MDU3X0dQUEdDUjEpKTsKKwkJdWRlbGF5KDUwMCk7CisJfSBlbHNlIHsK
KwkJZHByaW50aygzLAorCQkJS0VSTl9ERUJVRworCQkJIiVzOiBqcGVnX2NvZGVjX3NsZWVwKCkg
LSBzbGVlcCBHUElPPTB4JTA4eFxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBidHJlYWQoWlIzNjA1
N19HUFBHQ1IxKSk7CisJCXVkZWxheSgyKTsKKwl9Cit9CisKK2ludAoranBlZ19jb2RlY19yZXNl
dCAoc3RydWN0IHpvcmFuICp6cikKK3sKKwkvKiBUYWtlIHRoZSBjb2RlYyBvdXQgb2Ygc2xlZXAg
Ki8KKwlqcGVnX2NvZGVjX3NsZWVwKHpyLCAwKTsKKworCWlmICh6ci0+Y2FyZC5ncGNzW0dQQ1Nf
SlBFR19SRVNFVF0gIT0gMHhmZikgeworCQlwb3N0X29mZmljZV93cml0ZSh6ciwgenItPmNhcmQu
Z3Bjc1tHUENTX0pQRUdfUkVTRVRdLCAwLAorCQkJCSAgMCk7CisJCXVkZWxheSgyKTsKKwl9IGVs
c2UgeworCQlHUElPKHpyLCB6ci0+Y2FyZC5ncGlvW1pSX0dQSU9fSlBFR19SRVNFVF0sIDApOwor
CQl1ZGVsYXkoMik7CisJCUdQSU8oenIsIHpyLT5jYXJkLmdwaW9bWlJfR1BJT19KUEVHX1JFU0VU
XSwgMSk7CisJCXVkZWxheSgyKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoKKyAqICAgU2V0
IHRoZSByZWdpc3RlcnMgZm9yIHRoZSBzaXplIHdlIGhhdmUgc3BlY2lmaWVkLiBEb24ndCBib3Ro
ZXIKKyAqICAgdHJ5aW5nIHRvIHVuZGVyc3RhbmQgdGhpcyB3aXRob3V0IHRoZSBaUjM2MDU3IG1h
bnVhbCBpbiBmcm9udCBvZgorICogICB5b3UgW0FDXS4KKyAqCisgKiAgIFBTOiBUaGUgbWFudWFs
IGlzIGZyZWUgZm9yIGRvd25sb2FkIGluIC5wZGYgZm9ybWF0IGZyb20KKyAqICAgd3d3LnpvcmFu
LmNvbSAtIG5pY2VseSBkb25lIHRob3NlIGZvbGtzLgorICovCisKK3N0YXRpYyB2b2lkCit6cjM2
MDU3X2FkanVzdF92ZmUgKHN0cnVjdCB6b3JhbiAgICAgICAgICAqenIsCisJCSAgICBlbnVtIHpv
cmFuX2NvZGVjX21vZGUgIG1vZGUpCit7CisJdTMyIHJlZzsKKworCXN3aXRjaCAobW9kZSkgewor
CWNhc2UgQlVaX01PREVfTU9USU9OX0RFQ09NUFJFU1M6CisJCWJ0YW5kKH5aUjM2MDU3X1ZGRVNQ
RlJfRXh0RmwsIFpSMzYwNTdfVkZFU1BGUik7CisJCXJlZyA9IGJ0cmVhZChaUjM2MDU3X1ZGRUhD
Uik7CisJCWlmICgocmVnICYgKDEgPDwgMTApKSAmJiB6ci0+Y2FyZC50eXBlICE9IExNTDMzUjEw
KSB7CisJCQlyZWcgKz0gKCgxIDw8IDEwKSB8IDEpOworCQl9CisJCWJ0d3JpdGUocmVnLCBaUjM2
MDU3X1ZGRUhDUik7CisJCWJyZWFrOworCWNhc2UgQlVaX01PREVfTU9USU9OX0NPTVBSRVNTOgor
CWNhc2UgQlVaX01PREVfSURMRToKKwlkZWZhdWx0OgorCQlpZiAoKHpyLT5ub3JtICYgVjRMMl9T
VERfTlRTQykgfHwKKwkJICAgICh6ci0+Y2FyZC50eXBlID09IExNTDMzUjEwICYmCisJCSAgICAg
KHpyLT5ub3JtICYgVjRMMl9TVERfUEFMKSkpCisJCQlidGFuZCh+WlIzNjA1N19WRkVTUEZSX0V4
dEZsLCBaUjM2MDU3X1ZGRVNQRlIpOworCQllbHNlCisJCQlidG9yKFpSMzYwNTdfVkZFU1BGUl9F
eHRGbCwgWlIzNjA1N19WRkVTUEZSKTsKKwkJcmVnID0gYnRyZWFkKFpSMzYwNTdfVkZFSENSKTsK
KwkJaWYgKCEocmVnICYgKDEgPDwgMTApKSAmJiB6ci0+Y2FyZC50eXBlICE9IExNTDMzUjEwKSB7
CisJCQlyZWcgLT0gKCgxIDw8IDEwKSB8IDEpOworCQl9CisJCWJ0d3JpdGUocmVnLCBaUjM2MDU3
X1ZGRUhDUik7CisJCWJyZWFrOworCX0KK30KKworLyoKKyAqIHNldCBnZW9tZXRyeQorICovCisK
K3N0YXRpYyB2b2lkCit6cjM2MDU3X3NldF92ZmUgKHN0cnVjdCB6b3JhbiAgICAgICAgICAgICAg
KnpyLAorCQkgaW50ICAgICAgICAgICAgICAgICAgICAgICAgdmlkZW9fd2lkdGgsCisJCSBpbnQg
ICAgICAgICAgICAgICAgICAgICAgICB2aWRlb19oZWlnaHQsCisJCSBjb25zdCBzdHJ1Y3Qgem9y
YW5fZm9ybWF0ICpmb3JtYXQpCit7CisJc3RydWN0IHR2bm9ybSAqdHZuOworCXVuc2lnbmVkIEhT
dGFydCwgSEVuZCwgVlN0YXJ0LCBWRW5kOworCXVuc2lnbmVkIERpc3BNb2RlOworCXVuc2lnbmVk
IFZpZFdpbldpZCwgVmlkV2luSHQ7CisJdW5zaWduZWQgaGNyb3AxLCBoY3JvcDIsIHZjcm9wMSwg
dmNyb3AyOworCXVuc2lnbmVkIFdhLCBXZSwgSGEsIEhlOworCXVuc2lnbmVkIFgsIFksIEhvckRj
bSwgVmVyRGNtOworCXUzMiByZWc7CisJdW5zaWduZWQgbWFza19saW5lX3NpemU7CisKKwl0dm4g
PSB6ci0+dGltaW5nOworCisJV2EgPSB0dm4tPldhOworCUhhID0gdHZuLT5IYTsKKworCWRwcmlu
dGsoMiwgS0VSTl9JTkZPICIlczogc2V0X3ZmZSgpIC0gd2lkdGggPSAlZCwgaGVpZ2h0ID0gJWRc
biIsCisJCVpSX0RFVk5BTUUoenIpLCB2aWRlb193aWR0aCwgdmlkZW9faGVpZ2h0KTsKKworCWlm
ICh2aWRlb193aWR0aCA8IEJVWl9NSU5fV0lEVEggfHwKKwkgICAgdmlkZW9faGVpZ2h0IDwgQlVa
X01JTl9IRUlHSFQgfHwKKwkgICAgdmlkZW9fd2lkdGggPiBXYSB8fCB2aWRlb19oZWlnaHQgPiBI
YSkgeworCQlkcHJpbnRrKDEsIEtFUk5fRVJSICIlczogc2V0X3ZmZTogdz0lZCBoPSVkIG5vdCB2
YWxpZFxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCB2aWRlb193aWR0aCwgdmlkZW9faGVpZ2h0KTsK
KwkJcmV0dXJuOworCX0KKworCS8qKioqIHpyMzYwNTcgKioqKi8KKworCS8qIGhvcml6b250YWwg
Ki8KKwlWaWRXaW5XaWQgPSB2aWRlb193aWR0aDsKKwlYID0gRElWX1JPVU5EX1VQKFZpZFdpbldp
ZCAqIDY0LCB0dm4tPldhKTsKKwlXZSA9IChWaWRXaW5XaWQgKiA2NCkgLyBYOworCUhvckRjbSA9
IDY0IC0gWDsKKwloY3JvcDEgPSAyICogKCh0dm4tPldhIC0gV2UpIC8gNCk7CisJaGNyb3AyID0g
dHZuLT5XYSAtIFdlIC0gaGNyb3AxOworCUhTdGFydCA9IHR2bi0+SFN0YXJ0ID8gdHZuLT5IU3Rh
cnQgOiAxOworCS8qIChSb25hbGQpIE9yaWdpbmFsIGNvbW1lbnQ6CisJICogInwgMSBEb2Vzbid0
IGhhdmUgYW55IGVmZmVjdCwgdGVzdGVkIG9uIGJvdGggYSBEQzEwIGFuZCBhIERDMTArIgorCSAq
IHRoaXMgaXMgZmFsc2UuIEl0IGludmVyc2VzIGNocm9tYSB2YWx1ZXMgb24gdGhlIExNTDMzUjEw
IChzbyBDcgorCSAqIHN1ZGRlbmx5IGlzIHNob3duIGFzIENiIGFuZCByZXZlcnNlLCByZWFsbHkg
Y29vbCBlZmZlY3QgaWYgeW91CisJICogd2FudCB0byBzZWUgYmx1ZSBmYWNlcywgbm90IHVzZWZ1
bCBvdGhlcndpc2UpLiBTbyBkb24ndCB1c2UgfDEuCisJICogSG93ZXZlciwgdGhlIERDMTAgaGFz
ICcwJyBhcyBIU3RhcnQsIGJ1dCBkb2VzIG5lZWQgfDEsIHNvIHdlCisJICogdXNlIGEgZGlydHkg
Y2hlY2suLi4KKwkgKi8KKwlIRW5kID0gSFN0YXJ0ICsgdHZuLT5XYSAtIDE7CisJSFN0YXJ0ICs9
IGhjcm9wMTsKKwlIRW5kIC09IGhjcm9wMjsKKwlyZWcgPSAoKEhTdGFydCAmIFpSMzYwNTdfVkZF
SENSX0htYXNrKSA8PCBaUjM2MDU3X1ZGRUhDUl9IU3RhcnQpCisJICAgIHwgKChIRW5kICYgWlIz
NjA1N19WRkVIQ1JfSG1hc2spIDw8IFpSMzYwNTdfVkZFSENSX0hFbmQpOworCWlmICh6ci0+Y2Fy
ZC52ZmVfcG9sLmhzeW5jX3BvbCkKKwkJcmVnIHw9IFpSMzYwNTdfVkZFSENSX0hTUG9sOworCWJ0
d3JpdGUocmVnLCBaUjM2MDU3X1ZGRUhDUik7CisKKwkvKiBWZXJ0aWNhbCAqLworCURpc3BNb2Rl
ID0gISh2aWRlb19oZWlnaHQgPiBCVVpfTUFYX0hFSUdIVCAvIDIpOworCVZpZFdpbkh0ID0gRGlz
cE1vZGUgPyB2aWRlb19oZWlnaHQgOiB2aWRlb19oZWlnaHQgLyAyOworCVkgPSBESVZfUk9VTkRf
VVAoVmlkV2luSHQgKiA2NCAqIDIsIHR2bi0+SGEpOworCUhlID0gKFZpZFdpbkh0ICogNjQpIC8g
WTsKKwlWZXJEY20gPSA2NCAtIFk7CisJdmNyb3AxID0gKHR2bi0+SGEgLyAyIC0gSGUpIC8gMjsK
Kwl2Y3JvcDIgPSB0dm4tPkhhIC8gMiAtIEhlIC0gdmNyb3AxOworCVZTdGFydCA9IHR2bi0+VlN0
YXJ0OworCVZFbmQgPSBWU3RhcnQgKyB0dm4tPkhhIC8gMjsJLy8gLSAxOyBGSVhNRSBTbmFwU2hv
dCB0aW1lcyBvdXQgd2l0aCAtMSBpbiA3NjgqNTc2IG9uIHRoZSBEQzEwIC0gTFAKKwlWU3RhcnQg
Kz0gdmNyb3AxOworCVZFbmQgLT0gdmNyb3AyOworCXJlZyA9ICgoVlN0YXJ0ICYgWlIzNjA1N19W
RkVWQ1JfVm1hc2spIDw8IFpSMzYwNTdfVkZFVkNSX1ZTdGFydCkKKwkgICAgfCAoKFZFbmQgJiBa
UjM2MDU3X1ZGRVZDUl9WbWFzaykgPDwgWlIzNjA1N19WRkVWQ1JfVkVuZCk7CisJaWYgKHpyLT5j
YXJkLnZmZV9wb2wudnN5bmNfcG9sKQorCQlyZWcgfD0gWlIzNjA1N19WRkVWQ1JfVlNQb2w7CisJ
YnR3cml0ZShyZWcsIFpSMzYwNTdfVkZFVkNSKTsKKworCS8qIHNjYWxlciBhbmQgcGl4ZWwgZm9y
bWF0ICovCisJcmVnID0gMDsKKwlyZWcgfD0gKEhvckRjbSA8PCBaUjM2MDU3X1ZGRVNQRlJfSG9y
RGNtKTsKKwlyZWcgfD0gKFZlckRjbSA8PCBaUjM2MDU3X1ZGRVNQRlJfVmVyRGNtKTsKKwlyZWcg
fD0gKERpc3BNb2RlIDw8IFpSMzYwNTdfVkZFU1BGUl9EaXNwTW9kZSk7CisJLyogUko6IEkgZG9u
J3Qga25vdywgd2h5IHRoZSBmb2xsb3dpbmcgaGFzIHRvIGJlIHRoZSBvcHBvc2l0ZQorCSAqIG9m
IHRoZSBjb3JyZXNwb25kaW5nIFpSMzYwNjAgc2V0dGluZywgYnV0IG9ubHkgdGhpcyB3YXkKKwkg
KiB3ZSBnZXQgdGhlIGNvcnJlY3QgY29sb3JzIHdoZW4gdW5jb21wcmVzc2luZyB0byB0aGUgc2Ny
ZWVuICAqLworCS8vcmVnIHw9IFpSMzYwNTdfVkZFU1BGUl9WQ0xLUG9sOyAvKiovCisJLyogUko6
IERvbid0IGtub3cgaWYgdGhhdCBpcyBuZWVkZWQgZm9yIE5UU0MgYWxzbyAqLworCWlmICghKHpy
LT5ub3JtICYgVjRMMl9TVERfTlRTQykpCisJCXJlZyB8PSBaUjM2MDU3X1ZGRVNQRlJfRXh0Rmw7
CS8vIE5FRURFRCEhISEhISEgV29sZmdhbmcKKwlyZWcgfD0gWlIzNjA1N19WRkVTUEZSX1RvcEZp
ZWxkOworCWlmIChIb3JEY20gPj0gNDgpIHsKKwkJcmVnIHw9IDMgPDwgWlIzNjA1N19WRkVTUEZS
X0hGaWx0ZXI7CS8qIDUgdGFwIGZpbHRlciAqLworCX0gZWxzZSBpZiAoSG9yRGNtID49IDMyKSB7
CisJCXJlZyB8PSAyIDw8IFpSMzYwNTdfVkZFU1BGUl9IRmlsdGVyOwkvKiA0IHRhcCBmaWx0ZXIg
Ki8KKwl9IGVsc2UgaWYgKEhvckRjbSA+PSAxNikgeworCQlyZWcgfD0gMSA8PCBaUjM2MDU3X1ZG
RVNQRlJfSEZpbHRlcjsJLyogMyB0YXAgZmlsdGVyICovCisJfQorCXJlZyB8PSBmb3JtYXQtPnZm
ZXNwZnI7CisJYnR3cml0ZShyZWcsIFpSMzYwNTdfVkZFU1BGUik7CisKKwkvKiBkaXNwbGF5IGNv
bmZpZ3VyYXRpb24gKi8KKwlyZWcgPSAoMTYgPDwgWlIzNjA1N19WRENSX01pblBpeCkKKwkgICAg
fCAoVmlkV2luSHQgPDwgWlIzNjA1N19WRENSX1ZpZFdpbkh0KQorCSAgICB8IChWaWRXaW5XaWQg
PDwgWlIzNjA1N19WRENSX1ZpZFdpbldpZCk7CisJaWYgKHBjaV9wY2lfcHJvYmxlbXMgJiBQQ0lQ
Q0lfVFJJVE9OKQorCQkvLyB8fCB6ci0+cmV2aXNpb24gPCAxKSAvLyBSZXZpc2lvbiAxIGhhcyBh
bHNvIFRyaXRvbiBzdXBwb3J0CisJCXJlZyAmPSB+WlIzNjA1N19WRENSX1RyaXRvbjsKKwllbHNl
CisJCXJlZyB8PSBaUjM2MDU3X1ZEQ1JfVHJpdG9uOworCWJ0d3JpdGUocmVnLCBaUjM2MDU3X1ZE
Q1IpOworCisJLyogKFJvbmFsZCkgZG9uJ3Qgd3JpdGUgdGhpcyBpZiBvdmVybGF5X21hc2sgPSBO
VUxMICovCisJaWYgKHpyLT5vdmVybGF5X21hc2spIHsKKwkJLyogV3JpdGUgb3ZlcmxheSBjbGlw
cGluZyBtYXNrIGRhdGEsIGJ1dCBkb24ndCBlbmFibGUgb3ZlcmxheSBjbGlwcGluZyAqLworCQkv
KiBSSjogc2luY2UgdGhpcyBtYWtlcyBvbmx5IHNlbnNlIG9uIHRoZSBzY3JlZW4sIHdlIHVzZQor
CQkgKiB6ci0+b3ZlcmxheV9zZXR0aW5ncy53aWR0aCBpbnN0ZWFkIG9mIHZpZGVvX3dpZHRoICov
CisKKwkJbWFza19saW5lX3NpemUgPSAoQlVaX01BWF9XSURUSCArIDMxKSAvIDMyOworCQlyZWcg
PSB2aXJ0X3RvX2J1cyh6ci0+b3ZlcmxheV9tYXNrKTsKKwkJYnR3cml0ZShyZWcsIFpSMzYwNTdf
TU1UUik7CisJCXJlZyA9IHZpcnRfdG9fYnVzKHpyLT5vdmVybGF5X21hc2sgKyBtYXNrX2xpbmVf
c2l6ZSk7CisJCWJ0d3JpdGUocmVnLCBaUjM2MDU3X01NQlIpOworCQlyZWcgPQorCQkgICAgbWFz
a19saW5lX3NpemUgLSAoenItPm92ZXJsYXlfc2V0dGluZ3Mud2lkdGggKworCQkJCSAgICAgIDMx
KSAvIDMyOworCQlpZiAoRGlzcE1vZGUgPT0gMCkKKwkJCXJlZyArPSBtYXNrX2xpbmVfc2l6ZTsK
KwkJcmVnIDw8PSBaUjM2MDU3X09DUl9NYXNrU3RyaWRlOworCQlidHdyaXRlKHJlZywgWlIzNjA1
N19PQ1IpOworCX0KKworCXpyMzYwNTdfYWRqdXN0X3ZmZSh6ciwgenItPmNvZGVjX21vZGUpOwor
fQorCisvKgorICogU3dpdGNoIG92ZXJsYXkgb24gb3Igb2ZmCisgKi8KKwordm9pZAorenIzNjA1
N19vdmVybGF5IChzdHJ1Y3Qgem9yYW4gKnpyLAorCQkgaW50ICAgICAgICAgICBvbikKK3sKKwl1
MzIgcmVnOworCisJaWYgKG9uKSB7CisJCS8qIGRvIHRoZSBuZWNlc3Nhcnkgc2V0dGluZ3MgLi4u
ICovCisJCWJ0YW5kKH5aUjM2MDU3X1ZEQ1JfVmlkRW4sIFpSMzYwNTdfVkRDUik7CS8qIHN3aXRj
aCBpdCBvZmYgZmlyc3QgKi8KKworCQl6cjM2MDU3X3NldF92ZmUoenIsCisJCQkJenItPm92ZXJs
YXlfc2V0dGluZ3Mud2lkdGgsCisJCQkJenItPm92ZXJsYXlfc2V0dGluZ3MuaGVpZ2h0LAorCQkJ
CXpyLT5vdmVybGF5X3NldHRpbmdzLmZvcm1hdCk7CisKKwkJLyogU3RhcnQgYW5kIGxlbmd0aCBv
ZiBlYWNoIGxpbmUgTVVTVCBiZSA0LWJ5dGUgYWxpZ25lZC4KKwkJICogVGhpcyBzaG91bGQgYmUg
YWxyZWFkeSBjaGVja2VkIGJlZm9yZSB0aGUgY2FsbCB0byB0aGlzIHJvdXRpbmUuCisJCSAqIEFs
bCBlcnJvciBtZXNzYWdlcyBhcmUgaW50ZXJuYWwgZHJpdmVyIGNoZWNraW5nIG9ubHkhICovCisK
KwkJLyogdmlkZW8gZGlzcGxheSB0b3AgYW5kIGJvdHRvbSByZWdpc3RlcnMgKi8KKwkJcmVnID0g
KGxvbmcpIHpyLT52YnVmX2Jhc2UgKworCQkgICAgenItPm92ZXJsYXlfc2V0dGluZ3MueCAqCisJ
CSAgICAoKHpyLT5vdmVybGF5X3NldHRpbmdzLmZvcm1hdC0+ZGVwdGggKyA3KSAvIDgpICsKKwkJ
ICAgIHpyLT5vdmVybGF5X3NldHRpbmdzLnkgKgorCQkgICAgenItPnZidWZfYnl0ZXNwZXJsaW5l
OworCQlidHdyaXRlKHJlZywgWlIzNjA1N19WRFRSKTsKKwkJaWYgKHJlZyAmIDMpCisJCQlkcHJp
bnRrKDEsCisJCQkJS0VSTl9FUlIKKwkJCQkiJXM6IHpyMzYwNTdfb3ZlcmxheSgpIC0gdmlkZW9f
YWRkcmVzcyBub3QgYWxpZ25lZFxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSk7CisJCWlmICh6ci0+
b3ZlcmxheV9zZXR0aW5ncy5oZWlnaHQgPiBCVVpfTUFYX0hFSUdIVCAvIDIpCisJCQlyZWcgKz0g
enItPnZidWZfYnl0ZXNwZXJsaW5lOworCQlidHdyaXRlKHJlZywgWlIzNjA1N19WREJSKTsKKwor
CQkvKiB2aWRlbyBzdHJpZGUsIHN0YXR1cywgYW5kIGZyYW1lIGdyYWIgcmVnaXN0ZXIgKi8KKwkJ
cmVnID0genItPnZidWZfYnl0ZXNwZXJsaW5lIC0KKwkJICAgIHpyLT5vdmVybGF5X3NldHRpbmdz
LndpZHRoICoKKwkJICAgICgoenItPm92ZXJsYXlfc2V0dGluZ3MuZm9ybWF0LT5kZXB0aCArIDcp
IC8gOCk7CisJCWlmICh6ci0+b3ZlcmxheV9zZXR0aW5ncy5oZWlnaHQgPiBCVVpfTUFYX0hFSUdI
VCAvIDIpCisJCQlyZWcgKz0genItPnZidWZfYnl0ZXNwZXJsaW5lOworCQlpZiAocmVnICYgMykK
KwkJCWRwcmludGsoMSwKKwkJCQlLRVJOX0VSUgorCQkJCSIlczogenIzNjA1N19vdmVybGF5KCkg
LSB2aWRlb19zdHJpZGUgbm90IGFsaWduZWRcbiIsCisJCQkJWlJfREVWTkFNRSh6cikpOworCQly
ZWcgPSAocmVnIDw8IFpSMzYwNTdfVlNTRkdSX0Rpc3BTdHJpZGUpOworCQlyZWcgfD0gWlIzNjA1
N19WU1NGR1JfVmlkT3ZmOwkvKiBjbGVhciBvdmVyZmxvdyBzdGF0dXMgKi8KKwkJYnR3cml0ZShy
ZWcsIFpSMzYwNTdfVlNTRkdSKTsKKworCQkvKiBTZXQgb3ZlcmxheSBjbGlwcGluZyAqLworCQlp
ZiAoenItPm92ZXJsYXlfc2V0dGluZ3MuY2xpcGNvdW50ID4gMCkKKwkJCWJ0b3IoWlIzNjA1N19P
Q1JfT3ZsRW5hYmxlLCBaUjM2MDU3X09DUik7CisKKwkJLyogLi4uIGFuZCBzd2l0Y2ggaXQgb24g
Ki8KKwkJYnRvcihaUjM2MDU3X1ZEQ1JfVmlkRW4sIFpSMzYwNTdfVkRDUik7CisJfSBlbHNlIHsK
KwkJLyogU3dpdGNoIGl0IG9mZiAqLworCQlidGFuZCh+WlIzNjA1N19WRENSX1ZpZEVuLCBaUjM2
MDU3X1ZEQ1IpOworCX0KK30KKworLyoKKyAqIFRoZSBvdmVybGF5IG1hc2sgaGFzIG9uZSBiaXQg
Zm9yIGVhY2ggcGl4ZWwgb24gYSBzY2FuIGxpbmUsCisgKiAgYW5kIHRoZSBtYXhpbXVtIHdpbmRv
dyBzaXplIGlzIEJVWl9NQVhfV0lEVEggKiBCVVpfTUFYX0hFSUdIVCBwaXhlbHMuCisgKi8KKwor
dm9pZCB3cml0ZV9vdmVybGF5X21hc2soc3RydWN0IHpvcmFuX2ZoICpmaCwgc3RydWN0IHY0bDJf
Y2xpcCAqdnAsIGludCBjb3VudCkKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCXVu
c2lnbmVkIG1hc2tfbGluZV9zaXplID0gKEJVWl9NQVhfV0lEVEggKyAzMSkgLyAzMjsKKwl1MzIg
Km1hc2s7CisJaW50IHgsIHksIHdpZHRoLCBoZWlnaHQ7CisJdW5zaWduZWQgaSwgaiwgazsKKwor
CS8qIGZpbGwgbWFzayB3aXRoIG9uZSBiaXRzICovCisJbWVtc2V0KGZoLT5vdmVybGF5X21hc2ss
IH4wLCBtYXNrX2xpbmVfc2l6ZSAqIDQgKiBCVVpfTUFYX0hFSUdIVCk7CisKKwlmb3IgKGkgPSAw
OyBpIDwgY291bnQ7ICsraSkgeworCQkvKiBwaWNrIHVwIGxvY2FsIGNvcHkgb2YgY2xpcCAqLwor
CQl4ID0gdnBbaV0uYy5sZWZ0OworCQl5ID0gdnBbaV0uYy50b3A7CisJCXdpZHRoID0gdnBbaV0u
Yy53aWR0aDsKKwkJaGVpZ2h0ID0gdnBbaV0uYy5oZWlnaHQ7CisKKwkJLyogdHJpbSBjbGlwcyB0
aGF0IGV4dGVuZCBiZXlvbmQgdGhlIHdpbmRvdyAqLworCQlpZiAoeCA8IDApIHsKKwkJCXdpZHRo
ICs9IHg7CisJCQl4ID0gMDsKKwkJfQorCQlpZiAoeSA8IDApIHsKKwkJCWhlaWdodCArPSB5Owor
CQkJeSA9IDA7CisJCX0KKwkJaWYgKHggKyB3aWR0aCA+IGZoLT5vdmVybGF5X3NldHRpbmdzLndp
ZHRoKSB7CisJCQl3aWR0aCA9IGZoLT5vdmVybGF5X3NldHRpbmdzLndpZHRoIC0geDsKKwkJfQor
CQlpZiAoeSArIGhlaWdodCA+IGZoLT5vdmVybGF5X3NldHRpbmdzLmhlaWdodCkgeworCQkJaGVp
Z2h0ID0gZmgtPm92ZXJsYXlfc2V0dGluZ3MuaGVpZ2h0IC0geTsKKwkJfQorCisJCS8qIGlnbm9y
ZSBkZWdlbmVyYXRlIGNsaXBzICovCisJCWlmIChoZWlnaHQgPD0gMCkgeworCQkJY29udGludWU7
CisJCX0KKwkJaWYgKHdpZHRoIDw9IDApIHsKKwkJCWNvbnRpbnVlOworCQl9CisKKwkJLyogYXBw
bHkgY2xpcCBmb3IgZWFjaCBzY2FuIGxpbmUgKi8KKwkJZm9yIChqID0gMDsgaiA8IGhlaWdodDsg
KytqKSB7CisJCQkvKiByZXNldCBiaXQgZm9yIGVhY2ggcGl4ZWwgKi8KKwkJCS8qIHRoaXMgY2Fu
IGJlIG9wdGltaXplZCBsYXRlciBpZiBuZWVkIGJlICovCisJCQltYXNrID0gZmgtPm92ZXJsYXlf
bWFzayArICh5ICsgaikgKiBtYXNrX2xpbmVfc2l6ZTsKKwkJCWZvciAoayA9IDA7IGsgPCB3aWR0
aDsgKytrKSB7CisJCQkJbWFza1soeCArIGspIC8gMzJdICY9CisJCQkJICAgIH4oKHUzMikgMSA8
PCAoeCArIGspICUgMzIpOworCQkJfQorCQl9CisJfQorfQorCisvKiBFbmFibGUvRGlzYWJsZSB1
bmNvbXByZXNzZWQgbWVtb3J5IGdyYWJiaW5nIG9mIHRoZSAzNjA1NyAqLworCit2b2lkCit6cjM2
MDU3X3NldF9tZW1ncmFiIChzdHJ1Y3Qgem9yYW4gKnpyLAorCQkgICAgIGludCAgICAgICAgICAg
bW9kZSkKK3sKKwlpZiAobW9kZSkgeworCQkvKiBXZSBvbmx5IGNoZWNrIFNuYXBTaG90IGFuZCBu
b3QgRnJhbWVHcmFiIGhlcmUuICBTbmFwU2hvdD09MQorCQkgKiBtZWFucyBhIGNhcHR1cmUgaXMg
YWxyZWFkeSBpbiBwcm9ncmVzcywgYnV0IEZyYW1lR3JhYj09MQorCQkgKiBkb2Vzbid0IG5lY2Vz
c2FyeSBtZWFuIHRoYXQuICBJdCdzIG1vcmUgY29ycmVjdCB0byBzYXkgYSAxCisJCSAqIHRvIDAg
dHJhbnNpdGlvbiBpbmRpY2F0ZXMgYSBjYXB0dXJlIGNvbXBsZXRlZC4gIElmIGEKKwkJICogY2Fw
dHVyZSBpcyBwZW5kaW5nIHdoZW4gY2FwdHVyaW5nIGlzIHR1bmVkIG9mZiwgRnJhbWVHcmFiCisJ
CSAqIHdpbGwgYmUgc3R1Y2sgYXQgMSB1bnRpbCBjYXB0dXJpbmcgaXMgdHVybmVkIGJhY2sgb24u
CisJCSAqLworCQlpZiAoYnRyZWFkKFpSMzYwNTdfVlNTRkdSKSAmIFpSMzYwNTdfVlNTRkdSX1Nu
YXBTaG90KQorCQkJZHByaW50aygxLAorCQkJCUtFUk5fV0FSTklORworCQkJCSIlczogenIzNjA1
N19zZXRfbWVtZ3JhYigxKSB3aXRoIFNuYXBTaG90IG9uIT9cbiIsCisJCQkJWlJfREVWTkFNRSh6
cikpOworCisJCS8qIHN3aXRjaCBvbiBWU3luYyBpbnRlcnJ1cHRzICovCisJCWJ0d3JpdGUoSVJR
X01BU0ssIFpSMzYwNTdfSVNSKTsJLy8gQ2xlYXIgSW50ZXJydXB0cworCQlidG9yKHpyLT5jYXJk
LnZzeW5jX2ludCwgWlIzNjA1N19JQ1IpOwkvLyBTVworCisJCS8qIGVuYWJsZSBTbmFwU2hvdCAq
LworCQlidG9yKFpSMzYwNTdfVlNTRkdSX1NuYXBTaG90LCBaUjM2MDU3X1ZTU0ZHUik7CisKKwkJ
LyogU2V0IHpyMzYwNTcgdmlkZW8gZnJvbnQgZW5kICBhbmQgZW5hYmxlIHZpZGVvICovCisJCXpy
MzYwNTdfc2V0X3ZmZSh6ciwgenItPnY0bF9zZXR0aW5ncy53aWR0aCwKKwkJCQl6ci0+djRsX3Nl
dHRpbmdzLmhlaWdodCwKKwkJCQl6ci0+djRsX3NldHRpbmdzLmZvcm1hdCk7CisKKwkJenItPnY0
bF9tZW1ncmFiX2FjdGl2ZSA9IDE7CisJfSBlbHNlIHsKKwkJLyogc3dpdGNoIG9mZiBWU3luYyBp
bnRlcnJ1cHRzICovCisJCWJ0YW5kKH56ci0+Y2FyZC52c3luY19pbnQsIFpSMzYwNTdfSUNSKTsJ
Ly8gU1cKKworCQl6ci0+djRsX21lbWdyYWJfYWN0aXZlID0gMDsKKwkJenItPnY0bF9ncmFiX2Zy
YW1lID0gTk9fR1JBQl9BQ1RJVkU7CisKKwkJLyogcmUtZW5hYmxlIGdyYWJiaW5nIHRvIHNjcmVl
biBpZiBpdCB3YXMgcnVubmluZyAqLworCQlpZiAoenItPnY0bF9vdmVybGF5X2FjdGl2ZSkgewor
CQkJenIzNjA1N19vdmVybGF5KHpyLCAxKTsKKwkJfSBlbHNlIHsKKwkJCWJ0YW5kKH5aUjM2MDU3
X1ZEQ1JfVmlkRW4sIFpSMzYwNTdfVkRDUik7CisJCQlidGFuZCh+WlIzNjA1N19WU1NGR1JfU25h
cFNob3QsIFpSMzYwNTdfVlNTRkdSKTsKKwkJfQorCX0KK30KKworaW50Cit3YWl0X2dyYWJfcGVu
ZGluZyAoc3RydWN0IHpvcmFuICp6cikKK3sKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCisJLyog
d2FpdCB1bnRpbCBhbGwgcGVuZGluZyBncmFicyBhcmUgZmluaXNoZWQgKi8KKworCWlmICghenIt
PnY0bF9tZW1ncmFiX2FjdGl2ZSkKKwkJcmV0dXJuIDA7CisKKwl3YWl0X2V2ZW50X2ludGVycnVw
dGlibGUoenItPnY0bF9jYXBxLAorCQkJKHpyLT52NGxfcGVuZF90YWlsID09IHpyLT52NGxfcGVu
ZF9oZWFkKSk7CisJaWYgKHNpZ25hbF9wZW5kaW5nKGN1cnJlbnQpKQorCQlyZXR1cm4gLUVSRVNU
QVJUU1lTOworCisJc3Bpbl9sb2NrX2lycXNhdmUoJnpyLT5zcGlubG9jaywgZmxhZ3MpOworCXpy
MzYwNTdfc2V0X21lbWdyYWIoenIsIDApOworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnpyLT5z
cGlubG9jaywgZmxhZ3MpOworCisJcmV0dXJuIDA7Cit9CisKKy8qKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KgorICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAqCisgKiAgU2V0IHVwIHRoZSBCdXotc3BlY2lmaWMgTUpQ
RUcgcGFydCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKKyAqICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKgorICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLworCitzdGF0aWMgaW5saW5lIHZv
aWQKK3NldF9mcmFtZSAoc3RydWN0IHpvcmFuICp6ciwKKwkgICBpbnQgICAgICAgICAgIHZhbCkK
K3sKKwlHUElPKHpyLCB6ci0+Y2FyZC5ncGlvW1pSX0dQSU9fSlBFR19GUkFNRV0sIHZhbCk7Cit9
CisKK3N0YXRpYyB2b2lkCitzZXRfdmlkZW9idXNfZGlyIChzdHJ1Y3Qgem9yYW4gKnpyLAorCQkg
IGludCAgICAgICAgICAgdmFsKQoreworCXN3aXRjaCAoenItPmNhcmQudHlwZSkgeworCWNhc2Ug
TE1MMzM6CisJY2FzZSBMTUwzM1IxMDoKKwkJaWYgKCFsbWwzM2RwYXRoKQorCQkJR1BJTyh6ciwg
NSwgdmFsKTsKKwkJZWxzZQorCQkJR1BJTyh6ciwgNSwgMSk7CisJCWJyZWFrOworCWRlZmF1bHQ6
CisJCUdQSU8oenIsIHpyLT5jYXJkLmdwaW9bWlJfR1BJT19WSURfRElSXSwKKwkJICAgICB6ci0+
Y2FyZC5ncGlvX3BvbFtaUl9HUElPX1ZJRF9ESVJdID8gIXZhbCA6IHZhbCk7CisJCWJyZWFrOwor
CX0KK30KKworc3RhdGljIHZvaWQKK2luaXRfanBlZ19xdWV1ZSAoc3RydWN0IHpvcmFuICp6cikK
K3sKKwlpbnQgaTsKKworCS8qIHJlLWluaXRpYWxpemUgRE1BIHJpbmcgc3R1ZmYgKi8KKwl6ci0+
anBnX3F1ZV9oZWFkID0gMDsKKwl6ci0+anBnX2RtYV9oZWFkID0gMDsKKwl6ci0+anBnX2RtYV90
YWlsID0gMDsKKwl6ci0+anBnX3F1ZV90YWlsID0gMDsKKwl6ci0+anBnX3NlcV9udW0gPSAwOwor
CXpyLT5KUEVHX2Vycm9yID0gMDsKKwl6ci0+bnVtX2Vycm9ycyA9IDA7CisJenItPmpwZ19lcnJf
c2VxID0gMDsKKwl6ci0+anBnX2Vycl9zaGlmdCA9IDA7CisJenItPmpwZ19xdWV1ZWRfbnVtID0g
MDsKKwlmb3IgKGkgPSAwOyBpIDwgenItPmpwZ19idWZmZXJzLm51bV9idWZmZXJzOyBpKyspIHsK
KwkJenItPmpwZ19idWZmZXJzLmJ1ZmZlcltpXS5zdGF0ZSA9IEJVWl9TVEFURV9VU0VSOwkvKiBu
b3RoaW5nIGdvaW5nIG9uICovCisJfQorCWZvciAoaSA9IDA7IGkgPCBCVVpfTlVNX1NUQVRfQ09N
OyBpKyspIHsKKwkJenItPnN0YXRfY29tW2ldID0gY3B1X3RvX2xlMzIoMSk7CS8qIG1hcmsgYXMg
dW5hdmFpbGFibGUgdG8genIzNjA1NyAqLworCX0KK30KKworc3RhdGljIHZvaWQKK3pyMzYwNTdf
c2V0X2pwZyAoc3RydWN0IHpvcmFuICAgICAgICAgICp6ciwKKwkJIGVudW0gem9yYW5fY29kZWNf
bW9kZSAgbW9kZSkKK3sKKwlzdHJ1Y3QgdHZub3JtICp0dm47CisJdTMyIHJlZzsKKworCXR2biA9
IHpyLT50aW1pbmc7CisKKwkvKiBhc3NlcnQgUF9SZXNldCwgZGlzYWJsZSBjb2RlIHRyYW5zZmVy
LCBkZWFzc2VydCBBY3RpdmUgKi8KKwlidHdyaXRlKDAsIFpSMzYwNTdfSlBDKTsKKworCS8qIE1K
UEVHIGNvbXByZXNzaW9uIG1vZGUgKi8KKwlzd2l0Y2ggKG1vZGUpIHsKKworCWNhc2UgQlVaX01P
REVfTU9USU9OX0NPTVBSRVNTOgorCWRlZmF1bHQ6CisJCXJlZyA9IFpSMzYwNTdfSk1DX01KUEdD
bXBNb2RlOworCQlicmVhazsKKworCWNhc2UgQlVaX01PREVfTU9USU9OX0RFQ09NUFJFU1M6CisJ
CXJlZyA9IFpSMzYwNTdfSk1DX01KUEdFeHBNb2RlOworCQlyZWcgfD0gWlIzNjA1N19KTUNfU3lu
Y01zdHI7CisJCS8qIFJKOiBUaGUgZm9sbG93aW5nIGlzIGV4cGVyaW1lbnRhbCAtIGltcHJvdmVz
IHRoZSBvdXRwdXQgdG8gc2NyZWVuICovCisJCS8vaWYoenItPmpwZ19zZXR0aW5ncy5WRklGT19G
QikgcmVnIHw9IFpSMzYwNTdfSk1DX1ZGSUZPX0ZCOyAvLyBObywgaXQgZG9lc24ndC4gU00KKwkJ
YnJlYWs7CisKKwljYXNlIEJVWl9NT0RFX1NUSUxMX0NPTVBSRVNTOgorCQlyZWcgPSBaUjM2MDU3
X0pNQ19KUEdDbXBNb2RlOworCQlicmVhazsKKworCWNhc2UgQlVaX01PREVfU1RJTExfREVDT01Q
UkVTUzoKKwkJcmVnID0gWlIzNjA1N19KTUNfSlBHRXhwTW9kZTsKKwkJYnJlYWs7CisKKwl9CisJ
cmVnIHw9IFpSMzYwNTdfSk1DX0pQRzsKKwlpZiAoenItPmpwZ19zZXR0aW5ncy5maWVsZF9wZXJf
YnVmZiA9PSAxKQorCQlyZWcgfD0gWlIzNjA1N19KTUNfRmxkX3Blcl9idWZmOworCWJ0d3JpdGUo
cmVnLCBaUjM2MDU3X0pNQyk7CisKKwkvKiB2ZXJ0aWNhbCAqLworCWJ0b3IoWlIzNjA1N19WRkVW
Q1JfVlNQb2wsIFpSMzYwNTdfVkZFVkNSKTsKKwlyZWcgPSAoNiA8PCBaUjM2MDU3X1ZTUF9Wc3lu
Y1NpemUpIHwKKwkgICAgICAodHZuLT5IdCA8PCBaUjM2MDU3X1ZTUF9Gcm1Ub3QpOworCWJ0d3Jp
dGUocmVnLCBaUjM2MDU3X1ZTUCk7CisJcmVnID0gKCh6ci0+anBnX3NldHRpbmdzLmltZ195ICsg
dHZuLT5WU3RhcnQpIDw8IFpSMzYwNTdfRlZBUF9OQVkpIHwKKwkgICAgICAoenItPmpwZ19zZXR0
aW5ncy5pbWdfaGVpZ2h0IDw8IFpSMzYwNTdfRlZBUF9QQVkpOworCWJ0d3JpdGUocmVnLCBaUjM2
MDU3X0ZWQVApOworCisJLyogaG9yaXpvbnRhbCAqLworCWlmICh6ci0+Y2FyZC52ZmVfcG9sLmhz
eW5jX3BvbCkKKwkJYnRvcihaUjM2MDU3X1ZGRUhDUl9IU1BvbCwgWlIzNjA1N19WRkVIQ1IpOwor
CWVsc2UKKwkJYnRhbmQoflpSMzYwNTdfVkZFSENSX0hTUG9sLCBaUjM2MDU3X1ZGRUhDUik7CisJ
cmVnID0gKCh0dm4tPkhTeW5jU3RhcnQpIDw8IFpSMzYwNTdfSFNQX0hzeW5jU3RhcnQpIHwKKwkg
ICAgICAodHZuLT5XdCA8PCBaUjM2MDU3X0hTUF9MaW5lVG90KTsKKwlidHdyaXRlKHJlZywgWlIz
NjA1N19IU1ApOworCXJlZyA9ICgoenItPmpwZ19zZXR0aW5ncy5pbWdfeCArCisJCXR2bi0+SFN0
YXJ0ICsgNCkgPDwgWlIzNjA1N19GSEFQX05BWCkgfAorCSAgICAgICh6ci0+anBnX3NldHRpbmdz
LmltZ193aWR0aCA8PCBaUjM2MDU3X0ZIQVBfUEFYKTsKKwlidHdyaXRlKHJlZywgWlIzNjA1N19G
SEFQKTsKKworCS8qIGZpZWxkIHByb2Nlc3MgcGFyYW1ldGVycyAqLworCWlmICh6ci0+anBnX3Nl
dHRpbmdzLm9kZF9ldmVuKQorCQlyZWcgPSBaUjM2MDU3X0ZQUF9PZGRfRXZlbjsKKwllbHNlCisJ
CXJlZyA9IDA7CisKKwlidHdyaXRlKHJlZywgWlIzNjA1N19GUFApOworCisJLyogU2V0IHByb3Bl
ciBWQ0xLIFBvbGFyaXR5LCBlbHNlIGNvbG9ycyB3aWxsIGJlIHdyb25nIGR1cmluZyBwbGF5YmFj
ayAqLworCS8vYnRvcihaUjM2MDU3X1ZGRVNQRlJfVkNMS1BvbCwgWlIzNjA1N19WRkVTUEZSKTsK
KworCS8qIGNvZGUgYmFzZSBhZGRyZXNzICovCisJcmVnID0gdmlydF90b19idXMoenItPnN0YXRf
Y29tKTsKKwlidHdyaXRlKHJlZywgWlIzNjA1N19KQ0JBKTsKKworCS8qIEZJRk8gdGhyZXNob2xk
IChGSUZPIGlzIDE2MC4gZG91YmxlIHdvcmRzKSAqLworCS8qIE5PVEU6IGRlY2ltYWwgdmFsdWVz
IGhlcmUgKi8KKwlzd2l0Y2ggKG1vZGUpIHsKKworCWNhc2UgQlVaX01PREVfU1RJTExfQ09NUFJF
U1M6CisJY2FzZSBCVVpfTU9ERV9NT1RJT05fQ09NUFJFU1M6CisJCWlmICh6ci0+Y2FyZC50eXBl
ICE9IEJVWikKKwkJCXJlZyA9IDE0MDsKKwkJZWxzZQorCQkJcmVnID0gNjA7CisJCWJyZWFrOwor
CisJY2FzZSBCVVpfTU9ERV9TVElMTF9ERUNPTVBSRVNTOgorCWNhc2UgQlVaX01PREVfTU9USU9O
X0RFQ09NUFJFU1M6CisJCXJlZyA9IDIwOworCQlicmVhazsKKworCWRlZmF1bHQ6CisJCXJlZyA9
IDgwOworCQlicmVhazsKKworCX0KKwlidHdyaXRlKHJlZywgWlIzNjA1N19KQ0ZUKTsKKwl6cjM2
MDU3X2FkanVzdF92ZmUoenIsIG1vZGUpOworCit9CisKK3ZvaWQKK3ByaW50X2ludGVycnVwdHMg
KHN0cnVjdCB6b3JhbiAqenIpCit7CisJaW50IHJlcywgbm9lcnIgPSAwOworCisJcHJpbnRrKEtF
Uk5fSU5GTyAiJXM6IGludGVycnVwdHMgcmVjZWl2ZWQ6IiwgWlJfREVWTkFNRSh6cikpOworCWlm
ICgocmVzID0genItPmZpZWxkX2NvdW50ZXIpIDwgLTEgfHwgcmVzID4gMSkgeworCQlwcmludGso
S0VSTl9DT05UICIgRkQ6JWQiLCByZXMpOworCX0KKwlpZiAoKHJlcyA9IHpyLT5pbnRyX2NvdW50
ZXJfR0lSUTEpICE9IDApIHsKKwkJcHJpbnRrKEtFUk5fQ09OVCAiIEdJUlExOiVkIiwgcmVzKTsK
KwkJbm9lcnIrKzsKKwl9CisJaWYgKChyZXMgPSB6ci0+aW50cl9jb3VudGVyX0dJUlEwKSAhPSAw
KSB7CisJCXByaW50ayhLRVJOX0NPTlQgIiBHSVJRMDolZCIsIHJlcyk7CisJCW5vZXJyKys7CisJ
fQorCWlmICgocmVzID0genItPmludHJfY291bnRlcl9Db2RSZXBJUlEpICE9IDApIHsKKwkJcHJp
bnRrKEtFUk5fQ09OVCAiIENvZFJlcElSUTolZCIsIHJlcyk7CisJCW5vZXJyKys7CisJfQorCWlm
ICgocmVzID0genItPmludHJfY291bnRlcl9KUEVHUmVwSVJRKSAhPSAwKSB7CisJCXByaW50ayhL
RVJOX0NPTlQgIiBKUEVHUmVwSVJROiVkIiwgcmVzKTsKKwkJbm9lcnIrKzsKKwl9CisJaWYgKHpy
LT5KUEVHX21heF9taXNzZWQpIHsKKwkJcHJpbnRrKEtFUk5fQ09OVCAiIEpQRUcgZGVsYXlzOiBt
YXg9JWQgbWluPSVkIiwgenItPkpQRUdfbWF4X21pc3NlZCwKKwkJICAgICAgIHpyLT5KUEVHX21p
bl9taXNzZWQpOworCX0KKwlpZiAoenItPkVORF9ldmVudF9taXNzZWQpIHsKKwkJcHJpbnRrKEtF
Uk5fQ09OVCAiIEVORHMgbWlzc2VkOiAlZCIsIHpyLT5FTkRfZXZlbnRfbWlzc2VkKTsKKwl9CisJ
Ly9pZiAoenItPmpwZ19xdWV1ZWRfbnVtKSB7CisJcHJpbnRrKEtFUk5fQ09OVCAiIHF1ZXVlX3N0
YXRlPSVsZC8lbGQvJWxkLyVsZCIsIHpyLT5qcGdfcXVlX3RhaWwsCisJICAgICAgIHpyLT5qcGdf
ZG1hX3RhaWwsIHpyLT5qcGdfZG1hX2hlYWQsIHpyLT5qcGdfcXVlX2hlYWQpOworCS8vfQorCWlm
ICghbm9lcnIpIHsKKwkJcHJpbnRrKEtFUk5fQ09OVCAiOiBubyBpbnRlcnJ1cHRzIGRldGVjdGVk
LiIpOworCX0KKwlwcmludGsoS0VSTl9DT05UICJcbiIpOworfQorCit2b2lkCitjbGVhcl9pbnRl
cnJ1cHRfY291bnRlcnMgKHN0cnVjdCB6b3JhbiAqenIpCit7CisJenItPmludHJfY291bnRlcl9H
SVJRMSA9IDA7CisJenItPmludHJfY291bnRlcl9HSVJRMCA9IDA7CisJenItPmludHJfY291bnRl
cl9Db2RSZXBJUlEgPSAwOworCXpyLT5pbnRyX2NvdW50ZXJfSlBFR1JlcElSUSA9IDA7CisJenIt
PmZpZWxkX2NvdW50ZXIgPSAwOworCXpyLT5JUlExX2luID0gMDsKKwl6ci0+SVJRMV9vdXQgPSAw
OworCXpyLT5KUEVHX2luID0gMDsKKwl6ci0+SlBFR19vdXQgPSAwOworCXpyLT5KUEVHXzAgPSAw
OworCXpyLT5KUEVHXzEgPSAwOworCXpyLT5FTkRfZXZlbnRfbWlzc2VkID0gMDsKKwl6ci0+SlBF
R19taXNzZWQgPSAwOworCXpyLT5KUEVHX21heF9taXNzZWQgPSAwOworCXpyLT5KUEVHX21pbl9t
aXNzZWQgPSAweDdmZmZmZmZmOworfQorCitzdGF0aWMgdTMyCitjb3VudF9yZXNldF9pbnRlcnJ1
cHQgKHN0cnVjdCB6b3JhbiAqenIpCit7CisJdTMyIGlzcjsKKworCWlmICgoaXNyID0gYnRyZWFk
KFpSMzYwNTdfSVNSKSAmIDB4NzgwMDAwMDApKSB7CisJCWlmIChpc3IgJiBaUjM2MDU3X0lTUl9H
SVJRMSkgeworCQkJYnR3cml0ZShaUjM2MDU3X0lTUl9HSVJRMSwgWlIzNjA1N19JU1IpOworCQkJ
enItPmludHJfY291bnRlcl9HSVJRMSsrOworCQl9CisJCWlmIChpc3IgJiBaUjM2MDU3X0lTUl9H
SVJRMCkgeworCQkJYnR3cml0ZShaUjM2MDU3X0lTUl9HSVJRMCwgWlIzNjA1N19JU1IpOworCQkJ
enItPmludHJfY291bnRlcl9HSVJRMCsrOworCQl9CisJCWlmIChpc3IgJiBaUjM2MDU3X0lTUl9D
b2RSZXBJUlEpIHsKKwkJCWJ0d3JpdGUoWlIzNjA1N19JU1JfQ29kUmVwSVJRLCBaUjM2MDU3X0lT
Uik7CisJCQl6ci0+aW50cl9jb3VudGVyX0NvZFJlcElSUSsrOworCQl9CisJCWlmIChpc3IgJiBa
UjM2MDU3X0lTUl9KUEVHUmVwSVJRKSB7CisJCQlidHdyaXRlKFpSMzYwNTdfSVNSX0pQRUdSZXBJ
UlEsIFpSMzYwNTdfSVNSKTsKKwkJCXpyLT5pbnRyX2NvdW50ZXJfSlBFR1JlcElSUSsrOworCQl9
CisJfQorCXJldHVybiBpc3I7Cit9CisKK3ZvaWQKK2pwZWdfc3RhcnQgKHN0cnVjdCB6b3JhbiAq
enIpCit7CisJaW50IHJlZzsKKworCXpyLT5mcmFtZV9udW0gPSAwOworCisJLyogZGVhc3NlcnQg
UF9yZXNldCwgZGlzYWJsZSBjb2RlIHRyYW5zZmVyLCBkZWFzc2VydCBBY3RpdmUgKi8KKwlidHdy
aXRlKFpSMzYwNTdfSlBDX1BfUmVzZXQsIFpSMzYwNTdfSlBDKTsKKwkvKiBzdG9wIGZsdXNoaW5n
IHRoZSBpbnRlcm5hbCBjb2RlIGJ1ZmZlciAqLworCWJ0YW5kKH5aUjM2MDU3X01DVENSX0NGbHVz
aCwgWlIzNjA1N19NQ1RDUik7CisJLyogZW5hYmxlIGNvZGUgdHJhbnNmZXIgKi8KKwlidG9yKFpS
MzYwNTdfSlBDX0NvZFRybnNFbiwgWlIzNjA1N19KUEMpOworCisJLyogY2xlYXIgSVJRcyAqLwor
CWJ0d3JpdGUoSVJRX01BU0ssIFpSMzYwNTdfSVNSKTsKKwkvKiBlbmFibGUgdGhlIEpQRUcgSVJR
cyAqLworCWJ0d3JpdGUoenItPmNhcmQuanBlZ19pbnQgfAorCQkJWlIzNjA1N19JQ1JfSlBFR1Jl
cElSUSB8CisJCQlaUjM2MDU3X0lDUl9JbnRQaW5FbiwKKwkJWlIzNjA1N19JQ1IpOworCisJc2V0
X2ZyYW1lKHpyLCAwKTsJLy8gXEZSQU1FCisKKwkvKiBzZXQgdGhlIEpQRUcgY29kZWMgZ3Vlc3Qg
SUQgKi8KKwlyZWcgPSAoenItPmNhcmQuZ3Bjc1sxXSA8PCBaUjM2MDU3X0pDR0lfSlBFR3Vlc3RJ
RCkgfAorCSAgICAgICAoMCA8PCBaUjM2MDU3X0pDR0lfSlBFR3Vlc3RSZWcpOworCWJ0d3JpdGUo
cmVnLCBaUjM2MDU3X0pDR0kpOworCisJaWYgKHpyLT5jYXJkLnZpZGVvX3ZmZSA9PSBDT0RFQ19U
WVBFX1pSMzYwMTYgJiYKKwkgICAgenItPmNhcmQudmlkZW9fY29kZWMgPT0gQ09ERUNfVFlQRV9a
UjM2MDUwKSB7CisJCS8qIEVuYWJsZSBwcm9jZXNzaW5nIG9uIHRoZSBaUjM2MDE2ICovCisJCWlm
ICh6ci0+dmZlKQorCQkJenIzNjAxNl93cml0ZSh6ci0+dmZlLCAwLCAxKTsKKworCQkvKiBsb2Fk
IHRoZSBhZGRyZXNzIG9mIHRoZSBHTyByZWdpc3RlciBpbiB0aGUgWlIzNjA1MCBsYXRjaCAqLwor
CQlwb3N0X29mZmljZV93cml0ZSh6ciwgMCwgMCwgMCk7CisJfQorCisJLyogYXNzZXJ0IEFjdGl2
ZSAqLworCWJ0b3IoWlIzNjA1N19KUENfQWN0aXZlLCBaUjM2MDU3X0pQQyk7CisKKwkvKiBlbmFi
bGUgdGhlIEdvIGdlbmVyYXRpb24gKi8KKwlidG9yKFpSMzYwNTdfSk1DX0dvX2VuLCBaUjM2MDU3
X0pNQyk7CisJdWRlbGF5KDMwKTsKKworCXNldF9mcmFtZSh6ciwgMSk7CS8vIC9GUkFNRQorCisJ
ZHByaW50aygzLCBLRVJOX0RFQlVHICIlczoganBlZ19zdGFydFxuIiwgWlJfREVWTkFNRSh6cikp
OworfQorCit2b2lkCit6cjM2MDU3X2VuYWJsZV9qcGcgKHN0cnVjdCB6b3JhbiAgICAgICAgICAq
enIsCisJCSAgICBlbnVtIHpvcmFuX2NvZGVjX21vZGUgIG1vZGUpCit7CisJc3RydWN0IHZmZV9z
ZXR0aW5ncyBjYXA7CisJaW50IGZpZWxkX3NpemUgPQorCSAgICB6ci0+anBnX2J1ZmZlcnMuYnVm
ZmVyX3NpemUgLyB6ci0+anBnX3NldHRpbmdzLmZpZWxkX3Blcl9idWZmOworCisJenItPmNvZGVj
X21vZGUgPSBtb2RlOworCisJY2FwLnggPSB6ci0+anBnX3NldHRpbmdzLmltZ194OworCWNhcC55
ID0genItPmpwZ19zZXR0aW5ncy5pbWdfeTsKKwljYXAud2lkdGggPSB6ci0+anBnX3NldHRpbmdz
LmltZ193aWR0aDsKKwljYXAuaGVpZ2h0ID0genItPmpwZ19zZXR0aW5ncy5pbWdfaGVpZ2h0Owor
CWNhcC5kZWNpbWF0aW9uID0KKwkgICAgenItPmpwZ19zZXR0aW5ncy5Ib3JEY20gfCAoenItPmpw
Z19zZXR0aW5ncy5WZXJEY20gPDwgOCk7CisJY2FwLnF1YWxpdHkgPSB6ci0+anBnX3NldHRpbmdz
LmpwZ19jb21wLnF1YWxpdHk7CisKKwlzd2l0Y2ggKG1vZGUpIHsKKworCWNhc2UgQlVaX01PREVf
TU9USU9OX0NPTVBSRVNTOiB7CisJCXN0cnVjdCBqcGVnX2FwcF9tYXJrZXIgYXBwOworCQlzdHJ1
Y3QganBlZ19jb21fbWFya2VyIGNvbTsKKworCQkvKiBJbiBtb3Rpb24gY29tcHJlc3MgbW9kZSwg
dGhlIGRlY29kZXIgb3V0cHV0IG11c3QgYmUgZW5hYmxlZCwgYW5kCisJCSAqIHRoZSB2aWRlbyBi
dXMgZGlyZWN0aW9uIHNldCB0byBpbnB1dC4KKwkJICovCisJCXNldF92aWRlb2J1c19kaXIoenIs
IDApOworCQlkZWNvZGVyX2NhbGwoenIsIHZpZGVvLCBzX3N0cmVhbSwgMSk7CisJCWVuY29kZXJf
Y2FsbCh6ciwgdmlkZW8sIHNfcm91dGluZywgMCwgMCwgMCk7CisKKwkJLyogVGFrZSB0aGUgSlBF
RyBjb2RlYyBhbmQgdGhlIFZGRSBvdXQgb2Ygc2xlZXAgKi8KKwkJanBlZ19jb2RlY19zbGVlcCh6
ciwgMCk7CisKKwkJLyogc2V0IEpQRUcgYXBwL2NvbSBtYXJrZXIgKi8KKwkJYXBwLmFwcG4gPSB6
ci0+anBnX3NldHRpbmdzLmpwZ19jb21wLkFQUG47CisJCWFwcC5sZW4gPSB6ci0+anBnX3NldHRp
bmdzLmpwZ19jb21wLkFQUF9sZW47CisJCW1lbWNweShhcHAuZGF0YSwgenItPmpwZ19zZXR0aW5n
cy5qcGdfY29tcC5BUFBfZGF0YSwgNjApOworCQl6ci0+Y29kZWMtPmNvbnRyb2woenItPmNvZGVj
LCBDT0RFQ19TX0pQRUdfQVBQX0RBVEEsCisJCQkJICAgc2l6ZW9mKHN0cnVjdCBqcGVnX2FwcF9t
YXJrZXIpLCAmYXBwKTsKKworCQljb20ubGVuID0genItPmpwZ19zZXR0aW5ncy5qcGdfY29tcC5D
T01fbGVuOworCQltZW1jcHkoY29tLmRhdGEsIHpyLT5qcGdfc2V0dGluZ3MuanBnX2NvbXAuQ09N
X2RhdGEsIDYwKTsKKwkJenItPmNvZGVjLT5jb250cm9sKHpyLT5jb2RlYywgQ09ERUNfU19KUEVH
X0NPTV9EQVRBLAorCQkJCSAgIHNpemVvZihzdHJ1Y3QganBlZ19jb21fbWFya2VyKSwgJmNvbSk7
CisKKwkJLyogU2V0dXAgdGhlIEpQRUcgY29kZWMgKi8KKwkJenItPmNvZGVjLT5jb250cm9sKHpy
LT5jb2RlYywgQ09ERUNfU19KUEVHX1REU19CWVRFLAorCQkJCSAgIHNpemVvZihpbnQpLCAmZmll
bGRfc2l6ZSk7CisJCXpyLT5jb2RlYy0+c2V0X3ZpZGVvKHpyLT5jb2RlYywgenItPnRpbWluZywg
JmNhcCwKKwkJCQkgICAgICZ6ci0+Y2FyZC52ZmVfcG9sKTsKKwkJenItPmNvZGVjLT5zZXRfbW9k
ZSh6ci0+Y29kZWMsIENPREVDX0RPX0NPTVBSRVNTSU9OKTsKKworCQkvKiBTZXR1cCB0aGUgVkZF
ICovCisJCWlmICh6ci0+dmZlKSB7CisJCQl6ci0+dmZlLT5jb250cm9sKHpyLT52ZmUsIENPREVD
X1NfSlBFR19URFNfQllURSwKKwkJCQkJIHNpemVvZihpbnQpLCAmZmllbGRfc2l6ZSk7CisJCQl6
ci0+dmZlLT5zZXRfdmlkZW8oenItPnZmZSwgenItPnRpbWluZywgJmNhcCwKKwkJCQkJICAgJnpy
LT5jYXJkLnZmZV9wb2wpOworCQkJenItPnZmZS0+c2V0X21vZGUoenItPnZmZSwgQ09ERUNfRE9f
Q09NUFJFU1NJT04pOworCQl9CisKKwkJaW5pdF9qcGVnX3F1ZXVlKHpyKTsKKwkJenIzNjA1N19z
ZXRfanBnKHpyLCBtb2RlKTsJLy8gXFBfUmVzZXQsIC4uLiBWaWRlbyBwYXJhbSwgRklGTworCisJ
CWNsZWFyX2ludGVycnVwdF9jb3VudGVycyh6cik7CisJCWRwcmludGsoMiwgS0VSTl9JTkZPICIl
czogZW5hYmxlX2pwZyhNT1RJT05fQ09NUFJFU1MpXG4iLAorCQkJWlJfREVWTkFNRSh6cikpOwor
CQlicmVhazsKKwl9CisKKwljYXNlIEJVWl9NT0RFX01PVElPTl9ERUNPTVBSRVNTOgorCQkvKiBJ
biBtb3Rpb24gZGVjb21wcmVzc2lvbiBtb2RlLCB0aGUgZGVjb2RlciBvdXRwdXQgbXVzdCBiZSBk
aXNhYmxlZCwgYW5kCisJCSAqIHRoZSB2aWRlbyBidXMgZGlyZWN0aW9uIHNldCB0byBvdXRwdXQu
CisJCSAqLworCQlkZWNvZGVyX2NhbGwoenIsIHZpZGVvLCBzX3N0cmVhbSwgMCk7CisJCXNldF92
aWRlb2J1c19kaXIoenIsIDEpOworCQllbmNvZGVyX2NhbGwoenIsIHZpZGVvLCBzX3JvdXRpbmcs
IDEsIDAsIDApOworCisJCS8qIFRha2UgdGhlIEpQRUcgY29kZWMgYW5kIHRoZSBWRkUgb3V0IG9m
IHNsZWVwICovCisJCWpwZWdfY29kZWNfc2xlZXAoenIsIDApOworCQkvKiBTZXR1cCB0aGUgVkZF
ICovCisJCWlmICh6ci0+dmZlKSB7CisJCQl6ci0+dmZlLT5zZXRfdmlkZW8oenItPnZmZSwgenIt
PnRpbWluZywgJmNhcCwKKwkJCQkJICAgJnpyLT5jYXJkLnZmZV9wb2wpOworCQkJenItPnZmZS0+
c2V0X21vZGUoenItPnZmZSwgQ09ERUNfRE9fRVhQQU5TSU9OKTsKKwkJfQorCQkvKiBTZXR1cCB0
aGUgSlBFRyBjb2RlYyAqLworCQl6ci0+Y29kZWMtPnNldF92aWRlbyh6ci0+Y29kZWMsIHpyLT50
aW1pbmcsICZjYXAsCisJCQkJICAgICAmenItPmNhcmQudmZlX3BvbCk7CisJCXpyLT5jb2RlYy0+
c2V0X21vZGUoenItPmNvZGVjLCBDT0RFQ19ET19FWFBBTlNJT04pOworCisJCWluaXRfanBlZ19x
dWV1ZSh6cik7CisJCXpyMzYwNTdfc2V0X2pwZyh6ciwgbW9kZSk7CS8vIFxQX1Jlc2V0LCAuLi4g
VmlkZW8gcGFyYW0sIEZJRk8KKworCQljbGVhcl9pbnRlcnJ1cHRfY291bnRlcnMoenIpOworCQlk
cHJpbnRrKDIsIEtFUk5fSU5GTyAiJXM6IGVuYWJsZV9qcGcoTU9USU9OX0RFQ09NUFJFU1MpXG4i
LAorCQkJWlJfREVWTkFNRSh6cikpOworCQlicmVhazsKKworCWNhc2UgQlVaX01PREVfSURMRToK
KwlkZWZhdWx0OgorCQkvKiBzaHV0IGRvd24gcHJvY2Vzc2luZyAqLworCQlidGFuZCh+KHpyLT5j
YXJkLmpwZWdfaW50IHwgWlIzNjA1N19JQ1JfSlBFR1JlcElSUSksCisJCSAgICAgIFpSMzYwNTdf
SUNSKTsKKwkJYnR3cml0ZSh6ci0+Y2FyZC5qcGVnX2ludCB8IFpSMzYwNTdfSUNSX0pQRUdSZXBJ
UlEsCisJCQlaUjM2MDU3X0lTUik7CisJCWJ0YW5kKH5aUjM2MDU3X0pNQ19Hb19lbiwgWlIzNjA1
N19KTUMpOwkvLyBcR29fZW4KKworCQltc2xlZXAoNTApOworCisJCXNldF92aWRlb2J1c19kaXIo
enIsIDApOworCQlzZXRfZnJhbWUoenIsIDEpOwkvLyAvRlJBTUUKKwkJYnRvcihaUjM2MDU3X01D
VENSX0NGbHVzaCwgWlIzNjA1N19NQ1RDUik7CS8vIC9DRmx1c2gKKwkJYnR3cml0ZSgwLCBaUjM2
MDU3X0pQQyk7CS8vIFxQX1Jlc2V0LFxDb2RUcm5zRW4sXEFjdGl2ZQorCQlidGFuZCh+WlIzNjA1
N19KTUNfVkZJRk9fRkIsIFpSMzYwNTdfSk1DKTsKKwkJYnRhbmQoflpSMzYwNTdfSk1DX1N5bmNN
c3RyLCBaUjM2MDU3X0pNQyk7CisJCWpwZWdfY29kZWNfcmVzZXQoenIpOworCQlqcGVnX2NvZGVj
X3NsZWVwKHpyLCAxKTsKKwkJenIzNjA1N19hZGp1c3RfdmZlKHpyLCBtb2RlKTsKKworCQlkZWNv
ZGVyX2NhbGwoenIsIHZpZGVvLCBzX3N0cmVhbSwgMSk7CisJCWVuY29kZXJfY2FsbCh6ciwgdmlk
ZW8sIHNfcm91dGluZywgMCwgMCwgMCk7CisKKwkJZHByaW50aygyLCBLRVJOX0lORk8gIiVzOiBl
bmFibGVfanBnKElETEUpXG4iLCBaUl9ERVZOQU1FKHpyKSk7CisJCWJyZWFrOworCisJfQorfQor
CisvKiB3aGVuIHRoaXMgaXMgY2FsbGVkIHRoZSBzcGlubG9jayBtdXN0IGJlIGhlbGQgKi8KK3Zv
aWQKK3pvcmFuX2ZlZWRfc3RhdF9jb20gKHN0cnVjdCB6b3JhbiAqenIpCit7CisJLyogbW92ZSBm
cmFtZXMgZnJvbSBwZW5kaW5nIHF1ZXVlIHRvIERNQSAqLworCisJaW50IGZyYW1lLCBpLCBtYXhf
c3RhdF9jb207CisKKwltYXhfc3RhdF9jb20gPQorCSAgICAoenItPmpwZ19zZXR0aW5ncy5UbXBE
Y20gPT0KKwkgICAgIDEpID8gQlVaX05VTV9TVEFUX0NPTSA6IChCVVpfTlVNX1NUQVRfQ09NID4+
IDEpOworCisJd2hpbGUgKCh6ci0+anBnX2RtYV9oZWFkIC0genItPmpwZ19kbWFfdGFpbCkgPCBt
YXhfc3RhdF9jb20gJiYKKwkgICAgICAgenItPmpwZ19kbWFfaGVhZCA8IHpyLT5qcGdfcXVlX2hl
YWQpIHsKKworCQlmcmFtZSA9IHpyLT5qcGdfcGVuZFt6ci0+anBnX2RtYV9oZWFkICYgQlVaX01B
U0tfRlJBTUVdOworCQlpZiAoenItPmpwZ19zZXR0aW5ncy5UbXBEY20gPT0gMSkgeworCQkJLyog
ZmlsbCAxIHN0YXRfY29tIGVudHJ5ICovCisJCQlpID0gKHpyLT5qcGdfZG1hX2hlYWQgLQorCQkJ
ICAgICB6ci0+anBnX2Vycl9zaGlmdCkgJiBCVVpfTUFTS19TVEFUX0NPTTsKKwkJCWlmICghKHpy
LT5zdGF0X2NvbVtpXSAmIGNwdV90b19sZTMyKDEpKSkKKwkJCQlicmVhazsKKwkJCXpyLT5zdGF0
X2NvbVtpXSA9CisJCQkgICAgY3B1X3RvX2xlMzIoenItPmpwZ19idWZmZXJzLmJ1ZmZlcltmcmFt
ZV0uanBnLmZyYWdfdGFiX2J1cyk7CisJCX0gZWxzZSB7CisJCQkvKiBmaWxsIDIgc3RhdF9jb20g
ZW50cmllcyAqLworCQkJaSA9ICgoenItPmpwZ19kbWFfaGVhZCAtCisJCQkgICAgICB6ci0+anBn
X2Vycl9zaGlmdCkgJiAxKSAqIDI7CisJCQlpZiAoISh6ci0+c3RhdF9jb21baV0gJiBjcHVfdG9f
bGUzMigxKSkpCisJCQkJYnJlYWs7CisJCQl6ci0+c3RhdF9jb21baV0gPQorCQkJICAgIGNwdV90
b19sZTMyKHpyLT5qcGdfYnVmZmVycy5idWZmZXJbZnJhbWVdLmpwZy5mcmFnX3RhYl9idXMpOwor
CQkJenItPnN0YXRfY29tW2kgKyAxXSA9CisJCQkgICAgY3B1X3RvX2xlMzIoenItPmpwZ19idWZm
ZXJzLmJ1ZmZlcltmcmFtZV0uanBnLmZyYWdfdGFiX2J1cyk7CisJCX0KKwkJenItPmpwZ19idWZm
ZXJzLmJ1ZmZlcltmcmFtZV0uc3RhdGUgPSBCVVpfU1RBVEVfRE1BOworCQl6ci0+anBnX2RtYV9o
ZWFkKys7CisKKwl9CisJaWYgKHpyLT5jb2RlY19tb2RlID09IEJVWl9NT0RFX01PVElPTl9ERUNP
TVBSRVNTKQorCQl6ci0+anBnX3F1ZXVlZF9udW0rKzsKK30KKworLyogd2hlbiB0aGlzIGlzIGNh
bGxlZCB0aGUgc3BpbmxvY2sgbXVzdCBiZSBoZWxkICovCitzdGF0aWMgdm9pZAorem9yYW5fcmVh
cF9zdGF0X2NvbSAoc3RydWN0IHpvcmFuICp6cikKK3sKKwkvKiBtb3ZlIGZyYW1lcyBmcm9tIERN
QSBxdWV1ZSB0byBkb25lIHF1ZXVlICovCisKKwlpbnQgaTsKKwl1MzIgc3RhdF9jb207CisJdW5z
aWduZWQgaW50IHNlcTsKKwl1bnNpZ25lZCBpbnQgZGlmOworCXN0cnVjdCB6b3Jhbl9idWZmZXIg
KmJ1ZmZlcjsKKwlpbnQgZnJhbWU7CisKKwkvKiBJbiBtb3Rpb24gZGVjb21wcmVzcyB3ZSBkb24n
dCBoYXZlIGEgaGFyZHdhcmUgZnJhbWUgY291bnRlciwKKwkgKiB3ZSBqdXN0IGNvdW50IHRoZSBp
bnRlcnJ1cHRzIGhlcmUgKi8KKworCWlmICh6ci0+Y29kZWNfbW9kZSA9PSBCVVpfTU9ERV9NT1RJ
T05fREVDT01QUkVTUykgeworCQl6ci0+anBnX3NlcV9udW0rKzsKKwl9CisJd2hpbGUgKHpyLT5q
cGdfZG1hX3RhaWwgPCB6ci0+anBnX2RtYV9oZWFkKSB7CisJCWlmICh6ci0+anBnX3NldHRpbmdz
LlRtcERjbSA9PSAxKQorCQkJaSA9ICh6ci0+anBnX2RtYV90YWlsIC0KKwkJCSAgICAgenItPmpw
Z19lcnJfc2hpZnQpICYgQlVaX01BU0tfU1RBVF9DT007CisJCWVsc2UKKwkJCWkgPSAoKHpyLT5q
cGdfZG1hX3RhaWwgLQorCQkJICAgICAgenItPmpwZ19lcnJfc2hpZnQpICYgMSkgKiAyICsgMTsK
KworCQlzdGF0X2NvbSA9IGxlMzJfdG9fY3B1KHpyLT5zdGF0X2NvbVtpXSk7CisKKwkJaWYgKChz
dGF0X2NvbSAmIDEpID09IDApIHsKKwkJCXJldHVybjsKKwkJfQorCQlmcmFtZSA9IHpyLT5qcGdf
cGVuZFt6ci0+anBnX2RtYV90YWlsICYgQlVaX01BU0tfRlJBTUVdOworCQlidWZmZXIgPSAmenIt
PmpwZ19idWZmZXJzLmJ1ZmZlcltmcmFtZV07CisJCWJ1ZmZlci0+YnMudHMgPSBrdGltZV9nZXRf
bnMoKTsKKworCQlpZiAoenItPmNvZGVjX21vZGUgPT0gQlVaX01PREVfTU9USU9OX0NPTVBSRVNT
KSB7CisJCQlidWZmZXItPmJzLmxlbmd0aCA9IChzdGF0X2NvbSAmIDB4N2ZmZmZmKSA+PiAxOwor
CisJCQkvKiB1cGRhdGUgc2VxdWVuY2UgbnVtYmVyIHdpdGggdGhlIGhlbHAgb2YgdGhlIGNvdW50
ZXIgaW4gc3RhdF9jb20gKi8KKworCQkJc2VxID0gKChzdGF0X2NvbSA+PiAyNCkgKyB6ci0+anBn
X2Vycl9zZXEpICYgMHhmZjsKKwkJCWRpZiA9IChzZXEgLSB6ci0+anBnX3NlcV9udW0pICYgMHhm
ZjsKKwkJCXpyLT5qcGdfc2VxX251bSArPSBkaWY7CisJCX0gZWxzZSB7CisJCQlidWZmZXItPmJz
Lmxlbmd0aCA9IDA7CisJCX0KKwkJYnVmZmVyLT5icy5zZXEgPQorCQkgICAgenItPmpwZ19zZXR0
aW5ncy5UbXBEY20gPT0KKwkJICAgIDIgPyAoenItPmpwZ19zZXFfbnVtID4+IDEpIDogenItPmpw
Z19zZXFfbnVtOworCQlidWZmZXItPnN0YXRlID0gQlVaX1NUQVRFX0RPTkU7CisKKwkJenItPmpw
Z19kbWFfdGFpbCsrOworCX0KK30KKworc3RhdGljIHZvaWQgem9yYW5fcmVzdGFydChzdHJ1Y3Qg
em9yYW4gKnpyKQoreworCS8qIE5vdyB0aGUgc3RhdF9jb21tIGJ1ZmZlciBpcyByZWFkeSBmb3Ig
cmVzdGFydCAqLworCXVuc2lnbmVkIGludCBzdGF0dXMgPSAwOworCWludCBtb2RlOworCisJaWYg
KHpyLT5jb2RlY19tb2RlID09IEJVWl9NT0RFX01PVElPTl9DT01QUkVTUykgeworCQlkZWNvZGVy
X2NhbGwoenIsIHZpZGVvLCBnX2lucHV0X3N0YXR1cywgJnN0YXR1cyk7CisJCW1vZGUgPSBDT0RF
Q19ET19DT01QUkVTU0lPTjsKKwl9IGVsc2UgeworCQlzdGF0dXMgPSBWNEwyX0lOX1NUX05PX1NJ
R05BTDsKKwkJbW9kZSA9IENPREVDX0RPX0VYUEFOU0lPTjsKKwl9CisJaWYgKHpyLT5jb2RlY19t
b2RlID09IEJVWl9NT0RFX01PVElPTl9ERUNPTVBSRVNTIHx8CisJICAgICEoc3RhdHVzICYgVjRM
Ml9JTl9TVF9OT19TSUdOQUwpKSB7CisJCS8qKioqKioqKioqIFJFU1RBUlQgY29kZSAqKioqKioq
KioqKioqLworCQlqcGVnX2NvZGVjX3Jlc2V0KHpyKTsKKwkJenItPmNvZGVjLT5zZXRfbW9kZSh6
ci0+Y29kZWMsIG1vZGUpOworCQl6cjM2MDU3X3NldF9qcGcoenIsIHpyLT5jb2RlY19tb2RlKTsK
KwkJanBlZ19zdGFydCh6cik7CisKKwkJaWYgKHpyLT5udW1fZXJyb3JzIDw9IDgpCisJCQlkcHJp
bnRrKDIsIEtFUk5fSU5GTyAiJXM6IFJlc3RhcnRcbiIsCisJCQkJWlJfREVWTkFNRSh6cikpOwor
CisJCXpyLT5KUEVHX21pc3NlZCA9IDA7CisJCXpyLT5KUEVHX2Vycm9yID0gMjsKKwkJLyoqKioq
KioqKiogRW5kIFJFU1RBUlQgY29kZSAqKioqKioqKioqKi8KKwl9Cit9CisKK3N0YXRpYyB2b2lk
CitlcnJvcl9oYW5kbGVyIChzdHJ1Y3Qgem9yYW4gKnpyLAorCSAgICAgICB1MzIgICAgICAgICAg
IGFzdGF0LAorCSAgICAgICB1MzIgICAgICAgICAgIHN0YXQpCit7CisJaW50IGk7CisKKwkvKiBU
aGlzIGlzIEpQRUcgZXJyb3IgaGFuZGxpbmcgcGFydCAqLworCWlmICh6ci0+Y29kZWNfbW9kZSAh
PSBCVVpfTU9ERV9NT1RJT05fQ09NUFJFU1MgJiYKKwkgICAgenItPmNvZGVjX21vZGUgIT0gQlVa
X01PREVfTU9USU9OX0RFQ09NUFJFU1MpIHsKKwkJcmV0dXJuOworCX0KKworCWlmICgoc3RhdCAm
IDEpID09IDAgJiYKKwkgICAgenItPmNvZGVjX21vZGUgPT0gQlVaX01PREVfTU9USU9OX0NPTVBS
RVNTICYmCisJICAgIHpyLT5qcGdfZG1hX3RhaWwgLSB6ci0+anBnX3F1ZV90YWlsID49IHpyLT5q
cGdfYnVmZmVycy5udW1fYnVmZmVycykgeworCQkvKiBObyBmcmVlIGJ1ZmZlcnMuLi4gKi8KKwkJ
em9yYW5fcmVhcF9zdGF0X2NvbSh6cik7CisJCXpvcmFuX2ZlZWRfc3RhdF9jb20oenIpOworCQl3
YWtlX3VwX2ludGVycnVwdGlibGUoJnpyLT5qcGdfY2FwcSk7CisJCXpyLT5KUEVHX21pc3NlZCA9
IDA7CisJCXJldHVybjsKKwl9CisKKwlpZiAoenItPkpQRUdfZXJyb3IgPT0gMSkgeworCQl6b3Jh
bl9yZXN0YXJ0KHpyKTsKKwkJcmV0dXJuOworCX0KKworCS8qCisJICogRmlyc3QgZW50cnk6IGVy
cm9yIGp1c3QgaGFwcGVuZWQgZHVyaW5nIG5vcm1hbCBvcGVyYXRpb24KKwkgKgorCSAqIEluIEJV
Wl9NT0RFX01PVElPTl9DT01QUkVTUzoKKwkgKgorCSAqIFBvc3NpYmxlIGdsaXRjaCBpbiBUViBz
aWduYWwuIEluIHRoaXMgY2FzZSB3ZSBzaG91bGQKKwkgKiBzdG9wIHRoZSBjb2RlYyBhbmQgd2Fp
dCBmb3IgZ29vZCBxdWFsaXR5IHNpZ25hbCBiZWZvcmUKKwkgKiByZXN0YXJ0aW5nIGl0IHRvIGF2
b2lkIGZ1cnRoZXIgcHJvYmxlbXMKKwkgKgorCSAqIEluIEJVWl9NT0RFX01PVElPTl9ERUNPTVBS
RVNTOgorCSAqCisJICogQmFkIEpQRUcgZnJhbWU6IHdlIGhhdmUgdG8gbWFyayBpdCBhcyBwcm9j
ZXNzZWQgKGNvZGVjIGNyYXNoZWQKKwkgKiBhbmQgd2FzIG5vdCBhYmxlIHRvIGRvIGl0IGl0c2Vs
ZiksIGFuZCB0byByZW1vdmUgaXQgZnJvbSBxdWV1ZS4KKwkgKi8KKwlidGFuZCh+WlIzNjA1N19K
TUNfR29fZW4sIFpSMzYwNTdfSk1DKTsKKwl1ZGVsYXkoMSk7CisJc3RhdCA9IHN0YXQgfCAocG9z
dF9vZmZpY2VfcmVhZCh6ciwgNywgMCkgJiAzKSA8PCA4OworCWJ0d3JpdGUoMCwgWlIzNjA1N19K
UEMpOworCWJ0b3IoWlIzNjA1N19NQ1RDUl9DRmx1c2gsIFpSMzYwNTdfTUNUQ1IpOworCWpwZWdf
Y29kZWNfcmVzZXQoenIpOworCWpwZWdfY29kZWNfc2xlZXAoenIsIDEpOworCXpyLT5KUEVHX2Vy
cm9yID0gMTsKKwl6ci0+bnVtX2Vycm9ycysrOworCisJLyogUmVwb3J0IGVycm9yICovCisJaWYg
KHpyMzYwNjdfZGVidWcgPiAxICYmIHpyLT5udW1fZXJyb3JzIDw9IDgpIHsKKwkJbG9uZyBmcmFt
ZTsKKwkJaW50IGo7CisKKwkJZnJhbWUgPSB6ci0+anBnX3BlbmRbenItPmpwZ19kbWFfdGFpbCAm
IEJVWl9NQVNLX0ZSQU1FXTsKKwkJcHJpbnRrKEtFUk5fRVJSCisJCSAgICAgICAiJXM6IEpQRUcg
ZXJyb3Igc3RhdD0weCUwOHgoMHglMDh4KSBxdWV1ZV9zdGF0ZT0lbGQvJWxkLyVsZC8lbGQgc2Vx
PSVsZCBmcmFtZT0lbGQuIENvZGVjIHN0b3BwZWQuICIsCisJCSAgICAgICBaUl9ERVZOQU1FKHpy
KSwgc3RhdCwgenItPmxhc3RfaXNyLAorCQkgICAgICAgenItPmpwZ19xdWVfdGFpbCwgenItPmpw
Z19kbWFfdGFpbCwKKwkJICAgICAgIHpyLT5qcGdfZG1hX2hlYWQsIHpyLT5qcGdfcXVlX2hlYWQs
CisJCSAgICAgICB6ci0+anBnX3NlcV9udW0sIGZyYW1lKTsKKwkJcHJpbnRrKEtFUk5fSU5GTyAi
c3RhdF9jb20gZnJhbWVzOiIpOworCQlmb3IgKGogPSAwOyBqIDwgQlVaX05VTV9TVEFUX0NPTTsg
aisrKSB7CisJCQlmb3IgKGkgPSAwOyBpIDwgenItPmpwZ19idWZmZXJzLm51bV9idWZmZXJzOyBp
KyspIHsKKwkJCQlpZiAobGUzMl90b19jcHUoenItPnN0YXRfY29tW2pdKSA9PSB6ci0+anBnX2J1
ZmZlcnMuYnVmZmVyW2ldLmpwZy5mcmFnX3RhYl9idXMpCisJCQkJCXByaW50ayhLRVJOX0NPTlQg
IiUgZC0+JWQiLCBqLCBpKTsKKwkJCX0KKwkJfQorCQlwcmludGsoS0VSTl9DT05UICJcbiIpOwor
CX0KKwkvKiBGaW5kIGFuIGVudHJ5IGluIHN0YXRfY29tIGFuZCByb3RhdGUgY29udGVudHMgKi8K
KwlpZiAoenItPmpwZ19zZXR0aW5ncy5UbXBEY20gPT0gMSkKKwkJaSA9ICh6ci0+anBnX2RtYV90
YWlsIC0genItPmpwZ19lcnJfc2hpZnQpICYgQlVaX01BU0tfU1RBVF9DT007CisJZWxzZQorCQlp
ID0gKCh6ci0+anBnX2RtYV90YWlsIC0genItPmpwZ19lcnJfc2hpZnQpICYgMSkgKiAyOworCWlm
ICh6ci0+Y29kZWNfbW9kZSA9PSBCVVpfTU9ERV9NT1RJT05fREVDT01QUkVTUykgeworCQkvKiBN
aW1pYyB6cjM2MDY3IG9wZXJhdGlvbiAqLworCQl6ci0+c3RhdF9jb21baV0gfD0gY3B1X3RvX2xl
MzIoMSk7CisJCWlmICh6ci0+anBnX3NldHRpbmdzLlRtcERjbSAhPSAxKQorCQkJenItPnN0YXRf
Y29tW2kgKyAxXSB8PSBjcHVfdG9fbGUzMigxKTsKKwkJLyogUmVmaWxsICovCisJCXpvcmFuX3Jl
YXBfc3RhdF9jb20oenIpOworCQl6b3Jhbl9mZWVkX3N0YXRfY29tKHpyKTsKKwkJd2FrZV91cF9p
bnRlcnJ1cHRpYmxlKCZ6ci0+anBnX2NhcHEpOworCQkvKiBGaW5kIGFuIGVudHJ5IGluIHN0YXRf
Y29tIGFnYWluIGFmdGVyIHJlZmlsbCAqLworCQlpZiAoenItPmpwZ19zZXR0aW5ncy5UbXBEY20g
PT0gMSkKKwkJCWkgPSAoenItPmpwZ19kbWFfdGFpbCAtIHpyLT5qcGdfZXJyX3NoaWZ0KSAmIEJV
Wl9NQVNLX1NUQVRfQ09NOworCQllbHNlCisJCQlpID0gKCh6ci0+anBnX2RtYV90YWlsIC0genIt
PmpwZ19lcnJfc2hpZnQpICYgMSkgKiAyOworCX0KKwlpZiAoaSkgeworCQkvKiBSb3RhdGUgc3Rh
dF9jb21tIGVudHJpZXMgdG8gbWFrZSBjdXJyZW50IGVudHJ5IGZpcnN0ICovCisJCWludCBqOwor
CQlfX2xlMzIgYnVzX2FkZHJbQlVaX05VTV9TVEFUX0NPTV07CisKKwkJLyogSGVyZSB3ZSBhcmUg
Y29weWluZyB0aGUgc3RhdF9jb20gYXJyYXksIHdoaWNoCisJCSAqIGlzIGFscmVhZHkgaW4gbGl0
dGxlIGVuZGlhbiBmb3JtYXQsIHNvCisJCSAqIG5vIGVuZGlhbiBjb252ZXJzaW9ucyBoZXJlCisJ
CSAqLworCQltZW1jcHkoYnVzX2FkZHIsIHpyLT5zdGF0X2NvbSwgc2l6ZW9mKGJ1c19hZGRyKSk7
CisKKwkJZm9yIChqID0gMDsgaiA8IEJVWl9OVU1fU1RBVF9DT007IGorKykKKwkJCXpyLT5zdGF0
X2NvbVtqXSA9IGJ1c19hZGRyWyhpICsgaikgJiBCVVpfTUFTS19TVEFUX0NPTV07CisKKwkJenIt
PmpwZ19lcnJfc2hpZnQgKz0gaTsKKwkJenItPmpwZ19lcnJfc2hpZnQgJj0gQlVaX01BU0tfU1RB
VF9DT007CisJfQorCWlmICh6ci0+Y29kZWNfbW9kZSA9PSBCVVpfTU9ERV9NT1RJT05fQ09NUFJF
U1MpCisJCXpyLT5qcGdfZXJyX3NlcSA9IHpyLT5qcGdfc2VxX251bTsJLyogKyAxOyAqLworCXpv
cmFuX3Jlc3RhcnQoenIpOworfQorCitpcnFyZXR1cm5fdAorem9yYW5faXJxIChpbnQgICAgICAg
ICAgICAgaXJxLAorCSAgIHZvaWQgICAgICAgICAgICpkZXZfaWQpCit7CisJdTMyIHN0YXQsIGFz
dGF0OworCWludCBjb3VudDsKKwlzdHJ1Y3Qgem9yYW4gKnpyOworCXVuc2lnbmVkIGxvbmcgZmxh
Z3M7CisKKwl6ciA9IGRldl9pZDsKKwljb3VudCA9IDA7CisKKwlpZiAoenItPnRlc3RpbmcpIHsK
KwkJLyogVGVzdGluZyBpbnRlcnJ1cHRzICovCisJCXNwaW5fbG9ja19pcnFzYXZlKCZ6ci0+c3Bp
bmxvY2ssIGZsYWdzKTsKKwkJd2hpbGUgKChzdGF0ID0gY291bnRfcmVzZXRfaW50ZXJydXB0KHpy
KSkpIHsKKwkJCWlmIChjb3VudCsrID4gMTAwKSB7CisJCQkJYnRhbmQoflpSMzYwNTdfSUNSX0lu
dFBpbkVuLCBaUjM2MDU3X0lDUik7CisJCQkJZHByaW50aygxLAorCQkJCQlLRVJOX0VSUgorCQkJ
CQkiJXM6IElSUSBsb2NrdXAgd2hpbGUgdGVzdGluZywgaXNyPTB4JTA4eCwgY2xlYXJlZCBpbnQg
bWFza1xuIiwKKwkJCQkJWlJfREVWTkFNRSh6ciksIHN0YXQpOworCQkJCXdha2VfdXBfaW50ZXJy
dXB0aWJsZSgmenItPnRlc3RfcSk7CisJCQl9CisJCX0KKwkJenItPmxhc3RfaXNyID0gc3RhdDsK
KwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmenItPnNwaW5sb2NrLCBmbGFncyk7CisJCXJldHVy
biBJUlFfSEFORExFRDsKKwl9CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmenItPnNwaW5sb2NrLCBm
bGFncyk7CisJd2hpbGUgKDEpIHsKKwkJLyogZ2V0L2NsZWFyIGludGVycnVwdCBzdGF0dXMgYml0
cyAqLworCQlzdGF0ID0gY291bnRfcmVzZXRfaW50ZXJydXB0KHpyKTsKKwkJYXN0YXQgPSBzdGF0
ICYgSVJRX01BU0s7CisJCWlmICghYXN0YXQpIHsKKwkJCWJyZWFrOworCQl9CisJCWRwcmludGso
NCwKKwkJCUtFUk5fREVCVUcKKwkJCSJ6b3Jhbl9pcnE6IGFzdGF0OiAweCUwOHgsIG1hc2s6IDB4
JTA4eFxuIiwKKwkJCWFzdGF0LCBidHJlYWQoWlIzNjA1N19JQ1IpKTsKKwkJaWYgKGFzdGF0ICYg
enItPmNhcmQudnN5bmNfaW50KSB7CS8vIFNXCisKKwkJCWlmICh6ci0+Y29kZWNfbW9kZSA9PSBC
VVpfTU9ERV9NT1RJT05fREVDT01QUkVTUyB8fAorCQkJICAgIHpyLT5jb2RlY19tb2RlID09IEJV
Wl9NT0RFX01PVElPTl9DT01QUkVTUykgeworCQkJCS8qIGNvdW50IG1pc3NlZCBpbnRlcnJ1cHRz
ICovCisJCQkJenItPkpQRUdfbWlzc2VkKys7CisJCQl9CisJCQkvL3Bvc3Rfb2ZmaWNlX3JlYWQo
enIsMSwwKTsKKwkJCS8qIEludGVycnVwdHMgbWF5IHN0aWxsIGhhcHBlbiB3aGVuCisJCQkgKiB6
ci0+djRsX21lbWdyYWJfYWN0aXZlIGlzIHN3aXRjaGVkIG9mZi4KKwkJCSAqIFdlIHNpbXBseSBp
Z25vcmUgdGhlbSAqLworCisJCQlpZiAoenItPnY0bF9tZW1ncmFiX2FjdGl2ZSkgeworCQkJCS8q
IEEgbG90IG1vcmUgY2hlY2tzIHNob3VsZCBiZSBoZXJlIC4uLiAqLworCQkJCWlmICgoYnRyZWFk
KFpSMzYwNTdfVlNTRkdSKSAmIFpSMzYwNTdfVlNTRkdSX1NuYXBTaG90KSA9PSAwKQorCQkJCQlk
cHJpbnRrKDEsCisJCQkJCQlLRVJOX1dBUk5JTkcKKwkJCQkJCSIlczogQnV6SVJRIHdpdGggU25h
cFNob3Qgb2ZmID8/P1xuIiwKKwkJCQkJCVpSX0RFVk5BTUUoenIpKTsKKworCQkJCWlmICh6ci0+
djRsX2dyYWJfZnJhbWUgIT0gTk9fR1JBQl9BQ1RJVkUpIHsKKwkJCQkJLyogVGhlcmUgaXMgYSBn
cmFiIG9uIGEgZnJhbWUgZ29pbmcgb24sIGNoZWNrIGlmIGl0IGhhcyBmaW5pc2hlZCAqLworCQkJ
CQlpZiAoKGJ0cmVhZChaUjM2MDU3X1ZTU0ZHUikgJiBaUjM2MDU3X1ZTU0ZHUl9GcmFtZUdyYWIp
ID09IDApIHsKKwkJCQkJCS8qIGl0IGlzIGZpbmlzaGVkLCBub3RpZnkgdGhlIHVzZXIgKi8KKwor
CQkJCQkJenItPnY0bF9idWZmZXJzLmJ1ZmZlclt6ci0+djRsX2dyYWJfZnJhbWVdLnN0YXRlID0g
QlVaX1NUQVRFX0RPTkU7CisJCQkJCQl6ci0+djRsX2J1ZmZlcnMuYnVmZmVyW3pyLT52NGxfZ3Jh
Yl9mcmFtZV0uYnMuc2VxID0genItPnY0bF9ncmFiX3NlcTsKKwkJCQkJCXpyLT52NGxfYnVmZmVy
cy5idWZmZXJbenItPnY0bF9ncmFiX2ZyYW1lXS5icy50cyA9IGt0aW1lX2dldF9ucygpOworCQkJ
CQkJenItPnY0bF9ncmFiX2ZyYW1lID0gTk9fR1JBQl9BQ1RJVkU7CisJCQkJCQl6ci0+djRsX3Bl
bmRfdGFpbCsrOworCQkJCQl9CisJCQkJfQorCisJCQkJaWYgKHpyLT52NGxfZ3JhYl9mcmFtZSA9
PSBOT19HUkFCX0FDVElWRSkKKwkJCQkJd2FrZV91cF9pbnRlcnJ1cHRpYmxlKCZ6ci0+djRsX2Nh
cHEpOworCisJCQkJLyogQ2hlY2sgaWYgdGhlcmUgaXMgYW5vdGhlciBncmFiIHF1ZXVlZCAqLwor
CisJCQkJaWYgKHpyLT52NGxfZ3JhYl9mcmFtZSA9PSBOT19HUkFCX0FDVElWRSAmJgorCQkJCSAg
ICB6ci0+djRsX3BlbmRfdGFpbCAhPSB6ci0+djRsX3BlbmRfaGVhZCkgeworCQkJCQlpbnQgZnJh
bWUgPSB6ci0+djRsX3BlbmRbenItPnY0bF9wZW5kX3RhaWwgJiBWNExfTUFTS19GUkFNRV07CisJ
CQkJCXUzMiByZWc7CisKKwkJCQkJenItPnY0bF9ncmFiX2ZyYW1lID0gZnJhbWU7CisKKwkJCQkJ
LyogU2V0IHpyMzYwNTcgdmlkZW8gZnJvbnQgZW5kIGFuZCBlbmFibGUgdmlkZW8gKi8KKworCQkJ
CQkvKiBCdWZmZXIgYWRkcmVzcyAqLworCisJCQkJCXJlZyA9IHpyLT52NGxfYnVmZmVycy5idWZm
ZXJbZnJhbWVdLnY0bC5mYnVmZmVyX2J1czsKKwkJCQkJYnR3cml0ZShyZWcsIFpSMzYwNTdfVkRU
Uik7CisJCQkJCWlmICh6ci0+djRsX3NldHRpbmdzLmhlaWdodCA+IEJVWl9NQVhfSEVJR0hUIC8g
MikKKwkJCQkJCXJlZyArPSB6ci0+djRsX3NldHRpbmdzLmJ5dGVzcGVybGluZTsKKwkJCQkJYnR3
cml0ZShyZWcsIFpSMzYwNTdfVkRCUik7CisKKwkJCQkJLyogdmlkZW8gc3RyaWRlLCBzdGF0dXMs
IGFuZCBmcmFtZSBncmFiIHJlZ2lzdGVyICovCisJCQkJCXJlZyA9IDA7CisJCQkJCWlmICh6ci0+
djRsX3NldHRpbmdzLmhlaWdodCA+IEJVWl9NQVhfSEVJR0hUIC8gMikKKwkJCQkJCXJlZyArPSB6
ci0+djRsX3NldHRpbmdzLmJ5dGVzcGVybGluZTsKKwkJCQkJcmVnID0gKHJlZyA8PCBaUjM2MDU3
X1ZTU0ZHUl9EaXNwU3RyaWRlKTsKKwkJCQkJcmVnIHw9IFpSMzYwNTdfVlNTRkdSX1ZpZE92ZjsK
KwkJCQkJcmVnIHw9IFpSMzYwNTdfVlNTRkdSX1NuYXBTaG90OworCQkJCQlyZWcgfD0gWlIzNjA1
N19WU1NGR1JfRnJhbWVHcmFiOworCQkJCQlidHdyaXRlKHJlZywgWlIzNjA1N19WU1NGR1IpOwor
CisJCQkJCWJ0b3IoWlIzNjA1N19WRENSX1ZpZEVuLAorCQkJCQkgICAgIFpSMzYwNTdfVkRDUik7
CisJCQkJfQorCQkJfQorCisJCQkvKiBldmVuIGlmIHdlIGRvbid0IGdyYWIsIHdlIGRvIHdhbnQg
dG8gaW5jcmVtZW50CisJCQkgKiB0aGUgc2VxdWVuY2UgY291bnRlciB0byBzZWUgbG9zdCBmcmFt
ZXMgKi8KKwkJCXpyLT52NGxfZ3JhYl9zZXErKzsKKwkJfQorI2lmIChJUlFfTUFTSyAmIFpSMzYw
NTdfSVNSX0NvZFJlcElSUSkKKwkJaWYgKGFzdGF0ICYgWlIzNjA1N19JU1JfQ29kUmVwSVJRKSB7
CisJCQl6ci0+aW50cl9jb3VudGVyX0NvZFJlcElSUSsrOworCQkJSURFQlVHKHByaW50ayhLRVJO
X0RFQlVHICIlczogWlIzNjA1N19JU1JfQ29kUmVwSVJRXG4iLAorCQkJCVpSX0RFVk5BTUUoenIp
KSk7CisJCQlidGFuZCh+WlIzNjA1N19JQ1JfQ29kUmVwSVJRLCBaUjM2MDU3X0lDUik7CisJCX0K
KyNlbmRpZgkJCQkvKiAoSVJRX01BU0sgJiBaUjM2MDU3X0lTUl9Db2RSZXBJUlEpICovCisKKyNp
ZiAoSVJRX01BU0sgJiBaUjM2MDU3X0lTUl9KUEVHUmVwSVJRKQorCQlpZiAoKGFzdGF0ICYgWlIz
NjA1N19JU1JfSlBFR1JlcElSUSkgJiYKKwkJICAgICh6ci0+Y29kZWNfbW9kZSA9PSBCVVpfTU9E
RV9NT1RJT05fREVDT01QUkVTUyB8fAorCQkgICAgIHpyLT5jb2RlY19tb2RlID09IEJVWl9NT0RF
X01PVElPTl9DT01QUkVTUykpIHsKKwkJCWlmICh6cjM2MDY3X2RlYnVnID4gMSAmJiAoIXpyLT5m
cmFtZV9udW0gfHwgenItPkpQRUdfZXJyb3IpKSB7CisJCQkJY2hhciBzdltCVVpfTlVNX1NUQVRf
Q09NICsgMV07CisJCQkJaW50IGk7CisKKwkJCQlwcmludGsoS0VSTl9JTkZPCisJCQkJICAgICAg
ICIlczogZmlyc3QgZnJhbWUgcmVhZHk6IHN0YXRlPTB4JTA4eCBvZGRfZXZlbj0lZCBmaWVsZF9w
ZXJfYnVmZj0lZCBkZWxheT0lZFxuIiwKKwkJCQkgICAgICAgWlJfREVWTkFNRSh6ciksIHN0YXQs
CisJCQkJICAgICAgIHpyLT5qcGdfc2V0dGluZ3Mub2RkX2V2ZW4sCisJCQkJICAgICAgIHpyLT5q
cGdfc2V0dGluZ3MuZmllbGRfcGVyX2J1ZmYsCisJCQkJICAgICAgIHpyLT5KUEVHX21pc3NlZCk7
CisKKwkJCQlmb3IgKGkgPSAwOyBpIDwgQlVaX05VTV9TVEFUX0NPTTsgaSsrKQorCQkJCQlzdltp
XSA9IGxlMzJfdG9fY3B1KHpyLT5zdGF0X2NvbVtpXSkgJiAxID8gJzEnIDogJzAnOworCQkJCXN2
W0JVWl9OVU1fU1RBVF9DT01dID0gMDsKKwkJCQlwcmludGsoS0VSTl9JTkZPCisJCQkJICAgICAg
ICIlczogc3RhdF9jb209JXMgcXVldWVfc3RhdGU9JWxkLyVsZC8lbGQvJWxkXG4iLAorCQkJCSAg
ICAgICBaUl9ERVZOQU1FKHpyKSwgc3YsCisJCQkJICAgICAgIHpyLT5qcGdfcXVlX3RhaWwsCisJ
CQkJICAgICAgIHpyLT5qcGdfZG1hX3RhaWwsCisJCQkJICAgICAgIHpyLT5qcGdfZG1hX2hlYWQs
CisJCQkJICAgICAgIHpyLT5qcGdfcXVlX2hlYWQpOworCQkJfSBlbHNlIHsKKwkJCQkvKiBHZXQg
c3RhdGlzdGljcyAqLworCQkJCWlmICh6ci0+SlBFR19taXNzZWQgPiB6ci0+SlBFR19tYXhfbWlz
c2VkKQorCQkJCQl6ci0+SlBFR19tYXhfbWlzc2VkID0genItPkpQRUdfbWlzc2VkOworCQkJCWlm
ICh6ci0+SlBFR19taXNzZWQgPCB6ci0+SlBFR19taW5fbWlzc2VkKQorCQkJCQl6ci0+SlBFR19t
aW5fbWlzc2VkID0genItPkpQRUdfbWlzc2VkOworCQkJfQorCisJCQlpZiAoenIzNjA2N19kZWJ1
ZyA+IDIgJiYgenItPmZyYW1lX251bSA8IDYpIHsKKwkJCQlpbnQgaTsKKworCQkJCXByaW50ayhL
RVJOX0lORk8gIiVzOiBzZXE9JWxkIHN0YXRfY29tOiIsCisJCQkJICAgICAgIFpSX0RFVk5BTUUo
enIpLCB6ci0+anBnX3NlcV9udW0pOworCQkJCWZvciAoaSA9IDA7IGkgPCA0OyBpKyspIHsKKwkJ
CQkJcHJpbnRrKEtFUk5fQ09OVCAiICUwOHgiLAorCQkJCQkgICAgICAgbGUzMl90b19jcHUoenIt
PnN0YXRfY29tW2ldKSk7CisJCQkJfQorCQkJCXByaW50ayhLRVJOX0NPTlQgIlxuIik7CisJCQl9
CisJCQl6ci0+ZnJhbWVfbnVtKys7CisJCQl6ci0+SlBFR19taXNzZWQgPSAwOworCQkJenItPkpQ
RUdfZXJyb3IgPSAwOworCQkJem9yYW5fcmVhcF9zdGF0X2NvbSh6cik7CisJCQl6b3Jhbl9mZWVk
X3N0YXRfY29tKHpyKTsKKwkJCXdha2VfdXBfaW50ZXJydXB0aWJsZSgmenItPmpwZ19jYXBxKTsK
KwkJfQorI2VuZGlmCQkJCS8qIChJUlFfTUFTSyAmIFpSMzYwNTdfSVNSX0pQRUdSZXBJUlEpICov
CisKKwkJLyogREFURVJSLCB0b28gbWFueSBmaWVsZHMgbWlzc2VkLCBlcnJvciBwcm9jZXNzaW5n
ICovCisJCWlmICgoYXN0YXQgJiB6ci0+Y2FyZC5qcGVnX2ludCkgfHwKKwkJICAgIHpyLT5KUEVH
X21pc3NlZCA+IDI1IHx8CisJCSAgICB6ci0+SlBFR19lcnJvciA9PSAxCXx8CisJCSAgICAoKHpy
LT5jb2RlY19tb2RlID09IEJVWl9NT0RFX01PVElPTl9ERUNPTVBSRVNTKSAmJgorCQkgICAgICh6
ci0+ZnJhbWVfbnVtICYmICh6ci0+SlBFR19taXNzZWQgPiB6ci0+anBnX3NldHRpbmdzLmZpZWxk
X3Blcl9idWZmKSkpKSB7CisJCQllcnJvcl9oYW5kbGVyKHpyLCBhc3RhdCwgc3RhdCk7CisJCX0K
KworCQljb3VudCsrOworCQlpZiAoY291bnQgPiAxMCkgeworCQkJZHByaW50aygyLCBLRVJOX1dB
Uk5JTkcgIiVzOiBpcnEgbG9vcCAlZFxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgY291bnQpOwor
CQkJaWYgKGNvdW50ID4gMjApIHsKKwkJCQlidGFuZCh+WlIzNjA1N19JQ1JfSW50UGluRW4sIFpS
MzYwNTdfSUNSKTsKKwkJCQlkcHJpbnRrKDIsCisJCQkJCUtFUk5fRVJSCisJCQkJCSIlczogSVJR
IGxvY2t1cCwgY2xlYXJlZCBpbnQgbWFza1xuIiwKKwkJCQkJWlJfREVWTkFNRSh6cikpOworCQkJ
CWJyZWFrOworCQkJfQorCQl9CisJCXpyLT5sYXN0X2lzciA9IHN0YXQ7CisJfQorCXNwaW5fdW5s
b2NrX2lycXJlc3RvcmUoJnpyLT5zcGlubG9jaywgZmxhZ3MpOworCisJcmV0dXJuIElSUV9IQU5E
TEVEOworfQorCit2b2lkCit6b3Jhbl9zZXRfcGNpX21hc3RlciAoc3RydWN0IHpvcmFuICp6ciwK
KwkJICAgICAgaW50ICAgICAgICAgICBzZXRfbWFzdGVyKQoreworCWlmIChzZXRfbWFzdGVyKSB7
CisJCXBjaV9zZXRfbWFzdGVyKHpyLT5wY2lfZGV2KTsKKwl9IGVsc2UgeworCQl1MTYgY29tbWFu
ZDsKKworCQlwY2lfcmVhZF9jb25maWdfd29yZCh6ci0+cGNpX2RldiwgUENJX0NPTU1BTkQsICZj
b21tYW5kKTsKKwkJY29tbWFuZCAmPSB+UENJX0NPTU1BTkRfTUFTVEVSOworCQlwY2lfd3JpdGVf
Y29uZmlnX3dvcmQoenItPnBjaV9kZXYsIFBDSV9DT01NQU5ELCBjb21tYW5kKTsKKwl9Cit9CisK
K3ZvaWQKK3pvcmFuX2luaXRfaGFyZHdhcmUgKHN0cnVjdCB6b3JhbiAqenIpCit7CisJLyogRW5h
YmxlIGJ1cy1tYXN0ZXJpbmcgKi8KKwl6b3Jhbl9zZXRfcGNpX21hc3Rlcih6ciwgMSk7CisKKwkv
KiBJbml0aWFsaXplIHRoZSBib2FyZCAqLworCWlmICh6ci0+Y2FyZC5pbml0KSB7CisJCXpyLT5j
YXJkLmluaXQoenIpOworCX0KKworCWRlY29kZXJfY2FsbCh6ciwgY29yZSwgaW5pdCwgMCk7CisJ
ZGVjb2Rlcl9jYWxsKHpyLCB2aWRlbywgc19zdGQsIHpyLT5ub3JtKTsKKwlkZWNvZGVyX2NhbGwo
enIsIHZpZGVvLCBzX3JvdXRpbmcsCisJCXpyLT5jYXJkLmlucHV0W3pyLT5pbnB1dF0ubXV4c2Vs
LCAwLCAwKTsKKworCWVuY29kZXJfY2FsbCh6ciwgY29yZSwgaW5pdCwgMCk7CisJZW5jb2Rlcl9j
YWxsKHpyLCB2aWRlbywgc19zdGRfb3V0cHV0LCB6ci0+bm9ybSk7CisJZW5jb2Rlcl9jYWxsKHpy
LCB2aWRlbywgc19yb3V0aW5nLCAwLCAwLCAwKTsKKworCS8qIHRvZ2dsZSBKUEVHIGNvZGVjIHNs
ZWVwIHRvIHN5bmMgUExMICovCisJanBlZ19jb2RlY19zbGVlcCh6ciwgMSk7CisJanBlZ19jb2Rl
Y19zbGVlcCh6ciwgMCk7CisKKwkvKgorCSAqIHNldCBpbmRpdmlkdWFsIGludGVycnVwdCBlbmFi
bGVzICh3aXRob3V0IEdJUlExKQorCSAqIGJ1dCBkb24ndCBnbG9iYWwgZW5hYmxlIHVudGlsIHpv
cmFuX29wZW4oKQorCSAqLworCXpyMzYwNTdfaW5pdF92ZmUoenIpOworCisJenIzNjA1N19lbmFi
bGVfanBnKHpyLCBCVVpfTU9ERV9JRExFKTsKKworCWJ0d3JpdGUoSVJRX01BU0ssIFpSMzYwNTdf
SVNSKTsJLy8gQ2xlYXJzIGludGVycnVwdHMKK30KKwordm9pZAorenIzNjA1N19yZXN0YXJ0IChz
dHJ1Y3Qgem9yYW4gKnpyKQoreworCWJ0d3JpdGUoMCwgWlIzNjA1N19TUEdQUENSKTsKKwltZGVs
YXkoMSk7CisJYnRvcihaUjM2MDU3X1NQR1BQQ1JfU29mdFJlc2V0LCBaUjM2MDU3X1NQR1BQQ1Ip
OworCW1kZWxheSgxKTsKKworCS8qIGFzc2VydCBQX1Jlc2V0ICovCisJYnR3cml0ZSgwLCBaUjM2
MDU3X0pQQyk7CisJLyogc2V0IHVwIEdQSU8gZGlyZWN0aW9uIC0gYWxsIG91dHB1dCAqLworCWJ0
d3JpdGUoWlIzNjA1N19TUEdQUENSX1NvZnRSZXNldCB8IDAsIFpSMzYwNTdfU1BHUFBDUik7CisK
KwkvKiBzZXQgdXAgR1BJTyBwaW5zIGFuZCBndWVzdCBidXMgdGltaW5nICovCisJYnR3cml0ZSgo
MHg4MSA8PCAyNCkgfCAweDg4ODgsIFpSMzYwNTdfR1BQR0NSMSk7Cit9CisKKy8qCisgKiBpbml0
aWFsaXplIHZpZGVvIGZyb250IGVuZAorICovCisKK3N0YXRpYyB2b2lkCit6cjM2MDU3X2luaXRf
dmZlIChzdHJ1Y3Qgem9yYW4gKnpyKQoreworCXUzMiByZWc7CisKKwlyZWcgPSBidHJlYWQoWlIz
NjA1N19WRkVTUEZSKTsKKwlyZWcgfD0gWlIzNjA1N19WRkVTUEZSX0xpdHRsZUVuZGlhbjsKKwly
ZWcgJj0gflpSMzYwNTdfVkZFU1BGUl9WQ0xLUG9sOworCXJlZyB8PSBaUjM2MDU3X1ZGRVNQRlJf
RXh0Rmw7CisJcmVnIHw9IFpSMzYwNTdfVkZFU1BGUl9Ub3BGaWVsZDsKKwlidHdyaXRlKHJlZywg
WlIzNjA1N19WRkVTUEZSKTsKKwlyZWcgPSBidHJlYWQoWlIzNjA1N19WRENSKTsKKwlpZiAocGNp
X3BjaV9wcm9ibGVtcyAmIFBDSVBDSV9UUklUT04pCisJCS8vIHx8IHpyLT5yZXZpc2lvbiA8IDEp
IC8vIFJldmlzaW9uIDEgaGFzIGFsc28gVHJpdG9uIHN1cHBvcnQKKwkJcmVnICY9IH5aUjM2MDU3
X1ZEQ1JfVHJpdG9uOworCWVsc2UKKwkJcmVnIHw9IFpSMzYwNTdfVkRDUl9Ucml0b247CisJYnR3
cml0ZShyZWcsIFpSMzYwNTdfVkRDUik7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcv
bWVkaWEvem9yYW4vem9yYW5fZGV2aWNlLmggYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4v
em9yYW5fZGV2aWNlLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5h
NTA3YWFhZDRlYmIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9y
YW4vem9yYW5fZGV2aWNlLmgKQEAgLTAsMCArMSw5MSBAQAorLyoKKyAqIFpvcmFuIHpyMzYwNTcv
enIzNjA2NyBQQ0kgY29udHJvbGxlciBkcml2ZXIsIGZvciB0aGUKKyAqIFBpbm5hY2xlL01pcm8g
REMxMC9EQzEwKy9EQzMwL0RDMzArLCBJb21lZ2EgQnV6LCBMaW51eAorICogTWVkaWEgTGFicyBM
TUwzMy9MTUwzM1IxMC4KKyAqCisgKiBUaGlzIHBhcnQgaGFuZGxlcyBjYXJkLXNwZWNpZmljIGRh
dGEgYW5kIGRldGVjdGlvbgorICoKKyAqIENvcHlyaWdodCAoQykgMjAwMCBTZXJndWVpIE1pcmlk
b25vdiA8bWlyc2V2QGNpY2VzZS5teD4KKyAqCisgKiBDdXJyZW50bHkgbWFpbnRhaW5lZCBieToK
KyAqICAgUm9uYWxkIEJ1bHRqZSAgICA8cmJ1bHRqZUByb25hbGQuYml0ZnJlYWsubmV0PgorICog
ICBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QHNreW5ldC5iZT4KKyAqICAgTWFp
bGluZ2xpc3QgICAgICA8bWpwZWctdXNlcnNAbGlzdHMuc2YubmV0PgorICoKKyAqIFRoaXMgcHJv
Z3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9k
aWZ5CisgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGFzIHB1Ymxpc2hlZCBieQorICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0
aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqIChhdCB5b3VyIG9wdGlvbikgYW55
IGxhdGVyIHZlcnNpb24uCisgKgorICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRo
ZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFO
VFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogTUVSQ0hBTlRBQklM
SVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogR05V
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqLworCisjaWZuZGVm
IF9fWk9SQU5fREVWSUNFX0hfXworI2RlZmluZSBfX1pPUkFOX0RFVklDRV9IX18KKworLyogZ2Vu
ZXJhbCBwdXJwb3NlIEkvTyAqLworZXh0ZXJuIHZvaWQgR1BJTyhzdHJ1Y3Qgem9yYW4gKnpyLAor
CQkgaW50IGJpdCwKKwkJIHVuc2lnbmVkIGludCB2YWx1ZSk7CisKKy8qIGNvZGVjIChvciBhY3R1
YWxseTogZ3Vlc3QgYnVzKSBhY2Nlc3MgKi8KK2V4dGVybiBpbnQgcG9zdF9vZmZpY2Vfd2FpdChz
dHJ1Y3Qgem9yYW4gKnpyKTsKK2V4dGVybiBpbnQgcG9zdF9vZmZpY2Vfd3JpdGUoc3RydWN0IHpv
cmFuICp6ciwKKwkJCSAgICAgdW5zaWduZWQgZ3Vlc3QsCisJCQkgICAgIHVuc2lnbmVkIHJlZywK
KwkJCSAgICAgdW5zaWduZWQgdmFsdWUpOworZXh0ZXJuIGludCBwb3N0X29mZmljZV9yZWFkKHN0
cnVjdCB6b3JhbiAqenIsCisJCQkgICAgdW5zaWduZWQgZ3Vlc3QsCisJCQkgICAgdW5zaWduZWQg
cmVnKTsKKworZXh0ZXJuIHZvaWQgZGV0ZWN0X2d1ZXN0X2FjdGl2aXR5KHN0cnVjdCB6b3JhbiAq
enIpOworCitleHRlcm4gdm9pZCBqcGVnX2NvZGVjX3NsZWVwKHN0cnVjdCB6b3JhbiAqenIsCisJ
CQkgICAgIGludCBzbGVlcCk7CitleHRlcm4gaW50IGpwZWdfY29kZWNfcmVzZXQoc3RydWN0IHpv
cmFuICp6cik7CisKKy8qIHpyMzYweDcgYWNjZXNzIHRvIHJhdyBjYXB0dXJlICovCitleHRlcm4g
dm9pZCB6cjM2MDU3X292ZXJsYXkoc3RydWN0IHpvcmFuICp6ciwKKwkJCSAgICBpbnQgb24pOwor
ZXh0ZXJuIHZvaWQgd3JpdGVfb3ZlcmxheV9tYXNrKHN0cnVjdCB6b3Jhbl9maCAqZmgsCisJCQkg
ICAgICAgc3RydWN0IHY0bDJfY2xpcCAqdnAsCisJCQkgICAgICAgaW50IGNvdW50KTsKK2V4dGVy
biB2b2lkIHpyMzYwNTdfc2V0X21lbWdyYWIoc3RydWN0IHpvcmFuICp6ciwKKwkJCQlpbnQgbW9k
ZSk7CitleHRlcm4gaW50IHdhaXRfZ3JhYl9wZW5kaW5nKHN0cnVjdCB6b3JhbiAqenIpOworCisv
KiBpbnRlcnJ1cHRzICovCitleHRlcm4gdm9pZCBwcmludF9pbnRlcnJ1cHRzKHN0cnVjdCB6b3Jh
biAqenIpOworZXh0ZXJuIHZvaWQgY2xlYXJfaW50ZXJydXB0X2NvdW50ZXJzKHN0cnVjdCB6b3Jh
biAqenIpOworZXh0ZXJuIGlycXJldHVybl90IHpvcmFuX2lycShpbnQgaXJxLCB2b2lkICpkZXZf
aWQpOworCisvKiBKUEVHIGNvZGVjIGFjY2VzcyAqLworZXh0ZXJuIHZvaWQganBlZ19zdGFydChz
dHJ1Y3Qgem9yYW4gKnpyKTsKK2V4dGVybiB2b2lkIHpyMzYwNTdfZW5hYmxlX2pwZyhzdHJ1Y3Qg
em9yYW4gKnpyLAorCQkJICAgICAgIGVudW0gem9yYW5fY29kZWNfbW9kZSBtb2RlKTsKK2V4dGVy
biB2b2lkIHpvcmFuX2ZlZWRfc3RhdF9jb20oc3RydWN0IHpvcmFuICp6cik7CisKKy8qIGdlbmVy
YWwgKi8KK2V4dGVybiB2b2lkIHpvcmFuX3NldF9wY2lfbWFzdGVyKHN0cnVjdCB6b3JhbiAqenIs
CisJCQkJIGludCBzZXRfbWFzdGVyKTsKK2V4dGVybiB2b2lkIHpvcmFuX2luaXRfaGFyZHdhcmUo
c3RydWN0IHpvcmFuICp6cik7CitleHRlcm4gdm9pZCB6cjM2MDU3X3Jlc3RhcnQoc3RydWN0IHpv
cmFuICp6cik7CisKK2V4dGVybiBjb25zdCBzdHJ1Y3Qgem9yYW5fZm9ybWF0IHpvcmFuX2Zvcm1h
dHNbXTsKKworZXh0ZXJuIGludCB2NGxfbmJ1ZnM7CitleHRlcm4gaW50IHY0bF9idWZzaXplOwor
ZXh0ZXJuIGludCBqcGdfbmJ1ZnM7CitleHRlcm4gaW50IGpwZ19idWZzaXplOworZXh0ZXJuIGlu
dCBwYXNzX3Rocm91Z2g7CisKKy8qIGkyYyAqLworI2RlZmluZSBkZWNvZGVyX2NhbGwoenIsIG8s
IGYsIGFyZ3MuLi4pIFwKKwl2NGwyX3N1YmRldl9jYWxsKHpyLT5kZWNvZGVyLCBvLCBmLCAjI2Fy
Z3MpCisjZGVmaW5lIGVuY29kZXJfY2FsbCh6ciwgbywgZiwgYXJncy4uLikgXAorCXY0bDJfc3Vi
ZGV2X2NhbGwoenItPmVuY29kZXIsIG8sIGYsICMjYXJncykKKworI2VuZGlmCQkJCS8qIF9fWk9S
QU5fREVWSUNFX0hfXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFu
L3pvcmFuX2RyaXZlci5jIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX2RyaXZl
ci5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uYzk5OGFhNGRjNzNi
Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX2Ry
aXZlci5jCkBAIC0wLDAgKzEsMjg1MCBAQAorLyoKKyAqIFpvcmFuIHpyMzYwNTcvenIzNjA2NyBQ
Q0kgY29udHJvbGxlciBkcml2ZXIsIGZvciB0aGUKKyAqIFBpbm5hY2xlL01pcm8gREMxMC9EQzEw
Ky9EQzMwL0RDMzArLCBJb21lZ2EgQnV6LCBMaW51eAorICogTWVkaWEgTGFicyBMTUwzMy9MTUwz
M1IxMC4KKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMDAgU2VyZ3VlaSBNaXJpZG9ub3YgPG1pcnNl
dkBjaWNlc2UubXg+CisgKgorICogQ2hhbmdlcyBmb3IgQlVaIGJ5IFdvbGZnYW5nIFNjaGVyciA8
c2NoZXJyQG5ldDR5b3UubmV0PgorICoKKyAqIENoYW5nZXMgZm9yIERDMTAvREMzMCBieSBMYXVy
ZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QHNreW5ldC5iZT4KKyAqCisgKiBDaGFuZ2Vz
IGZvciBMTUwzM1IxMCBieSBNYXhpbSBZZXZ0eXVzaGtpbiA8bWF4QGxpbnV4bWVkaWFsYWJzLmNv
bT4KKyAqCisgKiBDaGFuZ2VzIGZvciB2aWRlb2RldjIvdjRsMiBieSBSb25hbGQgQnVsdGplIDxy
YnVsdGplQHJvbmFsZC5iaXRmcmVhay5uZXQ+CisgKgorICogQmFzZWQgb24KKyAqCisgKiBNaXJv
IERDMTAgZHJpdmVyCisgKiBDb3B5cmlnaHQgKEMpIDE5OTkgV29sZmdhbmcgU2NoZXJyIDxzY2hl
cnJAbmV0NHlvdS5uZXQ+CisgKgorICogSW9tZWdhIEJ1eiBkcml2ZXIgdmVyc2lvbiAxLjAKKyAq
IENvcHlyaWdodCAoQykgMTk5OSBSYWluZXIgSm9oYW5uaSA8UmFpbmVyQEpvaGFubmkuZGU+Cisg
KgorICogYnV6LjAuMC4zCisgKiBDb3B5cmlnaHQgKEMpIDE5OTggRGF2ZSBQZXJrcyA8ZHBlcmtz
QGlibS5uZXQ+CisgKgorICogYnR0diAtIEJ0ODQ4IGZyYW1lIGdyYWJiZXIgZHJpdmVyCisgKiBD
b3B5cmlnaHQgKEMpIDE5OTYsOTcsOTggUmFscGggIE1ldHpsZXIgKHJqa21AdGhwLnVuaS1rb2Vs
bi5kZSkKKyAqICAgICAgICAgICAgICAgICAgICAgICAgJiBNYXJjdXMgTWV0emxlciAobW9jbUB0
aHAudW5pLWtvZWxuLmRlKQorICoKKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2Fy
ZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogaXQgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkK
KyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhl
IExpY2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoK
KyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwg
YmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhl
IGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBB
IFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNl
bnNlIGZvciBtb3JlIGRldGFpbHMuCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2luaXQuaD4KKyNp
bmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1
ZGUgPGxpbnV4L3NsYWIuaD4KKyNpbmNsdWRlIDxsaW51eC9wY2kuaD4KKyNpbmNsdWRlIDxsaW51
eC92bWFsbG9jLmg+CisjaW5jbHVkZSA8bGludXgvd2FpdC5oPgorCisjaW5jbHVkZSA8bGludXgv
aW50ZXJydXB0Lmg+CisjaW5jbHVkZSA8bGludXgvaTJjLmg+CisjaW5jbHVkZSA8bGludXgvaTJj
LWFsZ28tYml0Lmg+CisKKyNpbmNsdWRlIDxsaW51eC9zcGlubG9jay5oPgorCisjaW5jbHVkZSA8
bGludXgvdmlkZW9kZXYyLmg+CisjaW5jbHVkZSA8bWVkaWEvdjRsMi1jb21tb24uaD4KKyNpbmNs
dWRlIDxtZWRpYS92NGwyLWlvY3RsLmg+CisjaW5jbHVkZSA8bWVkaWEvdjRsMi1ldmVudC5oPgor
I2luY2x1ZGUgInZpZGVvY29kZWMuaCIKKworI2luY2x1ZGUgPGFzbS9ieXRlb3JkZXIuaD4KKyNp
bmNsdWRlIDxhc20vaW8uaD4KKyNpbmNsdWRlIDxsaW51eC91YWNjZXNzLmg+CisjaW5jbHVkZSA8
bGludXgvcHJvY19mcy5oPgorCisjaW5jbHVkZSA8bGludXgvbXV0ZXguaD4KKyNpbmNsdWRlICJ6
b3Jhbi5oIgorI2luY2x1ZGUgInpvcmFuX2RldmljZS5oIgorI2luY2x1ZGUgInpvcmFuX2NhcmQu
aCIKKworCitjb25zdCBzdHJ1Y3Qgem9yYW5fZm9ybWF0IHpvcmFuX2Zvcm1hdHNbXSA9IHsKKwl7
CisJCS5uYW1lID0gIjE1LWJpdCBSR0IgTEUiLAorCQkuZm91cmNjID0gVjRMMl9QSVhfRk1UX1JH
QjU1NSwKKwkJLmNvbG9yc3BhY2UgPSBWNEwyX0NPTE9SU1BBQ0VfU1JHQiwKKwkJLmRlcHRoID0g
MTUsCisJCS5mbGFncyA9IFpPUkFOX0ZPUk1BVF9DQVBUVVJFIHwKKwkJCSBaT1JBTl9GT1JNQVRf
T1ZFUkxBWSwKKwkJLnZmZXNwZnIgPSBaUjM2MDU3X1ZGRVNQRlJfUkdCNTU1fFpSMzYwNTdfVkZF
U1BGUl9FcnJEaWZ8CisJCQkgICBaUjM2MDU3X1ZGRVNQRlJfTGl0dGxlRW5kaWFuLAorCX0sIHsK
KwkJLm5hbWUgPSAiMTUtYml0IFJHQiBCRSIsCisJCS5mb3VyY2MgPSBWNEwyX1BJWF9GTVRfUkdC
NTU1WCwKKwkJLmNvbG9yc3BhY2UgPSBWNEwyX0NPTE9SU1BBQ0VfU1JHQiwKKwkJLmRlcHRoID0g
MTUsCisJCS5mbGFncyA9IFpPUkFOX0ZPUk1BVF9DQVBUVVJFIHwKKwkJCSBaT1JBTl9GT1JNQVRf
T1ZFUkxBWSwKKwkJLnZmZXNwZnIgPSBaUjM2MDU3X1ZGRVNQRlJfUkdCNTU1fFpSMzYwNTdfVkZF
U1BGUl9FcnJEaWYsCisJfSwgeworCQkubmFtZSA9ICIxNi1iaXQgUkdCIExFIiwKKwkJLmZvdXJj
YyA9IFY0TDJfUElYX0ZNVF9SR0I1NjUsCisJCS5jb2xvcnNwYWNlID0gVjRMMl9DT0xPUlNQQUNF
X1NSR0IsCisJCS5kZXB0aCA9IDE2LAorCQkuZmxhZ3MgPSBaT1JBTl9GT1JNQVRfQ0FQVFVSRSB8
CisJCQkgWk9SQU5fRk9STUFUX09WRVJMQVksCisJCS52ZmVzcGZyID0gWlIzNjA1N19WRkVTUEZS
X1JHQjU2NXxaUjM2MDU3X1ZGRVNQRlJfRXJyRGlmfAorCQkJICAgWlIzNjA1N19WRkVTUEZSX0xp
dHRsZUVuZGlhbiwKKwl9LCB7CisJCS5uYW1lID0gIjE2LWJpdCBSR0IgQkUiLAorCQkuZm91cmNj
ID0gVjRMMl9QSVhfRk1UX1JHQjU2NVgsCisJCS5jb2xvcnNwYWNlID0gVjRMMl9DT0xPUlNQQUNF
X1NSR0IsCisJCS5kZXB0aCA9IDE2LAorCQkuZmxhZ3MgPSBaT1JBTl9GT1JNQVRfQ0FQVFVSRSB8
CisJCQkgWk9SQU5fRk9STUFUX09WRVJMQVksCisJCS52ZmVzcGZyID0gWlIzNjA1N19WRkVTUEZS
X1JHQjU2NXxaUjM2MDU3X1ZGRVNQRlJfRXJyRGlmLAorCX0sIHsKKwkJLm5hbWUgPSAiMjQtYml0
IFJHQiIsCisJCS5mb3VyY2MgPSBWNEwyX1BJWF9GTVRfQkdSMjQsCisJCS5jb2xvcnNwYWNlID0g
VjRMMl9DT0xPUlNQQUNFX1NSR0IsCisJCS5kZXB0aCA9IDI0LAorCQkuZmxhZ3MgPSBaT1JBTl9G
T1JNQVRfQ0FQVFVSRSB8CisJCQkgWk9SQU5fRk9STUFUX09WRVJMQVksCisJCS52ZmVzcGZyID0g
WlIzNjA1N19WRkVTUEZSX1JHQjg4OHxaUjM2MDU3X1ZGRVNQRlJfUGFjazI0LAorCX0sIHsKKwkJ
Lm5hbWUgPSAiMzItYml0IFJHQiBMRSIsCisJCS5mb3VyY2MgPSBWNEwyX1BJWF9GTVRfQkdSMzIs
CisJCS5jb2xvcnNwYWNlID0gVjRMMl9DT0xPUlNQQUNFX1NSR0IsCisJCS5kZXB0aCA9IDMyLAor
CQkuZmxhZ3MgPSBaT1JBTl9GT1JNQVRfQ0FQVFVSRSB8CisJCQkgWk9SQU5fRk9STUFUX09WRVJM
QVksCisJCS52ZmVzcGZyID0gWlIzNjA1N19WRkVTUEZSX1JHQjg4OHxaUjM2MDU3X1ZGRVNQRlJf
TGl0dGxlRW5kaWFuLAorCX0sIHsKKwkJLm5hbWUgPSAiMzItYml0IFJHQiBCRSIsCisJCS5mb3Vy
Y2MgPSBWNEwyX1BJWF9GTVRfUkdCMzIsCisJCS5jb2xvcnNwYWNlID0gVjRMMl9DT0xPUlNQQUNF
X1NSR0IsCisJCS5kZXB0aCA9IDMyLAorCQkuZmxhZ3MgPSBaT1JBTl9GT1JNQVRfQ0FQVFVSRSB8
CisJCQkgWk9SQU5fRk9STUFUX09WRVJMQVksCisJCS52ZmVzcGZyID0gWlIzNjA1N19WRkVTUEZS
X1JHQjg4OCwKKwl9LCB7CisJCS5uYW1lID0gIjQ6MjoyLCBwYWNrZWQsIFlVWVYiLAorCQkuZm91
cmNjID0gVjRMMl9QSVhfRk1UX1lVWVYsCisJCS5jb2xvcnNwYWNlID0gVjRMMl9DT0xPUlNQQUNF
X1NNUFRFMTcwTSwKKwkJLmRlcHRoID0gMTYsCisJCS5mbGFncyA9IFpPUkFOX0ZPUk1BVF9DQVBU
VVJFIHwKKwkJCSBaT1JBTl9GT1JNQVRfT1ZFUkxBWSwKKwkJLnZmZXNwZnIgPSBaUjM2MDU3X1ZG
RVNQRlJfWVVWNDIyLAorCX0sIHsKKwkJLm5hbWUgPSAiNDoyOjIsIHBhY2tlZCwgVVlWWSIsCisJ
CS5mb3VyY2MgPSBWNEwyX1BJWF9GTVRfVVlWWSwKKwkJLmNvbG9yc3BhY2UgPSBWNEwyX0NPTE9S
U1BBQ0VfU01QVEUxNzBNLAorCQkuZGVwdGggPSAxNiwKKwkJLmZsYWdzID0gWk9SQU5fRk9STUFU
X0NBUFRVUkUgfAorCQkJIFpPUkFOX0ZPUk1BVF9PVkVSTEFZLAorCQkudmZlc3BmciA9IFpSMzYw
NTdfVkZFU1BGUl9ZVVY0MjJ8WlIzNjA1N19WRkVTUEZSX0xpdHRsZUVuZGlhbiwKKwl9LCB7CisJ
CS5uYW1lID0gIkhhcmR3YXJlLWVuY29kZWQgTW90aW9uLUpQRUciLAorCQkuZm91cmNjID0gVjRM
Ml9QSVhfRk1UX01KUEVHLAorCQkuY29sb3JzcGFjZSA9IFY0TDJfQ09MT1JTUEFDRV9TTVBURTE3
ME0sCisJCS5kZXB0aCA9IDAsCisJCS5mbGFncyA9IFpPUkFOX0ZPUk1BVF9DQVBUVVJFIHwKKwkJ
CSBaT1JBTl9GT1JNQVRfUExBWUJBQ0sgfAorCQkJIFpPUkFOX0ZPUk1BVF9DT01QUkVTU0VELAor
CX0KK307CisjZGVmaW5lIE5VTV9GT1JNQVRTIEFSUkFZX1NJWkUoem9yYW5fZm9ybWF0cykKKwor
CS8qIHNtYWxsIGhlbHBlciBmdW5jdGlvbiBmb3IgY2FsY3VsYXRpbmcgYnVmZmVyc2l6ZXMgZm9y
IHY0bDIKKwkgKiB3ZSBjYWxjdWxhdGUgdGhlIG5lYXJlc3QgaGlnaGVyIHBvd2VyLW9mLXR3bywg
d2hpY2gKKwkgKiB3aWxsIGJlIHRoZSByZWNvbW1lbmRlZCBidWZmZXJzaXplICovCitzdGF0aWMg
X191MzIKK3pvcmFuX3Y0bDJfY2FsY19idWZzaXplIChzdHJ1Y3Qgem9yYW5fanBnX3NldHRpbmdz
ICpzZXR0aW5ncykKK3sKKwlfX3U4IGRpdiA9IHNldHRpbmdzLT5WZXJEY20gKiBzZXR0aW5ncy0+
SG9yRGNtICogc2V0dGluZ3MtPlRtcERjbTsKKwlfX3UzMiBudW0gPSAoMTAyNCAqIDUxMikgLyAo
ZGl2KTsKKwlfX3UzMiByZXN1bHQgPSAyOworCisJbnVtLS07CisJd2hpbGUgKG51bSkgeworCQlu
dW0gPj49IDE7CisJCXJlc3VsdCA8PD0gMTsKKwl9CisKKwlpZiAocmVzdWx0ID4ganBnX2J1ZnNp
emUpCisJCXJldHVybiBqcGdfYnVmc2l6ZTsKKwlpZiAocmVzdWx0IDwgODE5MikKKwkJcmV0dXJu
IDgxOTI7CisJcmV0dXJuIHJlc3VsdDsKK30KKworLyogZm9yd2FyZCByZWZlcmVuY2VzICovCitz
dGF0aWMgdm9pZCB2NGxfZmJ1ZmZlcl9mcmVlKHN0cnVjdCB6b3Jhbl9maCAqZmgpOworc3RhdGlj
IHZvaWQganBnX2ZidWZmZXJfZnJlZShzdHJ1Y3Qgem9yYW5fZmggKmZoKTsKKworLyogU2V0IG1h
cHBpbmcgbW9kZSAqLworc3RhdGljIHZvaWQgbWFwX21vZGVfcmF3KHN0cnVjdCB6b3Jhbl9maCAq
ZmgpCit7CisJZmgtPm1hcF9tb2RlID0gWk9SQU5fTUFQX01PREVfUkFXOworCWZoLT5idWZmZXJz
LmJ1ZmZlcl9zaXplID0gdjRsX2J1ZnNpemU7CisJZmgtPmJ1ZmZlcnMubnVtX2J1ZmZlcnMgPSB2
NGxfbmJ1ZnM7Cit9CitzdGF0aWMgdm9pZCBtYXBfbW9kZV9qcGcoc3RydWN0IHpvcmFuX2ZoICpm
aCwgaW50IHBsYXkpCit7CisJZmgtPm1hcF9tb2RlID0gcGxheSA/IFpPUkFOX01BUF9NT0RFX0pQ
R19QTEFZIDogWk9SQU5fTUFQX01PREVfSlBHX1JFQzsKKwlmaC0+YnVmZmVycy5idWZmZXJfc2l6
ZSA9IGpwZ19idWZzaXplOworCWZoLT5idWZmZXJzLm51bV9idWZmZXJzID0ganBnX25idWZzOwor
fQorc3RhdGljIGlubGluZSBjb25zdCBjaGFyICptb2RlX25hbWUoZW51bSB6b3Jhbl9tYXBfbW9k
ZSBtb2RlKQoreworCXJldHVybiBtb2RlID09IFpPUkFOX01BUF9NT0RFX1JBVyA/ICJWNEwiIDog
IkpQRyI7Cit9CisKKy8qCisgKiAgIEFsbG9jYXRlIHRoZSBWNEwgZ3JhYiBidWZmZXJzCisgKgor
ICogICBUaGVzZSBoYXZlIHRvIGJlIHB5c2ljYWxseSBjb250aWd1b3VzLgorICovCisKK3N0YXRp
YyBpbnQgdjRsX2ZidWZmZXJfYWxsb2Moc3RydWN0IHpvcmFuX2ZoICpmaCkKK3sKKwlzdHJ1Y3Qg
em9yYW4gKnpyID0gZmgtPnpyOworCWludCBpLCBvZmY7CisJdW5zaWduZWQgY2hhciAqbWVtOwor
CisJZm9yIChpID0gMDsgaSA8IGZoLT5idWZmZXJzLm51bV9idWZmZXJzOyBpKyspIHsKKwkJaWYg
KGZoLT5idWZmZXJzLmJ1ZmZlcltpXS52NGwuZmJ1ZmZlcikKKwkJCWRwcmludGsoMiwKKwkJCQlL
RVJOX1dBUk5JTkcKKwkJCQkiJXM6ICVzIC0gYnVmZmVyICVkIGFscmVhZHkgYWxsb2NhdGVkIT9c
biIsCisJCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBpKTsKKworCQkvL3VkZWxheSgyMCk7
CisJCW1lbSA9IGttYWxsb2MoZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemUsCisJCQkgICAgICBHRlBf
S0VSTkVMIHwgX19HRlBfTk9XQVJOKTsKKwkJaWYgKCFtZW0pIHsKKwkJCWRwcmludGsoMSwKKwkJ
CQlLRVJOX0VSUgorCQkJCSIlczogJXMgLSBrbWFsbG9jIGZvciBWNEwgYnVmICVkIGZhaWxlZFxu
IiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18sIGkpOworCQkJdjRsX2ZidWZmZXJfZnJl
ZShmaCk7CisJCQlyZXR1cm4gLUVOT0JVRlM7CisJCX0KKwkJZmgtPmJ1ZmZlcnMuYnVmZmVyW2ld
LnY0bC5mYnVmZmVyID0gbWVtOworCQlmaC0+YnVmZmVycy5idWZmZXJbaV0udjRsLmZidWZmZXJf
cGh5cyA9IHZpcnRfdG9fcGh5cyhtZW0pOworCQlmaC0+YnVmZmVycy5idWZmZXJbaV0udjRsLmZi
dWZmZXJfYnVzID0gdmlydF90b19idXMobWVtKTsKKwkJZm9yIChvZmYgPSAwOyBvZmYgPCBmaC0+
YnVmZmVycy5idWZmZXJfc2l6ZTsKKwkJICAgICBvZmYgKz0gUEFHRV9TSVpFKQorCQkJU2V0UGFn
ZVJlc2VydmVkKHZpcnRfdG9fcGFnZShtZW0gKyBvZmYpKTsKKwkJZHByaW50ayg0LAorCQkJS0VS
Tl9JTkZPCisJCQkiJXM6ICVzIC0gVjRMIGZyYW1lICVkIG1lbSAlcCAoYnVzOiAweCVsbHgpXG4i
LAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBpLCBtZW0sCisJCQkodW5zaWduZWQgbG9u
ZyBsb25nKXZpcnRfdG9fYnVzKG1lbSkpOworCX0KKworCWZoLT5idWZmZXJzLmFsbG9jYXRlZCA9
IDE7CisKKwlyZXR1cm4gMDsKK30KKworLyogZnJlZSB0aGUgVjRMIGdyYWIgYnVmZmVycyAqLwor
c3RhdGljIHZvaWQgdjRsX2ZidWZmZXJfZnJlZShzdHJ1Y3Qgem9yYW5fZmggKmZoKQoreworCXN0
cnVjdCB6b3JhbiAqenIgPSBmaC0+enI7CisJaW50IGksIG9mZjsKKwl1bnNpZ25lZCBjaGFyICpt
ZW07CisKKwlkcHJpbnRrKDQsIEtFUk5fSU5GTyAiJXM6ICVzXG4iLCBaUl9ERVZOQU1FKHpyKSwg
X19mdW5jX18pOworCisJZm9yIChpID0gMDsgaSA8IGZoLT5idWZmZXJzLm51bV9idWZmZXJzOyBp
KyspIHsKKwkJaWYgKCFmaC0+YnVmZmVycy5idWZmZXJbaV0udjRsLmZidWZmZXIpCisJCQljb250
aW51ZTsKKworCQltZW0gPSBmaC0+YnVmZmVycy5idWZmZXJbaV0udjRsLmZidWZmZXI7CisJCWZv
ciAob2ZmID0gMDsgb2ZmIDwgZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemU7CisJCSAgICAgb2ZmICs9
IFBBR0VfU0laRSkKKwkJCUNsZWFyUGFnZVJlc2VydmVkKHZpcnRfdG9fcGFnZShtZW0gKyBvZmYp
KTsKKwkJa2ZyZWUoZmgtPmJ1ZmZlcnMuYnVmZmVyW2ldLnY0bC5mYnVmZmVyKTsKKwkJZmgtPmJ1
ZmZlcnMuYnVmZmVyW2ldLnY0bC5mYnVmZmVyID0gTlVMTDsKKwl9CisKKwlmaC0+YnVmZmVycy5h
bGxvY2F0ZWQgPSAwOworfQorCisvKgorICogICBBbGxvY2F0ZSB0aGUgTUpQRUcgZ3JhYiBidWZm
ZXJzLgorICoKKyAqICAgSWYgYSBOYXRvbWEgY2hpcHNldCBpcyBwcmVzZW50IGFuZCB0aGlzIGlz
IGEgcmV2aXNpb24gMSB6cjM2MDU3LAorICogICBlYWNoIE1KUEVHIGJ1ZmZlciBuZWVkcyB0byBi
ZSBwaHlzaWNhbGx5IGNvbnRpZ3VvdXMuCisgKiAgIChSSjogVGhpcyBzdGF0ZW1lbnQgaXMgZnJv
bSBEYXZlIFBlcmtzJyBvcmlnaW5hbCBkcml2ZXIsCisgKiAgIEkgY291bGQgbmV2ZXIgY2hlY2sg
aXQgYmVjYXVzZSBJIGhhdmUgYSB6cjM2MDY3KQorICoKKyAqICAgUko6IFRoZSBjb250ZW50cyBn
cmFiIGJ1ZmZlcnMgbmVlZHMgbmV2ZXIgYmUgYWNjZXNzZWQgaW4gdGhlIGRyaXZlci4KKyAqICAg
ICAgIFRoZXJlZm9yZSB0aGVyZSBpcyBubyBuZWVkIHRvIGFsbG9jYXRlIHRoZW0gd2l0aCB2bWFs
bG9jIGluIG9yZGVyCisgKiAgICAgICB0byBnZXQgYSBjb250aWd1b3VzIHZpcnR1YWwgbWVtb3J5
IHNwYWNlLgorICogICAgICAgSSBkb24ndCB1bmRlcnN0YW5kIHdoeSBtYW55IG90aGVyIGRyaXZl
cnMgZmlyc3QgYWxsb2NhdGUgdGhlbSB3aXRoCisgKiAgICAgICB2bWFsbG9jICh3aGljaCB1c2Vz
IGludGVybmFsbHkgYWxzbyBnZXRfemVyb2VkX3BhZ2UsIGJ1dCBkZWxpdmVycyB5b3UKKyAqICAg
ICAgIHZpcnR1YWwgYWRkcmVzc2VzKSBhbmQgdGhlbiBhZ2FpbiBoYXZlIHRvIG1ha2UgYSBsb3Qg
b2YgZWZmb3J0cworICogICAgICAgdG8gZ2V0IHRoZSBwaHlzaWNhbCBhZGRyZXNzLgorICoKKyAq
ICAgQmVuIENhcHBlcjoKKyAqICAgICAgIE9uIGJpZy1lbmRpYW4gYXJjaGl0ZWN0dXJlcyAoc3Vj
aCBhcyBwcGMpIHNvbWUgZXh0cmEgc3RlcHMKKyAqICAgICAgIGFyZSBuZWVkZWQuIFdoZW4gcmVh
ZGluZyBhbmQgd3JpdGluZyB0byB0aGUgc3RhdF9jb20gYXJyYXkKKyAqICAgICAgIGFuZCBmcmFn
bWVudCBidWZmZXJzLCB0aGUgZGV2aWNlIGV4cGVjdHMgdG8gc2VlIGxpdHRsZS0KKyAqICAgICAg
IGVuZGlhbiB2YWx1ZXMuIFRoZSB1c2Ugb2YgY3B1X3RvX2xlMzIoKSBhbmQgbGUzMl90b19jcHUo
KQorICogICAgICAgaW4gdGhpcyBmdW5jdGlvbiAoYW5kIG9uZSBvciB0d28gb3RoZXJzIGluIHpv
cmFuX2RldmljZS5jKQorICogICAgICAgZW5zdXJlIHRoYXQgdGhlc2UgdmFsdWVzIGFyZSBhbHdh
eXMgc3RvcmVkIGluIGxpdHRsZS1lbmRpYW4KKyAqICAgICAgIGZvcm0sIHJlZ2FyZGxlc3Mgb2Yg
YXJjaGl0ZWN0dXJlLiBUaGUgenIzNjA1NyBkb2VzIFZlcnkgQmFkCisgKiAgICAgICBUaGluZ3Mg
b24gYmlnIGVuZGlhbiBhcmNoaXRlY3R1cmVzIGlmIHRoZSBzdGF0X2NvbSBhcnJheQorICogICAg
ICAgYW5kIGZyYWdtZW50IGJ1ZmZlcnMgYXJlIG5vdCBsaXR0bGUtZW5kaWFuLgorICovCisKK3N0
YXRpYyBpbnQganBnX2ZidWZmZXJfYWxsb2Moc3RydWN0IHpvcmFuX2ZoICpmaCkKK3sKKwlzdHJ1
Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCWludCBpLCBqLCBvZmY7CisJdTggKm1lbTsKKworCWZv
ciAoaSA9IDA7IGkgPCBmaC0+YnVmZmVycy5udW1fYnVmZmVyczsgaSsrKSB7CisJCWlmIChmaC0+
YnVmZmVycy5idWZmZXJbaV0uanBnLmZyYWdfdGFiKQorCQkJZHByaW50aygyLAorCQkJCUtFUk5f
V0FSTklORworCQkJCSIlczogJXMgLSBidWZmZXIgJWQgYWxyZWFkeSBhbGxvY2F0ZWQhP1xuIiwK
KwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18sIGkpOworCisJCS8qIEFsbG9jYXRlIGZyYWdt
ZW50IHRhYmxlIGZvciB0aGlzIGJ1ZmZlciAqLworCisJCW1lbSA9ICh2b2lkICopZ2V0X3plcm9l
ZF9wYWdlKEdGUF9LRVJORUwpOworCQlpZiAoIW1lbSkgeworCQkJZHByaW50aygxLAorCQkJCUtF
Uk5fRVJSCisJCQkJIiVzOiAlcyAtIGdldF96ZXJvZWRfcGFnZSAoZnJhZ190YWIpIGZhaWxlZCBm
b3IgYnVmZmVyICVkXG4iLAorCQkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXywgaSk7CisJCQlq
cGdfZmJ1ZmZlcl9mcmVlKGZoKTsKKwkJCXJldHVybiAtRU5PQlVGUzsKKwkJfQorCQlmaC0+YnVm
ZmVycy5idWZmZXJbaV0uanBnLmZyYWdfdGFiID0gKF9fbGUzMiAqKW1lbTsKKwkJZmgtPmJ1ZmZl
cnMuYnVmZmVyW2ldLmpwZy5mcmFnX3RhYl9idXMgPSB2aXJ0X3RvX2J1cyhtZW0pOworCisJCWlm
IChmaC0+YnVmZmVycy5uZWVkX2NvbnRpZ3VvdXMpIHsKKwkJCW1lbSA9IGttYWxsb2MoZmgtPmJ1
ZmZlcnMuYnVmZmVyX3NpemUsIEdGUF9LRVJORUwpOworCQkJaWYgKG1lbSA9PSBOVUxMKSB7CisJ
CQkJZHByaW50aygxLAorCQkJCQlLRVJOX0VSUgorCQkJCQkiJXM6ICVzIC0ga21hbGxvYyBmYWls
ZWQgZm9yIGJ1ZmZlciAlZFxuIiwKKwkJCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBpKTsK
KwkJCQlqcGdfZmJ1ZmZlcl9mcmVlKGZoKTsKKwkJCQlyZXR1cm4gLUVOT0JVRlM7CisJCQl9CisJ
CQlmaC0+YnVmZmVycy5idWZmZXJbaV0uanBnLmZyYWdfdGFiWzBdID0KKwkJCQljcHVfdG9fbGUz
Mih2aXJ0X3RvX2J1cyhtZW0pKTsKKwkJCWZoLT5idWZmZXJzLmJ1ZmZlcltpXS5qcGcuZnJhZ190
YWJbMV0gPQorCQkJCWNwdV90b19sZTMyKChmaC0+YnVmZmVycy5idWZmZXJfc2l6ZSA+PiAxKSB8
IDEpOworCQkJZm9yIChvZmYgPSAwOyBvZmYgPCBmaC0+YnVmZmVycy5idWZmZXJfc2l6ZTsgb2Zm
ICs9IFBBR0VfU0laRSkKKwkJCQlTZXRQYWdlUmVzZXJ2ZWQodmlydF90b19wYWdlKG1lbSArIG9m
ZikpOworCQl9IGVsc2UgeworCQkJLyoganBnX2J1ZnNpemUgaXMgYWxyZWFkeSBwYWdlIGFsaWdu
ZWQgKi8KKwkJCWZvciAoaiA9IDA7IGogPCBmaC0+YnVmZmVycy5idWZmZXJfc2l6ZSAvIFBBR0Vf
U0laRTsgaisrKSB7CisJCQkJbWVtID0gKHZvaWQgKilnZXRfemVyb2VkX3BhZ2UoR0ZQX0tFUk5F
TCk7CisJCQkJaWYgKG1lbSA9PSBOVUxMKSB7CisJCQkJCWRwcmludGsoMSwKKwkJCQkJCUtFUk5f
RVJSCisJCQkJCQkiJXM6ICVzIC0gZ2V0X3plcm9lZF9wYWdlIGZhaWxlZCBmb3IgYnVmZmVyICVk
XG4iLAorCQkJCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBpKTsKKwkJCQkJanBnX2ZidWZm
ZXJfZnJlZShmaCk7CisJCQkJCXJldHVybiAtRU5PQlVGUzsKKwkJCQl9CisKKwkJCQlmaC0+YnVm
ZmVycy5idWZmZXJbaV0uanBnLmZyYWdfdGFiWzIgKiBqXSA9CisJCQkJCWNwdV90b19sZTMyKHZp
cnRfdG9fYnVzKG1lbSkpOworCQkJCWZoLT5idWZmZXJzLmJ1ZmZlcltpXS5qcGcuZnJhZ190YWJb
MiAqIGogKyAxXSA9CisJCQkJCWNwdV90b19sZTMyKChQQUdFX1NJWkUgPj4gMikgPDwgMSk7CisJ
CQkJU2V0UGFnZVJlc2VydmVkKHZpcnRfdG9fcGFnZShtZW0pKTsKKwkJCX0KKworCQkJZmgtPmJ1
ZmZlcnMuYnVmZmVyW2ldLmpwZy5mcmFnX3RhYlsyICogaiAtIDFdIHw9IGNwdV90b19sZTMyKDEp
OworCQl9CisJfQorCisJZHByaW50ayg0LAorCQlLRVJOX0RFQlVHICIlczogJXMgLSAlZCBLQiBh
bGxvY2F0ZWRcbiIsCisJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXywKKwkJKGZoLT5idWZmZXJz
Lm51bV9idWZmZXJzICogZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemUpID4+IDEwKTsKKworCWZoLT5i
dWZmZXJzLmFsbG9jYXRlZCA9IDE7CisKKwlyZXR1cm4gMDsKK30KKworLyogZnJlZSB0aGUgTUpQ
RUcgZ3JhYiBidWZmZXJzICovCitzdGF0aWMgdm9pZCBqcGdfZmJ1ZmZlcl9mcmVlKHN0cnVjdCB6
b3Jhbl9maCAqZmgpCit7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKwlpbnQgaSwgaiwg
b2ZmOworCXVuc2lnbmVkIGNoYXIgKm1lbTsKKwlfX2xlMzIgZnJhZ190YWI7CisJc3RydWN0IHpv
cmFuX2J1ZmZlciAqYnVmZmVyOworCisJZHByaW50ayg0LCBLRVJOX0RFQlVHICIlczogJXNcbiIs
IFpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXyk7CisKKwlmb3IgKGkgPSAwLCBidWZmZXIgPSAmZmgt
PmJ1ZmZlcnMuYnVmZmVyWzBdOworCSAgICAgaSA8IGZoLT5idWZmZXJzLm51bV9idWZmZXJzOyBp
KyssIGJ1ZmZlcisrKSB7CisJCWlmICghYnVmZmVyLT5qcGcuZnJhZ190YWIpCisJCQljb250aW51
ZTsKKworCQlpZiAoZmgtPmJ1ZmZlcnMubmVlZF9jb250aWd1b3VzKSB7CisJCQlmcmFnX3RhYiA9
IGJ1ZmZlci0+anBnLmZyYWdfdGFiWzBdOworCisJCQlpZiAoZnJhZ190YWIpIHsKKwkJCQltZW0g
PSBidXNfdG9fdmlydChsZTMyX3RvX2NwdShmcmFnX3RhYikpOworCQkJCWZvciAob2ZmID0gMDsg
b2ZmIDwgZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemU7IG9mZiArPSBQQUdFX1NJWkUpCisJCQkJCUNs
ZWFyUGFnZVJlc2VydmVkKHZpcnRfdG9fcGFnZShtZW0gKyBvZmYpKTsKKwkJCQlrZnJlZShtZW0p
OworCQkJCWJ1ZmZlci0+anBnLmZyYWdfdGFiWzBdID0gMDsKKwkJCQlidWZmZXItPmpwZy5mcmFn
X3RhYlsxXSA9IDA7CisJCQl9CisJCX0gZWxzZSB7CisJCQlmb3IgKGogPSAwOyBqIDwgZmgtPmJ1
ZmZlcnMuYnVmZmVyX3NpemUgLyBQQUdFX1NJWkU7IGorKykgeworCQkJCWZyYWdfdGFiID0gYnVm
ZmVyLT5qcGcuZnJhZ190YWJbMiAqIGpdOworCisJCQkJaWYgKCFmcmFnX3RhYikKKwkJCQkJYnJl
YWs7CisJCQkJQ2xlYXJQYWdlUmVzZXJ2ZWQodmlydF90b19wYWdlKGJ1c190b192aXJ0KGxlMzJf
dG9fY3B1KGZyYWdfdGFiKSkpKTsKKwkJCQlmcmVlX3BhZ2UoKHVuc2lnbmVkIGxvbmcpYnVzX3Rv
X3ZpcnQobGUzMl90b19jcHUoZnJhZ190YWIpKSk7CisJCQkJYnVmZmVyLT5qcGcuZnJhZ190YWJb
MiAqIGpdID0gMDsKKwkJCQlidWZmZXItPmpwZy5mcmFnX3RhYlsyICogaiArIDFdID0gMDsKKwkJ
CX0KKwkJfQorCisJCWZyZWVfcGFnZSgodW5zaWduZWQgbG9uZylidWZmZXItPmpwZy5mcmFnX3Rh
Yik7CisJCWJ1ZmZlci0+anBnLmZyYWdfdGFiID0gTlVMTDsKKwl9CisKKwlmaC0+YnVmZmVycy5h
bGxvY2F0ZWQgPSAwOworfQorCisvKgorICogICBWNEwgQnVmZmVyIGdyYWJiaW5nCisgKi8KKwor
c3RhdGljIGludAorem9yYW5fdjRsX3NldF9mb3JtYXQgKHN0cnVjdCB6b3Jhbl9maCAgICAgICAg
ICAgKmZoLAorCQkgICAgICBpbnQgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCwKKwkJICAg
ICAgaW50ICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0LAorCQkgICAgICBjb25zdCBzdHJ1
Y3Qgem9yYW5fZm9ybWF0ICpmb3JtYXQpCit7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsK
KwlpbnQgYnBwOworCisJLyogQ2hlY2sgc2l6ZSBhbmQgZm9ybWF0IG9mIHRoZSBncmFiIHdhbnRl
ZCAqLworCisJaWYgKGhlaWdodCA8IEJVWl9NSU5fSEVJR0hUIHx8IHdpZHRoIDwgQlVaX01JTl9X
SURUSCB8fAorCSAgICBoZWlnaHQgPiBCVVpfTUFYX0hFSUdIVCB8fCB3aWR0aCA+IEJVWl9NQVhf
V0lEVEgpIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczogJXMgLSB3cm9uZyBm
cmFtZSBzaXplICglZHglZClcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18sIHdpZHRo
LCBoZWlnaHQpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlicHAgPSAoZm9ybWF0LT5kZXB0
aCArIDcpIC8gODsKKworCS8qIENoZWNrIGFnYWluc3QgYXZhaWxhYmxlIGJ1ZmZlciBzaXplICov
CisJaWYgKGhlaWdodCAqIHdpZHRoICogYnBwID4gZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemUpIHsK
KwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczogJXMgLSB2aWRlbyBidWZmZXIgc2l6
ZSAoJWQga0IpIGlzIHRvbyBzbWFsbFxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXywg
ZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemUgPj4gMTApOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisK
KwkvKiBUaGUgdmlkZW8gZnJvbnQgZW5kIG5lZWRzIDQtYnl0ZSBhbGluZ2VkIGxpbmUgc2l6ZXMg
Ki8KKworCWlmICgoYnBwID09IDIgJiYgKHdpZHRoICYgMSkpIHx8IChicHAgPT0gMyAmJiAod2lk
dGggJiAzKSkpIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczogJXMgLSB3cm9u
ZyBmcmFtZSBhbGlnbm1lbnRcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQly
ZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlmaC0+djRsX3NldHRpbmdzLndpZHRoID0gd2lkdGg7CisJ
ZmgtPnY0bF9zZXR0aW5ncy5oZWlnaHQgPSBoZWlnaHQ7CisJZmgtPnY0bF9zZXR0aW5ncy5mb3Jt
YXQgPSBmb3JtYXQ7CisJZmgtPnY0bF9zZXR0aW5ncy5ieXRlc3BlcmxpbmUgPSBicHAgKiBmaC0+
djRsX3NldHRpbmdzLndpZHRoOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgem9yYW5f
djRsX3F1ZXVlX2ZyYW1lKHN0cnVjdCB6b3Jhbl9maCAqZmgsIGludCBudW0pCit7CisJc3RydWN0
IHpvcmFuICp6ciA9IGZoLT56cjsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOworCWludCByZXMgPSAw
OworCisJaWYgKCFmaC0+YnVmZmVycy5hbGxvY2F0ZWQpIHsKKwkJZHByaW50aygxLAorCQkJS0VS
Tl9FUlIKKwkJCSIlczogJXMgLSBidWZmZXJzIG5vdCB5ZXQgYWxsb2NhdGVkXG4iLAorCQkJWlJf
REVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJcmVzID0gLUVOT01FTTsKKwl9CisKKwkvKiBObyBn
cmFiYmluZyBvdXRzaWRlIHRoZSBidWZmZXIgcmFuZ2UhICovCisJaWYgKG51bSA+PSBmaC0+YnVm
ZmVycy5udW1fYnVmZmVycyB8fCBudW0gPCAwKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJS
CisJCQkiJXM6ICVzIC0gYnVmZmVyICVkIGlzIG91dCBvZiByYW5nZVxuIiwKKwkJCVpSX0RFVk5B
TUUoenIpLCBfX2Z1bmNfXywgbnVtKTsKKwkJcmVzID0gLUVJTlZBTDsKKwl9CisKKwlzcGluX2xv
Y2tfaXJxc2F2ZSgmenItPnNwaW5sb2NrLCBmbGFncyk7CisKKwlpZiAoZmgtPmJ1ZmZlcnMuYWN0
aXZlID09IFpPUkFOX0ZSRUUpIHsKKwkJaWYgKHpyLT52NGxfYnVmZmVycy5hY3RpdmUgPT0gWk9S
QU5fRlJFRSkgeworCQkJenItPnY0bF9idWZmZXJzID0gZmgtPmJ1ZmZlcnM7CisJCQlmaC0+YnVm
ZmVycy5hY3RpdmUgPSBaT1JBTl9BQ1RJVkU7CisJCX0gZWxzZSB7CisJCQlkcHJpbnRrKDEsCisJ
CQkJS0VSTl9FUlIKKwkJCQkiJXM6ICVzIC0gYW5vdGhlciBzZXNzaW9uIGlzIGFscmVhZHkgY2Fw
dHVyaW5nXG4iLAorCQkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXyk7CisJCQlyZXMgPSAtRUJV
U1k7CisJCX0KKwl9CisKKwkvKiBtYWtlIHN1cmUgYSBncmFiIGlzbid0IGdvaW5nIG9uIGN1cnJl
bnRseSB3aXRoIHRoaXMgYnVmZmVyICovCisJaWYgKCFyZXMpIHsKKwkJc3dpdGNoICh6ci0+djRs
X2J1ZmZlcnMuYnVmZmVyW251bV0uc3RhdGUpIHsKKwkJZGVmYXVsdDoKKwkJY2FzZSBCVVpfU1RB
VEVfUEVORDoKKwkJCWlmICh6ci0+djRsX2J1ZmZlcnMuYWN0aXZlID09IFpPUkFOX0ZSRUUpIHsK
KwkJCQlmaC0+YnVmZmVycy5hY3RpdmUgPSBaT1JBTl9GUkVFOworCQkJCXpyLT52NGxfYnVmZmVy
cy5hbGxvY2F0ZWQgPSAwOworCQkJfQorCQkJcmVzID0gLUVCVVNZOwkvKiB3aGF0IGFyZSB5b3Ug
ZG9pbmc/ICovCisJCQlicmVhazsKKwkJY2FzZSBCVVpfU1RBVEVfRE9ORToKKwkJCWRwcmludGso
MiwKKwkJCQlLRVJOX1dBUk5JTkcKKwkJCQkiJXM6ICVzIC0gcXVldWVpbmcgYnVmZmVyICVkIGlu
IHN0YXRlIERPTkUhP1xuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18sIG51bSk7CisJ
CQkvKiBmYWxsIHRocm91Z2ggKi8KKwkJY2FzZSBCVVpfU1RBVEVfVVNFUjoKKwkJCS8qIHNpbmNl
IHRoZXJlIGlzIGF0IGxlYXN0IG9uZSB1bnVzZWQgYnVmZmVyIHRoZXJlJ3Mgcm9vbSBmb3IgYXQg
bGVhc3QKKwkJCSAqIG9uZSBtb3JlIHBlbmRbXSBlbnRyeSAqLworCQkJenItPnY0bF9wZW5kW3py
LT52NGxfcGVuZF9oZWFkKysgJiBWNExfTUFTS19GUkFNRV0gPSBudW07CisJCQl6ci0+djRsX2J1
ZmZlcnMuYnVmZmVyW251bV0uc3RhdGUgPSBCVVpfU1RBVEVfUEVORDsKKwkJCXpyLT52NGxfYnVm
ZmVycy5idWZmZXJbbnVtXS5icy5sZW5ndGggPQorCQkJICAgIGZoLT52NGxfc2V0dGluZ3MuYnl0
ZXNwZXJsaW5lICoKKwkJCSAgICB6ci0+djRsX3NldHRpbmdzLmhlaWdodDsKKwkJCWZoLT5idWZm
ZXJzLmJ1ZmZlcltudW1dID0genItPnY0bF9idWZmZXJzLmJ1ZmZlcltudW1dOworCQkJYnJlYWs7
CisJCX0KKwl9CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ6ci0+c3BpbmxvY2ssIGZsYWdz
KTsKKworCWlmICghcmVzICYmIHpyLT52NGxfYnVmZmVycy5hY3RpdmUgPT0gWk9SQU5fRlJFRSkK
KwkJenItPnY0bF9idWZmZXJzLmFjdGl2ZSA9IGZoLT5idWZmZXJzLmFjdGl2ZTsKKworCXJldHVy
biByZXM7Cit9CisKKy8qCisgKiBTeW5jIG9uIGEgVjRMIGJ1ZmZlcgorICovCisKK3N0YXRpYyBp
bnQgdjRsX3N5bmMoc3RydWN0IHpvcmFuX2ZoICpmaCwgaW50IGZyYW1lKQoreworCXN0cnVjdCB6
b3JhbiAqenIgPSBmaC0+enI7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCWlmIChmaC0+YnVm
ZmVycy5hY3RpdmUgPT0gWk9SQU5fRlJFRSkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgor
CQkJIiVzOiAlcyAtIG5vIGdyYWIgYWN0aXZlIGZvciB0aGlzIHNlc3Npb25cbiIsCisJCQlaUl9E
RVZOQU1FKHpyKSwgX19mdW5jX18pOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwkvKiBjaGVj
ayBwYXNzZWQtaW4gZnJhbWUgbnVtYmVyICovCisJaWYgKGZyYW1lID49IGZoLT5idWZmZXJzLm51
bV9idWZmZXJzIHx8IGZyYW1lIDwgMCkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUiAiJXM6
ICVzIC0gZnJhbWUgJWQgaXMgaW52YWxpZFxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNf
XywgZnJhbWUpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwkvKiBDaGVjayBpZiBpcyBidWZm
ZXIgd2FzIHF1ZXVlZCBhdCBhbGwgKi8KKwlpZiAoenItPnY0bF9idWZmZXJzLmJ1ZmZlcltmcmFt
ZV0uc3RhdGUgPT0gQlVaX1NUQVRFX1VTRVIpIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIK
KwkJCSIlczogJXMgLSBhdHRlbXB0IHRvIHN5bmMgb24gYSBidWZmZXIgd2hpY2ggd2FzIG5vdCBx
dWV1ZWQ/XG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJcmV0dXJuIC1FUFJP
VE87CisJfQorCisJbXV0ZXhfdW5sb2NrKCZ6ci0+bG9jayk7CisJLyogd2FpdCBvbiB0aGlzIGJ1
ZmZlciB0byBnZXQgcmVhZHkgKi8KKwlpZiAoIXdhaXRfZXZlbnRfaW50ZXJydXB0aWJsZV90aW1l
b3V0KHpyLT52NGxfY2FwcSwKKwkJKHpyLT52NGxfYnVmZmVycy5idWZmZXJbZnJhbWVdLnN0YXRl
ICE9IEJVWl9TVEFURV9QRU5EKSwgMTAqSFopKSB7CisJCW11dGV4X2xvY2soJnpyLT5sb2NrKTsK
KwkJcmV0dXJuIC1FVElNRTsKKwl9CisJbXV0ZXhfbG9jaygmenItPmxvY2spOworCWlmIChzaWdu
YWxfcGVuZGluZyhjdXJyZW50KSkKKwkJcmV0dXJuIC1FUkVTVEFSVFNZUzsKKworCS8qIGJ1ZmZl
ciBzaG91bGQgbm93IGJlIGluIEJVWl9TVEFURV9ET05FICovCisJaWYgKHpyLT52NGxfYnVmZmVy
cy5idWZmZXJbZnJhbWVdLnN0YXRlICE9IEJVWl9TVEFURV9ET05FKQorCQlkcHJpbnRrKDIsCisJ
CQlLRVJOX0VSUiAiJXM6ICVzIC0gaW50ZXJuYWwgc3RhdGUgZXJyb3JcbiIsCisJCQlaUl9ERVZO
QU1FKHpyKSwgX19mdW5jX18pOworCisJenItPnY0bF9idWZmZXJzLmJ1ZmZlcltmcmFtZV0uc3Rh
dGUgPSBCVVpfU1RBVEVfVVNFUjsKKwlmaC0+YnVmZmVycy5idWZmZXJbZnJhbWVdID0genItPnY0
bF9idWZmZXJzLmJ1ZmZlcltmcmFtZV07CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmenItPnNwaW5s
b2NrLCBmbGFncyk7CisKKwkvKiBDaGVjayBpZiBzdHJlYW1pbmcgY2FwdHVyZSBoYXMgZmluaXNo
ZWQgKi8KKwlpZiAoenItPnY0bF9wZW5kX3RhaWwgPT0genItPnY0bF9wZW5kX2hlYWQpIHsKKwkJ
enIzNjA1N19zZXRfbWVtZ3JhYih6ciwgMCk7CisJCWlmICh6ci0+djRsX2J1ZmZlcnMuYWN0aXZl
ID09IFpPUkFOX0FDVElWRSkgeworCQkJZmgtPmJ1ZmZlcnMuYWN0aXZlID0genItPnY0bF9idWZm
ZXJzLmFjdGl2ZSA9IFpPUkFOX0ZSRUU7CisJCQl6ci0+djRsX2J1ZmZlcnMuYWxsb2NhdGVkID0g
MDsKKwkJfQorCX0KKworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnpyLT5zcGlubG9jaywgZmxh
Z3MpOworCisJcmV0dXJuIDA7Cit9CisKKy8qCisgKiAgIFF1ZXVlIGEgTUpQRUcgYnVmZmVyIGZv
ciBjYXB0dXJlL3BsYXliYWNrCisgKi8KKworc3RhdGljIGludCB6b3Jhbl9qcGdfcXVldWVfZnJh
bWUoc3RydWN0IHpvcmFuX2ZoICpmaCwgaW50IG51bSwKKwkJCQkgZW51bSB6b3Jhbl9jb2RlY19t
b2RlIG1vZGUpCit7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKwl1bnNpZ25lZCBsb25n
IGZsYWdzOworCWludCByZXMgPSAwOworCisJLyogQ2hlY2sgaWYgYnVmZmVycyBhcmUgYWxsb2Nh
dGVkICovCisJaWYgKCFmaC0+YnVmZmVycy5hbGxvY2F0ZWQpIHsKKwkJZHByaW50aygxLAorCQkJ
S0VSTl9FUlIKKwkJCSIlczogJXMgLSBidWZmZXJzIG5vdCB5ZXQgYWxsb2NhdGVkXG4iLAorCQkJ
WlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCisJLyog
Tm8gZ3JhYmJpbmcgb3V0c2lkZSB0aGUgYnVmZmVyIHJhbmdlISAqLworCWlmIChudW0gPj0gZmgt
PmJ1ZmZlcnMubnVtX2J1ZmZlcnMgfHwgbnVtIDwgMCkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJO
X0VSUgorCQkJIiVzOiAlcyAtIGJ1ZmZlciAlZCBvdXQgb2YgcmFuZ2VcbiIsCisJCQlaUl9ERVZO
QU1FKHpyKSwgX19mdW5jX18sIG51bSk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCS8qIHdo
YXQgaXMgdGhlIGNvZGVjIG1vZGUgcmlnaHQgbm93PyAqLworCWlmICh6ci0+Y29kZWNfbW9kZSA9
PSBCVVpfTU9ERV9JRExFKSB7CisJCXpyLT5qcGdfc2V0dGluZ3MgPSBmaC0+anBnX3NldHRpbmdz
OworCX0gZWxzZSBpZiAoenItPmNvZGVjX21vZGUgIT0gbW9kZSkgeworCQkvKiB3cm9uZyBjb2Rl
YyBtb2RlIGFjdGl2ZSAtIGludmFsaWQgKi8KKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJ
CSIlczogJXMgLSBjb2RlYyBpbiB3cm9uZyBtb2RlXG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9f
ZnVuY19fKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJaWYgKGZoLT5idWZmZXJzLmFjdGl2
ZSA9PSBaT1JBTl9GUkVFKSB7CisJCWlmICh6ci0+anBnX2J1ZmZlcnMuYWN0aXZlID09IFpPUkFO
X0ZSRUUpIHsKKwkJCXpyLT5qcGdfYnVmZmVycyA9IGZoLT5idWZmZXJzOworCQkJZmgtPmJ1ZmZl
cnMuYWN0aXZlID0gWk9SQU5fQUNUSVZFOworCQl9IGVsc2UgeworCQkJZHByaW50aygxLAorCQkJ
CUtFUk5fRVJSCisJCQkJIiVzOiAlcyAtIGFub3RoZXIgc2Vzc2lvbiBpcyBhbHJlYWR5IGNhcHR1
cmluZ1xuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQkJcmVzID0gLUVCVVNZ
OworCQl9CisJfQorCisJaWYgKCFyZXMgJiYgenItPmNvZGVjX21vZGUgPT0gQlVaX01PREVfSURM
RSkgeworCQkvKiBPayBsb2FkIHVwIHRoZSBqcGVnIGNvZGVjICovCisJCXpyMzYwNTdfZW5hYmxl
X2pwZyh6ciwgbW9kZSk7CisJfQorCisJc3Bpbl9sb2NrX2lycXNhdmUoJnpyLT5zcGlubG9jaywg
ZmxhZ3MpOworCisJaWYgKCFyZXMpIHsKKwkJc3dpdGNoICh6ci0+anBnX2J1ZmZlcnMuYnVmZmVy
W251bV0uc3RhdGUpIHsKKwkJY2FzZSBCVVpfU1RBVEVfRE9ORToKKwkJCWRwcmludGsoMiwKKwkJ
CQlLRVJOX1dBUk5JTkcKKwkJCQkiJXM6ICVzIC0gcXVldWluZyBmcmFtZSBpbiBCVVpfU1RBVEVf
RE9ORSBzdGF0ZSE/XG4iLAorCQkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXyk7CisJCQkvKiBm
YWxsIHRocm91Z2ggKi8KKwkJY2FzZSBCVVpfU1RBVEVfVVNFUjoKKwkJCS8qIHNpbmNlIHRoZXJl
IGlzIGF0IGxlYXN0IG9uZSB1bnVzZWQgYnVmZmVyIHRoZXJlJ3Mgcm9vbSBmb3IgYXQKKwkJCSAq
bGVhc3Qgb25lIG1vcmUgcGVuZFtdIGVudHJ5ICovCisJCQl6ci0+anBnX3BlbmRbenItPmpwZ19x
dWVfaGVhZCsrICYgQlVaX01BU0tfRlJBTUVdID0gbnVtOworCQkJenItPmpwZ19idWZmZXJzLmJ1
ZmZlcltudW1dLnN0YXRlID0gQlVaX1NUQVRFX1BFTkQ7CisJCQlmaC0+YnVmZmVycy5idWZmZXJb
bnVtXSA9IHpyLT5qcGdfYnVmZmVycy5idWZmZXJbbnVtXTsKKwkJCXpvcmFuX2ZlZWRfc3RhdF9j
b20oenIpOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCWNhc2UgQlVaX1NUQVRFX0RNQToKKwkJ
Y2FzZSBCVVpfU1RBVEVfUEVORDoKKwkJCWlmICh6ci0+anBnX2J1ZmZlcnMuYWN0aXZlID09IFpP
UkFOX0ZSRUUpIHsKKwkJCQlmaC0+YnVmZmVycy5hY3RpdmUgPSBaT1JBTl9GUkVFOworCQkJCXpy
LT5qcGdfYnVmZmVycy5hbGxvY2F0ZWQgPSAwOworCQkJfQorCQkJcmVzID0gLUVCVVNZOwkvKiB3
aGF0IGFyZSB5b3UgZG9pbmc/ICovCisJCQlicmVhazsKKwkJfQorCX0KKworCXNwaW5fdW5sb2Nr
X2lycXJlc3RvcmUoJnpyLT5zcGlubG9jaywgZmxhZ3MpOworCisJaWYgKCFyZXMgJiYgenItPmpw
Z19idWZmZXJzLmFjdGl2ZSA9PSBaT1JBTl9GUkVFKQorCQl6ci0+anBnX2J1ZmZlcnMuYWN0aXZl
ID0gZmgtPmJ1ZmZlcnMuYWN0aXZlOworCisJcmV0dXJuIHJlczsKK30KKworc3RhdGljIGludCBq
cGdfcWJ1ZihzdHJ1Y3Qgem9yYW5fZmggKmZoLCBpbnQgZnJhbWUsIGVudW0gem9yYW5fY29kZWNf
bW9kZSBtb2RlKQoreworCXN0cnVjdCB6b3JhbiAqenIgPSBmaC0+enI7CisJaW50IHJlcyA9IDA7
CisKKwkvKiBEb2VzIHRoZSB1c2VyIHdhbnQgdG8gc3RvcCBzdHJlYW1pbmc/ICovCisJaWYgKGZy
YW1lIDwgMCkgeworCQlpZiAoenItPmNvZGVjX21vZGUgPT0gbW9kZSkgeworCQkJaWYgKGZoLT5i
dWZmZXJzLmFjdGl2ZSA9PSBaT1JBTl9GUkVFKSB7CisJCQkJZHByaW50aygxLAorCQkJCQlLRVJO
X0VSUgorCQkJCQkiJXM6ICVzKC0xKSAtIHNlc3Npb24gbm90IGFjdGl2ZVxuIiwKKwkJCQkJWlJf
REVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJCQlyZXR1cm4gLUVJTlZBTDsKKwkJCX0KKwkJCWZo
LT5idWZmZXJzLmFjdGl2ZSA9IHpyLT5qcGdfYnVmZmVycy5hY3RpdmUgPSBaT1JBTl9GUkVFOwor
CQkJenItPmpwZ19idWZmZXJzLmFsbG9jYXRlZCA9IDA7CisJCQl6cjM2MDU3X2VuYWJsZV9qcGco
enIsIEJVWl9NT0RFX0lETEUpOworCQkJcmV0dXJuIDA7CisJCX0gZWxzZSB7CisJCQlkcHJpbnRr
KDEsCisJCQkJS0VSTl9FUlIKKwkJCQkiJXM6ICVzIC0gc3RvcCBzdHJlYW1pbmcgYnV0IG5vdCBp
biBzdHJlYW1pbmcgbW9kZVxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQkJ
cmV0dXJuIC1FSU5WQUw7CisJCX0KKwl9CisKKwlpZiAoKHJlcyA9IHpvcmFuX2pwZ19xdWV1ZV9m
cmFtZShmaCwgZnJhbWUsIG1vZGUpKSkKKwkJcmV0dXJuIHJlczsKKworCS8qIFN0YXJ0IHRoZSBq
cGVnIGNvZGVjIHdoZW4gdGhlIGZpcnN0IGZyYW1lIGlzIHF1ZXVlZCAgKi8KKwlpZiAoIXJlcyAm
JiB6ci0+anBnX3F1ZV9oZWFkID09IDEpCisJCWpwZWdfc3RhcnQoenIpOworCisJcmV0dXJuIHJl
czsKK30KKworLyoKKyAqICAgU3luYyBvbiBhIE1KUEVHIGJ1ZmZlcgorICovCisKK3N0YXRpYyBp
bnQganBnX3N5bmMoc3RydWN0IHpvcmFuX2ZoICpmaCwgc3RydWN0IHpvcmFuX3N5bmMgKmJzKQor
eworCXN0cnVjdCB6b3JhbiAqenIgPSBmaC0+enI7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKwlp
bnQgZnJhbWU7CisKKwlpZiAoZmgtPmJ1ZmZlcnMuYWN0aXZlID09IFpPUkFOX0ZSRUUpIHsKKwkJ
ZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczogJXMgLSBjYXB0dXJlIGlzIG5vdCBjdXJy
ZW50bHkgYWN0aXZlXG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJcmV0dXJu
IC1FSU5WQUw7CisJfQorCWlmICh6ci0+Y29kZWNfbW9kZSAhPSBCVVpfTU9ERV9NT1RJT05fREVD
T01QUkVTUyAmJgorCSAgICB6ci0+Y29kZWNfbW9kZSAhPSBCVVpfTU9ERV9NT1RJT05fQ09NUFJF
U1MpIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczogJXMgLSBjb2RlYyBub3Qg
aW4gc3RyZWFtaW5nIG1vZGVcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQly
ZXR1cm4gLUVJTlZBTDsKKwl9CisJbXV0ZXhfdW5sb2NrKCZ6ci0+bG9jayk7CisJaWYgKCF3YWl0
X2V2ZW50X2ludGVycnVwdGlibGVfdGltZW91dCh6ci0+anBnX2NhcHEsCisJCQkoenItPmpwZ19x
dWVfdGFpbCAhPSB6ci0+anBnX2RtYV90YWlsIHx8CisJCQkgenItPmpwZ19kbWFfdGFpbCA9PSB6
ci0+anBnX2RtYV9oZWFkKSwKKwkJCTEwKkhaKSkgeworCQlpbnQgaXNyOworCisJCWJ0YW5kKH5a
UjM2MDU3X0pNQ19Hb19lbiwgWlIzNjA1N19KTUMpOworCQl1ZGVsYXkoMSk7CisJCXpyLT5jb2Rl
Yy0+Y29udHJvbCh6ci0+Y29kZWMsIENPREVDX0dfU1RBVFVTLAorCQkJCQkgICBzaXplb2YoaXNy
KSwgJmlzcik7CisJCW11dGV4X2xvY2soJnpyLT5sb2NrKTsKKwkJZHByaW50aygxLAorCQkJS0VS
Tl9FUlIKKwkJCSIlczogJXMgLSB0aW1lb3V0OiBjb2RlYyBpc3I9MHglMDJ4XG4iLAorCQkJWlJf
REVWTkFNRSh6ciksIF9fZnVuY19fLCBpc3IpOworCisJCXJldHVybiAtRVRJTUU7CisKKwl9CisJ
bXV0ZXhfbG9jaygmenItPmxvY2spOworCWlmIChzaWduYWxfcGVuZGluZyhjdXJyZW50KSkKKwkJ
cmV0dXJuIC1FUkVTVEFSVFNZUzsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZ6ci0+c3BpbmxvY2ss
IGZsYWdzKTsKKworCWlmICh6ci0+anBnX2RtYV90YWlsICE9IHpyLT5qcGdfZG1hX2hlYWQpCisJ
CWZyYW1lID0genItPmpwZ19wZW5kW3pyLT5qcGdfcXVlX3RhaWwrKyAmIEJVWl9NQVNLX0ZSQU1F
XTsKKwllbHNlCisJCWZyYW1lID0genItPmpwZ19wZW5kW3pyLT5qcGdfcXVlX3RhaWwgJiBCVVpf
TUFTS19GUkFNRV07CisKKwkvKiBidWZmZXIgc2hvdWxkIG5vdyBiZSBpbiBCVVpfU1RBVEVfRE9O
RSAqLworCWlmICh6ci0+anBnX2J1ZmZlcnMuYnVmZmVyW2ZyYW1lXS5zdGF0ZSAhPSBCVVpfU1RB
VEVfRE9ORSkKKwkJZHByaW50aygyLAorCQkJS0VSTl9FUlIgIiVzOiAlcyAtIGludGVybmFsIHN0
YXRlIGVycm9yXG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKworCSpicyA9IHpy
LT5qcGdfYnVmZmVycy5idWZmZXJbZnJhbWVdLmJzOworCWJzLT5mcmFtZSA9IGZyYW1lOworCXpy
LT5qcGdfYnVmZmVycy5idWZmZXJbZnJhbWVdLnN0YXRlID0gQlVaX1NUQVRFX1VTRVI7CisJZmgt
PmJ1ZmZlcnMuYnVmZmVyW2ZyYW1lXSA9IHpyLT5qcGdfYnVmZmVycy5idWZmZXJbZnJhbWVdOwor
CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmenItPnNwaW5sb2NrLCBmbGFncyk7CisKKwlyZXR1
cm4gMDsKK30KKworc3RhdGljIHZvaWQgem9yYW5fb3Blbl9pbml0X3Nlc3Npb24oc3RydWN0IHpv
cmFuX2ZoICpmaCkKK3sKKwlpbnQgaTsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCisJ
LyogUGVyIGRlZmF1bHQsIG1hcCB0aGUgVjRMIEJ1ZmZlcnMgKi8KKwltYXBfbW9kZV9yYXcoZmgp
OworCisJLyogdGFrZSBvdmVyIHRoZSBjYXJkJ3MgY3VycmVudCBzZXR0aW5ncyAqLworCWZoLT5v
dmVybGF5X3NldHRpbmdzID0genItPm92ZXJsYXlfc2V0dGluZ3M7CisJZmgtPm92ZXJsYXlfc2V0
dGluZ3MuaXNfc2V0ID0gMDsKKwlmaC0+b3ZlcmxheV9zZXR0aW5ncy5mb3JtYXQgPSB6ci0+b3Zl
cmxheV9zZXR0aW5ncy5mb3JtYXQ7CisJZmgtPm92ZXJsYXlfYWN0aXZlID0gWk9SQU5fRlJFRTsK
KworCS8qIHY0bCBzZXR0aW5ncyAqLworCWZoLT52NGxfc2V0dGluZ3MgPSB6ci0+djRsX3NldHRp
bmdzOworCS8qIGpwZyBzZXR0aW5ncyAqLworCWZoLT5qcGdfc2V0dGluZ3MgPSB6ci0+anBnX3Nl
dHRpbmdzOworCisJLyogYnVmZmVycyAqLworCW1lbXNldCgmZmgtPmJ1ZmZlcnMsIDAsIHNpemVv
ZihmaC0+YnVmZmVycykpOworCWZvciAoaSA9IDA7IGkgPCBNQVhfRlJBTUU7IGkrKykgeworCQlm
aC0+YnVmZmVycy5idWZmZXJbaV0uc3RhdGUgPSBCVVpfU1RBVEVfVVNFUjsJLyogbm90aGluZyBn
b2luZyBvbiAqLworCQlmaC0+YnVmZmVycy5idWZmZXJbaV0uYnMuZnJhbWUgPSBpOworCX0KKwlm
aC0+YnVmZmVycy5hbGxvY2F0ZWQgPSAwOworCWZoLT5idWZmZXJzLmFjdGl2ZSA9IFpPUkFOX0ZS
RUU7Cit9CisKK3N0YXRpYyB2b2lkIHpvcmFuX2Nsb3NlX2VuZF9zZXNzaW9uKHN0cnVjdCB6b3Jh
bl9maCAqZmgpCit7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKworCS8qIG92ZXJsYXkg
Ki8KKwlpZiAoZmgtPm92ZXJsYXlfYWN0aXZlICE9IFpPUkFOX0ZSRUUpIHsKKwkJZmgtPm92ZXJs
YXlfYWN0aXZlID0genItPm92ZXJsYXlfYWN0aXZlID0gWk9SQU5fRlJFRTsKKwkJenItPnY0bF9v
dmVybGF5X2FjdGl2ZSA9IDA7CisJCWlmICghenItPnY0bF9tZW1ncmFiX2FjdGl2ZSkKKwkJCXpy
MzYwNTdfb3ZlcmxheSh6ciwgMCk7CisJCXpyLT5vdmVybGF5X21hc2sgPSBOVUxMOworCX0KKwor
CWlmIChmaC0+bWFwX21vZGUgPT0gWk9SQU5fTUFQX01PREVfUkFXKSB7CisJCS8qIHY0bCBjYXB0
dXJlICovCisJCWlmIChmaC0+YnVmZmVycy5hY3RpdmUgIT0gWk9SQU5fRlJFRSkgeworCQkJdW5z
aWduZWQgbG9uZyBmbGFnczsKKworCQkJc3Bpbl9sb2NrX2lycXNhdmUoJnpyLT5zcGlubG9jaywg
ZmxhZ3MpOworCQkJenIzNjA1N19zZXRfbWVtZ3JhYih6ciwgMCk7CisJCQl6ci0+djRsX2J1ZmZl
cnMuYWxsb2NhdGVkID0gMDsKKwkJCXpyLT52NGxfYnVmZmVycy5hY3RpdmUgPSBmaC0+YnVmZmVy
cy5hY3RpdmUgPSBaT1JBTl9GUkVFOworCQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmenItPnNw
aW5sb2NrLCBmbGFncyk7CisJCX0KKworCQkvKiB2NGwgYnVmZmVycyAqLworCQlpZiAoZmgtPmJ1
ZmZlcnMuYWxsb2NhdGVkKQorCQkJdjRsX2ZidWZmZXJfZnJlZShmaCk7CisJfSBlbHNlIHsKKwkJ
LyoganBnIGNhcHR1cmUgKi8KKwkJaWYgKGZoLT5idWZmZXJzLmFjdGl2ZSAhPSBaT1JBTl9GUkVF
KSB7CisJCQl6cjM2MDU3X2VuYWJsZV9qcGcoenIsIEJVWl9NT0RFX0lETEUpOworCQkJenItPmpw
Z19idWZmZXJzLmFsbG9jYXRlZCA9IDA7CisJCQl6ci0+anBnX2J1ZmZlcnMuYWN0aXZlID0gZmgt
PmJ1ZmZlcnMuYWN0aXZlID0gWk9SQU5fRlJFRTsKKwkJfQorCisJCS8qIGpwZyBidWZmZXJzICov
CisJCWlmIChmaC0+YnVmZmVycy5hbGxvY2F0ZWQpCisJCQlqcGdfZmJ1ZmZlcl9mcmVlKGZoKTsK
Kwl9Cit9CisKKy8qCisgKiAgIE9wZW4gYSB6b3JhbiBjYXJkLiBSaWdodCBub3cgdGhlIGZsYWdz
IHN0dWZmIGlzIGp1c3QgcGxheWluZworICovCisKK3N0YXRpYyBpbnQgem9yYW5fb3BlbihzdHJ1
Y3QgZmlsZSAqZmlsZSkKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gdmlkZW9fZHJ2ZGF0YShmaWxl
KTsKKwlzdHJ1Y3Qgem9yYW5fZmggKmZoOworCWludCByZXMsIGZpcnN0X29wZW4gPSAwOworCisJ
ZHByaW50aygyLCBLRVJOX0lORk8gIiVzOiAlcyglcywgcGlkPVslZF0pLCB1c2VycygtKT0lZFxu
IiwKKwkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBjdXJyZW50LT5jb21tLCB0YXNrX3BpZF9u
cihjdXJyZW50KSwgenItPnVzZXIgKyAxKTsKKworCW11dGV4X2xvY2soJnpyLT5sb2NrKTsKKwor
CWlmICh6ci0+dXNlciA+PSAyMDQ4KSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIgIiVzOiB0b28g
bWFueSB1c2VycyAoJWQpIG9uIGRldmljZVxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCB6ci0+dXNl
cik7CisJCXJlcyA9IC1FQlVTWTsKKwkJZ290byBmYWlsX3VubG9jazsKKwl9CisKKwkvKiBub3cs
IGNyZWF0ZSB0aGUgb3BlbigpLXNwZWNpZmljIGZpbGVfb3BzIHN0cnVjdCAqLworCWZoID0ga3ph
bGxvYyhzaXplb2Yoc3RydWN0IHpvcmFuX2ZoKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFmaCkgewor
CQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgorCQkJIiVzOiAlcyAtIGFsbG9jYXRpb24gb2Ygem9y
YW5fZmggZmFpbGVkXG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJcmVzID0g
LUVOT01FTTsKKwkJZ290byBmYWlsX3VubG9jazsKKwl9CisJdjRsMl9maF9pbml0KCZmaC0+Zmgs
IHZpZGVvX2RldmRhdGEoZmlsZSkpOworCisJLyogdXNlZCB0byBiZSBCVVpfTUFYX1dJRFRIL0hF
SUdIVCwgYnV0IHRoYXQgZ2l2ZXMgb3ZlcmZsb3dzCisJICogb24gbm9ybS1jaGFuZ2UhICovCisJ
ZmgtPm92ZXJsYXlfbWFzayA9CisJICAgIGttYWxsb2MoYXJyYXkzX3NpemUoKDc2OCArIDMxKSAv
IDMyLCA1NzYsIDQpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWZoLT5vdmVybGF5X21hc2spIHsKKwkJ
ZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczogJXMgLSBhbGxvY2F0aW9uIG9mIG92ZXJs
YXlfbWFzayBmYWlsZWRcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQlyZXMg
PSAtRU5PTUVNOworCQlnb3RvIGZhaWxfZmg7CisJfQorCisJaWYgKHpyLT51c2VyKysgPT0gMCkK
KwkJZmlyc3Rfb3BlbiA9IDE7CisKKwkvKiBkZWZhdWx0IHNldHVwIC0gVE9ETzogbG9vayBhdCBm
bGFncyAqLworCWlmIChmaXJzdF9vcGVuKSB7CS8qIEZpcnN0IGRldmljZSBvcGVuICovCisJCXpy
MzYwNTdfcmVzdGFydCh6cik7CisJCXpvcmFuX29wZW5faW5pdF9wYXJhbXMoenIpOworCQl6b3Jh
bl9pbml0X2hhcmR3YXJlKHpyKTsKKworCQlidG9yKFpSMzYwNTdfSUNSX0ludFBpbkVuLCBaUjM2
MDU3X0lDUik7CisJfQorCisJLyogc2V0IGZpbGVfb3BzIHN0dWZmICovCisJZmlsZS0+cHJpdmF0
ZV9kYXRhID0gZmg7CisJZmgtPnpyID0genI7CisJem9yYW5fb3Blbl9pbml0X3Nlc3Npb24oZmgp
OworCXY0bDJfZmhfYWRkKCZmaC0+ZmgpOworCW11dGV4X3VubG9jaygmenItPmxvY2spOworCisJ
cmV0dXJuIDA7CisKK2ZhaWxfZmg6CisJdjRsMl9maF9leGl0KCZmaC0+ZmgpOworCWtmcmVlKGZo
KTsKK2ZhaWxfdW5sb2NrOgorCW11dGV4X3VubG9jaygmenItPmxvY2spOworCisJZHByaW50aygy
LCBLRVJOX0lORk8gIiVzOiBvcGVuIGZhaWxlZCAoJWQpLCB1c2VycygtKT0lZFxuIiwKKwkJWlJf
REVWTkFNRSh6ciksIHJlcywgenItPnVzZXIpOworCisJcmV0dXJuIHJlczsKK30KKworc3RhdGlj
IGludAorem9yYW5fY2xvc2Uoc3RydWN0IGZpbGUgICpmaWxlKQoreworCXN0cnVjdCB6b3Jhbl9m
aCAqZmggPSBmaWxlLT5wcml2YXRlX2RhdGE7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsK
KworCWRwcmludGsoMiwgS0VSTl9JTkZPICIlczogJXMoJXMsIHBpZD1bJWRdKSwgdXNlcnMoKyk9
JWRcbiIsCisJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXywgY3VycmVudC0+Y29tbSwgdGFza19w
aWRfbnIoY3VycmVudCksIHpyLT51c2VyIC0gMSk7CisKKwkvKiBrZXJuZWwgbG9ja3MgKGZzL2Rl
dmljZS5jKSwgc28gZG9uJ3QgZG8gdGhhdCBvdXJzZWx2ZXMKKwkgKiAocHJldmVudHMgZGVhZGxv
Y2tzKSAqLworCW11dGV4X2xvY2soJnpyLT5sb2NrKTsKKworCXpvcmFuX2Nsb3NlX2VuZF9zZXNz
aW9uKGZoKTsKKworCWlmICh6ci0+dXNlci0tID09IDEpIHsJLyogTGFzdCBwcm9jZXNzICovCisJ
CS8qIENsZWFuIHVwIEpQRUcgcHJvY2VzcyAqLworCQl3YWtlX3VwX2ludGVycnVwdGlibGUoJnpy
LT5qcGdfY2FwcSk7CisJCXpyMzYwNTdfZW5hYmxlX2pwZyh6ciwgQlVaX01PREVfSURMRSk7CisJ
CXpyLT5qcGdfYnVmZmVycy5hbGxvY2F0ZWQgPSAwOworCQl6ci0+anBnX2J1ZmZlcnMuYWN0aXZl
ID0gWk9SQU5fRlJFRTsKKworCQkvKiBkaXNhYmxlIGludGVycnVwdHMgKi8KKwkJYnRhbmQoflpS
MzYwNTdfSUNSX0ludFBpbkVuLCBaUjM2MDU3X0lDUik7CisKKwkJaWYgKHpyMzYwNjdfZGVidWcg
PiAxKQorCQkJcHJpbnRfaW50ZXJydXB0cyh6cik7CisKKwkJLyogT3ZlcmxheSBvZmYgKi8KKwkJ
enItPnY0bF9vdmVybGF5X2FjdGl2ZSA9IDA7CisJCXpyMzYwNTdfb3ZlcmxheSh6ciwgMCk7CisJ
CXpyLT5vdmVybGF5X21hc2sgPSBOVUxMOworCisJCS8qIGNhcHR1cmUgb2ZmICovCisJCXdha2Vf
dXBfaW50ZXJydXB0aWJsZSgmenItPnY0bF9jYXBxKTsKKwkJenIzNjA1N19zZXRfbWVtZ3JhYih6
ciwgMCk7CisJCXpyLT52NGxfYnVmZmVycy5hbGxvY2F0ZWQgPSAwOworCQl6ci0+djRsX2J1ZmZl
cnMuYWN0aXZlID0gWk9SQU5fRlJFRTsKKwkJem9yYW5fc2V0X3BjaV9tYXN0ZXIoenIsIDApOwor
CisJCWlmICghcGFzc190aHJvdWdoKSB7CS8qIFN3aXRjaCB0byBjb2xvciBiYXIgKi8KKwkJCWRl
Y29kZXJfY2FsbCh6ciwgdmlkZW8sIHNfc3RyZWFtLCAwKTsKKwkJCWVuY29kZXJfY2FsbCh6ciwg
dmlkZW8sIHNfcm91dGluZywgMiwgMCwgMCk7CisJCX0KKwl9CisJbXV0ZXhfdW5sb2NrKCZ6ci0+
bG9jayk7CisKKwl2NGwyX2ZoX2RlbCgmZmgtPmZoKTsKKwl2NGwyX2ZoX2V4aXQoJmZoLT5maCk7
CisJa2ZyZWUoZmgtPm92ZXJsYXlfbWFzayk7CisJa2ZyZWUoZmgpOworCisJZHByaW50ayg0LCBL
RVJOX0lORk8gIiVzOiAlcyBkb25lXG4iLCBaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCisJ
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgc2V0dXBfZmJ1ZmZlcihzdHJ1Y3Qgem9yYW5fZmgg
KmZoLAorCSAgICAgICB2b2lkICAgICAgICAgICAgICAgICAgICAgICpiYXNlLAorCSAgICAgICBj
b25zdCBzdHJ1Y3Qgem9yYW5fZm9ybWF0ICpmbXQsCisJICAgICAgIGludCAgICAgICAgICAgICAg
ICAgICAgICAgIHdpZHRoLAorCSAgICAgICBpbnQgICAgICAgICAgICAgICAgICAgICAgICBoZWln
aHQsCisJICAgICAgIGludCAgICAgICAgICAgICAgICAgICAgICAgIGJ5dGVzcGVybGluZSkKK3sK
KwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCisJLyogKFJvbmFsZCkgdjRsL3Y0bDIgZ3Vp
ZGVsaW5lcyAqLworCWlmICghY2FwYWJsZShDQVBfU1lTX0FETUlOKSAmJiAhY2FwYWJsZShDQVBf
U1lTX1JBV0lPKSkKKwkJcmV0dXJuIC1FUEVSTTsKKworCS8qIERvbid0IGFsbG93IGZyYW1lIGJ1
ZmZlciBvdmVybGF5IGlmIFBDSSBvciBBR1AgaXMgYnVnZ3ksIG9yIG9uCisJICAgQUxpIE1hZ2lr
ICh0aGF0IG5lZWRzIHZlcnkgbG93IGxhdGVuY3kgd2hpbGUgdGhlIGNhcmQgbmVlZHMgYQorCSAg
IGhpZ2hlciB2YWx1ZSBhbHdheXMpICovCisKKwlpZiAocGNpX3BjaV9wcm9ibGVtcyAmIChQQ0lQ
Q0lfRkFJTCB8IFBDSUFHUF9GQUlMIHwgUENJUENJX0FMSU1BR0lLKSkKKwkJcmV0dXJuIC1FTlhJ
TzsKKworCS8qIHdlIG5lZWQgYSBieXRlc3BlcmxpbmUgdmFsdWUsIGV2ZW4gaWYgbm90IGdpdmVu
ICovCisJaWYgKCFieXRlc3BlcmxpbmUpCisJCWJ5dGVzcGVybGluZSA9IHdpZHRoICogKChmbXQt
PmRlcHRoICsgNykgJiB+NykgLyA4OworCisjaWYgMAorCWlmICh6ci0+b3ZlcmxheV9hY3RpdmUp
IHsKKwkJLyogZHpqZWUuLi4gc3R1cGlkIHVzZXJzLi4uIGRvbid0IGV2ZW4gYm90aGVyIHRvIHR1
cm4gb2ZmCisJCSAqIG92ZXJsYXkgYmVmb3JlIGNoYW5naW5nIHRoZSBtZW1vcnkgbG9jYXRpb24u
Li4KKwkJICogbm9ybWFsbHksIHdlIHdvdWxkIHJldHVybiBlcnJvcnMgaGVyZS4gSG93ZXZlciwg
b25lIG9mCisJCSAqIHRoZSB0b29scyB0aGF0IGRvZXMgdGhpcyBpcy4uLiB4YXd0diEgYW5kIHNp
bmNlIHhhd3R2CisJCSAqIGlzIHVzZWQgYnkgKy8tIDk5JSBvZiB0aGUgdXNlcnMsIHdlJ2QgcmF0
aGVyIGJlIHVzZXItCisJCSAqIGZyaWVuZGx5IGFuZCBzaWxlbnRseSBkbyBhcyBpZiBub3RoaW5n
IHdlbnQgd3JvbmcgKi8KKwkJZHByaW50aygzLAorCQkJS0VSTl9FUlIKKwkJCSIlczogJXMgLSBm
b3JjZWQgb3ZlcmxheSB0dXJub2ZmIGJlY2F1c2UgZnJhbWVidWZmZXIgY2hhbmdlZFxuIiwKKwkJ
CVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXyk7CisJCXpyMzYwNTdfb3ZlcmxheSh6ciwgMCk7CisJ
fQorI2VuZGlmCisKKwlpZiAoIShmbXQtPmZsYWdzICYgWk9SQU5fRk9STUFUX09WRVJMQVkpKSB7
CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJSCisJCQkiJXM6ICVzIC0gbm8gdmFsaWQgb3Zlcmxh
eSBmb3JtYXQgZ2l2ZW5cbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQlyZXR1
cm4gLUVJTlZBTDsKKwl9CisJaWYgKGhlaWdodCA8PSAwIHx8IHdpZHRoIDw9IDAgfHwgYnl0ZXNw
ZXJsaW5lIDw9IDApIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczogJXMgLSBp
bnZhbGlkIGhlaWdodC93aWR0aC9icGwgdmFsdWUgKCVkfCVkfCVkKVxuIiwKKwkJCVpSX0RFVk5B
TUUoenIpLCBfX2Z1bmNfXywgd2lkdGgsIGhlaWdodCwgYnl0ZXNwZXJsaW5lKTsKKwkJcmV0dXJu
IC1FSU5WQUw7CisJfQorCWlmIChieXRlc3BlcmxpbmUgJiAzKSB7CisJCWRwcmludGsoMSwKKwkJ
CUtFUk5fRVJSCisJCQkiJXM6ICVzIC0gYnl0ZXNwZXJsaW5lICglZCkgbXVzdCBiZSA0LWJ5dGUg
YWxpZ25lZFxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXywgYnl0ZXNwZXJsaW5lKTsK
KwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJenItPnZidWZfYmFzZSA9ICh2b2lkICopICgodW5z
aWduZWQgbG9uZykgYmFzZSAmIH4zKTsKKwl6ci0+dmJ1Zl9oZWlnaHQgPSBoZWlnaHQ7CisJenIt
PnZidWZfd2lkdGggPSB3aWR0aDsKKwl6ci0+dmJ1Zl9kZXB0aCA9IGZtdC0+ZGVwdGg7CisJenIt
Pm92ZXJsYXlfc2V0dGluZ3MuZm9ybWF0ID0gZm10OworCXpyLT52YnVmX2J5dGVzcGVybGluZSA9
IGJ5dGVzcGVybGluZTsKKworCS8qIFRoZSB1c2VyIHNob3VsZCBzZXQgbmV3IHdpbmRvdyBwYXJh
bWV0ZXJzICovCisJenItPm92ZXJsYXlfc2V0dGluZ3MuaXNfc2V0ID0gMDsKKworCXJldHVybiAw
OworfQorCisKK3N0YXRpYyBpbnQgc2V0dXBfd2luZG93KHN0cnVjdCB6b3Jhbl9maCAqZmgsCisJ
CQlpbnQgeCwKKwkJCWludCB5LAorCQkJaW50IHdpZHRoLAorCQkJaW50IGhlaWdodCwKKwkJCXN0
cnVjdCB2NGwyX2NsaXAgX191c2VyICpjbGlwcywKKwkJCXVuc2lnbmVkIGludCBjbGlwY291bnQs
CisJCQl2b2lkIF9fdXNlciAqYml0bWFwKQoreworCXN0cnVjdCB6b3JhbiAqenIgPSBmaC0+enI7
CisJc3RydWN0IHY0bDJfY2xpcCAqdmNwID0gTlVMTDsKKwlpbnQgb24sIGVuZDsKKworCisJaWYg
KCF6ci0+dmJ1Zl9iYXNlKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJSCisJCQkiJXM6ICVz
IC0gZnJhbWUgYnVmZmVyIGhhcyB0byBiZSBzZXQgZmlyc3RcbiIsCisJCQlaUl9ERVZOQU1FKHpy
KSwgX19mdW5jX18pOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpZiAoIWZoLT5vdmVybGF5
X3NldHRpbmdzLmZvcm1hdCkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgorCQkJIiVzOiAl
cyAtIG5vIG92ZXJsYXkgZm9ybWF0IHNldFxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNf
Xyk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWlmIChjbGlwY291bnQgPiAyMDQ4KSB7CisJ
CWRwcmludGsoMSwKKwkJCUtFUk5fRVJSCisJCQkiJXM6ICVzIC0gaW52YWxpZCBjbGlwY291bnRc
biIsCisJCQkgWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJ
fQorCisJLyoKKwkgKiBUaGUgdmlkZW8gZnJvbnQgZW5kIG5lZWRzIDQtYnl0ZSBhbGluZ2VkIGxp
bmUgc2l6ZXMsIHdlIGNvcnJlY3QgdGhhdAorCSAqIHNpbGVudGx5IGhlcmUgaWYgbmVjZXNzYXJ5
CisJICovCisJaWYgKHpyLT52YnVmX2RlcHRoID09IDE1IHx8IHpyLT52YnVmX2RlcHRoID09IDE2
KSB7CisJCWVuZCA9ICh4ICsgd2lkdGgpICYgfjE7CS8qIHJvdW5kIGRvd24gKi8KKwkJeCA9ICh4
ICsgMSkgJiB+MTsJLyogcm91bmQgdXAgKi8KKwkJd2lkdGggPSBlbmQgLSB4OworCX0KKworCWlm
ICh6ci0+dmJ1Zl9kZXB0aCA9PSAyNCkgeworCQllbmQgPSAoeCArIHdpZHRoKSAmIH4zOwkvKiBy
b3VuZCBkb3duICovCisJCXggPSAoeCArIDMpICYgfjM7CS8qIHJvdW5kIHVwICovCisJCXdpZHRo
ID0gZW5kIC0geDsKKwl9CisKKwlpZiAod2lkdGggPiBCVVpfTUFYX1dJRFRIKQorCQl3aWR0aCA9
IEJVWl9NQVhfV0lEVEg7CisJaWYgKGhlaWdodCA+IEJVWl9NQVhfSEVJR0hUKQorCQloZWlnaHQg
PSBCVVpfTUFYX0hFSUdIVDsKKworCS8qIENoZWNrIGZvciBpbnZhbGlkIHBhcmFtZXRlcnMgKi8K
KwlpZiAod2lkdGggPCBCVVpfTUlOX1dJRFRIIHx8IGhlaWdodCA8IEJVWl9NSU5fSEVJR0hUIHx8
CisJICAgIHdpZHRoID4gQlVaX01BWF9XSURUSCB8fCBoZWlnaHQgPiBCVVpfTUFYX0hFSUdIVCkg
eworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgorCQkJIiVzOiAlcyAtIHdpZHRoID0gJWQgb3Ig
aGVpZ2h0ID0gJWQgaW52YWxpZFxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXywgd2lk
dGgsIGhlaWdodCk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWZoLT5vdmVybGF5X3NldHRp
bmdzLnggPSB4OworCWZoLT5vdmVybGF5X3NldHRpbmdzLnkgPSB5OworCWZoLT5vdmVybGF5X3Nl
dHRpbmdzLndpZHRoID0gd2lkdGg7CisJZmgtPm92ZXJsYXlfc2V0dGluZ3MuaGVpZ2h0ID0gaGVp
Z2h0OworCWZoLT5vdmVybGF5X3NldHRpbmdzLmNsaXBjb3VudCA9IGNsaXBjb3VudDsKKworCS8q
CisJICogSWYgYW4gb3ZlcmxheSBpcyBydW5uaW5nLCB3ZSBoYXZlIHRvIHN3aXRjaCBpdCBvZmYK
KwkgKiBhbmQgc3dpdGNoIGl0IG9uIGFnYWluIGluIG9yZGVyIHRvIGdldCB0aGUgbmV3IHNldHRp
bmdzIGluIGVmZmVjdC4KKwkgKgorCSAqIFdlIGFsc28gd2FudCB0byBhdm9pZCB0aGF0IHRoZSBv
dmVybGF5IG1hc2sgaXMgd3JpdHRlbgorCSAqIHdoZW4gYW4gb3ZlcmxheSBpcyBydW5uaW5nLgor
CSAqLworCisJb24gPSB6ci0+djRsX292ZXJsYXlfYWN0aXZlICYmICF6ci0+djRsX21lbWdyYWJf
YWN0aXZlICYmCisJICAgIHpyLT5vdmVybGF5X2FjdGl2ZSAhPSBaT1JBTl9GUkVFICYmCisJICAg
IGZoLT5vdmVybGF5X2FjdGl2ZSAhPSBaT1JBTl9GUkVFOworCWlmIChvbikKKwkJenIzNjA1N19v
dmVybGF5KHpyLCAwKTsKKworCS8qCisJICogICBXcml0ZSB0aGUgb3ZlcmxheSBtYXNrIGlmIGNs
aXBzIGFyZSB3YW50ZWQuCisJICogICBXZSBwcmVmZXIgYSBiaXRtYXAuCisJICovCisJaWYgKGJp
dG1hcCkgeworCQkvKiBmYWtlIHZhbHVlIC0gaXQganVzdCBtZWFucyB3ZSB3YW50IGNsaXBzICov
CisJCWZoLT5vdmVybGF5X3NldHRpbmdzLmNsaXBjb3VudCA9IDE7CisKKwkJaWYgKGNvcHlfZnJv
bV91c2VyKGZoLT5vdmVybGF5X21hc2ssIGJpdG1hcCwKKwkJCQkgICAod2lkdGggKiBoZWlnaHQg
KyA3KSAvIDgpKSB7CisJCQlyZXR1cm4gLUVGQVVMVDsKKwkJfQorCX0gZWxzZSBpZiAoY2xpcGNv
dW50KSB7CisJCS8qIHdyaXRlIG91ciBvd24gYml0bWFwIGZyb20gdGhlIGNsaXBzICovCisJCXZj
cCA9IHZtYWxsb2MoYXJyYXlfc2l6ZShzaXplb2Yoc3RydWN0IHY0bDJfY2xpcCksCisJCQkJCSBj
bGlwY291bnQgKyA0KSk7CisJCWlmICh2Y3AgPT0gTlVMTCkgeworCQkJZHByaW50aygxLAorCQkJ
CUtFUk5fRVJSCisJCQkJIiVzOiAlcyAtIEFsbG9jIG9mIGNsaXAgbWFzayBmYWlsZWRcbiIsCisJ
CQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJCXJldHVybiAtRU5PTUVNOworCQl9CisJ
CWlmIChjb3B5X2Zyb21fdXNlcgorCQkgICAgKHZjcCwgY2xpcHMsIHNpemVvZihzdHJ1Y3QgdjRs
Ml9jbGlwKSAqIGNsaXBjb3VudCkpIHsKKwkJCXZmcmVlKHZjcCk7CisJCQlyZXR1cm4gLUVGQVVM
VDsKKwkJfQorCQl3cml0ZV9vdmVybGF5X21hc2soZmgsIHZjcCwgY2xpcGNvdW50KTsKKwkJdmZy
ZWUodmNwKTsKKwl9CisKKwlmaC0+b3ZlcmxheV9zZXR0aW5ncy5pc19zZXQgPSAxOworCWlmIChm
aC0+b3ZlcmxheV9hY3RpdmUgIT0gWk9SQU5fRlJFRSAmJgorCSAgICB6ci0+b3ZlcmxheV9hY3Rp
dmUgIT0gWk9SQU5fRlJFRSkKKwkJenItPm92ZXJsYXlfc2V0dGluZ3MgPSBmaC0+b3ZlcmxheV9z
ZXR0aW5nczsKKworCWlmIChvbikKKwkJenIzNjA1N19vdmVybGF5KHpyLCAxKTsKKworCS8qIE1h
a2Ugc3VyZSB0aGUgY2hhbmdlcyBjb21lIGludG8gZWZmZWN0ICovCisJcmV0dXJuIHdhaXRfZ3Jh
Yl9wZW5kaW5nKHpyKTsKK30KKworc3RhdGljIGludCBzZXR1cF9vdmVybGF5KHN0cnVjdCB6b3Jh
bl9maCAqZmgsIGludCBvbikKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCisJLyog
SWYgdGhlcmUgaXMgbm90aGluZyB0byBkbywgcmV0dXJuIGltbWVkaWF0ZWx5ICovCisJaWYgKChv
biAmJiBmaC0+b3ZlcmxheV9hY3RpdmUgIT0gWk9SQU5fRlJFRSkgfHwKKwkgICAgKCFvbiAmJiBm
aC0+b3ZlcmxheV9hY3RpdmUgPT0gWk9SQU5fRlJFRSkpCisJCXJldHVybiAwOworCisJLyogY2hl
Y2sgd2hldGhlciB3ZSdyZSB0b3VjaGluZyBzb21lb25lIGVsc2UncyBvdmVybGF5ICovCisJaWYg
KG9uICYmIHpyLT5vdmVybGF5X2FjdGl2ZSAhPSBaT1JBTl9GUkVFICYmCisJICAgIGZoLT5vdmVy
bGF5X2FjdGl2ZSA9PSBaT1JBTl9GUkVFKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJSCisJ
CQkiJXM6ICVzIC0gb3ZlcmxheSBpcyBhbHJlYWR5IGFjdGl2ZSBmb3IgYW5vdGhlciBzZXNzaW9u
XG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fKTsKKwkJcmV0dXJuIC1FQlVTWTsKKwl9
CisJaWYgKCFvbiAmJiB6ci0+b3ZlcmxheV9hY3RpdmUgIT0gWk9SQU5fRlJFRSAmJgorCSAgICBm
aC0+b3ZlcmxheV9hY3RpdmUgPT0gWk9SQU5fRlJFRSkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJO
X0VSUgorCQkJIiVzOiAlcyAtIHlvdSBjYW5ub3QgY2FuY2VsIHNvbWVvbmUgZWxzZSdzIHNlc3Np
b25cbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQlyZXR1cm4gLUVQRVJNOwor
CX0KKworCWlmIChvbiA9PSAwKSB7CisJCXpyLT5vdmVybGF5X2FjdGl2ZSA9IGZoLT5vdmVybGF5
X2FjdGl2ZSA9IFpPUkFOX0ZSRUU7CisJCXpyLT52NGxfb3ZlcmxheV9hY3RpdmUgPSAwOworCQkv
KiBXaGVuIGEgZ3JhYiBpcyBydW5uaW5nLCB0aGUgdmlkZW8gc2ltcGx5CisJCSAqIHdvbid0IGJl
IHN3aXRjaGVkIG9uIGFueSBtb3JlICovCisJCWlmICghenItPnY0bF9tZW1ncmFiX2FjdGl2ZSkK
KwkJCXpyMzYwNTdfb3ZlcmxheSh6ciwgMCk7CisJCXpyLT5vdmVybGF5X21hc2sgPSBOVUxMOwor
CX0gZWxzZSB7CisJCWlmICghenItPnZidWZfYmFzZSB8fCAhZmgtPm92ZXJsYXlfc2V0dGluZ3Mu
aXNfc2V0KSB7CisJCQlkcHJpbnRrKDEsCisJCQkJS0VSTl9FUlIKKwkJCQkiJXM6ICVzIC0gYnVm
ZmVyIG9yIHdpbmRvdyBub3Qgc2V0XG4iLAorCQkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXyk7
CisJCQlyZXR1cm4gLUVJTlZBTDsKKwkJfQorCQlpZiAoIWZoLT5vdmVybGF5X3NldHRpbmdzLmZv
cm1hdCkgeworCQkJZHByaW50aygxLAorCQkJCUtFUk5fRVJSCisJCQkJIiVzOiAlcyAtIG5vIG92
ZXJsYXkgZm9ybWF0IHNldFxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQkJ
cmV0dXJuIC1FSU5WQUw7CisJCX0KKwkJenItPm92ZXJsYXlfYWN0aXZlID0gZmgtPm92ZXJsYXlf
YWN0aXZlID0gWk9SQU5fTE9DS0VEOworCQl6ci0+djRsX292ZXJsYXlfYWN0aXZlID0gMTsKKwkJ
enItPm92ZXJsYXlfbWFzayA9IGZoLT5vdmVybGF5X21hc2s7CisJCXpyLT5vdmVybGF5X3NldHRp
bmdzID0gZmgtPm92ZXJsYXlfc2V0dGluZ3M7CisJCWlmICghenItPnY0bF9tZW1ncmFiX2FjdGl2
ZSkKKwkJCXpyMzYwNTdfb3ZlcmxheSh6ciwgMSk7CisJCS8qIFdoZW4gYSBncmFiIGlzIHJ1bm5p
bmcsIHRoZSB2aWRlbyB3aWxsIGJlCisJCSAqIHN3aXRjaGVkIG9uIHdoZW4gZ3JhYiBpcyBmaW5p
c2hlZCAqLworCX0KKworCS8qIE1ha2Ugc3VyZSB0aGUgY2hhbmdlcyBjb21lIGludG8gZWZmZWN0
ICovCisJcmV0dXJuIHdhaXRfZ3JhYl9wZW5kaW5nKHpyKTsKK30KKworLyogZ2V0IHRoZSBzdGF0
dXMgb2YgYSBidWZmZXIgaW4gdGhlIGNsaWVudHMgYnVmZmVyIHF1ZXVlICovCitzdGF0aWMgaW50
IHpvcmFuX3Y0bDJfYnVmZmVyX3N0YXR1cyhzdHJ1Y3Qgem9yYW5fZmggKmZoLAorCQkJCSAgICBz
dHJ1Y3QgdjRsMl9idWZmZXIgKmJ1ZiwgaW50IG51bSkKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0g
ZmgtPnpyOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlidWYtPmZsYWdzID0gVjRMMl9CVUZf
RkxBR19NQVBQRUQgfCBWNEwyX0JVRl9GTEFHX1RJTUVTVEFNUF9NT05PVE9OSUM7CisKKwlzd2l0
Y2ggKGZoLT5tYXBfbW9kZSkgeworCWNhc2UgWk9SQU5fTUFQX01PREVfUkFXOgorCQkvKiBjaGVj
ayByYW5nZSAqLworCQlpZiAobnVtIDwgMCB8fCBudW0gPj0gZmgtPmJ1ZmZlcnMubnVtX2J1ZmZl
cnMgfHwKKwkJICAgICFmaC0+YnVmZmVycy5hbGxvY2F0ZWQpIHsKKwkJCWRwcmludGsoMSwKKwkJ
CQlLRVJOX0VSUgorCQkJCSIlczogJXMgLSB3cm9uZyBudW1iZXIgb3IgYnVmZmVycyBub3QgYWxs
b2NhdGVkXG4iLAorCQkJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXyk7CisJCQlyZXR1cm4gLUVJ
TlZBTDsKKwkJfQorCisJCXNwaW5fbG9ja19pcnFzYXZlKCZ6ci0+c3BpbmxvY2ssIGZsYWdzKTsK
KwkJZHByaW50aygzLAorCQkJS0VSTl9ERUJVRworCQkJIiVzOiAlcygpIC0gcmF3IGFjdGl2ZT0l
YywgYnVmZmVyICVkOiBzdGF0ZT0lYywgbWFwPSVjXG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9f
ZnVuY19fLAorCQkJIkZBTCJbZmgtPmJ1ZmZlcnMuYWN0aXZlXSwgbnVtLAorCQkJIlVQTUQiW3py
LT52NGxfYnVmZmVycy5idWZmZXJbbnVtXS5zdGF0ZV0sCisJCQlmaC0+YnVmZmVycy5idWZmZXJb
bnVtXS5tYXAgPyAnWScgOiAnTicpOworCQlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ6ci0+c3Bp
bmxvY2ssIGZsYWdzKTsKKworCQlidWYtPnR5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRV
UkU7CisJCWJ1Zi0+bGVuZ3RoID0gZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemU7CisKKwkJLyogZ2V0
IGJ1ZmZlciAqLworCQlidWYtPmJ5dGVzdXNlZCA9IGZoLT5idWZmZXJzLmJ1ZmZlcltudW1dLmJz
Lmxlbmd0aDsKKwkJaWYgKGZoLT5idWZmZXJzLmJ1ZmZlcltudW1dLnN0YXRlID09IEJVWl9TVEFU
RV9ET05FIHx8CisJCSAgICBmaC0+YnVmZmVycy5idWZmZXJbbnVtXS5zdGF0ZSA9PSBCVVpfU1RB
VEVfVVNFUikgeworCQkJYnVmLT5zZXF1ZW5jZSA9IGZoLT5idWZmZXJzLmJ1ZmZlcltudW1dLmJz
LnNlcTsKKwkJCWJ1Zi0+ZmxhZ3MgfD0gVjRMMl9CVUZfRkxBR19ET05FOworCQkJYnVmLT50aW1l
c3RhbXAgPSBuc190b190aW1ldmFsKGZoLT5idWZmZXJzLmJ1ZmZlcltudW1dLmJzLnRzKTsKKwkJ
fSBlbHNlIHsKKwkJCWJ1Zi0+ZmxhZ3MgfD0gVjRMMl9CVUZfRkxBR19RVUVVRUQ7CisJCX0KKwor
CQlpZiAoZmgtPnY0bF9zZXR0aW5ncy5oZWlnaHQgPD0gQlVaX01BWF9IRUlHSFQgLyAyKQorCQkJ
YnVmLT5maWVsZCA9IFY0TDJfRklFTERfVE9QOworCQllbHNlCisJCQlidWYtPmZpZWxkID0gVjRM
Ml9GSUVMRF9JTlRFUkxBQ0VEOworCisJCWJyZWFrOworCisJY2FzZSBaT1JBTl9NQVBfTU9ERV9K
UEdfUkVDOgorCWNhc2UgWk9SQU5fTUFQX01PREVfSlBHX1BMQVk6CisKKwkJLyogY2hlY2sgcmFu
Z2UgKi8KKwkJaWYgKG51bSA8IDAgfHwgbnVtID49IGZoLT5idWZmZXJzLm51bV9idWZmZXJzIHx8
CisJCSAgICAhZmgtPmJ1ZmZlcnMuYWxsb2NhdGVkKSB7CisJCQlkcHJpbnRrKDEsCisJCQkJS0VS
Tl9FUlIKKwkJCQkiJXM6ICVzIC0gd3JvbmcgbnVtYmVyIG9yIGJ1ZmZlcnMgbm90IGFsbG9jYXRl
ZFxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQkJcmV0dXJuIC1FSU5WQUw7
CisJCX0KKworCQlidWYtPnR5cGUgPSAoZmgtPm1hcF9tb2RlID09IFpPUkFOX01BUF9NT0RFX0pQ
R19SRUMpID8KKwkJCSAgICAgIFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRSA6CisJCQkgICAg
ICBWNEwyX0JVRl9UWVBFX1ZJREVPX09VVFBVVDsKKwkJYnVmLT5sZW5ndGggPSBmaC0+YnVmZmVy
cy5idWZmZXJfc2l6ZTsKKworCQkvKiB0aGVzZSB2YXJpYWJsZXMgYXJlIG9ubHkgd3JpdHRlbiBh
ZnRlciBmcmFtZSBoYXMgYmVlbiBjYXB0dXJlZCAqLworCQlpZiAoZmgtPmJ1ZmZlcnMuYnVmZmVy
W251bV0uc3RhdGUgPT0gQlVaX1NUQVRFX0RPTkUgfHwKKwkJICAgIGZoLT5idWZmZXJzLmJ1ZmZl
cltudW1dLnN0YXRlID09IEJVWl9TVEFURV9VU0VSKSB7CisJCQlidWYtPnNlcXVlbmNlID0gZmgt
PmJ1ZmZlcnMuYnVmZmVyW251bV0uYnMuc2VxOworCQkJYnVmLT50aW1lc3RhbXAgPSBuc190b190
aW1ldmFsKGZoLT5idWZmZXJzLmJ1ZmZlcltudW1dLmJzLnRzKTsKKwkJCWJ1Zi0+Ynl0ZXN1c2Vk
ID0gZmgtPmJ1ZmZlcnMuYnVmZmVyW251bV0uYnMubGVuZ3RoOworCQkJYnVmLT5mbGFncyB8PSBW
NEwyX0JVRl9GTEFHX0RPTkU7CisJCX0gZWxzZSB7CisJCQlidWYtPmZsYWdzIHw9IFY0TDJfQlVG
X0ZMQUdfUVVFVUVEOworCQl9CisKKwkJLyogd2hpY2ggZmllbGRzIGFyZSB0aGVzZT8gKi8KKwkJ
aWYgKGZoLT5qcGdfc2V0dGluZ3MuVG1wRGNtICE9IDEpCisJCQlidWYtPmZpZWxkID0gZmgtPmpw
Z19zZXR0aW5ncy5vZGRfZXZlbiA/CisJCQkJVjRMMl9GSUVMRF9UT1AgOiBWNEwyX0ZJRUxEX0JP
VFRPTTsKKwkJZWxzZQorCQkJYnVmLT5maWVsZCA9IGZoLT5qcGdfc2V0dGluZ3Mub2RkX2V2ZW4g
PworCQkJCVY0TDJfRklFTERfU0VRX1RCIDogVjRMMl9GSUVMRF9TRVFfQlQ7CisKKwkJYnJlYWs7
CisKKwlkZWZhdWx0OgorCisJCWRwcmludGsoNSwKKwkJCUtFUk5fRVJSCisJCQkiJXM6ICVzIC0g
aW52YWxpZCBidWZmZXIgdHlwZXxtYXBfbW9kZSAoJWR8JWQpXG4iLAorCQkJWlJfREVWTkFNRSh6
ciksIF9fZnVuY19fLCBidWYtPnR5cGUsIGZoLT5tYXBfbW9kZSk7CisJCXJldHVybiAtRUlOVkFM
OworCX0KKworCWJ1Zi0+bWVtb3J5ID0gVjRMMl9NRU1PUllfTU1BUDsKKwlidWYtPmluZGV4ID0g
bnVtOworCWJ1Zi0+bS5vZmZzZXQgPSBidWYtPmxlbmd0aCAqIG51bTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50Cit6b3Jhbl9zZXRfbm9ybSAoc3RydWN0IHpvcmFuICp6ciwKKwkJdjRs
Ml9zdGRfaWQgbm9ybSkKK3sKKwlpbnQgb247CisKKwlpZiAoenItPnY0bF9idWZmZXJzLmFjdGl2
ZSAhPSBaT1JBTl9GUkVFIHx8CisJICAgIHpyLT5qcGdfYnVmZmVycy5hY3RpdmUgIT0gWk9SQU5f
RlJFRSkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX1dBUk5JTkcKKwkJCSIlczogJXMgY2FsbGVk
IHdoaWxlIGluIHBsYXliYWNrL2NhcHR1cmUgbW9kZVxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBf
X2Z1bmNfXyk7CisJCXJldHVybiAtRUJVU1k7CisJfQorCisJaWYgKCEobm9ybSAmIHpyLT5jYXJk
Lm5vcm1zKSkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUiAiJXM6ICVzIC0gdW5zdXBwb3J0
ZWQgbm9ybSAlbGx4XG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBub3JtKTsKKwkJ
cmV0dXJuIC1FSU5WQUw7CisJfQorCisJaWYgKG5vcm0gJiBWNEwyX1NURF9TRUNBTSkKKwkJenIt
PnRpbWluZyA9IHpyLT5jYXJkLnR2blsyXTsKKwllbHNlIGlmIChub3JtICYgVjRMMl9TVERfTlRT
QykKKwkJenItPnRpbWluZyA9IHpyLT5jYXJkLnR2blsxXTsKKwllbHNlCisJCXpyLT50aW1pbmcg
PSB6ci0+Y2FyZC50dm5bMF07CisKKwkvKiBXZSBzd2l0Y2ggb3ZlcmxheSBvZmYgYW5kIG9uIHNp
bmNlIGEgY2hhbmdlIGluIHRoZQorCSAqIG5vcm0gbmVlZHMgZGlmZmVyZW50IFZGRSBzZXR0aW5n
cyAqLworCW9uID0genItPm92ZXJsYXlfYWN0aXZlICYmICF6ci0+djRsX21lbWdyYWJfYWN0aXZl
OworCWlmIChvbikKKwkJenIzNjA1N19vdmVybGF5KHpyLCAwKTsKKworCWRlY29kZXJfY2FsbCh6
ciwgdmlkZW8sIHNfc3RkLCBub3JtKTsKKwllbmNvZGVyX2NhbGwoenIsIHZpZGVvLCBzX3N0ZF9v
dXRwdXQsIG5vcm0pOworCisJaWYgKG9uKQorCQl6cjM2MDU3X292ZXJsYXkoenIsIDEpOworCisJ
LyogTWFrZSBzdXJlIHRoZSBjaGFuZ2VzIGNvbWUgaW50byBlZmZlY3QgKi8KKwl6ci0+bm9ybSA9
IG5vcm07CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludAorem9yYW5fc2V0X2lucHV0IChz
dHJ1Y3Qgem9yYW4gKnpyLAorCQkgaW50ICAgICAgICAgICBpbnB1dCkKK3sKKwlpZiAoaW5wdXQg
PT0genItPmlucHV0KSB7CisJCXJldHVybiAwOworCX0KKworCWlmICh6ci0+djRsX2J1ZmZlcnMu
YWN0aXZlICE9IFpPUkFOX0ZSRUUgfHwKKwkgICAgenItPmpwZ19idWZmZXJzLmFjdGl2ZSAhPSBa
T1JBTl9GUkVFKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fV0FSTklORworCQkJIiVzOiAlcyBj
YWxsZWQgd2hpbGUgaW4gcGxheWJhY2svY2FwdHVyZSBtb2RlXG4iLAorCQkJWlJfREVWTkFNRSh6
ciksIF9fZnVuY19fKTsKKwkJcmV0dXJuIC1FQlVTWTsKKwl9CisKKwlpZiAoaW5wdXQgPCAwIHx8
IGlucHV0ID49IHpyLT5jYXJkLmlucHV0cykgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgor
CQkJIiVzOiAlcyAtIHVuc3VwcG9ydGVkIGlucHV0ICVkXG4iLAorCQkJWlJfREVWTkFNRSh6ciks
IF9fZnVuY19fLCBpbnB1dCk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXpyLT5pbnB1dCA9
IGlucHV0OworCisJZGVjb2Rlcl9jYWxsKHpyLCB2aWRlbywgc19yb3V0aW5nLAorCQkJenItPmNh
cmQuaW5wdXRbaW5wdXRdLm11eHNlbCwgMCwgMCk7CisKKwlyZXR1cm4gMDsKK30KKworLyoKKyAq
ICAgaW9jdGwgcm91dGluZQorICovCisKK3N0YXRpYyBpbnQgem9yYW5fcXVlcnljYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKl9fZmgsIHN0cnVjdCB2NGwyX2NhcGFiaWxpdHkgKmNhcCkKK3sK
KwlzdHJ1Y3Qgem9yYW5fZmggKmZoID0gX19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpy
OworCisJc3Ryc2NweShjYXAtPmNhcmQsIFpSX0RFVk5BTUUoenIpLCBzaXplb2YoY2FwLT5jYXJk
KSk7CisJc3Ryc2NweShjYXAtPmRyaXZlciwgInpvcmFuIiwgc2l6ZW9mKGNhcC0+ZHJpdmVyKSk7
CisJc25wcmludGYoY2FwLT5idXNfaW5mbywgc2l6ZW9mKGNhcC0+YnVzX2luZm8pLCAiUENJOiVz
IiwKKwkJIHBjaV9uYW1lKHpyLT5wY2lfZGV2KSk7CisJY2FwLT5kZXZpY2VfY2FwcyA9IFY0TDJf
Q0FQX1NUUkVBTUlORyB8IFY0TDJfQ0FQX1ZJREVPX0NBUFRVUkUgfAorCQkJICAgVjRMMl9DQVBf
VklERU9fT1VUUFVUIHwgVjRMMl9DQVBfVklERU9fT1ZFUkxBWTsKKwljYXAtPmNhcGFiaWxpdGll
cyA9IGNhcC0+ZGV2aWNlX2NhcHMgfCBWNEwyX0NBUF9ERVZJQ0VfQ0FQUzsKKwlyZXR1cm4gMDsK
K30KKworc3RhdGljIGludCB6b3Jhbl9lbnVtX2ZtdChzdHJ1Y3Qgem9yYW4gKnpyLCBzdHJ1Y3Qg
djRsMl9mbXRkZXNjICpmbXQsIGludCBmbGFnKQoreworCXVuc2lnbmVkIGludCBudW0sIGk7CisK
Kwlmb3IgKG51bSA9IGkgPSAwOyBpIDwgTlVNX0ZPUk1BVFM7IGkrKykgeworCQlpZiAoem9yYW5f
Zm9ybWF0c1tpXS5mbGFncyAmIGZsYWcgJiYgbnVtKysgPT0gZm10LT5pbmRleCkgeworCQkJc3Ry
c2NweShmbXQtPmRlc2NyaXB0aW9uLCB6b3Jhbl9mb3JtYXRzW2ldLm5hbWUsCisJCQkJc2l6ZW9m
KGZtdC0+ZGVzY3JpcHRpb24pKTsKKwkJCS8qIGZtdCBzdHJ1Y3QgcHJlLXplcm9lZCwgc28gYWRk
aW5nICdcMCcgbm90IG5lZWRlZCAqLworCQkJZm10LT5waXhlbGZvcm1hdCA9IHpvcmFuX2Zvcm1h
dHNbaV0uZm91cmNjOworCQkJaWYgKHpvcmFuX2Zvcm1hdHNbaV0uZmxhZ3MgJiBaT1JBTl9GT1JN
QVRfQ09NUFJFU1NFRCkKKwkJCQlmbXQtPmZsYWdzIHw9IFY0TDJfRk1UX0ZMQUdfQ09NUFJFU1NF
RDsKKwkJCXJldHVybiAwOworCQl9CisJfQorCXJldHVybiAtRUlOVkFMOworfQorCitzdGF0aWMg
aW50IHpvcmFuX2VudW1fZm10X3ZpZF9jYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKl9fZmgs
CisJCQkJCSAgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQoreworCXN0cnVjdCB6b3Jhbl9maCAq
ZmggPSBfX2ZoOworCXN0cnVjdCB6b3JhbiAqenIgPSBmaC0+enI7CisKKwlyZXR1cm4gem9yYW5f
ZW51bV9mbXQoenIsIGYsIFpPUkFOX0ZPUk1BVF9DQVBUVVJFKTsKK30KKworc3RhdGljIGludCB6
b3Jhbl9lbnVtX2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2ZoLAorCQkJ
CQkgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3sKKwlzdHJ1Y3Qgem9yYW5fZmggKmZoID0g
X19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCisJcmV0dXJuIHpvcmFuX2VudW1f
Zm10KHpyLCBmLCBaT1JBTl9GT1JNQVRfUExBWUJBQ0spOworfQorCitzdGF0aWMgaW50IHpvcmFu
X2VudW1fZm10X3ZpZF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2ZoLAorCQkJ
CQkgICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3sKKwlzdHJ1Y3Qgem9yYW5fZmggKmZoID0g
X19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCisJcmV0dXJuIHpvcmFuX2VudW1f
Zm10KHpyLCBmLCBaT1JBTl9GT1JNQVRfT1ZFUkxBWSk7Cit9CisKK3N0YXRpYyBpbnQgem9yYW5f
Z19mbXRfdmlkX291dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqX19maCwKKwkJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmbXQpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9IF9fZmg7CisKKwlm
bXQtPmZtdC5waXgud2lkdGggPSBmaC0+anBnX3NldHRpbmdzLmltZ193aWR0aCAvIGZoLT5qcGdf
c2V0dGluZ3MuSG9yRGNtOworCWZtdC0+Zm10LnBpeC5oZWlnaHQgPSBmaC0+anBnX3NldHRpbmdz
LmltZ19oZWlnaHQgKiAyIC8KKwkJKGZoLT5qcGdfc2V0dGluZ3MuVmVyRGNtICogZmgtPmpwZ19z
ZXR0aW5ncy5UbXBEY20pOworCWZtdC0+Zm10LnBpeC5zaXplaW1hZ2UgPSB6b3Jhbl92NGwyX2Nh
bGNfYnVmc2l6ZSgmZmgtPmpwZ19zZXR0aW5ncyk7CisJZm10LT5mbXQucGl4LnBpeGVsZm9ybWF0
ID0gVjRMMl9QSVhfRk1UX01KUEVHOworCWlmIChmaC0+anBnX3NldHRpbmdzLlRtcERjbSA9PSAx
KQorCQlmbXQtPmZtdC5waXguZmllbGQgPSAoZmgtPmpwZ19zZXR0aW5ncy5vZGRfZXZlbiA/CisJ
CQkJVjRMMl9GSUVMRF9TRVFfVEIgOiBWNEwyX0ZJRUxEX1NFUV9CVCk7CisJZWxzZQorCQlmbXQt
PmZtdC5waXguZmllbGQgPSAoZmgtPmpwZ19zZXR0aW5ncy5vZGRfZXZlbiA/CisJCQkJVjRMMl9G
SUVMRF9UT1AgOiBWNEwyX0ZJRUxEX0JPVFRPTSk7CisJZm10LT5mbXQucGl4LmJ5dGVzcGVybGlu
ZSA9IDA7CisJZm10LT5mbXQucGl4LmNvbG9yc3BhY2UgPSBWNEwyX0NPTE9SU1BBQ0VfU01QVEUx
NzBNOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgem9yYW5fZ19mbXRfdmlkX2NhcChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqX19maCwKKwkJCQkJc3RydWN0IHY0bDJfZm9ybWF0ICpm
bXQpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9IF9fZmg7CisJc3RydWN0IHpvcmFuICp6ciA9
IGZoLT56cjsKKworCWlmIChmaC0+bWFwX21vZGUgIT0gWk9SQU5fTUFQX01PREVfUkFXKQorCQly
ZXR1cm4gem9yYW5fZ19mbXRfdmlkX291dChmaWxlLCBmaCwgZm10KTsKKworCWZtdC0+Zm10LnBp
eC53aWR0aCA9IGZoLT52NGxfc2V0dGluZ3Mud2lkdGg7CisJZm10LT5mbXQucGl4LmhlaWdodCA9
IGZoLT52NGxfc2V0dGluZ3MuaGVpZ2h0OworCWZtdC0+Zm10LnBpeC5zaXplaW1hZ2UgPSBmaC0+
djRsX3NldHRpbmdzLmJ5dGVzcGVybGluZSAqCisJCQkJCWZoLT52NGxfc2V0dGluZ3MuaGVpZ2h0
OworCWZtdC0+Zm10LnBpeC5waXhlbGZvcm1hdCA9IGZoLT52NGxfc2V0dGluZ3MuZm9ybWF0LT5m
b3VyY2M7CisJZm10LT5mbXQucGl4LmNvbG9yc3BhY2UgPSBmaC0+djRsX3NldHRpbmdzLmZvcm1h
dC0+Y29sb3JzcGFjZTsKKwlmbXQtPmZtdC5waXguYnl0ZXNwZXJsaW5lID0gZmgtPnY0bF9zZXR0
aW5ncy5ieXRlc3BlcmxpbmU7CisJaWYgKEJVWl9NQVhfSEVJR0hUIDwgKGZoLT52NGxfc2V0dGlu
Z3MuaGVpZ2h0ICogMikpCisJCWZtdC0+Zm10LnBpeC5maWVsZCA9IFY0TDJfRklFTERfSU5URVJM
QUNFRDsKKwllbHNlCisJCWZtdC0+Zm10LnBpeC5maWVsZCA9IFY0TDJfRklFTERfVE9QOworCXJl
dHVybiAwOworfQorCitzdGF0aWMgaW50IHpvcmFuX2dfZm10X3ZpZF9vdmVybGF5KHN0cnVjdCBm
aWxlICpmaWxlLCB2b2lkICpfX2ZoLAorCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3sK
KwlzdHJ1Y3Qgem9yYW5fZmggKmZoID0gX19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpy
OworCisJZm10LT5mbXQud2luLncubGVmdCA9IGZoLT5vdmVybGF5X3NldHRpbmdzLng7CisJZm10
LT5mbXQud2luLncudG9wID0gZmgtPm92ZXJsYXlfc2V0dGluZ3MueTsKKwlmbXQtPmZtdC53aW4u
dy53aWR0aCA9IGZoLT5vdmVybGF5X3NldHRpbmdzLndpZHRoOworCWZtdC0+Zm10Lndpbi53Lmhl
aWdodCA9IGZoLT5vdmVybGF5X3NldHRpbmdzLmhlaWdodDsKKwlpZiAoZmgtPm92ZXJsYXlfc2V0
dGluZ3Mud2lkdGggKiAyID4gQlVaX01BWF9IRUlHSFQpCisJCWZtdC0+Zm10Lndpbi5maWVsZCA9
IFY0TDJfRklFTERfSU5URVJMQUNFRDsKKwllbHNlCisJCWZtdC0+Zm10Lndpbi5maWVsZCA9IFY0
TDJfRklFTERfVE9QOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgem9yYW5fdHJ5X2Zt
dF92aWRfb3ZlcmxheShzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqX19maCwKKwkJCQkJc3RydWN0
IHY0bDJfZm9ybWF0ICpmbXQpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9IF9fZmg7CisJc3Ry
dWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKworCWlmIChmbXQtPmZtdC53aW4udy53aWR0aCA+IEJV
Wl9NQVhfV0lEVEgpCisJCWZtdC0+Zm10Lndpbi53LndpZHRoID0gQlVaX01BWF9XSURUSDsKKwlp
ZiAoZm10LT5mbXQud2luLncud2lkdGggPCBCVVpfTUlOX1dJRFRIKQorCQlmbXQtPmZtdC53aW4u
dy53aWR0aCA9IEJVWl9NSU5fV0lEVEg7CisJaWYgKGZtdC0+Zm10Lndpbi53LmhlaWdodCA+IEJV
Wl9NQVhfSEVJR0hUKQorCQlmbXQtPmZtdC53aW4udy5oZWlnaHQgPSBCVVpfTUFYX0hFSUdIVDsK
KwlpZiAoZm10LT5mbXQud2luLncuaGVpZ2h0IDwgQlVaX01JTl9IRUlHSFQpCisJCWZtdC0+Zm10
Lndpbi53LmhlaWdodCA9IEJVWl9NSU5fSEVJR0hUOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgem9yYW5fdHJ5X2ZtdF92aWRfb3V0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2Zo
LAorCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3sKKwlzdHJ1Y3Qgem9yYW5fZmggKmZo
ID0gX19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCXN0cnVjdCB6b3Jhbl9qcGdf
c2V0dGluZ3Mgc2V0dGluZ3M7CisJaW50IHJlcyA9IDA7CisKKwlpZiAoZm10LT5mbXQucGl4LnBp
eGVsZm9ybWF0ICE9IFY0TDJfUElYX0ZNVF9NSlBFRykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlz
ZXR0aW5ncyA9IGZoLT5qcGdfc2V0dGluZ3M7CisKKwkvKiB3ZSBhY3R1YWxseSBuZWVkIHRvIHNl
dCAncmVhbCcgcGFyYW1ldGVycyBub3cgKi8KKwlpZiAoKGZtdC0+Zm10LnBpeC5oZWlnaHQgKiAy
KSA+IEJVWl9NQVhfSEVJR0hUKQorCQlzZXR0aW5ncy5UbXBEY20gPSAxOworCWVsc2UKKwkJc2V0
dGluZ3MuVG1wRGNtID0gMjsKKwlzZXR0aW5ncy5kZWNpbWF0aW9uID0gMDsKKwlpZiAoZm10LT5m
bXQucGl4LmhlaWdodCA8PSBmaC0+anBnX3NldHRpbmdzLmltZ19oZWlnaHQgLyAyKQorCQlzZXR0
aW5ncy5WZXJEY20gPSAyOworCWVsc2UKKwkJc2V0dGluZ3MuVmVyRGNtID0gMTsKKwlpZiAoZm10
LT5mbXQucGl4LndpZHRoIDw9IGZoLT5qcGdfc2V0dGluZ3MuaW1nX3dpZHRoIC8gNCkKKwkJc2V0
dGluZ3MuSG9yRGNtID0gNDsKKwllbHNlIGlmIChmbXQtPmZtdC5waXgud2lkdGggPD0gZmgtPmpw
Z19zZXR0aW5ncy5pbWdfd2lkdGggLyAyKQorCQlzZXR0aW5ncy5Ib3JEY20gPSAyOworCWVsc2UK
KwkJc2V0dGluZ3MuSG9yRGNtID0gMTsKKwlpZiAoc2V0dGluZ3MuVG1wRGNtID09IDEpCisJCXNl
dHRpbmdzLmZpZWxkX3Blcl9idWZmID0gMjsKKwllbHNlCisJCXNldHRpbmdzLmZpZWxkX3Blcl9i
dWZmID0gMTsKKworCWlmIChzZXR0aW5ncy5Ib3JEY20gPiAxKSB7CisJCXNldHRpbmdzLmltZ194
ID0gKEJVWl9NQVhfV0lEVEggPT0gNzIwKSA/IDggOiAwOworCQlzZXR0aW5ncy5pbWdfd2lkdGgg
PSAoQlVaX01BWF9XSURUSCA9PSA3MjApID8gNzA0IDogQlVaX01BWF9XSURUSDsKKwl9IGVsc2Ug
eworCQlzZXR0aW5ncy5pbWdfeCA9IDA7CisJCXNldHRpbmdzLmltZ193aWR0aCA9IEJVWl9NQVhf
V0lEVEg7CisJfQorCisJLyogY2hlY2sgKi8KKwlyZXMgPSB6b3Jhbl9jaGVja19qcGdfc2V0dGlu
Z3MoenIsICZzZXR0aW5ncywgMSk7CisJaWYgKHJlcykKKwkJcmV0dXJuIHJlczsKKworCS8qIHRl
bGwgdGhlIHVzZXIgd2hhdCB3ZSBhY3R1YWxseSBkaWQgKi8KKwlmbXQtPmZtdC5waXgud2lkdGgg
PSBzZXR0aW5ncy5pbWdfd2lkdGggLyBzZXR0aW5ncy5Ib3JEY207CisJZm10LT5mbXQucGl4Lmhl
aWdodCA9IHNldHRpbmdzLmltZ19oZWlnaHQgKiAyIC8KKwkJKHNldHRpbmdzLlRtcERjbSAqIHNl
dHRpbmdzLlZlckRjbSk7CisJaWYgKHNldHRpbmdzLlRtcERjbSA9PSAxKQorCQlmbXQtPmZtdC5w
aXguZmllbGQgPSAoZmgtPmpwZ19zZXR0aW5ncy5vZGRfZXZlbiA/CisJCQkJVjRMMl9GSUVMRF9T
RVFfVEIgOiBWNEwyX0ZJRUxEX1NFUV9CVCk7CisJZWxzZQorCQlmbXQtPmZtdC5waXguZmllbGQg
PSAoZmgtPmpwZ19zZXR0aW5ncy5vZGRfZXZlbiA/CisJCQkJVjRMMl9GSUVMRF9UT1AgOiBWNEwy
X0ZJRUxEX0JPVFRPTSk7CisKKwlmbXQtPmZtdC5waXguc2l6ZWltYWdlID0gem9yYW5fdjRsMl9j
YWxjX2J1ZnNpemUoJnNldHRpbmdzKTsKKwlmbXQtPmZtdC5waXguYnl0ZXNwZXJsaW5lID0gMDsK
KwlmbXQtPmZtdC5waXguY29sb3JzcGFjZSA9IFY0TDJfQ09MT1JTUEFDRV9TTVBURTE3ME07CisJ
cmV0dXJuIHJlczsKK30KKworc3RhdGljIGludCB6b3Jhbl90cnlfZm10X3ZpZF9jYXAoc3RydWN0
IGZpbGUgKmZpbGUsIHZvaWQgKl9fZmgsCisJCQkJCXN0cnVjdCB2NGwyX2Zvcm1hdCAqZm10KQor
eworCXN0cnVjdCB6b3Jhbl9maCAqZmggPSBfX2ZoOworCXN0cnVjdCB6b3JhbiAqenIgPSBmaC0+
enI7CisJaW50IGJwcDsKKwlpbnQgaTsKKworCWlmIChmbXQtPmZtdC5waXgucGl4ZWxmb3JtYXQg
PT0gVjRMMl9QSVhfRk1UX01KUEVHKQorCQlyZXR1cm4gem9yYW5fdHJ5X2ZtdF92aWRfb3V0KGZp
bGUsIGZoLCBmbXQpOworCisJZm9yIChpID0gMDsgaSA8IE5VTV9GT1JNQVRTOyBpKyspCisJCWlm
ICh6b3Jhbl9mb3JtYXRzW2ldLmZvdXJjYyA9PSBmbXQtPmZtdC5waXgucGl4ZWxmb3JtYXQpCisJ
CQlicmVhazsKKworCWlmIChpID09IE5VTV9GT1JNQVRTKQorCQlyZXR1cm4gLUVJTlZBTDsKKwor
CWJwcCA9IERJVl9ST1VORF9VUCh6b3Jhbl9mb3JtYXRzW2ldLmRlcHRoLCA4KTsKKwl2NGxfYm91
bmRfYWxpZ25faW1hZ2UoCisJCSZmbXQtPmZtdC5waXgud2lkdGgsIEJVWl9NSU5fV0lEVEgsIEJV
Wl9NQVhfV0lEVEgsIGJwcCA9PSAyID8gMSA6IDIsCisJCSZmbXQtPmZtdC5waXguaGVpZ2h0LCBC
VVpfTUlOX0hFSUdIVCwgQlVaX01BWF9IRUlHSFQsIDAsIDApOworCXJldHVybiAwOworfQorCitz
dGF0aWMgaW50IHpvcmFuX3NfZm10X3ZpZF9vdmVybGF5KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpfX2ZoLAorCQkJCQlzdHJ1Y3QgdjRsMl9mb3JtYXQgKmZtdCkKK3sKKwlzdHJ1Y3Qgem9yYW5f
ZmggKmZoID0gX19maDsKKwlpbnQgcmVzOworCisJZHByaW50aygzLCAieD0lZCwgeT0lZCwgdz0l
ZCwgaD0lZCwgY250PSVkLCBtYXA9MHglcFxuIiwKKwkJCWZtdC0+Zm10Lndpbi53LmxlZnQsIGZt
dC0+Zm10Lndpbi53LnRvcCwKKwkJCWZtdC0+Zm10Lndpbi53LndpZHRoLAorCQkJZm10LT5mbXQu
d2luLncuaGVpZ2h0LAorCQkJZm10LT5mbXQud2luLmNsaXBjb3VudCwKKwkJCWZtdC0+Zm10Lndp
bi5iaXRtYXApOworCXJlcyA9IHNldHVwX3dpbmRvdyhmaCwgZm10LT5mbXQud2luLncubGVmdCwg
Zm10LT5mbXQud2luLncudG9wLAorCQkJICAgZm10LT5mbXQud2luLncud2lkdGgsIGZtdC0+Zm10
Lndpbi53LmhlaWdodCwKKwkJCSAgIChzdHJ1Y3QgdjRsMl9jbGlwIF9fdXNlciAqKWZtdC0+Zm10
Lndpbi5jbGlwcywKKwkJCSAgIGZtdC0+Zm10Lndpbi5jbGlwY291bnQsIGZtdC0+Zm10Lndpbi5i
aXRtYXApOworCXJldHVybiByZXM7Cit9CisKK3N0YXRpYyBpbnQgem9yYW5fc19mbXRfdmlkX291
dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqX19maCwKKwkJCQkJc3RydWN0IHY0bDJfZm9ybWF0
ICpmbXQpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9IF9fZmg7CisJc3RydWN0IHpvcmFuICp6
ciA9IGZoLT56cjsKKwlfX2xlMzIgcHJpbnRmb3JtYXQgPSBfX2NwdV90b19sZTMyKGZtdC0+Zm10
LnBpeC5waXhlbGZvcm1hdCk7CisJc3RydWN0IHpvcmFuX2pwZ19zZXR0aW5ncyBzZXR0aW5nczsK
KwlpbnQgcmVzID0gMDsKKworCWRwcmludGsoMywgInNpemU9JWR4JWQsIGZtdD0weCV4ICglNC40
cylcbiIsCisJCQlmbXQtPmZtdC5waXgud2lkdGgsIGZtdC0+Zm10LnBpeC5oZWlnaHQsCisJCQlm
bXQtPmZtdC5waXgucGl4ZWxmb3JtYXQsCisJCQkoY2hhciAqKSAmcHJpbnRmb3JtYXQpOworCWlm
IChmbXQtPmZtdC5waXgucGl4ZWxmb3JtYXQgIT0gVjRMMl9QSVhfRk1UX01KUEVHKQorCQlyZXR1
cm4gLUVJTlZBTDsKKworCWlmIChmaC0+YnVmZmVycy5hbGxvY2F0ZWQpIHsKKwkJZHByaW50aygx
LCBLRVJOX0VSUiAiJXM6IFZJRElPQ19TX0ZNVCAtIGNhbm5vdCBjaGFuZ2UgY2FwdHVyZSBtb2Rl
XG4iLAorCQkJWlJfREVWTkFNRSh6cikpOworCQlyZXMgPSAtRUJVU1k7CisJCXJldHVybiByZXM7
CisJfQorCisJc2V0dGluZ3MgPSBmaC0+anBnX3NldHRpbmdzOworCisJLyogd2UgYWN0dWFsbHkg
bmVlZCB0byBzZXQgJ3JlYWwnIHBhcmFtZXRlcnMgbm93ICovCisJaWYgKGZtdC0+Zm10LnBpeC5o
ZWlnaHQgKiAyID4gQlVaX01BWF9IRUlHSFQpCisJCXNldHRpbmdzLlRtcERjbSA9IDE7CisJZWxz
ZQorCQlzZXR0aW5ncy5UbXBEY20gPSAyOworCXNldHRpbmdzLmRlY2ltYXRpb24gPSAwOworCWlm
IChmbXQtPmZtdC5waXguaGVpZ2h0IDw9IGZoLT5qcGdfc2V0dGluZ3MuaW1nX2hlaWdodCAvIDIp
CisJCXNldHRpbmdzLlZlckRjbSA9IDI7CisJZWxzZQorCQlzZXR0aW5ncy5WZXJEY20gPSAxOwor
CWlmIChmbXQtPmZtdC5waXgud2lkdGggPD0gZmgtPmpwZ19zZXR0aW5ncy5pbWdfd2lkdGggLyA0
KQorCQlzZXR0aW5ncy5Ib3JEY20gPSA0OworCWVsc2UgaWYgKGZtdC0+Zm10LnBpeC53aWR0aCA8
PSBmaC0+anBnX3NldHRpbmdzLmltZ193aWR0aCAvIDIpCisJCXNldHRpbmdzLkhvckRjbSA9IDI7
CisJZWxzZQorCQlzZXR0aW5ncy5Ib3JEY20gPSAxOworCWlmIChzZXR0aW5ncy5UbXBEY20gPT0g
MSkKKwkJc2V0dGluZ3MuZmllbGRfcGVyX2J1ZmYgPSAyOworCWVsc2UKKwkJc2V0dGluZ3MuZmll
bGRfcGVyX2J1ZmYgPSAxOworCisJaWYgKHNldHRpbmdzLkhvckRjbSA+IDEpIHsKKwkJc2V0dGlu
Z3MuaW1nX3ggPSAoQlVaX01BWF9XSURUSCA9PSA3MjApID8gOCA6IDA7CisJCXNldHRpbmdzLmlt
Z193aWR0aCA9IChCVVpfTUFYX1dJRFRIID09IDcyMCkgPyA3MDQgOiBCVVpfTUFYX1dJRFRIOwor
CX0gZWxzZSB7CisJCXNldHRpbmdzLmltZ194ID0gMDsKKwkJc2V0dGluZ3MuaW1nX3dpZHRoID0g
QlVaX01BWF9XSURUSDsKKwl9CisKKwkvKiBjaGVjayAqLworCXJlcyA9IHpvcmFuX2NoZWNrX2pw
Z19zZXR0aW5ncyh6ciwgJnNldHRpbmdzLCAwKTsKKwlpZiAocmVzKQorCQlyZXR1cm4gcmVzOwor
CisJLyogaXQncyBvaywgc28gc2V0IHRoZW0gKi8KKwlmaC0+anBnX3NldHRpbmdzID0gc2V0dGlu
Z3M7CisKKwltYXBfbW9kZV9qcGcoZmgsIGZtdC0+dHlwZSA9PSBWNEwyX0JVRl9UWVBFX1ZJREVP
X09VVFBVVCk7CisJZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemUgPSB6b3Jhbl92NGwyX2NhbGNfYnVm
c2l6ZSgmZmgtPmpwZ19zZXR0aW5ncyk7CisKKwkvKiB0ZWxsIHRoZSB1c2VyIHdoYXQgd2UgYWN0
dWFsbHkgZGlkICovCisJZm10LT5mbXQucGl4LndpZHRoID0gc2V0dGluZ3MuaW1nX3dpZHRoIC8g
c2V0dGluZ3MuSG9yRGNtOworCWZtdC0+Zm10LnBpeC5oZWlnaHQgPSBzZXR0aW5ncy5pbWdfaGVp
Z2h0ICogMiAvCisJCShzZXR0aW5ncy5UbXBEY20gKiBzZXR0aW5ncy5WZXJEY20pOworCWlmIChz
ZXR0aW5ncy5UbXBEY20gPT0gMSkKKwkJZm10LT5mbXQucGl4LmZpZWxkID0gKGZoLT5qcGdfc2V0
dGluZ3Mub2RkX2V2ZW4gPworCQkJCVY0TDJfRklFTERfU0VRX1RCIDogVjRMMl9GSUVMRF9TRVFf
QlQpOworCWVsc2UKKwkJZm10LT5mbXQucGl4LmZpZWxkID0gKGZoLT5qcGdfc2V0dGluZ3Mub2Rk
X2V2ZW4gPworCQkJCVY0TDJfRklFTERfVE9QIDogVjRMMl9GSUVMRF9CT1RUT00pOworCWZtdC0+
Zm10LnBpeC5ieXRlc3BlcmxpbmUgPSAwOworCWZtdC0+Zm10LnBpeC5zaXplaW1hZ2UgPSBmaC0+
YnVmZmVycy5idWZmZXJfc2l6ZTsKKwlmbXQtPmZtdC5waXguY29sb3JzcGFjZSA9IFY0TDJfQ09M
T1JTUEFDRV9TTVBURTE3ME07CisJcmV0dXJuIHJlczsKK30KKworc3RhdGljIGludCB6b3Jhbl9z
X2ZtdF92aWRfY2FwKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2ZoLAorCQkJCQlzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmZtdCkKK3sKKwlzdHJ1Y3Qgem9yYW5fZmggKmZoID0gX19maDsKKwlzdHJ1
Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCWludCBpOworCWludCByZXMgPSAwOworCisJaWYgKGZt
dC0+Zm10LnBpeC5waXhlbGZvcm1hdCA9PSBWNEwyX1BJWF9GTVRfTUpQRUcpCisJCXJldHVybiB6
b3Jhbl9zX2ZtdF92aWRfb3V0KGZpbGUsIGZoLCBmbXQpOworCisJZm9yIChpID0gMDsgaSA8IE5V
TV9GT1JNQVRTOyBpKyspCisJCWlmIChmbXQtPmZtdC5waXgucGl4ZWxmb3JtYXQgPT0gem9yYW5f
Zm9ybWF0c1tpXS5mb3VyY2MpCisJCQlicmVhazsKKwlpZiAoaSA9PSBOVU1fRk9STUFUUykgewor
CQlkcHJpbnRrKDEsIEtFUk5fRVJSICIlczogVklESU9DX1NfRk1UIC0gdW5rbm93bi91bnN1cHBv
cnRlZCBmb3JtYXQgMHgleFxuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBmbXQtPmZtdC5waXgucGl4
ZWxmb3JtYXQpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpZiAoKGZoLT5tYXBfbW9kZSAh
PSBaT1JBTl9NQVBfTU9ERV9SQVcgJiYgZmgtPmJ1ZmZlcnMuYWxsb2NhdGVkKSB8fAorCSAgICBm
aC0+YnVmZmVycy5hY3RpdmUgIT0gWk9SQU5fRlJFRSkgeworCQlkcHJpbnRrKDEsIEtFUk5fRVJS
ICIlczogVklESU9DX1NfRk1UIC0gY2Fubm90IGNoYW5nZSBjYXB0dXJlIG1vZGVcbiIsCisJCQkJ
WlJfREVWTkFNRSh6cikpOworCQlyZXMgPSAtRUJVU1k7CisJCXJldHVybiByZXM7CisJfQorCWlm
IChmbXQtPmZtdC5waXguaGVpZ2h0ID4gQlVaX01BWF9IRUlHSFQpCisJCWZtdC0+Zm10LnBpeC5o
ZWlnaHQgPSBCVVpfTUFYX0hFSUdIVDsKKwlpZiAoZm10LT5mbXQucGl4LndpZHRoID4gQlVaX01B
WF9XSURUSCkKKwkJZm10LT5mbXQucGl4LndpZHRoID0gQlVaX01BWF9XSURUSDsKKworCW1hcF9t
b2RlX3JhdyhmaCk7CisKKwlyZXMgPSB6b3Jhbl92NGxfc2V0X2Zvcm1hdChmaCwgZm10LT5mbXQu
cGl4LndpZHRoLCBmbXQtPmZtdC5waXguaGVpZ2h0LAorCQkJCSAgICZ6b3Jhbl9mb3JtYXRzW2ld
KTsKKwlpZiAocmVzKQorCQlyZXR1cm4gcmVzOworCisJLyogdGVsbCB0aGUgdXNlciB0aGUgcmVz
dWx0cy9taXNzaW5nIHN0dWZmICovCisJZm10LT5mbXQucGl4LmJ5dGVzcGVybGluZSA9IGZoLT52
NGxfc2V0dGluZ3MuYnl0ZXNwZXJsaW5lOworCWZtdC0+Zm10LnBpeC5zaXplaW1hZ2UgPSBmaC0+
djRsX3NldHRpbmdzLmhlaWdodCAqIGZoLT52NGxfc2V0dGluZ3MuYnl0ZXNwZXJsaW5lOworCWZt
dC0+Zm10LnBpeC5jb2xvcnNwYWNlID0gZmgtPnY0bF9zZXR0aW5ncy5mb3JtYXQtPmNvbG9yc3Bh
Y2U7CisJaWYgKEJVWl9NQVhfSEVJR0hUIDwgKGZoLT52NGxfc2V0dGluZ3MuaGVpZ2h0ICogMikp
CisJCWZtdC0+Zm10LnBpeC5maWVsZCA9IFY0TDJfRklFTERfSU5URVJMQUNFRDsKKwllbHNlCisJ
CWZtdC0+Zm10LnBpeC5maWVsZCA9IFY0TDJfRklFTERfVE9QOworCXJldHVybiByZXM7Cit9CisK
K3N0YXRpYyBpbnQgem9yYW5fZ19mYnVmKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2ZoLAor
CQlzdHJ1Y3QgdjRsMl9mcmFtZWJ1ZmZlciAqZmIpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9
IF9fZmg7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKworCW1lbXNldChmYiwgMCwgc2l6
ZW9mKCpmYikpOworCWZiLT5iYXNlID0genItPnZidWZfYmFzZTsKKwlmYi0+Zm10LndpZHRoID0g
enItPnZidWZfd2lkdGg7CisJZmItPmZtdC5oZWlnaHQgPSB6ci0+dmJ1Zl9oZWlnaHQ7CisJaWYg
KHpyLT5vdmVybGF5X3NldHRpbmdzLmZvcm1hdCkKKwkJZmItPmZtdC5waXhlbGZvcm1hdCA9IGZo
LT5vdmVybGF5X3NldHRpbmdzLmZvcm1hdC0+Zm91cmNjOworCWZiLT5mbXQuYnl0ZXNwZXJsaW5l
ID0genItPnZidWZfYnl0ZXNwZXJsaW5lOworCWZiLT5mbXQuY29sb3JzcGFjZSA9IFY0TDJfQ09M
T1JTUEFDRV9TUkdCOworCWZiLT5mbXQuZmllbGQgPSBWNEwyX0ZJRUxEX0lOVEVSTEFDRUQ7CisJ
ZmItPmNhcGFiaWxpdHkgPSBWNEwyX0ZCVUZfQ0FQX0xJU1RfQ0xJUFBJTkc7CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIGludCB6b3Jhbl9zX2ZidWYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
Kl9fZmgsCisJCWNvbnN0IHN0cnVjdCB2NGwyX2ZyYW1lYnVmZmVyICpmYikKK3sKKwlzdHJ1Y3Qg
em9yYW5fZmggKmZoID0gX19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCWludCBp
LCByZXMgPSAwOworCV9fbGUzMiBwcmludGZvcm1hdCA9IF9fY3B1X3RvX2xlMzIoZmItPmZtdC5w
aXhlbGZvcm1hdCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgTlVNX0ZPUk1BVFM7IGkrKykKKwkJaWYg
KHpvcmFuX2Zvcm1hdHNbaV0uZm91cmNjID09IGZiLT5mbXQucGl4ZWxmb3JtYXQpCisJCQlicmVh
azsKKwlpZiAoaSA9PSBOVU1fRk9STUFUUykgeworCQlkcHJpbnRrKDEsIEtFUk5fRVJSICIlczog
VklESU9DX1NfRkJVRiAtIGZvcm1hdD0weCV4ICglNC40cykgbm90IGFsbG93ZWRcbiIsCisJCQla
Ul9ERVZOQU1FKHpyKSwgZmItPmZtdC5waXhlbGZvcm1hdCwKKwkJCShjaGFyICopJnByaW50Zm9y
bWF0KTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcmVzID0gc2V0dXBfZmJ1ZmZlcihmaCwg
ZmItPmJhc2UsICZ6b3Jhbl9mb3JtYXRzW2ldLCBmYi0+Zm10LndpZHRoLAorCQkJICAgIGZiLT5m
bXQuaGVpZ2h0LCBmYi0+Zm10LmJ5dGVzcGVybGluZSk7CisKKwlyZXR1cm4gcmVzOworfQorCitz
dGF0aWMgaW50IHpvcmFuX292ZXJsYXkoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKl9fZmgsIHVu
c2lnbmVkIGludCBvbikKK3sKKwlzdHJ1Y3Qgem9yYW5fZmggKmZoID0gX19maDsKKwlpbnQgcmVz
OworCisJcmVzID0gc2V0dXBfb3ZlcmxheShmaCwgb24pOworCisJcmV0dXJuIHJlczsKK30KKwor
c3RhdGljIGludCB6b3Jhbl9zdHJlYW1vZmYoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKl9fZmgs
IGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKTsKKworc3RhdGljIGludCB6b3Jhbl9yZXFidWZzKHN0
cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2ZoLCBzdHJ1Y3QgdjRsMl9yZXF1ZXN0YnVmZmVycyAq
cmVxKQoreworCXN0cnVjdCB6b3Jhbl9maCAqZmggPSBfX2ZoOworCXN0cnVjdCB6b3JhbiAqenIg
PSBmaC0+enI7CisJaW50IHJlcyA9IDA7CisKKwlpZiAocmVxLT5tZW1vcnkgIT0gVjRMMl9NRU1P
UllfTU1BUCkgeworCQlkcHJpbnRrKDIsCisJCQkJS0VSTl9FUlIKKwkJCQkiJXM6IG9ubHkgTUVN
T1JZX01NQVAgY2FwdHVyZSBpcyBzdXBwb3J0ZWQsIG5vdCAlZFxuIiwKKwkJCQlaUl9ERVZOQU1F
KHpyKSwgcmVxLT5tZW1vcnkpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpZiAocmVxLT5j
b3VudCA9PSAwKQorCQlyZXR1cm4gem9yYW5fc3RyZWFtb2ZmKGZpbGUsIGZoLCByZXEtPnR5cGUp
OworCisJaWYgKGZoLT5idWZmZXJzLmFsbG9jYXRlZCkgeworCQlkcHJpbnRrKDIsCisJCQkJS0VS
Tl9FUlIKKwkJCQkiJXM6IFZJRElPQ19SRVFCVUZTIC0gYnVmZmVycyBhbHJlYWR5IGFsbG9jYXRl
ZFxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSk7CisJCXJlcyA9IC1FQlVTWTsKKwkJcmV0dXJuIHJl
czsKKwl9CisKKwlpZiAoZmgtPm1hcF9tb2RlID09IFpPUkFOX01BUF9NT0RFX1JBVyAmJgorCSAg
ICByZXEtPnR5cGUgPT0gVjRMMl9CVUZfVFlQRV9WSURFT19DQVBUVVJFKSB7CisJCS8qIGNvbnRy
b2wgdXNlciBpbnB1dCAqLworCQlpZiAocmVxLT5jb3VudCA8IDIpCisJCQlyZXEtPmNvdW50ID0g
MjsKKwkJaWYgKHJlcS0+Y291bnQgPiB2NGxfbmJ1ZnMpCisJCQlyZXEtPmNvdW50ID0gdjRsX25i
dWZzOworCisJCS8qIFRoZSBuZXh0IG1tYXAgd2lsbCBtYXAgdGhlIFY0TCBidWZmZXJzICovCisJ
CW1hcF9tb2RlX3JhdyhmaCk7CisJCWZoLT5idWZmZXJzLm51bV9idWZmZXJzID0gcmVxLT5jb3Vu
dDsKKworCQlpZiAodjRsX2ZidWZmZXJfYWxsb2MoZmgpKSB7CisJCQlyZXMgPSAtRU5PTUVNOwor
CQkJcmV0dXJuIHJlczsKKwkJfQorCX0gZWxzZSBpZiAoZmgtPm1hcF9tb2RlID09IFpPUkFOX01B
UF9NT0RFX0pQR19SRUMgfHwKKwkJICAgZmgtPm1hcF9tb2RlID09IFpPUkFOX01BUF9NT0RFX0pQ
R19QTEFZKSB7CisJCS8qIHdlIG5lZWQgdG8gY2FsY3VsYXRlIHNpemUgb3Vyc2VsdmVzIG5vdyAq
LworCQlpZiAocmVxLT5jb3VudCA8IDQpCisJCQlyZXEtPmNvdW50ID0gNDsKKwkJaWYgKHJlcS0+
Y291bnQgPiBqcGdfbmJ1ZnMpCisJCQlyZXEtPmNvdW50ID0ganBnX25idWZzOworCisJCS8qIFRo
ZSBuZXh0IG1tYXAgd2lsbCBtYXAgdGhlIE1KUEVHIGJ1ZmZlcnMgKi8KKwkJbWFwX21vZGVfanBn
KGZoLCByZXEtPnR5cGUgPT0gVjRMMl9CVUZfVFlQRV9WSURFT19PVVRQVVQpOworCQlmaC0+YnVm
ZmVycy5udW1fYnVmZmVycyA9IHJlcS0+Y291bnQ7CisJCWZoLT5idWZmZXJzLmJ1ZmZlcl9zaXpl
ID0gem9yYW5fdjRsMl9jYWxjX2J1ZnNpemUoJmZoLT5qcGdfc2V0dGluZ3MpOworCisJCWlmIChq
cGdfZmJ1ZmZlcl9hbGxvYyhmaCkpIHsKKwkJCXJlcyA9IC1FTk9NRU07CisJCQlyZXR1cm4gcmVz
OworCQl9CisJfSBlbHNlIHsKKwkJZHByaW50aygxLAorCQkJCUtFUk5fRVJSCisJCQkJIiVzOiBW
SURJT0NfUkVRQlVGUyAtIHVua25vd24gdHlwZSAlZFxuIiwKKwkJCQlaUl9ERVZOQU1FKHpyKSwg
cmVxLT50eXBlKTsKKwkJcmVzID0gLUVJTlZBTDsKKwkJcmV0dXJuIHJlczsKKwl9CisJcmV0dXJu
IHJlczsKK30KKworc3RhdGljIGludCB6b3Jhbl9xdWVyeWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqX19maCwgc3RydWN0IHY0bDJfYnVmZmVyICpidWYpCit7CisJc3RydWN0IHpvcmFuX2Zo
ICpmaCA9IF9fZmg7CisJaW50IHJlczsKKworCXJlcyA9IHpvcmFuX3Y0bDJfYnVmZmVyX3N0YXR1
cyhmaCwgYnVmLCBidWYtPmluZGV4KTsKKworCXJldHVybiByZXM7Cit9CisKK3N0YXRpYyBpbnQg
em9yYW5fcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqX19maCwgc3RydWN0IHY0bDJfYnVm
ZmVyICpidWYpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9IF9fZmg7CisJc3RydWN0IHpvcmFu
ICp6ciA9IGZoLT56cjsKKwlpbnQgcmVzID0gMCwgY29kZWNfbW9kZSwgYnVmX3R5cGU7CisKKwlz
d2l0Y2ggKGZoLT5tYXBfbW9kZSkgeworCWNhc2UgWk9SQU5fTUFQX01PREVfUkFXOgorCQlpZiAo
YnVmLT50eXBlICE9IFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRSkgeworCQkJZHByaW50aygx
LCBLRVJOX0VSUgorCQkJCSIlczogVklESU9DX1FCVUYgLSBpbnZhbGlkIGJ1Zi0+dHlwZT0lZCBm
b3IgbWFwX21vZGU9JWRcbiIsCisJCQkJWlJfREVWTkFNRSh6ciksIGJ1Zi0+dHlwZSwgZmgtPm1h
cF9tb2RlKTsKKwkJCXJlcyA9IC1FSU5WQUw7CisJCQlyZXR1cm4gcmVzOworCQl9CisKKwkJcmVz
ID0gem9yYW5fdjRsX3F1ZXVlX2ZyYW1lKGZoLCBidWYtPmluZGV4KTsKKwkJaWYgKHJlcykKKwkJ
CXJldHVybiByZXM7CisJCWlmICghenItPnY0bF9tZW1ncmFiX2FjdGl2ZSAmJiBmaC0+YnVmZmVy
cy5hY3RpdmUgPT0gWk9SQU5fTE9DS0VEKQorCQkJenIzNjA1N19zZXRfbWVtZ3JhYih6ciwgMSk7
CisJCWJyZWFrOworCisJY2FzZSBaT1JBTl9NQVBfTU9ERV9KUEdfUkVDOgorCWNhc2UgWk9SQU5f
TUFQX01PREVfSlBHX1BMQVk6CisJCWlmIChmaC0+bWFwX21vZGUgPT0gWk9SQU5fTUFQX01PREVf
SlBHX1BMQVkpIHsKKwkJCWJ1Zl90eXBlID0gVjRMMl9CVUZfVFlQRV9WSURFT19PVVRQVVQ7CisJ
CQljb2RlY19tb2RlID0gQlVaX01PREVfTU9USU9OX0RFQ09NUFJFU1M7CisJCX0gZWxzZSB7CisJ
CQlidWZfdHlwZSA9IFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRTsKKwkJCWNvZGVjX21vZGUg
PSBCVVpfTU9ERV9NT1RJT05fQ09NUFJFU1M7CisJCX0KKworCQlpZiAoYnVmLT50eXBlICE9IGJ1
Zl90eXBlKSB7CisJCQlkcHJpbnRrKDEsIEtFUk5fRVJSCisJCQkJIiVzOiBWSURJT0NfUUJVRiAt
IGludmFsaWQgYnVmLT50eXBlPSVkIGZvciBtYXBfbW9kZT0lZFxuIiwKKwkJCQlaUl9ERVZOQU1F
KHpyKSwgYnVmLT50eXBlLCBmaC0+bWFwX21vZGUpOworCQkJcmVzID0gLUVJTlZBTDsKKwkJCXJl
dHVybiByZXM7CisJCX0KKworCQlyZXMgPSB6b3Jhbl9qcGdfcXVldWVfZnJhbWUoZmgsIGJ1Zi0+
aW5kZXgsIGNvZGVjX21vZGUpOworCQlpZiAocmVzICE9IDApCisJCQlyZXR1cm4gcmVzOworCQlp
ZiAoenItPmNvZGVjX21vZGUgPT0gQlVaX01PREVfSURMRSAmJgorCQkgICAgZmgtPmJ1ZmZlcnMu
YWN0aXZlID09IFpPUkFOX0xPQ0tFRCkKKwkJCXpyMzYwNTdfZW5hYmxlX2pwZyh6ciwgY29kZWNf
bW9kZSk7CisKKwkJYnJlYWs7CisKKwlkZWZhdWx0OgorCQlkcHJpbnRrKDEsIEtFUk5fRVJSCisJ
CQkiJXM6IFZJRElPQ19RQlVGIC0gdW5zdXBwb3J0ZWQgdHlwZSAlZFxuIiwKKwkJCVpSX0RFVk5B
TUUoenIpLCBidWYtPnR5cGUpOworCQlyZXMgPSAtRUlOVkFMOworCQlicmVhazsKKwl9CisJcmV0
dXJuIHJlczsKK30KKworc3RhdGljIGludCB6b3Jhbl9kcWJ1ZihzdHJ1Y3QgZmlsZSAqZmlsZSwg
dm9pZCAqX19maCwgc3RydWN0IHY0bDJfYnVmZmVyICpidWYpCit7CisJc3RydWN0IHpvcmFuX2Zo
ICpmaCA9IF9fZmg7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKwlpbnQgcmVzID0gMCwg
YnVmX3R5cGUsIG51bSA9IC0xOwkvKiBjb21waWxlciBib3JrcyBoZXJlICg/KSAqLworCisJc3dp
dGNoIChmaC0+bWFwX21vZGUpIHsKKwljYXNlIFpPUkFOX01BUF9NT0RFX1JBVzoKKwkJaWYgKGJ1
Zi0+dHlwZSAhPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkUpIHsKKwkJCWRwcmludGsoMSwg
S0VSTl9FUlIKKwkJCQkiJXM6IFZJRElPQ19RQlVGIC0gaW52YWxpZCBidWYtPnR5cGU9JWQgZm9y
IG1hcF9tb2RlPSVkXG4iLAorCQkJCVpSX0RFVk5BTUUoenIpLCBidWYtPnR5cGUsIGZoLT5tYXBf
bW9kZSk7CisJCQlyZXMgPSAtRUlOVkFMOworCQkJcmV0dXJuIHJlczsKKwkJfQorCisJCW51bSA9
IHpyLT52NGxfcGVuZFt6ci0+djRsX3N5bmNfdGFpbCAmIFY0TF9NQVNLX0ZSQU1FXTsKKwkJaWYg
KGZpbGUtPmZfZmxhZ3MgJiBPX05PTkJMT0NLICYmCisJCSAgICB6ci0+djRsX2J1ZmZlcnMuYnVm
ZmVyW251bV0uc3RhdGUgIT0gQlVaX1NUQVRFX0RPTkUpIHsKKwkJCXJlcyA9IC1FQUdBSU47CisJ
CQlyZXR1cm4gcmVzOworCQl9CisJCXJlcyA9IHY0bF9zeW5jKGZoLCBudW0pOworCQlpZiAocmVz
KQorCQkJcmV0dXJuIHJlczsKKwkJenItPnY0bF9zeW5jX3RhaWwrKzsKKwkJcmVzID0gem9yYW5f
djRsMl9idWZmZXJfc3RhdHVzKGZoLCBidWYsIG51bSk7CisJCWJyZWFrOworCisJY2FzZSBaT1JB
Tl9NQVBfTU9ERV9KUEdfUkVDOgorCWNhc2UgWk9SQU5fTUFQX01PREVfSlBHX1BMQVk6CisJewor
CQlzdHJ1Y3Qgem9yYW5fc3luYyBiczsKKworCQlpZiAoZmgtPm1hcF9tb2RlID09IFpPUkFOX01B
UF9NT0RFX0pQR19QTEFZKQorCQkJYnVmX3R5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVPX09VVFBV
VDsKKwkJZWxzZQorCQkJYnVmX3R5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVPX0NBUFRVUkU7CisK
KwkJaWYgKGJ1Zi0+dHlwZSAhPSBidWZfdHlwZSkgeworCQkJZHByaW50aygxLCBLRVJOX0VSUgor
CQkJCSIlczogVklESU9DX1FCVUYgLSBpbnZhbGlkIGJ1Zi0+dHlwZT0lZCBmb3IgbWFwX21vZGU9
JWRcbiIsCisJCQkJWlJfREVWTkFNRSh6ciksIGJ1Zi0+dHlwZSwgZmgtPm1hcF9tb2RlKTsKKwkJ
CXJlcyA9IC1FSU5WQUw7CisJCQlyZXR1cm4gcmVzOworCQl9CisKKwkJbnVtID0genItPmpwZ19w
ZW5kW3pyLT5qcGdfcXVlX3RhaWwgJiBCVVpfTUFTS19GUkFNRV07CisKKwkJaWYgKGZpbGUtPmZf
ZmxhZ3MgJiBPX05PTkJMT0NLICYmCisJCSAgICB6ci0+anBnX2J1ZmZlcnMuYnVmZmVyW251bV0u
c3RhdGUgIT0gQlVaX1NUQVRFX0RPTkUpIHsKKwkJCXJlcyA9IC1FQUdBSU47CisJCQlyZXR1cm4g
cmVzOworCQl9CisJCWJzLmZyYW1lID0gMDsgLyogc3VwcHJlc3MgY29tcGlsZXIgd2FybmluZyAq
LworCQlyZXMgPSBqcGdfc3luYyhmaCwgJmJzKTsKKwkJaWYgKHJlcykKKwkJCXJldHVybiByZXM7
CisJCXJlcyA9IHpvcmFuX3Y0bDJfYnVmZmVyX3N0YXR1cyhmaCwgYnVmLCBicy5mcmFtZSk7CisJ
CWJyZWFrOworCX0KKworCWRlZmF1bHQ6CisJCWRwcmludGsoMSwgS0VSTl9FUlIKKwkJCSIlczog
VklESU9DX0RRQlVGIC0gdW5zdXBwb3J0ZWQgdHlwZSAlZFxuIiwKKwkJCVpSX0RFVk5BTUUoenIp
LCBidWYtPnR5cGUpOworCQlyZXMgPSAtRUlOVkFMOworCQlicmVhazsKKwl9CisJcmV0dXJuIHJl
czsKK30KKworc3RhdGljIGludCB6b3Jhbl9zdHJlYW1vbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9p
ZCAqX19maCwgZW51bSB2NGwyX2J1Zl90eXBlIHR5cGUpCit7CisJc3RydWN0IHpvcmFuX2ZoICpm
aCA9IF9fZmg7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKwlpbnQgcmVzID0gMDsKKwor
CXN3aXRjaCAoZmgtPm1hcF9tb2RlKSB7CisJY2FzZSBaT1JBTl9NQVBfTU9ERV9SQVc6CS8qIHJh
dyBjYXB0dXJlICovCisJCWlmICh6ci0+djRsX2J1ZmZlcnMuYWN0aXZlICE9IFpPUkFOX0FDVElW
RSB8fAorCQkgICAgZmgtPmJ1ZmZlcnMuYWN0aXZlICE9IFpPUkFOX0FDVElWRSkgeworCQkJcmVz
ID0gLUVCVVNZOworCQkJcmV0dXJuIHJlczsKKwkJfQorCisJCXpyLT52NGxfYnVmZmVycy5hY3Rp
dmUgPSBmaC0+YnVmZmVycy5hY3RpdmUgPSBaT1JBTl9MT0NLRUQ7CisJCXpyLT52NGxfc2V0dGlu
Z3MgPSBmaC0+djRsX3NldHRpbmdzOworCisJCXpyLT52NGxfc3luY190YWlsID0genItPnY0bF9w
ZW5kX3RhaWw7CisJCWlmICghenItPnY0bF9tZW1ncmFiX2FjdGl2ZSAmJgorCQkgICAgenItPnY0
bF9wZW5kX2hlYWQgIT0genItPnY0bF9wZW5kX3RhaWwpIHsKKwkJCXpyMzYwNTdfc2V0X21lbWdy
YWIoenIsIDEpOworCQl9CisJCWJyZWFrOworCisJY2FzZSBaT1JBTl9NQVBfTU9ERV9KUEdfUkVD
OgorCWNhc2UgWk9SQU5fTUFQX01PREVfSlBHX1BMQVk6CisJCS8qIHdoYXQgaXMgdGhlIGNvZGVj
IG1vZGUgcmlnaHQgbm93PyAqLworCQlpZiAoenItPmpwZ19idWZmZXJzLmFjdGl2ZSAhPSBaT1JB
Tl9BQ1RJVkUgfHwKKwkJICAgIGZoLT5idWZmZXJzLmFjdGl2ZSAhPSBaT1JBTl9BQ1RJVkUpIHsK
KwkJCXJlcyA9IC1FQlVTWTsKKwkJCXJldHVybiByZXM7CisJCX0KKworCQl6ci0+anBnX2J1ZmZl
cnMuYWN0aXZlID0gZmgtPmJ1ZmZlcnMuYWN0aXZlID0gWk9SQU5fTE9DS0VEOworCisJCWlmICh6
ci0+anBnX3F1ZV9oZWFkICE9IHpyLT5qcGdfcXVlX3RhaWwpIHsKKwkJCS8qIFN0YXJ0IHRoZSBq
cGVnIGNvZGVjIHdoZW4gdGhlIGZpcnN0IGZyYW1lIGlzIHF1ZXVlZCAgKi8KKwkJCWpwZWdfc3Rh
cnQoenIpOworCQl9CisJCWJyZWFrOworCisJZGVmYXVsdDoKKwkJZHByaW50aygxLAorCQkJS0VS
Tl9FUlIKKwkJCSIlczogVklESU9DX1NUUkVBTU9OIC0gaW52YWxpZCBtYXAgbW9kZSAlZFxuIiwK
KwkJCVpSX0RFVk5BTUUoenIpLCBmaC0+bWFwX21vZGUpOworCQlyZXMgPSAtRUlOVkFMOworCQli
cmVhazsKKwl9CisJcmV0dXJuIHJlczsKK30KKworc3RhdGljIGludCB6b3Jhbl9zdHJlYW1vZmYo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKl9fZmgsIGVudW0gdjRsMl9idWZfdHlwZSB0eXBlKQor
eworCXN0cnVjdCB6b3Jhbl9maCAqZmggPSBfX2ZoOworCXN0cnVjdCB6b3JhbiAqenIgPSBmaC0+
enI7CisJaW50IGksIHJlcyA9IDA7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCXN3aXRjaCAo
ZmgtPm1hcF9tb2RlKSB7CisJY2FzZSBaT1JBTl9NQVBfTU9ERV9SQVc6CS8qIHJhdyBjYXB0dXJl
ICovCisJCWlmIChmaC0+YnVmZmVycy5hY3RpdmUgPT0gWk9SQU5fRlJFRSAmJgorCQkgICAgenIt
PnY0bF9idWZmZXJzLmFjdGl2ZSAhPSBaT1JBTl9GUkVFKSB7CisJCQlyZXMgPSAtRVBFUk07CS8q
IHN0YXkgb2ZmIG90aGVyJ3Mgc2V0dGluZ3MhICovCisJCQlyZXR1cm4gcmVzOworCQl9CisJCWlm
ICh6ci0+djRsX2J1ZmZlcnMuYWN0aXZlID09IFpPUkFOX0ZSRUUpCisJCQlyZXR1cm4gcmVzOwor
CisJCXNwaW5fbG9ja19pcnFzYXZlKCZ6ci0+c3BpbmxvY2ssIGZsYWdzKTsKKwkJLyogdW5sb2Fk
IGNhcHR1cmUgKi8KKwkJaWYgKHpyLT52NGxfbWVtZ3JhYl9hY3RpdmUpIHsKKworCQkJenIzNjA1
N19zZXRfbWVtZ3JhYih6ciwgMCk7CisJCX0KKworCQlmb3IgKGkgPSAwOyBpIDwgZmgtPmJ1ZmZl
cnMubnVtX2J1ZmZlcnM7IGkrKykKKwkJCXpyLT52NGxfYnVmZmVycy5idWZmZXJbaV0uc3RhdGUg
PSBCVVpfU1RBVEVfVVNFUjsKKwkJZmgtPmJ1ZmZlcnMgPSB6ci0+djRsX2J1ZmZlcnM7CisKKwkJ
enItPnY0bF9idWZmZXJzLmFjdGl2ZSA9IGZoLT5idWZmZXJzLmFjdGl2ZSA9IFpPUkFOX0ZSRUU7
CisKKwkJenItPnY0bF9ncmFiX3NlcSA9IDA7CisJCXpyLT52NGxfcGVuZF9oZWFkID0genItPnY0
bF9wZW5kX3RhaWwgPSAwOworCQl6ci0+djRsX3N5bmNfdGFpbCA9IDA7CisKKwkJc3Bpbl91bmxv
Y2tfaXJxcmVzdG9yZSgmenItPnNwaW5sb2NrLCBmbGFncyk7CisKKwkJYnJlYWs7CisKKwljYXNl
IFpPUkFOX01BUF9NT0RFX0pQR19SRUM6CisJY2FzZSBaT1JBTl9NQVBfTU9ERV9KUEdfUExBWToK
KwkJaWYgKGZoLT5idWZmZXJzLmFjdGl2ZSA9PSBaT1JBTl9GUkVFICYmCisJCSAgICB6ci0+anBn
X2J1ZmZlcnMuYWN0aXZlICE9IFpPUkFOX0ZSRUUpIHsKKwkJCXJlcyA9IC1FUEVSTTsJLyogc3Rh
eSBvZmYgb3RoZXIncyBzZXR0aW5ncyEgKi8KKwkJCXJldHVybiByZXM7CisJCX0KKwkJaWYgKHpy
LT5qcGdfYnVmZmVycy5hY3RpdmUgPT0gWk9SQU5fRlJFRSkKKwkJCXJldHVybiByZXM7CisKKwkJ
cmVzID0ganBnX3FidWYoZmgsIC0xLAorCQkJICAgICAoZmgtPm1hcF9tb2RlID09IFpPUkFOX01B
UF9NT0RFX0pQR19SRUMpID8KKwkJCSAgICAgQlVaX01PREVfTU9USU9OX0NPTVBSRVNTIDoKKwkJ
CSAgICAgQlVaX01PREVfTU9USU9OX0RFQ09NUFJFU1MpOworCQlpZiAocmVzKQorCQkJcmV0dXJu
IHJlczsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJZHByaW50aygxLCBLRVJOX0VSUgorCQkJIiVz
OiBWSURJT0NfU1RSRUFNT0ZGIC0gaW52YWxpZCBtYXAgbW9kZSAlZFxuIiwKKwkJCVpSX0RFVk5B
TUUoenIpLCBmaC0+bWFwX21vZGUpOworCQlyZXMgPSAtRUlOVkFMOworCQlicmVhazsKKwl9CisJ
cmV0dXJuIHJlczsKK30KK3N0YXRpYyBpbnQgem9yYW5fZ19zdGQoc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKl9fZmgsIHY0bDJfc3RkX2lkICpzdGQpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9
IF9fZmg7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKworCSpzdGQgPSB6ci0+bm9ybTsK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCB6b3Jhbl9zX3N0ZChzdHJ1Y3QgZmlsZSAqZmls
ZSwgdm9pZCAqX19maCwgdjRsMl9zdGRfaWQgc3RkKQoreworCXN0cnVjdCB6b3Jhbl9maCAqZmgg
PSBfX2ZoOworCXN0cnVjdCB6b3JhbiAqenIgPSBmaC0+enI7CisJaW50IHJlcyA9IDA7CisKKwly
ZXMgPSB6b3Jhbl9zZXRfbm9ybSh6ciwgc3RkKTsKKwlpZiAocmVzKQorCQlyZXR1cm4gcmVzOwor
CisJcmVzID0gd2FpdF9ncmFiX3BlbmRpbmcoenIpOworCXJldHVybiByZXM7Cit9CisKK3N0YXRp
YyBpbnQgem9yYW5fZW51bV9pbnB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqX19maCwKKwkJ
CQkgc3RydWN0IHY0bDJfaW5wdXQgKmlucCkKK3sKKwlzdHJ1Y3Qgem9yYW5fZmggKmZoID0gX19m
aDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCisJaWYgKGlucC0+aW5kZXggPj0genIt
PmNhcmQuaW5wdXRzKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXN0cnNjcHkoaW5wLT5uYW1lLCB6
ci0+Y2FyZC5pbnB1dFtpbnAtPmluZGV4XS5uYW1lLAorCQlzaXplb2YoaW5wLT5uYW1lKSk7CisJ
aW5wLT50eXBlID0gVjRMMl9JTlBVVF9UWVBFX0NBTUVSQTsKKwlpbnAtPnN0ZCA9IFY0TDJfU1RE
X0FMTDsKKworCS8qIEdldCBzdGF0dXMgb2YgdmlkZW8gZGVjb2RlciAqLworCWRlY29kZXJfY2Fs
bCh6ciwgdmlkZW8sIGdfaW5wdXRfc3RhdHVzLCAmaW5wLT5zdGF0dXMpOworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IHpvcmFuX2dfaW5wdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKl9f
ZmgsIHVuc2lnbmVkIGludCAqaW5wdXQpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9IF9fZmg7
CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKworCSppbnB1dCA9IHpyLT5pbnB1dDsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHpvcmFuX3NfaW5wdXQoc3RydWN0IGZpbGUgKmZp
bGUsIHZvaWQgKl9fZmgsIHVuc2lnbmVkIGludCBpbnB1dCkKK3sKKwlzdHJ1Y3Qgem9yYW5fZmgg
KmZoID0gX19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCWludCByZXM7CisKKwly
ZXMgPSB6b3Jhbl9zZXRfaW5wdXQoenIsIGlucHV0KTsKKwlpZiAocmVzKQorCQlyZXR1cm4gcmVz
OworCisJLyogTWFrZSBzdXJlIHRoZSBjaGFuZ2VzIGNvbWUgaW50byBlZmZlY3QgKi8KKwlyZXMg
PSB3YWl0X2dyYWJfcGVuZGluZyh6cik7CisJcmV0dXJuIHJlczsKK30KKworc3RhdGljIGludCB6
b3Jhbl9lbnVtX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqX19maCwKKwkJCQkgIHN0
cnVjdCB2NGwyX291dHB1dCAqb3V0cCkKK3sKKwlpZiAob3V0cC0+aW5kZXggIT0gMCkKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwlvdXRwLT5pbmRleCA9IDA7CisJb3V0cC0+dHlwZSA9IFY0TDJfT1VU
UFVUX1RZUEVfQU5BTE9HVkdBT1ZFUkxBWTsKKwlzdHJzY3B5KG91dHAtPm5hbWUsICJBdXRvZGV0
ZWN0Iiwgc2l6ZW9mKG91dHAtPm5hbWUpKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50
IHpvcmFuX2dfb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2ZoLCB1bnNpZ25lZCBp
bnQgKm91dHB1dCkKK3sKKwkqb3V0cHV0ID0gMDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMg
aW50IHpvcmFuX3Nfb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2ZoLCB1bnNpZ25l
ZCBpbnQgb3V0cHV0KQoreworCWlmIChvdXRwdXQgIT0gMCkKKwkJcmV0dXJuIC1FSU5WQUw7CisK
KwlyZXR1cm4gMDsKK30KKworLyogY3JvcHBpbmcgKHN1Yi1mcmFtZSBjYXB0dXJlKSAqLworc3Rh
dGljIGludCB6b3Jhbl9nX3NlbGVjdGlvbihzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqX19maCwg
c3RydWN0IHY0bDJfc2VsZWN0aW9uICpzZWwpCit7CisJc3RydWN0IHpvcmFuX2ZoICpmaCA9IF9f
Zmg7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKworCWlmIChzZWwtPnR5cGUgIT0gVjRM
Ml9CVUZfVFlQRV9WSURFT19PVVRQVVQgJiYKKwkgICAgc2VsLT50eXBlICE9IFY0TDJfQlVGX1RZ
UEVfVklERU9fQ0FQVFVSRSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlpZiAoZmgtPm1hcF9tb2Rl
ID09IFpPUkFOX01BUF9NT0RFX1JBVykgeworCQlkcHJpbnRrKDEsIEtFUk5fRVJSCisJCQkiJXM6
IFZJRElPQ19HX1NFTEVDVElPTiAtIHN1YmNhcHR1cmUgb25seSBzdXBwb3J0ZWQgZm9yIGNvbXBy
ZXNzZWQgY2FwdHVyZVxuIiwKKwkJCVpSX0RFVk5BTUUoenIpKTsKKwkJcmV0dXJuIC1FSU5WQUw7
CisJfQorCisJc3dpdGNoIChzZWwtPnRhcmdldCkgeworCWNhc2UgVjRMMl9TRUxfVEdUX0NST1A6
CisJCXNlbC0+ci50b3AgPSBmaC0+anBnX3NldHRpbmdzLmltZ195OworCQlzZWwtPnIubGVmdCA9
IGZoLT5qcGdfc2V0dGluZ3MuaW1nX3g7CisJCXNlbC0+ci53aWR0aCA9IGZoLT5qcGdfc2V0dGlu
Z3MuaW1nX3dpZHRoOworCQlzZWwtPnIuaGVpZ2h0ID0gZmgtPmpwZ19zZXR0aW5ncy5pbWdfaGVp
Z2h0OworCQlicmVhazsKKwljYXNlIFY0TDJfU0VMX1RHVF9DUk9QX0RFRkFVTFQ6CisJCXNlbC0+
ci50b3AgPSBzZWwtPnIubGVmdCA9IDA7CisJCXNlbC0+ci53aWR0aCA9IEJVWl9NSU5fV0lEVEg7
CisJCXNlbC0+ci5oZWlnaHQgPSBCVVpfTUlOX0hFSUdIVDsKKwkJYnJlYWs7CisJY2FzZSBWNEwy
X1NFTF9UR1RfQ1JPUF9CT1VORFM6CisJCXNlbC0+ci50b3AgPSBzZWwtPnIubGVmdCA9IDA7CisJ
CXNlbC0+ci53aWR0aCA9IEJVWl9NQVhfV0lEVEg7CisJCXNlbC0+ci5oZWlnaHQgPSBCVVpfTUFY
X0hFSUdIVDsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCXJl
dHVybiAwOworfQorCitzdGF0aWMgaW50IHpvcmFuX3Nfc2VsZWN0aW9uKHN0cnVjdCBmaWxlICpm
aWxlLCB2b2lkICpfX2ZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnNlbCkKK3sKKwlzdHJ1Y3Qg
em9yYW5fZmggKmZoID0gX19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCXN0cnVj
dCB6b3Jhbl9qcGdfc2V0dGluZ3Mgc2V0dGluZ3M7CisJaW50IHJlczsKKworCWlmIChzZWwtPnR5
cGUgIT0gVjRMMl9CVUZfVFlQRV9WSURFT19PVVRQVVQgJiYKKwkgICAgc2VsLT50eXBlICE9IFY0
TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlpZiAoc2Vs
LT50YXJnZXQgIT0gVjRMMl9TRUxfVEdUX0NST1ApCisJCXJldHVybiAtRUlOVkFMOworCisJaWYg
KGZoLT5tYXBfbW9kZSA9PSBaT1JBTl9NQVBfTU9ERV9SQVcpIHsKKwkJZHByaW50aygxLCBLRVJO
X0VSUgorCQkJIiVzOiBWSURJT0NfU19TRUxFQ1RJT04gLSBzdWJjYXB0dXJlIG9ubHkgc3VwcG9y
dGVkIGZvciBjb21wcmVzc2VkIGNhcHR1cmVcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSk7CisJCXJl
dHVybiAtRUlOVkFMOworCX0KKworCXNldHRpbmdzID0gZmgtPmpwZ19zZXR0aW5nczsKKworCWlm
IChmaC0+YnVmZmVycy5hbGxvY2F0ZWQpIHsKKwkJZHByaW50aygxLCBLRVJOX0VSUgorCQkJIiVz
OiBWSURJT0NfU19TRUxFQ1RJT04gLSBjYW5ub3QgY2hhbmdlIHNldHRpbmdzIHdoaWxlIGFjdGl2
ZVxuIiwKKwkJCVpSX0RFVk5BTUUoenIpKTsKKwkJcmV0dXJuIC1FQlVTWTsKKwl9CisKKwkvKiBt
b3ZlIGludG8gYSBmb3JtIHRoYXQgd2UgdW5kZXJzdGFuZCAqLworCXNldHRpbmdzLmltZ194ID0g
c2VsLT5yLmxlZnQ7CisJc2V0dGluZ3MuaW1nX3kgPSBzZWwtPnIudG9wOworCXNldHRpbmdzLmlt
Z193aWR0aCA9IHNlbC0+ci53aWR0aDsKKwlzZXR0aW5ncy5pbWdfaGVpZ2h0ID0gc2VsLT5yLmhl
aWdodDsKKworCS8qIGNoZWNrIHZhbGlkaXR5ICovCisJcmVzID0gem9yYW5fY2hlY2tfanBnX3Nl
dHRpbmdzKHpyLCAmc2V0dGluZ3MsIDApOworCWlmIChyZXMpCisJCXJldHVybiByZXM7CisKKwkv
KiBhY2NlcHQgKi8KKwlmaC0+anBnX3NldHRpbmdzID0gc2V0dGluZ3M7CisJcmV0dXJuIHJlczsK
K30KKworc3RhdGljIGludCB6b3Jhbl9nX2pwZWdjb21wKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpfX2ZoLAorCQkJCQlzdHJ1Y3QgdjRsMl9qcGVnY29tcHJlc3Npb24gKnBhcmFtcykKK3sKKwlz
dHJ1Y3Qgem9yYW5fZmggKmZoID0gX19maDsKKwltZW1zZXQocGFyYW1zLCAwLCBzaXplb2YoKnBh
cmFtcykpOworCisJcGFyYW1zLT5xdWFsaXR5ID0gZmgtPmpwZ19zZXR0aW5ncy5qcGdfY29tcC5x
dWFsaXR5OworCXBhcmFtcy0+QVBQbiA9IGZoLT5qcGdfc2V0dGluZ3MuanBnX2NvbXAuQVBQbjsK
KwltZW1jcHkocGFyYW1zLT5BUFBfZGF0YSwKKwkgICAgICAgZmgtPmpwZ19zZXR0aW5ncy5qcGdf
Y29tcC5BUFBfZGF0YSwKKwkgICAgICAgZmgtPmpwZ19zZXR0aW5ncy5qcGdfY29tcC5BUFBfbGVu
KTsKKwlwYXJhbXMtPkFQUF9sZW4gPSBmaC0+anBnX3NldHRpbmdzLmpwZ19jb21wLkFQUF9sZW47
CisJbWVtY3B5KHBhcmFtcy0+Q09NX2RhdGEsCisJICAgICAgIGZoLT5qcGdfc2V0dGluZ3MuanBn
X2NvbXAuQ09NX2RhdGEsCisJICAgICAgIGZoLT5qcGdfc2V0dGluZ3MuanBnX2NvbXAuQ09NX2xl
bik7CisJcGFyYW1zLT5DT01fbGVuID0gZmgtPmpwZ19zZXR0aW5ncy5qcGdfY29tcC5DT01fbGVu
OworCXBhcmFtcy0+anBlZ19tYXJrZXJzID0KKwkgICAgZmgtPmpwZ19zZXR0aW5ncy5qcGdfY29t
cC5qcGVnX21hcmtlcnM7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCB6b3Jhbl9zX2pw
ZWdjb21wKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpfX2ZoLAorCQkJCQljb25zdCBzdHJ1Y3Qg
djRsMl9qcGVnY29tcHJlc3Npb24gKnBhcmFtcykKK3sKKwlzdHJ1Y3Qgem9yYW5fZmggKmZoID0g
X19maDsKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gZmgtPnpyOworCWludCByZXMgPSAwOworCXN0cnVj
dCB6b3Jhbl9qcGdfc2V0dGluZ3Mgc2V0dGluZ3M7CisKKwlzZXR0aW5ncyA9IGZoLT5qcGdfc2V0
dGluZ3M7CisKKwlzZXR0aW5ncy5qcGdfY29tcCA9ICpwYXJhbXM7CisKKwlpZiAoZmgtPmJ1ZmZl
cnMuYWN0aXZlICE9IFpPUkFOX0ZSRUUpIHsKKwkJZHByaW50aygxLCBLRVJOX1dBUk5JTkcKKwkJ
CSIlczogVklESU9DX1NfSlBFR0NPTVAgY2FsbGVkIHdoaWxlIGluIHBsYXliYWNrL2NhcHR1cmUg
bW9kZVxuIiwKKwkJCVpSX0RFVk5BTUUoenIpKTsKKwkJcmVzID0gLUVCVVNZOworCQlyZXR1cm4g
cmVzOworCX0KKworCXJlcyA9IHpvcmFuX2NoZWNrX2pwZ19zZXR0aW5ncyh6ciwgJnNldHRpbmdz
LCAwKTsKKwlpZiAocmVzKQorCQlyZXR1cm4gcmVzOworCWlmICghZmgtPmJ1ZmZlcnMuYWxsb2Nh
dGVkKQorCQlmaC0+YnVmZmVycy5idWZmZXJfc2l6ZSA9CisJCQl6b3Jhbl92NGwyX2NhbGNfYnVm
c2l6ZSgmZmgtPmpwZ19zZXR0aW5ncyk7CisJZmgtPmpwZ19zZXR0aW5ncy5qcGdfY29tcCA9IHNl
dHRpbmdzLmpwZ19jb21wOworCXJldHVybiByZXM7Cit9CisKK3N0YXRpYyBfX3BvbGxfdAorem9y
YW5fcG9sbCAoc3RydWN0IGZpbGUgKmZpbGUsCisJICAgIHBvbGxfdGFibGUgICp3YWl0KQorewor
CXN0cnVjdCB6b3Jhbl9maCAqZmggPSBmaWxlLT5wcml2YXRlX2RhdGE7CisJc3RydWN0IHpvcmFu
ICp6ciA9IGZoLT56cjsKKwlfX3BvbGxfdCByZXMgPSB2NGwyX2N0cmxfcG9sbChmaWxlLCB3YWl0
KTsKKwlpbnQgZnJhbWU7CisJdW5zaWduZWQgbG9uZyBmbGFnczsKKworCS8qIHdlIHNob3VsZCBj
aGVjayB3aGV0aGVyIGJ1ZmZlcnMgYXJlIHJlYWR5IHRvIGJlIHN5bmNlZCBvbgorCSAqICh3L28g
d2FpdHMgLSBPX05PTkJMT0NLKSBoZXJlCisJICogaWYgcmVhZHkgZm9yIHJlYWQgKHN5bmMpLCBy
ZXR1cm4gRVBPTExJTnxFUE9MTFJETk9STSwKKwkgKiBpZiByZWFkeSBmb3Igd3JpdGUgKHN5bmMp
LCByZXR1cm4gRVBPTExPVVR8RVBPTExXUk5PUk0sCisJICogaWYgZXJyb3IsIHJldHVybiBFUE9M
TEVSUiwKKwkgKiBpZiBubyBidWZmZXJzIHF1ZXVlZCBvciBzbywgcmV0dXJuIEVQT0xMTlZBTAor
CSAqLworCisJc3dpdGNoIChmaC0+bWFwX21vZGUpIHsKKwljYXNlIFpPUkFOX01BUF9NT0RFX1JB
VzoKKwkJcG9sbF93YWl0KGZpbGUsICZ6ci0+djRsX2NhcHEsIHdhaXQpOworCQlmcmFtZSA9IHpy
LT52NGxfcGVuZFt6ci0+djRsX3N5bmNfdGFpbCAmIFY0TF9NQVNLX0ZSQU1FXTsKKworCQlzcGlu
X2xvY2tfaXJxc2F2ZSgmenItPnNwaW5sb2NrLCBmbGFncyk7CisJCWRwcmludGsoMywKKwkJCUtF
Uk5fREVCVUcKKwkJCSIlczogJXMoKSByYXcgLSBhY3RpdmU9JWMsIHN5bmNfdGFpbD0lbHUvJWMs
IHBlbmRfdGFpbD0lbHUsIHBlbmRfaGVhZD0lbHVcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgX19m
dW5jX18sCisJCQkiRkFMIltmaC0+YnVmZmVycy5hY3RpdmVdLCB6ci0+djRsX3N5bmNfdGFpbCwK
KwkJCSJVUE1EIlt6ci0+djRsX2J1ZmZlcnMuYnVmZmVyW2ZyYW1lXS5zdGF0ZV0sCisJCQl6ci0+
djRsX3BlbmRfdGFpbCwgenItPnY0bF9wZW5kX2hlYWQpOworCQkvKiBQcm9jZXNzIGlzIHRoZSBv
bmUgY2FwdHVyaW5nPyAqLworCQlpZiAoZmgtPmJ1ZmZlcnMuYWN0aXZlICE9IFpPUkFOX0ZSRUUg
JiYKKwkJICAgIC8qIEJ1ZmZlciByZWFkeSB0byBEUUJVRj8gKi8KKwkJICAgIHpyLT52NGxfYnVm
ZmVycy5idWZmZXJbZnJhbWVdLnN0YXRlID09IEJVWl9TVEFURV9ET05FKQorCQkJcmVzIHw9IEVQ
T0xMSU4gfCBFUE9MTFJETk9STTsKKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmenItPnNwaW5s
b2NrLCBmbGFncyk7CisKKwkJYnJlYWs7CisKKwljYXNlIFpPUkFOX01BUF9NT0RFX0pQR19SRUM6
CisJY2FzZSBaT1JBTl9NQVBfTU9ERV9KUEdfUExBWToKKwkJcG9sbF93YWl0KGZpbGUsICZ6ci0+
anBnX2NhcHEsIHdhaXQpOworCQlmcmFtZSA9IHpyLT5qcGdfcGVuZFt6ci0+anBnX3F1ZV90YWls
ICYgQlVaX01BU0tfRlJBTUVdOworCisJCXNwaW5fbG9ja19pcnFzYXZlKCZ6ci0+c3BpbmxvY2ss
IGZsYWdzKTsKKwkJZHByaW50aygzLAorCQkJS0VSTl9ERUJVRworCQkJIiVzOiAlcygpIGpwZyAt
IGFjdGl2ZT0lYywgcXVlX3RhaWw9JWx1LyVjLCBxdWVfaGVhZD0lbHUsIGRtYT0lbHUvJWx1XG4i
LAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLAorCQkJIkZBTCJbZmgtPmJ1ZmZlcnMuYWN0
aXZlXSwgenItPmpwZ19xdWVfdGFpbCwKKwkJCSJVUE1EIlt6ci0+anBnX2J1ZmZlcnMuYnVmZmVy
W2ZyYW1lXS5zdGF0ZV0sCisJCQl6ci0+anBnX3F1ZV9oZWFkLCB6ci0+anBnX2RtYV90YWlsLCB6
ci0+anBnX2RtYV9oZWFkKTsKKwkJaWYgKGZoLT5idWZmZXJzLmFjdGl2ZSAhPSBaT1JBTl9GUkVF
ICYmCisJCSAgICB6ci0+anBnX2J1ZmZlcnMuYnVmZmVyW2ZyYW1lXS5zdGF0ZSA9PSBCVVpfU1RB
VEVfRE9ORSkgeworCQkJaWYgKGZoLT5tYXBfbW9kZSA9PSBaT1JBTl9NQVBfTU9ERV9KUEdfUkVD
KQorCQkJCXJlcyB8PSBFUE9MTElOIHwgRVBPTExSRE5PUk07CisJCQllbHNlCisJCQkJcmVzIHw9
IEVQT0xMT1VUIHwgRVBPTExXUk5PUk07CisJCX0KKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgm
enItPnNwaW5sb2NrLCBmbGFncyk7CisKKwkJYnJlYWs7CisKKwlkZWZhdWx0OgorCQlkcHJpbnRr
KDEsCisJCQlLRVJOX0VSUgorCQkJIiVzOiAlcyAtIGludGVybmFsIGVycm9yLCB1bmtub3duIG1h
cF9tb2RlPSVkXG4iLAorCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBmaC0+bWFwX21vZGUp
OworCQlyZXMgfD0gRVBPTExFUlI7CisJfQorCisJcmV0dXJuIHJlczsKK30KKworCisvKgorICog
VGhpcyBtYXBzIHRoZSBidWZmZXJzIHRvIHVzZXIgc3BhY2UuCisgKgorICogRGVwZW5kaW5nIG9u
IHRoZSBzdGF0ZSBvZiBmaC0+bWFwX21vZGUKKyAqIHRoZSBWNEwgb3IgdGhlIE1KUEVHIGJ1ZmZl
cnMgYXJlIG1hcHBlZAorICogcGVyIGJ1ZmZlciBvciBhbGwgdG9nZXRoZXIKKyAqCisgKiBOb3Rl
IHRoYXQgd2UgbmVlZCB0byBjb25uZWN0IHRvIHNvbWUKKyAqIHVubWFwIHNpZ25hbCBldmVudCB0
byB1bm1hcCB0aGUgZGUtYWxsb2NhdGUKKyAqIHRoZSBidWZmZXIgYWNjb3JkaW5nbHkgKHpvcmFu
X3ZtX2Nsb3NlKCkpCisgKi8KKworc3RhdGljIHZvaWQKK3pvcmFuX3ZtX29wZW4gKHN0cnVjdCB2
bV9hcmVhX3N0cnVjdCAqdm1hKQoreworCXN0cnVjdCB6b3Jhbl9tYXBwaW5nICptYXAgPSB2bWEt
PnZtX3ByaXZhdGVfZGF0YTsKKwlhdG9taWNfaW5jKCZtYXAtPmNvdW50KTsKK30KKworc3RhdGlj
IHZvaWQKK3pvcmFuX3ZtX2Nsb3NlIChzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkKK3sKKwlz
dHJ1Y3Qgem9yYW5fbWFwcGluZyAqbWFwID0gdm1hLT52bV9wcml2YXRlX2RhdGE7CisJc3RydWN0
IHpvcmFuX2ZoICpmaCA9IG1hcC0+Zmg7CisJc3RydWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKwlp
bnQgaTsKKworCWRwcmludGsoMywgS0VSTl9JTkZPICIlczogJXMgLSBtdW5tYXAoJXMpXG4iLCBa
Ul9ERVZOQU1FKHpyKSwKKwkJX19mdW5jX18sIG1vZGVfbmFtZShmaC0+bWFwX21vZGUpKTsKKwor
CWZvciAoaSA9IDA7IGkgPCBmaC0+YnVmZmVycy5udW1fYnVmZmVyczsgaSsrKSB7CisJCWlmIChm
aC0+YnVmZmVycy5idWZmZXJbaV0ubWFwID09IG1hcCkKKwkJCWZoLT5idWZmZXJzLmJ1ZmZlcltp
XS5tYXAgPSBOVUxMOworCX0KKwlrZnJlZShtYXApOworCisJLyogQW55IGJ1ZmZlcnMgc3RpbGwg
bWFwcGVkPyAqLworCWZvciAoaSA9IDA7IGkgPCBmaC0+YnVmZmVycy5udW1fYnVmZmVyczsgaSsr
KSB7CisJCWlmIChmaC0+YnVmZmVycy5idWZmZXJbaV0ubWFwKSB7CisJCQlyZXR1cm47CisJCX0K
Kwl9CisKKwlkcHJpbnRrKDMsIEtFUk5fSU5GTyAiJXM6ICVzIC0gZnJlZSAlcyBidWZmZXJzXG4i
LCBaUl9ERVZOQU1FKHpyKSwKKwkJX19mdW5jX18sIG1vZGVfbmFtZShmaC0+bWFwX21vZGUpKTsK
KworCWlmIChmaC0+bWFwX21vZGUgPT0gWk9SQU5fTUFQX01PREVfUkFXKSB7CisJCWlmIChmaC0+
YnVmZmVycy5hY3RpdmUgIT0gWk9SQU5fRlJFRSkgeworCQkJdW5zaWduZWQgbG9uZyBmbGFnczsK
KworCQkJc3Bpbl9sb2NrX2lycXNhdmUoJnpyLT5zcGlubG9jaywgZmxhZ3MpOworCQkJenIzNjA1
N19zZXRfbWVtZ3JhYih6ciwgMCk7CisJCQl6ci0+djRsX2J1ZmZlcnMuYWxsb2NhdGVkID0gMDsK
KwkJCXpyLT52NGxfYnVmZmVycy5hY3RpdmUgPSBmaC0+YnVmZmVycy5hY3RpdmUgPSBaT1JBTl9G
UkVFOworCQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmenItPnNwaW5sb2NrLCBmbGFncyk7CisJ
CX0KKwkJdjRsX2ZidWZmZXJfZnJlZShmaCk7CisJfSBlbHNlIHsKKwkJaWYgKGZoLT5idWZmZXJz
LmFjdGl2ZSAhPSBaT1JBTl9GUkVFKSB7CisJCQlqcGdfcWJ1ZihmaCwgLTEsIHpyLT5jb2RlY19t
b2RlKTsKKwkJCXpyLT5qcGdfYnVmZmVycy5hbGxvY2F0ZWQgPSAwOworCQkJenItPmpwZ19idWZm
ZXJzLmFjdGl2ZSA9IGZoLT5idWZmZXJzLmFjdGl2ZSA9IFpPUkFOX0ZSRUU7CisJCX0KKwkJanBn
X2ZidWZmZXJfZnJlZShmaCk7CisJfQorfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IHZtX29wZXJh
dGlvbnNfc3RydWN0IHpvcmFuX3ZtX29wcyA9IHsKKwkub3BlbiA9IHpvcmFuX3ZtX29wZW4sCisJ
LmNsb3NlID0gem9yYW5fdm1fY2xvc2UsCit9OworCitzdGF0aWMgaW50Cit6b3Jhbl9tbWFwIChz
dHJ1Y3QgZmlsZSAgICAgICAgICAgKmZpbGUsCisJICAgIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAq
dm1hKQoreworCXN0cnVjdCB6b3Jhbl9maCAqZmggPSBmaWxlLT5wcml2YXRlX2RhdGE7CisJc3Ry
dWN0IHpvcmFuICp6ciA9IGZoLT56cjsKKwl1bnNpZ25lZCBsb25nIHNpemUgPSAodm1hLT52bV9l
bmQgLSB2bWEtPnZtX3N0YXJ0KTsKKwl1bnNpZ25lZCBsb25nIG9mZnNldCA9IHZtYS0+dm1fcGdv
ZmYgPDwgUEFHRV9TSElGVDsKKwlpbnQgaSwgajsKKwl1bnNpZ25lZCBsb25nIHBhZ2UsIHN0YXJ0
ID0gdm1hLT52bV9zdGFydCwgdG9kbywgcG9zLCBmcmFnbGVuOworCWludCBmaXJzdCwgbGFzdDsK
KwlzdHJ1Y3Qgem9yYW5fbWFwcGluZyAqbWFwOworCWludCByZXMgPSAwOworCisJZHByaW50aygz
LAorCQlLRVJOX0lORk8gIiVzOiAlcyglcykgb2YgMHglMDhseC0weCUwOGx4IChzaXplPSVsdSlc
biIsCisJCVpSX0RFVk5BTUUoenIpLCBfX2Z1bmNfXywKKwkJbW9kZV9uYW1lKGZoLT5tYXBfbW9k
ZSksIHZtYS0+dm1fc3RhcnQsIHZtYS0+dm1fZW5kLCBzaXplKTsKKworCWlmICghKHZtYS0+dm1f
ZmxhZ3MgJiBWTV9TSEFSRUQpIHx8ICEodm1hLT52bV9mbGFncyAmIFZNX1JFQUQpIHx8CisJICAg
ICEodm1hLT52bV9mbGFncyAmIFZNX1dSSVRFKSkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VS
UgorCQkJIiVzOiAlcyAtIG5vIE1BUF9TSEFSRUQvUFJPVF97UkVBRCxXUklURX0gZ2l2ZW5cbiIs
CisJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisK
KwlpZiAoIWZoLT5idWZmZXJzLmFsbG9jYXRlZCkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VS
UgorCQkJIiVzOiAlcyglcykgLSBidWZmZXJzIG5vdCB5ZXQgYWxsb2NhdGVkXG4iLAorCQkJWlJf
REVWTkFNRSh6ciksIF9fZnVuY19fLCBtb2RlX25hbWUoZmgtPm1hcF9tb2RlKSk7CisJCXJlcyA9
IC1FTk9NRU07CisJCXJldHVybiByZXM7CisJfQorCisJZmlyc3QgPSBvZmZzZXQgLyBmaC0+YnVm
ZmVycy5idWZmZXJfc2l6ZTsKKwlsYXN0ID0gZmlyc3QgLSAxICsgc2l6ZSAvIGZoLT5idWZmZXJz
LmJ1ZmZlcl9zaXplOworCWlmIChvZmZzZXQgJSBmaC0+YnVmZmVycy5idWZmZXJfc2l6ZSAhPSAw
IHx8CisJICAgIHNpemUgJSBmaC0+YnVmZmVycy5idWZmZXJfc2l6ZSAhPSAwIHx8IGZpcnN0IDwg
MCB8fAorCSAgICBsYXN0IDwgMCB8fCBmaXJzdCA+PSBmaC0+YnVmZmVycy5udW1fYnVmZmVycyB8
fAorCSAgICBsYXN0ID49IGZoLT5idWZmZXJzLmJ1ZmZlcl9zaXplKSB7CisJCWRwcmludGsoMSwK
KwkJCUtFUk5fRVJSCisJCQkiJXM6ICVzKCVzKSAtIG9mZnNldD0lbHUgb3Igc2l6ZT0lbHUgaW52
YWxpZCBmb3IgYnVmc2l6ZT0lZCBhbmQgbnVtYnVmcz0lZFxuIiwKKwkJCVpSX0RFVk5BTUUoenIp
LCBfX2Z1bmNfXywgbW9kZV9uYW1lKGZoLT5tYXBfbW9kZSksIG9mZnNldCwgc2l6ZSwKKwkJCWZo
LT5idWZmZXJzLmJ1ZmZlcl9zaXplLAorCQkJZmgtPmJ1ZmZlcnMubnVtX2J1ZmZlcnMpOworCQly
ZXMgPSAtRUlOVkFMOworCQlyZXR1cm4gcmVzOworCX0KKworCS8qIENoZWNrIGlmIGFueSBidWZm
ZXJzIGFyZSBhbHJlYWR5IG1hcHBlZCAqLworCWZvciAoaSA9IGZpcnN0OyBpIDw9IGxhc3Q7IGkr
KykgeworCQlpZiAoZmgtPmJ1ZmZlcnMuYnVmZmVyW2ldLm1hcCkgeworCQkJZHByaW50aygxLAor
CQkJCUtFUk5fRVJSCisJCQkJIiVzOiAlcyglcykgLSBidWZmZXIgJWQgYWxyZWFkeSBtYXBwZWRc
biIsCisJCQkJWlJfREVWTkFNRSh6ciksIF9fZnVuY19fLCBtb2RlX25hbWUoZmgtPm1hcF9tb2Rl
KSwgaSk7CisJCQlyZXMgPSAtRUJVU1k7CisJCQlyZXR1cm4gcmVzOworCQl9CisJfQorCisJLyog
bWFwIHRoZXNlIGJ1ZmZlcnMgKi8KKwltYXAgPSBrbWFsbG9jKHNpemVvZihzdHJ1Y3Qgem9yYW5f
bWFwcGluZyksIEdGUF9LRVJORUwpOworCWlmICghbWFwKSB7CisJCXJlcyA9IC1FTk9NRU07CisJ
CXJldHVybiByZXM7CisJfQorCW1hcC0+ZmggPSBmaDsKKwlhdG9taWNfc2V0KCZtYXAtPmNvdW50
LCAxKTsKKworCXZtYS0+dm1fb3BzID0gJnpvcmFuX3ZtX29wczsKKwl2bWEtPnZtX2ZsYWdzIHw9
IFZNX0RPTlRFWFBBTkQ7CisJdm1hLT52bV9wcml2YXRlX2RhdGEgPSBtYXA7CisKKwlpZiAoZmgt
Pm1hcF9tb2RlID09IFpPUkFOX01BUF9NT0RFX1JBVykgeworCQlmb3IgKGkgPSBmaXJzdDsgaSA8
PSBsYXN0OyBpKyspIHsKKwkJCXRvZG8gPSBzaXplOworCQkJaWYgKHRvZG8gPiBmaC0+YnVmZmVy
cy5idWZmZXJfc2l6ZSkKKwkJCQl0b2RvID0gZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemU7CisJCQlw
YWdlID0gZmgtPmJ1ZmZlcnMuYnVmZmVyW2ldLnY0bC5mYnVmZmVyX3BoeXM7CisJCQlpZiAocmVt
YXBfcGZuX3JhbmdlKHZtYSwgc3RhcnQsIHBhZ2UgPj4gUEFHRV9TSElGVCwKKwkJCQkJCQl0b2Rv
LCBQQUdFX1NIQVJFRCkpIHsKKwkJCQlkcHJpbnRrKDEsCisJCQkJCUtFUk5fRVJSCisJCQkJCSIl
czogJXMoVjRMKSAtIHJlbWFwX3Bmbl9yYW5nZSBmYWlsZWRcbiIsCisJCQkJCVpSX0RFVk5BTUUo
enIpLCBfX2Z1bmNfXyk7CisJCQkJcmVzID0gLUVBR0FJTjsKKwkJCQlyZXR1cm4gcmVzOworCQkJ
fQorCQkJc2l6ZSAtPSB0b2RvOworCQkJc3RhcnQgKz0gdG9kbzsKKwkJCWZoLT5idWZmZXJzLmJ1
ZmZlcltpXS5tYXAgPSBtYXA7CisJCQlpZiAoc2l6ZSA9PSAwKQorCQkJCWJyZWFrOworCQl9CisJ
fSBlbHNlIHsKKwkJZm9yIChpID0gZmlyc3Q7IGkgPD0gbGFzdDsgaSsrKSB7CisJCQlmb3IgKGog
PSAwOworCQkJICAgICBqIDwgZmgtPmJ1ZmZlcnMuYnVmZmVyX3NpemUgLyBQQUdFX1NJWkU7CisJ
CQkgICAgIGorKykgeworCQkJCWZyYWdsZW4gPQorCQkJCSAgICAobGUzMl90b19jcHUoZmgtPmJ1
ZmZlcnMuYnVmZmVyW2ldLmpwZy4KKwkJCQkgICAgIGZyYWdfdGFiWzIgKiBqICsgMV0pICYgfjEp
IDw8IDE7CisJCQkJdG9kbyA9IHNpemU7CisJCQkJaWYgKHRvZG8gPiBmcmFnbGVuKQorCQkJCQl0
b2RvID0gZnJhZ2xlbjsKKwkJCQlwb3MgPQorCQkJCSAgICBsZTMyX3RvX2NwdShmaC0+YnVmZmVy
cy4KKwkJCQkgICAgYnVmZmVyW2ldLmpwZy5mcmFnX3RhYlsyICogal0pOworCQkJCS8qIHNob3Vs
ZCBqdXN0IGJlIHBvcyBvbiBpMzg2ICovCisJCQkJcGFnZSA9IHZpcnRfdG9fcGh5cyhidXNfdG9f
dmlydChwb3MpKQorCQkJCQkJCQk+PiBQQUdFX1NISUZUOworCQkJCWlmIChyZW1hcF9wZm5fcmFu
Z2Uodm1hLCBzdGFydCwgcGFnZSwKKwkJCQkJCQl0b2RvLCBQQUdFX1NIQVJFRCkpIHsKKwkJCQkJ
ZHByaW50aygxLAorCQkJCQkJS0VSTl9FUlIKKwkJCQkJCSIlczogJXMoVjRMKSAtIHJlbWFwX3Bm
bl9yYW5nZSBmYWlsZWRcbiIsCisJCQkJCQlaUl9ERVZOQU1FKHpyKSwgX19mdW5jX18pOworCQkJ
CQlyZXMgPSAtRUFHQUlOOworCQkJCQlyZXR1cm4gcmVzOworCQkJCX0KKwkJCQlzaXplIC09IHRv
ZG87CisJCQkJc3RhcnQgKz0gdG9kbzsKKwkJCQlpZiAoc2l6ZSA9PSAwKQorCQkJCQlicmVhazsK
KwkJCQlpZiAobGUzMl90b19jcHUoZmgtPmJ1ZmZlcnMuYnVmZmVyW2ldLmpwZy4KKwkJCQkgICAg
ZnJhZ190YWJbMiAqIGogKyAxXSkgJiAxKQorCQkJCQlicmVhazsJLyogd2FzIGxhc3QgZnJhZ21l
bnQgKi8KKwkJCX0KKwkJCWZoLT5idWZmZXJzLmJ1ZmZlcltpXS5tYXAgPSBtYXA7CisJCQlpZiAo
c2l6ZSA9PSAwKQorCQkJCWJyZWFrOworCisJCX0KKwl9CisJcmV0dXJuIHJlczsKK30KKworc3Rh
dGljIGNvbnN0IHN0cnVjdCB2NGwyX2lvY3RsX29wcyB6b3Jhbl9pb2N0bF9vcHMgPSB7CisJLnZp
ZGlvY19xdWVyeWNhcAkJICAgID0gem9yYW5fcXVlcnljYXAsCisJLnZpZGlvY19zX3NlbGVjdGlv
bgkJICAgID0gem9yYW5fc19zZWxlY3Rpb24sCisJLnZpZGlvY19nX3NlbGVjdGlvbgkJICAgID0g
em9yYW5fZ19zZWxlY3Rpb24sCisJLnZpZGlvY19lbnVtX2lucHV0CQkgICAgPSB6b3Jhbl9lbnVt
X2lucHV0LAorCS52aWRpb2NfZ19pbnB1dAkJCSAgICA9IHpvcmFuX2dfaW5wdXQsCisJLnZpZGlv
Y19zX2lucHV0CQkJICAgID0gem9yYW5fc19pbnB1dCwKKwkudmlkaW9jX2VudW1fb3V0cHV0CQkg
ICAgPSB6b3Jhbl9lbnVtX291dHB1dCwKKwkudmlkaW9jX2dfb3V0cHV0CQkgICAgPSB6b3Jhbl9n
X291dHB1dCwKKwkudmlkaW9jX3Nfb3V0cHV0CQkgICAgPSB6b3Jhbl9zX291dHB1dCwKKwkudmlk
aW9jX2dfZmJ1ZgkJCSAgICA9IHpvcmFuX2dfZmJ1ZiwKKwkudmlkaW9jX3NfZmJ1ZgkJCSAgICA9
IHpvcmFuX3NfZmJ1ZiwKKwkudmlkaW9jX2dfc3RkCQkJICAgID0gem9yYW5fZ19zdGQsCisJLnZp
ZGlvY19zX3N0ZAkJCSAgICA9IHpvcmFuX3Nfc3RkLAorCS52aWRpb2NfZ19qcGVnY29tcAkJICAg
ID0gem9yYW5fZ19qcGVnY29tcCwKKwkudmlkaW9jX3NfanBlZ2NvbXAJCSAgICA9IHpvcmFuX3Nf
anBlZ2NvbXAsCisJLnZpZGlvY19vdmVybGF5CQkJICAgID0gem9yYW5fb3ZlcmxheSwKKwkudmlk
aW9jX3JlcWJ1ZnMJCQkgICAgPSB6b3Jhbl9yZXFidWZzLAorCS52aWRpb2NfcXVlcnlidWYJCSAg
ICA9IHpvcmFuX3F1ZXJ5YnVmLAorCS52aWRpb2NfcWJ1ZgkJCSAgICA9IHpvcmFuX3FidWYsCisJ
LnZpZGlvY19kcWJ1ZgkJCSAgICA9IHpvcmFuX2RxYnVmLAorCS52aWRpb2Nfc3RyZWFtb24JCSAg
ICA9IHpvcmFuX3N0cmVhbW9uLAorCS52aWRpb2Nfc3RyZWFtb2ZmCQkgICAgPSB6b3Jhbl9zdHJl
YW1vZmYsCisJLnZpZGlvY19lbnVtX2ZtdF92aWRfY2FwCSAgICA9IHpvcmFuX2VudW1fZm10X3Zp
ZF9jYXAsCisJLnZpZGlvY19lbnVtX2ZtdF92aWRfb3V0CSAgICA9IHpvcmFuX2VudW1fZm10X3Zp
ZF9vdXQsCisJLnZpZGlvY19lbnVtX2ZtdF92aWRfb3ZlcmxheQkgICAgPSB6b3Jhbl9lbnVtX2Zt
dF92aWRfb3ZlcmxheSwKKwkudmlkaW9jX2dfZm10X3ZpZF9jYXAJCSAgICA9IHpvcmFuX2dfZm10
X3ZpZF9jYXAsCisJLnZpZGlvY19nX2ZtdF92aWRfb3V0ICAgICAgICAgICAgICAgPSB6b3Jhbl9n
X2ZtdF92aWRfb3V0LAorCS52aWRpb2NfZ19mbXRfdmlkX292ZXJsYXkgICAgICAgICAgID0gem9y
YW5fZ19mbXRfdmlkX292ZXJsYXksCisJLnZpZGlvY19zX2ZtdF92aWRfY2FwCQkgICAgPSB6b3Jh
bl9zX2ZtdF92aWRfY2FwLAorCS52aWRpb2Nfc19mbXRfdmlkX291dCAgICAgICAgICAgICAgID0g
em9yYW5fc19mbXRfdmlkX291dCwKKwkudmlkaW9jX3NfZm10X3ZpZF9vdmVybGF5ICAgICAgICAg
ICA9IHpvcmFuX3NfZm10X3ZpZF9vdmVybGF5LAorCS52aWRpb2NfdHJ5X2ZtdF92aWRfY2FwCQkg
ICAgPSB6b3Jhbl90cnlfZm10X3ZpZF9jYXAsCisJLnZpZGlvY190cnlfZm10X3ZpZF9vdXQJCSAg
ICA9IHpvcmFuX3RyeV9mbXRfdmlkX291dCwKKwkudmlkaW9jX3RyeV9mbXRfdmlkX292ZXJsYXkJ
ICAgID0gem9yYW5fdHJ5X2ZtdF92aWRfb3ZlcmxheSwKKwkudmlkaW9jX3N1YnNjcmliZV9ldmVu
dCAgICAgICAgICAgICA9IHY0bDJfY3RybF9zdWJzY3JpYmVfZXZlbnQsCisJLnZpZGlvY191bnN1
YnNjcmliZV9ldmVudCAgICAgICAgICAgPSB2NGwyX2V2ZW50X3Vuc3Vic2NyaWJlLAorfTsKKwor
c3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZpbGVfb3BlcmF0aW9ucyB6b3Jhbl9mb3BzID0gewor
CS5vd25lciA9IFRISVNfTU9EVUxFLAorCS5vcGVuID0gem9yYW5fb3BlbiwKKwkucmVsZWFzZSA9
IHpvcmFuX2Nsb3NlLAorCS51bmxvY2tlZF9pb2N0bCA9IHZpZGVvX2lvY3RsMiwKKwkubW1hcCA9
IHpvcmFuX21tYXAsCisJLnBvbGwgPSB6b3Jhbl9wb2xsLAorfTsKKworY29uc3Qgc3RydWN0IHZp
ZGVvX2RldmljZSB6b3Jhbl90ZW1wbGF0ZSA9IHsKKwkubmFtZSA9IFpPUkFOX05BTUUsCisJLmZv
cHMgPSAmem9yYW5fZm9wcywKKwkuaW9jdGxfb3BzID0gJnpvcmFuX2lvY3RsX29wcywKKwkucmVs
ZWFzZSA9ICZ6b3Jhbl92ZGV2X3JlbGVhc2UsCisJLnR2bm9ybXMgPSBWNEwyX1NURF9OVFNDIHwg
VjRMMl9TVERfUEFMIHwgVjRMMl9TVERfU0VDQU0sCit9OworCmRpZmYgLS1naXQgYS9kcml2ZXJz
L3N0YWdpbmcvbWVkaWEvem9yYW4vem9yYW5fcHJvY2ZzLmMgYi9kcml2ZXJzL3N0YWdpbmcvbWVk
aWEvem9yYW4vem9yYW5fcHJvY2ZzLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi43OGFjOGY4NTM3NDgKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcv
bWVkaWEvem9yYW4vem9yYW5fcHJvY2ZzLmMKQEAgLTAsMCArMSwyMjEgQEAKKy8qCisgKiBab3Jh
biB6cjM2MDU3L3pyMzYwNjcgUENJIGNvbnRyb2xsZXIgZHJpdmVyLCBmb3IgdGhlCisgKiBQaW5u
YWNsZS9NaXJvIERDMTAvREMxMCsvREMzMC9EQzMwKywgSW9tZWdhIEJ1eiwgTGludXgKKyAqIE1l
ZGlhIExhYnMgTE1MMzMvTE1MMzNSMTAuCisgKgorICogVGhpcyBwYXJ0IGhhbmRsZXMgdGhlIHBy
b2NGUyBlbnRyaWVzICgvcHJvYy9aT1JBTlslZF0pCisgKgorICogQ29weXJpZ2h0IChDKSAyMDAw
IFNlcmd1ZWkgTWlyaWRvbm92IDxtaXJzZXZAY2ljZXNlLm14PgorICoKKyAqIEN1cnJlbnRseSBt
YWludGFpbmVkIGJ5OgorICogICBSb25hbGQgQnVsdGplICAgIDxyYnVsdGplQHJvbmFsZC5iaXRm
cmVhay5uZXQ+CisgKiAgIExhdXJlbnQgUGluY2hhcnQgPGxhdXJlbnQucGluY2hhcnRAc2t5bmV0
LmJlPgorICogICBNYWlsaW5nbGlzdCAgICAgIDxtanBlZy11c2Vyc0BsaXN0cy5zZi5uZXQ+Cisg
KgorICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRl
IGl0IGFuZC9vciBtb2RpZnkKKyAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiB0aGUgRnJlZSBTb2Z0d2FyZSBG
b3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICogKGF0IHlv
dXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZGlz
dHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqIGJ1dCBXSVRI
T1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisg
KiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBT
ZWUgdGhlCisgKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgor
ICovCisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5o
PgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L3ZtYWxsb2MuaD4K
KworI2luY2x1ZGUgPGxpbnV4L3Byb2NfZnMuaD4KKyNpbmNsdWRlIDxsaW51eC9wY2kuaD4KKyNp
bmNsdWRlIDxsaW51eC9pMmMuaD4KKyNpbmNsdWRlIDxsaW51eC9pMmMtYWxnby1iaXQuaD4KKyNp
bmNsdWRlIDxsaW51eC92aWRlb2RldjIuaD4KKyNpbmNsdWRlIDxsaW51eC9zcGlubG9jay5oPgor
I2luY2x1ZGUgPGxpbnV4L3NlbS5oPgorI2luY2x1ZGUgPGxpbnV4L3NlcV9maWxlLmg+CisKKyNp
bmNsdWRlIDxsaW51eC9jdHlwZS5oPgorI2luY2x1ZGUgPGxpbnV4L3BvbGwuaD4KKyNpbmNsdWRl
IDxhc20vaW8uaD4KKworI2luY2x1ZGUgInZpZGVvY29kZWMuaCIKKyNpbmNsdWRlICJ6b3Jhbi5o
IgorI2luY2x1ZGUgInpvcmFuX3Byb2Nmcy5oIgorI2luY2x1ZGUgInpvcmFuX2NhcmQuaCIKKwor
I2lmZGVmIENPTkZJR19QUk9DX0ZTCitzdHJ1Y3QgcHJvY2ZzX3BhcmFtc196cjM2MDY3IHsKKwlj
aGFyICpuYW1lOworCXNob3J0IHJlZzsKKwl1MzIgbWFzazsKKwlzaG9ydCBiaXQ7Cit9OworCitz
dGF0aWMgY29uc3Qgc3RydWN0IHByb2Nmc19wYXJhbXNfenIzNjA2NyB6cjY3W10gPSB7CisJeyJI
U1BvbCIsIDB4MDAwLCAxLCAzMH0sCisJeyJIU3RhcnQiLCAweDAwMCwgMHgzZmYsIDEwfSwKKwl7
IkhFbmQiLCAweDAwMCwgMHgzZmYsIDB9LAorCisJeyJWU1BvbCIsIDB4MDA0LCAxLCAzMH0sCisJ
eyJWU3RhcnQiLCAweDAwNCwgMHgzZmYsIDEwfSwKKwl7IlZFbmQiLCAweDAwNCwgMHgzZmYsIDB9
LAorCisJeyJFeHRGbCIsIDB4MDA4LCAxLCAyNn0sCisJeyJUb3BGaWVsZCIsIDB4MDA4LCAxLCAy
NX0sCisJeyJWQ0xLUG9sIiwgMHgwMDgsIDEsIDI0fSwKKwl7IkR1cEZsZCIsIDB4MDA4LCAxLCAy
MH0sCisJeyJMaXR0bGVFbmRpYW4iLCAweDAwOCwgMSwgMH0sCisKKwl7IkhzeW5jU3RhcnQiLCAw
eDEwYywgMHhmZmZmLCAxNn0sCisJeyJMaW5lVG90IiwgMHgxMGMsIDB4ZmZmZiwgMH0sCisKKwl7
Ik5BWCIsIDB4MTEwLCAweGZmZmYsIDE2fSwKKwl7IlBBWCIsIDB4MTEwLCAweGZmZmYsIDB9LAor
CisJeyJOQVkiLCAweDExNCwgMHhmZmZmLCAxNn0sCisJeyJQQVkiLCAweDExNCwgMHhmZmZmLCAw
fSwKKworCS8qIHsiIiwsLH0sICovCisKKwl7TlVMTCwgMCwgMCwgMH0sCit9OworCitzdGF0aWMg
dm9pZAorc2V0cGFyYW0gKHN0cnVjdCB6b3JhbiAqenIsCisJICBjaGFyICAgICAgICAgKm5hbWUs
CisJICBjaGFyICAgICAgICAgKnN2YWwpCit7CisJaW50IGkgPSAwLCByZWcwLCByZWcsIHZhbDsK
KworCXdoaWxlICh6cjY3W2ldLm5hbWUgIT0gTlVMTCkgeworCQlpZiAoIXN0cm5jbXAobmFtZSwg
enI2N1tpXS5uYW1lLCBzdHJsZW4oenI2N1tpXS5uYW1lKSkpIHsKKwkJCXJlZyA9IHJlZzAgPSBi
dHJlYWQoenI2N1tpXS5yZWcpOworCQkJcmVnICY9IH4oenI2N1tpXS5tYXNrIDw8IHpyNjdbaV0u
Yml0KTsKKwkJCWlmICghaXNkaWdpdChzdmFsWzBdKSkKKwkJCQlicmVhazsKKwkJCXZhbCA9IHNp
bXBsZV9zdHJ0b3VsKHN2YWwsIE5VTEwsIDApOworCQkJaWYgKCh2YWwgJiB+enI2N1tpXS5tYXNr
KSkKKwkJCQlicmVhazsKKwkJCXJlZyB8PSAodmFsICYgenI2N1tpXS5tYXNrKSA8PCB6cjY3W2ld
LmJpdDsKKwkJCWRwcmludGsoNCwKKwkJCQlLRVJOX0lORk8KKwkJCQkiJXM6IHNldHBhcmFtOiBz
ZXR0aW5nIFpSMzYwNjcgcmVnaXN0ZXIgMHglMDN4OiAweCUwOHg9PjB4JTA4eCAlcz0lZFxuIiwK
KwkJCQlaUl9ERVZOQU1FKHpyKSwgenI2N1tpXS5yZWcsIHJlZzAsIHJlZywKKwkJCQl6cjY3W2ld
Lm5hbWUsIHZhbCk7CisJCQlidHdyaXRlKHJlZywgenI2N1tpXS5yZWcpOworCQkJYnJlYWs7CisJ
CX0KKwkJaSsrOworCX0KK30KKworc3RhdGljIGludCB6b3Jhbl9zaG93KHN0cnVjdCBzZXFfZmls
ZSAqcCwgdm9pZCAqdikKK3sKKwlzdHJ1Y3Qgem9yYW4gKnpyID0gcC0+cHJpdmF0ZTsKKwlpbnQg
aTsKKworCXNlcV9wcmludGYocCwgIlpSMzYwNjcgcmVnaXN0ZXJzOlxuIik7CisJZm9yIChpID0g
MDsgaSA8IDB4MTMwOyBpICs9IDE2KQorCQlzZXFfcHJpbnRmKHAsICIlMDNYICUwOFggICUwOFgg
ICUwOFggICUwOFggXG4iLCBpLAorCQkJICAgYnRyZWFkKGkpLCBidHJlYWQoaSs0KSwgYnRyZWFk
KGkrOCksIGJ0cmVhZChpKzEyKSk7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgem9yYW5f
b3BlbihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkKK3sKKwlzdHJ1Y3Qg
em9yYW4gKmRhdGEgPSBQREVfREFUQShpbm9kZSk7CisJcmV0dXJuIHNpbmdsZV9vcGVuKGZpbGUs
IHpvcmFuX3Nob3csIGRhdGEpOworfQorCitzdGF0aWMgc3NpemVfdCB6b3Jhbl93cml0ZShzdHJ1
Y3QgZmlsZSAqZmlsZSwgY29uc3QgY2hhciBfX3VzZXIgKmJ1ZmZlciwKKwkJCXNpemVfdCBjb3Vu
dCwgbG9mZl90ICpwcG9zKQoreworCXN0cnVjdCB6b3JhbiAqenIgPSBQREVfREFUQShmaWxlX2lu
b2RlKGZpbGUpKTsKKwljaGFyICpzdHJpbmcsICpzcDsKKwljaGFyICpsaW5lLCAqbGRlbGltLCAq
dmFybmFtZSwgKnN2YXIsICp0ZGVsaW07CisKKwlpZiAoY291bnQgPiAzMjc2OCkJLyogU3R1cGlk
aXR5IGZpbHRlciAqLworCQlyZXR1cm4gLUVJTlZBTDsKKworCXN0cmluZyA9IHNwID0gdm1hbGxv
Yyhjb3VudCArIDEpOworCWlmICghc3RyaW5nKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJS
CisJCQkiJXM6IHdyaXRlX3Byb2M6IGNhbiBub3QgYWxsb2NhdGUgbWVtb3J5XG4iLAorCQkJWlJf
REVWTkFNRSh6cikpOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisJaWYgKGNvcHlfZnJvbV91c2Vy
KHN0cmluZywgYnVmZmVyLCBjb3VudCkpIHsKKwkJdmZyZWUgKHN0cmluZyk7CisJCXJldHVybiAt
RUZBVUxUOworCX0KKwlzdHJpbmdbY291bnRdID0gMDsKKwlkcHJpbnRrKDQsIEtFUk5fSU5GTyAi
JXM6IHdyaXRlX3Byb2M6IG5hbWU9JXBEIGNvdW50PSV6dSB6cj0lcFxuIiwKKwkJWlJfREVWTkFN
RSh6ciksIGZpbGUsIGNvdW50LCB6cik7CisJbGRlbGltID0gIiBcdFxuIjsKKwl0ZGVsaW0gPSAi
PSI7CisJbGluZSA9IHN0cnBicmsoc3AsIGxkZWxpbSk7CisJd2hpbGUgKGxpbmUpIHsKKwkJKmxp
bmUgPSAwOworCQlzdmFyID0gc3RycGJyayhzcCwgdGRlbGltKTsKKwkJaWYgKHN2YXIpIHsKKwkJ
CSpzdmFyID0gMDsKKwkJCXZhcm5hbWUgPSBzcDsKKwkJCXN2YXIrKzsKKwkJCXNldHBhcmFtKHpy
LCB2YXJuYW1lLCBzdmFyKTsKKwkJfQorCQlzcCA9IGxpbmUgKyAxOworCQlsaW5lID0gc3RycGJy
ayhzcCwgbGRlbGltKTsKKwl9CisJdmZyZWUoc3RyaW5nKTsKKworCXJldHVybiBjb3VudDsKK30K
Kworc3RhdGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgem9yYW5fb3BlcmF0aW9ucyA9
IHsKKwkub3duZXIJCT0gVEhJU19NT0RVTEUsCisJLm9wZW4JCT0gem9yYW5fb3BlbiwKKwkucmVh
ZAkJPSBzZXFfcmVhZCwKKwkud3JpdGUJCT0gem9yYW5fd3JpdGUsCisJLmxsc2VlawkJPSBzZXFf
bHNlZWssCisJLnJlbGVhc2UJPSBzaW5nbGVfcmVsZWFzZSwKK307CisjZW5kaWYKKworaW50Cit6
b3Jhbl9wcm9jX2luaXQgKHN0cnVjdCB6b3JhbiAqenIpCit7CisjaWZkZWYgQ09ORklHX1BST0Nf
RlMKKwljaGFyIG5hbWVbOF07CisKKwlzbnByaW50ZihuYW1lLCA3LCAiem9yYW4lZCIsIHpyLT5p
ZCk7CisJenItPnpvcmFuX3Byb2MgPSBwcm9jX2NyZWF0ZV9kYXRhKG5hbWUsIDAsIE5VTEwsICZ6
b3Jhbl9vcGVyYXRpb25zLCB6cik7CisJaWYgKHpyLT56b3Jhbl9wcm9jICE9IE5VTEwpIHsKKwkJ
ZHByaW50aygyLAorCQkJS0VSTl9JTkZPCisJCQkiJXM6IHByb2NmcyBlbnRyeSAvcHJvYy8lcyBh
bGxvY2F0ZWQuIGRhdGE9JXBcbiIsCisJCQlaUl9ERVZOQU1FKHpyKSwgbmFtZSwgenIpOworCX0g
ZWxzZSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIgIiVzOiBVbmFibGUgdG8gaW5pdGlhbGlzZSAv
cHJvYy8lc1xuIiwKKwkJCVpSX0RFVk5BTUUoenIpLCBuYW1lKTsKKwkJcmV0dXJuIDE7CisJfQor
I2VuZGlmCisJcmV0dXJuIDA7Cit9CisKK3ZvaWQKK3pvcmFuX3Byb2NfY2xlYW51cCAoc3RydWN0
IHpvcmFuICp6cikKK3sKKyNpZmRlZiBDT05GSUdfUFJPQ19GUworCWNoYXIgbmFtZVs4XTsKKwor
CXNucHJpbnRmKG5hbWUsIDcsICJ6b3JhbiVkIiwgenItPmlkKTsKKwlpZiAoenItPnpvcmFuX3By
b2MpCisJCXJlbW92ZV9wcm9jX2VudHJ5KG5hbWUsIE5VTEwpOworCXpyLT56b3Jhbl9wcm9jID0g
TlVMTDsKKyNlbmRpZgorfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFu
L3pvcmFuX3Byb2Nmcy5oIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX3Byb2Nm
cy5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMGFjN2NiMDAxMWYy
Ci0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pvcmFuX3By
b2Nmcy5oCkBAIC0wLDAgKzEsMzIgQEAKKy8qCisgKiBab3JhbiB6cjM2MDU3L3pyMzYwNjcgUENJ
IGNvbnRyb2xsZXIgZHJpdmVyLCBmb3IgdGhlCisgKiBQaW5uYWNsZS9NaXJvIERDMTAvREMxMCsv
REMzMC9EQzMwKywgSW9tZWdhIEJ1eiwgTGludXgKKyAqIE1lZGlhIExhYnMgTE1MMzMvTE1MMzNS
MTAuCisgKgorICogVGhpcyBwYXJ0IGhhbmRsZXMgY2FyZC1zcGVjaWZpYyBkYXRhIGFuZCBkZXRl
Y3Rpb24KKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMDAgU2VyZ3VlaSBNaXJpZG9ub3YgPG1pcnNl
dkBjaWNlc2UubXg+CisgKgorICogQ3VycmVudGx5IG1haW50YWluZWQgYnk6CisgKiAgIFJvbmFs
ZCBCdWx0amUgICAgPHJidWx0amVAcm9uYWxkLmJpdGZyZWFrLm5ldD4KKyAqICAgTGF1cmVudCBQ
aW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBza3luZXQuYmU+CisgKiAgIE1haWxpbmdsaXN0ICAg
ICAgPG1qcGVnLXVzZXJzQGxpc3RzLnNmLm5ldD4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogaXQg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJs
aXNoZWQgYnkKKyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9u
IDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJz
aW9uLgorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0
IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0
IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRO
RVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqIEdOVSBHZW5lcmFsIFB1
YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKi8KKworI2lmbmRlZiBfX1pPUkFOX1BS
T0NGU19IX18KKyNkZWZpbmUgX19aT1JBTl9QUk9DRlNfSF9fCisKK2V4dGVybiBpbnQgem9yYW5f
cHJvY19pbml0KHN0cnVjdCB6b3JhbiAqenIpOworZXh0ZXJuIHZvaWQgem9yYW5fcHJvY19jbGVh
bnVwKHN0cnVjdCB6b3JhbiAqenIpOworCisjZW5kaWYJCQkJLyogX19aT1JBTl9QUk9DRlNfSF9f
ICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4venIzNjAxNi5jIGIv
ZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pyMzYwMTYuYwpuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwMDAuLjg3MzZiOWQ4ZDk3ZQotLS0gL2Rldi9udWxsCisrKyBiL2Ry
aXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDE2LmMKQEAgLTAsMCArMSw1MTYgQEAKKy8q
CisgKiBab3JhbiBaUjM2MDE2IGJhc2ljIGNvbmZpZ3VyYXRpb24gZnVuY3Rpb25zCisgKgorICog
Q29weXJpZ2h0IChDKSAyMDAxIFdvbGZnYW5nIFNjaGVyciA8c2NoZXJyQG5ldDR5b3UuYXQ+Cisg
KgorICogJElkOiB6cjM2MDE2LmMsdiAxLjEuMi4xNCAyMDAzLzA4LzIwIDE5OjQ2OjU1IHJidWx0
amUgRXhwICQKKyAqCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMg
ZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICog
aXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBw
dWJsaXNoZWQgYnkKKyAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJz
aW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2
ZXJzaW9uLgorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0
aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRo
b3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBG
SVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqIEdOVSBHZW5lcmFs
IFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CisgKi8KKworI2RlZmluZSBaUjAxNl9WRVJTSU9OICJ2MC43IgorCisjaW5jbHVkZSA8bGludXgv
bW9kdWxlLmg+CisjaW5jbHVkZSA8bGludXgvaW5pdC5oPgorI2luY2x1ZGUgPGxpbnV4L3NsYWIu
aD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorCisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4K
KyNpbmNsdWRlIDxsaW51eC93YWl0Lmg+CisKKy8qIEkvTyBjb21tYW5kcywgZXJyb3IgY29kZXMg
Ki8KKyNpbmNsdWRlIDxhc20vaW8uaD4KKworLyogdjRsICBBUEkgKi8KKworLyogaGVhZGVyZmls
ZSBvZiB0aGlzIG1vZHVsZSAqLworI2luY2x1ZGUgInpyMzYwMTYuaCIKKworLyogY29kZWMgaW8g
QVBJICovCisjaW5jbHVkZSAidmlkZW9jb2RlYy5oIgorCisvKiBpdCBkb2Vzbid0IG1ha2Ugc2Vu
c2UgdG8gaGF2ZSBtb3JlIHRoYW4gMjAgb3Igc28sCisgIGp1c3QgdG8gcHJldmVudCBzb21lIHVu
d2FudGVkIGxvb3BzICovCisjZGVmaW5lIE1BWF9DT0RFQ1MgMjAKKworLyogYW1vdW50IG9mIGNo
aXBzIGF0dGFjaGVkIHZpYSB0aGlzIGRyaXZlciAqLworc3RhdGljIGludCB6cjM2MDE2X2NvZGVj
czsKKworLyogZGVidWdnaW5nIGlzIGF2YWlsYWJsZSB2aWEgbW9kdWxlIHBhcmFtZXRlciAqLwor
c3RhdGljIGludCBkZWJ1ZzsKK21vZHVsZV9wYXJhbShkZWJ1ZywgaW50LCAwKTsKK01PRFVMRV9Q
QVJNX0RFU0MoZGVidWcsICJEZWJ1ZyBsZXZlbCAoMC00KSIpOworCisjZGVmaW5lIGRwcmludGso
bnVtLCBmb3JtYXQsIGFyZ3MuLi4pIFwKKwlkbyB7IFwKKwkJaWYgKGRlYnVnID49IG51bSkgXAor
CQkJcHJpbnRrKGZvcm1hdCwgIyNhcmdzKTsgXAorCX0gd2hpbGUgKDApCisKKy8qID09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0KKyAgIExvY2FsIGhhcmR3YXJlIEkvTyBmdW5jdGlvbnM6CisKKyAgIHJlYWQvd3Jp
dGUgdmlhIGNvZGVjIGxheWVyIChyZWdpc3RlcnMgYXJlIGxvY2F0ZWQgaW4gdGhlIG1hc3RlciBk
ZXZpY2UpCisgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCisKKy8qIHJlYWQgYW5kIHdyaXRlIGZ1bmN0
aW9ucyAqLworc3RhdGljIHU4Cit6cjM2MDE2X3JlYWQgKHN0cnVjdCB6cjM2MDE2ICpwdHIsCisJ
ICAgICAgdTE2ICAgICAgICAgICAgIHJlZykKK3sKKwl1OCB2YWx1ZSA9IDA7CisKKwkvLyBqdXN0
IGluIGNhc2Ugc29tZXRoaW5nIGlzIHdyb25nLi4uCisJaWYgKHB0ci0+Y29kZWMtPm1hc3Rlcl9k
YXRhLT5yZWFkcmVnKQorCQl2YWx1ZSA9CisJCSAgICAocHRyLT5jb2RlYy0+bWFzdGVyX2RhdGEt
PgorCQkgICAgIHJlYWRyZWcocHRyLT5jb2RlYywgcmVnKSkgJiAweEZGOworCWVsc2UKKwkJZHBy
aW50aygxLAorCQkJS0VSTl9FUlIgIiVzOiBpbnZhbGlkIEkvTyBzZXR1cCwgbm90aGluZyByZWFk
IVxuIiwKKwkJCXB0ci0+bmFtZSk7CisKKwlkcHJpbnRrKDQsICIlczogcmVhZGluZyBmcm9tIDB4
JTA0eDogJTAyeFxuIiwgcHRyLT5uYW1lLCByZWcsCisJCXZhbHVlKTsKKworCXJldHVybiB2YWx1
ZTsKK30KKworc3RhdGljIHZvaWQKK3pyMzYwMTZfd3JpdGUgKHN0cnVjdCB6cjM2MDE2ICpwdHIs
CisJICAgICAgIHUxNiAgICAgICAgICAgICByZWcsCisJICAgICAgIHU4ICAgICAgICAgICAgICB2
YWx1ZSkKK3sKKwlkcHJpbnRrKDQsICIlczogd3JpdGluZyAweCUwMnggdG8gMHglMDR4XG4iLCBw
dHItPm5hbWUsIHZhbHVlLAorCQlyZWcpOworCisJLy8ganVzdCBpbiBjYXNlIHNvbWV0aGluZyBp
cyB3cm9uZy4uLgorCWlmIChwdHItPmNvZGVjLT5tYXN0ZXJfZGF0YS0+d3JpdGVyZWcpIHsKKwkJ
cHRyLT5jb2RlYy0+bWFzdGVyX2RhdGEtPndyaXRlcmVnKHB0ci0+Y29kZWMsIHJlZywgdmFsdWUp
OworCX0gZWxzZQorCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgorCQkJIiVzOiBpbnZhbGlkIEkv
TyBzZXR1cCwgbm90aGluZyB3cml0dGVuIVxuIiwKKwkJCXB0ci0+bmFtZSk7Cit9CisKKy8qIGlu
ZGlyZWN0IHJlYWQgYW5kIHdyaXRlIGZ1bmN0aW9ucyAqLworLyogdGhlIDAxNiBzdXBwb3J0cyBh
dXRvLWFkZHItaW5jcmVtZW50LCBidXQKKyAqIHdyaXRpbmcgaXQgYWxsIHRpbWUgY29zdCBub3Qg
bXVjaCBhbmQgaXMgc2FmZXIuLi4gKi8KK3N0YXRpYyB1OAorenIzNjAxNl9yZWFkaSAoc3RydWN0
IHpyMzYwMTYgKnB0ciwKKwkgICAgICAgdTE2ICAgICAgICAgICAgIHJlZykKK3sKKwl1OCB2YWx1
ZSA9IDA7CisKKwkvLyBqdXN0IGluIGNhc2Ugc29tZXRoaW5nIGlzIHdyb25nLi4uCisJaWYgKChw
dHItPmNvZGVjLT5tYXN0ZXJfZGF0YS0+d3JpdGVyZWcpICYmCisJICAgIChwdHItPmNvZGVjLT5t
YXN0ZXJfZGF0YS0+cmVhZHJlZykpIHsKKwkJcHRyLT5jb2RlYy0+bWFzdGVyX2RhdGEtPndyaXRl
cmVnKHB0ci0+Y29kZWMsIFpSMDE2X0lBRERSLCByZWcgJiAweDBGKTsJLy8gQUREUgorCQl2YWx1
ZSA9IChwdHItPmNvZGVjLT5tYXN0ZXJfZGF0YS0+cmVhZHJlZyhwdHItPmNvZGVjLCBaUjAxNl9J
REFUQSkpICYgMHhGRjsJLy8gREFUQQorCX0gZWxzZQorCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VS
UgorCQkJIiVzOiBpbnZhbGlkIEkvTyBzZXR1cCwgbm90aGluZyByZWFkIChpKSFcbiIsCisJCQlw
dHItPm5hbWUpOworCisJZHByaW50ayg0LCAiJXM6IHJlYWRpbmcgaW5kaXJlY3QgZnJvbSAweCUw
NHg6ICUwMnhcbiIsIHB0ci0+bmFtZSwKKwkJcmVnLCB2YWx1ZSk7CisJcmV0dXJuIHZhbHVlOwor
fQorCitzdGF0aWMgdm9pZAorenIzNjAxNl93cml0ZWkgKHN0cnVjdCB6cjM2MDE2ICpwdHIsCisJ
CXUxNiAgICAgICAgICAgICByZWcsCisJCXU4ICAgICAgICAgICAgICB2YWx1ZSkKK3sKKwlkcHJp
bnRrKDQsICIlczogd3JpdGluZyBpbmRpcmVjdCAweCUwMnggdG8gMHglMDR4XG4iLCBwdHItPm5h
bWUsCisJCXZhbHVlLCByZWcpOworCisJLy8ganVzdCBpbiBjYXNlIHNvbWV0aGluZyBpcyB3cm9u
Zy4uLgorCWlmIChwdHItPmNvZGVjLT5tYXN0ZXJfZGF0YS0+d3JpdGVyZWcpIHsKKwkJcHRyLT5j
b2RlYy0+bWFzdGVyX2RhdGEtPndyaXRlcmVnKHB0ci0+Y29kZWMsIFpSMDE2X0lBRERSLCByZWcg
JiAweDBGKTsJLy8gQUREUgorCQlwdHItPmNvZGVjLT5tYXN0ZXJfZGF0YS0+d3JpdGVyZWcocHRy
LT5jb2RlYywgWlIwMTZfSURBVEEsIHZhbHVlICYgMHgwRkYpOwkvLyBEQVRBCisJfSBlbHNlCisJ
CWRwcmludGsoMSwKKwkJCUtFUk5fRVJSCisJCQkiJXM6IGludmFsaWQgSS9PIHNldHVwLCBub3Ro
aW5nIHdyaXR0ZW4gKGkpIVxuIiwKKwkJCXB0ci0+bmFtZSk7Cit9CisKKy8qID09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KKyAgIExvY2FsIGhlbHBlciBmdW5jdGlvbjoKKworICAgdmVyc2lvbiByZWFkCisgICA9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ICovCisKKy8qIHZlcnNpb24ga2VwdCBpbiBkYXRhc3RydWN0dXJlICov
CitzdGF0aWMgdTgKK3pyMzYwMTZfcmVhZF92ZXJzaW9uIChzdHJ1Y3QgenIzNjAxNiAqcHRyKQor
eworCXB0ci0+dmVyc2lvbiA9IHpyMzYwMTZfcmVhZChwdHIsIDApID4+IDQ7CisJcmV0dXJuIHB0
ci0+dmVyc2lvbjsKK30KKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorICAgTG9jYWwgaGVscGVyIGZ1
bmN0aW9uOgorCisgICBiYXNpYyB0ZXN0IG9mICJjb25uZWN0aXZpdHkiLCB3cml0ZXMvcmVhZHMg
dG8vZnJvbSBQQVgtTG8gcmVnaXN0ZXIKKyAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKworc3RhdGlj
IGludAorenIzNjAxNl9iYXNpY190ZXN0IChzdHJ1Y3QgenIzNjAxNiAqcHRyKQoreworCWlmIChk
ZWJ1ZykgeworCQlpbnQgaTsKKwkJenIzNjAxNl93cml0ZWkocHRyLCBaUjAxNklfUEFYX0xPLCAw
eDU1KTsKKwkJZHByaW50aygxLCBLRVJOX0lORk8gIiVzOiByZWdpc3RlcnM6ICIsIHB0ci0+bmFt
ZSk7CisJCWZvciAoaSA9IDA7IGkgPD0gMHgwYjsgaSsrKQorCQkJZHByaW50aygxLCAiJTAyeCAi
LCB6cjM2MDE2X3JlYWRpKHB0ciwgaSkpOworCQlkcHJpbnRrKDEsICJcbiIpOworCX0KKwkvLyBm
b3IgdGVzdGluZyBqdXN0IHdyaXRlIDAsIHRoZW4gdGhlIGRlZmF1bHQgdmFsdWUgdG8gYSByZWdp
c3RlciBhbmQgcmVhZAorCS8vIGl0IGJhY2sgaW4gYm90aCBjYXNlcworCXpyMzYwMTZfd3JpdGVp
KHB0ciwgWlIwMTZJX1BBWF9MTywgMHgwMCk7CisJaWYgKHpyMzYwMTZfcmVhZGkocHRyLCBaUjAx
NklfUEFYX0xPKSAhPSAweDApIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczog
YXR0YWNoIGZhaWxlZCwgY2FuJ3QgY29ubmVjdCB0byB2ZmUgcHJvY2Vzc29yIVxuIiwKKwkJCXB0
ci0+bmFtZSk7CisJCXJldHVybiAtRU5YSU87CisJfQorCXpyMzYwMTZfd3JpdGVpKHB0ciwgWlIw
MTZJX1BBWF9MTywgMHgwZDApOworCWlmICh6cjM2MDE2X3JlYWRpKHB0ciwgWlIwMTZJX1BBWF9M
TykgIT0gMHgwZDApIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIlczogYXR0YWNo
IGZhaWxlZCwgY2FuJ3QgY29ubmVjdCB0byB2ZmUgcHJvY2Vzc29yIVxuIiwKKwkJCXB0ci0+bmFt
ZSk7CisJCXJldHVybiAtRU5YSU87CisJfQorCS8vIHdlIGFsbG93IHZlcnNpb24gbnVtYmVycyBm
cm9tIDAtMywgc2hvdWxkIGJlIGVub3VnaCwgdGhvdWdoCisJenIzNjAxNl9yZWFkX3ZlcnNpb24o
cHRyKTsKKwlpZiAocHRyLT52ZXJzaW9uICYgMHgwYykgeworCQlkcHJpbnRrKDEsCisJCQlLRVJO
X0VSUgorCQkJIiVzOiBhdHRhY2ggZmFpbGVkLCBzdXNwaWNpb3VzIHZlcnNpb24gJWQgZm91bmQu
Li5cbiIsCisJCQlwdHItPm5hbWUsIHB0ci0+dmVyc2lvbik7CisJCXJldHVybiAtRU5YSU87CisJ
fQorCisJcmV0dXJuIDA7CQkvKiBsb29rcyBnb29kISAqLworfQorCisvKiA9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09CisgICBMb2NhbCBoZWxwZXIgZnVuY3Rpb246CisKKyAgIHNpbXBsZSBsb29wIGZvciBwdXNo
aW5nIHRoZSBpbml0IGRhdGFzZXRzIC0gTk8gVVNFIC0tCisgICA9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICov
CisKKyNpZiAwCitzdGF0aWMgaW50IHpyMzYwMTZfcHVzaGl0IChzdHJ1Y3QgenIzNjAxNiAqcHRy
LAorCQkJICAgdTE2ICAgICAgICAgICAgIHN0YXJ0cmVnLAorCQkJICAgdTE2ICAgICAgICAgICAg
IGxlbiwKKwkJCSAgIGNvbnN0IGNoYXIgICAgICpkYXRhKQoreworCWludCBpPTA7CisKKwlkcHJp
bnRrKDQsICIlczogd3JpdGUgZGF0YSBibG9jayB0byAweCUwNHggKGxlbj0lZClcbiIsCisJCXB0
ci0+bmFtZSwgc3RhcnRyZWcsbGVuKTsKKwl3aGlsZSAoaTxsZW4pIHsKKwkJenIzNjAxNl93cml0
ZWkocHRyLCBzdGFydHJlZysrLCAgZGF0YVtpKytdKTsKKwl9CisKKwlyZXR1cm4gaTsKK30KKyNl
bmRpZgorCisvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09CisgICBCYXNpYyBkYXRhc2V0cyAmIGluaXQ6CisK
KyAgIC8vVE9ETy8vCisgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCisKK3N0YXRpYyB2b2lkCit6cjM2
MDE2X2luaXQgKHN0cnVjdCB6cjM2MDE2ICpwdHIpCit7CisJLy8gc3RvcCBhbnkgcHJvY2Vzc2lu
ZworCXpyMzYwMTZfd3JpdGUocHRyLCBaUjAxNl9HT1NUT1AsIDApOworCisJLy8gbW9kZSBzZXR1
cCAoeXV2NDIyIGluIGFuZCBvdXQsIGNvbXByZXNzaW9uL2V4cGFuc3VvbiBkdWUgdG8gbW9kZSkK
Kwl6cjM2MDE2X3dyaXRlKHB0ciwgWlIwMTZfTU9ERSwKKwkJICAgICAgWlIwMTZfWVVWNDIyIHwg
WlIwMTZfWVVWNDIyX1lVVjQyMiB8CisJCSAgICAgIChwdHItPm1vZGUgPT0gQ09ERUNfRE9fQ09N
UFJFU1NJT04gPworCQkgICAgICAgWlIwMTZfQ09NUFJFU1NJT04gOiBaUjAxNl9FWFBBTlNJT04p
KTsKKworCS8vIG1pc2Mgc2V0dXAKKwl6cjM2MDE2X3dyaXRlaShwdHIsIFpSMDE2SV9TRVRVUDEs
CisJCSAgICAgICAocHRyLT54ZGVjID8gKFpSMDE2X0hSRkwgfCBaUjAxNl9IT1JaKSA6IDApIHwK
KwkJICAgICAgIChwdHItPnlkZWMgPyBaUjAxNl9WRVJUIDogMCkgfCBaUjAxNl9DTlRJKTsKKwl6
cjM2MDE2X3dyaXRlaShwdHIsIFpSMDE2SV9TRVRVUDIsIFpSMDE2X0NDSVIpOworCisJLy8gV2lu
ZG93IHNldHVwCisJLy8gKG5vIGV4dHJhIG9mZnNldCBmb3Igbm93LCBub3JtIGRlZmluZXMgb2Zm
c2V0LCBkZWZhdWx0IHdpZHRoIGhlaWdodCkKKwl6cjM2MDE2X3dyaXRlaShwdHIsIFpSMDE2SV9Q
QVhfSEksIHB0ci0+d2lkdGggPj4gOCk7CisJenIzNjAxNl93cml0ZWkocHRyLCBaUjAxNklfUEFY
X0xPLCBwdHItPndpZHRoICYgMHhGRik7CisJenIzNjAxNl93cml0ZWkocHRyLCBaUjAxNklfUEFZ
X0hJLCBwdHItPmhlaWdodCA+PiA4KTsKKwl6cjM2MDE2X3dyaXRlaShwdHIsIFpSMDE2SV9QQVlf
TE8sIHB0ci0+aGVpZ2h0ICYgMHhGRik7CisJenIzNjAxNl93cml0ZWkocHRyLCBaUjAxNklfTkFY
X0hJLCBwdHItPnhvZmYgPj4gOCk7CisJenIzNjAxNl93cml0ZWkocHRyLCBaUjAxNklfTkFYX0xP
LCBwdHItPnhvZmYgJiAweEZGKTsKKwl6cjM2MDE2X3dyaXRlaShwdHIsIFpSMDE2SV9OQVlfSEks
IHB0ci0+eW9mZiA+PiA4KTsKKwl6cjM2MDE2X3dyaXRlaShwdHIsIFpSMDE2SV9OQVlfTE8sIHB0
ci0+eW9mZiAmIDB4RkYpOworCisJLyogc2hhbGwgd2UgY29udGludWUgbm93LCBwbGVhc2U/ICov
CisJenIzNjAxNl93cml0ZShwdHIsIFpSMDE2X0dPU1RPUCwgMSk7Cit9CisKKy8qID09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0KKyAgIENPREVDIEFQSSBGVU5DVElPTlMKKworICAgdGhpcyBmdW5jdGlvbnMgYXJl
IGFjY2Vzc2VkIGJ5IHRoZSBtYXN0ZXIgdmlhIHRoZSBBUEkgc3RydWN0dXJlCisgICA9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ICovCisKKy8qIHNldCBjb21wcmVzc2lvbi9leHBhbnNpb24gbW9kZSBhbmQgbGF1
bmNoZXMgY29kZWMgLQorICAgdGhpcyBzaG91bGQgYmUgdGhlIGxhc3QgY2FsbCBmcm9tIHRoZSBt
YXN0ZXIgYmVmb3JlIHN0YXJ0aW5nIHByb2Nlc3NpbmcgKi8KK3N0YXRpYyBpbnQKK3pyMzYwMTZf
c2V0X21vZGUgKHN0cnVjdCB2aWRlb2NvZGVjICpjb2RlYywKKwkJICBpbnQgICAgICAgICAgICAg
ICAgbW9kZSkKK3sKKwlzdHJ1Y3QgenIzNjAxNiAqcHRyID0gKHN0cnVjdCB6cjM2MDE2ICopIGNv
ZGVjLT5kYXRhOworCisJZHByaW50aygyLCAiJXM6IHNldF9tb2RlICVkIGNhbGxcbiIsIHB0ci0+
bmFtZSwgbW9kZSk7CisKKwlpZiAoKG1vZGUgIT0gQ09ERUNfRE9fRVhQQU5TSU9OKSAmJiAobW9k
ZSAhPSBDT0RFQ19ET19DT01QUkVTU0lPTikpCisJCXJldHVybiAtRUlOVkFMOworCisJcHRyLT5t
b2RlID0gbW9kZTsKKwl6cjM2MDE2X2luaXQocHRyKTsKKworCXJldHVybiAwOworfQorCisvKiBz
ZXQgcGljdHVyZSBzaXplICovCitzdGF0aWMgaW50Cit6cjM2MDE2X3NldF92aWRlbyAoc3RydWN0
IHZpZGVvY29kZWMgICAqY29kZWMsCisJCSAgIHN0cnVjdCB0dm5vcm0gICAgICAgKm5vcm0sCisJ
CSAgIHN0cnVjdCB2ZmVfc2V0dGluZ3MgKmNhcCwKKwkJICAgc3RydWN0IHZmZV9wb2xhcml0eSAq
cG9sKQoreworCXN0cnVjdCB6cjM2MDE2ICpwdHIgPSAoc3RydWN0IHpyMzYwMTYgKikgY29kZWMt
PmRhdGE7CisKKwlkcHJpbnRrKDIsICIlczogc2V0X3ZpZGVvICVkLiVkLCAlZC8lZC0lZHglZCAo
MHgleCkgY2FsbFxuIiwKKwkJcHRyLT5uYW1lLCBub3JtLT5IU3RhcnQsIG5vcm0tPlZTdGFydCwK
KwkJY2FwLT54LCBjYXAtPnksIGNhcC0+d2lkdGgsIGNhcC0+aGVpZ2h0LAorCQljYXAtPmRlY2lt
YXRpb24pOworCisJLyogaWYgKCkgcmV0dXJuIC1FSU5WQUw7CisJICogdHJ1c3QgdGhlIG1hc3Rl
ciBkcml2ZXIgdGhhdCBpdCBrbm93cyB3aGF0IGl0IGRvZXMgLSBzbworCSAqIHdlIGFsbG93IGlu
dmFsaWQgc3RhcnR4L3kgZm9yIG5vdyAuLi4gKi8KKwlwdHItPndpZHRoID0gY2FwLT53aWR0aDsK
KwlwdHItPmhlaWdodCA9IGNhcC0+aGVpZ2h0OworCS8qIChSb25hbGQpIFRoaXMgaXMgdWdseS4g
em9yYW5fZGV2aWNlLmMsIGxpbmUgMzg3CisJICogYWxyZWFkeSBtZW50aW9ucyB3aGF0IGhhcHBl
bnMgaWYgSFN0YXJ0IGlzIGV2ZW4KKwkgKiAoYmx1ZSBmYWNlcywgZXRjLiwgY3IvY2IgaW52ZXJz
ZWQpLiBUaGVyZSdzIHByb2JhYmx5CisJICogc29tZSBnb29kIHJlYXNvbiB3aHkgSFN0YXJ0IGlz
IDAgaW5zdGVhZCBvZiAxLCBzbyBJJ20KKwkgKiBsZWF2aW5nIGl0IHRvIHRoaXMgZm9yIG5vdywg
YnV0IHJlYWxseS4uLiBUaGlzIGNhbiBiZQorCSAqIGRvbmUgYSBsb3Qgc2ltcGxlciAqLworCXB0
ci0+eG9mZiA9IChub3JtLT5IU3RhcnQgPyBub3JtLT5IU3RhcnQgOiAxKSArIGNhcC0+eDsKKwkv
KiBTb21ldGhpbmcgdG8gbm90ZSBoZXJlIChJIGRvbid0IHVuZGVyc3RhbmQgaXQpLCBzZXR0aW5n
CisJICogVlN0YXJ0IHRvbyBoaWdoIHdpbGwgY2F1c2UgdGhlIGNvZGVjIHRvICdub3Qgd29yaycu
IEkKKwkgKiByZWFsbHkgZG9uJ3QgZ2V0IGl0LiB2YWx1ZXMgb2YgMTYgKFZTdGFydCkgYWxyZWFk
eSBicmVhaworCSAqIGl0IGhlcmUuIEp1c3QgJzAnIHNlZW1zIHRvIHdvcmsuIE1vcmUgdGVzdGlu
ZyBuZWVkZWQhICovCisJcHRyLT55b2ZmID0gbm9ybS0+VlN0YXJ0ICsgY2FwLT55OworCS8qIChS
b25hbGQpIGR6amVlaCwgY2FuJ3QgdGhpcyB0aGluZyBkbyBob3JfZGVjaW1hdGlvbiA9IDQ/ICov
CisJcHRyLT54ZGVjID0gKChjYXAtPmRlY2ltYXRpb24gJiAweGZmKSA9PSAxKSA/IDAgOiAxOwor
CXB0ci0+eWRlYyA9ICgoKGNhcC0+ZGVjaW1hdGlvbiA+PiA4KSAmIDB4ZmYpID09IDEpID8gMCA6
IDE7CisKKwlyZXR1cm4gMDsKK30KKworLyogYWRkaXRpb25hbCBjb250cm9sIGZ1bmN0aW9ucyAq
Lworc3RhdGljIGludAorenIzNjAxNl9jb250cm9sIChzdHJ1Y3QgdmlkZW9jb2RlYyAqY29kZWMs
CisJCSBpbnQgICAgICAgICAgICAgICAgdHlwZSwKKwkJIGludCAgICAgICAgICAgICAgICBzaXpl
LAorCQkgdm9pZCAgICAgICAgICAgICAgKmRhdGEpCit7CisJc3RydWN0IHpyMzYwMTYgKnB0ciA9
IChzdHJ1Y3QgenIzNjAxNiAqKSBjb2RlYy0+ZGF0YTsKKwlpbnQgKml2YWwgPSAoaW50ICopIGRh
dGE7CisKKwlkcHJpbnRrKDIsICIlczogY29udHJvbCAlZCBjYWxsIHdpdGggJWQgYnl0ZVxuIiwg
cHRyLT5uYW1lLCB0eXBlLAorCQlzaXplKTsKKworCXN3aXRjaCAodHlwZSkgeworCWNhc2UgQ09E
RUNfR19TVEFUVVM6CS8qIGdldCBsYXN0IHN0YXR1cyAtIHdlIGRvbid0IGtub3cgaXQgLi4uICov
CisJCWlmIChzaXplICE9IHNpemVvZihpbnQpKQorCQkJcmV0dXJuIC1FRkFVTFQ7CisJCSppdmFs
ID0gMDsKKwkJYnJlYWs7CisKKwljYXNlIENPREVDX0dfQ09ERUNfTU9ERToKKwkJaWYgKHNpemUg
IT0gc2l6ZW9mKGludCkpCisJCQlyZXR1cm4gLUVGQVVMVDsKKwkJKml2YWwgPSAwOworCQlicmVh
azsKKworCWNhc2UgQ09ERUNfU19DT0RFQ19NT0RFOgorCQlpZiAoc2l6ZSAhPSBzaXplb2YoaW50
KSkKKwkJCXJldHVybiAtRUZBVUxUOworCQlpZiAoKml2YWwgIT0gMCkKKwkJCXJldHVybiAtRUlO
VkFMOworCQkvKiBub3QgbmVlZGVkLCBkbyBub3RoaW5nICovCisJCXJldHVybiAwOworCisJY2Fz
ZSBDT0RFQ19HX1ZGRToKKwljYXNlIENPREVDX1NfVkZFOgorCQlyZXR1cm4gMDsKKworCWNhc2Ug
Q09ERUNfU19NTUFQOgorCQkvKiBub3QgYXZhaWxhYmxlLCBnaXZlIGFuIGVycm9yICovCisJCXJl
dHVybiAtRU5YSU87CisKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlyZXR1
cm4gc2l6ZTsKK30KKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorICAgRXhpdCBhbmQgdW5yZWdpc3Rl
ciBmdW5jdGlvbjoKKworICAgRGVpbml0aWFsaXplcyBab3JhbidzIEpQRUcgcHJvY2Vzc29yCisg
ICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ICovCisKK3N0YXRpYyBpbnQKK3pyMzYwMTZfdW5zZXQgKHN0cnVj
dCB2aWRlb2NvZGVjICpjb2RlYykKK3sKKwlzdHJ1Y3QgenIzNjAxNiAqcHRyID0gY29kZWMtPmRh
dGE7CisKKwlpZiAocHRyKSB7CisJCS8qIGRvIHdlZSBuZWVkIHNvbWUgY29kZWMgZGVpbml0IGhl
cmUsIHRvbyA/Pz8/ICovCisKKwkJZHByaW50aygxLCAiJXM6IGZpbmlzaGVkIGNvZGVjICMlZFxu
IiwgcHRyLT5uYW1lLAorCQkJcHRyLT5udW0pOworCQlrZnJlZShwdHIpOworCQljb2RlYy0+ZGF0
YSA9IE5VTEw7CisKKwkJenIzNjAxNl9jb2RlY3MtLTsKKwkJcmV0dXJuIDA7CisJfQorCisJcmV0
dXJuIC1FRkFVTFQ7Cit9CisKKy8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKyAgIFNldHVwIGFuZCByZWdp
c3RyeSBmdW5jdGlvbjoKKworICAgSW5pdGlhbGl6ZXMgWm9yYW4ncyBKUEVHIHByb2Nlc3Nvcgor
CisgICBBbHNvIHNldHMgcGl4ZWwgc2l6ZSwgYXZlcmFnZSBjb2RlIHNpemUsIG1vZGUgKGNvbXBy
Li9kZWNvbXByLikKKyAgICh0aGUgZ2l2ZW4gc2l6ZSBpcyBkZXRlcm1pbmVkIGJ5IHRoZSBwcm9j
ZXNzb3Igd2l0aCB0aGUgdmlkZW8gaW50ZXJmYWNlKQorICAgPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwor
CitzdGF0aWMgaW50Cit6cjM2MDE2X3NldHVwIChzdHJ1Y3QgdmlkZW9jb2RlYyAqY29kZWMpCit7
CisJc3RydWN0IHpyMzYwMTYgKnB0cjsKKwlpbnQgcmVzOworCisJZHByaW50aygyLCAienIzNjAx
NjogaW5pdGlhbGl6aW5nIFZGRSBzdWJzeXN0ZW0gIyVkLlxuIiwKKwkJenIzNjAxNl9jb2RlY3Mp
OworCisJaWYgKHpyMzYwMTZfY29kZWNzID09IE1BWF9DT0RFQ1MpIHsKKwkJZHByaW50aygxLAor
CQkJS0VSTl9FUlIgInpyMzYwMTY6IENhbid0IGF0dGFjaCBtb3JlIGNvZGVjcyFcbiIpOworCQly
ZXR1cm4gLUVOT1NQQzsKKwl9CisJLy9tZW0gc3RydWN0dXJlIGluaXQKKwljb2RlYy0+ZGF0YSA9
IHB0ciA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCB6cjM2MDE2KSwgR0ZQX0tFUk5FTCk7CisJaWYg
KE5VTEwgPT0gcHRyKSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIgInpyMzYwMTY6IENhbid0IGdl
dCBlbm91Z2ggbWVtb3J5IVxuIik7CisJCXJldHVybiAtRU5PTUVNOworCX0KKworCXNucHJpbnRm
KHB0ci0+bmFtZSwgc2l6ZW9mKHB0ci0+bmFtZSksICJ6cjM2MDE2WyVkXSIsCisJCSB6cjM2MDE2
X2NvZGVjcyk7CisJcHRyLT5udW0gPSB6cjM2MDE2X2NvZGVjcysrOworCXB0ci0+Y29kZWMgPSBj
b2RlYzsKKworCS8vdGVzdGluZworCXJlcyA9IHpyMzYwMTZfYmFzaWNfdGVzdChwdHIpOworCWlm
IChyZXMgPCAwKSB7CisJCXpyMzYwMTZfdW5zZXQoY29kZWMpOworCQlyZXR1cm4gcmVzOworCX0K
KwkvL2ZpbmFsIHNldHVwCisJcHRyLT5tb2RlID0gQ09ERUNfRE9fQ09NUFJFU1NJT047CisJcHRy
LT53aWR0aCA9IDc2ODsKKwlwdHItPmhlaWdodCA9IDI4ODsKKwlwdHItPnhkZWMgPSAxOworCXB0
ci0+eWRlYyA9IDA7CisJenIzNjAxNl9pbml0KHB0cik7CisKKwlkcHJpbnRrKDEsIEtFUk5fSU5G
TyAiJXM6IGNvZGVjIHYlZCBhdHRhY2hlZCBhbmQgcnVubmluZ1xuIiwKKwkJcHRyLT5uYW1lLCBw
dHItPnZlcnNpb24pOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgdmlk
ZW9jb2RlYyB6cjM2MDE2X2NvZGVjID0geworCS5vd25lciA9IFRISVNfTU9EVUxFLAorCS5uYW1l
ID0gInpyMzYwMTYiLAorCS5tYWdpYyA9IDBMLAkJLy8gbWFnaWMgbm90IHVzZWQKKwkuZmxhZ3Mg
PQorCSAgICBDT0RFQ19GTEFHX0hBUkRXQVJFIHwgQ09ERUNfRkxBR19WRkUgfCBDT0RFQ19GTEFH
X0VOQ09ERVIgfAorCSAgICBDT0RFQ19GTEFHX0RFQ09ERVIsCisJLnR5cGUgPSBDT0RFQ19UWVBF
X1pSMzYwMTYsCisJLnNldHVwID0genIzNjAxNl9zZXR1cCwJLy8gZnVuY3Rpb25hbGl0eQorCS51
bnNldCA9IHpyMzYwMTZfdW5zZXQsCisJLnNldF9tb2RlID0genIzNjAxNl9zZXRfbW9kZSwKKwku
c2V0X3ZpZGVvID0genIzNjAxNl9zZXRfdmlkZW8sCisJLmNvbnRyb2wgPSB6cjM2MDE2X2NvbnRy
b2wsCisJLy8gb3RoZXJzIGFyZSBub3QgdXNlZAorfTsKKworLyogPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQor
ICAgSE9PSyBJTiBEUklWRVIgQVMgS0VSTkVMIE1PRFVMRQorICAgPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAq
LworCitzdGF0aWMgaW50IF9faW5pdAorenIzNjAxNl9pbml0X21vZHVsZSAodm9pZCkKK3sKKwkv
L2RwcmludGsoMSwgIlpSMzYwMTYgZHJpdmVyICVzXG4iLFpSMDE2X1ZFUlNJT04pOworCXpyMzYw
MTZfY29kZWNzID0gMDsKKwlyZXR1cm4gdmlkZW9jb2RlY19yZWdpc3RlcigmenIzNjAxNl9jb2Rl
Yyk7Cit9CisKK3N0YXRpYyB2b2lkIF9fZXhpdAorenIzNjAxNl9jbGVhbnVwX21vZHVsZSAodm9p
ZCkKK3sKKwlpZiAoenIzNjAxNl9jb2RlY3MpIHsKKwkJZHByaW50aygxLAorCQkJInpyMzYwMTY6
IHNvbWV0aGluZydzIHdyb25nIC0gJWQgY29kZWNzIGxlZnQgc29tZWhvdy5cbiIsCisJCQl6cjM2
MDE2X2NvZGVjcyk7CisJfQorCXZpZGVvY29kZWNfdW5yZWdpc3RlcigmenIzNjAxNl9jb2RlYyk7
Cit9CisKK21vZHVsZV9pbml0KHpyMzYwMTZfaW5pdF9tb2R1bGUpOworbW9kdWxlX2V4aXQoenIz
NjAxNl9jbGVhbnVwX21vZHVsZSk7CisKK01PRFVMRV9BVVRIT1IoIldvbGZnYW5nIFNjaGVyciA8
c2NoZXJyQG5ldDR5b3UuYXQ+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIkRyaXZlciBtb2R1bGUg
Zm9yIFpSMzYwMTYgdmlkZW8gZnJvbnRlbmRzICIKKwkJICAgWlIwMTZfVkVSU0lPTik7CitNT0RV
TEVfTElDRU5TRSgiR1BMIik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9y
YW4venIzNjAxNi5oIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pyMzYwMTYuaApuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjc4NGJjZjU3MjdiOAotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDE2LmgKQEAgLTAs
MCArMSwxMDcgQEAKKy8qCisgKiBab3JhbiBaUjM2MDE2IGJhc2ljIGNvbmZpZ3VyYXRpb24gZnVu
Y3Rpb25zIC0gaGVhZGVyIGZpbGUKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMDEgV29sZmdhbmcg
U2NoZXJyIDxzY2hlcnJAbmV0NHlvdS5hdD4KKyAqCisgKiAkSWQ6IHpyMzYwMTYuaCx2IDEuMS4y
LjMgMjAwMy8wMS8xNCAyMToxODowNyByYnVsdGplIEV4cCAkCisgKgorICogLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tCisgKgorICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKKyAqIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5CisgKiB0aGUgRnJlZSBTb2Z0
d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvcgorICog
KGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KKyAqCisgKiBUaGlzIHByb2dyYW0g
aXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqIGJ1
dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5
IG9mCisgKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBP
U0UuICBTZWUgdGhlCisgKiBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRh
aWxzLgorICoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICovCisKKyNpZm5kZWYgWlIzNjAxNl9ICisj
ZGVmaW5lIFpSMzYwMTZfSAorCisvKiBkYXRhIHN0b3JlZCBmb3IgZWFjaCB6b3JhbiBqcGVnIGNv
ZGVjIGNoaXAgKi8KK3N0cnVjdCB6cjM2MDE2IHsKKwljaGFyIG5hbWVbMzJdOworCWludCBudW07
CisJLyogaW8gZGF0YXN0cnVjdHVyZSAqLworCXN0cnVjdCB2aWRlb2NvZGVjICpjb2RlYzsKKwkv
LyBjb2RlciBzdGF0dXMKKwlfX3U4IHZlcnNpb247CisJLy8gYWN0dWFsIGNvZGVyIHNldHVwCisJ
aW50IG1vZGU7CisKKwlfX3UxNiB4b2ZmOworCV9fdTE2IHlvZmY7CisJX191MTYgd2lkdGg7CisJ
X191MTYgaGVpZ2h0OworCV9fdTE2IHhkZWM7CisJX191MTYgeWRlYzsKK307CisKKy8qIGRpcmVj
dCAgcmVnaXN0ZXIgYWRkcmVzc2VzICovCisjZGVmaW5lIFpSMDE2X0dPU1RPUCAgICAgIDB4MDAK
KyNkZWZpbmUgWlIwMTZfTU9ERSAgICAgICAgMHgwMQorI2RlZmluZSBaUjAxNl9JQUREUiAgICAg
ICAweDAyCisjZGVmaW5lIFpSMDE2X0lEQVRBICAgICAgIDB4MDMKKworLyogaW5kaXJlY3QgIHJl
Z2lzdGVyIGFkZHJlc3NlcyAqLworI2RlZmluZSBaUjAxNklfU0VUVVAxICAgICAweDAwCisjZGVm
aW5lIFpSMDE2SV9TRVRVUDIgICAgIDB4MDEKKyNkZWZpbmUgWlIwMTZJX05BWF9MTyAgICAgMHgw
MgorI2RlZmluZSBaUjAxNklfTkFYX0hJICAgICAweDAzCisjZGVmaW5lIFpSMDE2SV9QQVhfTE8g
ICAgIDB4MDQKKyNkZWZpbmUgWlIwMTZJX1BBWF9ISSAgICAgMHgwNQorI2RlZmluZSBaUjAxNklf
TkFZX0xPICAgICAweDA2CisjZGVmaW5lIFpSMDE2SV9OQVlfSEkgICAgIDB4MDcKKyNkZWZpbmUg
WlIwMTZJX1BBWV9MTyAgICAgMHgwOAorI2RlZmluZSBaUjAxNklfUEFZX0hJICAgICAweDA5Cisj
ZGVmaW5lIFpSMDE2SV9OT0xfTE8gICAgIDB4MGEKKyNkZWZpbmUgWlIwMTZJX05PTF9ISSAgICAg
MHgwYgorCisvKiBwb3NzaWJsZSB2YWx1ZXMgZm9yIG1vZGUgcmVnaXN0ZXIgKi8KKyNkZWZpbmUg
WlIwMTZfUkdCNDQ0X1lVVjQ0NCAgMHgwMAorI2RlZmluZSBaUjAxNl9SR0I0NDRfWVVWNDIyICAw
eDAxCisjZGVmaW5lIFpSMDE2X1JHQjQ0NF9ZVVY0MTEgIDB4MDIKKyNkZWZpbmUgWlIwMTZfUkdC
NDQ0X1k0MDAgICAgMHgwMworI2RlZmluZSBaUjAxNl9SR0I0NDRfUkdCNDQ0ICAweDA0CisjZGVm
aW5lIFpSMDE2X1lVVjQ0NF9ZVVY0NDQgIDB4MDgKKyNkZWZpbmUgWlIwMTZfWVVWNDQ0X1lVVjQy
MiAgMHgwOQorI2RlZmluZSBaUjAxNl9ZVVY0NDRfWVVWNDExICAweDBhCisjZGVmaW5lIFpSMDE2
X1lVVjQ0NF9ZNDAwICAgIDB4MGIKKyNkZWZpbmUgWlIwMTZfWVVWNDQ0X1JHQjQ0NCAgMHgwYwor
I2RlZmluZSBaUjAxNl9ZVVY0MjJfWVVWNDIyICAweDExCisjZGVmaW5lIFpSMDE2X1lVVjQyMl9Z
VVY0MTEgIDB4MTIKKyNkZWZpbmUgWlIwMTZfWVVWNDIyX1k0MDAgICAgMHgxMworI2RlZmluZSBa
UjAxNl9ZVVY0MTFfWVVWNDExICAweDE2CisjZGVmaW5lIFpSMDE2X1lVVjQxMV9ZNDAwICAgIDB4
MTcKKyNkZWZpbmUgWlIwMTZfNDQ0NF80NDQ0ICAgICAgMHgxOQorI2RlZmluZSBaUjAxNl8xMDBf
MTAwICAgICAgICAweDFiCisKKyNkZWZpbmUgWlIwMTZfUkdCNDQ0ICAgICAgICAgMHgwMAorI2Rl
ZmluZSBaUjAxNl9ZVVY0NDQgICAgICAgICAweDIwCisjZGVmaW5lIFpSMDE2X1lVVjQyMiAgICAg
ICAgIDB4NDAKKworI2RlZmluZSBaUjAxNl9DT01QUkVTU0lPTiAgICAweDgwCisjZGVmaW5lIFpS
MDE2X0VYUEFOU0lPTiAgICAgIDB4ODAKKworLyogcG9zc2libGUgdmFsdWVzIGZvciBzZXR1cCAx
IHJlZ2lzdGVyICovCisjZGVmaW5lIFpSMDE2X0NLUlQgICAgICAgICAgIDB4ODAKKyNkZWZpbmUg
WlIwMTZfVkVSVCAgICAgICAgICAgMHg0MAorI2RlZmluZSBaUjAxNl9IT1JaICAgICAgICAgICAw
eDIwCisjZGVmaW5lIFpSMDE2X0hSRkwgICAgICAgICAgIDB4MTAKKyNkZWZpbmUgWlIwMTZfRFNG
TCAgICAgICAgICAgMHgwOAorI2RlZmluZSBaUjAxNl9TQkZMICAgICAgICAgICAweDA0CisjZGVm
aW5lIFpSMDE2X1JTVFIgICAgICAgICAgIDB4MDIKKyNkZWZpbmUgWlIwMTZfQ05USSAgICAgICAg
ICAgMHgwMQorCisvKiBwb3NzaWJsZSB2YWx1ZXMgZm9yIHNldHVwIDIgcmVnaXN0ZXIgKi8KKyNk
ZWZpbmUgWlIwMTZfU1lFTiAgICAgICAgICAgMHg0MAorI2RlZmluZSBaUjAxNl9DQ0lSICAgICAg
ICAgICAweDA0CisjZGVmaW5lIFpSMDE2X1NJR04gICAgICAgICAgIDB4MDIKKyNkZWZpbmUgWlIw
MTZfWU1DUyAgICAgICAgICAgMHgwMQorCisjZW5kaWYJCQkJLypmbmRlZiBaUjM2MDE2X0ggKi8K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDUwLmMgYi9kcml2
ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4venIzNjA1MC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwMDAwMC4uNWViZmMxNjY3MmYzCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVy
cy9zdGFnaW5nL21lZGlhL3pvcmFuL3pyMzYwNTAuYwpAQCAtMCwwICsxLDg5NiBAQAorLyoKKyAq
IFpvcmFuIFpSMzYwNTAgYmFzaWMgY29uZmlndXJhdGlvbiBmdW5jdGlvbnMKKyAqCisgKiBDb3B5
cmlnaHQgKEMpIDIwMDEgV29sZmdhbmcgU2NoZXJyIDxzY2hlcnJAbmV0NHlvdS5hdD4KKyAqCisg
KiAkSWQ6IHpyMzYwNTAuYyx2IDEuMS4yLjExIDIwMDMvMDgvMDMgMTQ6NTQ6NTMgcmJ1bHRqZSBF
eHAgJAorICoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVl
IHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxp
c2hlZCBieQorICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24g
MiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNp
b24uCisgKgorICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQg
aXQgd2lsbCBiZSB1c2VmdWwsCisgKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQg
ZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5F
U1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICogR05VIEdlbmVyYWwgUHVi
bGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAq
LworCisjZGVmaW5lIFpSMDUwX1ZFUlNJT04gInYwLjcuMSIKKworI2luY2x1ZGUgPGxpbnV4L21v
ZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L2luaXQuaD4KKyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+
CisjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4KKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cisj
aW5jbHVkZSA8bGludXgvd2FpdC5oPgorCisvKiBJL08gY29tbWFuZHMsIGVycm9yIGNvZGVzICov
CisjaW5jbHVkZSA8YXNtL2lvLmg+CisKKy8qIGhlYWRlcmZpbGUgb2YgdGhpcyBtb2R1bGUgKi8K
KyNpbmNsdWRlICJ6cjM2MDUwLmgiCisKKy8qIGNvZGVjIGlvIEFQSSAqLworI2luY2x1ZGUgInZp
ZGVvY29kZWMuaCIKKworLyogaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGhhdmUgbW9yZSB0aGFu
IDIwIG9yIHNvLAorICBqdXN0IHRvIHByZXZlbnQgc29tZSB1bndhbnRlZCBsb29wcyAqLworI2Rl
ZmluZSBNQVhfQ09ERUNTIDIwCisKKy8qIGFtb3VudCBvZiBjaGlwcyBhdHRhY2hlZCB2aWEgdGhp
cyBkcml2ZXIgKi8KK3N0YXRpYyBpbnQgenIzNjA1MF9jb2RlY3M7CisKKy8qIGRlYnVnZ2luZyBp
cyBhdmFpbGFibGUgdmlhIG1vZHVsZSBwYXJhbWV0ZXIgKi8KK3N0YXRpYyBpbnQgZGVidWc7Citt
b2R1bGVfcGFyYW0oZGVidWcsIGludCwgMCk7CitNT0RVTEVfUEFSTV9ERVNDKGRlYnVnLCAiRGVi
dWcgbGV2ZWwgKDAtNCkiKTsKKworI2RlZmluZSBkcHJpbnRrKG51bSwgZm9ybWF0LCBhcmdzLi4u
KSBcCisJZG8geyBcCisJCWlmIChkZWJ1ZyA+PSBudW0pIFwKKwkJCXByaW50ayhmb3JtYXQsICMj
YXJncyk7IFwKKwl9IHdoaWxlICgwKQorCisvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisgICBMb2NhbCBo
YXJkd2FyZSBJL08gZnVuY3Rpb25zOgorCisgICByZWFkL3dyaXRlIHZpYSBjb2RlYyBsYXllciAo
cmVnaXN0ZXJzIGFyZSBsb2NhdGVkIGluIHRoZSBtYXN0ZXIgZGV2aWNlKQorICAgPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PSAqLworCisvKiByZWFkIGFuZCB3cml0ZSBmdW5jdGlvbnMgKi8KK3N0YXRpYyB1OAor
enIzNjA1MF9yZWFkIChzdHJ1Y3QgenIzNjA1MCAqcHRyLAorCSAgICAgIHUxNiAgICAgICAgICAg
ICByZWcpCit7CisJdTggdmFsdWUgPSAwOworCisJLy8ganVzdCBpbiBjYXNlIHNvbWV0aGluZyBp
cyB3cm9uZy4uLgorCWlmIChwdHItPmNvZGVjLT5tYXN0ZXJfZGF0YS0+cmVhZHJlZykKKwkJdmFs
dWUgPSAocHRyLT5jb2RlYy0+bWFzdGVyX2RhdGEtPnJlYWRyZWcocHRyLT5jb2RlYywKKwkJCQkJ
CQkgIHJlZykpICYgMHhGRjsKKwllbHNlCisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJSICIlczog
aW52YWxpZCBJL08gc2V0dXAsIG5vdGhpbmcgcmVhZCFcbiIsCisJCQlwdHItPm5hbWUpOworCisJ
ZHByaW50ayg0LCAiJXM6IHJlYWRpbmcgZnJvbSAweCUwNHg6ICUwMnhcbiIsIHB0ci0+bmFtZSwg
cmVnLAorCQl2YWx1ZSk7CisKKwlyZXR1cm4gdmFsdWU7Cit9CisKK3N0YXRpYyB2b2lkCit6cjM2
MDUwX3dyaXRlIChzdHJ1Y3QgenIzNjA1MCAqcHRyLAorCSAgICAgICB1MTYgICAgICAgICAgICAg
cmVnLAorCSAgICAgICB1OCAgICAgICAgICAgICAgdmFsdWUpCit7CisJZHByaW50ayg0LCAiJXM6
IHdyaXRpbmcgMHglMDJ4IHRvIDB4JTA0eFxuIiwgcHRyLT5uYW1lLCB2YWx1ZSwKKwkJcmVnKTsK
KworCS8vIGp1c3QgaW4gY2FzZSBzb21ldGhpbmcgaXMgd3JvbmcuLi4KKwlpZiAocHRyLT5jb2Rl
Yy0+bWFzdGVyX2RhdGEtPndyaXRlcmVnKQorCQlwdHItPmNvZGVjLT5tYXN0ZXJfZGF0YS0+d3Jp
dGVyZWcocHRyLT5jb2RlYywgcmVnLCB2YWx1ZSk7CisJZWxzZQorCQlkcHJpbnRrKDEsCisJCQlL
RVJOX0VSUgorCQkJIiVzOiBpbnZhbGlkIEkvTyBzZXR1cCwgbm90aGluZyB3cml0dGVuIVxuIiwK
KwkJCXB0ci0+bmFtZSk7Cit9CisKKy8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKyAgIExvY2FsIGhlbHBl
ciBmdW5jdGlvbjoKKworICAgc3RhdHVzIHJlYWQKKyAgID09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKwor
Lyogc3RhdHVzIGlzIGtlcHQgaW4gZGF0YXN0cnVjdHVyZSAqLworc3RhdGljIHU4Cit6cjM2MDUw
X3JlYWRfc3RhdHVzMSAoc3RydWN0IHpyMzYwNTAgKnB0cikKK3sKKwlwdHItPnN0YXR1czEgPSB6
cjM2MDUwX3JlYWQocHRyLCBaUjA1MF9TVEFUVVNfMSk7CisKKwl6cjM2MDUwX3JlYWQocHRyLCAw
KTsKKwlyZXR1cm4gcHRyLT5zdGF0dXMxOworfQorCisvKiA9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisgICBM
b2NhbCBoZWxwZXIgZnVuY3Rpb246CisKKyAgIHNjYWxlIGZhY3RvciByZWFkCisgICA9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ICovCisKKy8qIHNjYWxlIGZhY3RvciBpcyBrZXB0IGluIGRhdGFzdHJ1Y3R1cmUg
Ki8KK3N0YXRpYyB1MTYKK3pyMzYwNTBfcmVhZF9zY2FsZWZhY3RvciAoc3RydWN0IHpyMzYwNTAg
KnB0cikKK3sKKwlwdHItPnNjYWxlZmFjdCA9ICh6cjM2MDUwX3JlYWQocHRyLCBaUjA1MF9TRl9I
SSkgPDwgOCkgfAorCQkJICh6cjM2MDUwX3JlYWQocHRyLCBaUjA1MF9TRl9MTykgJiAweEZGKTsK
KworCS8qIGxlYXZlIDAgc2VsZWN0ZWQgZm9yIGFuIGV2ZW50dWFsbHkgR08gZnJvbSBtYXN0ZXIg
Ki8KKwl6cjM2MDUwX3JlYWQocHRyLCAwKTsKKwlyZXR1cm4gcHRyLT5zY2FsZWZhY3Q7Cit9CisK
Ky8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KKyAgIExvY2FsIGhlbHBlciBmdW5jdGlvbjoKKworICAgd2Fp
dCBpZiBjb2RlYyBpcyByZWFkeSB0byBwcm9jZWVkIChlbmQgb2YgcHJvY2Vzc2luZykgb3IgdGlt
ZSBpcyBvdmVyCisgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCisKK3N0YXRpYyB2b2lkCit6cjM2MDUw
X3dhaXRfZW5kIChzdHJ1Y3QgenIzNjA1MCAqcHRyKQoreworCWludCBpID0gMDsKKworCXdoaWxl
ICghKHpyMzYwNTBfcmVhZF9zdGF0dXMxKHB0cikgJiAweDQpKSB7CisJCXVkZWxheSgxKTsKKwkJ
aWYgKGkrKyA+IDIwMDAwMCkgewkvLyAyMDBtcywgdGhlcmUgaXMgZm9yIHN1cmUgc29tZXRoaW5n
IHdyb25nISEhCisJCQlkcHJpbnRrKDEsCisJCQkJIiVzOiB0aW1lb3V0IGF0IHdhaXRfZW5kIChs
YXN0IHN0YXR1czogMHglMDJ4KVxuIiwKKwkJCQlwdHItPm5hbWUsIHB0ci0+c3RhdHVzMSk7CisJ
CQlicmVhazsKKwkJfQorCX0KK30KKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorICAgTG9jYWwgaGVs
cGVyIGZ1bmN0aW9uOgorCisgICBiYXNpYyB0ZXN0IG9mICJjb25uZWN0aXZpdHkiLCB3cml0ZXMv
cmVhZHMgdG8vZnJvbSBtZW1vcnkgdGhlIFNPRiBtYXJrZXIKKyAgID09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g
Ki8KKworc3RhdGljIGludAorenIzNjA1MF9iYXNpY190ZXN0IChzdHJ1Y3QgenIzNjA1MCAqcHRy
KQoreworCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9TT0ZfSURYLCAweDAwKTsKKwl6cjM2MDUw
X3dyaXRlKHB0ciwgWlIwNTBfU09GX0lEWCArIDEsIDB4MDApOworCWlmICgoenIzNjA1MF9yZWFk
KHB0ciwgWlIwNTBfU09GX0lEWCkgfAorCSAgICAgenIzNjA1MF9yZWFkKHB0ciwgWlIwNTBfU09G
X0lEWCArIDEpKSAhPSAweDAwMDApIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIKKwkJCSIl
czogYXR0YWNoIGZhaWxlZCwgY2FuJ3QgY29ubmVjdCB0byBqcGVnIHByb2Nlc3NvciFcbiIsCisJ
CQlwdHItPm5hbWUpOworCQlyZXR1cm4gLUVOWElPOworCX0KKwl6cjM2MDUwX3dyaXRlKHB0ciwg
WlIwNTBfU09GX0lEWCwgMHhmZik7CisJenIzNjA1MF93cml0ZShwdHIsIFpSMDUwX1NPRl9JRFgg
KyAxLCAweGMwKTsKKwlpZiAoKCh6cjM2MDUwX3JlYWQocHRyLCBaUjA1MF9TT0ZfSURYKSA8PCA4
KSB8CisJICAgICB6cjM2MDUwX3JlYWQocHRyLCBaUjA1MF9TT0ZfSURYICsgMSkpICE9IDB4ZmZj
MCkgeworCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgorCQkJIiVzOiBhdHRhY2ggZmFpbGVkLCBj
YW4ndCBjb25uZWN0IHRvIGpwZWcgcHJvY2Vzc29yIVxuIiwKKwkJCXB0ci0+bmFtZSk7CisJCXJl
dHVybiAtRU5YSU87CisJfQorCisJenIzNjA1MF93YWl0X2VuZChwdHIpOworCWlmICgocHRyLT5z
dGF0dXMxICYgMHg0KSA9PSAwKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJSCisJCQkiJXM6
IGF0dGFjaCBmYWlsZWQsIGpwZWcgcHJvY2Vzc29yIGZhaWxlZCAoZW5kIGZsYWcpIVxuIiwKKwkJ
CXB0ci0+bmFtZSk7CisJCXJldHVybiAtRUJVU1k7CisJfQorCisJcmV0dXJuIDA7CQkvKiBsb29r
cyBnb29kISAqLworfQorCisvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisgICBMb2NhbCBoZWxwZXIgZnVu
Y3Rpb246CisKKyAgIHNpbXBsZSBsb29wIGZvciBwdXNoaW5nIHRoZSBpbml0IGRhdGFzZXRzCisg
ICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ICovCisKK3N0YXRpYyBpbnQKK3pyMzYwNTBfcHVzaGl0IChzdHJ1
Y3QgenIzNjA1MCAqcHRyLAorCQl1MTYgICAgICAgICAgICAgc3RhcnRyZWcsCisJCXUxNiAgICAg
ICAgICAgICBsZW4sCisJCWNvbnN0IGNoYXIgICAgICpkYXRhKQoreworCWludCBpID0gMDsKKwor
CWRwcmludGsoNCwgIiVzOiB3cml0ZSBkYXRhIGJsb2NrIHRvIDB4JTA0eCAobGVuPSVkKVxuIiwg
cHRyLT5uYW1lLAorCQlzdGFydHJlZywgbGVuKTsKKwl3aGlsZSAoaSA8IGxlbikgeworCQl6cjM2
MDUwX3dyaXRlKHB0ciwgc3RhcnRyZWcrKywgZGF0YVtpKytdKTsKKwl9CisKKwlyZXR1cm4gaTsK
K30KKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQorICAgQmFzaWMgZGF0YXNldHM6CisKKyAgIGpwZWcg
YmFzZWxpbmUgc2V0dXAgZGF0YSAoeW91IGZpbmQgaXQgb24gbG90cyBwbGFjZXMgaW4gaW50ZXJu
ZXQsIG9yIGp1c3QKKyAgIGV4dHJhY3QgaXQgZnJvbSBhbnkgcmVndWxhciAuanBnIGltYWdlLi4u
KQorCisgICBDb3VsZCBiZSB2YXJpYWJsZSwgYnV0IHVudGlsIGl0J3Mgbm90IG5lZWRlZCBpdCB0
aGV5IGFyZSBqdXN0IGZpeGVkIHRvIHNhdmUKKyAgIG1lbW9yeS4gT3RoZXJ3aXNlIGV4cGFuZCB6
cjM2MDUwIHN0cnVjdHVyZSB3aXRoIGFycmF5cywgcHVzaCB0aGUgdmFsdWVzIHRvCisgICBpdCBh
bmQgaW5pdGlhbGl6ZSBmcm9tIHRoZXJlLCBhcyBlLmcuIHRoZSBsaW51eCB6cjM2MDU3LzYwIGRy
aXZlciBkb2VzIGl0LgorICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLworCitzdGF0aWMgY29uc3QgY2hh
ciB6cjM2MDUwX2RxdFsweDg2XSA9IHsKKwkweGZmLCAweGRiLAkJLy9NYXJrZXI6IERRVAorCTB4
MDAsIDB4ODQsCQkvL0xlbmd0aDogMio2NSsyCisJMHgwMCwJCQkvL1BxLFRxIGZpcnN0IHRhYmxl
CisJMHgxMCwgMHgwYiwgMHgwYywgMHgwZSwgMHgwYywgMHgwYSwgMHgxMCwgMHgwZSwKKwkweDBk
LCAweDBlLCAweDEyLCAweDExLCAweDEwLCAweDEzLCAweDE4LCAweDI4LAorCTB4MWEsIDB4MTgs
IDB4MTYsIDB4MTYsIDB4MTgsIDB4MzEsIDB4MjMsIDB4MjUsCisJMHgxZCwgMHgyOCwgMHgzYSwg
MHgzMywgMHgzZCwgMHgzYywgMHgzOSwgMHgzMywKKwkweDM4LCAweDM3LCAweDQwLCAweDQ4LCAw
eDVjLCAweDRlLCAweDQwLCAweDQ0LAorCTB4NTcsIDB4NDUsIDB4MzcsIDB4MzgsIDB4NTAsIDB4
NmQsIDB4NTEsIDB4NTcsCisJMHg1ZiwgMHg2MiwgMHg2NywgMHg2OCwgMHg2NywgMHgzZSwgMHg0
ZCwgMHg3MSwKKwkweDc5LCAweDcwLCAweDY0LCAweDc4LCAweDVjLCAweDY1LCAweDY3LCAweDYz
LAorCTB4MDEsCQkJLy9QcSxUcSBzZWNvbmQgdGFibGUKKwkweDExLCAweDEyLCAweDEyLCAweDE4
LCAweDE1LCAweDE4LCAweDJmLCAweDFhLAorCTB4MWEsIDB4MmYsIDB4NjMsIDB4NDIsIDB4Mzgs
IDB4NDIsIDB4NjMsIDB4NjMsCisJMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2Mywg
MHg2MywgMHg2MywKKwkweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAw
eDYzLAorCTB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsCisJ
MHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2MywKKwkweDYzLCAw
eDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLAorCTB4NjMsIDB4NjMsIDB4
NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMKK307CisKK3N0YXRpYyBjb25zdCBjaGFy
IHpyMzYwNTBfZGh0WzB4MWE0XSA9IHsKKwkweGZmLCAweGM0LAkJLy9NYXJrZXI6IERIVAorCTB4
MDEsIDB4YTIsCQkvL0xlbmd0aDogMipBQywgMipEQworCTB4MDAsCQkJLy9EQyBmaXJzdCB0YWJs
ZQorCTB4MDAsIDB4MDEsIDB4MDUsIDB4MDEsIDB4MDEsIDB4MDEsIDB4MDEsIDB4MDEsCisJMHgw
MSwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwK
KwkweDAyLCAweDAzLCAweDA0LCAweDA1LCAweDA2LCAweDA3LCAweDA4LCAweDA5LCAweDBBLCAw
eDBCLAorCTB4MDEsCQkJLy9EQyBzZWNvbmQgdGFibGUKKwkweDAwLCAweDAzLCAweDAxLCAweDAx
LCAweDAxLCAweDAxLCAweDAxLCAweDAxLAorCTB4MDEsIDB4MDEsIDB4MDEsIDB4MDAsIDB4MDAs
IDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsCisJMHgwMiwgMHgwMywgMHgwNCwgMHgwNSwg
MHgwNiwgMHgwNywgMHgwOCwgMHgwOSwgMHgwQSwgMHgwQiwKKwkweDEwLAkJCS8vQUMgZmlyc3Qg
dGFibGUKKwkweDAwLCAweDAyLCAweDAxLCAweDAzLCAweDAzLCAweDAyLCAweDA0LCAweDAzLAor
CTB4MDUsIDB4MDUsIDB4MDQsIDB4MDQsIDB4MDAsIDB4MDAsCisJMHgwMSwgMHg3RCwgMHgwMSwg
MHgwMiwgMHgwMywgMHgwMCwgMHgwNCwgMHgxMSwKKwkweDA1LCAweDEyLCAweDIxLCAweDMxLCAw
eDQxLCAweDA2LCAweDEzLCAweDUxLCAweDYxLAorCTB4MDcsIDB4MjIsIDB4NzEsIDB4MTQsIDB4
MzIsIDB4ODEsIDB4OTEsIDB4QTEsCisJMHgwOCwgMHgyMywgMHg0MiwgMHhCMSwgMHhDMSwgMHgx
NSwgMHg1MiwgMHhEMSwgMHhGMCwgMHgyNCwKKwkweDMzLCAweDYyLCAweDcyLCAweDgyLCAweDA5
LCAweDBBLCAweDE2LCAweDE3LAorCTB4MTgsIDB4MTksIDB4MUEsIDB4MjUsIDB4MjYsIDB4Mjcs
IDB4MjgsIDB4MjksIDB4MkEsIDB4MzQsCisJMHgzNSwgMHgzNiwgMHgzNywgMHgzOCwgMHgzOSwg
MHgzQSwgMHg0MywgMHg0NCwKKwkweDQ1LCAweDQ2LCAweDQ3LCAweDQ4LCAweDQ5LCAweDRBLCAw
eDUzLCAweDU0LCAweDU1LCAweDU2LAorCTB4NTcsIDB4NTgsIDB4NTksIDB4NUEsIDB4NjMsIDB4
NjQsIDB4NjUsIDB4NjYsCisJMHg2NywgMHg2OCwgMHg2OSwgMHg2QSwgMHg3MywgMHg3NCwgMHg3
NSwgMHg3NiwgMHg3NywgMHg3OCwKKwkweDc5LCAweDdBLCAweDgzLCAweDg0LCAweDg1LCAweDg2
LCAweDg3LCAweDg4LAorCTB4ODksIDB4OEEsIDB4OTIsIDB4OTMsIDB4OTQsIDB4OTUsIDB4OTYs
IDB4OTcsIDB4OTgsIDB4OTksCisJMHg5QSwgMHhBMiwgMHhBMywgMHhBNCwgMHhBNSwgMHhBNiwg
MHhBNywgMHhBOCwKKwkweEE5LCAweEFBLCAweEIyLCAweEIzLCAweEI0LCAweEI1LCAweEI2LCAw
eEI3LCAweEI4LCAweEI5LAorCTB4QkEsIDB4QzIsIDB4QzMsIDB4QzQsIDB4QzUsIDB4QzYsIDB4
QzcsIDB4QzgsCisJMHhDOSwgMHhDQSwgMHhEMiwgMHhEMywgMHhENCwgMHhENSwgMHhENiwgMHhE
NywgMHhEOCwgMHhEOSwKKwkweERBLCAweEUxLCAweEUyLCAweEUzLCAweEU0LCAweEU1LCAweEU2
LCAweEU3LAorCTB4RTgsIDB4RTksIDB4RUEsIDB4RjEsIDB4RjIsIDB4RjMsIDB4RjQsIDB4RjUs
IDB4RjYsIDB4RjcsCisJMHhGOCwgMHhGOSwgMHhGQSwKKwkweDExLAkJCS8vQUMgc2Vjb25kIHRh
YmxlCisJMHgwMCwgMHgwMiwgMHgwMSwgMHgwMiwgMHgwNCwgMHgwNCwgMHgwMywgMHgwNCwKKwkw
eDA3LCAweDA1LCAweDA0LCAweDA0LCAweDAwLCAweDAxLAorCTB4MDIsIDB4NzcsIDB4MDAsIDB4
MDEsIDB4MDIsIDB4MDMsIDB4MTEsIDB4MDQsCisJMHgwNSwgMHgyMSwgMHgzMSwgMHgwNiwgMHgx
MiwgMHg0MSwgMHg1MSwgMHgwNywgMHg2MSwgMHg3MSwKKwkweDEzLCAweDIyLCAweDMyLCAweDgx
LCAweDA4LCAweDE0LCAweDQyLCAweDkxLAorCTB4QTEsIDB4QjEsIDB4QzEsIDB4MDksIDB4MjMs
IDB4MzMsIDB4NTIsIDB4RjAsIDB4MTUsIDB4NjIsCisJMHg3MiwgMHhEMSwgMHgwQSwgMHgxNiwg
MHgyNCwgMHgzNCwgMHhFMSwgMHgyNSwKKwkweEYxLCAweDE3LCAweDE4LCAweDE5LCAweDFBLCAw
eDI2LCAweDI3LCAweDI4LCAweDI5LCAweDJBLAorCTB4MzUsIDB4MzYsIDB4MzcsIDB4MzgsIDB4
MzksIDB4M0EsIDB4NDMsIDB4NDQsCisJMHg0NSwgMHg0NiwgMHg0NywgMHg0OCwgMHg0OSwgMHg0
QSwgMHg1MywgMHg1NCwgMHg1NSwgMHg1NiwKKwkweDU3LCAweDU4LCAweDU5LCAweDVBLCAweDYz
LCAweDY0LCAweDY1LCAweDY2LAorCTB4NjcsIDB4NjgsIDB4NjksIDB4NkEsIDB4NzMsIDB4NzQs
IDB4NzUsIDB4NzYsIDB4NzcsIDB4NzgsCisJMHg3OSwgMHg3QSwgMHg4MiwgMHg4MywgMHg4NCwg
MHg4NSwgMHg4NiwgMHg4NywKKwkweDg4LCAweDg5LCAweDhBLCAweDkyLCAweDkzLCAweDk0LCAw
eDk1LCAweDk2LCAweDk3LCAweDk4LAorCTB4OTksIDB4OUEsIDB4QTIsIDB4QTMsIDB4QTQsIDB4
QTUsIDB4QTYsIDB4QTcsCisJMHhBOCwgMHhBOSwgMHhBQSwgMHhCMiwgMHhCMywgMHhCNCwgMHhC
NSwgMHhCNiwgMHhCNywgMHhCOCwKKwkweEI5LCAweEJBLCAweEMyLCAweEMzLCAweEM0LCAweEM1
LCAweEM2LCAweEM3LAorCTB4QzgsIDB4QzksIDB4Q0EsIDB4RDIsIDB4RDMsIDB4RDQsIDB4RDUs
IDB4RDYsIDB4RDcsIDB4RDgsCisJMHhEOSwgMHhEQSwgMHhFMiwgMHhFMywgMHhFNCwgMHhFNSwg
MHhFNiwgMHhFNywKKwkweEU4LCAweEU5LCAweEVBLCAweEYyLCAweEYzLCAweEY0LCAweEY1LCAw
eEY2LCAweEY3LCAweEY4LAorCTB4RjksIDB4RkEKK307CisKKy8qIGpwZWcgYmFzZWxpbmUgc2V0
dXAsIHRoaXMgaXMganVzdCBmaXhlZCBpbiB0aGlzIGRyaXZlciAoWVVWIHBpY3R1cmVzKSAqLwor
I2RlZmluZSBOT19PRl9DT01QT05FTlRTICAgICAgICAgIDB4MwkvL1ksVSxWCisjZGVmaW5lIEJB
U0VMSU5FX1BSRUNJU0lPTiAgICAgICAgMHg4CS8vTUNVIHNpemUgKD8pCitzdGF0aWMgY29uc3Qg
Y2hhciB6cjM2MDUwX3RxWzhdID0geyAwLCAxLCAxLCAwLCAwLCAwLCAwLCAwIH07CS8vdGFibGUg
aWR4J3MgUVQKK3N0YXRpYyBjb25zdCBjaGFyIHpyMzYwNTBfdGRbOF0gPSB7IDAsIDEsIDEsIDAs
IDAsIDAsIDAsIDAgfTsJLy90YWJsZSBpZHgncyBEQworc3RhdGljIGNvbnN0IGNoYXIgenIzNjA1
MF90YVs4XSA9IHsgMCwgMSwgMSwgMCwgMCwgMCwgMCwgMCB9OwkvL3RhYmxlIGlkeCdzIEFDCisK
Ky8qIGhvcml6b250YWwgNDIyIGRlY2ltYXRpb24gc2V0dXAgKG1heWJlIHdlIHN1cHBvcnQgNDEx
IG9yIHNvIGxhdGVyLCB0b28pICovCitzdGF0aWMgY29uc3QgY2hhciB6cjM2MDUwX2RlY2ltYXRp
b25faFs4XSA9IHsgMiwgMSwgMSwgMCwgMCwgMCwgMCwgMCB9Oworc3RhdGljIGNvbnN0IGNoYXIg
enIzNjA1MF9kZWNpbWF0aW9uX3ZbOF0gPSB7IDEsIDEsIDEsIDAsIDAsIDAsIDAsIDAgfTsKKwor
LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PQorICAgTG9jYWwgaGVscGVyIGZ1bmN0aW9uczoKKworICAgY2Fs
Y3VsYXRpb24gYW5kIHNldHVwIG9mIHBhcmFtZXRlci1kZXBlbmRlbnQgSlBFRyBiYXNlbGluZSBz
ZWdtZW50cworICAgKG5lZWRlZCBmb3IgY29tcHJlc3Npb24gb25seSkKKyAgID09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0gKi8KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLworCisvKiBTT0YgKHN0YXJ0IG9mIGZy
YW1lKSBzZWdtZW50IGRlcGVuZHMgb24gd2lkdGgsIGhlaWdodCBhbmQgc2FtcGxpbmcgcmF0aW8K
KwkJCSBvZiBlYWNoIGNvbG9yIGNvbXBvbmVudCAqLworCitzdGF0aWMgaW50Cit6cjM2MDUwX3Nl
dF9zb2YgKHN0cnVjdCB6cjM2MDUwICpwdHIpCit7CisJY2hhciBzb2ZfZGF0YVszNF07CS8vIG1h
eC4gc2l6ZSBvZiByZWdpc3RlciBzZXQKKwlpbnQgaTsKKworCWRwcmludGsoMywgIiVzOiB3cml0
ZSBTT0YgKCVkeCVkLCAlZCBjb21wb25lbnRzKVxuIiwgcHRyLT5uYW1lLAorCQlwdHItPndpZHRo
LCBwdHItPmhlaWdodCwgTk9fT0ZfQ09NUE9ORU5UUyk7CisJc29mX2RhdGFbMF0gPSAweGZmOwor
CXNvZl9kYXRhWzFdID0gMHhjMDsKKwlzb2ZfZGF0YVsyXSA9IDB4MDA7CisJc29mX2RhdGFbM10g
PSAoMyAqIE5PX09GX0NPTVBPTkVOVFMpICsgODsKKwlzb2ZfZGF0YVs0XSA9IEJBU0VMSU5FX1BS
RUNJU0lPTjsJLy8gb25seSAnOCcgcG9zc2libGUgd2l0aCB6cjM2MDUwCisJc29mX2RhdGFbNV0g
PSAocHRyLT5oZWlnaHQpID4+IDg7CisJc29mX2RhdGFbNl0gPSAocHRyLT5oZWlnaHQpICYgMHhm
ZjsKKwlzb2ZfZGF0YVs3XSA9IChwdHItPndpZHRoKSA+PiA4OworCXNvZl9kYXRhWzhdID0gKHB0
ci0+d2lkdGgpICYgMHhmZjsKKwlzb2ZfZGF0YVs5XSA9IE5PX09GX0NPTVBPTkVOVFM7CisJZm9y
IChpID0gMDsgaSA8IE5PX09GX0NPTVBPTkVOVFM7IGkrKykgeworCQlzb2ZfZGF0YVsxMCArIChp
ICogMyldID0gaTsJLy8gaW5kZXggaWRlbnRpZmllcgorCQlzb2ZfZGF0YVsxMSArIChpICogMyld
ID0gKHB0ci0+aF9zYW1wX3JhdGlvW2ldIDw8IDQpIHwgKHB0ci0+dl9zYW1wX3JhdGlvW2ldKTsJ
Ly8gc2FtcGxpbmcgcmF0aW9zCisJCXNvZl9kYXRhWzEyICsgKGkgKiAzKV0gPSB6cjM2MDUwX3Rx
W2ldOwkvLyBRIHRhYmxlIHNlbGVjdGlvbgorCX0KKwlyZXR1cm4genIzNjA1MF9wdXNoaXQocHRy
LCBaUjA1MF9TT0ZfSURYLAorCQkJICAgICAgKDMgKiBOT19PRl9DT01QT05FTlRTKSArIDEwLCBz
b2ZfZGF0YSk7Cit9CisKKy8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KKworLyogU09TIChzdGFydCBv
ZiBzY2FuKSBzZWdtZW50IGRlcGVuZHMgb24gdGhlIHVzZWQgc2NhbiBjb21wb25lbnRzCisJCQlv
ZiBlYWNoIGNvbG9yIGNvbXBvbmVudCAqLworCitzdGF0aWMgaW50Cit6cjM2MDUwX3NldF9zb3Mg
KHN0cnVjdCB6cjM2MDUwICpwdHIpCit7CisJY2hhciBzb3NfZGF0YVsxNl07CS8vIG1heC4gc2l6
ZSBvZiByZWdpc3RlciBzZXQKKwlpbnQgaTsKKworCWRwcmludGsoMywgIiVzOiB3cml0ZSBTT1Nc
biIsIHB0ci0+bmFtZSk7CisJc29zX2RhdGFbMF0gPSAweGZmOworCXNvc19kYXRhWzFdID0gMHhk
YTsKKwlzb3NfZGF0YVsyXSA9IDB4MDA7CisJc29zX2RhdGFbM10gPSAyICsgMSArICgyICogTk9f
T0ZfQ09NUE9ORU5UUykgKyAzOworCXNvc19kYXRhWzRdID0gTk9fT0ZfQ09NUE9ORU5UUzsKKwlm
b3IgKGkgPSAwOyBpIDwgTk9fT0ZfQ09NUE9ORU5UUzsgaSsrKSB7CisJCXNvc19kYXRhWzUgKyAo
aSAqIDIpXSA9IGk7CS8vIGluZGV4CisJCXNvc19kYXRhWzYgKyAoaSAqIDIpXSA9ICh6cjM2MDUw
X3RkW2ldIDw8IDQpIHwgenIzNjA1MF90YVtpXTsJLy8gQUMvREMgdGJsLnNlbC4KKwl9CisJc29z
X2RhdGFbMiArIDEgKyAoMiAqIE5PX09GX0NPTVBPTkVOVFMpICsgMl0gPSAwMDsJLy8gc2NhbiBz
dGFydAorCXNvc19kYXRhWzIgKyAxICsgKDIgKiBOT19PRl9DT01QT05FTlRTKSArIDNdID0gMHgz
RjsKKwlzb3NfZGF0YVsyICsgMSArICgyICogTk9fT0ZfQ09NUE9ORU5UUykgKyA0XSA9IDAwOwor
CXJldHVybiB6cjM2MDUwX3B1c2hpdChwdHIsIFpSMDUwX1NPUzFfSURYLAorCQkJICAgICAgNCAr
IDEgKyAoMiAqIE5PX09GX0NPTVBPTkVOVFMpICsgMywKKwkJCSAgICAgIHNvc19kYXRhKTsKK30K
KworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLworCisvKiBEUkkgKGRlZmluZSByZXN0YXJ0IGludGVy
dmFsKSAqLworCitzdGF0aWMgaW50Cit6cjM2MDUwX3NldF9kcmkgKHN0cnVjdCB6cjM2MDUwICpw
dHIpCit7CisJY2hhciBkcmlfZGF0YVs2XTsJLy8gbWF4LiBzaXplIG9mIHJlZ2lzdGVyIHNldAor
CisJZHByaW50aygzLCAiJXM6IHdyaXRlIERSSVxuIiwgcHRyLT5uYW1lKTsKKwlkcmlfZGF0YVsw
XSA9IDB4ZmY7CisJZHJpX2RhdGFbMV0gPSAweGRkOworCWRyaV9kYXRhWzJdID0gMHgwMDsKKwlk
cmlfZGF0YVszXSA9IDB4MDQ7CisJZHJpX2RhdGFbNF0gPSBwdHItPmRyaSA+PiA4OworCWRyaV9k
YXRhWzVdID0gcHRyLT5kcmkgJiAweGZmOworCXJldHVybiB6cjM2MDUwX3B1c2hpdChwdHIsIFpS
MDUwX0RSSV9JRFgsIDYsIGRyaV9kYXRhKTsKK30KKworLyogPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorICAg
U2V0dXAgZnVuY3Rpb246CisKKyAgIFNldHVwIGNvbXByZXNzaW9uL2RlY29tcHJlc3Npb24gb2Yg
Wm9yYW4ncyBKUEVHIHByb2Nlc3NvcgorICAgKCBzZWUgYWxzbyB6b3JhbiAzNjA1MCBtYW51YWwg
KQorCisgICAuLi4gc29ycnkgZm9yIHRoZSBzcGFnaGV0dGkgY29kZSAuLi4KKyAgID09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0gKi8KK3N0YXRpYyB2b2lkCit6cjM2MDUwX2luaXQgKHN0cnVjdCB6cjM2MDUwICpw
dHIpCit7CisJaW50IHN1bSA9IDA7CisJbG9uZyBiaXRjbnQsIHRtcDsKKworCWlmIChwdHItPm1v
ZGUgPT0gQ09ERUNfRE9fQ09NUFJFU1NJT04pIHsKKwkJZHByaW50aygyLCAiJXM6IENPTVBSRVNT
SU9OIFNFVFVQXG4iLCBwdHItPm5hbWUpOworCisJCS8qIDA1MCBjb21tdW5pY2F0ZXMgd2l0aCAw
NTcgaW4gbWFzdGVyIG1vZGUgKi8KKwkJenIzNjA1MF93cml0ZShwdHIsIFpSMDUwX0hBUkRXQVJF
LCBaUjA1MF9IV19NU1RSKTsKKworCQkvKiBlbmNvZGluZyB0YWJsZSBwcmVsb2FkIGZvciBjb21w
cmVzc2lvbiAqLworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfTU9ERSwKKwkJCSAgICAgIFpS
MDUwX01PX0NPTVAgfCBaUjA1MF9NT19UTE0pOworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBf
T1BUSU9OUywgMCk7CisKKwkJLyogZGlzYWJsZSBhbGwgSVJRcyAqLworCQl6cjM2MDUwX3dyaXRl
KHB0ciwgWlIwNTBfSU5UX1JFUV8wLCAwKTsKKwkJenIzNjA1MF93cml0ZShwdHIsIFpSMDUwX0lO
VF9SRVFfMSwgMyk7CS8vIGxvdyAyIGJpdHMgYWx3YXlzIDEKKworCQkvKiB2b2x1bWUgY29udHJv
bCBzZXR0aW5ncyAqLworCQkvKnpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9NQkNWLCBwdHItPm1h
eF9ibG9ja192b2wpOyovCisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9TRl9ISSwgcHRyLT5z
Y2FsZWZhY3QgPj4gOCk7CisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9TRl9MTywgcHRyLT5z
Y2FsZWZhY3QgJiAweGZmKTsKKworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfQUZfSEksIDB4
ZmYpOworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfQUZfTSwgMHhmZik7CisJCXpyMzYwNTBf
d3JpdGUocHRyLCBaUjA1MF9BRl9MTywgMHhmZik7CisKKwkJLyogc2V0dXAgdGhlIHZhcmlhYmxl
IGpwZWcgdGFibGVzICovCisJCXN1bSArPSB6cjM2MDUwX3NldF9zb2YocHRyKTsKKwkJc3VtICs9
IHpyMzYwNTBfc2V0X3NvcyhwdHIpOworCQlzdW0gKz0genIzNjA1MF9zZXRfZHJpKHB0cik7CisK
KwkJLyogc2V0dXAgdGhlIGZpeGVkIGpwZWcgdGFibGVzIC0gbWF5YmUgdmFyaWFibGUsIHRob3Vn
aCAtCisJCSAqIChzZWUgdGFibGUgaW5pdCBzZWN0aW9uIGFib3ZlKSAqLworCQlkcHJpbnRrKDMs
ICIlczogd3JpdGUgRFFULCBESFQsIEFQUFxuIiwgcHRyLT5uYW1lKTsKKwkJc3VtICs9IHpyMzYw
NTBfcHVzaGl0KHB0ciwgWlIwNTBfRFFUX0lEWCwKKwkJCQkgICAgICBzaXplb2YoenIzNjA1MF9k
cXQpLCB6cjM2MDUwX2RxdCk7CisJCXN1bSArPSB6cjM2MDUwX3B1c2hpdChwdHIsIFpSMDUwX0RI
VF9JRFgsCisJCQkJICAgICAgc2l6ZW9mKHpyMzYwNTBfZGh0KSwgenIzNjA1MF9kaHQpOworCQl6
cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfQVBQX0lEWCwgMHhmZik7CisJCXpyMzYwNTBfd3JpdGUo
cHRyLCBaUjA1MF9BUFBfSURYICsgMSwgMHhlMCArIHB0ci0+YXBwLmFwcG4pOworCQl6cjM2MDUw
X3dyaXRlKHB0ciwgWlIwNTBfQVBQX0lEWCArIDIsIDB4MDApOworCQl6cjM2MDUwX3dyaXRlKHB0
ciwgWlIwNTBfQVBQX0lEWCArIDMsIHB0ci0+YXBwLmxlbiArIDIpOworCQlzdW0gKz0genIzNjA1
MF9wdXNoaXQocHRyLCBaUjA1MF9BUFBfSURYICsgNCwgNjAsCisJCQkJICAgICAgcHRyLT5hcHAu
ZGF0YSkgKyA0OworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfQ09NX0lEWCwgMHhmZik7CisJ
CXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9DT01fSURYICsgMSwgMHhmZSk7CisJCXpyMzYwNTBf
d3JpdGUocHRyLCBaUjA1MF9DT01fSURYICsgMiwgMHgwMCk7CisJCXpyMzYwNTBfd3JpdGUocHRy
LCBaUjA1MF9DT01fSURYICsgMywgcHRyLT5jb20ubGVuICsgMik7CisJCXN1bSArPSB6cjM2MDUw
X3B1c2hpdChwdHIsIFpSMDUwX0NPTV9JRFggKyA0LCA2MCwKKwkJCQkgICAgICBwdHItPmNvbS5k
YXRhKSArIDQ7CisKKwkJLyogZG8gdGhlIGludGVybmFsIGh1ZmZtYW4gdGFibGUgcHJlbG9hZCAq
LworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfTUFSS0VSU19FTiwgWlIwNTBfTUVfREhUSSk7
CisKKwkJenIzNjA1MF93cml0ZShwdHIsIFpSMDUwX0dPLCAxKTsJLy8gbGF1bmNoIGNvZGVjCisJ
CXpyMzYwNTBfd2FpdF9lbmQocHRyKTsKKwkJZHByaW50aygyLCAiJXM6IFN0YXR1cyBhZnRlciB0
YWJsZSBwcmVsb2FkOiAweCUwMnhcbiIsCisJCQlwdHItPm5hbWUsIHB0ci0+c3RhdHVzMSk7CisK
KwkJaWYgKChwdHItPnN0YXR1czEgJiAweDQpID09IDApIHsKKwkJCWRwcmludGsoMSwgS0VSTl9F
UlIgIiVzOiBpbml0IGFib3J0ZWQhXG4iLAorCQkJCXB0ci0+bmFtZSk7CisJCQlyZXR1cm47CS8v
IHNvbWV0aGluZyBpcyB3cm9uZywgaXRzIHRpbWVkIG91dCEhISEKKwkJfQorCisJCS8qIHNldHVw
IG1pc2MuIGRhdGEgZm9yIGNvbXByZXNzaW9uICh0YXJnZXQgY29kZSBzaXplcykgKi8KKworCQkv
KiBzaXplIG9mIGNvbXByZXNzZWQgY29kZSB0byByZWFjaCB3aXRob3V0IGhlYWRlciBkYXRhICov
CisJCXN1bSA9IHB0ci0+cmVhbF9jb2RlX3ZvbCAtIHN1bTsKKwkJYml0Y250ID0gc3VtIDw8IDM7
CS8qIG5lZWQgdGhlIHNpemUgaW4gYml0cyAqLworCisJCXRtcCA9IGJpdGNudCA+PiAxNjsKKwkJ
ZHByaW50aygzLAorCQkJIiVzOiBjb2RlOiBjc2l6ZT0lZCwgdG90PSVkLCBiaXQ9JWxkLCBoaWdo
Yml0cz0lbGRcbiIsCisJCQlwdHItPm5hbWUsIHN1bSwgcHRyLT5yZWFsX2NvZGVfdm9sLCBiaXRj
bnQsIHRtcCk7CisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9UQ1ZfTkVUX0hJLCB0bXAgPj4g
OCk7CisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9UQ1ZfTkVUX01ILCB0bXAgJiAweGZmKTsK
KwkJdG1wID0gYml0Y250ICYgMHhmZmZmOworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfVENW
X05FVF9NTCwgdG1wID4+IDgpOworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfVENWX05FVF9M
TywgdG1wICYgMHhmZik7CisKKwkJYml0Y250IC09IGJpdGNudCA+PiA3OwkvLyBiaXRzIHdpdGhv
dXQgc3R1ZmZpbmcKKwkJYml0Y250IC09ICgoYml0Y250ICogNSkgPj4gNik7CS8vIGJpdHMgd2l0
aG91dCBlb2IKKworCQl0bXAgPSBiaXRjbnQgPj4gMTY7CisJCWRwcmludGsoMywgIiVzOiBjb2Rl
OiBuZXR0b2JpdD0lbGQsIGhpZ2huZXR0b2JpdHM9JWxkXG4iLAorCQkJcHRyLT5uYW1lLCBiaXRj
bnQsIHRtcCk7CisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9UQ1ZfREFUQV9ISSwgdG1wID4+
IDgpOworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfVENWX0RBVEFfTUgsIHRtcCAmIDB4ZmYp
OworCQl0bXAgPSBiaXRjbnQgJiAweGZmZmY7CisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9U
Q1ZfREFUQV9NTCwgdG1wID4+IDgpOworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIwNTBfVENWX0RB
VEFfTE8sIHRtcCAmIDB4ZmYpOworCisJCS8qIGNvbXByZXNzaW9uIHNldHVwIHdpdGggb3Igd2l0
aG91dCBiaXRyYXRlIGNvbnRyb2wgKi8KKwkJenIzNjA1MF93cml0ZShwdHIsIFpSMDUwX01PREUs
CisJCQkgICAgICBaUjA1MF9NT19DT01QIHwgWlIwNTBfTU9fUEFTUzIgfAorCQkJICAgICAgKHB0
ci0+Yml0cmF0ZV9jdHJsID8gWlIwNTBfTU9fQlJDIDogMCkpOworCisJCS8qIHRoaXMgaGVhZGVy
cyBzZWVtIHRvIGRlbGl2ZXIgInZhbGlkIEFWSSIganBlZyBmcmFtZXMgKi8KKwkJenIzNjA1MF93
cml0ZShwdHIsIFpSMDUwX01BUktFUlNfRU4sCisJCQkgICAgICBaUjA1MF9NRV9EUVQgfCBaUjA1
MF9NRV9ESFQgfAorCQkJICAgICAgKChwdHItPmFwcC5sZW4gPiAwKSA/IFpSMDUwX01FX0FQUCA6
IDApIHwKKwkJCSAgICAgICgocHRyLT5jb20ubGVuID4gMCkgPyBaUjA1MF9NRV9DT00gOiAwKSk7
CisJfSBlbHNlIHsKKwkJZHByaW50aygyLCAiJXM6IEVYUEFOU0lPTiBTRVRVUFxuIiwgcHRyLT5u
YW1lKTsKKworCQkvKiAwNTAgY29tbXVuaWNhdGVzIHdpdGggMDU1IGluIG1hc3RlciBtb2RlICov
CisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9IQVJEV0FSRSwKKwkJCSAgICAgIFpSMDUwX0hX
X01TVFIgfCBaUjA1MF9IV19DRklTXzJfQ0xLKTsKKworCQkvKiBlbmNvZGluZyB0YWJsZSBwcmVs
b2FkICovCisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9NT0RFLCBaUjA1MF9NT19UTE0pOwor
CisJCS8qIGRpc2FibGUgYWxsIElSUXMgKi8KKwkJenIzNjA1MF93cml0ZShwdHIsIFpSMDUwX0lO
VF9SRVFfMCwgMCk7CisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9JTlRfUkVRXzEsIDMpOwkv
LyBsb3cgMiBiaXRzIGFsd2F5cyAxCisKKwkJZHByaW50aygzLCAiJXM6IHdyaXRlIERIVFxuIiwg
cHRyLT5uYW1lKTsKKwkJenIzNjA1MF9wdXNoaXQocHRyLCBaUjA1MF9ESFRfSURYLCBzaXplb2Yo
enIzNjA1MF9kaHQpLAorCQkJICAgICAgIHpyMzYwNTBfZGh0KTsKKworCQkvKiBkbyB0aGUgaW50
ZXJuYWwgaHVmZm1hbiB0YWJsZSBwcmVsb2FkICovCisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1
MF9NQVJLRVJTX0VOLCBaUjA1MF9NRV9ESFRJKTsKKworCQl6cjM2MDUwX3dyaXRlKHB0ciwgWlIw
NTBfR08sIDEpOwkvLyBsYXVuY2ggY29kZWMKKwkJenIzNjA1MF93YWl0X2VuZChwdHIpOworCQlk
cHJpbnRrKDIsICIlczogU3RhdHVzIGFmdGVyIHRhYmxlIHByZWxvYWQ6IDB4JTAyeFxuIiwKKwkJ
CXB0ci0+bmFtZSwgcHRyLT5zdGF0dXMxKTsKKworCQlpZiAoKHB0ci0+c3RhdHVzMSAmIDB4NCkg
PT0gMCkgeworCQkJZHByaW50aygxLCBLRVJOX0VSUiAiJXM6IGluaXQgYWJvcnRlZCFcbiIsCisJ
CQkJcHRyLT5uYW1lKTsKKwkJCXJldHVybjsJLy8gc29tZXRoaW5nIGlzIHdyb25nLCBpdHMgdGlt
ZWQgb3V0ISEhIQorCQl9CisKKwkJLyogc2V0dXAgbWlzYy4gZGF0YSBmb3IgZXhwYW5zaW9uICov
CisJCXpyMzYwNTBfd3JpdGUocHRyLCBaUjA1MF9NT0RFLCAwKTsKKwkJenIzNjA1MF93cml0ZShw
dHIsIFpSMDUwX01BUktFUlNfRU4sIDApOworCX0KKworCS8qIGFkciBvbiBzZWxlY3RlZCwgdG8g
YWxsb3cgR08gZnJvbSBtYXN0ZXIgKi8KKwl6cjM2MDUwX3JlYWQocHRyLCAwKTsKK30KKworLyog
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQorICAgQ09ERUMgQVBJIEZVTkNUSU9OUworCisgICB0aGlzIGZ1bmN0
aW9ucyBhcmUgYWNjZXNzZWQgYnkgdGhlIG1hc3RlciB2aWEgdGhlIEFQSSBzdHJ1Y3R1cmUKKyAg
ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0gKi8KKworLyogc2V0IGNvbXByZXNzaW9uL2V4cGFuc2lvbiBtb2Rl
IGFuZCBsYXVuY2hlcyBjb2RlYyAtCisgICB0aGlzIHNob3VsZCBiZSB0aGUgbGFzdCBjYWxsIGZy
b20gdGhlIG1hc3RlciBiZWZvcmUgc3RhcnRpbmcgcHJvY2Vzc2luZyAqLworc3RhdGljIGludAor
enIzNjA1MF9zZXRfbW9kZSAoc3RydWN0IHZpZGVvY29kZWMgKmNvZGVjLAorCQkgIGludCAgICAg
ICAgICAgICAgICBtb2RlKQoreworCXN0cnVjdCB6cjM2MDUwICpwdHIgPSAoc3RydWN0IHpyMzYw
NTAgKikgY29kZWMtPmRhdGE7CisKKwlkcHJpbnRrKDIsICIlczogc2V0X21vZGUgJWQgY2FsbFxu
IiwgcHRyLT5uYW1lLCBtb2RlKTsKKworCWlmICgobW9kZSAhPSBDT0RFQ19ET19FWFBBTlNJT04p
ICYmIChtb2RlICE9IENPREVDX0RPX0NPTVBSRVNTSU9OKSkKKwkJcmV0dXJuIC1FSU5WQUw7CisK
KwlwdHItPm1vZGUgPSBtb2RlOworCXpyMzYwNTBfaW5pdChwdHIpOworCisJcmV0dXJuIDA7Cit9
CisKKy8qIHNldCBwaWN0dXJlIHNpemUgKG5vcm0gaXMgaWdub3JlZCBhcyB0aGUgY29kZWMgZG9l
c24ndCBrbm93IGFib3V0IGl0KSAqLworc3RhdGljIGludAorenIzNjA1MF9zZXRfdmlkZW8gKHN0
cnVjdCB2aWRlb2NvZGVjICAgKmNvZGVjLAorCQkgICBzdHJ1Y3QgdHZub3JtICAgICAgICpub3Jt
LAorCQkgICBzdHJ1Y3QgdmZlX3NldHRpbmdzICpjYXAsCisJCSAgIHN0cnVjdCB2ZmVfcG9sYXJp
dHkgKnBvbCkKK3sKKwlzdHJ1Y3QgenIzNjA1MCAqcHRyID0gKHN0cnVjdCB6cjM2MDUwICopIGNv
ZGVjLT5kYXRhOworCWludCBzaXplOworCisJZHByaW50aygyLCAiJXM6IHNldF92aWRlbyAlZC4l
ZCwgJWQvJWQtJWR4JWQgKDB4JXgpIHElZCBjYWxsXG4iLAorCQlwdHItPm5hbWUsIG5vcm0tPkhT
dGFydCwgbm9ybS0+VlN0YXJ0LAorCQljYXAtPngsIGNhcC0+eSwgY2FwLT53aWR0aCwgY2FwLT5o
ZWlnaHQsCisJCWNhcC0+ZGVjaW1hdGlvbiwgY2FwLT5xdWFsaXR5KTsKKwkvKiBpZiAoKSByZXR1
cm4gLUVJTlZBTDsKKwkgKiB0cnVzdCB0aGUgbWFzdGVyIGRyaXZlciB0aGF0IGl0IGtub3dzIHdo
YXQgaXQgZG9lcyAtIHNvCisJICogd2UgYWxsb3cgaW52YWxpZCBzdGFydHgveSBhbmQgbm9ybSBm
b3Igbm93IC4uLiAqLworCXB0ci0+d2lkdGggPSBjYXAtPndpZHRoIC8gKGNhcC0+ZGVjaW1hdGlv
biAmIDB4ZmYpOworCXB0ci0+aGVpZ2h0ID0gY2FwLT5oZWlnaHQgLyAoKGNhcC0+ZGVjaW1hdGlv
biA+PiA4KSAmIDB4ZmYpOworCisJLyogKEtNKSBKUEVHIHF1YWxpdHkgKi8KKwlzaXplID0gcHRy
LT53aWR0aCAqIHB0ci0+aGVpZ2h0OworCXNpemUgKj0gMTY7IC8qIHNpemUgaW4gYml0cyAqLwor
CS8qIGFwcGx5IHF1YWxpdHkgc2V0dGluZyAqLworCXNpemUgPSBzaXplICogY2FwLT5xdWFsaXR5
IC8gMjAwOworCisJLyogTWluaW11bTogMWtiICovCisJaWYgKHNpemUgPCA4MTkyKQorCQlzaXpl
ID0gODE5MjsKKwkvKiBNYXhpbXVtOiA3Lzggb2YgY29kZSBidWZmZXIgKi8KKwlpZiAoc2l6ZSA+
IHB0ci0+dG90YWxfY29kZV92b2wgKiA3KQorCQlzaXplID0gcHRyLT50b3RhbF9jb2RlX3ZvbCAq
IDc7CisKKwlwdHItPnJlYWxfY29kZV92b2wgPSBzaXplID4+IDM7IC8qIGluIGJ5dGVzICovCisK
KwkvKiBTZXQgbWF4X2Jsb2NrX3ZvbCBoZXJlIChwcmV2aW91c2x5IGluIHpyMzYwNTBfaW5pdCwg
bW92ZWQKKwkgKiBoZXJlIGZvciBjb25zaXN0ZW5jeSB3aXRoIHpyMzYwNjAgY29kZSAqLworCXpy
MzYwNTBfd3JpdGUocHRyLCBaUjA1MF9NQkNWLCBwdHItPm1heF9ibG9ja192b2wpOworCisJcmV0
dXJuIDA7Cit9CisKKy8qIGFkZGl0aW9uYWwgY29udHJvbCBmdW5jdGlvbnMgKi8KK3N0YXRpYyBp
bnQKK3pyMzYwNTBfY29udHJvbCAoc3RydWN0IHZpZGVvY29kZWMgKmNvZGVjLAorCQkgaW50ICAg
ICAgICAgICAgICAgIHR5cGUsCisJCSBpbnQgICAgICAgICAgICAgICAgc2l6ZSwKKwkJIHZvaWQg
ICAgICAgICAgICAgICpkYXRhKQoreworCXN0cnVjdCB6cjM2MDUwICpwdHIgPSAoc3RydWN0IHpy
MzYwNTAgKikgY29kZWMtPmRhdGE7CisJaW50ICppdmFsID0gKGludCAqKSBkYXRhOworCisJZHBy
aW50aygyLCAiJXM6IGNvbnRyb2wgJWQgY2FsbCB3aXRoICVkIGJ5dGVcbiIsIHB0ci0+bmFtZSwg
dHlwZSwKKwkJc2l6ZSk7CisKKwlzd2l0Y2ggKHR5cGUpIHsKKwljYXNlIENPREVDX0dfU1RBVFVT
OgkvKiBnZXQgbGFzdCBzdGF0dXMgKi8KKwkJaWYgKHNpemUgIT0gc2l6ZW9mKGludCkpCisJCQly
ZXR1cm4gLUVGQVVMVDsKKwkJenIzNjA1MF9yZWFkX3N0YXR1czEocHRyKTsKKwkJKml2YWwgPSBw
dHItPnN0YXR1czE7CisJCWJyZWFrOworCisJY2FzZSBDT0RFQ19HX0NPREVDX01PREU6CisJCWlm
IChzaXplICE9IHNpemVvZihpbnQpKQorCQkJcmV0dXJuIC1FRkFVTFQ7CisJCSppdmFsID0gQ09E
RUNfTU9ERV9CSlBHOworCQlicmVhazsKKworCWNhc2UgQ09ERUNfU19DT0RFQ19NT0RFOgorCQlp
ZiAoc2l6ZSAhPSBzaXplb2YoaW50KSkKKwkJCXJldHVybiAtRUZBVUxUOworCQlpZiAoKml2YWwg
IT0gQ09ERUNfTU9ERV9CSlBHKQorCQkJcmV0dXJuIC1FSU5WQUw7CisJCS8qIG5vdCBuZWVkZWQs
IGRvIG5vdGhpbmcgKi8KKwkJcmV0dXJuIDA7CisKKwljYXNlIENPREVDX0dfVkZFOgorCWNhc2Ug
Q09ERUNfU19WRkU6CisJCS8qIG5vdCBuZWVkZWQsIGRvIG5vdGhpbmcgKi8KKwkJcmV0dXJuIDA7
CisKKwljYXNlIENPREVDX1NfTU1BUDoKKwkJLyogbm90IGF2YWlsYWJsZSwgZ2l2ZSBhbiBlcnJv
ciAqLworCQlyZXR1cm4gLUVOWElPOworCisJY2FzZSBDT0RFQ19HX0pQRUdfVERTX0JZVEU6CS8q
IGdldCB0YXJnZXQgdm9sdW1lIGluIGJ5dGUgKi8KKwkJaWYgKHNpemUgIT0gc2l6ZW9mKGludCkp
CisJCQlyZXR1cm4gLUVGQVVMVDsKKwkJKml2YWwgPSBwdHItPnRvdGFsX2NvZGVfdm9sOworCQli
cmVhazsKKworCWNhc2UgQ09ERUNfU19KUEVHX1REU19CWVRFOgkvKiBnZXQgdGFyZ2V0IHZvbHVt
ZSBpbiBieXRlICovCisJCWlmIChzaXplICE9IHNpemVvZihpbnQpKQorCQkJcmV0dXJuIC1FRkFV
TFQ7CisJCXB0ci0+dG90YWxfY29kZV92b2wgPSAqaXZhbDsKKwkJLyogKEtpZXJhbiBNb3JyaXNz
ZXkpCisJCSAqIGNvZGUgY29waWVkIGZyb20genIzNjA2MC5jIHRvIGVuc3VyZSBwcm9wZXIgYml0
cmF0ZSAqLworCQlwdHItPnJlYWxfY29kZV92b2wgPSAocHRyLT50b3RhbF9jb2RlX3ZvbCAqIDYp
ID4+IDM7CisJCWJyZWFrOworCisJY2FzZSBDT0RFQ19HX0pQRUdfU0NBTEU6CS8qIGdldCBzY2Fs
aW5nIGZhY3RvciAqLworCQlpZiAoc2l6ZSAhPSBzaXplb2YoaW50KSkKKwkJCXJldHVybiAtRUZB
VUxUOworCQkqaXZhbCA9IHpyMzYwNTBfcmVhZF9zY2FsZWZhY3RvcihwdHIpOworCQlicmVhazsK
KworCWNhc2UgQ09ERUNfU19KUEVHX1NDQUxFOgkvKiBzZXQgc2NhbGluZyBmYWN0b3IgKi8KKwkJ
aWYgKHNpemUgIT0gc2l6ZW9mKGludCkpCisJCQlyZXR1cm4gLUVGQVVMVDsKKwkJcHRyLT5zY2Fs
ZWZhY3QgPSAqaXZhbDsKKwkJYnJlYWs7CisKKwljYXNlIENPREVDX0dfSlBFR19BUFBfREFUQTog
ewkvKiBnZXQgYXBwbiBtYXJrZXIgZGF0YSAqLworCQlzdHJ1Y3QganBlZ19hcHBfbWFya2VyICph
cHAgPSBkYXRhOworCisJCWlmIChzaXplICE9IHNpemVvZihzdHJ1Y3QganBlZ19hcHBfbWFya2Vy
KSkKKwkJCXJldHVybiAtRUZBVUxUOworCisJCSphcHAgPSBwdHItPmFwcDsKKwkJYnJlYWs7CisJ
fQorCisJY2FzZSBDT0RFQ19TX0pQRUdfQVBQX0RBVEE6IHsJIC8qIHNldCBhcHBuIG1hcmtlciBk
YXRhICovCisJCXN0cnVjdCBqcGVnX2FwcF9tYXJrZXIgKmFwcCA9IGRhdGE7CisKKwkJaWYgKHNp
emUgIT0gc2l6ZW9mKHN0cnVjdCBqcGVnX2FwcF9tYXJrZXIpKQorCQkJcmV0dXJuIC1FRkFVTFQ7
CisKKwkJcHRyLT5hcHAgPSAqYXBwOworCQlicmVhazsKKwl9CisKKwljYXNlIENPREVDX0dfSlBF
R19DT01fREFUQTogewkvKiBnZXQgY29tbWVudCBtYXJrZXIgZGF0YSAqLworCQlzdHJ1Y3QganBl
Z19jb21fbWFya2VyICpjb20gPSBkYXRhOworCisJCWlmIChzaXplICE9IHNpemVvZihzdHJ1Y3Qg
anBlZ19jb21fbWFya2VyKSkKKwkJCXJldHVybiAtRUZBVUxUOworCisJCSpjb20gPSBwdHItPmNv
bTsKKwkJYnJlYWs7CisJfQorCisJY2FzZSBDT0RFQ19TX0pQRUdfQ09NX0RBVEE6IHsJLyogc2V0
IGNvbW1lbnQgbWFya2VyIGRhdGEgKi8KKwkJc3RydWN0IGpwZWdfY29tX21hcmtlciAqY29tID0g
ZGF0YTsKKworCQlpZiAoc2l6ZSAhPSBzaXplb2Yoc3RydWN0IGpwZWdfY29tX21hcmtlcikpCisJ
CQlyZXR1cm4gLUVGQVVMVDsKKworCQlwdHItPmNvbSA9ICpjb207CisJCWJyZWFrOworCX0KKwor
CWRlZmF1bHQ6CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJldHVybiBzaXplOworfQorCisv
KiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09CisgICBFeGl0IGFuZCB1bnJlZ2lzdGVyIGZ1bmN0aW9uOgorCisg
ICBEZWluaXRpYWxpemVzIFpvcmFuJ3MgSlBFRyBwcm9jZXNzb3IKKyAgID09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0gKi8KKworc3RhdGljIGludAorenIzNjA1MF91bnNldCAoc3RydWN0IHZpZGVvY29kZWMgKmNv
ZGVjKQoreworCXN0cnVjdCB6cjM2MDUwICpwdHIgPSBjb2RlYy0+ZGF0YTsKKworCWlmIChwdHIp
IHsKKwkJLyogZG8gd2VlIG5lZWQgc29tZSBjb2RlYyBkZWluaXQgaGVyZSwgdG9vID8/Pz8gKi8K
KworCQlkcHJpbnRrKDEsICIlczogZmluaXNoZWQgY29kZWMgIyVkXG4iLCBwdHItPm5hbWUsCisJ
CQlwdHItPm51bSk7CisJCWtmcmVlKHB0cik7CisJCWNvZGVjLT5kYXRhID0gTlVMTDsKKworCQl6
cjM2MDUwX2NvZGVjcy0tOworCQlyZXR1cm4gMDsKKwl9CisKKwlyZXR1cm4gLUVGQVVMVDsKK30K
KworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQorICAgU2V0dXAgYW5kIHJlZ2lzdHJ5IGZ1bmN0aW9uOgor
CisgICBJbml0aWFsaXplcyBab3JhbidzIEpQRUcgcHJvY2Vzc29yCisKKyAgIEFsc28gc2V0cyBw
aXhlbCBzaXplLCBhdmVyYWdlIGNvZGUgc2l6ZSwgbW9kZSAoY29tcHIuL2RlY29tcHIuKQorICAg
KHRoZSBnaXZlbiBzaXplIGlzIGRldGVybWluZWQgYnkgdGhlIHByb2Nlc3NvciB3aXRoIHRoZSB2
aWRlbyBpbnRlcmZhY2UpCisgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCisKK3N0YXRpYyBpbnQKK3py
MzYwNTBfc2V0dXAgKHN0cnVjdCB2aWRlb2NvZGVjICpjb2RlYykKK3sKKwlzdHJ1Y3QgenIzNjA1
MCAqcHRyOworCWludCByZXM7CisKKwlkcHJpbnRrKDIsICJ6cjM2MDUwOiBpbml0aWFsaXppbmcg
TUpQRUcgc3Vic3lzdGVtICMlZC5cbiIsCisJCXpyMzYwNTBfY29kZWNzKTsKKworCWlmICh6cjM2
MDUwX2NvZGVjcyA9PSBNQVhfQ09ERUNTKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJSICJ6
cjM2MDUwOiBDYW4ndCBhdHRhY2ggbW9yZSBjb2RlY3MhXG4iKTsKKwkJcmV0dXJuIC1FTk9TUEM7
CisJfQorCS8vbWVtIHN0cnVjdHVyZSBpbml0CisJY29kZWMtPmRhdGEgPSBwdHIgPSBremFsbG9j
KHNpemVvZihzdHJ1Y3QgenIzNjA1MCksIEdGUF9LRVJORUwpOworCWlmIChOVUxMID09IHB0cikg
eworCQlkcHJpbnRrKDEsIEtFUk5fRVJSICJ6cjM2MDUwOiBDYW4ndCBnZXQgZW5vdWdoIG1lbW9y
eSFcbiIpOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisKKwlzbnByaW50ZihwdHItPm5hbWUsIHNp
emVvZihwdHItPm5hbWUpLCAienIzNjA1MFslZF0iLAorCQkgenIzNjA1MF9jb2RlY3MpOworCXB0
ci0+bnVtID0genIzNjA1MF9jb2RlY3MrKzsKKwlwdHItPmNvZGVjID0gY29kZWM7CisKKwkvL3Rl
c3RpbmcKKwlyZXMgPSB6cjM2MDUwX2Jhc2ljX3Rlc3QocHRyKTsKKwlpZiAocmVzIDwgMCkgewor
CQl6cjM2MDUwX3Vuc2V0KGNvZGVjKTsKKwkJcmV0dXJuIHJlczsKKwl9CisJLy9maW5hbCBzZXR1
cAorCW1lbWNweShwdHItPmhfc2FtcF9yYXRpbywgenIzNjA1MF9kZWNpbWF0aW9uX2gsIDgpOwor
CW1lbWNweShwdHItPnZfc2FtcF9yYXRpbywgenIzNjA1MF9kZWNpbWF0aW9uX3YsIDgpOworCisJ
cHRyLT5iaXRyYXRlX2N0cmwgPSAwOwkvKiAwIG9yIDEgLSBmaXhlZCBmaWxlIHNpemUgZmxhZwor
CQkJCSAqICh3aGF0IGlzIHRoZSBkaWZmZXJlbmNlPykgKi8KKwlwdHItPm1vZGUgPSBDT0RFQ19E
T19DT01QUkVTU0lPTjsKKwlwdHItPndpZHRoID0gMzg0OworCXB0ci0+aGVpZ2h0ID0gMjg4Owor
CXB0ci0+dG90YWxfY29kZV92b2wgPSAxNjAwMDsKKwlwdHItPm1heF9ibG9ja192b2wgPSAyNDA7
CisJcHRyLT5zY2FsZWZhY3QgPSAweDEwMDsKKwlwdHItPmRyaSA9IDE7CisKKwkvKiBubyBhcHAv
Y29tIG1hcmtlciBieSBkZWZhdWx0ICovCisJcHRyLT5hcHAuYXBwbiA9IDA7CisJcHRyLT5hcHAu
bGVuID0gMDsKKwlwdHItPmNvbS5sZW4gPSAwOworCisJenIzNjA1MF9pbml0KHB0cik7CisKKwlk
cHJpbnRrKDEsIEtFUk5fSU5GTyAiJXM6IGNvZGVjIGF0dGFjaGVkIGFuZCBydW5uaW5nXG4iLAor
CQlwdHItPm5hbWUpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgdmlk
ZW9jb2RlYyB6cjM2MDUwX2NvZGVjID0geworCS5vd25lciA9IFRISVNfTU9EVUxFLAorCS5uYW1l
ID0gInpyMzYwNTAiLAorCS5tYWdpYyA9IDBMLAkJLy8gbWFnaWMgbm90IHVzZWQKKwkuZmxhZ3Mg
PQorCSAgICBDT0RFQ19GTEFHX0pQRUcgfCBDT0RFQ19GTEFHX0hBUkRXQVJFIHwgQ09ERUNfRkxB
R19FTkNPREVSIHwKKwkgICAgQ09ERUNfRkxBR19ERUNPREVSLAorCS50eXBlID0gQ09ERUNfVFlQ
RV9aUjM2MDUwLAorCS5zZXR1cCA9IHpyMzYwNTBfc2V0dXAsCS8vIGZ1bmN0aW9uYWxpdHkKKwku
dW5zZXQgPSB6cjM2MDUwX3Vuc2V0LAorCS5zZXRfbW9kZSA9IHpyMzYwNTBfc2V0X21vZGUsCisJ
LnNldF92aWRlbyA9IHpyMzYwNTBfc2V0X3ZpZGVvLAorCS5jb250cm9sID0genIzNjA1MF9jb250
cm9sLAorCS8vIG90aGVycyBhcmUgbm90IHVzZWQKK307CisKKy8qID09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
KyAgIEhPT0sgSU4gRFJJVkVSIEFTIEtFUk5FTCBNT0RVTEUKKyAgID09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g
Ki8KKworc3RhdGljIGludCBfX2luaXQKK3pyMzYwNTBfaW5pdF9tb2R1bGUgKHZvaWQpCit7CisJ
Ly9kcHJpbnRrKDEsICJaUjM2MDUwIGRyaXZlciAlc1xuIixaUjA1MF9WRVJTSU9OKTsKKwl6cjM2
MDUwX2NvZGVjcyA9IDA7CisJcmV0dXJuIHZpZGVvY29kZWNfcmVnaXN0ZXIoJnpyMzYwNTBfY29k
ZWMpOworfQorCitzdGF0aWMgdm9pZCBfX2V4aXQKK3pyMzYwNTBfY2xlYW51cF9tb2R1bGUgKHZv
aWQpCit7CisJaWYgKHpyMzYwNTBfY29kZWNzKSB7CisJCWRwcmludGsoMSwKKwkJCSJ6cjM2MDUw
OiBzb21ldGhpbmcncyB3cm9uZyAtICVkIGNvZGVjcyBsZWZ0IHNvbWVob3cuXG4iLAorCQkJenIz
NjA1MF9jb2RlY3MpOworCX0KKwl2aWRlb2NvZGVjX3VucmVnaXN0ZXIoJnpyMzYwNTBfY29kZWMp
OworfQorCittb2R1bGVfaW5pdCh6cjM2MDUwX2luaXRfbW9kdWxlKTsKK21vZHVsZV9leGl0KHpy
MzYwNTBfY2xlYW51cF9tb2R1bGUpOworCitNT0RVTEVfQVVUSE9SKCJXb2xmZ2FuZyBTY2hlcnIg
PHNjaGVyckBuZXQ0eW91LmF0PiIpOworTU9EVUxFX0RFU0NSSVBUSU9OKCJEcml2ZXIgbW9kdWxl
IGZvciBaUjM2MDUwIGpwZWcgcHJvY2Vzc29ycyAiCisJCSAgIFpSMDUwX1ZFUlNJT04pOworTU9E
VUxFX0xJQ0VOU0UoIkdQTCIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pv
cmFuL3pyMzYwNTAuaCBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDUwLmgKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi45MjM2NDg2ZDNjMmIKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4venIzNjA1MC5oCkBAIC0w
LDAgKzEsMTc5IEBACisvKgorICogWm9yYW4gWlIzNjA1MCBiYXNpYyBjb25maWd1cmF0aW9uIGZ1
bmN0aW9ucyAtIGhlYWRlciBmaWxlCisgKgorICogQ29weXJpZ2h0IChDKSAyMDAxIFdvbGZnYW5n
IFNjaGVyciA8c2NoZXJyQG5ldDR5b3UuYXQ+CisgKgorICogJElkOiB6cjM2MDUwLmgsdiAxLjEu
Mi4yIDIwMDMvMDEvMTQgMjE6MTg6MjIgcmJ1bHRqZSBFeHAgJAorICoKKyAqIC0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQorICoKKyAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlz
dHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CisgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorICogdGhlIEZyZWUgU29m
dHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAq
IChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogVGhpcyBwcm9ncmFt
IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiBi
dXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50
eSBvZgorICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQ
T1NFLiAgU2VlIHRoZQorICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0
YWlscy4KKyAqCisgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKyAqLworCisjaWZuZGVmIFpSMzYwNTBfSAor
I2RlZmluZSBaUjM2MDUwX0gKKworI2luY2x1ZGUgInZpZGVvY29kZWMuaCIKKworLyogZGF0YSBz
dG9yZWQgZm9yIGVhY2ggem9yYW4ganBlZyBjb2RlYyBjaGlwICovCitzdHJ1Y3QgenIzNjA1MCB7
CisJY2hhciBuYW1lWzMyXTsKKwlpbnQgbnVtOworCS8qIGlvIGRhdGFzdHJ1Y3R1cmUgKi8KKwlz
dHJ1Y3QgdmlkZW9jb2RlYyAqY29kZWM7CisJLy8gbGFzdCBjb2RlciBzdGF0dXMKKwlfX3U4IHN0
YXR1czE7CisJLy8gYWN0dWFsIGNvZGVyIHNldHVwCisJaW50IG1vZGU7CisKKwlfX3UxNiB3aWR0
aDsKKwlfX3UxNiBoZWlnaHQ7CisKKwlfX3UxNiBiaXRyYXRlX2N0cmw7CisKKwlfX3UzMiB0b3Rh
bF9jb2RlX3ZvbDsKKwlfX3UzMiByZWFsX2NvZGVfdm9sOworCV9fdTE2IG1heF9ibG9ja192b2w7
CisKKwlfX3U4IGhfc2FtcF9yYXRpb1s4XTsKKwlfX3U4IHZfc2FtcF9yYXRpb1s4XTsKKwlfX3Ux
NiBzY2FsZWZhY3Q7CisJX191MTYgZHJpOworCisJLyogY29tL2FwcCBtYXJrZXIgKi8KKwlzdHJ1
Y3QganBlZ19jb21fbWFya2VyIGNvbTsKKwlzdHJ1Y3QganBlZ19hcHBfbWFya2VyIGFwcDsKK307
CisKKy8qIHpyMzYwNTAgcmVnaXN0ZXIgYWRkcmVzc2VzICovCisjZGVmaW5lIFpSMDUwX0dPICAg
ICAgICAgICAgICAgICAgMHgwMDAKKyNkZWZpbmUgWlIwNTBfSEFSRFdBUkUgICAgICAgICAgICAw
eDAwMgorI2RlZmluZSBaUjA1MF9NT0RFICAgICAgICAgICAgICAgIDB4MDAzCisjZGVmaW5lIFpS
MDUwX09QVElPTlMgICAgICAgICAgICAgMHgwMDQKKyNkZWZpbmUgWlIwNTBfTUJDViAgICAgICAg
ICAgICAgICAweDAwNQorI2RlZmluZSBaUjA1MF9NQVJLRVJTX0VOICAgICAgICAgIDB4MDA2Cisj
ZGVmaW5lIFpSMDUwX0lOVF9SRVFfMCAgICAgICAgICAgMHgwMDcKKyNkZWZpbmUgWlIwNTBfSU5U
X1JFUV8xICAgICAgICAgICAweDAwOAorI2RlZmluZSBaUjA1MF9UQ1ZfTkVUX0hJICAgICAgICAg
IDB4MDA5CisjZGVmaW5lIFpSMDUwX1RDVl9ORVRfTUggICAgICAgICAgMHgwMGEKKyNkZWZpbmUg
WlIwNTBfVENWX05FVF9NTCAgICAgICAgICAweDAwYgorI2RlZmluZSBaUjA1MF9UQ1ZfTkVUX0xP
ICAgICAgICAgIDB4MDBjCisjZGVmaW5lIFpSMDUwX1RDVl9EQVRBX0hJICAgICAgICAgMHgwMGQK
KyNkZWZpbmUgWlIwNTBfVENWX0RBVEFfTUggICAgICAgICAweDAwZQorI2RlZmluZSBaUjA1MF9U
Q1ZfREFUQV9NTCAgICAgICAgIDB4MDBmCisjZGVmaW5lIFpSMDUwX1RDVl9EQVRBX0xPICAgICAg
ICAgMHgwMTAKKyNkZWZpbmUgWlIwNTBfU0ZfSEkgICAgICAgICAgICAgICAweDAxMQorI2RlZmlu
ZSBaUjA1MF9TRl9MTyAgICAgICAgICAgICAgIDB4MDEyCisjZGVmaW5lIFpSMDUwX0FGX0hJICAg
ICAgICAgICAgICAgMHgwMTMKKyNkZWZpbmUgWlIwNTBfQUZfTSAgICAgICAgICAgICAgICAweDAx
NAorI2RlZmluZSBaUjA1MF9BRl9MTyAgICAgICAgICAgICAgIDB4MDE1CisjZGVmaW5lIFpSMDUw
X0FDVl9ISSAgICAgICAgICAgICAgMHgwMTYKKyNkZWZpbmUgWlIwNTBfQUNWX01IICAgICAgICAg
ICAgICAweDAxNworI2RlZmluZSBaUjA1MF9BQ1ZfTUwgICAgICAgICAgICAgIDB4MDE4CisjZGVm
aW5lIFpSMDUwX0FDVl9MTyAgICAgICAgICAgICAgMHgwMTkKKyNkZWZpbmUgWlIwNTBfQUNUX0hJ
ICAgICAgICAgICAgICAweDAxYQorI2RlZmluZSBaUjA1MF9BQ1RfTUggICAgICAgICAgICAgIDB4
MDFiCisjZGVmaW5lIFpSMDUwX0FDVF9NTCAgICAgICAgICAgICAgMHgwMWMKKyNkZWZpbmUgWlIw
NTBfQUNUX0xPICAgICAgICAgICAgICAweDAxZAorI2RlZmluZSBaUjA1MF9BQ1ZfVFJVTl9ISSAg
ICAgICAgIDB4MDFlCisjZGVmaW5lIFpSMDUwX0FDVl9UUlVOX01IICAgICAgICAgMHgwMWYKKyNk
ZWZpbmUgWlIwNTBfQUNWX1RSVU5fTUwgICAgICAgICAweDAyMAorI2RlZmluZSBaUjA1MF9BQ1Zf
VFJVTl9MTyAgICAgICAgIDB4MDIxCisjZGVmaW5lIFpSMDUwX1NUQVRVU18wICAgICAgICAgICAg
MHgwMmUKKyNkZWZpbmUgWlIwNTBfU1RBVFVTXzEgICAgICAgICAgICAweDAyZgorCisjZGVmaW5l
IFpSMDUwX1NPRl9JRFggICAgICAgICAgICAgMHgwNDAKKyNkZWZpbmUgWlIwNTBfU09TMV9JRFgg
ICAgICAgICAgICAweDA3YQorI2RlZmluZSBaUjA1MF9TT1MyX0lEWCAgICAgICAgICAgIDB4MDhh
CisjZGVmaW5lIFpSMDUwX1NPUzNfSURYICAgICAgICAgICAgMHgwOWEKKyNkZWZpbmUgWlIwNTBf
U09TNF9JRFggICAgICAgICAgICAweDBhYQorI2RlZmluZSBaUjA1MF9EUklfSURYICAgICAgICAg
ICAgIDB4MGMwCisjZGVmaW5lIFpSMDUwX0ROTF9JRFggICAgICAgICAgICAgMHgwYzYKKyNkZWZp
bmUgWlIwNTBfRFFUX0lEWCAgICAgICAgICAgICAweDBjYworI2RlZmluZSBaUjA1MF9ESFRfSURY
ICAgICAgICAgICAgIDB4MWQ0CisjZGVmaW5lIFpSMDUwX0FQUF9JRFggICAgICAgICAgICAgMHgz
ODAKKyNkZWZpbmUgWlIwNTBfQ09NX0lEWCAgICAgICAgICAgICAweDNjMAorCisvKiB6cjM2MDUw
IGhhcmR3YXJlIHJlZ2lzdGVyIGJpdHMgKi8KKworI2RlZmluZSBaUjA1MF9IV19CU1dEICAgICAg
ICAgICAgICAgIDB4ODAKKyNkZWZpbmUgWlIwNTBfSFdfTVNUUiAgICAgICAgICAgICAgICAweDQw
CisjZGVmaW5lIFpSMDUwX0hXX0RNQSAgICAgICAgICAgICAgICAgMHgyMAorI2RlZmluZSBaUjA1
MF9IV19DRklTXzFfQ0xLICAgICAgICAgIDB4MDAKKyNkZWZpbmUgWlIwNTBfSFdfQ0ZJU18yX0NM
SyAgICAgICAgICAweDA0CisjZGVmaW5lIFpSMDUwX0hXX0NGSVNfM19DTEsgICAgICAgICAgMHgw
OAorI2RlZmluZSBaUjA1MF9IV19DRklTXzRfQ0xLICAgICAgICAgIDB4MEMKKyNkZWZpbmUgWlIw
NTBfSFdfQ0ZJU181X0NMSyAgICAgICAgICAweDEwCisjZGVmaW5lIFpSMDUwX0hXX0NGSVNfNl9D
TEsgICAgICAgICAgMHgxNAorI2RlZmluZSBaUjA1MF9IV19DRklTXzdfQ0xLICAgICAgICAgIDB4
MTgKKyNkZWZpbmUgWlIwNTBfSFdfQ0ZJU184X0NMSyAgICAgICAgICAweDFDCisjZGVmaW5lIFpS
MDUwX0hXX0JFTEUgICAgICAgICAgICAgICAgMHgwMQorCisvKiB6cjM2MDUwIG1vZGUgcmVnaXN0
ZXIgYml0cyAqLworCisjZGVmaW5lIFpSMDUwX01PX0NPTVAgICAgICAgICAgICAgICAgMHg4MAor
I2RlZmluZSBaUjA1MF9NT19BVFAgICAgICAgICAgICAgICAgIDB4NDAKKyNkZWZpbmUgWlIwNTBf
TU9fUEFTUzIgICAgICAgICAgICAgICAweDIwCisjZGVmaW5lIFpSMDUwX01PX1RMTSAgICAgICAg
ICAgICAgICAgMHgxMAorI2RlZmluZSBaUjA1MF9NT19EQ09OTFkgICAgICAgICAgICAgIDB4MDgK
KyNkZWZpbmUgWlIwNTBfTU9fQlJDICAgICAgICAgICAgICAgICAweDA0CisKKyNkZWZpbmUgWlIw
NTBfTU9fQVRQICAgICAgICAgICAgICAgICAweDQwCisjZGVmaW5lIFpSMDUwX01PX1BBU1MyICAg
ICAgICAgICAgICAgMHgyMAorI2RlZmluZSBaUjA1MF9NT19UTE0gICAgICAgICAgICAgICAgIDB4
MTAKKyNkZWZpbmUgWlIwNTBfTU9fRENPTkxZICAgICAgICAgICAgICAweDA4CisKKy8qIHpyMzYw
NTAgb3B0aW9uIHJlZ2lzdGVyIGJpdHMgKi8KKworI2RlZmluZSBaUjA1MF9PUF9OU0NOXzEgICAg
ICAgICAgICAgIDB4MDAKKyNkZWZpbmUgWlIwNTBfT1BfTlNDTl8yICAgICAgICAgICAgICAweDIw
CisjZGVmaW5lIFpSMDUwX09QX05TQ05fMyAgICAgICAgICAgICAgMHg0MAorI2RlZmluZSBaUjA1
MF9PUF9OU0NOXzQgICAgICAgICAgICAgIDB4NjAKKyNkZWZpbmUgWlIwNTBfT1BfTlNDTl81ICAg
ICAgICAgICAgICAweDgwCisjZGVmaW5lIFpSMDUwX09QX05TQ05fNiAgICAgICAgICAgICAgMHhB
MAorI2RlZmluZSBaUjA1MF9PUF9OU0NOXzcgICAgICAgICAgICAgIDB4QzAKKyNkZWZpbmUgWlIw
NTBfT1BfTlNDTl84ICAgICAgICAgICAgICAweEUwCisjZGVmaW5lIFpSMDUwX09QX09WRiAgICAg
ICAgICAgICAgICAgMHgxMAorCisKKy8qIHpyMzYwNTAgbWFya2Vycy1lbmFibGUgcmVnaXN0ZXIg
Yml0cyAqLworCisjZGVmaW5lIFpSMDUwX01FX0FQUCAgICAgICAgICAgICAgICAgMHg4MAorI2Rl
ZmluZSBaUjA1MF9NRV9DT00gICAgICAgICAgICAgICAgIDB4NDAKKyNkZWZpbmUgWlIwNTBfTUVf
RFJJICAgICAgICAgICAgICAgICAweDIwCisjZGVmaW5lIFpSMDUwX01FX0RRVCAgICAgICAgICAg
ICAgICAgMHgxMAorI2RlZmluZSBaUjA1MF9NRV9ESFQgICAgICAgICAgICAgICAgIDB4MDgKKyNk
ZWZpbmUgWlIwNTBfTUVfRE5MICAgICAgICAgICAgICAgICAweDA0CisjZGVmaW5lIFpSMDUwX01F
X0RRVEkgICAgICAgICAgICAgICAgMHgwMgorI2RlZmluZSBaUjA1MF9NRV9ESFRJICAgICAgICAg
ICAgICAgIDB4MDEKKworLyogenIzNjA1MCBzdGF0dXMwLzEgcmVnaXN0ZXIgYml0IG1hc2tzICov
CisKKyNkZWZpbmUgWlIwNTBfU1RfUlNUX01BU0sgICAgICAgICAgICAweDIwCisjZGVmaW5lIFpS
MDUwX1NUX1NPRl9NQVNLICAgICAgICAgICAgMHgwMgorI2RlZmluZSBaUjA1MF9TVF9TT1NfTUFT
SyAgICAgICAgICAgIDB4MDIKKyNkZWZpbmUgWlIwNTBfU1RfREFUUkRZX01BU0sgICAgICAgICAw
eDgwCisjZGVmaW5lIFpSMDUwX1NUX01SS0RFVF9NQVNLICAgICAgICAgMHg0MAorI2RlZmluZSBa
UjA1MF9TVF9SRk1fTUFTSyAgICAgICAgICAgIDB4MTAKKyNkZWZpbmUgWlIwNTBfU1RfUkZEX01B
U0sgICAgICAgICAgICAweDA4CisjZGVmaW5lIFpSMDUwX1NUX0VORF9NQVNLICAgICAgICAgICAg
MHgwNAorI2RlZmluZSBaUjA1MF9TVF9UQ1ZPVkZfTUFTSyAgICAgICAgIDB4MDIKKyNkZWZpbmUg
WlIwNTBfU1RfREFUT1ZGX01BU0sgICAgICAgICAweDAxCisKKy8qIHBpeGVsIGNvbXBvbmVudCBp
ZHggKi8KKworI2RlZmluZSBaUjA1MF9ZX0NPTVBPTkVOVCAgICAgICAgIDAKKyNkZWZpbmUgWlIw
NTBfVV9DT01QT05FTlQgICAgICAgICAxCisjZGVmaW5lIFpSMDUwX1ZfQ09NUE9ORU5UICAgICAg
ICAgMgorCisjZW5kaWYJCQkJLypmbmRlZiBaUjM2MDUwX0ggKi8KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDU3LmggYi9kcml2ZXJzL3N0YWdpbmcvbWVkaWEv
em9yYW4venIzNjA1Ny5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4u
YzhhY2IyMWRjYjVjCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pv
cmFuL3pyMzYwNTcuaApAQCAtMCwwICsxLDE2NCBAQAorLyoKKyAqIHpyMzYwNTcuaCAtIHpyMzYw
NTcgcmVnaXN0ZXIgb2Zmc2V0cworICoKKyAqIENvcHlyaWdodCAoQykgMTk5OCBEYXZlIFBlcmtz
IDxkcGVya3NAaWJtLm5ldD4KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsg
eW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogaXQgdW5kZXIgdGhlIHRl
cm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAq
IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExp
Y2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAq
IFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUg
dXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGlt
cGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGZvciBtb3JlIGRldGFpbHMuCisgKi8KKworI2lmbmRlZiBfWlIzNjA1N19IXworI2RlZmluZSBf
WlIzNjA1N19IXworCisKKy8qIFpvcmFuIFpSMzYwNTcgcmVnaXN0ZXJzICovCisKKyNkZWZpbmUg
WlIzNjA1N19WRkVIQ1IgICAgICAgICAgMHgwMDAJLyogVmlkZW8gRnJvbnQgRW5kLCBIb3Jpem9u
dGFsIENvbmZpZ3VyYXRpb24gUmVnaXN0ZXIgKi8KKyNkZWZpbmUgWlIzNjA1N19WRkVIQ1JfSFNQ
b2wgICAgICAgICAgICAoMTw8MzApCisjZGVmaW5lIFpSMzYwNTdfVkZFSENSX0hTdGFydCAgICAg
ICAgICAgMTAKKyNkZWZpbmUgWlIzNjA1N19WRkVIQ1JfSEVuZAkJMAorI2RlZmluZSBaUjM2MDU3
X1ZGRUhDUl9IbWFzawkJMHgzZmYKKworI2RlZmluZSBaUjM2MDU3X1ZGRVZDUiAgICAgICAgICAw
eDAwNAkvKiBWaWRlbyBGcm9udCBFbmQsIFZlcnRpY2FsIENvbmZpZ3VyYXRpb24gUmVnaXN0ZXIg
Ki8KKyNkZWZpbmUgWlIzNjA1N19WRkVWQ1JfVlNQb2wgICAgICAgICAgICAoMTw8MzApCisjZGVm
aW5lIFpSMzYwNTdfVkZFVkNSX1ZTdGFydCAgICAgICAgICAgMTAKKyNkZWZpbmUgWlIzNjA1N19W
RkVWQ1JfVkVuZAkJMAorI2RlZmluZSBaUjM2MDU3X1ZGRVZDUl9WbWFzawkJMHgzZmYKKworI2Rl
ZmluZSBaUjM2MDU3X1ZGRVNQRlIgICAgICAgICAweDAwOAkvKiBWaWRlbyBGcm9udCBFbmQsIFNj
YWxlciBhbmQgUGl4ZWwgRm9ybWF0IFJlZ2lzdGVyICovCisjZGVmaW5lIFpSMzYwNTdfVkZFU1BG
Ul9FeHRGbCAgICAgICAgICAgKDE8PDI2KQorI2RlZmluZSBaUjM2MDU3X1ZGRVNQRlJfVG9wRmll
bGQgICAgICAgICgxPDwyNSkKKyNkZWZpbmUgWlIzNjA1N19WRkVTUEZSX1ZDTEtQb2wgICAgICAg
ICAoMTw8MjQpCisjZGVmaW5lIFpSMzYwNTdfVkZFU1BGUl9IRmlsdGVyICAgICAgICAgMjEKKyNk
ZWZpbmUgWlIzNjA1N19WRkVTUEZSX0hvckRjbSAgICAgICAgICAxNAorI2RlZmluZSBaUjM2MDU3
X1ZGRVNQRlJfVmVyRGNtICAgICAgICAgIDgKKyNkZWZpbmUgWlIzNjA1N19WRkVTUEZSX0Rpc3BN
b2RlICAgICAgICA2CisjZGVmaW5lIFpSMzYwNTdfVkZFU1BGUl9ZVVY0MjIgICAgICAgICAgKDA8
PDMpCisjZGVmaW5lIFpSMzYwNTdfVkZFU1BGUl9SR0I4ODggICAgICAgICAgKDE8PDMpCisjZGVm
aW5lIFpSMzYwNTdfVkZFU1BGUl9SR0I1NjUgICAgICAgICAgKDI8PDMpCisjZGVmaW5lIFpSMzYw
NTdfVkZFU1BGUl9SR0I1NTUgICAgICAgICAgKDM8PDMpCisjZGVmaW5lIFpSMzYwNTdfVkZFU1BG
Ul9FcnJEaWYgICAgICAgICAgKDE8PDIpCisjZGVmaW5lIFpSMzYwNTdfVkZFU1BGUl9QYWNrMjQg
ICAgICAgICAgKDE8PDEpCisjZGVmaW5lIFpSMzYwNTdfVkZFU1BGUl9MaXR0bGVFbmRpYW4gICAg
KDE8PDApCisKKyNkZWZpbmUgWlIzNjA1N19WRFRSICAgICAgICAgICAgMHgwMGMJLyogVmlkZW8g
RGlzcGxheSAiVG9wIiBSZWdpc3RlciAqLworCisjZGVmaW5lIFpSMzYwNTdfVkRCUiAgICAgICAg
ICAgIDB4MDEwCS8qIFZpZGVvIERpc3BsYXkgIkJvdHRvbSIgUmVnaXN0ZXIgKi8KKworI2RlZmlu
ZSBaUjM2MDU3X1ZTU0ZHUiAgICAgICAgICAweDAxNAkvKiBWaWRlbyBTdHJpZGUsIFN0YXR1cywg
YW5kIEZyYW1lIEdyYWIgUmVnaXN0ZXIgKi8KKyNkZWZpbmUgWlIzNjA1N19WU1NGR1JfRGlzcFN0
cmlkZSAgICAgICAxNgorI2RlZmluZSBaUjM2MDU3X1ZTU0ZHUl9WaWRPdmYgICAgICAgICAgICgx
PDw4KQorI2RlZmluZSBaUjM2MDU3X1ZTU0ZHUl9TbmFwU2hvdCAgICAgICAgICgxPDwxKQorI2Rl
ZmluZSBaUjM2MDU3X1ZTU0ZHUl9GcmFtZUdyYWIgICAgICAgICgxPDwwKQorCisjZGVmaW5lIFpS
MzYwNTdfVkRDUiAgICAgICAgICAgIDB4MDE4CS8qIFZpZGVvIERpc3BsYXkgQ29uZmlndXJhdGlv
biBSZWdpc3RlciAqLworI2RlZmluZSBaUjM2MDU3X1ZEQ1JfVmlkRW4gICAgICAgICAgICAgICgx
PDwzMSkKKyNkZWZpbmUgWlIzNjA1N19WRENSX01pblBpeCAgICAgICAgICAgICAyNAorI2RlZmlu
ZSBaUjM2MDU3X1ZEQ1JfVHJpdG9uICAgICAgICAgICAgICgxPDwyNCkKKyNkZWZpbmUgWlIzNjA1
N19WRENSX1ZpZFdpbkh0ICAgICAgICAgICAxMgorI2RlZmluZSBaUjM2MDU3X1ZEQ1JfVmlkV2lu
V2lkICAgICAgICAgIDAKKworI2RlZmluZSBaUjM2MDU3X01NVFIgICAgICAgICAgICAweDAxYwkv
KiBNYXNraW5nIE1hcCAiVG9wIiBSZWdpc3RlciAqLworCisjZGVmaW5lIFpSMzYwNTdfTU1CUiAg
ICAgICAgICAgIDB4MDIwCS8qIE1hc2tpbmcgTWFwICJCb3R0b20iIFJlZ2lzdGVyICovCisKKyNk
ZWZpbmUgWlIzNjA1N19PQ1IgICAgICAgICAgICAgMHgwMjQJLyogT3ZlcmxheSBDb250cm9sIFJl
Z2lzdGVyICovCisjZGVmaW5lIFpSMzYwNTdfT0NSX092bEVuYWJsZSAgICAgICAgICAgKDEgPDwg
MTUpCisjZGVmaW5lIFpSMzYwNTdfT0NSX01hc2tTdHJpZGUgICAgICAgICAgMAorCisjZGVmaW5l
IFpSMzYwNTdfU1BHUFBDUiAgICAgICAgIDB4MDI4CS8qIFN5c3RlbSwgUENJLCBhbmQgR2VuZXJh
bCBQdXJwb3NlIFBpbnMgQ29udHJvbCBSZWdpc3RlciAqLworI2RlZmluZSBaUjM2MDU3X1NQR1BQ
Q1JfU29mdFJlc2V0CSgxPDwyNCkKKworI2RlZmluZSBaUjM2MDU3X0dQUEdDUjEgICAgICAgICAw
eDAyYwkvKiBHZW5lcmFsIFB1cnBvc2UgUGlucyBhbmQgR3Vlc3RCdXMgQ29udHJvbCBSZWdpc3Rl
ciAoMSkgKi8KKworI2RlZmluZSBaUjM2MDU3X01DU0FSICAgICAgICAgICAweDAzMAkvKiBNUEVH
IENvZGUgU291cmNlIEFkZHJlc3MgUmVnaXN0ZXIgKi8KKworI2RlZmluZSBaUjM2MDU3X01DVENS
ICAgICAgICAgICAweDAzNAkvKiBNUEVHIENvZGUgVHJhbnNmZXIgQ29udHJvbCBSZWdpc3RlciAq
LworI2RlZmluZSBaUjM2MDU3X01DVENSX0NvZFRpbWUgICAgICAgICAgICgxIDw8IDMwKQorI2Rl
ZmluZSBaUjM2MDU3X01DVENSX0NFbXB0eSAgICAgICAgICAgICgxIDw8IDI5KQorI2RlZmluZSBa
UjM2MDU3X01DVENSX0NGbHVzaCAgICAgICAgICAgICgxIDw8IDI4KQorI2RlZmluZSBaUjM2MDU3
X01DVENSX0NvZEd1ZXN0SUQJMjAKKyNkZWZpbmUgWlIzNjA1N19NQ1RDUl9Db2RHdWVzdFJlZwkx
NgorCisjZGVmaW5lIFpSMzYwNTdfTUNNUFIgICAgICAgICAgIDB4MDM4CS8qIE1QRUcgQ29kZSBN
ZW1vcnkgUG9pbnRlciBSZWdpc3RlciAqLworCisjZGVmaW5lIFpSMzYwNTdfSVNSICAgICAgICAg
ICAgIDB4MDNjCS8qIEludGVycnVwdCBTdGF0dXMgUmVnaXN0ZXIgKi8KKyNkZWZpbmUgWlIzNjA1
N19JU1JfR0lSUTEgICAgICAgICAgICAgICAoMTw8MzApCisjZGVmaW5lIFpSMzYwNTdfSVNSX0dJ
UlEwICAgICAgICAgICAgICAgKDE8PDI5KQorI2RlZmluZSBaUjM2MDU3X0lTUl9Db2RSZXBJUlEg
ICAgICAgICAgICgxPDwyOCkKKyNkZWZpbmUgWlIzNjA1N19JU1JfSlBFR1JlcElSUSAgICAgICAg
ICAoMTw8MjcpCisKKyNkZWZpbmUgWlIzNjA1N19JQ1IgICAgICAgICAgICAgMHgwNDAJLyogSW50
ZXJydXB0IENvbnRyb2wgUmVnaXN0ZXIgKi8KKyNkZWZpbmUgWlIzNjA1N19JQ1JfR0lSUTEgICAg
ICAgICAgICAgICAoMTw8MzApCisjZGVmaW5lIFpSMzYwNTdfSUNSX0dJUlEwICAgICAgICAgICAg
ICAgKDE8PDI5KQorI2RlZmluZSBaUjM2MDU3X0lDUl9Db2RSZXBJUlEgICAgICAgICAgICgxPDwy
OCkKKyNkZWZpbmUgWlIzNjA1N19JQ1JfSlBFR1JlcElSUSAgICAgICAgICAoMTw8MjcpCisjZGVm
aW5lIFpSMzYwNTdfSUNSX0ludFBpbkVuICAgICAgICAgICAgKDE8PDI0KQorCisjZGVmaW5lIFpS
MzYwNTdfSTJDQlIgICAgICAgICAgIDB4MDQ0CS8qIEkyQyBCdXMgUmVnaXN0ZXIgKi8KKyNkZWZp
bmUgWlIzNjA1N19JMkNCUl9TREEJCSgxPDwxKQorI2RlZmluZSBaUjM2MDU3X0kyQ0JSX1NDTAkJ
KDE8PDApCisKKyNkZWZpbmUgWlIzNjA1N19KTUMgICAgICAgICAgICAgMHgxMDAJLyogSlBFRyBN
b2RlIGFuZCBDb250cm9sICovCisjZGVmaW5lIFpSMzYwNTdfSk1DX0pQRyAgICAgICAgICAgICAg
ICAgKDEgPDwgMzEpCisjZGVmaW5lIFpSMzYwNTdfSk1DX0pQR0V4cE1vZGUgICAgICAgICAgKDAg
PDwgMjkpCisjZGVmaW5lIFpSMzYwNTdfSk1DX0pQR0NtcE1vZGUgICAgICAgICAgKDEgPDwgMjkp
CisjZGVmaW5lIFpSMzYwNTdfSk1DX01KUEdFeHBNb2RlICAgICAgICAgKDIgPDwgMjkpCisjZGVm
aW5lIFpSMzYwNTdfSk1DX01KUEdDbXBNb2RlICAgICAgICAgKDMgPDwgMjkpCisjZGVmaW5lIFpS
MzYwNTdfSk1DX1JUQlVTWV9GQiAgICAgICAgICAgKDEgPDwgNikKKyNkZWZpbmUgWlIzNjA1N19K
TUNfR29fZW4gICAgICAgICAgICAgICAoMSA8PCA1KQorI2RlZmluZSBaUjM2MDU3X0pNQ19TeW5j
TXN0ciAgICAgICAgICAgICgxIDw8IDQpCisjZGVmaW5lIFpSMzYwNTdfSk1DX0ZsZF9wZXJfYnVm
ZiAgICAgICAgKDEgPDwgMykKKyNkZWZpbmUgWlIzNjA1N19KTUNfVkZJRk9fRkIgICAgICAgICAg
ICAoMSA8PCAyKQorI2RlZmluZSBaUjM2MDU3X0pNQ19DRklGT19GQiAgICAgICAgICAgICgxIDw8
IDEpCisjZGVmaW5lIFpSMzYwNTdfSk1DX1N0bGxfTGl0RW5kaWFuICAgICAgKDEgPDwgMCkKKwor
I2RlZmluZSBaUjM2MDU3X0pQQyAgICAgICAgICAgICAweDEwNAkvKiBKUEVHIFByb2Nlc3MgQ29u
dHJvbCAqLworI2RlZmluZSBaUjM2MDU3X0pQQ19QX1Jlc2V0ICAgICAgICAgICAgICgxIDw8IDcp
CisjZGVmaW5lIFpSMzYwNTdfSlBDX0NvZFRybnNFbiAgICAgICAgICAgKDEgPDwgNSkKKyNkZWZp
bmUgWlIzNjA1N19KUENfQWN0aXZlICAgICAgICAgICAgICAoMSA8PCAwKQorCisjZGVmaW5lIFpS
MzYwNTdfVlNQICAgICAgICAgICAgIDB4MTA4CS8qIFZlcnRpY2FsIFN5bmMgUGFyYW1ldGVycyAq
LworI2RlZmluZSBaUjM2MDU3X1ZTUF9Wc3luY1NpemUgICAgICAgICAgIDE2CisjZGVmaW5lIFpS
MzYwNTdfVlNQX0ZybVRvdCAgICAgICAgICAgICAgMAorCisjZGVmaW5lIFpSMzYwNTdfSFNQICAg
ICAgICAgICAgIDB4MTBjCS8qIEhvcml6b250YWwgU3luYyBQYXJhbWV0ZXJzICovCisjZGVmaW5l
IFpSMzYwNTdfSFNQX0hzeW5jU3RhcnQgICAgICAgICAgMTYKKyNkZWZpbmUgWlIzNjA1N19IU1Bf
TGluZVRvdCAgICAgICAgICAgICAwCisKKyNkZWZpbmUgWlIzNjA1N19GSEFQICAgICAgICAgICAg
MHgxMTAJLyogRmllbGQgSG9yaXpvbnRhbCBBY3RpdmUgUG9ydGlvbiAqLworI2RlZmluZSBaUjM2
MDU3X0ZIQVBfTkFYICAgICAgICAgICAgICAgIDE2CisjZGVmaW5lIFpSMzYwNTdfRkhBUF9QQVgg
ICAgICAgICAgICAgICAgMAorCisjZGVmaW5lIFpSMzYwNTdfRlZBUCAgICAgICAgICAgIDB4MTE0
CS8qIEZpZWxkIFZlcnRpY2FsIEFjdGl2ZSBQb3J0aW9uICovCisjZGVmaW5lIFpSMzYwNTdfRlZB
UF9OQVkgICAgICAgICAgICAgICAgMTYKKyNkZWZpbmUgWlIzNjA1N19GVkFQX1BBWSAgICAgICAg
ICAgICAgICAwCisKKyNkZWZpbmUgWlIzNjA1N19GUFAgICAgICAgICAgICAgMHgxMTgJLyogRmll
bGQgUHJvY2VzcyBQYXJhbWV0ZXJzICovCisjZGVmaW5lIFpSMzYwNTdfRlBQX09kZF9FdmVuICAg
ICAgICAgICAgKDEgPDwgMCkKKworI2RlZmluZSBaUjM2MDU3X0pDQkEgICAgICAgICAgICAweDEx
YwkvKiBKUEVHIENvZGUgQmFzZSBBZGRyZXNzICovCisKKyNkZWZpbmUgWlIzNjA1N19KQ0ZUICAg
ICAgICAgICAgMHgxMjAJLyogSlBFRyBDb2RlIEZJRk8gVGhyZXNob2xkICovCisKKyNkZWZpbmUg
WlIzNjA1N19KQ0dJICAgICAgICAgICAgMHgxMjQJLyogSlBFRyBDb2RlYyBHdWVzdCBJRCAqLwor
I2RlZmluZSBaUjM2MDU3X0pDR0lfSlBFR3Vlc3RJRCAgICAgICAgIDQKKyNkZWZpbmUgWlIzNjA1
N19KQ0dJX0pQRUd1ZXN0UmVnICAgICAgICAwCisKKyNkZWZpbmUgWlIzNjA1N19HQ1IyICAgICAg
ICAgICAgMHgxMmMJLyogR3Vlc3RCdXMgQ29udHJvbCBSZWdpc3RlciAoMikgKi8KKworI2RlZmlu
ZSBaUjM2MDU3X1BPUiAgICAgICAgICAgICAweDIwMAkvKiBQb3N0IE9mZmljZSBSZWdpc3RlciAq
LworI2RlZmluZSBaUjM2MDU3X1BPUl9QT1BlbiAgICAgICAgICAgICAgICgxPDwyNSkKKyNkZWZp
bmUgWlIzNjA1N19QT1JfUE9UaW1lICAgICAgICAgICAgICAoMTw8MjQpCisjZGVmaW5lIFpSMzYw
NTdfUE9SX1BPRGlyICAgICAgICAgICAgICAgKDE8PDIzKQorCisjZGVmaW5lIFpSMzYwNTdfU1RS
ICAgICAgICAgICAgIDB4MzAwCS8qICJTdGlsbCIgVHJhbnNmZXIgUmVnaXN0ZXIgKi8KKworI2Vu
ZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9yYW4venIzNjA2MC5jIGIv
ZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pyMzYwNjAuYwpuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwMDAuLjJjMmU4MTMwZmM5NgotLS0gL2Rldi9udWxsCisrKyBiL2Ry
aXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDYwLmMKQEAgLTAsMCArMSwxMDA2IEBACisv
KgorICogWm9yYW4gWlIzNjA2MCBiYXNpYyBjb25maWd1cmF0aW9uIGZ1bmN0aW9ucworICoKKyAq
IENvcHlyaWdodCAoQykgMjAwMiBMYXVyZW50IFBpbmNoYXJ0IDxsYXVyZW50LnBpbmNoYXJ0QHNr
eW5ldC5iZT4KKyAqCisgKiAkSWQ6IHpyMzYwNjAuYyx2IDEuMS4yLjIyIDIwMDMvMDUvMDYgMDk6
MzU6MzYgcmJ1bHRqZSBFeHAgJAorICoKKyAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQorICoKKyAqIFRoaXMg
cHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3Ig
bW9kaWZ5CisgKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBM
aWNlbnNlIGFzIHB1Ymxpc2hlZCBieQorICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsg
ZWl0aGVyIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IKKyAqIChhdCB5b3VyIG9wdGlvbikg
YW55IGxhdGVyIHZlcnNpb24uCisgKgorICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGlu
IHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCisgKiBidXQgV0lUSE9VVCBBTlkgV0FS
UkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgorICogTUVSQ0hBTlRB
QklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQorICog
R05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KKyAqCisgKiAtLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KKyAqLworCisjZGVmaW5lIFpSMDYwX1ZFUlNJT04gInYwLjciCisKKyNpbmNs
dWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9pbml0Lmg+CisjaW5jbHVkZSA8
bGludXgvc2xhYi5oPgorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+CisKKyNpbmNsdWRlIDxsaW51
eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L3dhaXQuaD4KKworLyogSS9PIGNvbW1hbmRzLCBl
cnJvciBjb2RlcyAqLworI2luY2x1ZGUgPGFzbS9pby5oPgorCisvKiBoZWFkZXJmaWxlIG9mIHRo
aXMgbW9kdWxlICovCisjaW5jbHVkZSAienIzNjA2MC5oIgorCisvKiBjb2RlYyBpbyBBUEkgKi8K
KyNpbmNsdWRlICJ2aWRlb2NvZGVjLmgiCisKKy8qIGl0IGRvZXNuJ3QgbWFrZSBzZW5zZSB0byBo
YXZlIG1vcmUgdGhhbiAyMCBvciBzbywKKyAganVzdCB0byBwcmV2ZW50IHNvbWUgdW53YW50ZWQg
bG9vcHMgKi8KKyNkZWZpbmUgTUFYX0NPREVDUyAyMAorCisvKiBhbW91bnQgb2YgY2hpcHMgYXR0
YWNoZWQgdmlhIHRoaXMgZHJpdmVyICovCitzdGF0aWMgaW50IHpyMzYwNjBfY29kZWNzOworCitz
dGF0aWMgYm9vbCBsb3dfYml0cmF0ZTsKK21vZHVsZV9wYXJhbShsb3dfYml0cmF0ZSwgYm9vbCwg
MCk7CitNT0RVTEVfUEFSTV9ERVNDKGxvd19iaXRyYXRlLCAiQnV6IGNvbXBhdGliaWxpdHkgb3B0
aW9uLCBoYWx2ZXMgYml0cmF0ZSIpOworCisvKiBkZWJ1Z2dpbmcgaXMgYXZhaWxhYmxlIHZpYSBt
b2R1bGUgcGFyYW1ldGVyICovCitzdGF0aWMgaW50IGRlYnVnOworbW9kdWxlX3BhcmFtKGRlYnVn
LCBpbnQsIDApOworTU9EVUxFX1BBUk1fREVTQyhkZWJ1ZywgIkRlYnVnIGxldmVsICgwLTQpIik7
CisKKyNkZWZpbmUgZHByaW50ayhudW0sIGZvcm1hdCwgYXJncy4uLikgXAorCWRvIHsgXAorCQlp
ZiAoZGVidWcgPj0gbnVtKSBcCisJCQlwcmludGsoZm9ybWF0LCAjI2FyZ3MpOyBcCisJfSB3aGls
ZSAoMCkKKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorICAgTG9jYWwgaGFyZHdhcmUgSS9PIGZ1bmN0
aW9uczoKKworICAgcmVhZC93cml0ZSB2aWEgY29kZWMgbGF5ZXIgKHJlZ2lzdGVycyBhcmUgbG9j
YXRlZCBpbiB0aGUgbWFzdGVyIGRldmljZSkKKyAgID09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKworLyog
cmVhZCBhbmQgd3JpdGUgZnVuY3Rpb25zICovCitzdGF0aWMgdTgKK3pyMzYwNjBfcmVhZCAoc3Ry
dWN0IHpyMzYwNjAgKnB0ciwKKwkgICAgICB1MTYgICAgICAgICAgICAgcmVnKQoreworCXU4IHZh
bHVlID0gMDsKKworCS8vIGp1c3QgaW4gY2FzZSBzb21ldGhpbmcgaXMgd3JvbmcuLi4KKwlpZiAo
cHRyLT5jb2RlYy0+bWFzdGVyX2RhdGEtPnJlYWRyZWcpCisJCXZhbHVlID0gKHB0ci0+Y29kZWMt
Pm1hc3Rlcl9kYXRhLT5yZWFkcmVnKHB0ci0+Y29kZWMsCisJCQkJCQkJICByZWcpKSAmIDB4ZmY7
CisJZWxzZQorCQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUiAiJXM6IGludmFsaWQgSS9PIHNldHVw
LCBub3RoaW5nIHJlYWQhXG4iLAorCQkJcHRyLT5uYW1lKTsKKworCS8vZHByaW50ayg0LCAiJXM6
IHJlYWRpbmcgZnJvbSAweCUwNHg6ICUwMnhcbiIscHRyLT5uYW1lLHJlZyx2YWx1ZSk7CisKKwly
ZXR1cm4gdmFsdWU7Cit9CisKK3N0YXRpYyB2b2lkCit6cjM2MDYwX3dyaXRlKHN0cnVjdCB6cjM2
MDYwICpwdHIsCisJICAgICAgdTE2ICAgICAgICAgICAgIHJlZywKKwkgICAgICB1OCAgICAgICAg
ICAgICAgdmFsdWUpCit7CisJLy9kcHJpbnRrKDQsICIlczogd3JpdGluZyAweCUwMnggdG8gMHgl
MDR4XG4iLHB0ci0+bmFtZSx2YWx1ZSxyZWcpOworCWRwcmludGsoNCwgIjB4JTAyeCBAMHglMDR4
XG4iLCB2YWx1ZSwgcmVnKTsKKworCS8vIGp1c3QgaW4gY2FzZSBzb21ldGhpbmcgaXMgd3Jvbmcu
Li4KKwlpZiAocHRyLT5jb2RlYy0+bWFzdGVyX2RhdGEtPndyaXRlcmVnKQorCQlwdHItPmNvZGVj
LT5tYXN0ZXJfZGF0YS0+d3JpdGVyZWcocHRyLT5jb2RlYywgcmVnLCB2YWx1ZSk7CisJZWxzZQor
CQlkcHJpbnRrKDEsCisJCQlLRVJOX0VSUgorCQkJIiVzOiBpbnZhbGlkIEkvTyBzZXR1cCwgbm90
aGluZyB3cml0dGVuIVxuIiwKKwkJCXB0ci0+bmFtZSk7Cit9CisKKy8qID09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KKyAgIExvY2FsIGhlbHBlciBmdW5jdGlvbjoKKworICAgc3RhdHVzIHJlYWQKKyAgID09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0gKi8KKworLyogc3RhdHVzIGlzIGtlcHQgaW4gZGF0YXN0cnVjdHVyZSAqLwor
c3RhdGljIHU4Cit6cjM2MDYwX3JlYWRfc3RhdHVzIChzdHJ1Y3QgenIzNjA2MCAqcHRyKQorewor
CXB0ci0+c3RhdHVzID0genIzNjA2MF9yZWFkKHB0ciwgWlIwNjBfQ0ZTUik7CisKKwl6cjM2MDYw
X3JlYWQocHRyLCAwKTsKKwlyZXR1cm4gcHRyLT5zdGF0dXM7Cit9CisKKy8qID09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KKyAgIExvY2FsIGhlbHBlciBmdW5jdGlvbjoKKworICAgc2NhbGUgZmFjdG9yIHJlYWQK
KyAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0gKi8KKworLyogc2NhbGUgZmFjdG9yIGlzIGtlcHQgaW4gZGF0
YXN0cnVjdHVyZSAqLworc3RhdGljIHUxNgorenIzNjA2MF9yZWFkX3NjYWxlZmFjdG9yIChzdHJ1
Y3QgenIzNjA2MCAqcHRyKQoreworCXB0ci0+c2NhbGVmYWN0ID0gKHpyMzYwNjBfcmVhZChwdHIs
IFpSMDYwX1NGX0hJKSA8PCA4KSB8CisJCQkgKHpyMzYwNjBfcmVhZChwdHIsIFpSMDYwX1NGX0xP
KSAmIDB4RkYpOworCisJLyogbGVhdmUgMCBzZWxlY3RlZCBmb3IgYW4gZXZlbnR1YWxseSBHTyBm
cm9tIG1hc3RlciAqLworCXpyMzYwNjBfcmVhZChwdHIsIDApOworCXJldHVybiBwdHItPnNjYWxl
ZmFjdDsKK30KKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorICAgTG9jYWwgaGVscGVyIGZ1bmN0aW9u
OgorCisgICB3YWl0IGlmIGNvZGVjIGlzIHJlYWR5IHRvIHByb2NlZWQgKGVuZCBvZiBwcm9jZXNz
aW5nKSBvciB0aW1lIGlzIG92ZXIKKyAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKworc3RhdGljIHZv
aWQKK3pyMzYwNjBfd2FpdF9lbmQgKHN0cnVjdCB6cjM2MDYwICpwdHIpCit7CisJaW50IGkgPSAw
OworCisJd2hpbGUgKHpyMzYwNjBfcmVhZF9zdGF0dXMocHRyKSAmIFpSMDYwX0NGU1JfQnVzeSkg
eworCQl1ZGVsYXkoMSk7CisJCWlmIChpKysgPiAyMDAwMDApIHsJLy8gMjAwbXMsIHRoZXJlIGlz
IGZvciBzdXJlIHNvbWV0aGluZyB3cm9uZyEhIQorCQkJZHByaW50aygxLAorCQkJCSIlczogdGlt
ZW91dCBhdCB3YWl0X2VuZCAobGFzdCBzdGF0dXM6IDB4JTAyeClcbiIsCisJCQkJcHRyLT5uYW1l
LCBwdHItPnN0YXR1cyk7CisJCQlicmVhazsKKwkJfQorCX0KK30KKworLyogPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQorICAgTG9jYWwgaGVscGVyIGZ1bmN0aW9uOgorCisgICBiYXNpYyB0ZXN0IG9mICJjb25u
ZWN0aXZpdHkiLCB3cml0ZXMvcmVhZHMgdG8vZnJvbSBtZW1vcnkgdGhlIFNPRiBtYXJrZXIKKyAg
ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0gKi8KKworc3RhdGljIGludAorenIzNjA2MF9iYXNpY190ZXN0IChz
dHJ1Y3QgenIzNjA2MCAqcHRyKQoreworCWlmICgoenIzNjA2MF9yZWFkKHB0ciwgWlIwNjBfSURS
X0RFVikgIT0gMHgzMykgJiYKKwkgICAgKHpyMzYwNjBfcmVhZChwdHIsIFpSMDYwX0lEUl9SRVYp
ICE9IDB4MDEpKSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5fRVJSCisJCQkiJXM6IGF0dGFjaCBm
YWlsZWQsIGNhbid0IGNvbm5lY3QgdG8ganBlZyBwcm9jZXNzb3IhXG4iLAorCQkJcHRyLT5uYW1l
KTsKKwkJcmV0dXJuIC1FTlhJTzsKKwl9CisKKwl6cjM2MDYwX3dhaXRfZW5kKHB0cik7CisJaWYg
KHB0ci0+c3RhdHVzICYgWlIwNjBfQ0ZTUl9CdXN5KSB7CisJCWRwcmludGsoMSwKKwkJCUtFUk5f
RVJSCisJCQkiJXM6IGF0dGFjaCBmYWlsZWQsIGpwZWcgcHJvY2Vzc29yIGZhaWxlZCAoZW5kIGZs
YWcpIVxuIiwKKwkJCXB0ci0+bmFtZSk7CisJCXJldHVybiAtRUJVU1k7CisJfQorCisJcmV0dXJu
IDA7CQkvKiBsb29rcyBnb29kISAqLworfQorCisvKiA9PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CisgICBMb2Nh
bCBoZWxwZXIgZnVuY3Rpb246CisKKyAgIHNpbXBsZSBsb29wIGZvciBwdXNoaW5nIHRoZSBpbml0
IGRhdGFzZXRzCisgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCisKK3N0YXRpYyBpbnQKK3pyMzYwNjBf
cHVzaGl0IChzdHJ1Y3QgenIzNjA2MCAqcHRyLAorCQl1MTYgICAgICAgICAgICAgc3RhcnRyZWcs
CisJCXUxNiAgICAgICAgICAgICBsZW4sCisJCWNvbnN0IGNoYXIgICAgICpkYXRhKQoreworCWlu
dCBpID0gMDsKKworCWRwcmludGsoNCwgIiVzOiB3cml0ZSBkYXRhIGJsb2NrIHRvIDB4JTA0eCAo
bGVuPSVkKVxuIiwgcHRyLT5uYW1lLAorCQlzdGFydHJlZywgbGVuKTsKKwl3aGlsZSAoaSA8IGxl
bikgeworCQl6cjM2MDYwX3dyaXRlKHB0ciwgc3RhcnRyZWcrKywgZGF0YVtpKytdKTsKKwl9CisK
KwlyZXR1cm4gaTsKK30KKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorICAgQmFzaWMgZGF0YXNldHM6
CisKKyAgIGpwZWcgYmFzZWxpbmUgc2V0dXAgZGF0YSAoeW91IGZpbmQgaXQgb24gbG90cyBwbGFj
ZXMgaW4gaW50ZXJuZXQsIG9yIGp1c3QKKyAgIGV4dHJhY3QgaXQgZnJvbSBhbnkgcmVndWxhciAu
anBnIGltYWdlLi4uKQorCisgICBDb3VsZCBiZSB2YXJpYWJsZSwgYnV0IHVudGlsIGl0J3Mgbm90
IG5lZWRlZCBpdCB0aGV5IGFyZSBqdXN0IGZpeGVkIHRvIHNhdmUKKyAgIG1lbW9yeS4gT3RoZXJ3
aXNlIGV4cGFuZCB6cjM2MDYwIHN0cnVjdHVyZSB3aXRoIGFycmF5cywgcHVzaCB0aGUgdmFsdWVz
IHRvCisgICBpdCBhbmQgaW5pdGlhbGl6ZSBmcm9tIHRoZXJlLCBhcyBlLmcuIHRoZSBsaW51eCB6
cjM2MDU3LzYwIGRyaXZlciBkb2VzIGl0LgorICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLworCitzdGF0
aWMgY29uc3QgY2hhciB6cjM2MDYwX2RxdFsweDg2XSA9IHsKKwkweGZmLCAweGRiLAkJLy9NYXJr
ZXI6IERRVAorCTB4MDAsIDB4ODQsCQkvL0xlbmd0aDogMio2NSsyCisJMHgwMCwJCQkvL1BxLFRx
IGZpcnN0IHRhYmxlCisJMHgxMCwgMHgwYiwgMHgwYywgMHgwZSwgMHgwYywgMHgwYSwgMHgxMCwg
MHgwZSwKKwkweDBkLCAweDBlLCAweDEyLCAweDExLCAweDEwLCAweDEzLCAweDE4LCAweDI4LAor
CTB4MWEsIDB4MTgsIDB4MTYsIDB4MTYsIDB4MTgsIDB4MzEsIDB4MjMsIDB4MjUsCisJMHgxZCwg
MHgyOCwgMHgzYSwgMHgzMywgMHgzZCwgMHgzYywgMHgzOSwgMHgzMywKKwkweDM4LCAweDM3LCAw
eDQwLCAweDQ4LCAweDVjLCAweDRlLCAweDQwLCAweDQ0LAorCTB4NTcsIDB4NDUsIDB4MzcsIDB4
MzgsIDB4NTAsIDB4NmQsIDB4NTEsIDB4NTcsCisJMHg1ZiwgMHg2MiwgMHg2NywgMHg2OCwgMHg2
NywgMHgzZSwgMHg0ZCwgMHg3MSwKKwkweDc5LCAweDcwLCAweDY0LCAweDc4LCAweDVjLCAweDY1
LCAweDY3LCAweDYzLAorCTB4MDEsCQkJLy9QcSxUcSBzZWNvbmQgdGFibGUKKwkweDExLCAweDEy
LCAweDEyLCAweDE4LCAweDE1LCAweDE4LCAweDJmLCAweDFhLAorCTB4MWEsIDB4MmYsIDB4NjMs
IDB4NDIsIDB4MzgsIDB4NDIsIDB4NjMsIDB4NjMsCisJMHg2MywgMHg2MywgMHg2MywgMHg2Mywg
MHg2MywgMHg2MywgMHg2MywgMHg2MywKKwkweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAw
eDYzLCAweDYzLCAweDYzLAorCTB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4
NjMsIDB4NjMsCisJMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2MywgMHg2
MywKKwkweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLCAweDYzLAorCTB4
NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMsIDB4NjMKK307CisKK3N0YXRp
YyBjb25zdCBjaGFyIHpyMzYwNjBfZGh0WzB4MWE0XSA9IHsKKwkweGZmLCAweGM0LAkJLy9NYXJr
ZXI6IERIVAorCTB4MDEsIDB4YTIsCQkvL0xlbmd0aDogMipBQywgMipEQworCTB4MDAsCQkJLy9E
QyBmaXJzdCB0YWJsZQorCTB4MDAsIDB4MDEsIDB4MDUsIDB4MDEsIDB4MDEsIDB4MDEsIDB4MDEs
IDB4MDEsCisJMHgwMSwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwg
MHgwMCwgMHgwMSwKKwkweDAyLCAweDAzLCAweDA0LCAweDA1LCAweDA2LCAweDA3LCAweDA4LCAw
eDA5LCAweDBBLCAweDBCLAorCTB4MDEsCQkJLy9EQyBzZWNvbmQgdGFibGUKKwkweDAwLCAweDAz
LCAweDAxLCAweDAxLCAweDAxLCAweDAxLCAweDAxLCAweDAxLAorCTB4MDEsIDB4MDEsIDB4MDEs
IDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsCisJMHgwMiwgMHgwMywg
MHgwNCwgMHgwNSwgMHgwNiwgMHgwNywgMHgwOCwgMHgwOSwgMHgwQSwgMHgwQiwKKwkweDEwLAkJ
CS8vQUMgZmlyc3QgdGFibGUKKwkweDAwLCAweDAyLCAweDAxLCAweDAzLCAweDAzLCAweDAyLCAw
eDA0LCAweDAzLAorCTB4MDUsIDB4MDUsIDB4MDQsIDB4MDQsIDB4MDAsIDB4MDAsCisJMHgwMSwg
MHg3RCwgMHgwMSwgMHgwMiwgMHgwMywgMHgwMCwgMHgwNCwgMHgxMSwKKwkweDA1LCAweDEyLCAw
eDIxLCAweDMxLCAweDQxLCAweDA2LCAweDEzLCAweDUxLCAweDYxLAorCTB4MDcsIDB4MjIsIDB4
NzEsIDB4MTQsIDB4MzIsIDB4ODEsIDB4OTEsIDB4QTEsCisJMHgwOCwgMHgyMywgMHg0MiwgMHhC
MSwgMHhDMSwgMHgxNSwgMHg1MiwgMHhEMSwgMHhGMCwgMHgyNCwKKwkweDMzLCAweDYyLCAweDcy
LCAweDgyLCAweDA5LCAweDBBLCAweDE2LCAweDE3LAorCTB4MTgsIDB4MTksIDB4MUEsIDB4MjUs
IDB4MjYsIDB4MjcsIDB4MjgsIDB4MjksIDB4MkEsIDB4MzQsCisJMHgzNSwgMHgzNiwgMHgzNywg
MHgzOCwgMHgzOSwgMHgzQSwgMHg0MywgMHg0NCwKKwkweDQ1LCAweDQ2LCAweDQ3LCAweDQ4LCAw
eDQ5LCAweDRBLCAweDUzLCAweDU0LCAweDU1LCAweDU2LAorCTB4NTcsIDB4NTgsIDB4NTksIDB4
NUEsIDB4NjMsIDB4NjQsIDB4NjUsIDB4NjYsCisJMHg2NywgMHg2OCwgMHg2OSwgMHg2QSwgMHg3
MywgMHg3NCwgMHg3NSwgMHg3NiwgMHg3NywgMHg3OCwKKwkweDc5LCAweDdBLCAweDgzLCAweDg0
LCAweDg1LCAweDg2LCAweDg3LCAweDg4LAorCTB4ODksIDB4OEEsIDB4OTIsIDB4OTMsIDB4OTQs
IDB4OTUsIDB4OTYsIDB4OTcsIDB4OTgsIDB4OTksCisJMHg5QSwgMHhBMiwgMHhBMywgMHhBNCwg
MHhBNSwgMHhBNiwgMHhBNywgMHhBOCwKKwkweEE5LCAweEFBLCAweEIyLCAweEIzLCAweEI0LCAw
eEI1LCAweEI2LCAweEI3LCAweEI4LCAweEI5LAorCTB4QkEsIDB4QzIsIDB4QzMsIDB4QzQsIDB4
QzUsIDB4QzYsIDB4QzcsIDB4QzgsCisJMHhDOSwgMHhDQSwgMHhEMiwgMHhEMywgMHhENCwgMHhE
NSwgMHhENiwgMHhENywgMHhEOCwgMHhEOSwKKwkweERBLCAweEUxLCAweEUyLCAweEUzLCAweEU0
LCAweEU1LCAweEU2LCAweEU3LAorCTB4RTgsIDB4RTksIDB4RUEsIDB4RjEsIDB4RjIsIDB4RjMs
IDB4RjQsIDB4RjUsIDB4RjYsIDB4RjcsCisJMHhGOCwgMHhGOSwgMHhGQSwKKwkweDExLAkJCS8v
QUMgc2Vjb25kIHRhYmxlCisJMHgwMCwgMHgwMiwgMHgwMSwgMHgwMiwgMHgwNCwgMHgwNCwgMHgw
MywgMHgwNCwKKwkweDA3LCAweDA1LCAweDA0LCAweDA0LCAweDAwLCAweDAxLAorCTB4MDIsIDB4
NzcsIDB4MDAsIDB4MDEsIDB4MDIsIDB4MDMsIDB4MTEsIDB4MDQsCisJMHgwNSwgMHgyMSwgMHgz
MSwgMHgwNiwgMHgxMiwgMHg0MSwgMHg1MSwgMHgwNywgMHg2MSwgMHg3MSwKKwkweDEzLCAweDIy
LCAweDMyLCAweDgxLCAweDA4LCAweDE0LCAweDQyLCAweDkxLAorCTB4QTEsIDB4QjEsIDB4QzEs
IDB4MDksIDB4MjMsIDB4MzMsIDB4NTIsIDB4RjAsIDB4MTUsIDB4NjIsCisJMHg3MiwgMHhEMSwg
MHgwQSwgMHgxNiwgMHgyNCwgMHgzNCwgMHhFMSwgMHgyNSwKKwkweEYxLCAweDE3LCAweDE4LCAw
eDE5LCAweDFBLCAweDI2LCAweDI3LCAweDI4LCAweDI5LCAweDJBLAorCTB4MzUsIDB4MzYsIDB4
MzcsIDB4MzgsIDB4MzksIDB4M0EsIDB4NDMsIDB4NDQsCisJMHg0NSwgMHg0NiwgMHg0NywgMHg0
OCwgMHg0OSwgMHg0QSwgMHg1MywgMHg1NCwgMHg1NSwgMHg1NiwKKwkweDU3LCAweDU4LCAweDU5
LCAweDVBLCAweDYzLCAweDY0LCAweDY1LCAweDY2LAorCTB4NjcsIDB4NjgsIDB4NjksIDB4NkEs
IDB4NzMsIDB4NzQsIDB4NzUsIDB4NzYsIDB4NzcsIDB4NzgsCisJMHg3OSwgMHg3QSwgMHg4Miwg
MHg4MywgMHg4NCwgMHg4NSwgMHg4NiwgMHg4NywKKwkweDg4LCAweDg5LCAweDhBLCAweDkyLCAw
eDkzLCAweDk0LCAweDk1LCAweDk2LCAweDk3LCAweDk4LAorCTB4OTksIDB4OUEsIDB4QTIsIDB4
QTMsIDB4QTQsIDB4QTUsIDB4QTYsIDB4QTcsCisJMHhBOCwgMHhBOSwgMHhBQSwgMHhCMiwgMHhC
MywgMHhCNCwgMHhCNSwgMHhCNiwgMHhCNywgMHhCOCwKKwkweEI5LCAweEJBLCAweEMyLCAweEMz
LCAweEM0LCAweEM1LCAweEM2LCAweEM3LAorCTB4QzgsIDB4QzksIDB4Q0EsIDB4RDIsIDB4RDMs
IDB4RDQsIDB4RDUsIDB4RDYsIDB4RDcsIDB4RDgsCisJMHhEOSwgMHhEQSwgMHhFMiwgMHhFMywg
MHhFNCwgMHhFNSwgMHhFNiwgMHhFNywKKwkweEU4LCAweEU5LCAweEVBLCAweEYyLCAweEYzLCAw
eEY0LCAweEY1LCAweEY2LCAweEY3LCAweEY4LAorCTB4RjksIDB4RkEKK307CisKKy8qIGpwZWcg
YmFzZWxpbmUgc2V0dXAsIHRoaXMgaXMganVzdCBmaXhlZCBpbiB0aGlzIGRyaXZlciAoWVVWIHBp
Y3R1cmVzKSAqLworI2RlZmluZSBOT19PRl9DT01QT05FTlRTICAgICAgICAgIDB4MwkvL1ksVSxW
CisjZGVmaW5lIEJBU0VMSU5FX1BSRUNJU0lPTiAgICAgICAgMHg4CS8vTUNVIHNpemUgKD8pCitz
dGF0aWMgY29uc3QgY2hhciB6cjM2MDYwX3RxWzhdID0geyAwLCAxLCAxLCAwLCAwLCAwLCAwLCAw
IH07CS8vdGFibGUgaWR4J3MgUVQKK3N0YXRpYyBjb25zdCBjaGFyIHpyMzYwNjBfdGRbOF0gPSB7
IDAsIDEsIDEsIDAsIDAsIDAsIDAsIDAgfTsJLy90YWJsZSBpZHgncyBEQworc3RhdGljIGNvbnN0
IGNoYXIgenIzNjA2MF90YVs4XSA9IHsgMCwgMSwgMSwgMCwgMCwgMCwgMCwgMCB9OwkvL3RhYmxl
IGlkeCdzIEFDCisKKy8qIGhvcml6b250YWwgNDIyIGRlY2ltYXRpb24gc2V0dXAgKG1heWJlIHdl
IHN1cHBvcnQgNDExIG9yIHNvIGxhdGVyLCB0b28pICovCitzdGF0aWMgY29uc3QgY2hhciB6cjM2
MDYwX2RlY2ltYXRpb25faFs4XSA9IHsgMiwgMSwgMSwgMCwgMCwgMCwgMCwgMCB9Oworc3RhdGlj
IGNvbnN0IGNoYXIgenIzNjA2MF9kZWNpbWF0aW9uX3ZbOF0gPSB7IDEsIDEsIDEsIDAsIDAsIDAs
IDAsIDAgfTsKKworLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQorICAgTG9jYWwgaGVscGVyIGZ1bmN0aW9u
czoKKworICAgY2FsY3VsYXRpb24gYW5kIHNldHVwIG9mIHBhcmFtZXRlci1kZXBlbmRlbnQgSlBF
RyBiYXNlbGluZSBzZWdtZW50cworICAgKG5lZWRlZCBmb3IgY29tcHJlc3Npb24gb25seSkKKyAg
ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0gKi8KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLworCisvKiBTT0Yg
KHN0YXJ0IG9mIGZyYW1lKSBzZWdtZW50IGRlcGVuZHMgb24gd2lkdGgsIGhlaWdodCBhbmQgc2Ft
cGxpbmcgcmF0aW8KKwkJCSBvZiBlYWNoIGNvbG9yIGNvbXBvbmVudCAqLworCitzdGF0aWMgaW50
Cit6cjM2MDYwX3NldF9zb2YgKHN0cnVjdCB6cjM2MDYwICpwdHIpCit7CisJY2hhciBzb2ZfZGF0
YVszNF07CS8vIG1heC4gc2l6ZSBvZiByZWdpc3RlciBzZXQKKwlpbnQgaTsKKworCWRwcmludGso
MywgIiVzOiB3cml0ZSBTT0YgKCVkeCVkLCAlZCBjb21wb25lbnRzKVxuIiwgcHRyLT5uYW1lLAor
CQlwdHItPndpZHRoLCBwdHItPmhlaWdodCwgTk9fT0ZfQ09NUE9ORU5UUyk7CisJc29mX2RhdGFb
MF0gPSAweGZmOworCXNvZl9kYXRhWzFdID0gMHhjMDsKKwlzb2ZfZGF0YVsyXSA9IDB4MDA7CisJ
c29mX2RhdGFbM10gPSAoMyAqIE5PX09GX0NPTVBPTkVOVFMpICsgODsKKwlzb2ZfZGF0YVs0XSA9
IEJBU0VMSU5FX1BSRUNJU0lPTjsJLy8gb25seSAnOCcgcG9zc2libGUgd2l0aCB6cjM2MDYwCisJ
c29mX2RhdGFbNV0gPSAocHRyLT5oZWlnaHQpID4+IDg7CisJc29mX2RhdGFbNl0gPSAocHRyLT5o
ZWlnaHQpICYgMHhmZjsKKwlzb2ZfZGF0YVs3XSA9IChwdHItPndpZHRoKSA+PiA4OworCXNvZl9k
YXRhWzhdID0gKHB0ci0+d2lkdGgpICYgMHhmZjsKKwlzb2ZfZGF0YVs5XSA9IE5PX09GX0NPTVBP
TkVOVFM7CisJZm9yIChpID0gMDsgaSA8IE5PX09GX0NPTVBPTkVOVFM7IGkrKykgeworCQlzb2Zf
ZGF0YVsxMCArIChpICogMyldID0gaTsJLy8gaW5kZXggaWRlbnRpZmllcgorCQlzb2ZfZGF0YVsx
MSArIChpICogMyldID0gKHB0ci0+aF9zYW1wX3JhdGlvW2ldIDw8IDQpIHwKKwkJCQkJIChwdHIt
PnZfc2FtcF9yYXRpb1tpXSk7IC8vIHNhbXBsaW5nIHJhdGlvcworCQlzb2ZfZGF0YVsxMiArIChp
ICogMyldID0genIzNjA2MF90cVtpXTsJLy8gUSB0YWJsZSBzZWxlY3Rpb24KKwl9CisJcmV0dXJu
IHpyMzYwNjBfcHVzaGl0KHB0ciwgWlIwNjBfU09GX0lEWCwKKwkJCSAgICAgICgzICogTk9fT0Zf
Q09NUE9ORU5UUykgKyAxMCwgc29mX2RhdGEpOworfQorCisvKiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICov
CisKKy8qIFNPUyAoc3RhcnQgb2Ygc2Nhbikgc2VnbWVudCBkZXBlbmRzIG9uIHRoZSB1c2VkIHNj
YW4gY29tcG9uZW50cworCQkJb2YgZWFjaCBjb2xvciBjb21wb25lbnQgKi8KKworc3RhdGljIGlu
dAorenIzNjA2MF9zZXRfc29zIChzdHJ1Y3QgenIzNjA2MCAqcHRyKQoreworCWNoYXIgc29zX2Rh
dGFbMTZdOwkvLyBtYXguIHNpemUgb2YgcmVnaXN0ZXIgc2V0CisJaW50IGk7CisKKwlkcHJpbnRr
KDMsICIlczogd3JpdGUgU09TXG4iLCBwdHItPm5hbWUpOworCXNvc19kYXRhWzBdID0gMHhmZjsK
Kwlzb3NfZGF0YVsxXSA9IDB4ZGE7CisJc29zX2RhdGFbMl0gPSAweDAwOworCXNvc19kYXRhWzNd
ID0gMiArIDEgKyAoMiAqIE5PX09GX0NPTVBPTkVOVFMpICsgMzsKKwlzb3NfZGF0YVs0XSA9IE5P
X09GX0NPTVBPTkVOVFM7CisJZm9yIChpID0gMDsgaSA8IE5PX09GX0NPTVBPTkVOVFM7IGkrKykg
eworCQlzb3NfZGF0YVs1ICsgKGkgKiAyKV0gPSBpOwkvLyBpbmRleAorCQlzb3NfZGF0YVs2ICsg
KGkgKiAyKV0gPSAoenIzNjA2MF90ZFtpXSA8PCA0KSB8CisJCQkJCXpyMzYwNjBfdGFbaV07IC8v
IEFDL0RDIHRibC5zZWwuCisJfQorCXNvc19kYXRhWzIgKyAxICsgKDIgKiBOT19PRl9DT01QT05F
TlRTKSArIDJdID0gMDA7CS8vIHNjYW4gc3RhcnQKKwlzb3NfZGF0YVsyICsgMSArICgyICogTk9f
T0ZfQ09NUE9ORU5UUykgKyAzXSA9IDB4M2Y7CisJc29zX2RhdGFbMiArIDEgKyAoMiAqIE5PX09G
X0NPTVBPTkVOVFMpICsgNF0gPSAwMDsKKwlyZXR1cm4genIzNjA2MF9wdXNoaXQocHRyLCBaUjA2
MF9TT1NfSURYLAorCQkJICAgICAgNCArIDEgKyAoMiAqIE5PX09GX0NPTVBPTkVOVFMpICsgMywK
KwkJCSAgICAgIHNvc19kYXRhKTsKK30KKworLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLworCisvKiBE
UkkgKGRlZmluZSByZXN0YXJ0IGludGVydmFsKSAqLworCitzdGF0aWMgaW50Cit6cjM2MDYwX3Nl
dF9kcmkgKHN0cnVjdCB6cjM2MDYwICpwdHIpCit7CisJY2hhciBkcmlfZGF0YVs2XTsJLy8gbWF4
LiBzaXplIG9mIHJlZ2lzdGVyIHNldAorCisJZHByaW50aygzLCAiJXM6IHdyaXRlIERSSVxuIiwg
cHRyLT5uYW1lKTsKKwlkcmlfZGF0YVswXSA9IDB4ZmY7CisJZHJpX2RhdGFbMV0gPSAweGRkOwor
CWRyaV9kYXRhWzJdID0gMHgwMDsKKwlkcmlfZGF0YVszXSA9IDB4MDQ7CisJZHJpX2RhdGFbNF0g
PSAocHRyLT5kcmkpID4+IDg7CisJZHJpX2RhdGFbNV0gPSAocHRyLT5kcmkpICYgMHhmZjsKKwly
ZXR1cm4genIzNjA2MF9wdXNoaXQocHRyLCBaUjA2MF9EUklfSURYLCA2LCBkcmlfZGF0YSk7Cit9
CisKKy8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KKyAgIFNldHVwIGZ1bmN0aW9uOgorCisgICBTZXR1cCBj
b21wcmVzc2lvbi9kZWNvbXByZXNzaW9uIG9mIFpvcmFuJ3MgSlBFRyBwcm9jZXNzb3IKKyAgICgg
c2VlIGFsc28gem9yYW4gMzYwNjAgbWFudWFsICkKKworICAgLi4uIHNvcnJ5IGZvciB0aGUgc3Bh
Z2hldHRpIGNvZGUgLi4uCisgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCitzdGF0aWMgdm9pZAorenIz
NjA2MF9pbml0IChzdHJ1Y3QgenIzNjA2MCAqcHRyKQoreworCWludCBzdW0gPSAwOworCWxvbmcg
Yml0Y250LCB0bXA7CisKKwlpZiAocHRyLT5tb2RlID09IENPREVDX0RPX0NPTVBSRVNTSU9OKSB7
CisJCWRwcmludGsoMiwgIiVzOiBDT01QUkVTU0lPTiBTRVRVUFxuIiwgcHRyLT5uYW1lKTsKKwor
CQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfTE9BRCwgWlIwNjBfTE9BRF9TeW5jUnN0KTsKKwor
CQkvKiAwNjAgY29tbXVuaWNhdGVzIHdpdGggMDY3IGluIG1hc3RlciBtb2RlICovCisJCXpyMzYw
NjBfd3JpdGUocHRyLCBaUjA2MF9DSVIsIFpSMDYwX0NJUl9Db2RlTXN0cik7CisKKwkJLyogQ29t
cHJlc3Npb24gd2l0aCBvciB3aXRob3V0IHZhcmlhYmxlIHNjYWxlIGZhY3RvciAqLworCQkvKkZJ
WE1FOiBXaGF0IGFib3V0IHB0ci0+Yml0cmF0ZV9jdHJsPyAqLworCQl6cjM2MDYwX3dyaXRlKHB0
ciwgWlIwNjBfQ01SLAorCQkJICAgICAgWlIwNjBfQ01SX0NvbXAgfCBaUjA2MF9DTVJfUGFzczIg
fAorCQkJICAgICAgWlIwNjBfQ01SX0JSQik7CisKKwkJLyogTXVzdCBiZSB6ZXJvICovCisJCXpy
MzYwNjBfd3JpdGUocHRyLCBaUjA2MF9NQlosIDB4MDApOworCQl6cjM2MDYwX3dyaXRlKHB0ciwg
WlIwNjBfVENSX0hJLCAweDAwKTsKKwkJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX1RDUl9MTywg
MHgwMCk7CisKKwkJLyogRGlzYWJsZSBhbGwgSVJRcyAtIG5vIERhdGFFcnIgbWVhbnMgYXV0b3Jl
c2V0ICovCisJCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9JTVIsIDApOworCisJCS8qIHZvbHVt
ZSBjb250cm9sIHNldHRpbmdzICovCisJCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9TRl9ISSwg
cHRyLT5zY2FsZWZhY3QgPj4gOCk7CisJCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9TRl9MTywg
cHRyLT5zY2FsZWZhY3QgJiAweGZmKTsKKworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfQUZf
SEksIDB4ZmYpOworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfQUZfTSwgMHhmZik7CisJCXpy
MzYwNjBfd3JpdGUocHRyLCBaUjA2MF9BRl9MTywgMHhmZik7CisKKwkJLyogc2V0dXAgdGhlIHZh
cmlhYmxlIGpwZWcgdGFibGVzICovCisJCXN1bSArPSB6cjM2MDYwX3NldF9zb2YocHRyKTsKKwkJ
c3VtICs9IHpyMzYwNjBfc2V0X3NvcyhwdHIpOworCQlzdW0gKz0genIzNjA2MF9zZXRfZHJpKHB0
cik7CisKKwkJLyogc2V0dXAgdGhlIGZpeGVkIGpwZWcgdGFibGVzIC0gbWF5YmUgdmFyaWFibGUs
IHRob3VnaCAtCisJCSAqIChzZWUgdGFibGUgaW5pdCBzZWN0aW9uIGFib3ZlKSAqLworCQlzdW0g
Kz0KKwkJICAgIHpyMzYwNjBfcHVzaGl0KHB0ciwgWlIwNjBfRFFUX0lEWCwgc2l6ZW9mKHpyMzYw
NjBfZHF0KSwKKwkJCQkgICB6cjM2MDYwX2RxdCk7CisJCXN1bSArPQorCQkgICAgenIzNjA2MF9w
dXNoaXQocHRyLCBaUjA2MF9ESFRfSURYLCBzaXplb2YoenIzNjA2MF9kaHQpLAorCQkJCSAgIHpy
MzYwNjBfZGh0KTsKKwkJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX0FQUF9JRFgsIDB4ZmYpOwor
CQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfQVBQX0lEWCArIDEsIDB4ZTAgKyBwdHItPmFwcC5h
cHBuKTsKKwkJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX0FQUF9JRFggKyAyLCAweDAwKTsKKwkJ
enIzNjA2MF93cml0ZShwdHIsIFpSMDYwX0FQUF9JRFggKyAzLCBwdHItPmFwcC5sZW4gKyAyKTsK
KwkJc3VtICs9IHpyMzYwNjBfcHVzaGl0KHB0ciwgWlIwNjBfQVBQX0lEWCArIDQsIDYwLAorCQkJ
CSAgICAgIHB0ci0+YXBwLmRhdGEpICsgNDsKKwkJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX0NP
TV9JRFgsIDB4ZmYpOworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfQ09NX0lEWCArIDEsIDB4
ZmUpOworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfQ09NX0lEWCArIDIsIDB4MDApOworCQl6
cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfQ09NX0lEWCArIDMsIHB0ci0+Y29tLmxlbiArIDIpOwor
CQlzdW0gKz0genIzNjA2MF9wdXNoaXQocHRyLCBaUjA2MF9DT01fSURYICsgNCwgNjAsCisJCQkJ
ICAgICAgcHRyLT5jb20uZGF0YSkgKyA0OworCisJCS8qIHNldHVwIG1pc2MuIGRhdGEgZm9yIGNv
bXByZXNzaW9uICh0YXJnZXQgY29kZSBzaXplcykgKi8KKworCQkvKiBzaXplIG9mIGNvbXByZXNz
ZWQgY29kZSB0byByZWFjaCB3aXRob3V0IGhlYWRlciBkYXRhICovCisJCXN1bSA9IHB0ci0+cmVh
bF9jb2RlX3ZvbCAtIHN1bTsKKwkJYml0Y250ID0gc3VtIDw8IDM7CS8qIG5lZWQgdGhlIHNpemUg
aW4gYml0cyAqLworCisJCXRtcCA9IGJpdGNudCA+PiAxNjsKKwkJZHByaW50aygzLAorCQkJIiVz
OiBjb2RlOiBjc2l6ZT0lZCwgdG90PSVkLCBiaXQ9JWxkLCBoaWdoYml0cz0lbGRcbiIsCisJCQlw
dHItPm5hbWUsIHN1bSwgcHRyLT5yZWFsX2NvZGVfdm9sLCBiaXRjbnQsIHRtcCk7CisJCXpyMzYw
NjBfd3JpdGUocHRyLCBaUjA2MF9UQ1ZfTkVUX0hJLCB0bXAgPj4gOCk7CisJCXpyMzYwNjBfd3Jp
dGUocHRyLCBaUjA2MF9UQ1ZfTkVUX01ILCB0bXAgJiAweGZmKTsKKwkJdG1wID0gYml0Y250ICYg
MHhmZmZmOworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfVENWX05FVF9NTCwgdG1wID4+IDgp
OworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfVENWX05FVF9MTywgdG1wICYgMHhmZik7CisK
KwkJYml0Y250IC09IGJpdGNudCA+PiA3OwkvLyBiaXRzIHdpdGhvdXQgc3R1ZmZpbmcKKwkJYml0
Y250IC09ICgoYml0Y250ICogNSkgPj4gNik7CS8vIGJpdHMgd2l0aG91dCBlb2IKKworCQl0bXAg
PSBiaXRjbnQgPj4gMTY7CisJCWRwcmludGsoMywgIiVzOiBjb2RlOiBuZXR0b2JpdD0lbGQsIGhp
Z2huZXR0b2JpdHM9JWxkXG4iLAorCQkJcHRyLT5uYW1lLCBiaXRjbnQsIHRtcCk7CisJCXpyMzYw
NjBfd3JpdGUocHRyLCBaUjA2MF9UQ1ZfREFUQV9ISSwgdG1wID4+IDgpOworCQl6cjM2MDYwX3dy
aXRlKHB0ciwgWlIwNjBfVENWX0RBVEFfTUgsIHRtcCAmIDB4ZmYpOworCQl0bXAgPSBiaXRjbnQg
JiAweGZmZmY7CisJCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9UQ1ZfREFUQV9NTCwgdG1wID4+
IDgpOworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfVENWX0RBVEFfTE8sIHRtcCAmIDB4ZmYp
OworCisJCS8qIEpQRUcgbWFya2VycyB0byBiZSBpbmNsdWRlZCBpbiB0aGUgY29tcHJlc3NlZCBz
dHJlYW0gKi8KKwkJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX01FUiwKKwkJCSAgICAgIFpSMDYw
X01FUl9EUVQgfCBaUjA2MF9NRVJfREhUIHwKKwkJCSAgICAgICgocHRyLT5jb20ubGVuID4gMCkg
PyBaUjA2MF9NRVJfQ29tIDogMCkgfAorCQkJICAgICAgKChwdHItPmFwcC5sZW4gPiAwKSA/IFpS
MDYwX01FUl9BcHAgOiAwKSk7CisKKwkJLyogU2V0dXAgdGhlIFZpZGVvIEZyb250ZW5kICovCisJ
CS8qIExpbWl0IHBpeGVsIHJhbmdlIHRvIDE2Li4yMzUgYXMgcGVyIENDSVItNjAxICovCisJCXpy
MzYwNjBfd3JpdGUocHRyLCBaUjA2MF9WQ1IsIFpSMDYwX1ZDUl9SYW5nZSk7CisKKwl9IGVsc2Ug
eworCQlkcHJpbnRrKDIsICIlczogRVhQQU5TSU9OIFNFVFVQXG4iLCBwdHItPm5hbWUpOworCisJ
CXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9MT0FELCBaUjA2MF9MT0FEX1N5bmNSc3QpOworCisJ
CS8qIDA2MCBjb21tdW5pY2F0ZXMgd2l0aCAwNjcgaW4gbWFzdGVyIG1vZGUgKi8KKwkJenIzNjA2
MF93cml0ZShwdHIsIFpSMDYwX0NJUiwgWlIwNjBfQ0lSX0NvZGVNc3RyKTsKKworCQkvKiBEZWNv
bXByZXNzaW9uICovCisJCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9DTVIsIDApOworCisJCS8q
IE11c3QgYmUgemVybyAqLworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfTUJaLCAweDAwKTsK
KwkJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX1RDUl9ISSwgMHgwMCk7CisJCXpyMzYwNjBfd3Jp
dGUocHRyLCBaUjA2MF9UQ1JfTE8sIDB4MDApOworCisJCS8qIERpc2FibGUgYWxsIElSUXMgLSBu
byBEYXRhRXJyIG1lYW5zIGF1dG9yZXNldCAqLworCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBf
SU1SLCAwKTsKKworCQkvKiBzZXR1cCBtaXNjLiBkYXRhIGZvciBleHBhbnNpb24gKi8KKwkJenIz
NjA2MF93cml0ZShwdHIsIFpSMDYwX01FUiwgMCk7CisKKwkJLyogc2V0dXAgdGhlIGZpeGVkIGpw
ZWcgdGFibGVzIC0gbWF5YmUgdmFyaWFibGUsIHRob3VnaCAtCisJCSAqIChzZWUgdGFibGUgaW5p
dCBzZWN0aW9uIGFib3ZlKSAqLworCQl6cjM2MDYwX3B1c2hpdChwdHIsIFpSMDYwX0RIVF9JRFgs
IHNpemVvZih6cjM2MDYwX2RodCksCisJCQkgICAgICAgenIzNjA2MF9kaHQpOworCisJCS8qIFNl
dHVwIHRoZSBWaWRlbyBGcm9udGVuZCAqLworCQkvL3pyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9W
Q1IsIFpSMDYwX1ZDUl9GSUV4dCk7CisJCS8vdGhpcyBkb2Vzbid0IHNlZW0gcmlnaHQgYW5kIGRv
ZXNuJ3Qgd29yay4uLgorCQl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfVkNSLCBaUjA2MF9WQ1Jf
UmFuZ2UpOworCX0KKworCS8qIExvYWQgdGhlIHRhYmxlcyAqLworCXpyMzYwNjBfd3JpdGUocHRy
LCBaUjA2MF9MT0FELAorCQkgICAgICBaUjA2MF9MT0FEX1N5bmNSc3QgfCBaUjA2MF9MT0FEX0xv
YWQpOworCXpyMzYwNjBfd2FpdF9lbmQocHRyKTsKKwlkcHJpbnRrKDIsICIlczogU3RhdHVzIGFm
dGVyIHRhYmxlIHByZWxvYWQ6IDB4JTAyeFxuIiwgcHRyLT5uYW1lLAorCQlwdHItPnN0YXR1cyk7
CisKKwlpZiAocHRyLT5zdGF0dXMgJiBaUjA2MF9DRlNSX0J1c3kpIHsKKwkJZHByaW50aygxLCBL
RVJOX0VSUiAiJXM6IGluaXQgYWJvcnRlZCFcbiIsIHB0ci0+bmFtZSk7CisJCXJldHVybjsJCS8v
IHNvbWV0aGluZyBpcyB3cm9uZywgaXRzIHRpbWVkIG91dCEhISEKKwl9Cit9CisKKy8qID09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KKyAgIENPREVDIEFQSSBGVU5DVElPTlMKKworICAgdGhpcyBmdW5jdGlvbnMg
YXJlIGFjY2Vzc2VkIGJ5IHRoZSBtYXN0ZXIgdmlhIHRoZSBBUEkgc3RydWN0dXJlCisgICA9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09ICovCisKKy8qIHNldCBjb21wcmVzc2lvbi9leHBhbnNpb24gbW9kZSBhbmQg
bGF1bmNoZXMgY29kZWMgLQorICAgdGhpcyBzaG91bGQgYmUgdGhlIGxhc3QgY2FsbCBmcm9tIHRo
ZSBtYXN0ZXIgYmVmb3JlIHN0YXJ0aW5nIHByb2Nlc3NpbmcgKi8KK3N0YXRpYyBpbnQKK3pyMzYw
NjBfc2V0X21vZGUgKHN0cnVjdCB2aWRlb2NvZGVjICpjb2RlYywKKwkJICBpbnQgICAgICAgICAg
ICAgICAgbW9kZSkKK3sKKwlzdHJ1Y3QgenIzNjA2MCAqcHRyID0gKHN0cnVjdCB6cjM2MDYwICop
IGNvZGVjLT5kYXRhOworCisJZHByaW50aygyLCAiJXM6IHNldF9tb2RlICVkIGNhbGxcbiIsIHB0
ci0+bmFtZSwgbW9kZSk7CisKKwlpZiAoKG1vZGUgIT0gQ09ERUNfRE9fRVhQQU5TSU9OKSAmJiAo
bW9kZSAhPSBDT0RFQ19ET19DT01QUkVTU0lPTikpCisJCXJldHVybiAtRUlOVkFMOworCisJcHRy
LT5tb2RlID0gbW9kZTsKKwl6cjM2MDYwX2luaXQocHRyKTsKKworCXJldHVybiAwOworfQorCisv
KiBzZXQgcGljdHVyZSBzaXplIChub3JtIGlzIGlnbm9yZWQgYXMgdGhlIGNvZGVjIGRvZXNuJ3Qg
a25vdyBhYm91dCBpdCkgKi8KK3N0YXRpYyBpbnQKK3pyMzYwNjBfc2V0X3ZpZGVvIChzdHJ1Y3Qg
dmlkZW9jb2RlYyAgICpjb2RlYywKKwkJICAgc3RydWN0IHR2bm9ybSAgICAgICAqbm9ybSwKKwkJ
ICAgc3RydWN0IHZmZV9zZXR0aW5ncyAqY2FwLAorCQkgICBzdHJ1Y3QgdmZlX3BvbGFyaXR5ICpw
b2wpCit7CisJc3RydWN0IHpyMzYwNjAgKnB0ciA9IChzdHJ1Y3QgenIzNjA2MCAqKSBjb2RlYy0+
ZGF0YTsKKwl1MzIgcmVnOworCWludCBzaXplOworCisJZHByaW50aygyLCAiJXM6IHNldF92aWRl
byAlZC8lZC0lZHglZCAoJSUlZCkgY2FsbFxuIiwgcHRyLT5uYW1lLAorCQljYXAtPngsIGNhcC0+
eSwgY2FwLT53aWR0aCwgY2FwLT5oZWlnaHQsIGNhcC0+ZGVjaW1hdGlvbik7CisKKwkvKiBpZiAo
KSByZXR1cm4gLUVJTlZBTDsKKwkgKiB0cnVzdCB0aGUgbWFzdGVyIGRyaXZlciB0aGF0IGl0IGtu
b3dzIHdoYXQgaXQgZG9lcyAtIHNvCisJICogd2UgYWxsb3cgaW52YWxpZCBzdGFydHgveSBhbmQg
bm9ybSBmb3Igbm93IC4uLiAqLworCXB0ci0+d2lkdGggPSBjYXAtPndpZHRoIC8gKGNhcC0+ZGVj
aW1hdGlvbiAmIDB4ZmYpOworCXB0ci0+aGVpZ2h0ID0gY2FwLT5oZWlnaHQgLyAoY2FwLT5kZWNp
bWF0aW9uID4+IDgpOworCisJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX0xPQUQsIFpSMDYwX0xP
QURfU3luY1JzdCk7CisKKwkvKiBOb3RlIHRoYXQgVlNQb2wvSFNQb2wgYml0cyBpbiB6cjM2MDYw
IGhhdmUgdGhlIG9wcG9zaXRlCisJICogbWVhbmluZyBvZiB0aGVpciB6cjM2MHg3IGNvdW50ZXJw
YXJ0cyB3aXRoIHRoZSBzYW1lIG5hbWVzCisJICogTi5iLiBmb3IgVlNQb2wgdGhpcyBpcyBvbmx5
IHRydWUgaWYgRklWRWRnZSA9IDAgKGRlZmF1bHQsCisJICogbGVmdCB1bmNoYW5nZWQgaGVyZSAt
IGluIGFjY29yZGFuY2Ugd2l0aCBkYXRhc2hlZXQpLgorCSovCisJcmVnID0gKCFwb2wtPnZzeW5j
X3BvbCA/IFpSMDYwX1ZQUl9WU1BvbCA6IDApCisJICAgIHwgKCFwb2wtPmhzeW5jX3BvbCA/IFpS
MDYwX1ZQUl9IU1BvbCA6IDApCisJICAgIHwgKHBvbC0+ZmllbGRfcG9sID8gWlIwNjBfVlBSX0ZJ
UG9sIDogMCkKKwkgICAgfCAocG9sLT5ibGFua19wb2wgPyBaUjA2MF9WUFJfQkxQb2wgOiAwKQor
CSAgICB8IChwb2wtPnN1YmltZ19wb2wgPyBaUjA2MF9WUFJfU0ltZ1BvbCA6IDApCisJICAgIHwg
KHBvbC0+cG9lX3BvbCA/IFpSMDYwX1ZQUl9Qb2VQb2wgOiAwKQorCSAgICB8IChwb2wtPnB2YWxp
ZF9wb2wgPyBaUjA2MF9WUFJfUFZhbFBvbCA6IDApCisJICAgIHwgKHBvbC0+dmNsa19wb2wgPyBa
UjA2MF9WUFJfVkNMS1BvbCA6IDApOworCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9WUFIsIHJl
Zyk7CisKKwlyZWcgPSAwOworCXN3aXRjaCAoY2FwLT5kZWNpbWF0aW9uICYgMHhmZikgeworCWRl
ZmF1bHQ6CisJY2FzZSAxOgorCQlicmVhazsKKworCWNhc2UgMjoKKwkJcmVnIHw9IFpSMDYwX1NS
X0hTY2FsZTI7CisJCWJyZWFrOworCisJY2FzZSA0OgorCQlyZWcgfD0gWlIwNjBfU1JfSFNjYWxl
NDsKKwkJYnJlYWs7CisJfQorCisJc3dpdGNoIChjYXAtPmRlY2ltYXRpb24gPj4gOCkgeworCWRl
ZmF1bHQ6CisJY2FzZSAxOgorCQlicmVhazsKKworCWNhc2UgMjoKKwkJcmVnIHw9IFpSMDYwX1NS
X1ZTY2FsZTsKKwkJYnJlYWs7CisJfQorCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9TUiwgcmVn
KTsKKworCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9CQ1JfWSwgMHgwMCk7CisJenIzNjA2MF93
cml0ZShwdHIsIFpSMDYwX0JDUl9VLCAweDgwKTsKKwl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBf
QkNSX1YsIDB4ODApOworCisJLyogc3luYyBnZW5lcmF0b3IgKi8KKworCXJlZyA9IG5vcm0tPkh0
IC0gMTsJLyogVnRvdGFsICovCisJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX1NHUl9WVE9UQUxf
SEksIChyZWcgPj4gOCkgJiAweGZmKTsKKwl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfU0dSX1ZU
T1RBTF9MTywgKHJlZyA+PiAwKSAmIDB4ZmYpOworCisJcmVnID0gbm9ybS0+V3QgLSAxOwkvKiBI
dG90YWwgKi8KKwl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfU0dSX0hUT1RBTF9ISSwgKHJlZyA+
PiA4KSAmIDB4ZmYpOworCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9TR1JfSFRPVEFMX0xPLCAo
cmVnID4+IDApICYgMHhmZik7CisKKwlyZWcgPSA2IC0gMTsJCS8qIFZzeW5jU2l6ZSAqLworCXpy
MzYwNjBfd3JpdGUocHRyLCBaUjA2MF9TR1JfVlNZTkMsIHJlZyk7CisKKwkvL3JlZyAgID0gMzAg
LSAxOyAgICAgICAgICAgICAgIC8qIEhzeW5jU2l6ZSAqLworLy8vKkNQKi8gICAgICAgIHJlZyA9
ICh6ci0+cGFyYW1zLm5vcm0gPT0gMSA/IDU3IDogNjgpOworCXJlZyA9IDY4OworCXpyMzYwNjBf
d3JpdGUocHRyLCBaUjA2MF9TR1JfSFNZTkMsIHJlZyk7CisKKwlyZWcgPSBub3JtLT5WU3RhcnQg
LSAxOwkvKiBCVnN0YXJ0ICovCisJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX1NHUl9CVlNUQVJU
LCByZWcpOworCisJcmVnICs9IG5vcm0tPkhhIC8gMjsJLyogQlZlbmQgKi8KKwl6cjM2MDYwX3dy
aXRlKHB0ciwgWlIwNjBfU0dSX0JWRU5EX0hJLCAocmVnID4+IDgpICYgMHhmZik7CisJenIzNjA2
MF93cml0ZShwdHIsIFpSMDYwX1NHUl9CVkVORF9MTywgKHJlZyA+PiAwKSAmIDB4ZmYpOworCisJ
cmVnID0gbm9ybS0+SFN0YXJ0IC0gMTsJLyogQkhzdGFydCAqLworCXpyMzYwNjBfd3JpdGUocHRy
LCBaUjA2MF9TR1JfQkhTVEFSVCwgcmVnKTsKKworCXJlZyArPSBub3JtLT5XYTsJLyogQkhlbmQg
Ki8KKwl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfU0dSX0JIRU5EX0hJLCAocmVnID4+IDgpICYg
MHhmZik7CisJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX1NHUl9CSEVORF9MTywgKHJlZyA+PiAw
KSAmIDB4ZmYpOworCisJLyogYWN0aXZlIGFyZWEgKi8KKwlyZWcgPSBjYXAtPnkgKyBub3JtLT5W
U3RhcnQ7CS8qIFZzdGFydCAqLworCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9BQVJfVlNUQVJU
X0hJLCAocmVnID4+IDgpICYgMHhmZik7CisJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX0FBUl9W
U1RBUlRfTE8sIChyZWcgPj4gMCkgJiAweGZmKTsKKworCXJlZyArPSBjYXAtPmhlaWdodDsJLyog
VmVuZCAqLworCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9BQVJfVkVORF9ISSwgKHJlZyA+PiA4
KSAmIDB4ZmYpOworCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9BQVJfVkVORF9MTywgKHJlZyA+
PiAwKSAmIDB4ZmYpOworCisJcmVnID0gY2FwLT54ICsgbm9ybS0+SFN0YXJ0OwkvKiBIc3RhcnQg
Ki8KKwl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfQUFSX0hTVEFSVF9ISSwgKHJlZyA+PiA4KSAm
IDB4ZmYpOworCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9BQVJfSFNUQVJUX0xPLCAocmVnID4+
IDApICYgMHhmZik7CisKKwlyZWcgKz0gY2FwLT53aWR0aDsJLyogSGVuZCAqLworCXpyMzYwNjBf
d3JpdGUocHRyLCBaUjA2MF9BQVJfSEVORF9ISSwgKHJlZyA+PiA4KSAmIDB4ZmYpOworCXpyMzYw
NjBfd3JpdGUocHRyLCBaUjA2MF9BQVJfSEVORF9MTywgKHJlZyA+PiAwKSAmIDB4ZmYpOworCisJ
Lyogc3ViaW1hZ2UgYXJlYSAqLworCXJlZyA9IG5vcm0tPlZTdGFydCAtIDQ7CS8qIFNWc3RhcnQg
Ki8KKwl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfU1dSX1ZTVEFSVF9ISSwgKHJlZyA+PiA4KSAm
IDB4ZmYpOworCXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9TV1JfVlNUQVJUX0xPLCAocmVnID4+
IDApICYgMHhmZik7CisKKwlyZWcgKz0gbm9ybS0+SGEgLyAyICsgODsJLyogU1ZlbmQgKi8KKwl6
cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfU1dSX1ZFTkRfSEksIChyZWcgPj4gOCkgJiAweGZmKTsK
Kwl6cjM2MDYwX3dyaXRlKHB0ciwgWlIwNjBfU1dSX1ZFTkRfTE8sIChyZWcgPj4gMCkgJiAweGZm
KTsKKworCXJlZyA9IG5vcm0tPkhTdGFydCAvKisgNjQgKi8gIC0gNDsJLyogU0hzdGFydCAqLwor
CXpyMzYwNjBfd3JpdGUocHRyLCBaUjA2MF9TV1JfSFNUQVJUX0hJLCAocmVnID4+IDgpICYgMHhm
Zik7CisJenIzNjA2MF93cml0ZShwdHIsIFpSMDYwX1NXUl9IU1RBUlRfTE8sIChyZWcgPj4gMCkg
JiAweGZmKTsKKworCXJlZyArPSBub3JtLT5XYSArIDg7CS8qIFNIZW5kICovCisJenIzNjA2MF93
cml0ZShwdHIsIFpSMDYwX1NXUl9IRU5EX0hJLCAocmVnID4+IDgpICYgMHhmZik7CisJenIzNjA2
MF93cml0ZShwdHIsIFpSMDYwX1NXUl9IRU5EX0xPLCAocmVnID4+IDApICYgMHhmZik7CisKKwlz
aXplID0gcHRyLT53aWR0aCAqIHB0ci0+aGVpZ2h0OworCS8qIFRhcmdldCBjb21wcmVzc2VkIGZp
ZWxkIHNpemUgaW4gYml0czogKi8KKwlzaXplID0gc2l6ZSAqIDE2OwkvKiB1bmNvbXByZXNzZWQg
c2l6ZSBpbiBiaXRzICovCisJLyogKFJvbmFsZCkgYnkgZGVmYXVsdCwgcXVhbGl0eSA9IDEwMCBp
cyBhIGNvbXByZXNzaW9uCisJICogcmF0aW8gMToyLiBTZXR0aW5nIGxvd19iaXRyYXRlIChpbnNt
b2Qgb3B0aW9uKSBzZXRzCisJICogaXQgdG8gMTo0IChpbnN0ZWFkIG9mIDE6MiwgenIzNjA2MCBt
YXgpIGFzIGxpbWl0IGJlY2F1c2UgdGhlCisJICogYnV6IGNhbid0IGhhbmRsZSBtb3JlIGF0IGRl
Y2ltYXRpb249MS4uLiBVc2UgbG93X2JpdHJhdGUgaWYKKwkgKiB5b3UgaGF2ZSBhIEJ1eiwgdW5s
ZXNzIHlvdSBrbm93IHdoYXQgeW91J3JlIGRvaW5nICovCisJc2l6ZSA9IHNpemUgKiBjYXAtPnF1
YWxpdHkgLyAobG93X2JpdHJhdGUgPyA0MDAgOiAyMDApOworCS8qIExvd2VyIGxpbWl0IChhcmJp
dHJhcnksIDEgS0IpICovCisJaWYgKHNpemUgPCA4MTkyKQorCQlzaXplID0gODE5MjsKKwkvKiBV
cHBlciBsaW1pdDogNy84IG9mIHRoZSBjb2RlIGJ1ZmZlcnMgKi8KKwlpZiAoc2l6ZSA+IHB0ci0+
dG90YWxfY29kZV92b2wgKiA3KQorCQlzaXplID0gcHRyLT50b3RhbF9jb2RlX3ZvbCAqIDc7CisK
KwlwdHItPnJlYWxfY29kZV92b2wgPSBzaXplID4+IDM7CS8qIGluIGJ5dGVzICovCisKKwkvKiB0
aGUgTUJDVlIgaXMgdGhlICptYXhpbXVtKiBibG9jayB2b2x1bWUsIGFjY29yZGluZyB0byB0aGUK
KwkgKiBKUEVHIElTTyBzcGVjcywgdGhpcyBzaG91bGRuJ3QgYmUgdXNlZCwgc2luY2UgdGhhdCBh
bGxvd3MKKwkgKiBmb3IgdGhlIGJlc3QgZW5jb2RpbmcgcXVhbGl0eS4gU28gc2V0IGl0IHRvIGl0
J3MgbWF4IHZhbHVlICovCisJcmVnID0gcHRyLT5tYXhfYmxvY2tfdm9sOworCXpyMzYwNjBfd3Jp
dGUocHRyLCBaUjA2MF9NQkNWUiwgcmVnKTsKKworCXJldHVybiAwOworfQorCisvKiBhZGRpdGlv
bmFsIGNvbnRyb2wgZnVuY3Rpb25zICovCitzdGF0aWMgaW50Cit6cjM2MDYwX2NvbnRyb2wgKHN0
cnVjdCB2aWRlb2NvZGVjICpjb2RlYywKKwkJIGludCAgICAgICAgICAgICAgICB0eXBlLAorCQkg
aW50ICAgICAgICAgICAgICAgIHNpemUsCisJCSB2b2lkICAgICAgICAgICAgICAqZGF0YSkKK3sK
KwlzdHJ1Y3QgenIzNjA2MCAqcHRyID0gKHN0cnVjdCB6cjM2MDYwICopIGNvZGVjLT5kYXRhOwor
CWludCAqaXZhbCA9IChpbnQgKikgZGF0YTsKKworCWRwcmludGsoMiwgIiVzOiBjb250cm9sICVk
IGNhbGwgd2l0aCAlZCBieXRlXG4iLCBwdHItPm5hbWUsIHR5cGUsCisJCXNpemUpOworCisJc3dp
dGNoICh0eXBlKSB7CisJY2FzZSBDT0RFQ19HX1NUQVRVUzoJLyogZ2V0IGxhc3Qgc3RhdHVzICov
CisJCWlmIChzaXplICE9IHNpemVvZihpbnQpKQorCQkJcmV0dXJuIC1FRkFVTFQ7CisJCXpyMzYw
NjBfcmVhZF9zdGF0dXMocHRyKTsKKwkJKml2YWwgPSBwdHItPnN0YXR1czsKKwkJYnJlYWs7CisK
KwljYXNlIENPREVDX0dfQ09ERUNfTU9ERToKKwkJaWYgKHNpemUgIT0gc2l6ZW9mKGludCkpCisJ
CQlyZXR1cm4gLUVGQVVMVDsKKwkJKml2YWwgPSBDT0RFQ19NT0RFX0JKUEc7CisJCWJyZWFrOwor
CisJY2FzZSBDT0RFQ19TX0NPREVDX01PREU6CisJCWlmIChzaXplICE9IHNpemVvZihpbnQpKQor
CQkJcmV0dXJuIC1FRkFVTFQ7CisJCWlmICgqaXZhbCAhPSBDT0RFQ19NT0RFX0JKUEcpCisJCQly
ZXR1cm4gLUVJTlZBTDsKKwkJLyogbm90IG5lZWRlZCwgZG8gbm90aGluZyAqLworCQlyZXR1cm4g
MDsKKworCWNhc2UgQ09ERUNfR19WRkU6CisJY2FzZSBDT0RFQ19TX1ZGRToKKwkJLyogbm90IG5l
ZWRlZCwgZG8gbm90aGluZyAqLworCQlyZXR1cm4gMDsKKworCWNhc2UgQ09ERUNfU19NTUFQOgor
CQkvKiBub3QgYXZhaWxhYmxlLCBnaXZlIGFuIGVycm9yICovCisJCXJldHVybiAtRU5YSU87CisK
KwljYXNlIENPREVDX0dfSlBFR19URFNfQllURToJLyogZ2V0IHRhcmdldCB2b2x1bWUgaW4gYnl0
ZSAqLworCQlpZiAoc2l6ZSAhPSBzaXplb2YoaW50KSkKKwkJCXJldHVybiAtRUZBVUxUOworCQkq
aXZhbCA9IHB0ci0+dG90YWxfY29kZV92b2w7CisJCWJyZWFrOworCisJY2FzZSBDT0RFQ19TX0pQ
RUdfVERTX0JZVEU6CS8qIGdldCB0YXJnZXQgdm9sdW1lIGluIGJ5dGUgKi8KKwkJaWYgKHNpemUg
IT0gc2l6ZW9mKGludCkpCisJCQlyZXR1cm4gLUVGQVVMVDsKKwkJcHRyLT50b3RhbF9jb2RlX3Zv
bCA9ICppdmFsOworCQlwdHItPnJlYWxfY29kZV92b2wgPSAocHRyLT50b3RhbF9jb2RlX3ZvbCAq
IDYpID4+IDM7CisJCWJyZWFrOworCisJY2FzZSBDT0RFQ19HX0pQRUdfU0NBTEU6CS8qIGdldCBz
Y2FsaW5nIGZhY3RvciAqLworCQlpZiAoc2l6ZSAhPSBzaXplb2YoaW50KSkKKwkJCXJldHVybiAt
RUZBVUxUOworCQkqaXZhbCA9IHpyMzYwNjBfcmVhZF9zY2FsZWZhY3RvcihwdHIpOworCQlicmVh
azsKKworCWNhc2UgQ09ERUNfU19KUEVHX1NDQUxFOgkvKiBzZXQgc2NhbGluZyBmYWN0b3IgKi8K
KwkJaWYgKHNpemUgIT0gc2l6ZW9mKGludCkpCisJCQlyZXR1cm4gLUVGQVVMVDsKKwkJcHRyLT5z
Y2FsZWZhY3QgPSAqaXZhbDsKKwkJYnJlYWs7CisKKwljYXNlIENPREVDX0dfSlBFR19BUFBfREFU
QTogewkvKiBnZXQgYXBwbiBtYXJrZXIgZGF0YSAqLworCQlzdHJ1Y3QganBlZ19hcHBfbWFya2Vy
ICphcHAgPSBkYXRhOworCisJCWlmIChzaXplICE9IHNpemVvZihzdHJ1Y3QganBlZ19hcHBfbWFy
a2VyKSkKKwkJCXJldHVybiAtRUZBVUxUOworCisJCSphcHAgPSBwdHItPmFwcDsKKwkJYnJlYWs7
CisJfQorCisJY2FzZSBDT0RFQ19TX0pQRUdfQVBQX0RBVEE6IHsJLyogc2V0IGFwcG4gbWFya2Vy
IGRhdGEgKi8KKwkJc3RydWN0IGpwZWdfYXBwX21hcmtlciAqYXBwID0gZGF0YTsKKworCQlpZiAo
c2l6ZSAhPSBzaXplb2Yoc3RydWN0IGpwZWdfYXBwX21hcmtlcikpCisJCQlyZXR1cm4gLUVGQVVM
VDsKKworCQlwdHItPmFwcCA9ICphcHA7CisJCWJyZWFrOworCX0KKworCWNhc2UgQ09ERUNfR19K
UEVHX0NPTV9EQVRBOiB7CS8qIGdldCBjb21tZW50IG1hcmtlciBkYXRhICovCisJCXN0cnVjdCBq
cGVnX2NvbV9tYXJrZXIgKmNvbSA9IGRhdGE7CisKKwkJaWYgKHNpemUgIT0gc2l6ZW9mKHN0cnVj
dCBqcGVnX2NvbV9tYXJrZXIpKQorCQkJcmV0dXJuIC1FRkFVTFQ7CisKKwkJKmNvbSA9IHB0ci0+
Y29tOworCQlicmVhazsKKwl9CisKKwljYXNlIENPREVDX1NfSlBFR19DT01fREFUQTogewkvKiBz
ZXQgY29tbWVudCBtYXJrZXIgZGF0YSAqLworCQlzdHJ1Y3QganBlZ19jb21fbWFya2VyICpjb20g
PSBkYXRhOworCisJCWlmIChzaXplICE9IHNpemVvZihzdHJ1Y3QganBlZ19jb21fbWFya2VyKSkK
KwkJCXJldHVybiAtRUZBVUxUOworCisJCXB0ci0+Y29tID0gKmNvbTsKKwkJYnJlYWs7CisJfQor
CisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcmV0dXJuIHNpemU7Cit9CisK
Ky8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KKyAgIEV4aXQgYW5kIHVucmVnaXN0ZXIgZnVuY3Rpb246CisK
KyAgIERlaW5pdGlhbGl6ZXMgWm9yYW4ncyBKUEVHIHByb2Nlc3NvcgorICAgPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PSAqLworCitzdGF0aWMgaW50Cit6cjM2MDYwX3Vuc2V0IChzdHJ1Y3QgdmlkZW9jb2RlYyAq
Y29kZWMpCit7CisJc3RydWN0IHpyMzYwNjAgKnB0ciA9IGNvZGVjLT5kYXRhOworCisJaWYgKHB0
cikgeworCQkvKiBkbyB3ZWUgbmVlZCBzb21lIGNvZGVjIGRlaW5pdCBoZXJlLCB0b28gPz8/PyAq
LworCisJCWRwcmludGsoMSwgIiVzOiBmaW5pc2hlZCBjb2RlYyAjJWRcbiIsIHB0ci0+bmFtZSwK
KwkJCXB0ci0+bnVtKTsKKwkJa2ZyZWUocHRyKTsKKwkJY29kZWMtPmRhdGEgPSBOVUxMOworCisJ
CXpyMzYwNjBfY29kZWNzLS07CisJCXJldHVybiAwOworCX0KKworCXJldHVybiAtRUZBVUxUOwor
fQorCisvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09CisgICBTZXR1cCBhbmQgcmVnaXN0cnkgZnVuY3Rpb246
CisKKyAgIEluaXRpYWxpemVzIFpvcmFuJ3MgSlBFRyBwcm9jZXNzb3IKKworICAgQWxzbyBzZXRz
IHBpeGVsIHNpemUsIGF2ZXJhZ2UgY29kZSBzaXplLCBtb2RlIChjb21wci4vZGVjb21wci4pCisg
ICAodGhlIGdpdmVuIHNpemUgaXMgZGV0ZXJtaW5lZCBieSB0aGUgcHJvY2Vzc29yIHdpdGggdGhl
IHZpZGVvIGludGVyZmFjZSkKKyAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KKworc3RhdGljIGludAor
enIzNjA2MF9zZXR1cCAoc3RydWN0IHZpZGVvY29kZWMgKmNvZGVjKQoreworCXN0cnVjdCB6cjM2
MDYwICpwdHI7CisJaW50IHJlczsKKworCWRwcmludGsoMiwgInpyMzYwNjA6IGluaXRpYWxpemlu
ZyBNSlBFRyBzdWJzeXN0ZW0gIyVkLlxuIiwKKwkJenIzNjA2MF9jb2RlY3MpOworCisJaWYgKHpy
MzYwNjBfY29kZWNzID09IE1BWF9DT0RFQ1MpIHsKKwkJZHByaW50aygxLAorCQkJS0VSTl9FUlIg
InpyMzYwNjA6IENhbid0IGF0dGFjaCBtb3JlIGNvZGVjcyFcbiIpOworCQlyZXR1cm4gLUVOT1NQ
QzsKKwl9CisJLy9tZW0gc3RydWN0dXJlIGluaXQKKwljb2RlYy0+ZGF0YSA9IHB0ciA9IGt6YWxs
b2Moc2l6ZW9mKHN0cnVjdCB6cjM2MDYwKSwgR0ZQX0tFUk5FTCk7CisJaWYgKE5VTEwgPT0gcHRy
KSB7CisJCWRwcmludGsoMSwgS0VSTl9FUlIgInpyMzYwNjA6IENhbid0IGdldCBlbm91Z2ggbWVt
b3J5IVxuIik7CisJCXJldHVybiAtRU5PTUVNOworCX0KKworCXNucHJpbnRmKHB0ci0+bmFtZSwg
c2l6ZW9mKHB0ci0+bmFtZSksICJ6cjM2MDYwWyVkXSIsCisJCSB6cjM2MDYwX2NvZGVjcyk7CisJ
cHRyLT5udW0gPSB6cjM2MDYwX2NvZGVjcysrOworCXB0ci0+Y29kZWMgPSBjb2RlYzsKKworCS8v
dGVzdGluZworCXJlcyA9IHpyMzYwNjBfYmFzaWNfdGVzdChwdHIpOworCWlmIChyZXMgPCAwKSB7
CisJCXpyMzYwNjBfdW5zZXQoY29kZWMpOworCQlyZXR1cm4gcmVzOworCX0KKwkvL2ZpbmFsIHNl
dHVwCisJbWVtY3B5KHB0ci0+aF9zYW1wX3JhdGlvLCB6cjM2MDYwX2RlY2ltYXRpb25faCwgOCk7
CisJbWVtY3B5KHB0ci0+dl9zYW1wX3JhdGlvLCB6cjM2MDYwX2RlY2ltYXRpb25fdiwgOCk7CisK
KwlwdHItPmJpdHJhdGVfY3RybCA9IDA7CS8qIDAgb3IgMSAtIGZpeGVkIGZpbGUgc2l6ZSBmbGFn
CisJCQkJICogKHdoYXQgaXMgdGhlIGRpZmZlcmVuY2U/KSAqLworCXB0ci0+bW9kZSA9IENPREVD
X0RPX0NPTVBSRVNTSU9OOworCXB0ci0+d2lkdGggPSAzODQ7CisJcHRyLT5oZWlnaHQgPSAyODg7
CisJcHRyLT50b3RhbF9jb2RlX3ZvbCA9IDE2MDAwOwkvKiBDSEVDS01FICovCisJcHRyLT5yZWFs
X2NvZGVfdm9sID0gKHB0ci0+dG90YWxfY29kZV92b2wgKiA2KSA+PiAzOworCXB0ci0+bWF4X2Js
b2NrX3ZvbCA9IDI0MDsJLyogQ0hFQ0tNRSwgd2FzIDEyMCBpcyAyNDAgKi8KKwlwdHItPnNjYWxl
ZmFjdCA9IDB4MTAwOworCXB0ci0+ZHJpID0gMTsJCS8qIENIRUNLTUUsIHdhcyA4IGlzIDEgKi8K
KworCS8qIGJ5IGRlZmF1bHQsIG5vIENPTSBvciBBUFAgbWFya2VycyAtIGFwcCBzaG91bGQgc2V0
IHRob3NlICovCisJcHRyLT5jb20ubGVuID0gMDsKKwlwdHItPmFwcC5hcHBuID0gMDsKKwlwdHIt
PmFwcC5sZW4gPSAwOworCisJenIzNjA2MF9pbml0KHB0cik7CisKKwlkcHJpbnRrKDEsIEtFUk5f
SU5GTyAiJXM6IGNvZGVjIGF0dGFjaGVkIGFuZCBydW5uaW5nXG4iLAorCQlwdHItPm5hbWUpOwor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdmlkZW9jb2RlYyB6cjM2MDYw
X2NvZGVjID0geworCS5vd25lciA9IFRISVNfTU9EVUxFLAorCS5uYW1lID0gInpyMzYwNjAiLAor
CS5tYWdpYyA9IDBMLAkJLy8gbWFnaWMgbm90IHVzZWQKKwkuZmxhZ3MgPQorCSAgICBDT0RFQ19G
TEFHX0pQRUcgfCBDT0RFQ19GTEFHX0hBUkRXQVJFIHwgQ09ERUNfRkxBR19FTkNPREVSIHwKKwkg
ICAgQ09ERUNfRkxBR19ERUNPREVSIHwgQ09ERUNfRkxBR19WRkUsCisJLnR5cGUgPSBDT0RFQ19U
WVBFX1pSMzYwNjAsCisJLnNldHVwID0genIzNjA2MF9zZXR1cCwJLy8gZnVuY3Rpb25hbGl0eQor
CS51bnNldCA9IHpyMzYwNjBfdW5zZXQsCisJLnNldF9tb2RlID0genIzNjA2MF9zZXRfbW9kZSwK
Kwkuc2V0X3ZpZGVvID0genIzNjA2MF9zZXRfdmlkZW8sCisJLmNvbnRyb2wgPSB6cjM2MDYwX2Nv
bnRyb2wsCisJLy8gb3RoZXJzIGFyZSBub3QgdXNlZAorfTsKKworLyogPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQorICAgSE9PSyBJTiBEUklWRVIgQVMgS0VSTkVMIE1PRFVMRQorICAgPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PSAqLworCitzdGF0aWMgaW50IF9faW5pdAorenIzNjA2MF9pbml0X21vZHVsZSAodm9pZCkKK3sK
KwkvL2RwcmludGsoMSwgInpyMzYwNjAgZHJpdmVyICVzXG4iLFpSMDYwX1ZFUlNJT04pOworCXpy
MzYwNjBfY29kZWNzID0gMDsKKwlyZXR1cm4gdmlkZW9jb2RlY19yZWdpc3RlcigmenIzNjA2MF9j
b2RlYyk7Cit9CisKK3N0YXRpYyB2b2lkIF9fZXhpdAorenIzNjA2MF9jbGVhbnVwX21vZHVsZSAo
dm9pZCkKK3sKKwlpZiAoenIzNjA2MF9jb2RlY3MpIHsKKwkJZHByaW50aygxLAorCQkJInpyMzYw
NjA6IHNvbWV0aGluZydzIHdyb25nIC0gJWQgY29kZWNzIGxlZnQgc29tZWhvdy5cbiIsCisJCQl6
cjM2MDYwX2NvZGVjcyk7CisJfQorCisJLyogaG93ZXZlciwgd2UgY2FuJ3QganVzdCBzdGF5IGFs
aXZlICovCisJdmlkZW9jb2RlY191bnJlZ2lzdGVyKCZ6cjM2MDYwX2NvZGVjKTsKK30KKworbW9k
dWxlX2luaXQoenIzNjA2MF9pbml0X21vZHVsZSk7Cittb2R1bGVfZXhpdCh6cjM2MDYwX2NsZWFu
dXBfbW9kdWxlKTsKKworTU9EVUxFX0FVVEhPUigiTGF1cmVudCBQaW5jaGFydCA8bGF1cmVudC5w
aW5jaGFydEBza3luZXQuYmU+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIkRyaXZlciBtb2R1bGUg
Zm9yIFpSMzYwNjAganBlZyBwcm9jZXNzb3JzICIKKwkJICAgWlIwNjBfVkVSU0lPTik7CitNT0RV
TEVfTElDRU5TRSgiR1BMIik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvbWVkaWEvem9y
YW4venIzNjA2MC5oIGIvZHJpdmVycy9zdGFnaW5nL21lZGlhL3pvcmFuL3pyMzYwNjAuaApuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjgyOTExNzU3YmE3OAotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9tZWRpYS96b3Jhbi96cjM2MDYwLmgKQEAgLTAs
MCArMSwyMTYgQEAKKy8qCisgKiBab3JhbiBaUjM2MDYwIGJhc2ljIGNvbmZpZ3VyYXRpb24gZnVu
Y3Rpb25zIC0gaGVhZGVyIGZpbGUKKyAqCisgKiBDb3B5cmlnaHQgKEMpIDIwMDIgTGF1cmVudCBQ
aW5jaGFydCA8bGF1cmVudC5waW5jaGFydEBza3luZXQuYmU+CisgKgorICogJElkOiB6cjM2MDYw
LmgsdiAxLjEuMS4xLjIuMyAyMDAzLzAxLzE0IDIxOjE4OjQ3IHJidWx0amUgRXhwICQKKyAqCisg
KiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0KKyAqCisgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsg
eW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQorICogaXQgdW5kZXIgdGhlIHRl
cm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKKyAq
IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExp
Y2Vuc2UsIG9yCisgKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAq
IFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUg
dXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGlt
cGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUKKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IGZvciBtb3JlIGRldGFpbHMuCisgKgorICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgKi8KKworI2lmbmRl
ZiBaUjM2MDYwX0gKKyNkZWZpbmUgWlIzNjA2MF9ICisKKyNpbmNsdWRlICJ2aWRlb2NvZGVjLmgi
CisKKy8qIGRhdGEgc3RvcmVkIGZvciBlYWNoIHpvcmFuIGpwZWcgY29kZWMgY2hpcCAqLworc3Ry
dWN0IHpyMzYwNjAgeworCWNoYXIgbmFtZVszMl07CisJaW50IG51bTsKKwkvKiBpbyBkYXRhc3Ry
dWN0dXJlICovCisJc3RydWN0IHZpZGVvY29kZWMgKmNvZGVjOworCS8vIGxhc3QgY29kZXIgc3Rh
dHVzCisJX191OCBzdGF0dXM7CisJLy8gYWN0dWFsIGNvZGVyIHNldHVwCisJaW50IG1vZGU7CisK
KwlfX3UxNiB3aWR0aDsKKwlfX3UxNiBoZWlnaHQ7CisKKwlfX3UxNiBiaXRyYXRlX2N0cmw7CisK
KwlfX3UzMiB0b3RhbF9jb2RlX3ZvbDsKKwlfX3UzMiByZWFsX2NvZGVfdm9sOworCV9fdTE2IG1h
eF9ibG9ja192b2w7CisKKwlfX3U4IGhfc2FtcF9yYXRpb1s4XTsKKwlfX3U4IHZfc2FtcF9yYXRp
b1s4XTsKKwlfX3UxNiBzY2FsZWZhY3Q7CisJX191MTYgZHJpOworCisJLyogYXBwL2NvbSBtYXJr
ZXIgZGF0YSAqLworCXN0cnVjdCBqcGVnX2FwcF9tYXJrZXIgYXBwOworCXN0cnVjdCBqcGVnX2Nv
bV9tYXJrZXIgY29tOworfTsKKworLyogWlIzNjA2MCByZWdpc3RlciBhZGRyZXNzZXMgKi8KKyNk
ZWZpbmUgWlIwNjBfTE9BRAkJCTB4MDAwCisjZGVmaW5lIFpSMDYwX0NGU1IJCQkweDAwMQorI2Rl
ZmluZSBaUjA2MF9DSVIJCQkweDAwMgorI2RlZmluZSBaUjA2MF9DTVIJCQkweDAwMworI2RlZmlu
ZSBaUjA2MF9NQloJCQkweDAwNAorI2RlZmluZSBaUjA2MF9NQkNWUgkJCTB4MDA1CisjZGVmaW5l
IFpSMDYwX01FUgkJCTB4MDA2CisjZGVmaW5lIFpSMDYwX0lNUgkJCTB4MDA3CisjZGVmaW5lIFpS
MDYwX0lTUgkJCTB4MDA4CisjZGVmaW5lIFpSMDYwX1RDVl9ORVRfSEkJCTB4MDA5CisjZGVmaW5l
IFpSMDYwX1RDVl9ORVRfTUgJCTB4MDBhCisjZGVmaW5lIFpSMDYwX1RDVl9ORVRfTUwJCTB4MDBi
CisjZGVmaW5lIFpSMDYwX1RDVl9ORVRfTE8JCTB4MDBjCisjZGVmaW5lIFpSMDYwX1RDVl9EQVRB
X0hJCQkweDAwZAorI2RlZmluZSBaUjA2MF9UQ1ZfREFUQV9NSAkJMHgwMGUKKyNkZWZpbmUgWlIw
NjBfVENWX0RBVEFfTUwJCTB4MDBmCisjZGVmaW5lIFpSMDYwX1RDVl9EQVRBX0xPCQkweDAxMAor
I2RlZmluZSBaUjA2MF9TRl9ISQkJCTB4MDExCisjZGVmaW5lIFpSMDYwX1NGX0xPCQkJMHgwMTIK
KyNkZWZpbmUgWlIwNjBfQUZfSEkJCQkweDAxMworI2RlZmluZSBaUjA2MF9BRl9NCQkJMHgwMTQK
KyNkZWZpbmUgWlIwNjBfQUZfTE8JCQkweDAxNQorI2RlZmluZSBaUjA2MF9BQ1ZfSEkJCQkweDAx
NgorI2RlZmluZSBaUjA2MF9BQ1ZfTUgJCQkweDAxNworI2RlZmluZSBaUjA2MF9BQ1ZfTUwJCQkw
eDAxOAorI2RlZmluZSBaUjA2MF9BQ1ZfTE8JCQkweDAxOQorI2RlZmluZSBaUjA2MF9BQ1RfSEkJ
CQkweDAxYQorI2RlZmluZSBaUjA2MF9BQ1RfTUgJCQkweDAxYgorI2RlZmluZSBaUjA2MF9BQ1Rf
TUwJCQkweDAxYworI2RlZmluZSBaUjA2MF9BQ1RfTE8JCQkweDAxZAorI2RlZmluZSBaUjA2MF9B
Q1ZfVFJVTl9ISQkJMHgwMWUKKyNkZWZpbmUgWlIwNjBfQUNWX1RSVU5fTUgJCTB4MDFmCisjZGVm
aW5lIFpSMDYwX0FDVl9UUlVOX01MCQkweDAyMAorI2RlZmluZSBaUjA2MF9BQ1ZfVFJVTl9MTwkJ
MHgwMjEKKyNkZWZpbmUgWlIwNjBfSURSX0RFVgkJCTB4MDIyCisjZGVmaW5lIFpSMDYwX0lEUl9S
RVYJCQkweDAyMworI2RlZmluZSBaUjA2MF9UQ1JfSEkJCQkweDAyNAorI2RlZmluZSBaUjA2MF9U
Q1JfTE8JCQkweDAyNQorI2RlZmluZSBaUjA2MF9WQ1IJCQkweDAzMAorI2RlZmluZSBaUjA2MF9W
UFIJCQkweDAzMQorI2RlZmluZSBaUjA2MF9TUgkJCTB4MDMyCisjZGVmaW5lIFpSMDYwX0JDUl9Z
CQkJMHgwMzMKKyNkZWZpbmUgWlIwNjBfQkNSX1UJCQkweDAzNAorI2RlZmluZSBaUjA2MF9CQ1Jf
VgkJCTB4MDM1CisjZGVmaW5lIFpSMDYwX1NHUl9WVE9UQUxfSEkJCTB4MDM2CisjZGVmaW5lIFpS
MDYwX1NHUl9WVE9UQUxfTE8JCTB4MDM3CisjZGVmaW5lIFpSMDYwX1NHUl9IVE9UQUxfSEkJCTB4
MDM4CisjZGVmaW5lIFpSMDYwX1NHUl9IVE9UQUxfTE8JCTB4MDM5CisjZGVmaW5lIFpSMDYwX1NH
Ul9WU1lOQwkJCTB4MDNhCisjZGVmaW5lIFpSMDYwX1NHUl9IU1lOQwkJCTB4MDNiCisjZGVmaW5l
IFpSMDYwX1NHUl9CVlNUQVJUCQkweDAzYworI2RlZmluZSBaUjA2MF9TR1JfQkhTVEFSVAkJMHgw
M2QKKyNkZWZpbmUgWlIwNjBfU0dSX0JWRU5EX0hJCQkweDAzZQorI2RlZmluZSBaUjA2MF9TR1Jf
QlZFTkRfTE8JCTB4MDNmCisjZGVmaW5lIFpSMDYwX1NHUl9CSEVORF9ISQkJMHgwNDAKKyNkZWZp
bmUgWlIwNjBfU0dSX0JIRU5EX0xPCQkweDA0MQorI2RlZmluZSBaUjA2MF9BQVJfVlNUQVJUX0hJ
CQkweDA0MgorI2RlZmluZSBaUjA2MF9BQVJfVlNUQVJUX0xPCQkweDA0MworI2RlZmluZSBaUjA2
MF9BQVJfVkVORF9ISQkJMHgwNDQKKyNkZWZpbmUgWlIwNjBfQUFSX1ZFTkRfTE8JCTB4MDQ1Cisj
ZGVmaW5lIFpSMDYwX0FBUl9IU1RBUlRfSEkJCTB4MDQ2CisjZGVmaW5lIFpSMDYwX0FBUl9IU1RB
UlRfTE8JCTB4MDQ3CisjZGVmaW5lIFpSMDYwX0FBUl9IRU5EX0hJCQkweDA0OAorI2RlZmluZSBa
UjA2MF9BQVJfSEVORF9MTwkJMHgwNDkKKyNkZWZpbmUgWlIwNjBfU1dSX1ZTVEFSVF9ISQkJMHgw
NGEKKyNkZWZpbmUgWlIwNjBfU1dSX1ZTVEFSVF9MTwkJMHgwNGIKKyNkZWZpbmUgWlIwNjBfU1dS
X1ZFTkRfSEkJCTB4MDRjCisjZGVmaW5lIFpSMDYwX1NXUl9WRU5EX0xPCQkweDA0ZAorI2RlZmlu
ZSBaUjA2MF9TV1JfSFNUQVJUX0hJCQkweDA0ZQorI2RlZmluZSBaUjA2MF9TV1JfSFNUQVJUX0xP
CQkweDA0ZgorI2RlZmluZSBaUjA2MF9TV1JfSEVORF9ISQkJMHgwNTAKKyNkZWZpbmUgWlIwNjBf
U1dSX0hFTkRfTE8JCTB4MDUxCisKKyNkZWZpbmUgWlIwNjBfU09GX0lEWAkJCTB4MDYwCisjZGVm
aW5lIFpSMDYwX1NPU19JRFgJCQkweDA3YQorI2RlZmluZSBaUjA2MF9EUklfSURYCQkJMHgwYzAK
KyNkZWZpbmUgWlIwNjBfRFFUX0lEWAkJCTB4MGNjCisjZGVmaW5lIFpSMDYwX0RIVF9JRFgJCQkw
eDFkNAorI2RlZmluZSBaUjA2MF9BUFBfSURYCQkJMHgzODAKKyNkZWZpbmUgWlIwNjBfQ09NX0lE
WAkJCTB4M2MwCisKKy8qIFpSMzYwNjAgTE9BRCByZWdpc3RlciBiaXRzICovCisKKyNkZWZpbmUg
WlIwNjBfTE9BRF9Mb2FkCQkJKDEgPDwgNykKKyNkZWZpbmUgWlIwNjBfTE9BRF9TeW5jUnN0CQko
MSA8PCAwKQorCisvKiBaUjM2MDYwIENvZGUgRklGTyBTdGF0dXMgcmVnaXN0ZXIgYml0cyAqLwor
CisjZGVmaW5lIFpSMDYwX0NGU1JfQnVzeQkJCSgxIDw8IDcpCisjZGVmaW5lIFpSMDYwX0NGU1Jf
Q0J1c3kJCSgxIDw8IDIpCisjZGVmaW5lIFpSMDYwX0NGU1JfQ0ZJRk8JCSgzIDw8IDApCisKKy8q
IFpSMzYwNjAgQ29kZSBJbnRlcmZhY2UgcmVnaXN0ZXIgKi8KKworI2RlZmluZSBaUjA2MF9DSVJf
Q29kZTE2CQkoMSA8PCA3KQorI2RlZmluZSBaUjA2MF9DSVJfRW5kaWFuCQkoMSA8PCA2KQorI2Rl
ZmluZSBaUjA2MF9DSVJfQ0ZJUwkJCSgxIDw8IDIpCisjZGVmaW5lIFpSMDYwX0NJUl9Db2RlTXN0
cgkJKDEgPDwgMCkKKworLyogWlIzNjA2MCBDb2RlYyBNb2RlIHJlZ2lzdGVyICovCisKKyNkZWZp
bmUgWlIwNjBfQ01SX0NvbXAJCQkoMSA8PCA3KQorI2RlZmluZSBaUjA2MF9DTVJfQVRQCQkJKDEg
PDwgNikKKyNkZWZpbmUgWlIwNjBfQ01SX1Bhc3MyCQkJKDEgPDwgNSkKKyNkZWZpbmUgWlIwNjBf
Q01SX1RMTQkJCSgxIDw8IDQpCisjZGVmaW5lIFpSMDYwX0NNUl9CUkIJCQkoMSA8PCAyKQorI2Rl
ZmluZSBaUjA2MF9DTVJfRlNGCQkJKDEgPDwgMSkKKworLyogWlIzNjA2MCBNYXJrZXJzIEVuYWJs
ZSByZWdpc3RlciAqLworCisjZGVmaW5lIFpSMDYwX01FUl9BcHAJCQkoMSA8PCA3KQorI2RlZmlu
ZSBaUjA2MF9NRVJfQ29tCQkJKDEgPDwgNikKKyNkZWZpbmUgWlIwNjBfTUVSX0RSSQkJCSgxIDw8
IDUpCisjZGVmaW5lIFpSMDYwX01FUl9EUVQJCQkoMSA8PCA0KQorI2RlZmluZSBaUjA2MF9NRVJf
REhUCQkJKDEgPDwgMykKKworLyogWlIzNjA2MCBJbnRlcnJ1cHQgTWFzayByZWdpc3RlciAqLwor
CisjZGVmaW5lIFpSMDYwX0lNUl9FT0FWCQkJKDEgPDwgMykKKyNkZWZpbmUgWlIwNjBfSU1SX0VP
SQkJCSgxIDw8IDIpCisjZGVmaW5lIFpSMDYwX0lNUl9FbmQJCQkoMSA8PCAxKQorI2RlZmluZSBa
UjA2MF9JTVJfRGF0YUVycgkJKDEgPDwgMCkKKworLyogWlIzNjA2MCBJbnRlcnJ1cHQgU3RhdHVz
IHJlZ2lzdGVyICovCisKKyNkZWZpbmUgWlIwNjBfSVNSX1Byb0NudAkJKDMgPDwgNikKKyNkZWZp
bmUgWlIwNjBfSVNSX0VPQVYJCQkoMSA8PCAzKQorI2RlZmluZSBaUjA2MF9JU1JfRU9JCQkJKDEg
PDwgMikKKyNkZWZpbmUgWlIwNjBfSVNSX0VuZAkJCSgxIDw8IDEpCisjZGVmaW5lIFpSMDYwX0lT
Ul9EYXRhRXJyCQkoMSA8PCAwKQorCisvKiBaUjM2MDYwIFZpZGVvIENvbnRyb2wgcmVnaXN0ZXIg
Ki8KKworI2RlZmluZSBaUjA2MF9WQ1JfVmlkZW84CQkoMSA8PCA3KQorI2RlZmluZSBaUjA2MF9W
Q1JfUmFuZ2UJCQkoMSA8PCA2KQorI2RlZmluZSBaUjA2MF9WQ1JfRklEZXQJCQkoMSA8PCAzKQor
I2RlZmluZSBaUjA2MF9WQ1JfRklWZWRnZQkJKDEgPDwgMikKKyNkZWZpbmUgWlIwNjBfVkNSX0ZJ
RXh0CQkJKDEgPDwgMSkKKyNkZWZpbmUgWlIwNjBfVkNSX1N5bmNNc3RyCQkoMSA8PCAwKQorCisv
KiBaUjM2MDYwIFZpZGVvIFBvbGFyaXR5IHJlZ2lzdGVyICovCisKKyNkZWZpbmUgWlIwNjBfVlBS
X1ZDTEtQb2wJCSgxIDw8IDcpCisjZGVmaW5lIFpSMDYwX1ZQUl9QVmFsUG9sCQkoMSA8PCA2KQor
I2RlZmluZSBaUjA2MF9WUFJfUG9lUG9sCQkoMSA8PCA1KQorI2RlZmluZSBaUjA2MF9WUFJfU0lt
Z1BvbAkJKDEgPDwgNCkKKyNkZWZpbmUgWlIwNjBfVlBSX0JMUG9sCQkJKDEgPDwgMykKKyNkZWZp
bmUgWlIwNjBfVlBSX0ZJUG9sCQkJKDEgPDwgMikKKyNkZWZpbmUgWlIwNjBfVlBSX0hTUG9sCQkJ
KDEgPDwgMSkKKyNkZWZpbmUgWlIwNjBfVlBSX1ZTUG9sCQkJKDEgPDwgMCkKKworLyogWlIzNjA2
MCBTY2FsaW5nIHJlZ2lzdGVyICovCisKKyNkZWZpbmUgWlIwNjBfU1JfVlNjYWxlCQkJKDEgPDwg
MikKKyNkZWZpbmUgWlIwNjBfU1JfSFNjYWxlMgkJKDEgPDwgMCkKKyNkZWZpbmUgWlIwNjBfU1Jf
SFNjYWxlNAkJKDIgPDwgMCkKKworI2VuZGlmCQkJCS8qZm5kZWYgWlIzNjA2MF9IICovCi0tIAoy
LjI2LjIKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmRl
dmVsIG1haWxpbmcgbGlzdApkZXZlbEBsaW51eGRyaXZlcnByb2plY3Qub3JnCmh0dHA6Ly9kcml2
ZXJkZXYubGludXhkcml2ZXJwcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2RyaXZlcmRldi1k
ZXZlbAo=
