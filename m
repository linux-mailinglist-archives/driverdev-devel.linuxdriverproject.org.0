Return-Path: <driverdev-devel-bounces@linuxdriverproject.org>
X-Original-To: lists+driverdev-devel@lfdr.de
Delivered-To: lists+driverdev-devel@lfdr.de
Received: from fraxinus.osuosl.org (smtp4.osuosl.org [140.211.166.137])
	by mail.lfdr.de (Postfix) with ESMTPS id 6A0B5A06FE
	for <lists+driverdev-devel@lfdr.de>; Wed, 28 Aug 2019 18:10:16 +0200 (CEST)
Received: from localhost (localhost [127.0.0.1])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 5CDC584508;
	Wed, 28 Aug 2019 16:10:08 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from fraxinus.osuosl.org ([127.0.0.1])
	by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id GFkr7zstqIs8; Wed, 28 Aug 2019 16:09:28 +0000 (UTC)
Received: from ash.osuosl.org (ash.osuosl.org [140.211.166.34])
	by fraxinus.osuosl.org (Postfix) with ESMTP id 92A0186DD1;
	Wed, 28 Aug 2019 16:09:01 +0000 (UTC)
X-Original-To: devel@linuxdriverproject.org
Delivered-To: driverdev-devel@osuosl.org
Received: from hemlock.osuosl.org (smtp2.osuosl.org [140.211.166.133])
 by ash.osuosl.org (Postfix) with ESMTP id 0423F1BF3FD
 for <devel@linuxdriverproject.org>; Wed, 28 Aug 2019 16:08:59 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
 by hemlock.osuosl.org (Postfix) with ESMTP id E031188891
 for <devel@linuxdriverproject.org>; Wed, 28 Aug 2019 16:08:58 +0000 (UTC)
X-Virus-Scanned: amavisd-new at osuosl.org
Received: from hemlock.osuosl.org ([127.0.0.1])
 by localhost (.osuosl.org [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id BKhEmUnzgvQ5 for <devel@linuxdriverproject.org>;
 Wed, 28 Aug 2019 16:08:42 +0000 (UTC)
X-Greylist: from auto-whitelisted by SQLgrey-1.7.6
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
 by hemlock.osuosl.org (Postfix) with ESMTPS id DB29C8888A
 for <devel@driverdev.osuosl.org>; Wed, 28 Aug 2019 16:08:42 +0000 (UTC)
Received: from localhost (83-86-89-107.cable.dynamic.v4.ziggo.nl
 [83.86.89.107])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 331E720828;
 Wed, 28 Aug 2019 16:08:33 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1567008522;
 bh=W38C5Ue1zf0J25I/a9nbTdZ5MBAMuZZzToVxHUozfWo=;
 h=From:To:Cc:Subject:Date:From;
 b=ZyWK4qMF/4lJH8ntRJFwHQ9WNhZBtQDOhIh9kteqXTmqByIMcK+scoubG5YNsuCte
 qbHb7aO37uYmc5n06e3sQOnsauKxvu4+6ysU+M151oOREOOK6ZJmajRJhe2y3z5VHY
 Uts8ike0W5q/T2LysFQabysVrABX5V0RKZtzivzk=
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: devel@driverdev.osuosl.org
Subject: [PATCH] staging: exfat: add exfat filesystem code to staging
Date: Wed, 28 Aug 2019 18:08:17 +0200
Message-Id: <20190828160817.6250-1-gregkh@linuxfoundation.org>
X-Mailer: git-send-email 2.23.0
MIME-Version: 1.0
X-BeenThere: driverdev-devel@linuxdriverproject.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux Driver Project Developer List
 <driverdev-devel.linuxdriverproject.org>
List-Unsubscribe: <http://driverdev.linuxdriverproject.org/mailman/options/driverdev-devel>, 
 <mailto:driverdev-devel-request@linuxdriverproject.org?subject=unsubscribe>
List-Archive: <http://driverdev.linuxdriverproject.org/pipermail/driverdev-devel/>
List-Post: <mailto:driverdev-devel@linuxdriverproject.org>
List-Help: <mailto:driverdev-devel-request@linuxdriverproject.org?subject=help>
List-Subscribe: <http://driverdev.linuxdriverproject.org/mailman/listinfo/driverdev-devel>, 
 <mailto:driverdev-devel-request@linuxdriverproject.org?subject=subscribe>
Cc: linux-fsdevel@vger.kernel.org, Sasha Levin <alexander.levin@microsoft.com>,
 =?UTF-8?q?Valdis=20Kl=C4=93tnieks?= <valdis.kletnieks@vt.edu>,
 linux-kernel@vger.kernel.org, Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: driverdev-devel-bounces@linuxdriverproject.org
Sender: "devel" <driverdev-devel-bounces@linuxdriverproject.org>

RnJvbTogVmFsZGlzIEtsxJN0bmlla3MgPHZhbGRpcy5rbGV0bmlla3NAdnQuZWR1PgoKVGhlIGV4
ZmF0IGNvZGUgbmVlZHMgYSBsb3Qgb2Ygd29yayB0byBnZXQgaXQgaW50byAicmVhbCIgc2hhcGUg
Zm9yCnRoZSBmcy8gcGFydCBvZiB0aGUga2VybmVsLCBzbyBwdXQgaXQgaW50byBkcml2ZXJzL3N0
YWdpbmcvIGZvciBub3cgc28KdGhhdCBpdCBjYW4gYmUgd29ya2VkIG9uIGJ5IGV2ZXJ5b25lIGlu
IHRoZSBjb21tdW5pdHkuCgpUaGUgZnVsbCBzcGVjaWZpY2F0aW9uIG9mIHRoZSBmaWxlc3lzdGVt
IGNhbiBiZSBmb3VuZCBhdDoKICBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy93aW5k
b3dzL3dpbjMyL2ZpbGVpby9leGZhdC1zcGVjaWZpY2F0aW9uCgpTaWduZWQtb2ZmLWJ5OiBWYWxk
aXMgS2xldG5pZWtzIDx2YWxkaXMua2xldG5pZWtzQHZ0LmVkdT4KU2lnbmVkLW9mZi1ieTogU2Fz
aGEgTGV2aW4gPGFsZXhhbmRlci5sZXZpbkBtaWNyb3NvZnQuY29tPgpTaWduZWQtb2ZmLWJ5OiBH
cmVnIEtyb2FoLUhhcnRtYW4gPGdyZWdraEBsaW51eGZvdW5kYXRpb24ub3JnPgotLS0KIE1BSU5U
QUlORVJTICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgIDUgKwogZHJpdmVycy9zdGFnaW5n
L0tjb25maWcgICAgICAgICAgICAgIHwgICAgMiArCiBkcml2ZXJzL3N0YWdpbmcvTWFrZWZpbGUg
ICAgICAgICAgICAgfCAgICAxICsKIGRyaXZlcnMvc3RhZ2luZy9leGZhdC9LY29uZmlnICAgICAg
ICB8ICAgMzkgKwogZHJpdmVycy9zdGFnaW5nL2V4ZmF0L01ha2VmaWxlICAgICAgIHwgICAxMCAr
CiBkcml2ZXJzL3N0YWdpbmcvZXhmYXQvVE9ETyAgICAgICAgICAgfCAgIDEyICsKIGRyaXZlcnMv
c3RhZ2luZy9leGZhdC9leGZhdC5oICAgICAgICB8ICA5NzMgKysrKysrCiBkcml2ZXJzL3N0YWdp
bmcvZXhmYXQvZXhmYXRfYmxrZGV2LmMgfCAgMTM2ICsKIGRyaXZlcnMvc3RhZ2luZy9leGZhdC9l
eGZhdF9jYWNoZS5jICB8ICA3MjIgKysrKysKIGRyaXZlcnMvc3RhZ2luZy9leGZhdC9leGZhdF9j
b3JlLmMgICB8IDM3MDQgKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvc3RhZ2luZy9l
eGZhdC9leGZhdF9ubHMuYyAgICB8ICA0MDQgKysrCiBkcml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhm
YXRfc3VwZXIuYyAgfCA0MTM3ICsrKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL3N0
YWdpbmcvZXhmYXQvZXhmYXRfdXBjYXNlLmMgfCAgNzQwICsrKysrCiAxMyBmaWxlcyBjaGFuZ2Vk
LCAxMDg4NSBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5n
L2V4ZmF0L0tjb25maWcKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvZXhmYXQv
TWFrZWZpbGUKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvZXhmYXQvVE9ETwog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc3RhZ2luZy9leGZhdC9leGZhdC5oCiBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL2V4ZmF0L2V4ZmF0X2Jsa2Rldi5jCiBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL2V4ZmF0L2V4ZmF0X2NhY2hlLmMKIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhmYXRfY29yZS5jCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9zdGFnaW5nL2V4ZmF0L2V4ZmF0X25scy5jCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9zdGFnaW5nL2V4ZmF0L2V4ZmF0X3N1cGVyLmMKIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhmYXRfdXBjYXNlLmMKCmRpZmYgLS1naXQgYS9N
QUlOVEFJTkVSUyBiL01BSU5UQUlORVJTCmluZGV4IGUzMjQyNjg3Y2QxOS4uYTQ4NGIzNmU1MTE3
IDEwMDY0NAotLS0gYS9NQUlOVEFJTkVSUworKysgYi9NQUlOVEFJTkVSUwpAQCAtNjA5Nyw2ICs2
MDk3LDExIEBAIEY6CWluY2x1ZGUvdHJhY2UvZXZlbnRzL21kaW8uaAogRjoJaW5jbHVkZS91YXBp
L2xpbnV4L21kaW8uaAogRjoJaW5jbHVkZS91YXBpL2xpbnV4L21paS5oCiAKK0VYRkFUIEZJTEUg
U1lTVEVNCitNOglWYWxkaXMgS2xldG5pZWtzIDx2YWxkaXMua2xldG5pZWtzQHZ0LmVkdT4KK1M6
CU1haW50YWluZWQKK0Y6CWZzL2V4ZmF0LworCiBFWFQyIEZJTEUgU1lTVEVNCiBNOglKYW4gS2Fy
YSA8amFja0BzdXNlLmNvbT4KIEw6CWxpbnV4LWV4dDRAdmdlci5rZXJuZWwub3JnCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3N0YWdpbmcvS2NvbmZpZyBiL2RyaXZlcnMvc3RhZ2luZy9LY29uZmlnCmlu
ZGV4IGQ5NzJlYzhlNzFmYi4uZmJkYzMzODc0NzgwIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdp
bmcvS2NvbmZpZworKysgYi9kcml2ZXJzL3N0YWdpbmcvS2NvbmZpZwpAQCAtMTE4LDQgKzExOCw2
IEBAIHNvdXJjZSAiZHJpdmVycy9zdGFnaW5nL2twYzIwMDAvS2NvbmZpZyIKIAogc291cmNlICJk
cml2ZXJzL3N0YWdpbmcvaXNkbi9LY29uZmlnIgogCitzb3VyY2UgImRyaXZlcnMvc3RhZ2luZy9l
eGZhdC9LY29uZmlnIgorCiBlbmRpZiAjIFNUQUdJTkcKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3Rh
Z2luZy9NYWtlZmlsZSBiL2RyaXZlcnMvc3RhZ2luZy9NYWtlZmlsZQppbmRleCA2MDE4YjlhNGEw
NzcuLmNhMTNmODdiMWUxYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL01ha2VmaWxlCisr
KyBiL2RyaXZlcnMvc3RhZ2luZy9NYWtlZmlsZQpAQCAtNDksMyArNDksNCBAQCBvYmotJChDT05G
SUdfWElMX0FYSVNfRklGTykJKz0gYXhpcy1maWZvLwogb2JqLSQoQ09ORklHX0ZJRUxEQlVTX0RF
VikgICAgICs9IGZpZWxkYnVzLwogb2JqLSQoQ09ORklHX0tQQzIwMDApCQkrPSBrcGMyMDAwLwog
b2JqLSQoQ09ORklHX0lTRE5fQ0FQSSkJCSs9IGlzZG4vCitvYmotJChDT05GSUdfRVhGQVRfRlMp
CQkrPSBleGZhdC8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9leGZhdC9LY29uZmlnIGIv
ZHJpdmVycy9zdGFnaW5nL2V4ZmF0L0tjb25maWcKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi43OGIzMmFhMmNhMTkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0
YWdpbmcvZXhmYXQvS2NvbmZpZwpAQCAtMCwwICsxLDM5IEBACitjb25maWcgRVhGQVRfRlMKKwl0
cmlzdGF0ZSAiZXhGQVQgZnMgc3VwcG9ydCIKKwlzZWxlY3QgTkxTCisJaGVscAorCSAgVGhpcyBh
ZGRzIHN1cHBvcnQgZm9yIHRoZSBleEZBVCBmaWxlIHN5c3RlbS4KKworY29uZmlnIEVYRkFUX0RJ
U0NBUkQKKwlib29sICJlbmFibGUgZGlzY2FyZCBzdXBwb3J0IgorCWRlcGVuZHMgb24gRVhGQVRf
RlMKKwlkZWZhdWx0IHkKKworY29uZmlnIEVYRkFUX0RFTEFZRURfU1lOQworCWJvb2wgImVuYWJs
ZSBkZWxheWVkIHN5bmMiCisJZGVwZW5kcyBvbiBFWEZBVF9GUworCWRlZmF1bHQgbgorCitjb25m
aWcgRVhGQVRfS0VSTkVMX0RFQlVHCisJYm9vbCAiZW5hYmxlIGtlcm5lbCBkZWJ1ZyBmZWF0dXJl
cyB2aWEgaW9jdGwiCisJZGVwZW5kcyBvbiBFWEZBVF9GUworCWRlZmF1bHQgbgorCitjb25maWcg
RVhGQVRfREVCVUdfTVNHCisJYm9vbCAicHJpbnQgZGVidWcgbWVzc2FnZXMiCisJZGVwZW5kcyBv
biBFWEZBVF9GUworCWRlZmF1bHQgbgorCitjb25maWcgRVhGQVRfREVGQVVMVF9DT0RFUEFHRQor
CWludCAiRGVmYXVsdCBjb2RlcGFnZSBmb3IgZXhGQVQiCisJZGVmYXVsdCA0MzcKKwlkZXBlbmRz
IG9uIEVYRkFUX0ZTCisJaGVscAorCSAgVGhpcyBvcHRpb24gc2hvdWxkIGJlIHNldCB0byB0aGUg
Y29kZXBhZ2Ugb2YgeW91ciBleEZBVCBmaWxlc3lzdGVtcy4KKworY29uZmlnIEVYRkFUX0RFRkFV
TFRfSU9DSEFSU0VUCisJc3RyaW5nICJEZWZhdWx0IGlvY2hhcnNldCBmb3IgZXhGQVQiCisJZGVm
YXVsdCAidXRmOCIKKwlkZXBlbmRzIG9uIEVYRkFUX0ZTCisJaGVscAorCSAgU2V0IHRoaXMgdG8g
dGhlIGRlZmF1bHQgaW5wdXQvb3V0cHV0IGNoYXJhY3RlciBzZXQgeW91J2QgbGlrZSBleEZBVCB0
byB1c2UuCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvZXhmYXQvTWFrZWZpbGUgYi9kcml2
ZXJzL3N0YWdpbmcvZXhmYXQvTWFrZWZpbGUKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMDAwMDAwLi44NDk0NGRmYmFlMjgKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdp
bmcvZXhmYXQvTWFrZWZpbGUKQEAgLTAsMCArMSwxMCBAQAorIyBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMAorCitvYmotJChDT05GSUdfRVhGQVRfRlMpICs9IGV4ZmF0Lm8KKworZXhm
YXQteSA6PQlleGZhdF9jb3JlLm8JXAorCQlleGZhdF9zdXBlci5vCVwKKwkJZXhmYXRfYmxrZGV2
Lm8JXAorCQlleGZhdF9jYWNoZS5vCVwKKwkJZXhmYXRfbmxzLm8JXAorCQlleGZhdF91cGNhc2Uu
bwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2V4ZmF0L1RPRE8gYi9kcml2ZXJzL3N0YWdp
bmcvZXhmYXQvVE9ETwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmEz
ZWIyODJmOWVmYwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9leGZhdC9UT0RP
CkBAIC0wLDAgKzEsMTIgQEAKK2V4ZmF0X2NvcmUuYyAtIGZmc1JlYWRGaWxlIC0gdGhlIGdvdG8g
ZXJyX291dCBzZWVtIHRvIGxlYWsgYSBicmVsc2UoKS4KK3NhbWUgZm9yIGZmc1dyaXRlRmlsZS4K
KworZXhmYXRfY29yZS5jIC0gZnNfc3luYyhzYiwwKSBhbGwgb3ZlciB0aGUgcGxhY2UgbG9va3Mg
ZmlzaHkgYXMgaGVsbC4KK1RoZXJlJ3Mgb25seSBvbmUgcGxhY2UgdGhhdCBjYWxscyBpdCB3aXRo
IGEgbm9uLXplcm8gYXJndW1lbnQuCisKK2Zmc1RydW5jYXRlRmlsZSAtICBpZiAob2xkX3NpemUg
PD0gbmV3X3NpemUpIHsKK1RoYXQgZG9lc24ndCBsb29rIHJpZ2h0LiBIb3cgZGlkIGl0IGV2ZXIg
d29yaz8gQXJlIHRoZXkgcmVseWluZyBvbiBsYXp5CitibG9jayBhbGxvY2F0aW9uIHdoZW4gYWN0
dWFsIHdyaXRlcyBoYXBwZW4/IElmIG5vdGhpbmcgZWxzZSwgaXQgbmV2ZXIKK2RvZXMgdGhlICdm
aWQtPnNpemUgPSBuZXdfc2l6ZScgYW5kIGRvIHRoZSBpbm9kZSB1cGRhdGUuLi4uCisKK2Zmc1Nl
dEF0dHIoKSBpcyBqdXN0IGRhbmdsaW5nIGluIHRoZSBicmVlemUsIG5vdCB3aXJlZCB1cCBhdCBh
bGwuLi4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9leGZhdC9leGZhdC5oIGIvZHJpdmVy
cy9zdGFnaW5nL2V4ZmF0L2V4ZmF0LmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi5iYWUxODBlMTA2MDkKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcv
ZXhmYXQvZXhmYXQuaApAQCAtMCwwICsxLDk3MyBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAgKi8KKy8qCisgKiAgQ29weXJpZ2h0IChDKSAyMDEyLTIwMTMgU2Ftc3VuZyBF
bGVjdHJvbmljcyBDby4sIEx0ZC4KKyAqLworCisjaWZuZGVmIF9FWEZBVF9ICisjZGVmaW5lIF9F
WEZBVF9ICisKKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L2J1ZmZl
cl9oZWFkLmg+CisKKyNpZmRlZiBDT05GSUdfRVhGQVRfS0VSTkVMX0RFQlVHCisgIC8qIEZvciBE
ZWJ1Z2dpbmcgUHVycG9zZSAqLworCS8qIElPQ1RMIGNvZGUgJ2YnIHVzZWQgYnkKKwkgKiAgIC0g
ZmlsZSBzeXN0ZW1zIHR5cGljYWxseSAjMH4weDFGCisJICogICAtIGVtYmVkZGVkIHRlcm1pbmFs
IGRldmljZXMgIzEyOH4KKwkgKiAgIC0gZXh0cyBmb3IgZGVidWdnaW5nIHB1cnBvc2UgIzk5CisJ
ICogbnVtYmVyIDEwMCBhbmQgMTAxIGlzIGF2YWlsYWJsZSBub3cgYnV0IGhhcyBwb3NzaWJsZSBj
b25mbGljdHMKKwkgKi8KKyNkZWZpbmUgRVhGQVRfSU9DX0dFVF9ERUJVR0ZMQUdTCV9JT1IoJ2Yn
LCAxMDAsIGxvbmcpCisjZGVmaW5lIEVYRkFUX0lPQ19TRVRfREVCVUdGTEFHUwlfSU9XKCdmJywg
MTAxLCBsb25nKQorCisjZGVmaW5lIEVYRkFUX0RFQlVHRkxBR1NfSU5WQUxJRF9VTU9VTlQJMHgw
MQorI2RlZmluZSBFWEZBVF9ERUJVR0ZMQUdTX0VSUk9SX1JXCTB4MDIKKyNlbmRpZiAvKiBDT05G
SUdfRVhGQVRfS0VSTkVMX0RFQlVHICovCisKKyNpZmRlZiBDT05GSUdfRVhGQVRfREVCVUdfTVNH
CisjZGVmaW5lIERFQlVHCTEKKyNlbHNlCisjdW5kZWYgREVCVUcKKyNlbmRpZgorCisjZGVmaW5l
IERFTlRSWV9TSVpFCQkzMgkvKiBkaXIgZW50cnkgc2l6ZSAqLworI2RlZmluZSBERU5UUllfU0la
RV9CSVRTCTUKKworLyogUEJSIGVudHJpZXMgKi8KKyNkZWZpbmUgUEJSX1NJR05BVFVSRQkweEFB
NTUKKyNkZWZpbmUgRVhUX1NJR05BVFVSRQkweEFBNTUwMDAwCisjZGVmaW5lIFZPTF9MQUJFTAki
Tk8gTkFNRSAgICAiCS8qIHNpemUgc2hvdWxkIGJlIDExICovCisjZGVmaW5lIE9FTV9OQU1FCSJN
U1dJTjQuMSIJLyogc2l6ZSBzaG91bGQgYmUgOCAqLworI2RlZmluZSBTVFJfRkFUMTIJIkZBVDEy
ICAgIgkvKiBzaXplIHNob3VsZCBiZSA4ICovCisjZGVmaW5lIFNUUl9GQVQxNgkiRkFUMTYgICAi
CS8qIHNpemUgc2hvdWxkIGJlIDggKi8KKyNkZWZpbmUgU1RSX0ZBVDMyCSJGQVQzMiAgICIJLyog
c2l6ZSBzaG91bGQgYmUgOCAqLworI2RlZmluZSBTVFJfRVhGQVQJIkVYRkFUICAgIgkvKiBzaXpl
IHNob3VsZCBiZSA4ICovCisjZGVmaW5lIFZPTF9DTEVBTgkweDAwMDAKKyNkZWZpbmUgVk9MX0RJ
UlRZCTB4MDAwMgorCisvKiBtYXggbnVtYmVyIG9mIGNsdXN0ZXJzICovCisjZGVmaW5lIEZBVDEy
X1RIUkVTSE9MRAkJNDA4NwkJLyogMl4xMiAtIDEgKyAyIChjbHUgMCAmIDEpICovCisjZGVmaW5l
IEZBVDE2X1RIUkVTSE9MRAkJNjU1MjcJCS8qIDJeMTYgLSAxICsgMiAqLworI2RlZmluZSBGQVQz
Ml9USFJFU0hPTEQJCTI2ODQzNTQ1NwkvKiAyXjI4IC0gMSArIDIgKi8KKyNkZWZpbmUgRVhGQVRf
VEhSRVNIT0xECQkyNjg0MzU0NTcJLyogMl4yOCAtIDEgKyAyICovCisKKy8qIGZpbGUgdHlwZXMg
Ki8KKyNkZWZpbmUgVFlQRV9VTlVTRUQJCTB4MDAwMAorI2RlZmluZSBUWVBFX0RFTEVURUQJCTB4
MDAwMQorI2RlZmluZSBUWVBFX0lOVkFMSUQJCTB4MDAwMgorI2RlZmluZSBUWVBFX0NSSVRJQ0FM
X1BSSQkweDAxMDAKKyNkZWZpbmUgVFlQRV9CSVRNQVAJCTB4MDEwMQorI2RlZmluZSBUWVBFX1VQ
Q0FTRQkJMHgwMTAyCisjZGVmaW5lIFRZUEVfVk9MVU1FCQkweDAxMDMKKyNkZWZpbmUgVFlQRV9E
SVIJCTB4MDEwNAorI2RlZmluZSBUWVBFX0ZJTEUJCTB4MDExRgorI2RlZmluZSBUWVBFX1NZTUxJ
TksJCTB4MDE1RgorI2RlZmluZSBUWVBFX0NSSVRJQ0FMX1NFQwkweDAyMDAKKyNkZWZpbmUgVFlQ
RV9TVFJFQU0JCTB4MDIwMQorI2RlZmluZSBUWVBFX0VYVEVORAkJMHgwMjAyCisjZGVmaW5lIFRZ
UEVfQUNMCQkweDAyMDMKKyNkZWZpbmUgVFlQRV9CRU5JR05fUFJJCQkweDA0MDAKKyNkZWZpbmUg
VFlQRV9HVUlECQkweDA0MDEKKyNkZWZpbmUgVFlQRV9QQURESU5HCQkweDA0MDIKKyNkZWZpbmUg
VFlQRV9BQ0xUQUIJCTB4MDQwMworI2RlZmluZSBUWVBFX0JFTklHTl9TRUMJCTB4MDgwMAorI2Rl
ZmluZSBUWVBFX0FMTAkJMHgwRkZGCisKKy8qIHRpbWUgbW9kZXMgKi8KKyNkZWZpbmUgVE1fQ1JF
QVRFCQkwCisjZGVmaW5lIFRNX01PRElGWQkJMQorI2RlZmluZSBUTV9BQ0NFU1MJCTIKKworLyog
Y2hlY2tzdW0gdHlwZXMgKi8KKyNkZWZpbmUgQ1NfRElSX0VOVFJZCQkwCisjZGVmaW5lIENTX1BC
Ul9TRUNUT1IJCTEKKyNkZWZpbmUgQ1NfREVGQVVMVAkJMgorCisjZGVmaW5lIENMVVNURVJfMTYo
eCkJCSgodTE2KSh4KSkKKyNkZWZpbmUgQ0xVU1RFUl8zMih4KQkJKCh1MzIpKHgpKQorCisjZGVm
aW5lIEZBTFNFCQkJMAorI2RlZmluZSBUUlVFCQkJMQorCisjZGVmaW5lIFNUQVJUX1NFQ1RPUih4
KQkJCQkJCQlcCisJKCgoKHNlY3Rvcl90KSgoeCkgLSAyKSkgPDwgcF9mcy0+c2VjdG9yc19wZXJf
Y2x1X2JpdHMpICsJXAorCSBwX2ZzLT5kYXRhX3N0YXJ0X3NlY3RvcikKKworI2RlZmluZSBJU19M
QVNUX1NFQ1RPUl9JTl9DTFVTVEVSKHNlYykJCQkJXAorCSgoKChzZWMpIC0gcF9mcy0+ZGF0YV9z
dGFydF9zZWN0b3IgKyAxKSAmCQlcCisJICAoKDEgPDwgIHBfZnMtPnNlY3RvcnNfcGVyX2NsdV9i
aXRzKSAtIDEpKSA9PSAwKQorCisjZGVmaW5lIEdFVF9DTFVTVEVSX0ZST01fU0VDVE9SKHNlYykJ
CQkJXAorCSgodTMyKSgoKChzZWMpIC0gcF9mcy0+ZGF0YV9zdGFydF9zZWN0b3IpID4+CQlcCisJ
CXBfZnMtPnNlY3RvcnNfcGVyX2NsdV9iaXRzKSArIDIpKQorCisjZGVmaW5lIEdFVDE2KHBfc3Jj
KQkJCQkJCVwKKwkoKCh1MTYpKHBfc3JjKVswXSkgfCAoKCh1MTYpKHBfc3JjKVsxXSkgPDwgOCkp
CisjZGVmaW5lIEdFVDMyKHBfc3JjKQkJCQkJCVwKKwkoKCh1MzIpKHBfc3JjKVswXSkgfCAoKCh1
MzIpKHBfc3JjKVsxXSkgPDwgOCkgfAkJXAorCSgoKHUzMikocF9zcmMpWzJdKSA8PCAxNikgfCAo
KCh1MzIpKHBfc3JjKVszXSkgPDwgMjQpKQorI2RlZmluZSBHRVQ2NChwX3NyYykgXAorCSgoKHU2
NCkocF9zcmMpWzBdKSB8ICgoKHU2NCkocF9zcmMpWzFdKSA8PCA4KSB8CQlcCisJKCgodTY0KShw
X3NyYylbMl0pIDw8IDE2KSB8ICgoKHU2NCkocF9zcmMpWzNdKSA8PCAyNCkgfAlcCisJKCgodTY0
KShwX3NyYylbNF0pIDw8IDMyKSB8ICgoKHU2NCkocF9zcmMpWzVdKSA8PCA0MCkgfAlcCisJKCgo
dTY0KShwX3NyYylbNl0pIDw8IDQ4KSB8ICgoKHU2NCkocF9zcmMpWzddKSA8PCA1NikpCisKKyNk
ZWZpbmUgU0VUMTYocF9kc3QsIHNyYykJCQkJCVwKKwlkbyB7CQkJCQkJCVwKKwkJKHBfZHN0KVsw
XSA9ICh1OCkoc3JjKTsJCQkJXAorCQkocF9kc3QpWzFdID0gKHU4KSgoKHUxNikoc3JjKSkgPj4g
OCk7CQlcCisJfSB3aGlsZSAoMCkKKyNkZWZpbmUgU0VUMzIocF9kc3QsIHNyYykJCQkJCVwKKwlk
byB7CQkJCQkJCVwKKwkJKHBfZHN0KVswXSA9ICh1OCkoc3JjKTsJCQkJXAorCQkocF9kc3QpWzFd
ID0gKHU4KSgoKHUzMikoc3JjKSkgPj4gOCk7CQlcCisJCShwX2RzdClbMl0gPSAodTgpKCgodTMy
KShzcmMpKSA+PiAxNik7CQlcCisJCShwX2RzdClbM10gPSAodTgpKCgodTMyKShzcmMpKSA+PiAy
NCk7CQlcCisJfSB3aGlsZSAoMCkKKyNkZWZpbmUgU0VUNjQocF9kc3QsIHNyYykJCQkJCVwKKwlk
byB7CQkJCQkJCVwKKwkJKHBfZHN0KVswXSA9ICh1OCkoc3JjKTsJCQkJXAorCQkocF9kc3QpWzFd
ID0gKHU4KSgoKHU2NCkoc3JjKSkgPj4gOCk7CQlcCisJCShwX2RzdClbMl0gPSAodTgpKCgodTY0
KShzcmMpKSA+PiAxNik7CQlcCisJCShwX2RzdClbM10gPSAodTgpKCgodTY0KShzcmMpKSA+PiAy
NCk7CQlcCisJCShwX2RzdClbNF0gPSAodTgpKCgodTY0KShzcmMpKSA+PiAzMik7CQlcCisJCShw
X2RzdClbNV0gPSAodTgpKCgodTY0KShzcmMpKSA+PiA0MCk7CQlcCisJCShwX2RzdClbNl0gPSAo
dTgpKCgodTY0KShzcmMpKSA+PiA0OCk7CQlcCisJCShwX2RzdClbN10gPSAodTgpKCgodTY0KShz
cmMpKSA+PiA1Nik7CQlcCisJfSB3aGlsZSAoMCkKKworI2lmZGVmIF9fTElUVExFX0VORElBTgor
I2RlZmluZSBHRVQxNl9BKHBfc3JjKQkJKCooKHUxNiAqKShwX3NyYykpKQorI2RlZmluZSBHRVQz
Ml9BKHBfc3JjKQkJKCooKHUzMiAqKShwX3NyYykpKQorI2RlZmluZSBHRVQ2NF9BKHBfc3JjKQkJ
KCooKHU2NCAqKShwX3NyYykpKQorI2RlZmluZSBTRVQxNl9BKHBfZHN0LCBzcmMpCSgqKCh1MTYg
KikocF9kc3QpKSA9ICh1MTYpKHNyYykpCisjZGVmaW5lIFNFVDMyX0EocF9kc3QsIHNyYykJKCoo
KHUzMiAqKShwX2RzdCkpID0gKHUzMikoc3JjKSkKKyNkZWZpbmUgU0VUNjRfQShwX2RzdCwgc3Jj
KQkoKigodTY0ICopKHBfZHN0KSkgPSAodTY0KShzcmMpKQorI2Vsc2UgLyogQklHX0VORElBTiAq
LworI2RlZmluZSBHRVQxNl9BKHBfc3JjKQkJR0VUMTYocF9zcmMpCisjZGVmaW5lIEdFVDMyX0Eo
cF9zcmMpCQlHRVQzMihwX3NyYykKKyNkZWZpbmUgR0VUNjRfQShwX3NyYykJCUdFVDY0KHBfc3Jj
KQorI2RlZmluZSBTRVQxNl9BKHBfZHN0LCBzcmMpCVNFVDE2KHBfZHN0LCBzcmMpCisjZGVmaW5l
IFNFVDMyX0EocF9kc3QsIHNyYykJU0VUMzIocF9kc3QsIHNyYykKKyNkZWZpbmUgU0VUNjRfQShw
X2RzdCwgc3JjKQlTRVQ2NChwX2RzdCwgc3JjKQorI2VuZGlmCisKKy8qIGNhY2hlIHNpemUgKGlu
IG51bWJlciBvZiBzZWN0b3JzKSAqLworLyogKHNob3VsZCBiZSBhbiBleHBvbmVudGlhbCB2YWx1
ZSBvZiAyKSAqLworI2RlZmluZSBGQVRfQ0FDSEVfU0laRQkJMTI4CisjZGVmaW5lIEZBVF9DQUNI
RV9IQVNIX1NJWkUJNjQKKyNkZWZpbmUgQlVGX0NBQ0hFX1NJWkUJCTI1NgorI2RlZmluZSBCVUZf
Q0FDSEVfSEFTSF9TSVpFCTY0CisKKy8qIFVwY2FzZSB0YWJsZSBtYWNybyAqLworI2RlZmluZSBI
SUdIX0lOREVYX0JJVAkoOCkKKyNkZWZpbmUgSElHSF9JTkRFWF9NQVNLCSgweEZGMDApCisjZGVm
aW5lIExPV19JTkRFWF9CSVQJKDE2LUhJR0hfSU5ERVhfQklUKQorI2RlZmluZSBVVEJMX1JPV19D
T1VOVAkoMTw8TE9XX0lOREVYX0JJVCkKKyNkZWZpbmUgVVRCTF9DT0xfQ09VTlQJKDE8PEhJR0hf
SU5ERVhfQklUKQorCitzdGF0aWMgaW5saW5lIHUxNiBnZXRfY29sX2luZGV4KHUxNiBpKQorewor
CXJldHVybiBpID4+IExPV19JTkRFWF9CSVQ7Cit9CitzdGF0aWMgaW5saW5lIHUxNiBnZXRfcm93
X2luZGV4KHUxNiBpKQoreworCXJldHVybiBpICYgfkhJR0hfSU5ERVhfTUFTSzsKK30KKworI2Rl
ZmluZSBFWEZBVF9TVVBFUl9NQUdJQyAgICAgICAoMHgyMDExQkFCMEwpCisjZGVmaW5lIEVYRkFU
X1JPT1RfSU5PICAgICAgICAgIDEKKworLyogRkFUIHR5cGVzICovCisjZGVmaW5lIEZBVDEyCQkJ
MHgwMQkvKiBGQVQxMiAqLworI2RlZmluZSBGQVQxNgkJCTB4MEUJLyogV2luOTUgRkFUMTYgKExC
QSkgKi8KKyNkZWZpbmUgRkFUMzIJCQkweDBDCS8qIFdpbjk1IEZBVDMyIChMQkEpICovCisjZGVm
aW5lIEVYRkFUCQkJMHgwNwkvKiBleEZBVCAqLworCisvKiBmaWxlIG5hbWUgbGVuZ3RocyAqLwor
I2RlZmluZSBNQVhfQ0hBUlNFVF9TSVpFCTMJLyogbWF4IHNpemUgb2YgbXVsdGktYnl0ZSBjaGFy
YWN0ZXIgKi8KKyNkZWZpbmUgTUFYX1BBVEhfREVQVEgJCTE1CS8qIG1heCBkZXB0aCBvZiBwYXRo
IG5hbWUgKi8KKyNkZWZpbmUgTUFYX05BTUVfTEVOR1RICQkyNTYJLyogbWF4IGxlbiBvZiBmaWxl
bmFtZSBpbmNsdWRpbmcgTlVMTCAqLworI2RlZmluZSBNQVhfUEFUSF9MRU5HVEgJCTI2MAkvKiBt
YXggbGVuIG9mIHBhdGhuYW1lIGluY2x1ZGluZyBOVUxMICovCisjZGVmaW5lIERPU19OQU1FX0xF
TkdUSAkJMTEJLyogRE9TIGZpbGVuYW1lIGxlbmd0aCBleGNsdWRpbmcgTlVMTCAqLworI2RlZmlu
ZSBET1NfUEFUSF9MRU5HVEgJCTgwCS8qIERPUyBwYXRobmFtZSBsZW5ndGggZXhjbHVkaW5nIE5V
TEwgKi8KKworLyogZmlsZSBhdHRyaWJ1dGVzICovCisjZGVmaW5lIEFUVFJfTk9STUFMCQkweDAw
MDAKKyNkZWZpbmUgQVRUUl9SRUFET05MWQkJMHgwMDAxCisjZGVmaW5lIEFUVFJfSElEREVOCQkw
eDAwMDIKKyNkZWZpbmUgQVRUUl9TWVNURU0JCTB4MDAwNAorI2RlZmluZSBBVFRSX1ZPTFVNRQkJ
MHgwMDA4CisjZGVmaW5lIEFUVFJfU1VCRElSCQkweDAwMTAKKyNkZWZpbmUgQVRUUl9BUkNISVZF
CQkweDAwMjAKKyNkZWZpbmUgQVRUUl9TWU1MSU5LCQkweDAwNDAKKyNkZWZpbmUgQVRUUl9FWFRF
TkQJCTB4MDAwRgorI2RlZmluZSBBVFRSX1JXTUFTSwkJMHgwMDdFCisKKy8qIGZpbGUgY3JlYXRp
b24gbW9kZXMgKi8KKyNkZWZpbmUgRk1fUkVHVUxBUiAgICAgICAgICAgICAgMHgwMAorI2RlZmlu
ZSBGTV9TWU1MSU5LICAgICAgICAgICAgICAweDQwCisKKy8qIHJldHVybiB2YWx1ZXMgKi8KKyNk
ZWZpbmUgRkZTX1NVQ0NFU1MgICAgICAgICAgICAgMAorI2RlZmluZSBGRlNfTUVESUFFUlIgICAg
ICAgICAgICAxCisjZGVmaW5lIEZGU19GT1JNQVRFUlIgICAgICAgICAgIDIKKyNkZWZpbmUgRkZT
X01PVU5URUQgICAgICAgICAgICAgMworI2RlZmluZSBGRlNfTk9UTU9VTlRFRCAgICAgICAgICA0
CisjZGVmaW5lIEZGU19BTElHTk1FTlRFUlIgICAgICAgIDUKKyNkZWZpbmUgRkZTX1NFTUFQSE9S
RUVSUiAgICAgICAgNgorI2RlZmluZSBGRlNfSU5WQUxJRFBBVEggICAgICAgICA3CisjZGVmaW5l
IEZGU19JTlZBTElERklEICAgICAgICAgIDgKKyNkZWZpbmUgRkZTX05PVEZPVU5EICAgICAgICAg
ICAgOQorI2RlZmluZSBGRlNfRklMRUVYSVNUICAgICAgICAgICAxMAorI2RlZmluZSBGRlNfUEVS
TUlTU0lPTkVSUiAgICAgICAxMQorI2RlZmluZSBGRlNfTk9UT1BFTkVEICAgICAgICAgICAxMgor
I2RlZmluZSBGRlNfTUFYT1BFTkVEICAgICAgICAgICAxMworI2RlZmluZSBGRlNfRlVMTCAgICAg
ICAgICAgICAgICAxNAorI2RlZmluZSBGRlNfRU9GICAgICAgICAgICAgICAgICAxNQorI2RlZmlu
ZSBGRlNfRElSQlVTWSAgICAgICAgICAgICAxNgorI2RlZmluZSBGRlNfTUVNT1JZRVJSICAgICAg
ICAgICAxNworI2RlZmluZSBGRlNfTkFNRVRPT0xPTkcJCTE4CisjZGVmaW5lIEZGU19FUlJPUiAg
ICAgICAgICAgICAgIDE5CisKKyNkZWZpbmUgTlVNX1VQQ0FTRSAgICAgICAgICAgICAgMjkxOAor
CisjZGVmaW5lIERPU19DVVJfRElSX05BTUUgICAgICAgICIuICAgICAgICAgICIKKyNkZWZpbmUg
RE9TX1BBUl9ESVJfTkFNRSAgICAgICAgIi4uICAgICAgICAgIgorCisjaWZkZWYgX19MSVRUTEVf
RU5ESUFOCisjZGVmaW5lIFVOSV9DVVJfRElSX05BTUUgICAgICAgICIuXDAiCisjZGVmaW5lIFVO
SV9QQVJfRElSX05BTUUgICAgICAgICIuXDAuXDAiCisjZWxzZQorI2RlZmluZSBVTklfQ1VSX0RJ
Ul9OQU1FICAgICAgICAiXDAuIgorI2RlZmluZSBVTklfUEFSX0RJUl9OQU1FICAgICAgICAiXDAu
XDAuIgorI2VuZGlmCisKK3N0cnVjdCBkYXRlX3RpbWVfdCB7CisJdTE2ICAgICAgWWVhcjsKKwl1
MTYgICAgICBNb250aDsKKwl1MTYgICAgICBEYXk7CisJdTE2ICAgICAgSG91cjsKKwl1MTYgICAg
ICBNaW51dGU7CisJdTE2ICAgICAgU2Vjb25kOworCXUxNiAgICAgIE1pbGxpU2Vjb25kOworfTsK
Kworc3RydWN0IHBhcnRfaW5mb190IHsKKwl1MzIgICAgICBPZmZzZXQ7ICAgIC8qIHN0YXJ0IHNl
Y3RvciBudW1iZXIgb2YgdGhlIHBhcnRpdGlvbiAqLworCXUzMiAgICAgIFNpemU7ICAgICAgLyog
aW4gc2VjdG9ycyAqLworfTsKKworc3RydWN0IGRldl9pbmZvX3QgeworCXUzMiAgICAgIFNlY1Np
emU7ICAgIC8qIHNlY3RvciBzaXplIGluIGJ5dGVzICovCisJdTMyICAgICAgRGV2U2l6ZTsgICAg
LyogYmxvY2sgZGV2aWNlIHNpemUgaW4gc2VjdG9ycyAqLworfTsKKworc3RydWN0IHZvbF9pbmZv
X3QgeworCXUzMiAgICAgIEZhdFR5cGU7CisJdTMyICAgICAgQ2x1c3RlclNpemU7CisJdTMyICAg
ICAgTnVtQ2x1c3RlcnM7CisJdTMyICAgICAgRnJlZUNsdXN0ZXJzOworCXUzMiAgICAgIFVzZWRD
bHVzdGVyczsKK307CisKKy8qIGRpcmVjdG9yeSBzdHJ1Y3R1cmUgKi8KK3N0cnVjdCBjaGFpbl90
IHsKKwl1MzIgICAgICBkaXI7CisJczMyICAgICAgIHNpemU7CisJdTggICAgICAgZmxhZ3M7Cit9
OworCitzdHJ1Y3QgZmlsZV9pZF90IHsKKwlzdHJ1Y3QgY2hhaW5fdCAgICAgZGlyOworCXMzMiAg
ICAgICBlbnRyeTsKKwl1MzIgICAgICB0eXBlOworCXUzMiAgICAgIGF0dHI7CisJdTMyICAgICAg
c3RhcnRfY2x1OworCXU2NCAgICAgIHNpemU7CisJdTggICAgICAgZmxhZ3M7CisJczY0ICAgICAg
IHJ3b2Zmc2V0OworCXMzMiAgICAgICBoaW50X2xhc3Rfb2ZmOworCXUzMiAgICAgIGhpbnRfbGFz
dF9jbHU7Cit9OworCitzdHJ1Y3QgZGlyX2VudHJ5X3QgeworCWNoYXIgTmFtZVtNQVhfTkFNRV9M
RU5HVEggKiBNQVhfQ0hBUlNFVF9TSVpFXTsKKworCS8qIHVzZWQgb25seSBmb3IgRkFUMTIvMTYv
MzIsIG5vdCB1c2VkIGZvciBleEZBVCAqLworCWNoYXIgU2hvcnROYW1lW0RPU19OQU1FX0xFTkdU
SCArIDJdOworCisJdTMyIEF0dHI7CisJdTY0IFNpemU7CisJdTMyIE51bVN1YmRpcnM7CisJc3Ry
dWN0IGRhdGVfdGltZV90IENyZWF0ZVRpbWVzdGFtcDsKKwlzdHJ1Y3QgZGF0ZV90aW1lX3QgTW9k
aWZ5VGltZXN0YW1wOworCXN0cnVjdCBkYXRlX3RpbWVfdCBBY2Nlc3NUaW1lc3RhbXA7Cit9Owor
CitzdHJ1Y3QgdGltZXN0YW1wX3QgeworCXUxNiAgICAgIHNlYzsgICAgICAgIC8qIDAgfiA1OSAg
ICAgICAgICAgICAgICovCisJdTE2ICAgICAgbWluOyAgICAgICAgLyogMCB+IDU5ICAgICAgICAg
ICAgICAgKi8KKwl1MTYgICAgICBob3VyOyAgICAgICAvKiAwIH4gMjMgICAgICAgICAgICAgICAq
LworCXUxNiAgICAgIGRheTsgICAgICAgIC8qIDEgfiAzMSAgICAgICAgICAgICAgICovCisJdTE2
ICAgICAgbW9uOyAgICAgICAgLyogMSB+IDEyICAgICAgICAgICAgICAgKi8KKwl1MTYgICAgICB5
ZWFyOyAgICAgICAvKiAwIH4gMTI3IChzaW5jZSAxOTgwKSAqLworfTsKKworLyogTVNfRE9TIEZB
VCBwYXJ0aXRpb24gYm9vdCByZWNvcmQgKDUxMiBieXRlcykgKi8KK3N0cnVjdCBwYnJfc2VjdG9y
X3QgeworCXU4ICAgICAgIGptcF9ib290WzNdOworCXU4ICAgICAgIG9lbV9uYW1lWzhdOworCXU4
ICAgICAgIGJwYlsxMDldOworCXU4ICAgICAgIGJvb3RfY29kZVszOTBdOworCXU4ICAgICAgIHNp
Z25hdHVyZVsyXTsKK307CisKKy8qIE1TLURPUyBGQVQxMi8xNiBCSU9TIHBhcmFtZXRlciBibG9j
ayAoNTEgYnl0ZXMpICovCitzdHJ1Y3QgYnBiMTZfdCB7CisJdTggICAgICAgc2VjdG9yX3NpemVb
Ml07CisJdTggICAgICAgc2VjdG9yc19wZXJfY2x1OworCXU4ICAgICAgIG51bV9yZXNlcnZlZFsy
XTsKKwl1OCAgICAgICBudW1fZmF0czsKKwl1OCAgICAgICBudW1fcm9vdF9lbnRyaWVzWzJdOwor
CXU4ICAgICAgIG51bV9zZWN0b3JzWzJdOworCXU4ICAgICAgIG1lZGlhX3R5cGU7CisJdTggICAg
ICAgbnVtX2ZhdF9zZWN0b3JzWzJdOworCXU4ICAgICAgIHNlY3RvcnNfaW5fdHJhY2tbMl07CisJ
dTggICAgICAgbnVtX2hlYWRzWzJdOworCXU4ICAgICAgIG51bV9oaWRfc2VjdG9yc1s0XTsKKwl1
OCAgICAgICBudW1faHVnZV9zZWN0b3JzWzRdOworCisJdTggICAgICAgcGh5X2Rydl9ubzsKKwl1
OCAgICAgICByZXNlcnZlZDsKKwl1OCAgICAgICBleHRfc2lnbmF0dXJlOworCXU4ICAgICAgIHZv
bF9zZXJpYWxbNF07CisJdTggICAgICAgdm9sX2xhYmVsWzExXTsKKwl1OCAgICAgICB2b2xfdHlw
ZVs4XTsKK307CisKKy8qIE1TLURPUyBGQVQzMiBCSU9TIHBhcmFtZXRlciBibG9jayAoNzkgYnl0
ZXMpICovCitzdHJ1Y3QgYnBiMzJfdCB7CisJdTggICAgICAgc2VjdG9yX3NpemVbMl07CisJdTgg
ICAgICAgc2VjdG9yc19wZXJfY2x1OworCXU4ICAgICAgIG51bV9yZXNlcnZlZFsyXTsKKwl1OCAg
ICAgICBudW1fZmF0czsKKwl1OCAgICAgICBudW1fcm9vdF9lbnRyaWVzWzJdOworCXU4ICAgICAg
IG51bV9zZWN0b3JzWzJdOworCXU4ICAgICAgIG1lZGlhX3R5cGU7CisJdTggICAgICAgbnVtX2Zh
dF9zZWN0b3JzWzJdOworCXU4ICAgICAgIHNlY3RvcnNfaW5fdHJhY2tbMl07CisJdTggICAgICAg
bnVtX2hlYWRzWzJdOworCXU4ICAgICAgIG51bV9oaWRfc2VjdG9yc1s0XTsKKwl1OCAgICAgICBu
dW1faHVnZV9zZWN0b3JzWzRdOworCXU4ICAgICAgIG51bV9mYXQzMl9zZWN0b3JzWzRdOworCXU4
ICAgICAgIGV4dF9mbGFnc1syXTsKKwl1OCAgICAgICBmc192ZXJzaW9uWzJdOworCXU4ICAgICAg
IHJvb3RfY2x1c3Rlcls0XTsKKwl1OCAgICAgICBmc2luZm9fc2VjdG9yWzJdOworCXU4ICAgICAg
IGJhY2t1cF9zZWN0b3JbMl07CisJdTggICAgICAgcmVzZXJ2ZWRbMTJdOworCisJdTggICAgICAg
cGh5X2Rydl9ubzsKKwl1OCAgICAgICBleHRfcmVzZXJ2ZWQ7CisJdTggICAgICAgZXh0X3NpZ25h
dHVyZTsKKwl1OCAgICAgICB2b2xfc2VyaWFsWzRdOworCXU4ICAgICAgIHZvbF9sYWJlbFsxMV07
CisJdTggICAgICAgdm9sX3R5cGVbOF07Cit9OworCisvKiBNUy1ET1MgRVhGQVQgQklPUyBwYXJh
bWV0ZXIgYmxvY2sgKDEwOSBieXRlcykgKi8KK3N0cnVjdCBicGJleF90IHsKKwl1OCAgICAgICBy
ZXNlcnZlZDFbNTNdOworCXU4ICAgICAgIHZvbF9vZmZzZXRbOF07CisJdTggICAgICAgdm9sX2xl
bmd0aFs4XTsKKwl1OCAgICAgICBmYXRfb2Zmc2V0WzRdOworCXU4ICAgICAgIGZhdF9sZW5ndGhb
NF07CisJdTggICAgICAgY2x1X29mZnNldFs0XTsKKwl1OCAgICAgICBjbHVfY291bnRbNF07CisJ
dTggICAgICAgcm9vdF9jbHVzdGVyWzRdOworCXU4ICAgICAgIHZvbF9zZXJpYWxbNF07CisJdTgg
ICAgICAgZnNfdmVyc2lvblsyXTsKKwl1OCAgICAgICB2b2xfZmxhZ3NbMl07CisJdTggICAgICAg
c2VjdG9yX3NpemVfYml0czsKKwl1OCAgICAgICBzZWN0b3JzX3Blcl9jbHVfYml0czsKKwl1OCAg
ICAgICBudW1fZmF0czsKKwl1OCAgICAgICBwaHlfZHJ2X25vOworCXU4ICAgICAgIHBlcmNfaW5f
dXNlOworCXU4ICAgICAgIHJlc2VydmVkMls3XTsKK307CisKKy8qIE1TLURPUyBGQVQgZmlsZSBz
eXN0ZW0gaW5mb3JtYXRpb24gc2VjdG9yICg1MTIgYnl0ZXMpICovCitzdHJ1Y3QgZnNpX3NlY3Rv
cl90IHsKKwl1OCAgICAgICBzaWduYXR1cmUxWzRdOworCXU4ICAgICAgIHJlc2VydmVkMVs0ODBd
OworCXU4ICAgICAgIHNpZ25hdHVyZTJbNF07CisJdTggICAgICAgZnJlZV9jbHVzdGVyWzRdOwor
CXU4ICAgICAgIG5leHRfY2x1c3Rlcls0XTsKKwl1OCAgICAgICByZXNlcnZlZDJbMTRdOworCXU4
ICAgICAgIHNpZ25hdHVyZTNbMl07Cit9OworCisvKiBNUy1ET1MgRkFUIGRpcmVjdG9yeSBlbnRy
eSAoMzIgYnl0ZXMpICovCitzdHJ1Y3QgZGVudHJ5X3QgeworCXU4ICAgICAgIGR1bW15WzMyXTsK
K307CisKK3N0cnVjdCBkb3NfZGVudHJ5X3QgeworCXU4ICAgICAgIG5hbWVbRE9TX05BTUVfTEVO
R1RIXTsKKwl1OCAgICAgICBhdHRyOworCXU4ICAgICAgIGxjYXNlOworCXU4ICAgICAgIGNyZWF0
ZV90aW1lX21zOworCXU4ICAgICAgIGNyZWF0ZV90aW1lWzJdOworCXU4ICAgICAgIGNyZWF0ZV9k
YXRlWzJdOworCXU4ICAgICAgIGFjY2Vzc19kYXRlWzJdOworCXU4ICAgICAgIHN0YXJ0X2NsdV9o
aVsyXTsKKwl1OCAgICAgICBtb2RpZnlfdGltZVsyXTsKKwl1OCAgICAgICBtb2RpZnlfZGF0ZVsy
XTsKKwl1OCAgICAgICBzdGFydF9jbHVfbG9bMl07CisJdTggICAgICAgc2l6ZVs0XTsKK307CisK
Ky8qIE1TLURPUyBGQVQgZXh0ZW5kZWQgZGlyZWN0b3J5IGVudHJ5ICgzMiBieXRlcykgKi8KK3N0
cnVjdCBleHRfZGVudHJ5X3QgeworCXU4ICAgICAgIG9yZGVyOworCXU4ICAgICAgIHVuaWNvZGVf
MF80WzEwXTsKKwl1OCAgICAgICBhdHRyOworCXU4ICAgICAgIHN5c2lkOworCXU4ICAgICAgIGNo
ZWNrc3VtOworCXU4ICAgICAgIHVuaWNvZGVfNV8xMFsxMl07CisJdTggICAgICAgc3RhcnRfY2x1
WzJdOworCXU4ICAgICAgIHVuaWNvZGVfMTFfMTJbNF07Cit9OworCisvKiBNUy1ET1MgRVhGQVQg
ZmlsZSBkaXJlY3RvcnkgZW50cnkgKDMyIGJ5dGVzKSAqLworc3RydWN0IGZpbGVfZGVudHJ5X3Qg
eworCXU4ICAgICAgIHR5cGU7CisJdTggICAgICAgbnVtX2V4dDsKKwl1OCAgICAgICBjaGVja3N1
bVsyXTsKKwl1OCAgICAgICBhdHRyWzJdOworCXU4ICAgICAgIHJlc2VydmVkMVsyXTsKKwl1OCAg
ICAgICBjcmVhdGVfdGltZVsyXTsKKwl1OCAgICAgICBjcmVhdGVfZGF0ZVsyXTsKKwl1OCAgICAg
ICBtb2RpZnlfdGltZVsyXTsKKwl1OCAgICAgICBtb2RpZnlfZGF0ZVsyXTsKKwl1OCAgICAgICBh
Y2Nlc3NfdGltZVsyXTsKKwl1OCAgICAgICBhY2Nlc3NfZGF0ZVsyXTsKKwl1OCAgICAgICBjcmVh
dGVfdGltZV9tczsKKwl1OCAgICAgICBtb2RpZnlfdGltZV9tczsKKwl1OCAgICAgICBhY2Nlc3Nf
dGltZV9tczsKKwl1OCAgICAgICByZXNlcnZlZDJbOV07Cit9OworCisvKiBNUy1ET1MgRVhGQVQg
c3RyZWFtIGV4dGVuc2lvbiBkaXJlY3RvcnkgZW50cnkgKDMyIGJ5dGVzKSAqLworc3RydWN0IHN0
cm1fZGVudHJ5X3QgeworCXU4ICAgICAgIHR5cGU7CisJdTggICAgICAgZmxhZ3M7CisJdTggICAg
ICAgcmVzZXJ2ZWQxOworCXU4ICAgICAgIG5hbWVfbGVuOworCXU4ICAgICAgIG5hbWVfaGFzaFsy
XTsKKwl1OCAgICAgICByZXNlcnZlZDJbMl07CisJdTggICAgICAgdmFsaWRfc2l6ZVs4XTsKKwl1
OCAgICAgICByZXNlcnZlZDNbNF07CisJdTggICAgICAgc3RhcnRfY2x1WzRdOworCXU4ICAgICAg
IHNpemVbOF07Cit9OworCisvKiBNUy1ET1MgRVhGQVQgZmlsZSBuYW1lIGRpcmVjdG9yeSBlbnRy
eSAoMzIgYnl0ZXMpICovCitzdHJ1Y3QgbmFtZV9kZW50cnlfdCB7CisJdTggICAgICAgdHlwZTsK
Kwl1OCAgICAgICBmbGFnczsKKwl1OCAgICAgICB1bmljb2RlXzBfMTRbMzBdOworfTsKKworLyog
TVMtRE9TIEVYRkFUIGFsbG9jYXRpb24gYml0bWFwIGRpcmVjdG9yeSBlbnRyeSAoMzIgYnl0ZXMp
ICovCitzdHJ1Y3QgYm1hcF9kZW50cnlfdCB7CisJdTggICAgICAgdHlwZTsKKwl1OCAgICAgICBm
bGFnczsKKwl1OCAgICAgICByZXNlcnZlZFsxOF07CisJdTggICAgICAgc3RhcnRfY2x1WzRdOwor
CXU4ICAgICAgIHNpemVbOF07Cit9OworCisvKiBNUy1ET1MgRVhGQVQgdXAtY2FzZSB0YWJsZSBk
aXJlY3RvcnkgZW50cnkgKDMyIGJ5dGVzKSAqLworc3RydWN0IGNhc2VfZGVudHJ5X3QgeworCXU4
ICAgICAgIHR5cGU7CisJdTggICAgICAgcmVzZXJ2ZWQxWzNdOworCXU4ICAgICAgIGNoZWNrc3Vt
WzRdOworCXU4ICAgICAgIHJlc2VydmVkMlsxMl07CisJdTggICAgICAgc3RhcnRfY2x1WzRdOwor
CXU4ICAgICAgIHNpemVbOF07Cit9OworCisvKiBNUy1ET1MgRVhGQVQgdm9sdW1lIGxhYmVsIGRp
cmVjdG9yeSBlbnRyeSAoMzIgYnl0ZXMpICovCitzdHJ1Y3Qgdm9sbV9kZW50cnlfdCB7CisJdTgg
ICAgICAgdHlwZTsKKwl1OCAgICAgICBsYWJlbF9sZW47CisJdTggICAgICAgdW5pY29kZV8wXzEw
WzIyXTsKKwl1OCAgICAgICByZXNlcnZlZFs4XTsKK307CisKKy8qIHVudXNlZCBlbnRyeSBoaW50
IGluZm9ybWF0aW9uICovCitzdHJ1Y3QgdWVudHJ5X3QgeworCXUzMiAgICAgIGRpcjsKKwlzMzIg
ICAgICAgZW50cnk7CisJc3RydWN0IGNoYWluX3QgICAgIGNsdTsKK307CisKKy8qIERPUyBuYW1l
IHN0cnVjdHVyZSAqLworc3RydWN0IGRvc19uYW1lX3QgeworCXU4ICAgICAgIG5hbWVbRE9TX05B
TUVfTEVOR1RIXTsKKwl1OCAgICAgICBuYW1lX2Nhc2U7Cit9OworCisvKiB1bmljb2RlIG5hbWUg
c3RydWN0dXJlICovCitzdHJ1Y3QgdW5pX25hbWVfdCB7CisJdTE2ICAgICAgbmFtZVtNQVhfTkFN
RV9MRU5HVEhdOworCXUxNiAgICAgIG5hbWVfaGFzaDsKKwl1OCAgICAgICBuYW1lX2xlbjsKK307
CisKK3N0cnVjdCBidWZfY2FjaGVfdCB7CisJc3RydWN0IGJ1Zl9jYWNoZV90ICpuZXh0OworCXN0
cnVjdCBidWZfY2FjaGVfdCAqcHJldjsKKwlzdHJ1Y3QgYnVmX2NhY2hlX3QgKmhhc2hfbmV4dDsK
KwlzdHJ1Y3QgYnVmX2NhY2hlX3QgKmhhc2hfcHJldjsKKwlzMzIgICAgICAgICAgICAgICAgZHJ2
OworCXNlY3Rvcl90ICAgICAgICAgIHNlYzsKKwl1MzIgICAgICAgICAgICAgICBmbGFnOworCXN0
cnVjdCBidWZmZXJfaGVhZCAgICpidWZfYmg7Cit9OworCitzdHJ1Y3QgZnNfZnVuYyB7CisJczMy
CSgqYWxsb2NfY2x1c3Rlcikoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgczMyIG51bV9hbGxvYywK
KwkJCQkgc3RydWN0IGNoYWluX3QgKnBfY2hhaW4pOworCXZvaWQJKCpmcmVlX2NsdXN0ZXIpKHN0
cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2NoYWluLAorCQkJCXMzMiBk
b19yZWxzZSk7CisJczMyCSgqY291bnRfdXNlZF9jbHVzdGVycykoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYik7CisKKwlzMzIJKCppbml0X2Rpcl9lbnRyeSkoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwg
c3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkJCSAgczMyIGVudHJ5LCB1MzIgdHlwZSwgdTMyIHN0
YXJ0X2NsdSwgdTY0IHNpemUpOworCXMzMgkoKmluaXRfZXh0X2VudHJ5KShzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJCQkJICBzMzIgZW50cnksIHMzMiBu
dW1fZW50cmllcywKKwkJCQkgIHN0cnVjdCB1bmlfbmFtZV90ICpwX3VuaW5hbWUsCisJCQkJICBz
dHJ1Y3QgZG9zX25hbWVfdCAqcF9kb3NuYW1lKTsKKwlzMzIJKCpmaW5kX2Rpcl9lbnRyeSkoc3Ry
dWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkJCSAgc3RydWN0
IHVuaV9uYW1lX3QgKnBfdW5pbmFtZSwgczMyIG51bV9lbnRyaWVzLAorCQkJCSAgc3RydWN0IGRv
c19uYW1lX3QgKnBfZG9zbmFtZSwgdTMyIHR5cGUpOworCXZvaWQJKCpkZWxldGVfZGlyX2VudHJ5
KShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJCSAgICBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIs
IHMzMiBlbnRyeSwKKwkJCQkgICAgczMyIG9mZnNldCwgczMyIG51bV9lbnRyaWVzKTsKKwl2b2lk
CSgqZ2V0X3VuaV9uYW1lX2Zyb21fZXh0X2VudHJ5KShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAor
CQkJCQkgICAgICAgc3RydWN0IGNoYWluX3QgKnBfZGlyLCBzMzIgZW50cnksCisJCQkJCSAgICAg
ICB1MTYgKnVuaW5hbWUpOworCXMzMgkoKmNvdW50X2V4dF9lbnRyaWVzKShzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKnNiLAorCQkJCSAgICAgc3RydWN0IGNoYWluX3QgKnBfZGlyLCBzMzIgZW50cnksCisJ
CQkJICAgICBzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnkpOworCXMzMgkoKmNhbGNfbnVtX2VudHJp
ZXMpKHN0cnVjdCB1bmlfbmFtZV90ICpwX3VuaW5hbWUpOworCisJdTMyCSgqZ2V0X2VudHJ5X3R5
cGUpKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSk7CisJdm9pZAkoKnNldF9lbnRyeV90eXBlKShz
dHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHUzMiB0eXBlKTsKKwl1MzIJKCpnZXRfZW50cnlfYXR0
cikoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5KTsKKwl2b2lkCSgqc2V0X2VudHJ5X2F0dHIpKHN0
cnVjdCBkZW50cnlfdCAqcF9lbnRyeSwgdTMyIGF0dHIpOworCXU4CSgqZ2V0X2VudHJ5X2ZsYWcp
KHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSk7CisJdm9pZAkoKnNldF9lbnRyeV9mbGFnKShzdHJ1
Y3QgZGVudHJ5X3QgKnBfZW50cnksIHU4IGZsYWcpOworCXUzMgkoKmdldF9lbnRyeV9jbHUwKShz
dHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnkpOworCXZvaWQJKCpzZXRfZW50cnlfY2x1MCkoc3RydWN0
IGRlbnRyeV90ICpwX2VudHJ5LCB1MzIgY2x1MCk7CisJdTY0CSgqZ2V0X2VudHJ5X3NpemUpKHN0
cnVjdCBkZW50cnlfdCAqcF9lbnRyeSk7CisJdm9pZAkoKnNldF9lbnRyeV9zaXplKShzdHJ1Y3Qg
ZGVudHJ5X3QgKnBfZW50cnksIHU2NCBzaXplKTsKKwl2b2lkCSgqZ2V0X2VudHJ5X3RpbWUpKHN0
cnVjdCBkZW50cnlfdCAqcF9lbnRyeSwKKwkJCQkgIHN0cnVjdCB0aW1lc3RhbXBfdCAqdHAsIHU4
IG1vZGUpOworCXZvaWQJKCpzZXRfZW50cnlfdGltZSkoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5
LAorCQkJCSAgc3RydWN0IHRpbWVzdGFtcF90ICp0cCwgdTggbW9kZSk7Cit9OworCitzdHJ1Y3Qg
ZnNfaW5mb190IHsKKwl1MzIgICAgICBkcnY7ICAgICAgICAgICAgICAgICAgICAvKiBkcml2ZSBJ
RCAqLworCXUzMiAgICAgIHZvbF90eXBlOyAgICAgICAgICAgICAgIC8qIHZvbHVtZSBGQVQgdHlw
ZSAqLworCXUzMiAgICAgIHZvbF9pZDsgICAgICAgICAgICAgICAgIC8qIHZvbHVtZSBzZXJpYWwg
bnVtYmVyICovCisKKwl1NjQgICAgICBudW1fc2VjdG9yczsgICAgICAgICAgICAvKiBudW0gb2Yg
c2VjdG9ycyBpbiB2b2x1bWUgKi8KKwl1MzIgICAgICBudW1fY2x1c3RlcnM7ICAgICAgICAgICAv
KiBudW0gb2YgY2x1c3RlcnMgaW4gdm9sdW1lICovCisJdTMyICAgICAgY2x1c3Rlcl9zaXplOyAg
ICAgICAgICAgLyogY2x1c3RlciBzaXplIGluIGJ5dGVzICovCisJdTMyICAgICAgY2x1c3Rlcl9z
aXplX2JpdHM7CisJdTMyICAgICAgc2VjdG9yc19wZXJfY2x1OyAgICAgICAgLyogY2x1c3RlciBz
aXplIGluIHNlY3RvcnMgKi8KKwl1MzIgICAgICBzZWN0b3JzX3Blcl9jbHVfYml0czsKKworCXUz
MiAgICAgIFBCUl9zZWN0b3I7ICAgICAgICAgICAgIC8qIFBCUiBzZWN0b3IgKi8KKwl1MzIgICAg
ICBGQVQxX3N0YXJ0X3NlY3RvcjsgICAgICAvKiBGQVQxIHN0YXJ0IHNlY3RvciAqLworCXUzMiAg
ICAgIEZBVDJfc3RhcnRfc2VjdG9yOyAgICAgIC8qIEZBVDIgc3RhcnQgc2VjdG9yICovCisJdTMy
ICAgICAgcm9vdF9zdGFydF9zZWN0b3I7ICAgICAgLyogcm9vdCBkaXIgc3RhcnQgc2VjdG9yICov
CisJdTMyICAgICAgZGF0YV9zdGFydF9zZWN0b3I7ICAgICAgLyogZGF0YSBhcmVhIHN0YXJ0IHNl
Y3RvciAqLworCXUzMiAgICAgIG51bV9GQVRfc2VjdG9yczsgICAgICAgIC8qIG51bSBvZiBGQVQg
c2VjdG9ycyAqLworCisJdTMyICAgICAgcm9vdF9kaXI7ICAgICAgICAgICAgICAgLyogcm9vdCBk
aXIgY2x1c3RlciAqLworCXUzMiAgICAgIGRlbnRyaWVzX2luX3Jvb3Q7ICAgICAgIC8qIG51bSBv
ZiBkZW50cmllcyBpbiByb290IGRpciAqLworCXUzMiAgICAgIGRlbnRyaWVzX3Blcl9jbHU7ICAg
ICAgIC8qIG51bSBvZiBkZW50cmllcyBwZXIgY2x1c3RlciAqLworCisJdTMyICAgICAgdm9sX2Zs
YWc7ICAgICAgICAgICAgICAgLyogdm9sdW1lIGRpcnR5IGZsYWcgKi8KKwlzdHJ1Y3QgYnVmZmVy
X2hlYWQgKnBicl9iaDsgICAgICAgICAvKiBQQlIgc2VjdG9yICovCisKKwl1MzIgICAgICBtYXBf
Y2x1OyAgICAgICAgICAgICAgICAvKiBhbGxvY2F0aW9uIGJpdG1hcCBzdGFydCBjbHVzdGVyICov
CisJdTMyICAgICAgbWFwX3NlY3RvcnM7ICAgICAgICAgICAgLyogbnVtIG9mIGFsbG9jYXRpb24g
Yml0bWFwIHNlY3RvcnMgKi8KKwlzdHJ1Y3QgYnVmZmVyX2hlYWQgKip2b2xfYW1hcDsgICAgICAv
KiBhbGxvY2F0aW9uIGJpdG1hcCAqLworCisJdTE2ICoqdm9sX3V0Ymw7CQkJLyogdXBjYXNlIHRh
YmxlICovCisKKwl1MzIgY2x1X3NyY2hfcHRyOwkJLyogY2x1c3RlciBzZWFyY2ggcG9pbnRlciAq
LworCXUzMiB1c2VkX2NsdXN0ZXJzOwkJLyogbnVtYmVyIG9mIHVzZWQgY2x1c3RlcnMgKi8KKwlz
dHJ1Y3QgdWVudHJ5X3QgaGludF91ZW50cnk7CS8qIHVudXNlZCBlbnRyeSBoaW50IGluZm9ybWF0
aW9uICovCisKKwl1MzIgZGV2X2VqZWN0ZWQ7CS8qIGJsb2NrIGRldmljZSBvcGVyYXRpb24gZXJy
b3IgZmxhZyAqLworCisJc3RydWN0IGZzX2Z1bmMgKmZzX2Z1bmM7CisJc3RydWN0IHNlbWFwaG9y
ZSB2X3NlbTsKKworCS8qIEZBVCBjYWNoZSAqLworCXN0cnVjdCBidWZfY2FjaGVfdCBGQVRfY2Fj
aGVfYXJyYXlbRkFUX0NBQ0hFX1NJWkVdOworCXN0cnVjdCBidWZfY2FjaGVfdCBGQVRfY2FjaGVf
bHJ1X2xpc3Q7CisJc3RydWN0IGJ1Zl9jYWNoZV90IEZBVF9jYWNoZV9oYXNoX2xpc3RbRkFUX0NB
Q0hFX0hBU0hfU0laRV07CisKKwkvKiBidWYgY2FjaGUgKi8KKwlzdHJ1Y3QgYnVmX2NhY2hlX3Qg
YnVmX2NhY2hlX2FycmF5W0JVRl9DQUNIRV9TSVpFXTsKKwlzdHJ1Y3QgYnVmX2NhY2hlX3QgYnVm
X2NhY2hlX2xydV9saXN0OworCXN0cnVjdCBidWZfY2FjaGVfdCBidWZfY2FjaGVfaGFzaF9saXN0
W0JVRl9DQUNIRV9IQVNIX1NJWkVdOworfTsKKworI2RlZmluZSBFU18yX0VOVFJJRVMJCTIKKyNk
ZWZpbmUgRVNfM19FTlRSSUVTCQkzCisjZGVmaW5lIEVTX0FMTF9FTlRSSUVTCQkwCisKK3N0cnVj
dCBlbnRyeV9zZXRfY2FjaGVfdCB7CisJLyogc2VjdG9yIG51bWJlciB0aGF0IGNvbnRhaW5zIGZp
bGVfZW50cnkgKi8KKwlzZWN0b3JfdCBzZWN0b3I7CisKKwkvKiBieXRlIG9mZnNldCBpbiB0aGUg
c2VjdG9yICovCisJczMyIG9mZnNldDsKKworCS8qCisJICogZmxhZyBpbiBzdHJlYW0gZW50cnku
CisJICogMDEgZm9yIGNsdXN0ZXIgY2hhaW4sCisJICogMDMgZm9yIGNvbnRpZy4gY2x1c3RlcmVz
LgorCSAqLworCXMzMiBhbGxvY19mbGFnOworCisJdTMyIG51bV9lbnRyaWVzOworCisJLyogX19i
dWYgc2hvdWxkIGJlIHRoZSBsYXN0IG1lbWJlciAqLworCXZvaWQgKl9fYnVmOworfTsKKworI2Rl
ZmluZSBFWEZBVF9FUlJPUlNfQ09OVAkxCS8qIGlnbm9yZSBlcnJvciBhbmQgY29udGludWUgKi8K
KyNkZWZpbmUgRVhGQVRfRVJST1JTX1BBTklDCTIJLyogcGFuaWMgb24gZXJyb3IgKi8KKyNkZWZp
bmUgRVhGQVRfRVJST1JTX1JPCQkzCS8qIHJlbW91bnQgci9vIG9uIGVycm9yICovCisKKy8qIGlv
Y3RsIGNvbW1hbmQgKi8KKyNkZWZpbmUgRVhGQVRfSU9DVExfR0VUX1ZPTFVNRV9JRCBfSU9SKCdy
JywgMHgxMiwgX191MzIpCisKK3N0cnVjdCBleGZhdF9tb3VudF9vcHRpb25zIHsKKwlrdWlkX3Qg
ZnNfdWlkOworCWtnaWRfdCBmc19naWQ7CisJdW5zaWduZWQgc2hvcnQgZnNfZm1hc2s7CisJdW5z
aWduZWQgc2hvcnQgZnNfZG1hc2s7CisKKwkvKiBwZXJtaXNzaW9uIGZvciBzZXR0aW5nIHRoZSBb
YW1ddGltZSAqLworCXVuc2lnbmVkIHNob3J0IGFsbG93X3V0aW1lOworCisJLyogY29kZXBhZ2Ug
Zm9yIHNob3J0bmFtZSBjb252ZXJzaW9ucyAqLworCXVuc2lnbmVkIHNob3J0IGNvZGVwYWdlOwor
CisJLyogY2hhcnNldCBmb3IgZmlsZW5hbWUgaW5wdXQvZGlzcGxheSAqLworCWNoYXIgKmlvY2hh
cnNldDsKKworCXVuc2lnbmVkIGNoYXIgY2FzZXNlbnNpdGl2ZTsKKworCS8qIG9uIGVycm9yOiBj
b250aW51ZSwgcGFuaWMsIHJlbW91bnQtcm8gKi8KKwl1bnNpZ25lZCBjaGFyIGVycm9yczsKKyNp
ZmRlZiBDT05GSUdfRVhGQVRfRElTQ0FSRAorCS8qIGZsYWcgb24gaWYgLW8gZGljYXJkIHNwZWNp
ZmllZCBhbmQgZGV2aWNlIHN1cHBvcnQgZGlzY2FyZCgpICovCisJdW5zaWduZWQgY2hhciBkaXNj
YXJkOworI2VuZGlmIC8qIENPTkZJR19FWEZBVF9ESVNDQVJEICovCit9OworCisjZGVmaW5lIEVY
RkFUX0hBU0hfQklUUwkJOAorI2RlZmluZSBFWEZBVF9IQVNIX1NJWkUJCSgxVUwgPDwgRVhGQVRf
SEFTSF9CSVRTKQorCisvKgorICogRVhGQVQgZmlsZSBzeXN0ZW0gaW4tY29yZSBzdXBlcmJsb2Nr
IGRhdGEKKyAqLworc3RydWN0IGJkX2luZm9fdCB7CisJczMyIHNlY3Rvcl9zaXplOwkvKiBpbiBi
eXRlcyAqLworCXMzMiBzZWN0b3Jfc2l6ZV9iaXRzOworCXMzMiBzZWN0b3Jfc2l6ZV9tYXNrOwor
CisJLyogdG90YWwgbnVtYmVyIG9mIHNlY3RvcnMgaW4gdGhpcyBibG9jayBkZXZpY2UgKi8KKwlz
MzIgbnVtX3NlY3RvcnM7CisKKwkvKiBvcGVuZWQgb3Igbm90ICovCisJYm9vbCBvcGVuZWQ7Cit9
OworCitzdHJ1Y3QgZXhmYXRfc2JfaW5mbyB7CisJc3RydWN0IGZzX2luZm9fdCBmc19pbmZvOwor
CXN0cnVjdCBiZF9pbmZvX3QgYmRfaW5mbzsKKworCXN0cnVjdCBleGZhdF9tb3VudF9vcHRpb25z
IG9wdGlvbnM7CisKKwlpbnQgc19kaXJ0OworCXN0cnVjdCBtdXRleCBzX2xvY2s7CisJc3RydWN0
IG5sc190YWJsZSAqbmxzX2Rpc2s7IC8qIENvZGVwYWdlIHVzZWQgb24gZGlzayAqLworCXN0cnVj
dCBubHNfdGFibGUgKm5sc19pbzsgICAvKiBDaGFyc2V0IHVzZWQgZm9yIGlucHV0IGFuZCBkaXNw
bGF5ICovCisKKwlzdHJ1Y3QgaW5vZGUgKmZhdF9pbm9kZTsKKworCXNwaW5sb2NrX3QgaW5vZGVf
aGFzaF9sb2NrOworCXN0cnVjdCBobGlzdF9oZWFkIGlub2RlX2hhc2h0YWJsZVtFWEZBVF9IQVNI
X1NJWkVdOworI2lmZGVmIENPTkZJR19FWEZBVF9LRVJORUxfREVCVUcKKwlsb25nIGRlYnVnX2Zs
YWdzOworI2VuZGlmIC8qIENPTkZJR19FWEZBVF9LRVJORUxfREVCVUcgKi8KK307CisKKy8qCisg
KiBFWEZBVCBmaWxlIHN5c3RlbSBpbm9kZSBkYXRhIGluIG1lbW9yeQorICovCitzdHJ1Y3QgZXhm
YXRfaW5vZGVfaW5mbyB7CisJc3RydWN0IGZpbGVfaWRfdCBmaWQ7CisJY2hhciAgKnRhcmdldDsK
KwkvKiBOT1RFOiBtbXVfcHJpdmF0ZSBpcyA2NGJpdHMsIHNvIG11c3QgaG9sZCAtPmlfbXV0ZXgg
dG8gYWNjZXNzICovCisJbG9mZl90IG1tdV9wcml2YXRlOwkvKiBwaHlzaWNhbGx5IGFsbG9jYXRl
ZCBzaXplICovCisJbG9mZl90IGlfcG9zOwkJLyogb24tZGlzayBwb3NpdGlvbiBvZiBkaXJlY3Rv
cnkgZW50cnkgb3IgMCAqLworCXN0cnVjdCBobGlzdF9ub2RlIGlfaGFzaF9mYXQ7CS8qIGhhc2gg
YnkgaV9sb2NhdGlvbiAqLworCXN0cnVjdCByd19zZW1hcGhvcmUgdHJ1bmNhdGVfbG9jazsKKwlz
dHJ1Y3QgaW5vZGUgdmZzX2lub2RlOworCXN0cnVjdCByd19zZW1hcGhvcmUgaV9hbGxvY19zZW07
IC8qIHByb3RlY3QgYm1hcCBhZ2FpbnN0IHRydW5jYXRlICovCit9OworCisjZGVmaW5lIEVYRkFU
X1NCKHNiKQkJKChzdHJ1Y3QgZXhmYXRfc2JfaW5mbyAqKSgoc2IpLT5zX2ZzX2luZm8pKQorCitz
dGF0aWMgaW5saW5lIHN0cnVjdCBleGZhdF9pbm9kZV9pbmZvICpFWEZBVF9JKHN0cnVjdCBpbm9k
ZSAqaW5vZGUpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihpbm9kZSwgc3RydWN0IGV4ZmF0X2lu
b2RlX2luZm8sIHZmc19pbm9kZSk7Cit9CisKKy8qIE5MUyBtYW5hZ2VtZW50IGZ1bmN0aW9uICov
Cit1MTYgbmxzX3VwcGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHUxNiBhKTsKK2ludCBubHNf
ZG9zbmFtZV9jbXAoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTggKmEsIHU4ICpiKTsKK2ludCBu
bHNfdW5pbmFtZV9jbXAoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTE2ICphLCB1MTYgKmIpOwor
dm9pZCBubHNfdW5pbmFtZV90b19kb3NuYW1lKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsCisJCQkg
ICAgc3RydWN0IGRvc19uYW1lX3QgKnBfZG9zbmFtZSwKKwkJCSAgICBzdHJ1Y3QgdW5pX25hbWVf
dCAqcF91bmluYW1lLCBib29sICpwX2xvc3N5KTsKK3ZvaWQgbmxzX2Rvc25hbWVfdG9fdW5pbmFt
ZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJICAgIHN0cnVjdCB1bmlfbmFtZV90ICpwX3Vu
aW5hbWUsCisJCQkgICAgc3RydWN0IGRvc19uYW1lX3QgKnBfZG9zbmFtZSk7Cit2b2lkIG5sc191
bmluYW1lX3RvX2NzdHJpbmcoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTggKnBfY3N0cmluZywK
KwkJCSAgICBzdHJ1Y3QgdW5pX25hbWVfdCAqcF91bmluYW1lKTsKK3ZvaWQgbmxzX2NzdHJpbmdf
dG9fdW5pbmFtZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJICAgIHN0cnVjdCB1bmlfbmFt
ZV90ICpwX3VuaW5hbWUsIHU4ICpwX2NzdHJpbmcsCisJCQkgICAgYm9vbCAqcF9sb3NzeSk7CisK
Ky8qIGJ1ZmZlciBjYWNoZSBtYW5hZ2VtZW50ICovCit2b2lkIGJ1Zl9pbml0KHN0cnVjdCBzdXBl
cl9ibG9jayAqc2IpOwordm9pZCBidWZfc2h1dGRvd24oc3RydWN0IHN1cGVyX2Jsb2NrICpzYik7
CitpbnQgRkFUX3JlYWQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTMyIGxvYywgdTMyICpjb250
ZW50KTsKK3MzMiBGQVRfd3JpdGUoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTMyIGxvYywgdTMy
IGNvbnRlbnQpOwordTggKkZBVF9nZXRibGsoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc2VjdG9y
X3Qgc2VjKTsKK3ZvaWQgRkFUX21vZGlmeShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzZWN0b3Jf
dCBzZWMpOwordm9pZCBGQVRfcmVsZWFzZV9hbGwoc3RydWN0IHN1cGVyX2Jsb2NrICpzYik7Cit2
b2lkIEZBVF9zeW5jKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpOwordTggKmJ1Zl9nZXRibGsoc3Ry
dWN0IHN1cGVyX2Jsb2NrICpzYiwgc2VjdG9yX3Qgc2VjKTsKK3ZvaWQgYnVmX21vZGlmeShzdHJ1
Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzZWN0b3JfdCBzZWMpOwordm9pZCBidWZfbG9jayhzdHJ1Y3Qg
c3VwZXJfYmxvY2sgKnNiLCBzZWN0b3JfdCBzZWMpOwordm9pZCBidWZfdW5sb2NrKHN0cnVjdCBz
dXBlcl9ibG9jayAqc2IsIHNlY3Rvcl90IHNlYyk7Cit2b2lkIGJ1Zl9yZWxlYXNlKHN0cnVjdCBz
dXBlcl9ibG9jayAqc2IsIHNlY3Rvcl90IHNlYyk7Cit2b2lkIGJ1Zl9yZWxlYXNlX2FsbChzdHJ1
Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKK3ZvaWQgYnVmX3N5bmMoc3RydWN0IHN1cGVyX2Jsb2NrICpz
Yik7CisKKy8qIGZzIG1hbmFnZW1lbnQgZnVuY3Rpb25zICovCit2b2lkIGZzX3NldF92b2xfZmxh
Z3Moc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTMyIG5ld19mbGFnKTsKK3ZvaWQgZnNfZXJyb3Io
c3RydWN0IHN1cGVyX2Jsb2NrICpzYik7CisKKy8qIGNsdXN0ZXIgbWFuYWdlbWVudCBmdW5jdGlv
bnMgKi8KK3MzMiBjbGVhcl9jbHVzdGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHUzMiBjbHUp
OworczMyIGZhdF9hbGxvY19jbHVzdGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHMzMiBudW1f
YWxsb2MsCisJCSAgICAgIHN0cnVjdCBjaGFpbl90ICpwX2NoYWluKTsKK3MzMiBleGZhdF9hbGxv
Y19jbHVzdGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHMzMiBudW1fYWxsb2MsCisJCQlzdHJ1
Y3QgY2hhaW5fdCAqcF9jaGFpbik7Cit2b2lkIGZhdF9mcmVlX2NsdXN0ZXIoc3RydWN0IHN1cGVy
X2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfY2hhaW4sCisJCSAgICAgIHMzMiBkb19yZWxz
ZSk7Cit2b2lkIGV4ZmF0X2ZyZWVfY2x1c3RlcihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1
Y3QgY2hhaW5fdCAqcF9jaGFpbiwKKwkJCXMzMiBkb19yZWxzZSk7Cit1MzIgZmluZF9sYXN0X2Ns
dXN0ZXIoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfY2hhaW4pOwor
czMyIGNvdW50X251bV9jbHVzdGVycyhzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hh
aW5fdCAqZGlyKTsKK3MzMiBmYXRfY291bnRfdXNlZF9jbHVzdGVycyhzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiKTsKK3MzMiBleGZhdF9jb3VudF91c2VkX2NsdXN0ZXJzKHN0cnVjdCBzdXBlcl9ibG9j
ayAqc2IpOwordm9pZCBleGZhdF9jaGFpbl9jb250X2NsdXN0ZXIoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYiwgdTMyIGNoYWluLCBzMzIgbGVuKTsKKworLyogYWxsb2NhdGlvbiBiaXRtYXAgbWFuYWdl
bWVudCBmdW5jdGlvbnMgKi8KK3MzMiBsb2FkX2FsbG9jX2JpdG1hcChzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiKTsKK3ZvaWQgZnJlZV9hbGxvY19iaXRtYXAoc3RydWN0IHN1cGVyX2Jsb2NrICpzYik7
CitzMzIgc2V0X2FsbG9jX2JpdG1hcChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCB1MzIgY2x1KTsK
K3MzMiBjbHJfYWxsb2NfYml0bWFwKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHUzMiBjbHUpOwor
dTMyIHRlc3RfYWxsb2NfYml0bWFwKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHUzMiBjbHUpOwor
dm9pZCBzeW5jX2FsbG9jX2JpdG1hcChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKKworLyogdXBj
YXNlIHRhYmxlIG1hbmFnZW1lbnQgZnVuY3Rpb25zICovCitzMzIgbG9hZF91cGNhc2VfdGFibGUo
c3RydWN0IHN1cGVyX2Jsb2NrICpzYik7Cit2b2lkIGZyZWVfdXBjYXNlX3RhYmxlKHN0cnVjdCBz
dXBlcl9ibG9jayAqc2IpOworCisvKiBkaXIgZW50cnkgbWFuYWdlbWVudCBmdW5jdGlvbnMgKi8K
K3UzMiBmYXRfZ2V0X2VudHJ5X3R5cGUoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5KTsKK3UzMiBl
eGZhdF9nZXRfZW50cnlfdHlwZShzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnkpOwordm9pZCBmYXRf
c2V0X2VudHJ5X3R5cGUoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5LCB1MzIgdHlwZSk7Cit2b2lk
IGV4ZmF0X3NldF9lbnRyeV90eXBlKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSwgdTMyIHR5cGUp
OwordTMyIGZhdF9nZXRfZW50cnlfYXR0cihzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnkpOwordTMy
IGV4ZmF0X2dldF9lbnRyeV9hdHRyKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSk7Cit2b2lkIGZh
dF9zZXRfZW50cnlfYXR0cihzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHUzMiBhdHRyKTsKK3Zv
aWQgZXhmYXRfc2V0X2VudHJ5X2F0dHIoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5LCB1MzIgYXR0
cik7Cit1OCBmYXRfZ2V0X2VudHJ5X2ZsYWcoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5KTsKK3U4
IGV4ZmF0X2dldF9lbnRyeV9mbGFnKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSk7Cit2b2lkIGZh
dF9zZXRfZW50cnlfZmxhZyhzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHU4IGZsYWcpOwordm9p
ZCBleGZhdF9zZXRfZW50cnlfZmxhZyhzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHU4IGZsYWcp
OwordTMyIGZhdF9nZXRfZW50cnlfY2x1MChzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnkpOwordTMy
IGV4ZmF0X2dldF9lbnRyeV9jbHUwKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSk7Cit2b2lkIGZh
dF9zZXRfZW50cnlfY2x1MChzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHUzMiBzdGFydF9jbHUp
Owordm9pZCBleGZhdF9zZXRfZW50cnlfY2x1MChzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHUz
MiBzdGFydF9jbHUpOwordTY0IGZhdF9nZXRfZW50cnlfc2l6ZShzdHJ1Y3QgZGVudHJ5X3QgKnBf
ZW50cnkpOwordTY0IGV4ZmF0X2dldF9lbnRyeV9zaXplKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRy
eSk7Cit2b2lkIGZhdF9zZXRfZW50cnlfc2l6ZShzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHU2
NCBzaXplKTsKK3ZvaWQgZXhmYXRfc2V0X2VudHJ5X3NpemUoc3RydWN0IGRlbnRyeV90ICpwX2Vu
dHJ5LCB1NjQgc2l6ZSk7CitzdHJ1Y3QgdGltZXN0YW1wX3QgKnRtX2N1cnJlbnQoc3RydWN0IHRp
bWVzdGFtcF90ICp0bSk7Cit2b2lkIGZhdF9nZXRfZW50cnlfdGltZShzdHJ1Y3QgZGVudHJ5X3Qg
KnBfZW50cnksIHN0cnVjdCB0aW1lc3RhbXBfdCAqdHAsCisJCQl1OCBtb2RlKTsKK3ZvaWQgZXhm
YXRfZ2V0X2VudHJ5X3RpbWUoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5LCBzdHJ1Y3QgdGltZXN0
YW1wX3QgKnRwLAorCQkJICB1OCBtb2RlKTsKK3ZvaWQgZmF0X3NldF9lbnRyeV90aW1lKHN0cnVj
dCBkZW50cnlfdCAqcF9lbnRyeSwgc3RydWN0IHRpbWVzdGFtcF90ICp0cCwKKwkJCXU4IG1vZGUp
Owordm9pZCBleGZhdF9zZXRfZW50cnlfdGltZShzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHN0
cnVjdCB0aW1lc3RhbXBfdCAqdHAsCisJCQkgIHU4IG1vZGUpOworczMyIGZhdF9pbml0X2Rpcl9l
bnRyeShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsIHMzMiBl
bnRyeSwKKwkJICAgICAgIHUzMiB0eXBlLCB1MzIgc3RhcnRfY2x1LCB1NjQgc2l6ZSk7CitzMzIg
ZXhmYXRfaW5pdF9kaXJfZW50cnkoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWlu
X3QgKnBfZGlyLAorCQkJIHMzMiBlbnRyeSwgdTMyIHR5cGUsIHUzMiBzdGFydF9jbHUsIHU2NCBz
aXplKTsKK3MzMiBmYXRfaW5pdF9leHRfZGlyX2VudHJ5KHN0cnVjdCBzdXBlcl9ibG9jayAqc2Is
IHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJCSAgIHMzMiBlbnRyeSwgczMyIG51bV9lbnRyaWVz
LAorCQkJICAgc3RydWN0IHVuaV9uYW1lX3QgKnBfdW5pbmFtZSwKKwkJCSAgIHN0cnVjdCBkb3Nf
bmFtZV90ICpwX2Rvc25hbWUpOworczMyIGV4ZmF0X2luaXRfZXh0X2Rpcl9lbnRyeShzdHJ1Y3Qg
c3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJCQkgICAgIHMzMiBlbnRy
eSwgczMyIG51bV9lbnRyaWVzLAorCQkJICAgICBzdHJ1Y3QgdW5pX25hbWVfdCAqcF91bmluYW1l
LAorCQlzdHJ1Y3QgZG9zX25hbWVfdCAqcF9kb3NuYW1lKTsKK3ZvaWQgaW5pdF9kb3NfZW50cnko
c3RydWN0IGRvc19kZW50cnlfdCAqZXAsIHUzMiB0eXBlLCB1MzIgc3RhcnRfY2x1KTsKK3ZvaWQg
aW5pdF9leHRfZW50cnkoc3RydWN0IGV4dF9kZW50cnlfdCAqZXAsIHMzMiBvcmRlciwgdTggY2hr
c3VtLAorCQkgICAgdTE2ICp1bmluYW1lKTsKK3ZvaWQgaW5pdF9maWxlX2VudHJ5KHN0cnVjdCBm
aWxlX2RlbnRyeV90ICplcCwgdTMyIHR5cGUpOwordm9pZCBpbml0X3N0cm1fZW50cnkoc3RydWN0
IHN0cm1fZGVudHJ5X3QgKmVwLCB1OCBmbGFncywgdTMyIHN0YXJ0X2NsdSwKKwkJICAgICB1NjQg
c2l6ZSk7Cit2b2lkIGluaXRfbmFtZV9lbnRyeShzdHJ1Y3QgbmFtZV9kZW50cnlfdCAqZXAsIHUx
NiAqdW5pbmFtZSk7Cit2b2lkIGZhdF9kZWxldGVfZGlyX2VudHJ5KHN0cnVjdCBzdXBlcl9ibG9j
ayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJCSAgczMyIGVudHJ5LCBzMzIgb3JkZXIs
IHMzMiBudW1fZW50cmllcyk7Cit2b2lkIGV4ZmF0X2RlbGV0ZV9kaXJfZW50cnkoc3RydWN0IHN1
cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkJICAgIHMzMiBlbnRyeSwg
czMyIG9yZGVyLCBzMzIgbnVtX2VudHJpZXMpOworCitzMzIgZmluZF9sb2NhdGlvbihzdHJ1Y3Qg
c3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsIHMzMiBlbnRyeSwKKwkJICBz
ZWN0b3JfdCAqc2VjdG9yLCBzMzIgKm9mZnNldCk7CitzdHJ1Y3QgZGVudHJ5X3QgKmdldF9lbnRy
eV93aXRoX3NlY3RvcihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzZWN0b3JfdCBzZWN0b3IsCisJ
CQkJICAgICAgIHMzMiBvZmZzZXQpOworc3RydWN0IGRlbnRyeV90ICpnZXRfZW50cnlfaW5fZGly
KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJCQkgIHMz
MiBlbnRyeSwgc2VjdG9yX3QgKnNlY3Rvcik7CitzdHJ1Y3QgZW50cnlfc2V0X2NhY2hlX3QgKmdl
dF9lbnRyeV9zZXRfaW5fZGlyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsCisJCQkJCSAgICAgICBz
dHJ1Y3QgY2hhaW5fdCAqcF9kaXIsIHMzMiBlbnRyeSwKKwkJCQkJICAgICAgIHUzMiB0eXBlLAor
CQkJCQkgICAgICAgc3RydWN0IGRlbnRyeV90ICoqZmlsZV9lcCk7Cit2b2lkIHJlbGVhc2VfZW50
cnlfc2V0KHN0cnVjdCBlbnRyeV9zZXRfY2FjaGVfdCAqZXMpOworczMyIHdyaXRlX3dob2xlX2Vu
dHJ5X3NldChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgZW50cnlfc2V0X2NhY2hlX3Qg
KmVzKTsKK3MzMiB3cml0ZV9wYXJ0aWFsX2VudHJpZXNfaW5fZW50cnlfc2V0KHN0cnVjdCBzdXBl
cl9ibG9jayAqc2IsCisJCQkJICAgICAgIHN0cnVjdCBlbnRyeV9zZXRfY2FjaGVfdCAqZXMsCisJ
CQkJICAgICAgIHN0cnVjdCBkZW50cnlfdCAqZXAsIHUzMiBjb3VudCk7CitzMzIgc2VhcmNoX2Rl
bGV0ZWRfb3JfdW51c2VkX2VudHJ5KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsCisJCQkJICAgc3Ry
dWN0IGNoYWluX3QgKnBfZGlyLCBzMzIgbnVtX2VudHJpZXMpOworczMyIGZpbmRfZW1wdHlfZW50
cnkoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkgICAgIHMz
MiBudW1fZW50cmllcyk7CitzMzIgZmF0X2ZpbmRfZGlyX2VudHJ5KHN0cnVjdCBzdXBlcl9ibG9j
ayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJICAgICAgIHN0cnVjdCB1bmlfbmFtZV90
ICpwX3VuaW5hbWUsIHMzMiBudW1fZW50cmllcywKKwkJICAgICAgIHN0cnVjdCBkb3NfbmFtZV90
ICpwX2Rvc25hbWUsIHUzMiB0eXBlKTsKK3MzMiBleGZhdF9maW5kX2Rpcl9lbnRyeShzdHJ1Y3Qg
c3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJCQkgc3RydWN0IHVuaV9u
YW1lX3QgKnBfdW5pbmFtZSwgczMyIG51bV9lbnRyaWVzLAorCQkJIHN0cnVjdCBkb3NfbmFtZV90
ICpwX2Rvc25hbWUsIHUzMiB0eXBlKTsKK3MzMiBmYXRfY291bnRfZXh0X2VudHJpZXMoc3RydWN0
IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkJICBzMzIgZW50cnks
IHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSk7CitzMzIgZXhmYXRfY291bnRfZXh0X2VudHJpZXMo
c3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkJICAgIHMz
MiBlbnRyeSwgc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5KTsKK3MzMiBjb3VudF9kb3NfbmFtZV9l
bnRyaWVzKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJ
CSAgIHUzMiB0eXBlKTsKK3ZvaWQgdXBkYXRlX2Rpcl9jaGVja3N1bShzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJCQkgczMyIGVudHJ5KTsKK3ZvaWQgdXBk
YXRlX2Rpcl9jaGVja3N1bV93aXRoX2VudHJ5X3NldChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAor
CQkJCQlzdHJ1Y3QgZW50cnlfc2V0X2NhY2hlX3QgKmVzKTsKK2Jvb2wgaXNfZGlyX2VtcHR5KHN0
cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2Rpcik7CisKKy8qIG5hbWUg
Y29udmVyc2lvbiBmdW5jdGlvbnMgKi8KK3MzMiBnZXRfbnVtX2VudHJpZXNfYW5kX2Rvc19uYW1l
KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJCQkgc3Ry
dWN0IHVuaV9uYW1lX3QgKnBfdW5pbmFtZSwgczMyICplbnRyaWVzLAorCQkJCSBzdHJ1Y3QgZG9z
X25hbWVfdCAqcF9kb3NuYW1lKTsKK3ZvaWQgZ2V0X3VuaV9uYW1lX2Zyb21fZG9zX2VudHJ5KHN0
cnVjdCBzdXBlcl9ibG9jayAqc2IsCisJCQkJIHN0cnVjdCBkb3NfZGVudHJ5X3QgKmVwLAorCQkJ
CSBzdHJ1Y3QgdW5pX25hbWVfdCAqcF91bmluYW1lLCB1OCBtb2RlKTsKK3ZvaWQgZmF0X2dldF91
bmlfbmFtZV9mcm9tX2V4dF9lbnRyeShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJCSAgICAg
c3RydWN0IGNoYWluX3QgKnBfZGlyLCBzMzIgZW50cnksCisJCQkJICAgICB1MTYgKnVuaW5hbWUp
Owordm9pZCBleGZhdF9nZXRfdW5pX25hbWVfZnJvbV9leHRfZW50cnkoc3RydWN0IHN1cGVyX2Js
b2NrICpzYiwKKwkJCQkgICAgICAgc3RydWN0IGNoYWluX3QgKnBfZGlyLCBzMzIgZW50cnksCisJ
CQkJICAgICAgIHUxNiAqdW5pbmFtZSk7CitzMzIgZXh0cmFjdF91bmlfbmFtZV9mcm9tX2V4dF9l
bnRyeShzdHJ1Y3QgZXh0X2RlbnRyeV90ICplcCwKKwkJCQkgICAgdTE2ICp1bmluYW1lLCBzMzIg
b3JkZXIpOworczMyIGV4dHJhY3RfdW5pX25hbWVfZnJvbV9uYW1lX2VudHJ5KHN0cnVjdCBuYW1l
X2RlbnRyeV90ICplcCwKKwkJCQkgICAgIHUxNiAqdW5pbmFtZSwgczMyIG9yZGVyKTsKK3MzMiBm
YXRfZ2VuZXJhdGVfZG9zX25hbWUoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWlu
X3QgKnBfZGlyLAorCQkJICBzdHJ1Y3QgZG9zX25hbWVfdCAqcF9kb3NuYW1lKTsKK3ZvaWQgZmF0
X2F0dGFjaF9jb3VudF90b19kb3NfbmFtZSh1OCAqZG9zbmFtZSwgczMyIGNvdW50KTsKK3MzMiBm
YXRfY2FsY19udW1fZW50cmllcyhzdHJ1Y3QgdW5pX25hbWVfdCAqcF91bmluYW1lKTsKK3MzMiBl
eGZhdF9jYWxjX251bV9lbnRyaWVzKHN0cnVjdCB1bmlfbmFtZV90ICpwX3VuaW5hbWUpOwordTgg
Y2FsY19jaGVja3N1bV8xYnl0ZSh2b2lkICpkYXRhLCBzMzIgbGVuLCB1OCBjaGtzdW0pOwordTE2
IGNhbGNfY2hlY2tzdW1fMmJ5dGUodm9pZCAqZGF0YSwgczMyIGxlbiwgdTE2IGNoa3N1bSwgczMy
IHR5cGUpOwordTMyIGNhbGNfY2hlY2tzdW1fNGJ5dGUodm9pZCAqZGF0YSwgczMyIGxlbiwgdTMy
IGNoa3N1bSwgczMyIHR5cGUpOworCisvKiBuYW1lIHJlc29sdXRpb24gZnVuY3Rpb25zICovCitz
MzIgcmVzb2x2ZV9wYXRoKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNoYXIgKnBhdGgsIHN0cnVjdCBj
aGFpbl90ICpwX2RpciwKKwkJIHN0cnVjdCB1bmlfbmFtZV90ICpwX3VuaW5hbWUpOworczMyIHJl
c29sdmVfbmFtZSh1OCAqbmFtZSwgdTggKiphcmcpOworCisvKiBmaWxlIG9wZXJhdGlvbiBmdW5j
dGlvbnMgKi8KK3MzMiBmYXQxNl9tb3VudChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3Qg
cGJyX3NlY3Rvcl90ICpwX3Bicik7CitzMzIgZmF0MzJfbW91bnQoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYiwgc3RydWN0IHBicl9zZWN0b3JfdCAqcF9wYnIpOworczMyIGV4ZmF0X21vdW50KHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBwYnJfc2VjdG9yX3QgKnBfcGJyKTsKK3MzMiBjcmVh
dGVfZGlyKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkgICAg
ICAgc3RydWN0IHVuaV9uYW1lX3QgKnBfdW5pbmFtZSwgc3RydWN0IGZpbGVfaWRfdCAqZmlkKTsK
K3MzMiBjcmVhdGVfZmlsZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgY2hhaW5fdCAqcF9k
aXIsCisJCXN0cnVjdCB1bmlfbmFtZV90ICpwX3VuaW5hbWUsIHU4IG1vZGUsIHN0cnVjdCBmaWxl
X2lkX3QgKmZpZCk7Cit2b2lkIHJlbW92ZV9maWxlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVj
dCBjaGFpbl90ICpwX2RpciwgczMyIGVudHJ5KTsKK3MzMiByZW5hbWVfZmlsZShzdHJ1Y3QgaW5v
ZGUgKmlub2RlLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsIHMzMiBvbGRfZW50cnksCisJCXN0cnVj
dCB1bmlfbmFtZV90ICpwX3VuaW5hbWUsIHN0cnVjdCBmaWxlX2lkX3QgKmZpZCk7CitzMzIgbW92
ZV9maWxlKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBjaGFpbl90ICpwX29sZGRpciwgczMy
IG9sZGVudHJ5LAorCSAgICAgIHN0cnVjdCBjaGFpbl90ICpwX25ld2Rpciwgc3RydWN0IHVuaV9u
YW1lX3QgKnBfdW5pbmFtZSwKKwkgICAgICBzdHJ1Y3QgZmlsZV9pZF90ICpmaWQpOworCisvKiBz
ZWN0b3IgcmVhZC93cml0ZSBmdW5jdGlvbnMgKi8KK2ludCBzZWN0b3JfcmVhZChzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKnNiLCBzZWN0b3JfdCBzZWMsCisJCXN0cnVjdCBidWZmZXJfaGVhZCAqKmJoLCBi
b29sIHJlYWQpOworaW50IHNlY3Rvcl93cml0ZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzZWN0
b3JfdCBzZWMsCisJCSBzdHJ1Y3QgYnVmZmVyX2hlYWQgKmJoLCBib29sIHN5bmMpOworaW50IG11
bHRpX3NlY3Rvcl9yZWFkKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHNlY3Rvcl90IHNlYywKKwkJ
ICAgICAgc3RydWN0IGJ1ZmZlcl9oZWFkICoqYmgsIHMzMiBudW1fc2VjcywgYm9vbCByZWFkKTsK
K2ludCBtdWx0aV9zZWN0b3Jfd3JpdGUoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc2VjdG9yX3Qg
c2VjLAorCQkgICAgICAgc3RydWN0IGJ1ZmZlcl9oZWFkICpiaCwgczMyIG51bV9zZWNzLCBib29s
IHN5bmMpOworCit2b2lkIGJkZXZfb3BlbihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKK3ZvaWQg
YmRldl9jbG9zZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKTsKK2ludCBiZGV2X3JlYWQoc3RydWN0
IHN1cGVyX2Jsb2NrICpzYiwgc2VjdG9yX3Qgc2Vjbm8sCisJICAgICAgc3RydWN0IGJ1ZmZlcl9o
ZWFkICoqYmgsIHUzMiBudW1fc2VjcywgYm9vbCByZWFkKTsKK2ludCBiZGV2X3dyaXRlKHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IsIHNlY3Rvcl90IHNlY25vLAorCSAgICAgICBzdHJ1Y3QgYnVmZmVy
X2hlYWQgKmJoLCB1MzIgbnVtX3NlY3MsIGJvb2wgc3luYyk7CitpbnQgYmRldl9zeW5jKHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IpOworCitleHRlcm4gY29uc3QgdTggdW5pX3VwY2FzZVtdOworI2Vu
ZGlmIC8qIF9FWEZBVF9IICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhm
YXRfYmxrZGV2LmMgYi9kcml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhmYXRfYmxrZGV2LmMKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5mMDg2Yzc1ZTcwNzYKLS0tIC9kZXYv
bnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhmYXRfYmxrZGV2LmMKQEAgLTAsMCAr
MSwxMzYgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogIENv
cHlyaWdodCAoQykgMjAxMi0yMDEzIFNhbXN1bmcgRWxlY3Ryb25pY3MgQ28uLCBMdGQuCisgKi8K
KworI2luY2x1ZGUgPGxpbnV4L2Jsa2Rldi5oPgorI2luY2x1ZGUgPGxpbnV4L2J1ZmZlcl9oZWFk
Lmg+CisjaW5jbHVkZSA8bGludXgvZnMuaD4KKyNpbmNsdWRlICJleGZhdC5oIgorCit2b2lkIGJk
ZXZfb3BlbihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQoreworCXN0cnVjdCBiZF9pbmZvX3QgKnBf
YmQgPSAmKEVYRkFUX1NCKHNiKS0+YmRfaW5mbyk7CisKKwlpZiAocF9iZC0+b3BlbmVkKQorCQly
ZXR1cm47CisKKwlwX2JkLT5zZWN0b3Jfc2l6ZSAgICAgID0gYmRldl9sb2dpY2FsX2Jsb2NrX3Np
emUoc2ItPnNfYmRldik7CisJcF9iZC0+c2VjdG9yX3NpemVfYml0cyA9IGlsb2cyKHBfYmQtPnNl
Y3Rvcl9zaXplKTsKKwlwX2JkLT5zZWN0b3Jfc2l6ZV9tYXNrID0gcF9iZC0+c2VjdG9yX3NpemUg
LSAxOworCXBfYmQtPm51bV9zZWN0b3JzICAgICAgPSBpX3NpemVfcmVhZChzYi0+c19iZGV2LT5i
ZF9pbm9kZSkgPj4KKwkJCQkgcF9iZC0+c2VjdG9yX3NpemVfYml0czsKKwlwX2JkLT5vcGVuZWQg
PSB0cnVlOworfQorCit2b2lkIGJkZXZfY2xvc2Uoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sK
KwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihFWEZBVF9TQihzYiktPmJkX2luZm8pOworCisJ
cF9iZC0+b3BlbmVkID0gZmFsc2U7Cit9CisKK2ludCBiZGV2X3JlYWQoc3RydWN0IHN1cGVyX2Js
b2NrICpzYiwgc2VjdG9yX3Qgc2Vjbm8sIHN0cnVjdCBidWZmZXJfaGVhZCAqKmJoLAorCSAgICAg
IHUzMiBudW1fc2VjcywgYm9vbCByZWFkKQoreworCXN0cnVjdCBiZF9pbmZvX3QgKnBfYmQgPSAm
KEVYRkFUX1NCKHNiKS0+YmRfaW5mbyk7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhG
QVRfU0Ioc2IpLT5mc19pbmZvKTsKKyNpZmRlZiBDT05GSUdfRVhGQVRfS0VSTkVMX0RFQlVHCisJ
c3RydWN0IGV4ZmF0X3NiX2luZm8gKnNiaSA9IEVYRkFUX1NCKHNiKTsKKwlsb25nIGZsYWdzID0g
c2JpLT5kZWJ1Z19mbGFnczsKKworCWlmIChmbGFncyAmIEVYRkFUX0RFQlVHRkxBR1NfRVJST1Jf
UlcpCisJCXJldHVybiBGRlNfTUVESUFFUlI7CisjZW5kaWYgLyogQ09ORklHX0VYRkFUX0tFUk5F
TF9ERUJVRyAqLworCisJaWYgKCFwX2JkLT5vcGVuZWQpCisJCXJldHVybiBGRlNfTUVESUFFUlI7
CisKKwlpZiAoKmJoKQorCQlfX2JyZWxzZSgqYmgpOworCisJaWYgKHJlYWQpCisJCSpiaCA9IF9f
YnJlYWQoc2ItPnNfYmRldiwgc2Vjbm8sCisJCQkgICAgICBudW1fc2VjcyA8PCBwX2JkLT5zZWN0
b3Jfc2l6ZV9iaXRzKTsKKwllbHNlCisJCSpiaCA9IF9fZ2V0YmxrKHNiLT5zX2JkZXYsIHNlY25v
LAorCQkJICAgICAgIG51bV9zZWNzIDw8IHBfYmQtPnNlY3Rvcl9zaXplX2JpdHMpOworCisJaWYg
KCpiaCkKKwkJcmV0dXJuIDA7CisKKwlXQVJOKCFwX2ZzLT5kZXZfZWplY3RlZCwKKwkgICAgICJb
RVhGQVRdIE5vIGJoLCBkZXZpY2Ugc2VlbXMgd3Jvbmcgb3IgdG8gYmUgZWplY3RlZC5cbiIpOwor
CisJcmV0dXJuIEZGU19NRURJQUVSUjsKK30KKworaW50IGJkZXZfd3JpdGUoc3RydWN0IHN1cGVy
X2Jsb2NrICpzYiwgc2VjdG9yX3Qgc2Vjbm8sIHN0cnVjdCBidWZmZXJfaGVhZCAqYmgsCisJICAg
ICAgIHUzMiBudW1fc2VjcywgYm9vbCBzeW5jKQoreworCXMzMiBjb3VudDsKKwlzdHJ1Y3QgYnVm
ZmVyX2hlYWQgKmJoMjsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihFWEZBVF9TQihzYikt
PmJkX2luZm8pOworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNf
aW5mbyk7CisjaWZkZWYgQ09ORklHX0VYRkFUX0tFUk5FTF9ERUJVRworCXN0cnVjdCBleGZhdF9z
Yl9pbmZvICpzYmkgPSBFWEZBVF9TQihzYik7CisJbG9uZyBmbGFncyA9IHNiaS0+ZGVidWdfZmxh
Z3M7CisKKwlpZiAoZmxhZ3MgJiBFWEZBVF9ERUJVR0ZMQUdTX0VSUk9SX1JXKQorCQlyZXR1cm4g
RkZTX01FRElBRVJSOworI2VuZGlmIC8qIENPTkZJR19FWEZBVF9LRVJORUxfREVCVUcgKi8KKwor
CWlmICghcF9iZC0+b3BlbmVkKQorCQlyZXR1cm4gRkZTX01FRElBRVJSOworCisJaWYgKHNlY25v
ID09IGJoLT5iX2Jsb2NrbnIpIHsKKwkJbG9ja19idWZmZXIoYmgpOworCQlzZXRfYnVmZmVyX3Vw
dG9kYXRlKGJoKTsKKwkJbWFya19idWZmZXJfZGlydHkoYmgpOworCQl1bmxvY2tfYnVmZmVyKGJo
KTsKKwkJaWYgKHN5bmMgJiYgKHN5bmNfZGlydHlfYnVmZmVyKGJoKSAhPSAwKSkKKwkJCXJldHVy
biBGRlNfTUVESUFFUlI7CisJfSBlbHNlIHsKKwkJY291bnQgPSBudW1fc2VjcyA8PCBwX2JkLT5z
ZWN0b3Jfc2l6ZV9iaXRzOworCisJCWJoMiA9IF9fZ2V0YmxrKHNiLT5zX2JkZXYsIHNlY25vLCBj
b3VudCk7CisJCWlmICghYmgyKQorCQkJZ290byBub19iaDsKKworCQlsb2NrX2J1ZmZlcihiaDIp
OworCQltZW1jcHkoYmgyLT5iX2RhdGEsIGJoLT5iX2RhdGEsIGNvdW50KTsKKwkJc2V0X2J1ZmZl
cl91cHRvZGF0ZShiaDIpOworCQltYXJrX2J1ZmZlcl9kaXJ0eShiaDIpOworCQl1bmxvY2tfYnVm
ZmVyKGJoMik7CisJCWlmIChzeW5jICYmIChzeW5jX2RpcnR5X2J1ZmZlcihiaDIpICE9IDApKSB7
CisJCQlfX2JyZWxzZShiaDIpOworCQkJZ290byBub19iaDsKKwkJfQorCQlfX2JyZWxzZShiaDIp
OworCX0KKworCXJldHVybiAwOworCitub19iaDoKKwlXQVJOKCFwX2ZzLT5kZXZfZWplY3RlZCwK
KwkgICAgICJbRVhGQVRdIE5vIGJoLCBkZXZpY2Ugc2VlbXMgd3Jvbmcgb3IgdG8gYmUgZWplY3Rl
ZC5cbiIpOworCisJcmV0dXJuIEZGU19NRURJQUVSUjsKK30KKworaW50IGJkZXZfc3luYyhzdHJ1
Y3Qgc3VwZXJfYmxvY2sgKnNiKQoreworCXN0cnVjdCBiZF9pbmZvX3QgKnBfYmQgPSAmKEVYRkFU
X1NCKHNiKS0+YmRfaW5mbyk7CisjaWZkZWYgQ09ORklHX0VYRkFUX0tFUk5FTF9ERUJVRworCXN0
cnVjdCBleGZhdF9zYl9pbmZvICpzYmkgPSBFWEZBVF9TQihzYik7CisJbG9uZyBmbGFncyA9IHNi
aS0+ZGVidWdfZmxhZ3M7CisKKwlpZiAoZmxhZ3MgJiBFWEZBVF9ERUJVR0ZMQUdTX0VSUk9SX1JX
KQorCQlyZXR1cm4gRkZTX01FRElBRVJSOworI2VuZGlmIC8qIENPTkZJR19FWEZBVF9LRVJORUxf
REVCVUcgKi8KKworCWlmICghcF9iZC0+b3BlbmVkKQorCQlyZXR1cm4gRkZTX01FRElBRVJSOwor
CisJcmV0dXJuIHN5bmNfYmxvY2tkZXYoc2ItPnNfYmRldik7Cit9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL3N0YWdpbmcvZXhmYXQvZXhmYXRfY2FjaGUuYyBiL2RyaXZlcnMvc3RhZ2luZy9leGZhdC9l
eGZhdF9jYWNoZS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZjA1
ZDY5MmMyYjFlCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9zdGFnaW5nL2V4ZmF0L2V4ZmF0
X2NhY2hlLmMKQEAgLTAsMCArMSw3MjIgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wCisvKgorICogIENvcHlyaWdodCAoQykgMjAxMi0yMDEzIFNhbXN1bmcgRWxlY3Ryb25p
Y3MgQ28uLCBMdGQuCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2J1ZmZlcl9oZWFkLmg+CisjaW5j
bHVkZSA8bGludXgvZnMuaD4KKyNpbmNsdWRlIDxsaW51eC9tdXRleC5oPgorI2luY2x1ZGUgImV4
ZmF0LmgiCisKKyNkZWZpbmUgTE9DS0JJVAkJMHgwMQorI2RlZmluZSBESVJUWUJJVAkweDAyCisK
Ky8qIExvY2FsIHZhcmlhYmxlcyAqLworc3RhdGljIERFRklORV9TRU1BUEhPUkUoZl9zZW0pOwor
c3RhdGljIERFRklORV9TRU1BUEhPUkUoYl9zZW0pOworCitzdGF0aWMgc3RydWN0IGJ1Zl9jYWNo
ZV90ICpGQVRfY2FjaGVfZmluZChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzZWN0b3JfdCBzZWMp
Cit7CisJczMyIG9mZjsKKwlzdHJ1Y3QgYnVmX2NhY2hlX3QgKmJwLCAqaHA7CisJc3RydWN0IGZz
X2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCW9mZiA9IChzZWMg
KworCSAgICAgICAoc2VjID4+IHBfZnMtPnNlY3RvcnNfcGVyX2NsdV9iaXRzKSkgJiAoRkFUX0NB
Q0hFX0hBU0hfU0laRSAtIDEpOworCisJaHAgPSAmcF9mcy0+RkFUX2NhY2hlX2hhc2hfbGlzdFtv
ZmZdOworCWZvciAoYnAgPSBocC0+aGFzaF9uZXh0OyBicCAhPSBocDsgYnAgPSBicC0+aGFzaF9u
ZXh0KSB7CisJCWlmICgoYnAtPmRydiA9PSBwX2ZzLT5kcnYpICYmIChicC0+c2VjID09IHNlYykp
IHsKKwkJCVdBUk4oIWJwLT5idWZfYmgsCisJCQkgICAgICJbRVhGQVRdIEZBVF9jYWNoZSBoYXMg
bm8gYmguIEl0IHdpbGwgbWFrZSBzeXN0ZW0gcGFuaWMuXG4iKTsKKworCQkJdG91Y2hfYnVmZmVy
KGJwLT5idWZfYmgpOworCQkJcmV0dXJuIGJwOworCQl9CisJfQorCXJldHVybiBOVUxMOworfQor
CitzdGF0aWMgdm9pZCBwdXNoX3RvX21ydShzdHJ1Y3QgYnVmX2NhY2hlX3QgKmJwLCBzdHJ1Y3Qg
YnVmX2NhY2hlX3QgKmxpc3QpCit7CisJYnAtPm5leHQgPSBsaXN0LT5uZXh0OworCWJwLT5wcmV2
ID0gbGlzdDsKKwlsaXN0LT5uZXh0LT5wcmV2ID0gYnA7CisJbGlzdC0+bmV4dCA9IGJwOworfQor
CitzdGF0aWMgdm9pZCBwdXNoX3RvX2xydShzdHJ1Y3QgYnVmX2NhY2hlX3QgKmJwLCBzdHJ1Y3Qg
YnVmX2NhY2hlX3QgKmxpc3QpCit7CisJYnAtPnByZXYgPSBsaXN0LT5wcmV2OworCWJwLT5uZXh0
ID0gbGlzdDsKKwlsaXN0LT5wcmV2LT5uZXh0ID0gYnA7CisJbGlzdC0+cHJldiA9IGJwOworfQor
CitzdGF0aWMgdm9pZCBtb3ZlX3RvX21ydShzdHJ1Y3QgYnVmX2NhY2hlX3QgKmJwLCBzdHJ1Y3Qg
YnVmX2NhY2hlX3QgKmxpc3QpCit7CisJYnAtPnByZXYtPm5leHQgPSBicC0+bmV4dDsKKwlicC0+
bmV4dC0+cHJldiA9IGJwLT5wcmV2OworCXB1c2hfdG9fbXJ1KGJwLCBsaXN0KTsKK30KKworc3Rh
dGljIHZvaWQgbW92ZV90b19scnUoc3RydWN0IGJ1Zl9jYWNoZV90ICpicCwgc3RydWN0IGJ1Zl9j
YWNoZV90ICpsaXN0KQoreworCWJwLT5wcmV2LT5uZXh0ID0gYnAtPm5leHQ7CisJYnAtPm5leHQt
PnByZXYgPSBicC0+cHJldjsKKwlwdXNoX3RvX2xydShicCwgbGlzdCk7Cit9CisKK3N0YXRpYyBz
dHJ1Y3QgYnVmX2NhY2hlX3QgKkZBVF9jYWNoZV9nZXQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwg
c2VjdG9yX3Qgc2VjKQoreworCXN0cnVjdCBidWZfY2FjaGVfdCAqYnA7CisJc3RydWN0IGZzX2lu
Zm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCWJwID0gcF9mcy0+RkFU
X2NhY2hlX2xydV9saXN0LnByZXY7CisKKwltb3ZlX3RvX21ydShicCwgJnBfZnMtPkZBVF9jYWNo
ZV9scnVfbGlzdCk7CisJcmV0dXJuIGJwOworfQorCitzdGF0aWMgdm9pZCBGQVRfY2FjaGVfaW5z
ZXJ0X2hhc2goc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwKKwkJCQkgIHN0cnVjdCBidWZfY2FjaGVf
dCAqYnApCit7CisJczMyIG9mZjsKKwlzdHJ1Y3QgYnVmX2NhY2hlX3QgKmhwOworCXN0cnVjdCBm
c19pbmZvX3QgKnBfZnM7CisKKwlwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCW9m
ZiA9IChicC0+c2VjICsKKwkgICAgICAgKGJwLT5zZWMgPj4gcF9mcy0+c2VjdG9yc19wZXJfY2x1
X2JpdHMpKSAmCisJCShGQVRfQ0FDSEVfSEFTSF9TSVpFIC0gMSk7CisKKwlocCA9ICZwX2ZzLT5G
QVRfY2FjaGVfaGFzaF9saXN0W29mZl07CisJYnAtPmhhc2hfbmV4dCA9IGhwLT5oYXNoX25leHQ7
CisJYnAtPmhhc2hfcHJldiA9IGhwOworCWhwLT5oYXNoX25leHQtPmhhc2hfcHJldiA9IGJwOwor
CWhwLT5oYXNoX25leHQgPSBicDsKK30KKworc3RhdGljIHZvaWQgRkFUX2NhY2hlX3JlbW92ZV9o
YXNoKHN0cnVjdCBidWZfY2FjaGVfdCAqYnApCit7CisJKGJwLT5oYXNoX3ByZXYpLT5oYXNoX25l
eHQgPSBicC0+aGFzaF9uZXh0OworCShicC0+aGFzaF9uZXh0KS0+aGFzaF9wcmV2ID0gYnAtPmhh
c2hfcHJldjsKK30KKworc3RhdGljIHZvaWQgYnVmX2NhY2hlX2luc2VydF9oYXNoKHN0cnVjdCBz
dXBlcl9ibG9jayAqc2IsCisJCQkJICBzdHJ1Y3QgYnVmX2NhY2hlX3QgKmJwKQoreworCXMzMiBv
ZmY7CisJc3RydWN0IGJ1Zl9jYWNoZV90ICpocDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzOwor
CisJcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlvZmYgPSAoYnAtPnNlYyArCisJ
ICAgICAgIChicC0+c2VjID4+IHBfZnMtPnNlY3RvcnNfcGVyX2NsdV9iaXRzKSkgJgorCQkoQlVG
X0NBQ0hFX0hBU0hfU0laRSAtIDEpOworCisJaHAgPSAmcF9mcy0+YnVmX2NhY2hlX2hhc2hfbGlz
dFtvZmZdOworCWJwLT5oYXNoX25leHQgPSBocC0+aGFzaF9uZXh0OworCWJwLT5oYXNoX3ByZXYg
PSBocDsKKwlocC0+aGFzaF9uZXh0LT5oYXNoX3ByZXYgPSBicDsKKwlocC0+aGFzaF9uZXh0ID0g
YnA7Cit9CisKK3N0YXRpYyB2b2lkIGJ1Zl9jYWNoZV9yZW1vdmVfaGFzaChzdHJ1Y3QgYnVmX2Nh
Y2hlX3QgKmJwKQoreworCShicC0+aGFzaF9wcmV2KS0+aGFzaF9uZXh0ID0gYnAtPmhhc2hfbmV4
dDsKKwkoYnAtPmhhc2hfbmV4dCktPmhhc2hfcHJldiA9IGJwLT5oYXNoX3ByZXY7Cit9CisKK3Zv
aWQgYnVmX2luaXQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sKKwlzdHJ1Y3QgZnNfaW5mb190
ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJaW50IGk7CisKKwkvKiBMUlUg
bGlzdCAqLworCXBfZnMtPkZBVF9jYWNoZV9scnVfbGlzdC5uZXh0ID0gJnBfZnMtPkZBVF9jYWNo
ZV9scnVfbGlzdDsKKwlwX2ZzLT5GQVRfY2FjaGVfbHJ1X2xpc3QucHJldiA9ICZwX2ZzLT5GQVRf
Y2FjaGVfbHJ1X2xpc3Q7CisKKwlmb3IgKGkgPSAwOyBpIDwgRkFUX0NBQ0hFX1NJWkU7IGkrKykg
eworCQlwX2ZzLT5GQVRfY2FjaGVfYXJyYXlbaV0uZHJ2ID0gLTE7CisJCXBfZnMtPkZBVF9jYWNo
ZV9hcnJheVtpXS5zZWMgPSB+MDsKKwkJcF9mcy0+RkFUX2NhY2hlX2FycmF5W2ldLmZsYWcgPSAw
OworCQlwX2ZzLT5GQVRfY2FjaGVfYXJyYXlbaV0uYnVmX2JoID0gTlVMTDsKKwkJcF9mcy0+RkFU
X2NhY2hlX2FycmF5W2ldLnByZXYgPSBOVUxMOworCQlwX2ZzLT5GQVRfY2FjaGVfYXJyYXlbaV0u
bmV4dCA9IE5VTEw7CisJCXB1c2hfdG9fbXJ1KCZwX2ZzLT5GQVRfY2FjaGVfYXJyYXlbaV0sCisJ
CQkgICAgJnBfZnMtPkZBVF9jYWNoZV9scnVfbGlzdCk7CisJfQorCisJcF9mcy0+YnVmX2NhY2hl
X2xydV9saXN0Lm5leHQgPSAmcF9mcy0+YnVmX2NhY2hlX2xydV9saXN0OworCXBfZnMtPmJ1Zl9j
YWNoZV9scnVfbGlzdC5wcmV2ID0gJnBfZnMtPmJ1Zl9jYWNoZV9scnVfbGlzdDsKKworCWZvciAo
aSA9IDA7IGkgPCBCVUZfQ0FDSEVfU0laRTsgaSsrKSB7CisJCXBfZnMtPmJ1Zl9jYWNoZV9hcnJh
eVtpXS5kcnYgPSAtMTsKKwkJcF9mcy0+YnVmX2NhY2hlX2FycmF5W2ldLnNlYyA9IH4wOworCQlw
X2ZzLT5idWZfY2FjaGVfYXJyYXlbaV0uZmxhZyA9IDA7CisJCXBfZnMtPmJ1Zl9jYWNoZV9hcnJh
eVtpXS5idWZfYmggPSBOVUxMOworCQlwX2ZzLT5idWZfY2FjaGVfYXJyYXlbaV0ucHJldiA9IE5V
TEw7CisJCXBfZnMtPmJ1Zl9jYWNoZV9hcnJheVtpXS5uZXh0ID0gTlVMTDsKKwkJcHVzaF90b19t
cnUoJnBfZnMtPmJ1Zl9jYWNoZV9hcnJheVtpXSwKKwkJCSAgICAmcF9mcy0+YnVmX2NhY2hlX2xy
dV9saXN0KTsKKwl9CisKKwkvKiBIQVNIIGxpc3QgKi8KKwlmb3IgKGkgPSAwOyBpIDwgRkFUX0NB
Q0hFX0hBU0hfU0laRTsgaSsrKSB7CisJCXBfZnMtPkZBVF9jYWNoZV9oYXNoX2xpc3RbaV0uZHJ2
ID0gLTE7CisJCXBfZnMtPkZBVF9jYWNoZV9oYXNoX2xpc3RbaV0uc2VjID0gfjA7CisJCXBfZnMt
PkZBVF9jYWNoZV9oYXNoX2xpc3RbaV0uaGFzaF9uZXh0ID0KKwkJCSZwX2ZzLT5GQVRfY2FjaGVf
aGFzaF9saXN0W2ldOworCQlwX2ZzLT5GQVRfY2FjaGVfaGFzaF9saXN0W2ldLmhhc2hfcHJldiA9
CisJCQkmcF9mcy0+RkFUX2NhY2hlX2hhc2hfbGlzdFtpXTsKKwl9CisKKwlmb3IgKGkgPSAwOyBp
IDwgRkFUX0NBQ0hFX1NJWkU7IGkrKykKKwkJRkFUX2NhY2hlX2luc2VydF9oYXNoKHNiLCAmcF9m
cy0+RkFUX2NhY2hlX2FycmF5W2ldKTsKKworCWZvciAoaSA9IDA7IGkgPCBCVUZfQ0FDSEVfSEFT
SF9TSVpFOyBpKyspIHsKKwkJcF9mcy0+YnVmX2NhY2hlX2hhc2hfbGlzdFtpXS5kcnYgPSAtMTsK
KwkJcF9mcy0+YnVmX2NhY2hlX2hhc2hfbGlzdFtpXS5zZWMgPSB+MDsKKwkJcF9mcy0+YnVmX2Nh
Y2hlX2hhc2hfbGlzdFtpXS5oYXNoX25leHQgPQorCQkJJnBfZnMtPmJ1Zl9jYWNoZV9oYXNoX2xp
c3RbaV07CisJCXBfZnMtPmJ1Zl9jYWNoZV9oYXNoX2xpc3RbaV0uaGFzaF9wcmV2ID0KKwkJCSZw
X2ZzLT5idWZfY2FjaGVfaGFzaF9saXN0W2ldOworCX0KKworCWZvciAoaSA9IDA7IGkgPCBCVUZf
Q0FDSEVfU0laRTsgaSsrKQorCQlidWZfY2FjaGVfaW5zZXJ0X2hhc2goc2IsICZwX2ZzLT5idWZf
Y2FjaGVfYXJyYXlbaV0pOworfQorCit2b2lkIGJ1Zl9zaHV0ZG93bihzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiKQoreworfQorCitzdGF0aWMgaW50IF9fRkFUX3JlYWQoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYiwgdTMyIGxvYywgdTMyICpjb250ZW50KQoreworCXMzMiBvZmY7CisJdTMyIF9jb250ZW50
OworCXNlY3Rvcl90IHNlYzsKKwl1OCAqZmF0X3NlY3RvciwgKmZhdF9lbnRyeTsKKwlzdHJ1Y3Qg
ZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0cnVjdCBiZF9p
bmZvX3QgKnBfYmQgPSAmKEVYRkFUX1NCKHNiKS0+YmRfaW5mbyk7CisKKwlpZiAocF9mcy0+dm9s
X3R5cGUgPT0gRkFUMTIpIHsKKwkJc2VjID0gcF9mcy0+RkFUMV9zdGFydF9zZWN0b3IgKworCQkJ
KChsb2MgKyAobG9jID4+IDEpKSA+PiBwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzKTsKKwkJb2ZmID0g
KGxvYyArIChsb2MgPj4gMSkpICYgcF9iZC0+c2VjdG9yX3NpemVfbWFzazsKKworCQlpZiAob2Zm
ID09IChwX2JkLT5zZWN0b3Jfc2l6ZSAtIDEpKSB7CisJCQlmYXRfc2VjdG9yID0gRkFUX2dldGJs
ayhzYiwgc2VjKTsKKwkJCWlmICghZmF0X3NlY3RvcikKKwkJCQlyZXR1cm4gLTE7CisKKwkJCV9j
b250ZW50ID0gKHUzMilmYXRfc2VjdG9yW29mZl07CisKKwkJCWZhdF9zZWN0b3IgPSBGQVRfZ2V0
YmxrKHNiLCArK3NlYyk7CisJCQlpZiAoIWZhdF9zZWN0b3IpCisJCQkJcmV0dXJuIC0xOworCisJ
CQlfY29udGVudCB8PSAodTMyKWZhdF9zZWN0b3JbMF0gPDwgODsKKwkJfSBlbHNlIHsKKwkJCWZh
dF9zZWN0b3IgPSBGQVRfZ2V0YmxrKHNiLCBzZWMpOworCQkJaWYgKCFmYXRfc2VjdG9yKQorCQkJ
CXJldHVybiAtMTsKKworCQkJZmF0X2VudHJ5ID0gJmZhdF9zZWN0b3Jbb2ZmXTsKKwkJCV9jb250
ZW50ID0gR0VUMTYoZmF0X2VudHJ5KTsKKwkJfQorCisJCWlmIChsb2MgJiAxKQorCQkJX2NvbnRl
bnQgPj49IDQ7CisKKwkJX2NvbnRlbnQgJj0gMHgwMDAwMEZGRjsKKworCQlpZiAoX2NvbnRlbnQg
Pj0gQ0xVU1RFUl8xNigweDBGRjgpKSB7CisJCQkqY29udGVudCA9IENMVVNURVJfMzIofjApOwor
CQkJcmV0dXJuIDA7CisJCX0KKwkJKmNvbnRlbnQgPSBDTFVTVEVSXzMyKF9jb250ZW50KTsKKwkJ
cmV0dXJuIDA7CisJfSBlbHNlIGlmIChwX2ZzLT52b2xfdHlwZSA9PSBGQVQxNikgeworCQlzZWMg
PSBwX2ZzLT5GQVQxX3N0YXJ0X3NlY3RvciArCisJCQkobG9jID4+IChwX2JkLT5zZWN0b3Jfc2l6
ZV9iaXRzIC0gMSkpOworCQlvZmYgPSAobG9jIDw8IDEpICYgcF9iZC0+c2VjdG9yX3NpemVfbWFz
azsKKworCQlmYXRfc2VjdG9yID0gRkFUX2dldGJsayhzYiwgc2VjKTsKKwkJaWYgKCFmYXRfc2Vj
dG9yKQorCQkJcmV0dXJuIC0xOworCisJCWZhdF9lbnRyeSA9ICZmYXRfc2VjdG9yW29mZl07CisK
KwkJX2NvbnRlbnQgPSBHRVQxNl9BKGZhdF9lbnRyeSk7CisKKwkJX2NvbnRlbnQgJj0gMHgwMDAw
RkZGRjsKKworCQlpZiAoX2NvbnRlbnQgPj0gQ0xVU1RFUl8xNigweEZGRjgpKSB7CisJCQkqY29u
dGVudCA9IENMVVNURVJfMzIofjApOworCQkJcmV0dXJuIDA7CisJCX0KKwkJKmNvbnRlbnQgPSBD
TFVTVEVSXzMyKF9jb250ZW50KTsKKwkJcmV0dXJuIDA7CisJfSBlbHNlIGlmIChwX2ZzLT52b2xf
dHlwZSA9PSBGQVQzMikgeworCQlzZWMgPSBwX2ZzLT5GQVQxX3N0YXJ0X3NlY3RvciArCisJCQko
bG9jID4+IChwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzIC0gMikpOworCQlvZmYgPSAobG9jIDw8IDIp
ICYgcF9iZC0+c2VjdG9yX3NpemVfbWFzazsKKworCQlmYXRfc2VjdG9yID0gRkFUX2dldGJsayhz
Yiwgc2VjKTsKKwkJaWYgKCFmYXRfc2VjdG9yKQorCQkJcmV0dXJuIC0xOworCisJCWZhdF9lbnRy
eSA9ICZmYXRfc2VjdG9yW29mZl07CisKKwkJX2NvbnRlbnQgPSBHRVQzMl9BKGZhdF9lbnRyeSk7
CisKKwkJX2NvbnRlbnQgJj0gMHgwRkZGRkZGRjsKKworCQlpZiAoX2NvbnRlbnQgPj0gQ0xVU1RF
Ul8zMigweDBGRkZGRkY4KSkgeworCQkJKmNvbnRlbnQgPSBDTFVTVEVSXzMyKH4wKTsKKwkJCXJl
dHVybiAwOworCQl9CisJCSpjb250ZW50ID0gQ0xVU1RFUl8zMihfY29udGVudCk7CisJCXJldHVy
biAwOworCX0gZWxzZSBpZiAocF9mcy0+dm9sX3R5cGUgPT0gRVhGQVQpIHsKKwkJc2VjID0gcF9m
cy0+RkFUMV9zdGFydF9zZWN0b3IgKworCQkJKGxvYyA+PiAocF9iZC0+c2VjdG9yX3NpemVfYml0
cyAtIDIpKTsKKwkJb2ZmID0gKGxvYyA8PCAyKSAmIHBfYmQtPnNlY3Rvcl9zaXplX21hc2s7CisK
KwkJZmF0X3NlY3RvciA9IEZBVF9nZXRibGsoc2IsIHNlYyk7CisJCWlmICghZmF0X3NlY3RvcikK
KwkJCXJldHVybiAtMTsKKworCQlmYXRfZW50cnkgPSAmZmF0X3NlY3RvcltvZmZdOworCQlfY29u
dGVudCA9IEdFVDMyX0EoZmF0X2VudHJ5KTsKKworCQlpZiAoX2NvbnRlbnQgPj0gQ0xVU1RFUl8z
MigweEZGRkZGRkY4KSkgeworCQkJKmNvbnRlbnQgPSBDTFVTVEVSXzMyKH4wKTsKKwkJCXJldHVy
biAwOworCQl9CisJCSpjb250ZW50ID0gQ0xVU1RFUl8zMihfY29udGVudCk7CisJCXJldHVybiAw
OworCX0KKworCS8qIFVua25vd24gdm9sdW1lIHR5cGUsIHRocm93IGluIHRoZSB0b3dlbCBhbmQg
Z28gaG9tZSAqLworCSpjb250ZW50ID0gQ0xVU1RFUl8zMih+MCk7CisJcmV0dXJuIDA7Cit9CisK
Ky8qIGluIDogc2IsIGxvYworICogb3V0OiBjb250ZW50CisgKiByZXR1cm5zIDAgb24gc3VjY2Vz
cworICogICAgICAgICAgICAtMSBvbiBlcnJvcgorICovCitpbnQgRkFUX3JlYWQoc3RydWN0IHN1
cGVyX2Jsb2NrICpzYiwgdTMyIGxvYywgdTMyICpjb250ZW50KQoreworCXMzMiByZXQ7CisKKwlk
b3duKCZmX3NlbSk7CisJcmV0ID0gX19GQVRfcmVhZChzYiwgbG9jLCBjb250ZW50KTsKKwl1cCgm
Zl9zZW0pOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHMzMiBfX0ZBVF93cml0ZShzdHJ1
Y3Qgc3VwZXJfYmxvY2sgKnNiLCB1MzIgbG9jLCB1MzIgY29udGVudCkKK3sKKwlzMzIgb2ZmOwor
CXNlY3Rvcl90IHNlYzsKKwl1OCAqZmF0X3NlY3RvciwgKmZhdF9lbnRyeTsKKwlzdHJ1Y3QgZnNf
aW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0cnVjdCBiZF9pbmZv
X3QgKnBfYmQgPSAmKEVYRkFUX1NCKHNiKS0+YmRfaW5mbyk7CisKKwlpZiAocF9mcy0+dm9sX3R5
cGUgPT0gRkFUMTIpIHsKKwkJY29udGVudCAmPSAweDAwMDAwRkZGOworCisJCXNlYyA9IHBfZnMt
PkZBVDFfc3RhcnRfc2VjdG9yICsKKwkJCSgobG9jICsgKGxvYyA+PiAxKSkgPj4gcF9iZC0+c2Vj
dG9yX3NpemVfYml0cyk7CisJCW9mZiA9IChsb2MgKyAobG9jID4+IDEpKSAmIHBfYmQtPnNlY3Rv
cl9zaXplX21hc2s7CisKKwkJZmF0X3NlY3RvciA9IEZBVF9nZXRibGsoc2IsIHNlYyk7CisJCWlm
ICghZmF0X3NlY3RvcikKKwkJCXJldHVybiAtMTsKKworCQlpZiAobG9jICYgMSkgeyAvKiBvZGQg
Ki8KKwkJCWNvbnRlbnQgPDw9IDQ7CisKKwkJCWlmIChvZmYgPT0gKHBfYmQtPnNlY3Rvcl9zaXpl
IC0gMSkpIHsKKwkJCQlmYXRfc2VjdG9yW29mZl0gPSAodTgpKGNvbnRlbnQgfAorCQkJCQkJICAg
ICAgIChmYXRfc2VjdG9yW29mZl0gJgorCQkJCQkJCTB4MEYpKTsKKwkJCQlGQVRfbW9kaWZ5KHNi
LCBzZWMpOworCisJCQkJZmF0X3NlY3RvciA9IEZBVF9nZXRibGsoc2IsICsrc2VjKTsKKwkJCQlp
ZiAoIWZhdF9zZWN0b3IpCisJCQkJCXJldHVybiAtMTsKKworCQkJCWZhdF9zZWN0b3JbMF0gPSAo
dTgpKGNvbnRlbnQgPj4gOCk7CisJCQl9IGVsc2UgeworCQkJCWZhdF9lbnRyeSA9ICZmYXRfc2Vj
dG9yW29mZl07CisJCQkJY29udGVudCB8PSBHRVQxNihmYXRfZW50cnkpICYgMHgwMDBGOworCisJ
CQkJU0VUMTYoZmF0X2VudHJ5LCBjb250ZW50KTsKKwkJCX0KKwkJfSBlbHNlIHsgLyogZXZlbiAq
LworCQkJZmF0X3NlY3RvcltvZmZdID0gKHU4KShjb250ZW50KTsKKworCQkJaWYgKG9mZiA9PSAo
cF9iZC0+c2VjdG9yX3NpemUgLSAxKSkgeworCQkJCWZhdF9zZWN0b3Jbb2ZmXSA9ICh1OCkoY29u
dGVudCk7CisJCQkJRkFUX21vZGlmeShzYiwgc2VjKTsKKworCQkJCWZhdF9zZWN0b3IgPSBGQVRf
Z2V0YmxrKHNiLCArK3NlYyk7CisJCQkJZmF0X3NlY3RvclswXSA9ICh1OCkoKGZhdF9zZWN0b3Jb
MF0gJiAweEYwKSB8CisJCQkJCQkgICAgIChjb250ZW50ID4+IDgpKTsKKwkJCX0gZWxzZSB7CisJ
CQkJZmF0X2VudHJ5ID0gJmZhdF9zZWN0b3Jbb2ZmXTsKKwkJCQljb250ZW50IHw9IEdFVDE2KGZh
dF9lbnRyeSkgJiAweEYwMDA7CisKKwkJCQlTRVQxNihmYXRfZW50cnksIGNvbnRlbnQpOworCQkJ
fQorCQl9CisJfQorCisJZWxzZSBpZiAocF9mcy0+dm9sX3R5cGUgPT0gRkFUMTYpIHsKKwkJY29u
dGVudCAmPSAweDAwMDBGRkZGOworCisJCXNlYyA9IHBfZnMtPkZBVDFfc3RhcnRfc2VjdG9yICsg
KGxvYyA+PgorCQkJCQkJIChwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzIC0gMSkpOworCQlvZmYgPSAo
bG9jIDw8IDEpICYgcF9iZC0+c2VjdG9yX3NpemVfbWFzazsKKworCQlmYXRfc2VjdG9yID0gRkFU
X2dldGJsayhzYiwgc2VjKTsKKwkJaWYgKCFmYXRfc2VjdG9yKQorCQkJcmV0dXJuIC0xOworCisJ
CWZhdF9lbnRyeSA9ICZmYXRfc2VjdG9yW29mZl07CisKKwkJU0VUMTZfQShmYXRfZW50cnksIGNv
bnRlbnQpOworCX0gZWxzZSBpZiAocF9mcy0+dm9sX3R5cGUgPT0gRkFUMzIpIHsKKwkJY29udGVu
dCAmPSAweDBGRkZGRkZGOworCisJCXNlYyA9IHBfZnMtPkZBVDFfc3RhcnRfc2VjdG9yICsgKGxv
YyA+PgorCQkJCQkJIChwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzIC0gMikpOworCQlvZmYgPSAobG9j
IDw8IDIpICYgcF9iZC0+c2VjdG9yX3NpemVfbWFzazsKKworCQlmYXRfc2VjdG9yID0gRkFUX2dl
dGJsayhzYiwgc2VjKTsKKwkJaWYgKCFmYXRfc2VjdG9yKQorCQkJcmV0dXJuIC0xOworCisJCWZh
dF9lbnRyeSA9ICZmYXRfc2VjdG9yW29mZl07CisKKwkJY29udGVudCB8PSBHRVQzMl9BKGZhdF9l
bnRyeSkgJiAweEYwMDAwMDAwOworCisJCVNFVDMyX0EoZmF0X2VudHJ5LCBjb250ZW50KTsKKwl9
IGVsc2UgeyAvKiBwX2ZzLT52b2xfdHlwZSA9PSBFWEZBVCAqLworCQlzZWMgPSBwX2ZzLT5GQVQx
X3N0YXJ0X3NlY3RvciArIChsb2MgPj4KKwkJCQkJCSAocF9iZC0+c2VjdG9yX3NpemVfYml0cyAt
IDIpKTsKKwkJb2ZmID0gKGxvYyA8PCAyKSAmIHBfYmQtPnNlY3Rvcl9zaXplX21hc2s7CisKKwkJ
ZmF0X3NlY3RvciA9IEZBVF9nZXRibGsoc2IsIHNlYyk7CisJCWlmICghZmF0X3NlY3RvcikKKwkJ
CXJldHVybiAtMTsKKworCQlmYXRfZW50cnkgPSAmZmF0X3NlY3RvcltvZmZdOworCisJCVNFVDMy
X0EoZmF0X2VudHJ5LCBjb250ZW50KTsKKwl9CisKKwlGQVRfbW9kaWZ5KHNiLCBzZWMpOworCXJl
dHVybiAwOworfQorCitpbnQgRkFUX3dyaXRlKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHUzMiBs
b2MsIHUzMiBjb250ZW50KQoreworCXMzMiByZXQ7CisKKwlkb3duKCZmX3NlbSk7CisJcmV0ID0g
X19GQVRfd3JpdGUoc2IsIGxvYywgY29udGVudCk7CisJdXAoJmZfc2VtKTsKKworCXJldHVybiBy
ZXQ7Cit9CisKK3U4ICpGQVRfZ2V0YmxrKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHNlY3Rvcl90
IHNlYykKK3sKKwlzdHJ1Y3QgYnVmX2NhY2hlX3QgKmJwOworCXN0cnVjdCBmc19pbmZvX3QgKnBf
ZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisKKwlicCA9IEZBVF9jYWNoZV9maW5kKHNi
LCBzZWMpOworCWlmIChicCkgeworCQltb3ZlX3RvX21ydShicCwgJnBfZnMtPkZBVF9jYWNoZV9s
cnVfbGlzdCk7CisJCXJldHVybiBicC0+YnVmX2JoLT5iX2RhdGE7CisJfQorCisJYnAgPSBGQVRf
Y2FjaGVfZ2V0KHNiLCBzZWMpOworCisJRkFUX2NhY2hlX3JlbW92ZV9oYXNoKGJwKTsKKworCWJw
LT5kcnYgPSBwX2ZzLT5kcnY7CisJYnAtPnNlYyA9IHNlYzsKKwlicC0+ZmxhZyA9IDA7CisKKwlG
QVRfY2FjaGVfaW5zZXJ0X2hhc2goc2IsIGJwKTsKKworCWlmIChzZWN0b3JfcmVhZChzYiwgc2Vj
LCAmYnAtPmJ1Zl9iaCwgMSkgIT0gRkZTX1NVQ0NFU1MpIHsKKwkJRkFUX2NhY2hlX3JlbW92ZV9o
YXNoKGJwKTsKKwkJYnAtPmRydiA9IC0xOworCQlicC0+c2VjID0gfjA7CisJCWJwLT5mbGFnID0g
MDsKKwkJYnAtPmJ1Zl9iaCA9IE5VTEw7CisKKwkJbW92ZV90b19scnUoYnAsICZwX2ZzLT5GQVRf
Y2FjaGVfbHJ1X2xpc3QpOworCQlyZXR1cm4gTlVMTDsKKwl9CisKKwlyZXR1cm4gYnAtPmJ1Zl9i
aC0+Yl9kYXRhOworfQorCit2b2lkIEZBVF9tb2RpZnkoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwg
c2VjdG9yX3Qgc2VjKQoreworCXN0cnVjdCBidWZfY2FjaGVfdCAqYnA7CisKKwlicCA9IEZBVF9j
YWNoZV9maW5kKHNiLCBzZWMpOworCWlmIChicCkKKwkJc2VjdG9yX3dyaXRlKHNiLCBzZWMsIGJw
LT5idWZfYmgsIDApOworfQorCit2b2lkIEZBVF9yZWxlYXNlX2FsbChzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiKQoreworCXN0cnVjdCBidWZfY2FjaGVfdCAqYnA7CisJc3RydWN0IGZzX2luZm9fdCAq
cF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCWRvd24oJmZfc2VtKTsKKworCWJw
ID0gcF9mcy0+RkFUX2NhY2hlX2xydV9saXN0Lm5leHQ7CisJd2hpbGUgKGJwICE9ICZwX2ZzLT5G
QVRfY2FjaGVfbHJ1X2xpc3QpIHsKKwkJaWYgKGJwLT5kcnYgPT0gcF9mcy0+ZHJ2KSB7CisJCQli
cC0+ZHJ2ID0gLTE7CisJCQlicC0+c2VjID0gfjA7CisJCQlicC0+ZmxhZyA9IDA7CisKKwkJCWlm
IChicC0+YnVmX2JoKSB7CisJCQkJX19icmVsc2UoYnAtPmJ1Zl9iaCk7CisJCQkJYnAtPmJ1Zl9i
aCA9IE5VTEw7CisJCQl9CisJCX0KKwkJYnAgPSBicC0+bmV4dDsKKwl9CisKKwl1cCgmZl9zZW0p
OworfQorCit2b2lkIEZBVF9zeW5jKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCit7CisJc3RydWN0
IGJ1Zl9jYWNoZV90ICpicDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihz
YiktPmZzX2luZm8pOworCisJZG93bigmZl9zZW0pOworCisJYnAgPSBwX2ZzLT5GQVRfY2FjaGVf
bHJ1X2xpc3QubmV4dDsKKwl3aGlsZSAoYnAgIT0gJnBfZnMtPkZBVF9jYWNoZV9scnVfbGlzdCkg
eworCQlpZiAoKGJwLT5kcnYgPT0gcF9mcy0+ZHJ2KSAmJiAoYnAtPmZsYWcgJiBESVJUWUJJVCkp
IHsKKwkJCXN5bmNfZGlydHlfYnVmZmVyKGJwLT5idWZfYmgpOworCQkJYnAtPmZsYWcgJj0gfihE
SVJUWUJJVCk7CisJCX0KKwkJYnAgPSBicC0+bmV4dDsKKwl9CisKKwl1cCgmZl9zZW0pOworfQor
CitzdGF0aWMgc3RydWN0IGJ1Zl9jYWNoZV90ICpidWZfY2FjaGVfZmluZChzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKnNiLCBzZWN0b3JfdCBzZWMpCit7CisJczMyIG9mZjsKKwlzdHJ1Y3QgYnVmX2NhY2hl
X3QgKmJwLCAqaHA7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5m
c19pbmZvKTsKKworCW9mZiA9IChzZWMgKyAoc2VjID4+IHBfZnMtPnNlY3RvcnNfcGVyX2NsdV9i
aXRzKSkgJgorCQkoQlVGX0NBQ0hFX0hBU0hfU0laRSAtIDEpOworCisJaHAgPSAmcF9mcy0+YnVm
X2NhY2hlX2hhc2hfbGlzdFtvZmZdOworCWZvciAoYnAgPSBocC0+aGFzaF9uZXh0OyBicCAhPSBo
cDsgYnAgPSBicC0+aGFzaF9uZXh0KSB7CisJCWlmICgoYnAtPmRydiA9PSBwX2ZzLT5kcnYpICYm
IChicC0+c2VjID09IHNlYykpIHsKKwkJCXRvdWNoX2J1ZmZlcihicC0+YnVmX2JoKTsKKwkJCXJl
dHVybiBicDsKKwkJfQorCX0KKwlyZXR1cm4gTlVMTDsKK30KKworc3RhdGljIHN0cnVjdCBidWZf
Y2FjaGVfdCAqYnVmX2NhY2hlX2dldChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzZWN0b3JfdCBz
ZWMpCit7CisJc3RydWN0IGJ1Zl9jYWNoZV90ICpicDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2Zz
ID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJYnAgPSBwX2ZzLT5idWZfY2FjaGVfbHJ1
X2xpc3QucHJldjsKKwl3aGlsZSAoYnAtPmZsYWcgJiBMT0NLQklUKQorCQlicCA9IGJwLT5wcmV2
OworCisJbW92ZV90b19tcnUoYnAsICZwX2ZzLT5idWZfY2FjaGVfbHJ1X2xpc3QpOworCXJldHVy
biBicDsKK30KKworc3RhdGljIHU4ICpfX2J1Zl9nZXRibGsoc3RydWN0IHN1cGVyX2Jsb2NrICpz
Yiwgc2VjdG9yX3Qgc2VjKQoreworCXN0cnVjdCBidWZfY2FjaGVfdCAqYnA7CisJc3RydWN0IGZz
X2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCWJwID0gYnVmX2Nh
Y2hlX2ZpbmQoc2IsIHNlYyk7CisJaWYgKGJwKSB7CisJCW1vdmVfdG9fbXJ1KGJwLCAmcF9mcy0+
YnVmX2NhY2hlX2xydV9saXN0KTsKKwkJcmV0dXJuIGJwLT5idWZfYmgtPmJfZGF0YTsKKwl9CisK
KwlicCA9IGJ1Zl9jYWNoZV9nZXQoc2IsIHNlYyk7CisKKwlidWZfY2FjaGVfcmVtb3ZlX2hhc2go
YnApOworCisJYnAtPmRydiA9IHBfZnMtPmRydjsKKwlicC0+c2VjID0gc2VjOworCWJwLT5mbGFn
ID0gMDsKKworCWJ1Zl9jYWNoZV9pbnNlcnRfaGFzaChzYiwgYnApOworCisJaWYgKHNlY3Rvcl9y
ZWFkKHNiLCBzZWMsICZicC0+YnVmX2JoLCAxKSAhPSBGRlNfU1VDQ0VTUykgeworCQlidWZfY2Fj
aGVfcmVtb3ZlX2hhc2goYnApOworCQlicC0+ZHJ2ID0gLTE7CisJCWJwLT5zZWMgPSB+MDsKKwkJ
YnAtPmZsYWcgPSAwOworCQlicC0+YnVmX2JoID0gTlVMTDsKKworCQltb3ZlX3RvX2xydShicCwg
JnBfZnMtPmJ1Zl9jYWNoZV9scnVfbGlzdCk7CisJCXJldHVybiBOVUxMOworCX0KKworCXJldHVy
biBicC0+YnVmX2JoLT5iX2RhdGE7Cit9CisKK3U4ICpidWZfZ2V0YmxrKHN0cnVjdCBzdXBlcl9i
bG9jayAqc2IsIHNlY3Rvcl90IHNlYykKK3sKKwl1OCAqYnVmOworCisJZG93bigmYl9zZW0pOwor
CWJ1ZiA9IF9fYnVmX2dldGJsayhzYiwgc2VjKTsKKwl1cCgmYl9zZW0pOworCisJcmV0dXJuIGJ1
ZjsKK30KKwordm9pZCBidWZfbW9kaWZ5KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHNlY3Rvcl90
IHNlYykKK3sKKwlzdHJ1Y3QgYnVmX2NhY2hlX3QgKmJwOworCisJZG93bigmYl9zZW0pOworCisJ
YnAgPSBidWZfY2FjaGVfZmluZChzYiwgc2VjKTsKKwlpZiAobGlrZWx5KGJwKSkKKwkJc2VjdG9y
X3dyaXRlKHNiLCBzZWMsIGJwLT5idWZfYmgsIDApOworCisJV0FSTighYnAsICJbRVhGQVRdIGZh
aWxlZCB0byBmaW5kIGJ1ZmZlcl9jYWNoZShzZWN0b3I6JWxsdSkuXG4iLAorCSAgICAgKHVuc2ln
bmVkIGxvbmcgbG9uZylzZWMpOworCisJdXAoJmJfc2VtKTsKK30KKwordm9pZCBidWZfbG9jayhz
dHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzZWN0b3JfdCBzZWMpCit7CisJc3RydWN0IGJ1Zl9jYWNo
ZV90ICpicDsKKworCWRvd24oJmJfc2VtKTsKKworCWJwID0gYnVmX2NhY2hlX2ZpbmQoc2IsIHNl
Yyk7CisJaWYgKGxpa2VseShicCkpCisJCWJwLT5mbGFnIHw9IExPQ0tCSVQ7CisKKwlXQVJOKCFi
cCwgIltFWEZBVF0gZmFpbGVkIHRvIGZpbmQgYnVmZmVyX2NhY2hlKHNlY3RvcjolbGx1KS5cbiIs
CisJICAgICAodW5zaWduZWQgbG9uZyBsb25nKXNlYyk7CisKKwl1cCgmYl9zZW0pOworfQorCit2
b2lkIGJ1Zl91bmxvY2soc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc2VjdG9yX3Qgc2VjKQorewor
CXN0cnVjdCBidWZfY2FjaGVfdCAqYnA7CisKKwlkb3duKCZiX3NlbSk7CisKKwlicCA9IGJ1Zl9j
YWNoZV9maW5kKHNiLCBzZWMpOworCWlmIChsaWtlbHkoYnApKQorCQlicC0+ZmxhZyAmPSB+KExP
Q0tCSVQpOworCisJV0FSTighYnAsICJbRVhGQVRdIGZhaWxlZCB0byBmaW5kIGJ1ZmZlcl9jYWNo
ZShzZWN0b3I6JWxsdSkuXG4iLAorCSAgICAgKHVuc2lnbmVkIGxvbmcgbG9uZylzZWMpOworCisJ
dXAoJmJfc2VtKTsKK30KKwordm9pZCBidWZfcmVsZWFzZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
LCBzZWN0b3JfdCBzZWMpCit7CisJc3RydWN0IGJ1Zl9jYWNoZV90ICpicDsKKwlzdHJ1Y3QgZnNf
aW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJZG93bigmYl9zZW0p
OworCisJYnAgPSBidWZfY2FjaGVfZmluZChzYiwgc2VjKTsKKwlpZiAobGlrZWx5KGJwKSkgewor
CQlicC0+ZHJ2ID0gLTE7CisJCWJwLT5zZWMgPSB+MDsKKwkJYnAtPmZsYWcgPSAwOworCisJCWlm
IChicC0+YnVmX2JoKSB7CisJCQlfX2JyZWxzZShicC0+YnVmX2JoKTsKKwkJCWJwLT5idWZfYmgg
PSBOVUxMOworCQl9CisKKwkJbW92ZV90b19scnUoYnAsICZwX2ZzLT5idWZfY2FjaGVfbHJ1X2xp
c3QpOworCX0KKworCXVwKCZiX3NlbSk7Cit9CisKK3ZvaWQgYnVmX3JlbGVhc2VfYWxsKHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IpCit7CisJc3RydWN0IGJ1Zl9jYWNoZV90ICpicDsKKwlzdHJ1Y3Qg
ZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJZG93bigmYl9z
ZW0pOworCisJYnAgPSBwX2ZzLT5idWZfY2FjaGVfbHJ1X2xpc3QubmV4dDsKKwl3aGlsZSAoYnAg
IT0gJnBfZnMtPmJ1Zl9jYWNoZV9scnVfbGlzdCkgeworCQlpZiAoYnAtPmRydiA9PSBwX2ZzLT5k
cnYpIHsKKwkJCWJwLT5kcnYgPSAtMTsKKwkJCWJwLT5zZWMgPSB+MDsKKwkJCWJwLT5mbGFnID0g
MDsKKworCQkJaWYgKGJwLT5idWZfYmgpIHsKKwkJCQlfX2JyZWxzZShicC0+YnVmX2JoKTsKKwkJ
CQlicC0+YnVmX2JoID0gTlVMTDsKKwkJCX0KKwkJfQorCQlicCA9IGJwLT5uZXh0OworCX0KKwor
CXVwKCZiX3NlbSk7Cit9CisKK3ZvaWQgYnVmX3N5bmMoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikK
K3sKKwlzdHJ1Y3QgYnVmX2NhY2hlX3QgKmJwOworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAm
KEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisKKwlkb3duKCZiX3NlbSk7CisKKwlicCA9IHBfZnMt
PmJ1Zl9jYWNoZV9scnVfbGlzdC5uZXh0OworCXdoaWxlIChicCAhPSAmcF9mcy0+YnVmX2NhY2hl
X2xydV9saXN0KSB7CisJCWlmICgoYnAtPmRydiA9PSBwX2ZzLT5kcnYpICYmIChicC0+ZmxhZyAm
IERJUlRZQklUKSkgeworCQkJc3luY19kaXJ0eV9idWZmZXIoYnAtPmJ1Zl9iaCk7CisJCQlicC0+
ZmxhZyAmPSB+KERJUlRZQklUKTsKKwkJfQorCQlicCA9IGJwLT5uZXh0OworCX0KKworCXVwKCZi
X3NlbSk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhmYXRfY29yZS5j
IGIvZHJpdmVycy9zdGFnaW5nL2V4ZmF0L2V4ZmF0X2NvcmUuYwpuZXcgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAwMDAwMDAwMDAwMDAuLjlmNzZjYTE3NWM4MAotLS0gL2Rldi9udWxsCisrKyBiL2Ry
aXZlcnMvc3RhZ2luZy9leGZhdC9leGZhdF9jb3JlLmMKQEAgLTAsMCArMSwzNzA0IEBACisvLyBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAqICBDb3B5cmlnaHQgKEMpIDIw
MTItMjAxMyBTYW1zdW5nIEVsZWN0cm9uaWNzIENvLiwgTHRkLgorICovCisKKyNpbmNsdWRlIDxs
aW51eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L2J1ZmZlcl9oZWFkLmg+CisjaW5jbHVkZSA8
bGludXgvZnMuaD4KKyNpbmNsdWRlIDxsaW51eC9tdXRleC5oPgorI2luY2x1ZGUgPGxpbnV4L2Js
a2Rldi5oPgorI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KKyNpbmNsdWRlICJleGZhdC5oIgorCisK
K3N0YXRpYyB2b2lkIF9fc2V0X3NiX2RpcnR5KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCit7CisJ
c3RydWN0IGV4ZmF0X3NiX2luZm8gKnNiaSA9IEVYRkFUX1NCKHNiKTsKKworCXNiaS0+c19kaXJ0
ID0gMTsKK30KKworc3RhdGljIHU4IG5hbWVfYnVmW01BWF9QQVRIX0xFTkdUSCAqIE1BWF9DSEFS
U0VUX1NJWkVdOworCitzdGF0aWMgY2hhciAqcmVzZXJ2ZWRfbmFtZXNbXSA9IHsKKwkiQVVYICAg
ICAiLCAiQ09OICAgICAiLCAiTlVMICAgICAiLCAiUFJOICAgICAiLAorCSJDT00xICAgICIsICJD
T00yICAgICIsICJDT00zICAgICIsICJDT000ICAgICIsCisJIkNPTTUgICAgIiwgIkNPTTYgICAg
IiwgIkNPTTcgICAgIiwgIkNPTTggICAgIiwgIkNPTTkgICAgIiwKKwkiTFBUMSAgICAiLCAiTFBU
MiAgICAiLCAiTFBUMyAgICAiLCAiTFBUNCAgICAiLAorCSJMUFQ1ICAgICIsICJMUFQ2ICAgICIs
ICJMUFQ3ICAgICIsICJMUFQ4ICAgICIsICJMUFQ5ICAgICIsCisJTlVMTAorfTsKKworc3RhdGlj
IHU4IGZyZWVfYml0W10gPSB7CisJMCwgMSwgMCwgMiwgMCwgMSwgMCwgMywgMCwgMSwgMCwgMiwg
MCwgMSwgMCwgNCwgMCwgMSwgMCwgMiwgLyogICAwIH4gIDE5ICovCisJMCwgMSwgMCwgMywgMCwg
MSwgMCwgMiwgMCwgMSwgMCwgNSwgMCwgMSwgMCwgMiwgMCwgMSwgMCwgMywgLyogIDIwIH4gIDM5
ICovCisJMCwgMSwgMCwgMiwgMCwgMSwgMCwgNCwgMCwgMSwgMCwgMiwgMCwgMSwgMCwgMywgMCwg
MSwgMCwgMiwgLyogIDQwIH4gIDU5ICovCisJMCwgMSwgMCwgNiwgMCwgMSwgMCwgMiwgMCwgMSwg
MCwgMywgMCwgMSwgMCwgMiwgMCwgMSwgMCwgNCwgLyogIDYwIH4gIDc5ICovCisJMCwgMSwgMCwg
MiwgMCwgMSwgMCwgMywgMCwgMSwgMCwgMiwgMCwgMSwgMCwgNSwgMCwgMSwgMCwgMiwgLyogIDgw
IH4gIDk5ICovCisJMCwgMSwgMCwgMywgMCwgMSwgMCwgMiwgMCwgMSwgMCwgNCwgMCwgMSwgMCwg
MiwgMCwgMSwgMCwgMywgLyogMTAwIH4gMTE5ICovCisJMCwgMSwgMCwgMiwgMCwgMSwgMCwgNywg
MCwgMSwgMCwgMiwgMCwgMSwgMCwgMywgMCwgMSwgMCwgMiwgLyogMTIwIH4gMTM5ICovCisJMCwg
MSwgMCwgNCwgMCwgMSwgMCwgMiwgMCwgMSwgMCwgMywgMCwgMSwgMCwgMiwgMCwgMSwgMCwgNSwg
LyogMTQwIH4gMTU5ICovCisJMCwgMSwgMCwgMiwgMCwgMSwgMCwgMywgMCwgMSwgMCwgMiwgMCwg
MSwgMCwgNCwgMCwgMSwgMCwgMiwgLyogMTYwIH4gMTc5ICovCisJMCwgMSwgMCwgMywgMCwgMSwg
MCwgMiwgMCwgMSwgMCwgNiwgMCwgMSwgMCwgMiwgMCwgMSwgMCwgMywgLyogMTgwIH4gMTk5ICov
CisJMCwgMSwgMCwgMiwgMCwgMSwgMCwgNCwgMCwgMSwgMCwgMiwgMCwgMSwgMCwgMywgMCwgMSwg
MCwgMiwgLyogMjAwIH4gMjE5ICovCisJMCwgMSwgMCwgNSwgMCwgMSwgMCwgMiwgMCwgMSwgMCwg
MywgMCwgMSwgMCwgMiwgMCwgMSwgMCwgNCwgLyogMjIwIH4gMjM5ICovCisJMCwgMSwgMCwgMiwg
MCwgMSwgMCwgMywgMCwgMSwgMCwgMiwgMCwgMSwgMCAgICAgICAgICAgICAgICAgLyogMjQwIH4g
MjU0ICovCit9OworCitzdGF0aWMgdTggdXNlZF9iaXRbXSA9IHsKKwkwLCAxLCAxLCAyLCAxLCAy
LCAyLCAzLCAxLCAyLCAyLCAzLCAyLCAzLCAzLCA0LCAxLCAyLCAyLCAzLCAvKiAgIDAgfiAgMTkg
Ki8KKwkyLCAzLCAzLCA0LCAyLCAzLCAzLCA0LCAzLCA0LCA0LCA1LCAxLCAyLCAyLCAzLCAyLCAz
LCAzLCA0LCAvKiAgMjAgfiAgMzkgKi8KKwkyLCAzLCAzLCA0LCAzLCA0LCA0LCA1LCAyLCAzLCAz
LCA0LCAzLCA0LCA0LCA1LCAzLCA0LCA0LCA1LCAvKiAgNDAgfiAgNTkgKi8KKwk0LCA1LCA1LCA2
LCAxLCAyLCAyLCAzLCAyLCAzLCAzLCA0LCAyLCAzLCAzLCA0LCAzLCA0LCA0LCA1LCAvKiAgNjAg
fiAgNzkgKi8KKwkyLCAzLCAzLCA0LCAzLCA0LCA0LCA1LCAzLCA0LCA0LCA1LCA0LCA1LCA1LCA2
LCAyLCAzLCAzLCA0LCAvKiAgODAgfiAgOTkgKi8KKwkzLCA0LCA0LCA1LCAzLCA0LCA0LCA1LCA0
LCA1LCA1LCA2LCAzLCA0LCA0LCA1LCA0LCA1LCA1LCA2LCAvKiAxMDAgfiAxMTkgKi8KKwk0LCA1
LCA1LCA2LCA1LCA2LCA2LCA3LCAxLCAyLCAyLCAzLCAyLCAzLCAzLCA0LCAyLCAzLCAzLCA0LCAv
KiAxMjAgfiAxMzkgKi8KKwkzLCA0LCA0LCA1LCAyLCAzLCAzLCA0LCAzLCA0LCA0LCA1LCAzLCA0
LCA0LCA1LCA0LCA1LCA1LCA2LCAvKiAxNDAgfiAxNTkgKi8KKwkyLCAzLCAzLCA0LCAzLCA0LCA0
LCA1LCAzLCA0LCA0LCA1LCA0LCA1LCA1LCA2LCAzLCA0LCA0LCA1LCAvKiAxNjAgfiAxNzkgKi8K
Kwk0LCA1LCA1LCA2LCA0LCA1LCA1LCA2LCA1LCA2LCA2LCA3LCAyLCAzLCAzLCA0LCAzLCA0LCA0
LCA1LCAvKiAxODAgfiAxOTkgKi8KKwkzLCA0LCA0LCA1LCA0LCA1LCA1LCA2LCAzLCA0LCA0LCA1
LCA0LCA1LCA1LCA2LCA0LCA1LCA1LCA2LCAvKiAyMDAgfiAyMTkgKi8KKwk1LCA2LCA2LCA3LCAz
LCA0LCA0LCA1LCA0LCA1LCA1LCA2LCA0LCA1LCA1LCA2LCA1LCA2LCA2LCA3LCAvKiAyMjAgfiAy
MzkgKi8KKwk0LCA1LCA1LCA2LCA1LCA2LCA2LCA3LCA1LCA2LCA2LCA3LCA2LCA3LCA3LCA4ICAg
ICAgICAgICAgICAvKiAyNDAgfiAyNTUgKi8KK307CisKKyNkZWZpbmUgQklUTUFQX0xPQyh2KSAg
ICAgICAgICAgKCh2KSA+PiAzKQorI2RlZmluZSBCSVRNQVBfU0hJRlQodikgICAgICAgICAoKHYp
ICYgMHgwNykKKworc3RhdGljIGlubGluZSBzMzIgZXhmYXRfYml0bWFwX3Rlc3QodTggKmJpdG1h
cCwgaW50IGkpCit7CisJdTggZGF0YTsKKworCWRhdGEgPSBiaXRtYXBbQklUTUFQX0xPQyhpKV07
CisJaWYgKChkYXRhID4+IEJJVE1BUF9TSElGVChpKSkgJiAweDAxKQorCQlyZXR1cm4gMTsKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGV4ZmF0X2JpdG1hcF9zZXQodTggKmJp
dG1hcCwgaW50IGkpCit7CisJYml0bWFwW0JJVE1BUF9MT0MoaSldIHw9ICgweDAxIDw8IEJJVE1B
UF9TSElGVChpKSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBleGZhdF9iaXRtYXBfY2xlYXIo
dTggKmJpdG1hcCwgaW50IGkpCit7CisJYml0bWFwW0JJVE1BUF9MT0MoaSldICY9IH4oMHgwMSA8
PCBCSVRNQVBfU0hJRlQoaSkpOworfQorCisvKgorICogIEZpbGUgU3lzdGVtIE1hbmFnZW1lbnQg
RnVuY3Rpb25zCisgKi8KKwordm9pZCBmc19zZXRfdm9sX2ZsYWdzKHN0cnVjdCBzdXBlcl9ibG9j
ayAqc2IsIHUzMiBuZXdfZmxhZykKK3sKKwlzdHJ1Y3QgcGJyX3NlY3Rvcl90ICpwX3BicjsKKwlz
dHJ1Y3QgYnBiZXhfdCAqcF9icGI7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRf
U0Ioc2IpLT5mc19pbmZvKTsKKworCWlmIChwX2ZzLT52b2xfZmxhZyA9PSBuZXdfZmxhZykKKwkJ
cmV0dXJuOworCisJcF9mcy0+dm9sX2ZsYWcgPSBuZXdfZmxhZzsKKworCWlmIChwX2ZzLT52b2xf
dHlwZSA9PSBFWEZBVCkgeworCQlpZiAocF9mcy0+cGJyX2JoID09IE5VTEwpIHsKKwkJCWlmIChz
ZWN0b3JfcmVhZChzYiwgcF9mcy0+UEJSX3NlY3RvciwKKwkJCQkJJnBfZnMtPnBicl9iaCwgMSkg
IT0gRkZTX1NVQ0NFU1MpCisJCQkJcmV0dXJuOworCQl9CisKKwkJcF9wYnIgPSAoc3RydWN0IHBi
cl9zZWN0b3JfdCAqKXBfZnMtPnBicl9iaC0+Yl9kYXRhOworCQlwX2JwYiA9IChzdHJ1Y3QgYnBi
ZXhfdCAqKXBfcGJyLT5icGI7CisJCVNFVDE2KHBfYnBiLT52b2xfZmxhZ3MsICh1MTYpbmV3X2Zs
YWcpOworCisJCS8qIFhYWCBkdXlvdW5nCisJCSAqIHdoYXQgY2FuIHdlIGRvIGhlcmU/IChjdXog
ZnNfc2V0X3ZvbF9mbGFncygpIGlzIHZvaWQpCisJCSAqLworCQlpZiAoKG5ld19mbGFnID09IFZP
TF9ESVJUWSkgJiYgKCFidWZmZXJfZGlydHkocF9mcy0+cGJyX2JoKSkpCisJCQlzZWN0b3Jfd3Jp
dGUoc2IsIHBfZnMtPlBCUl9zZWN0b3IsIHBfZnMtPnBicl9iaCwgMSk7CisJCWVsc2UKKwkJCXNl
Y3Rvcl93cml0ZShzYiwgcF9mcy0+UEJSX3NlY3RvciwgcF9mcy0+cGJyX2JoLCAwKTsKKwl9Cit9
CisKK3ZvaWQgZnNfZXJyb3Ioc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sKKwlzdHJ1Y3QgZXhm
YXRfbW91bnRfb3B0aW9ucyAqb3B0cyA9ICZFWEZBVF9TQihzYiktPm9wdGlvbnM7CisKKwlpZiAo
b3B0cy0+ZXJyb3JzID09IEVYRkFUX0VSUk9SU19QQU5JQykgeworCQlwYW5pYygiW0VYRkFUXSBG
aWxlc3lzdGVtIHBhbmljIGZyb20gcHJldmlvdXMgZXJyb3JcbiIpOworCX0gZWxzZSBpZiAoKG9w
dHMtPmVycm9ycyA9PSBFWEZBVF9FUlJPUlNfUk8pICYmICFzYl9yZG9ubHkoc2IpKSB7CisJCXNi
LT5zX2ZsYWdzIHw9IFNCX1JET05MWTsKKwkJcHJfZXJyKCJbRVhGQVRdIEZpbGVzeXN0ZW0gaGFz
IGJlZW4gc2V0IHJlYWQtb25seVxuIik7CisJfQorfQorCisvKgorICogIENsdXN0ZXIgTWFuYWdl
bWVudCBGdW5jdGlvbnMKKyAqLworCitzMzIgY2xlYXJfY2x1c3RlcihzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiLCB1MzIgY2x1KQoreworCXNlY3Rvcl90IHMsIG47CisJczMyIHJldCA9IEZGU19TVUND
RVNTOworCXN0cnVjdCBidWZmZXJfaGVhZCAqdG1wX2JoID0gTlVMTDsKKwlzdHJ1Y3QgZnNfaW5m
b190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0cnVjdCBiZF9pbmZvX3Qg
KnBfYmQgPSAmKEVYRkFUX1NCKHNiKS0+YmRfaW5mbyk7CisKKwlpZiAoY2x1ID09IENMVVNURVJf
MzIoMCkpIHsgLyogRkFUMTYgcm9vdF9kaXIgKi8KKwkJcyA9IHBfZnMtPnJvb3Rfc3RhcnRfc2Vj
dG9yOworCQluID0gcF9mcy0+ZGF0YV9zdGFydF9zZWN0b3I7CisJfSBlbHNlIHsKKwkJcyA9IFNU
QVJUX1NFQ1RPUihjbHUpOworCQluID0gcyArIHBfZnMtPnNlY3RvcnNfcGVyX2NsdTsKKwl9CisK
Kwlmb3IgKDsgcyA8IG47IHMrKykgeworCQlyZXQgPSBzZWN0b3JfcmVhZChzYiwgcywgJnRtcF9i
aCwgMCk7CisJCWlmIChyZXQgIT0gRkZTX1NVQ0NFU1MpCisJCQlyZXR1cm4gcmV0OworCisJCW1l
bXNldCgoY2hhciAqKXRtcF9iaC0+Yl9kYXRhLCAweDAsIHBfYmQtPnNlY3Rvcl9zaXplKTsKKwkJ
cmV0ID0gc2VjdG9yX3dyaXRlKHNiLCBzLCB0bXBfYmgsIDApOworCQlpZiAocmV0ICE9IEZGU19T
VUNDRVNTKQorCQkJYnJlYWs7CisJfQorCisJYnJlbHNlKHRtcF9iaCk7CisJcmV0dXJuIHJldDsK
K30KKworczMyIGZhdF9hbGxvY19jbHVzdGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHMzMiBu
dW1fYWxsb2MsCisJCSAgICAgIHN0cnVjdCBjaGFpbl90ICpwX2NoYWluKQoreworCWludCBpLCBu
dW1fY2x1c3RlcnMgPSAwOworCXUzMiBuZXdfY2x1LCBsYXN0X2NsdSA9IENMVVNURVJfMzIofjAp
LCByZWFkX2NsdTsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZz
X2luZm8pOworCisJbmV3X2NsdSA9IHBfY2hhaW4tPmRpcjsKKwlpZiAobmV3X2NsdSA9PSBDTFVT
VEVSXzMyKH4wKSkKKwkJbmV3X2NsdSA9IHBfZnMtPmNsdV9zcmNoX3B0cjsKKwllbHNlIGlmIChu
ZXdfY2x1ID49IHBfZnMtPm51bV9jbHVzdGVycykKKwkJbmV3X2NsdSA9IDI7CisKKwlfX3NldF9z
Yl9kaXJ0eShzYik7CisKKwlwX2NoYWluLT5kaXIgPSBDTFVTVEVSXzMyKH4wKTsKKworCWZvciAo
aSA9IDI7IGkgPCBwX2ZzLT5udW1fY2x1c3RlcnM7IGkrKykgeworCQlpZiAoRkFUX3JlYWQoc2Is
IG5ld19jbHUsICZyZWFkX2NsdSkgIT0gMCkKKwkJCXJldHVybiAtMTsKKworCQlpZiAocmVhZF9j
bHUgPT0gQ0xVU1RFUl8zMigwKSkgeworCQkJaWYgKEZBVF93cml0ZShzYiwgbmV3X2NsdSwgQ0xV
U1RFUl8zMih+MCkpIDwgMCkKKwkJCQlyZXR1cm4gLTE7CisJCQludW1fY2x1c3RlcnMrKzsKKwor
CQkJaWYgKHBfY2hhaW4tPmRpciA9PSBDTFVTVEVSXzMyKH4wKSkgeworCQkJCXBfY2hhaW4tPmRp
ciA9IG5ld19jbHU7CisJCQl9IGVsc2UgeworCQkJCWlmIChGQVRfd3JpdGUoc2IsIGxhc3RfY2x1
LCBuZXdfY2x1KSA8IDApCisJCQkJCXJldHVybiAtMTsKKwkJCX0KKworCQkJbGFzdF9jbHUgPSBu
ZXdfY2x1OworCisJCQlpZiAoKC0tbnVtX2FsbG9jKSA9PSAwKSB7CisJCQkJcF9mcy0+Y2x1X3Ny
Y2hfcHRyID0gbmV3X2NsdTsKKwkJCQlpZiAocF9mcy0+dXNlZF9jbHVzdGVycyAhPSAodTMyKSB+
MCkKKwkJCQkJcF9mcy0+dXNlZF9jbHVzdGVycyArPSBudW1fY2x1c3RlcnM7CisKKwkJCQlyZXR1
cm4gbnVtX2NsdXN0ZXJzOworCQkJfQorCQl9CisJCWlmICgoKytuZXdfY2x1KSA+PSBwX2ZzLT5u
dW1fY2x1c3RlcnMpCisJCQluZXdfY2x1ID0gMjsKKwl9CisKKwlwX2ZzLT5jbHVfc3JjaF9wdHIg
PSBuZXdfY2x1OworCWlmIChwX2ZzLT51c2VkX2NsdXN0ZXJzICE9ICh1MzIpIH4wKQorCQlwX2Zz
LT51c2VkX2NsdXN0ZXJzICs9IG51bV9jbHVzdGVyczsKKworCXJldHVybiBudW1fY2x1c3RlcnM7
Cit9CisKK3MzMiBleGZhdF9hbGxvY19jbHVzdGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHMz
MiBudW1fYWxsb2MsCisJCQlzdHJ1Y3QgY2hhaW5fdCAqcF9jaGFpbikKK3sKKwlzMzIgbnVtX2Ns
dXN0ZXJzID0gMDsKKwl1MzIgaGludF9jbHUsIG5ld19jbHUsIGxhc3RfY2x1ID0gQ0xVU1RFUl8z
Mih+MCk7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZv
KTsKKworCWhpbnRfY2x1ID0gcF9jaGFpbi0+ZGlyOworCWlmIChoaW50X2NsdSA9PSBDTFVTVEVS
XzMyKH4wKSkgeworCQloaW50X2NsdSA9IHRlc3RfYWxsb2NfYml0bWFwKHNiLCBwX2ZzLT5jbHVf
c3JjaF9wdHItMik7CisJCWlmIChoaW50X2NsdSA9PSBDTFVTVEVSXzMyKH4wKSkKKwkJCXJldHVy
biAwOworCX0gZWxzZSBpZiAoaGludF9jbHUgPj0gcF9mcy0+bnVtX2NsdXN0ZXJzKSB7CisJCWhp
bnRfY2x1ID0gMjsKKwkJcF9jaGFpbi0+ZmxhZ3MgPSAweDAxOworCX0KKworCV9fc2V0X3NiX2Rp
cnR5KHNiKTsKKworCXBfY2hhaW4tPmRpciA9IENMVVNURVJfMzIofjApOworCisJd2hpbGUgKChu
ZXdfY2x1ID0gdGVzdF9hbGxvY19iaXRtYXAoc2IsIGhpbnRfY2x1LTIpKSAhPSBDTFVTVEVSXzMy
KH4wKSkgeworCQlpZiAobmV3X2NsdSAhPSBoaW50X2NsdSkgeworCQkJaWYgKHBfY2hhaW4tPmZs
YWdzID09IDB4MDMpIHsKKwkJCQlleGZhdF9jaGFpbl9jb250X2NsdXN0ZXIoc2IsIHBfY2hhaW4t
PmRpciwKKwkJCQkJCQkgbnVtX2NsdXN0ZXJzKTsKKwkJCQlwX2NoYWluLT5mbGFncyA9IDB4MDE7
CisJCQl9CisJCX0KKworCQlpZiAoc2V0X2FsbG9jX2JpdG1hcChzYiwgbmV3X2NsdS0yKSAhPSBG
RlNfU1VDQ0VTUykKKwkJCXJldHVybiAtMTsKKworCQludW1fY2x1c3RlcnMrKzsKKworCQlpZiAo
cF9jaGFpbi0+ZmxhZ3MgPT0gMHgwMSkgeworCQkJaWYgKEZBVF93cml0ZShzYiwgbmV3X2NsdSwg
Q0xVU1RFUl8zMih+MCkpIDwgMCkKKwkJCQlyZXR1cm4gLTE7CisJCX0KKworCQlpZiAocF9jaGFp
bi0+ZGlyID09IENMVVNURVJfMzIofjApKSB7CisJCQlwX2NoYWluLT5kaXIgPSBuZXdfY2x1Owor
CQl9IGVsc2UgeworCQkJaWYgKHBfY2hhaW4tPmZsYWdzID09IDB4MDEpIHsKKwkJCQlpZiAoRkFU
X3dyaXRlKHNiLCBsYXN0X2NsdSwgbmV3X2NsdSkgPCAwKQorCQkJCQlyZXR1cm4gLTE7CisJCQl9
CisJCX0KKwkJbGFzdF9jbHUgPSBuZXdfY2x1OworCisJCWlmICgoLS1udW1fYWxsb2MpID09IDAp
IHsKKwkJCXBfZnMtPmNsdV9zcmNoX3B0ciA9IGhpbnRfY2x1OworCQkJaWYgKHBfZnMtPnVzZWRf
Y2x1c3RlcnMgIT0gKHUzMikgfjApCisJCQkJcF9mcy0+dXNlZF9jbHVzdGVycyArPSBudW1fY2x1
c3RlcnM7CisKKwkJCXBfY2hhaW4tPnNpemUgKz0gbnVtX2NsdXN0ZXJzOworCQkJcmV0dXJuIG51
bV9jbHVzdGVyczsKKwkJfQorCisJCWhpbnRfY2x1ID0gbmV3X2NsdSArIDE7CisJCWlmIChoaW50
X2NsdSA+PSBwX2ZzLT5udW1fY2x1c3RlcnMpIHsKKwkJCWhpbnRfY2x1ID0gMjsKKworCQkJaWYg
KHBfY2hhaW4tPmZsYWdzID09IDB4MDMpIHsKKwkJCQlleGZhdF9jaGFpbl9jb250X2NsdXN0ZXIo
c2IsIHBfY2hhaW4tPmRpciwKKwkJCQkJCQkgbnVtX2NsdXN0ZXJzKTsKKwkJCQlwX2NoYWluLT5m
bGFncyA9IDB4MDE7CisJCQl9CisJCX0KKwl9CisKKwlwX2ZzLT5jbHVfc3JjaF9wdHIgPSBoaW50
X2NsdTsKKwlpZiAocF9mcy0+dXNlZF9jbHVzdGVycyAhPSAodTMyKSB+MCkKKwkJcF9mcy0+dXNl
ZF9jbHVzdGVycyArPSBudW1fY2x1c3RlcnM7CisKKwlwX2NoYWluLT5zaXplICs9IG51bV9jbHVz
dGVyczsKKwlyZXR1cm4gbnVtX2NsdXN0ZXJzOworfQorCit2b2lkIGZhdF9mcmVlX2NsdXN0ZXIo
c3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfY2hhaW4sCisJCSAgICAg
IHMzMiBkb19yZWxzZSkKK3sKKwlzMzIgbnVtX2NsdXN0ZXJzID0gMDsKKwl1MzIgY2x1LCBwcmV2
OworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisJ
aW50IGk7CisJc2VjdG9yX3Qgc2VjdG9yOworCisJaWYgKChwX2NoYWluLT5kaXIgPT0gQ0xVU1RF
Ul8zMigwKSkgfHwgKHBfY2hhaW4tPmRpciA9PSBDTFVTVEVSXzMyKH4wKSkpCisJCXJldHVybjsK
KwlfX3NldF9zYl9kaXJ0eShzYik7CisJY2x1ID0gcF9jaGFpbi0+ZGlyOworCisJaWYgKHBfY2hh
aW4tPnNpemUgPD0gMCkKKwkJcmV0dXJuOworCisJZG8geworCQlpZiAocF9mcy0+ZGV2X2VqZWN0
ZWQpCisJCQlicmVhazsKKworCQlpZiAoZG9fcmVsc2UpIHsKKwkJCXNlY3RvciA9IFNUQVJUX1NF
Q1RPUihjbHUpOworCQkJZm9yIChpID0gMDsgaSA8IHBfZnMtPnNlY3RvcnNfcGVyX2NsdTsgaSsr
KQorCQkJCWJ1Zl9yZWxlYXNlKHNiLCBzZWN0b3IraSk7CisJCX0KKworCQlwcmV2ID0gY2x1Owor
CQlpZiAoRkFUX3JlYWQoc2IsIGNsdSwgJmNsdSkgPT0gLTEpCisJCQlicmVhazsKKworCQlpZiAo
RkFUX3dyaXRlKHNiLCBwcmV2LCBDTFVTVEVSXzMyKDApKSA8IDApCisJCQlicmVhazsKKwkJbnVt
X2NsdXN0ZXJzKys7CisKKwl9IHdoaWxlIChjbHUgIT0gQ0xVU1RFUl8zMih+MCkpOworCisJaWYg
KHBfZnMtPnVzZWRfY2x1c3RlcnMgIT0gKHUzMikgfjApCisJCXBfZnMtPnVzZWRfY2x1c3RlcnMg
LT0gbnVtX2NsdXN0ZXJzOworfQorCit2b2lkIGV4ZmF0X2ZyZWVfY2x1c3RlcihzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9jaGFpbiwKKwkJCXMzMiBkb19yZWxzZSkK
K3sKKwlzMzIgbnVtX2NsdXN0ZXJzID0gMDsKKwl1MzIgY2x1OworCXN0cnVjdCBmc19pbmZvX3Qg
KnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisJaW50IGk7CisJc2VjdG9yX3Qgc2Vj
dG9yOworCisJaWYgKChwX2NoYWluLT5kaXIgPT0gQ0xVU1RFUl8zMigwKSkgfHwgKHBfY2hhaW4t
PmRpciA9PSBDTFVTVEVSXzMyKH4wKSkpCisJCXJldHVybjsKKworCWlmIChwX2NoYWluLT5zaXpl
IDw9IDApIHsKKwkJcHJfZXJyKCJbRVhGQVRdIGZyZWVfY2x1c3RlciA6IHNraXAgZnJlZS1yZXEg
Y2x1OiV1LCBiZWNhdXNlIG9mIHplcm8tc2l6ZSB0cnVuY2F0aW9uXG4iLAorCQkgICAgICAgcF9j
aGFpbi0+ZGlyKTsKKwkJcmV0dXJuOworCX0KKworCV9fc2V0X3NiX2RpcnR5KHNiKTsKKwljbHUg
PSBwX2NoYWluLT5kaXI7CisKKwlpZiAocF9jaGFpbi0+ZmxhZ3MgPT0gMHgwMykgeworCQlkbyB7
CisJCQlpZiAoZG9fcmVsc2UpIHsKKwkJCQlzZWN0b3IgPSBTVEFSVF9TRUNUT1IoY2x1KTsKKwkJ
CQlmb3IgKGkgPSAwOyBpIDwgcF9mcy0+c2VjdG9yc19wZXJfY2x1OyBpKyspCisJCQkJCWJ1Zl9y
ZWxlYXNlKHNiLCBzZWN0b3IraSk7CisJCQl9CisKKwkJCWlmIChjbHJfYWxsb2NfYml0bWFwKHNi
LCBjbHUtMikgIT0gRkZTX1NVQ0NFU1MpCisJCQkJYnJlYWs7CisJCQljbHUrKzsKKworCQkJbnVt
X2NsdXN0ZXJzKys7CisJCX0gd2hpbGUgKG51bV9jbHVzdGVycyA8IHBfY2hhaW4tPnNpemUpOwor
CX0gZWxzZSB7CisJCWRvIHsKKwkJCWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJCQlicmVhazsK
KworCQkJaWYgKGRvX3JlbHNlKSB7CisJCQkJc2VjdG9yID0gU1RBUlRfU0VDVE9SKGNsdSk7CisJ
CQkJZm9yIChpID0gMDsgaSA8IHBfZnMtPnNlY3RvcnNfcGVyX2NsdTsgaSsrKQorCQkJCQlidWZf
cmVsZWFzZShzYiwgc2VjdG9yK2kpOworCQkJfQorCisJCQlpZiAoY2xyX2FsbG9jX2JpdG1hcChz
YiwgY2x1LTIpICE9IEZGU19TVUNDRVNTKQorCQkJCWJyZWFrOworCisJCQlpZiAoRkFUX3JlYWQo
c2IsIGNsdSwgJmNsdSkgPT0gLTEpCisJCQkJYnJlYWs7CisJCQludW1fY2x1c3RlcnMrKzsKKwkJ
fSB3aGlsZSAoKGNsdSAhPSBDTFVTVEVSXzMyKDApKSAmJiAoY2x1ICE9IENMVVNURVJfMzIofjAp
KSk7CisJfQorCisJaWYgKHBfZnMtPnVzZWRfY2x1c3RlcnMgIT0gKHUzMikgfjApCisJCXBfZnMt
PnVzZWRfY2x1c3RlcnMgLT0gbnVtX2NsdXN0ZXJzOworfQorCit1MzIgZmluZF9sYXN0X2NsdXN0
ZXIoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfY2hhaW4pCit7CisJ
dTMyIGNsdSwgbmV4dDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYikt
PmZzX2luZm8pOworCisJY2x1ID0gcF9jaGFpbi0+ZGlyOworCisJaWYgKHBfY2hhaW4tPmZsYWdz
ID09IDB4MDMpIHsKKwkJY2x1ICs9IHBfY2hhaW4tPnNpemUgLSAxOworCX0gZWxzZSB7CisJCXdo
aWxlICgoRkFUX3JlYWQoc2IsIGNsdSwgJm5leHQpID09IDApICYmCisJCSAgICAgICAobmV4dCAh
PSBDTFVTVEVSXzMyKH4wKSkpIHsKKwkJCWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJCQlicmVh
azsKKwkJCWNsdSA9IG5leHQ7CisJCX0KKwl9CisKKwlyZXR1cm4gY2x1OworfQorCitzMzIgY291
bnRfbnVtX2NsdXN0ZXJzKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpw
X2NoYWluKQoreworCWludCBpLCBjb3VudCA9IDA7CisJdTMyIGNsdTsKKwlzdHJ1Y3QgZnNfaW5m
b190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJaWYgKChwX2NoYWluLT5k
aXIgPT0gQ0xVU1RFUl8zMigwKSkgfHwgKHBfY2hhaW4tPmRpciA9PSBDTFVTVEVSXzMyKH4wKSkp
CisJCXJldHVybiAwOworCisJY2x1ID0gcF9jaGFpbi0+ZGlyOworCisJaWYgKHBfY2hhaW4tPmZs
YWdzID09IDB4MDMpIHsKKwkJY291bnQgPSBwX2NoYWluLT5zaXplOworCX0gZWxzZSB7CisJCWZv
ciAoaSA9IDI7IGkgPCBwX2ZzLT5udW1fY2x1c3RlcnM7IGkrKykgeworCQkJY291bnQrKzsKKwkJ
CWlmIChGQVRfcmVhZChzYiwgY2x1LCAmY2x1KSAhPSAwKQorCQkJCXJldHVybiAwOworCQkJaWYg
KGNsdSA9PSBDTFVTVEVSXzMyKH4wKSkKKwkJCQlicmVhazsKKwkJfQorCX0KKworCXJldHVybiBj
b3VudDsKK30KKworczMyIGZhdF9jb3VudF91c2VkX2NsdXN0ZXJzKHN0cnVjdCBzdXBlcl9ibG9j
ayAqc2IpCit7CisJaW50IGksIGNvdW50ID0gMDsKKwl1MzIgY2x1OworCXN0cnVjdCBmc19pbmZv
X3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisKKwlmb3IgKGkgPSAyOyBpIDwg
cF9mcy0+bnVtX2NsdXN0ZXJzOyBpKyspIHsKKwkJaWYgKEZBVF9yZWFkKHNiLCBpLCAmY2x1KSAh
PSAwKQorCQkJYnJlYWs7CisJCWlmIChjbHUgIT0gQ0xVU1RFUl8zMigwKSkKKwkJCWNvdW50Kys7
CisJfQorCisJcmV0dXJuIGNvdW50OworfQorCitzMzIgZXhmYXRfY291bnRfdXNlZF9jbHVzdGVy
cyhzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQoreworCWludCBpLCBtYXBfaSwgbWFwX2IsIGNvdW50
ID0gMDsKKwl1OCBrOworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+
ZnNfaW5mbyk7CisJc3RydWN0IGJkX2luZm9fdCAqcF9iZCA9ICYoRVhGQVRfU0Ioc2IpLT5iZF9p
bmZvKTsKKworCW1hcF9pID0gbWFwX2IgPSAwOworCisJZm9yIChpID0gMjsgaSA8IHBfZnMtPm51
bV9jbHVzdGVyczsgaSArPSA4KSB7CisJCWsgPSAqKCgodTggKikgcF9mcy0+dm9sX2FtYXBbbWFw
X2ldLT5iX2RhdGEpICsgbWFwX2IpOworCQljb3VudCArPSB1c2VkX2JpdFtrXTsKKworCQlpZiAo
KCsrbWFwX2IpID49IHBfYmQtPnNlY3Rvcl9zaXplKSB7CisJCQltYXBfaSsrOworCQkJbWFwX2Ig
PSAwOworCQl9CisJfQorCisJcmV0dXJuIGNvdW50OworfQorCit2b2lkIGV4ZmF0X2NoYWluX2Nv
bnRfY2x1c3RlcihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCB1MzIgY2hhaW4sIHMzMiBsZW4pCit7
CisJaWYgKGxlbiA9PSAwKQorCQlyZXR1cm47CisKKwl3aGlsZSAobGVuID4gMSkgeworCQlpZiAo
RkFUX3dyaXRlKHNiLCBjaGFpbiwgY2hhaW4rMSkgPCAwKQorCQkJYnJlYWs7CisJCWNoYWluKys7
CisJCWxlbi0tOworCX0KKwlGQVRfd3JpdGUoc2IsIGNoYWluLCBDTFVTVEVSXzMyKH4wKSk7Cit9
CisKKy8qCisgKiAgQWxsb2NhdGlvbiBCaXRtYXAgTWFuYWdlbWVudCBGdW5jdGlvbnMKKyAqLwor
CitzMzIgbG9hZF9hbGxvY19iaXRtYXAoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sKKwlpbnQg
aSwgaiwgcmV0OworCXUzMiBtYXBfc2l6ZTsKKwl1MzIgdHlwZTsKKwlzZWN0b3JfdCBzZWN0b3I7
CisJc3RydWN0IGNoYWluX3QgY2x1OworCXN0cnVjdCBibWFwX2RlbnRyeV90ICplcDsKKwlzdHJ1
Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0cnVjdCBi
ZF9pbmZvX3QgKnBfYmQgPSAmKEVYRkFUX1NCKHNiKS0+YmRfaW5mbyk7CisKKwljbHUuZGlyID0g
cF9mcy0+cm9vdF9kaXI7CisJY2x1LmZsYWdzID0gMHgwMTsKKworCXdoaWxlIChjbHUuZGlyICE9
IENMVVNURVJfMzIofjApKSB7CisJCWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJCWJyZWFrOwor
CisJCWZvciAoaSA9IDA7IGkgPCBwX2ZzLT5kZW50cmllc19wZXJfY2x1OyBpKyspIHsKKwkJCWVw
ID0gKHN0cnVjdCBibWFwX2RlbnRyeV90ICopZ2V0X2VudHJ5X2luX2RpcihzYiwgJmNsdSwKKwkJ
CQkJCQkJICAgICAgaSwgTlVMTCk7CisJCQlpZiAoIWVwKQorCQkJCXJldHVybiBGRlNfTUVESUFF
UlI7CisKKwkJCXR5cGUgPSBwX2ZzLT5mc19mdW5jLT5nZXRfZW50cnlfdHlwZSgoc3RydWN0IGRl
bnRyeV90ICopZXApOworCisJCQlpZiAodHlwZSA9PSBUWVBFX1VOVVNFRCkKKwkJCQlicmVhazsK
KwkJCWlmICh0eXBlICE9IFRZUEVfQklUTUFQKQorCQkJCWNvbnRpbnVlOworCisJCQlpZiAoZXAt
PmZsYWdzID09IDB4MCkgeworCQkJCXBfZnMtPm1hcF9jbHUgID0gR0VUMzJfQShlcC0+c3RhcnRf
Y2x1KTsKKwkJCQltYXBfc2l6ZSA9ICh1MzIpIEdFVDY0X0EoZXAtPnNpemUpOworCisJCQkJcF9m
cy0+bWFwX3NlY3RvcnMgPSAoKG1hcF9zaXplLTEpID4+IHBfYmQtPnNlY3Rvcl9zaXplX2JpdHMp
ICsgMTsKKworCQkJCXBfZnMtPnZvbF9hbWFwID0ga21hbGxvY19hcnJheShwX2ZzLT5tYXBfc2Vj
dG9ycywKKwkJCQkJCQkgICAgICAgc2l6ZW9mKHN0cnVjdCBidWZmZXJfaGVhZCAqKSwKKwkJCQkJ
CQkgICAgICAgR0ZQX0tFUk5FTCk7CisJCQkJaWYgKHBfZnMtPnZvbF9hbWFwID09IE5VTEwpCisJ
CQkJCXJldHVybiBGRlNfTUVNT1JZRVJSOworCisJCQkJc2VjdG9yID0gU1RBUlRfU0VDVE9SKHBf
ZnMtPm1hcF9jbHUpOworCisJCQkJZm9yIChqID0gMDsgaiA8IHBfZnMtPm1hcF9zZWN0b3JzOyBq
KyspIHsKKwkJCQkJcF9mcy0+dm9sX2FtYXBbal0gPSBOVUxMOworCQkJCQlyZXQgPSBzZWN0b3Jf
cmVhZChzYiwgc2VjdG9yK2osICYocF9mcy0+dm9sX2FtYXBbal0pLCAxKTsKKwkJCQkJaWYgKHJl
dCAhPSBGRlNfU1VDQ0VTUykgeworCQkJCQkJLyogIHJlbGVhc2UgYWxsIGJ1ZmZlcnMgYW5kIGZy
ZWUgdm9sX2FtYXAgKi8KKwkJCQkJCWkgPSAwOworCQkJCQkJd2hpbGUgKGkgPCBqKQorCQkJCQkJ
CWJyZWxzZShwX2ZzLT52b2xfYW1hcFtpKytdKTsKKworCQkJCQkJa2ZyZWUocF9mcy0+dm9sX2Ft
YXApOworCQkJCQkJcF9mcy0+dm9sX2FtYXAgPSBOVUxMOworCQkJCQkJcmV0dXJuIHJldDsKKwkJ
CQkJfQorCQkJCX0KKworCQkJCXBfZnMtPnBicl9iaCA9IE5VTEw7CisJCQkJcmV0dXJuIEZGU19T
VUNDRVNTOworCQkJfQorCQl9CisKKwkJaWYgKEZBVF9yZWFkKHNiLCBjbHUuZGlyLCAmY2x1LmRp
cikgIT0gMCkKKwkJCXJldHVybiBGRlNfTUVESUFFUlI7CisJfQorCisJcmV0dXJuIEZGU19GT1JN
QVRFUlI7Cit9CisKK3ZvaWQgZnJlZV9hbGxvY19iaXRtYXAoc3RydWN0IHN1cGVyX2Jsb2NrICpz
YikKK3sKKwlpbnQgaTsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYikt
PmZzX2luZm8pOworCisJYnJlbHNlKHBfZnMtPnBicl9iaCk7CisKKwlmb3IgKGkgPSAwOyBpIDwg
cF9mcy0+bWFwX3NlY3RvcnM7IGkrKykKKwkJX19icmVsc2UocF9mcy0+dm9sX2FtYXBbaV0pOwor
CisJa2ZyZWUocF9mcy0+dm9sX2FtYXApOworCXBfZnMtPnZvbF9hbWFwID0gTlVMTDsKK30KKwor
czMyIHNldF9hbGxvY19iaXRtYXAoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTMyIGNsdSkKK3sK
KwlpbnQgaSwgYjsKKwlzZWN0b3JfdCBzZWN0b3I7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9
ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihF
WEZBVF9TQihzYiktPmJkX2luZm8pOworCisJaSA9IGNsdSA+PiAocF9iZC0+c2VjdG9yX3NpemVf
Yml0cyArIDMpOworCWIgPSBjbHUgJiAoKHBfYmQtPnNlY3Rvcl9zaXplIDw8IDMpIC0gMSk7CisK
KwlzZWN0b3IgPSBTVEFSVF9TRUNUT1IocF9mcy0+bWFwX2NsdSkgKyBpOworCisJZXhmYXRfYml0
bWFwX3NldCgodTggKikgcF9mcy0+dm9sX2FtYXBbaV0tPmJfZGF0YSwgYik7CisKKwlyZXR1cm4g
c2VjdG9yX3dyaXRlKHNiLCBzZWN0b3IsIHBfZnMtPnZvbF9hbWFwW2ldLCAwKTsKK30KKworczMy
IGNscl9hbGxvY19iaXRtYXAoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTMyIGNsdSkKK3sKKwlp
bnQgaSwgYjsKKwlzZWN0b3JfdCBzZWN0b3I7CisjaWZkZWYgQ09ORklHX0VYRkFUX0RJU0NBUkQK
KwlzdHJ1Y3QgZXhmYXRfc2JfaW5mbyAqc2JpID0gRVhGQVRfU0Ioc2IpOworCXN0cnVjdCBleGZh
dF9tb3VudF9vcHRpb25zICpvcHRzID0gJnNiaS0+b3B0aW9uczsKKwlpbnQgcmV0OworI2VuZGlm
IC8qIENPTkZJR19FWEZBVF9ESVNDQVJEICovCisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYo
RVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihFWEZB
VF9TQihzYiktPmJkX2luZm8pOworCisJaSA9IGNsdSA+PiAocF9iZC0+c2VjdG9yX3NpemVfYml0
cyArIDMpOworCWIgPSBjbHUgJiAoKHBfYmQtPnNlY3Rvcl9zaXplIDw8IDMpIC0gMSk7CisKKwlz
ZWN0b3IgPSBTVEFSVF9TRUNUT1IocF9mcy0+bWFwX2NsdSkgKyBpOworCisJZXhmYXRfYml0bWFw
X2NsZWFyKCh1OCAqKSBwX2ZzLT52b2xfYW1hcFtpXS0+Yl9kYXRhLCBiKTsKKworCXJldHVybiBz
ZWN0b3Jfd3JpdGUoc2IsIHNlY3RvciwgcF9mcy0+dm9sX2FtYXBbaV0sIDApOworCisjaWZkZWYg
Q09ORklHX0VYRkFUX0RJU0NBUkQKKwlpZiAob3B0cy0+ZGlzY2FyZCkgeworCQlyZXQgPSBzYl9p
c3N1ZV9kaXNjYXJkKHNiLCBTVEFSVF9TRUNUT1IoY2x1KSwKKwkJCQkgICAgICAgKDEgPDwgcF9m
cy0+c2VjdG9yc19wZXJfY2x1X2JpdHMpLAorCQkJCSAgICAgICBHRlBfTk9GUywgMCk7CisJCWlm
IChyZXQgPT0gLUVPUE5PVFNVUFApIHsKKwkJCXByX3dhcm4oImRpc2NhcmQgbm90IHN1cHBvcnRl
ZCBieSBkZXZpY2UsIGRpc2FibGluZyIpOworCQkJb3B0cy0+ZGlzY2FyZCA9IDA7CisJCX0KKwl9
CisjZW5kaWYgLyogQ09ORklHX0VYRkFUX0RJU0NBUkQgKi8KK30KKwordTMyIHRlc3RfYWxsb2Nf
Yml0bWFwKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHUzMiBjbHUpCit7CisJaW50IGksIG1hcF9p
LCBtYXBfYjsKKwl1MzIgY2x1X2Jhc2UsIGNsdV9mcmVlOworCXU4IGssIGNsdV9tYXNrOworCXN0
cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisJc3RydWN0
IGJkX2luZm9fdCAqcF9iZCA9ICYoRVhGQVRfU0Ioc2IpLT5iZF9pbmZvKTsKKworCWNsdV9iYXNl
ID0gKGNsdSAmIH4oMHg3KSkgKyAyOworCWNsdV9tYXNrID0gKDEgPDwgKGNsdSAtIGNsdV9iYXNl
ICsgMikpIC0gMTsKKworCW1hcF9pID0gY2x1ID4+IChwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzICsg
Myk7CisJbWFwX2IgPSAoY2x1ID4+IDMpICYgcF9iZC0+c2VjdG9yX3NpemVfbWFzazsKKworCWZv
ciAoaSA9IDI7IGkgPCBwX2ZzLT5udW1fY2x1c3RlcnM7IGkgKz0gOCkgeworCQlrID0gKigoKHU4
ICopIHBfZnMtPnZvbF9hbWFwW21hcF9pXS0+Yl9kYXRhKSArIG1hcF9iKTsKKwkJaWYgKGNsdV9t
YXNrID4gMCkgeworCQkJayB8PSBjbHVfbWFzazsKKwkJCWNsdV9tYXNrID0gMDsKKwkJfQorCQlp
ZiAoayA8IDB4RkYpIHsKKwkJCWNsdV9mcmVlID0gY2x1X2Jhc2UgKyBmcmVlX2JpdFtrXTsKKwkJ
CWlmIChjbHVfZnJlZSA8IHBfZnMtPm51bV9jbHVzdGVycykKKwkJCQlyZXR1cm4gY2x1X2ZyZWU7
CisJCX0KKwkJY2x1X2Jhc2UgKz0gODsKKworCQlpZiAoKCgrK21hcF9iKSA+PSBwX2JkLT5zZWN0
b3Jfc2l6ZSkgfHwKKwkJICAgIChjbHVfYmFzZSA+PSBwX2ZzLT5udW1fY2x1c3RlcnMpKSB7CisJ
CQlpZiAoKCsrbWFwX2kpID49IHBfZnMtPm1hcF9zZWN0b3JzKSB7CisJCQkJY2x1X2Jhc2UgPSAy
OworCQkJCW1hcF9pID0gMDsKKwkJCX0KKwkJCW1hcF9iID0gMDsKKwkJfQorCX0KKworCXJldHVy
biBDTFVTVEVSXzMyKH4wKTsKK30KKwordm9pZCBzeW5jX2FsbG9jX2JpdG1hcChzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKnNiKQoreworCWludCBpOworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVY
RkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisKKwlpZiAocF9mcy0+dm9sX2FtYXAgPT0gTlVMTCkKKwkJ
cmV0dXJuOworCisJZm9yIChpID0gMDsgaSA8IHBfZnMtPm1hcF9zZWN0b3JzOyBpKyspCisJCXN5
bmNfZGlydHlfYnVmZmVyKHBfZnMtPnZvbF9hbWFwW2ldKTsKK30KKworLyoKKyAqICBVcGNhc2Ug
dGFibGUgTWFuYWdlbWVudCBGdW5jdGlvbnMKKyAqLworc3RhdGljIHMzMiBfX2xvYWRfdXBjYXNl
X3RhYmxlKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHNlY3Rvcl90IHNlY3RvciwKKwkJCSAgICAg
ICB1MzIgbnVtX3NlY3RvcnMsIHUzMiB1dGJsX2NoZWNrc3VtKQoreworCWludCBpLCByZXQgPSBG
RlNfRVJST1I7CisJdTMyIGo7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Io
c2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihFWEZBVF9TQihzYikt
PmJkX2luZm8pOworCXN0cnVjdCBidWZmZXJfaGVhZCAqdG1wX2JoID0gTlVMTDsKKwlzZWN0b3Jf
dCBlbmRfc2VjdG9yID0gbnVtX3NlY3RvcnMgKyBzZWN0b3I7CisKKwl1OAlza2lwID0gRkFMU0U7
CisJdTMyCWluZGV4ID0gMDsKKwl1MTYJdW5pID0gMDsKKwl1MTYgKip1cGNhc2VfdGFibGU7CisK
Kwl1MzIgY2hlY2tzdW0gPSAwOworCisJdXBjYXNlX3RhYmxlID0gcF9mcy0+dm9sX3V0YmwgPSBr
bWFsbG9jKFVUQkxfQ09MX0NPVU5UICogc2l6ZW9mKHUxNiAqKSwKKwkJCQkJCUdGUF9LRVJORUwp
OworCWlmICh1cGNhc2VfdGFibGUgPT0gTlVMTCkKKwkJcmV0dXJuIEZGU19NRU1PUllFUlI7CisJ
bWVtc2V0KHVwY2FzZV90YWJsZSwgMCwgVVRCTF9DT0xfQ09VTlQgKiBzaXplb2YodTE2ICopKTsK
KworCXdoaWxlIChzZWN0b3IgPCBlbmRfc2VjdG9yKSB7CisJCXJldCA9IHNlY3Rvcl9yZWFkKHNi
LCBzZWN0b3IsICZ0bXBfYmgsIDEpOworCQlpZiAocmV0ICE9IEZGU19TVUNDRVNTKSB7CisJCQlw
cl9kZWJ1Zygic2VjdG9yIHJlYWQgKDB4JWxsWClmYWlsXG4iLAorCQkJCSAodW5zaWduZWQgbG9u
ZyBsb25nKXNlY3Rvcik7CisJCQlnb3RvIGVycm9yOworCQl9CisJCXNlY3RvcisrOworCisJCWZv
ciAoaSA9IDA7IGkgPCBwX2JkLT5zZWN0b3Jfc2l6ZSAmJiBpbmRleCA8PSAweEZGRkY7IGkgKz0g
MikgeworCQkJdW5pID0gR0VUMTYoKCh1OCAqKSB0bXBfYmgtPmJfZGF0YSkraSk7CisKKwkJCWNo
ZWNrc3VtID0gKChjaGVja3N1bSAmIDEpID8gMHg4MDAwMDAwMCA6IDApICsKKwkJCQkgICAoY2hl
Y2tzdW0gPj4gMSkgKyAqKCgodTggKil0bXBfYmgtPmJfZGF0YSkgKworCQkJCQkJICAgICAgIGkp
OworCQkJY2hlY2tzdW0gPSAoKGNoZWNrc3VtICYgMSkgPyAweDgwMDAwMDAwIDogMCkgKworCQkJ
CSAgIChjaGVja3N1bSA+PiAxKSArICooKCh1OCAqKXRtcF9iaC0+Yl9kYXRhKSArCisJCQkJCQkg
ICAgICAgKGkgKyAxKSk7CisKKwkJCWlmIChza2lwKSB7CisJCQkJcHJfZGVidWcoInNraXAgZnJv
bSAweCVYICIsIGluZGV4KTsKKwkJCQlpbmRleCArPSB1bmk7CisJCQkJcHJfZGVidWcoInRvIDB4
JVggKGFtb3VudCBvZiAweCVYKVxuIiwKKwkJCQkJIGluZGV4LCB1bmkpOworCQkJCXNraXAgPSBG
QUxTRTsKKwkJCX0gZWxzZSBpZiAodW5pID09IGluZGV4KQorCQkJCWluZGV4Kys7CisJCQllbHNl
IGlmICh1bmkgPT0gMHhGRkZGKQorCQkJCXNraXAgPSBUUlVFOworCQkJZWxzZSB7IC8qIHVuaSAh
PSBpbmRleCAsIHVuaSAhPSAweEZGRkYgKi8KKwkJCQl1MTYgY29sX2luZGV4ID0gZ2V0X2NvbF9p
bmRleChpbmRleCk7CisKKwkJCQlpZiAodXBjYXNlX3RhYmxlW2NvbF9pbmRleF0gPT0gTlVMTCkg
eworCQkJCQlwcl9kZWJ1ZygiYWxsb2MgPSAweCVYXG4iLCBjb2xfaW5kZXgpOworCQkJCQl1cGNh
c2VfdGFibGVbY29sX2luZGV4XSA9IGttYWxsb2NfYXJyYXkoVVRCTF9ST1dfQ09VTlQsCisJCQkJ
CQlzaXplb2YodTE2KSwgR0ZQX0tFUk5FTCk7CisJCQkJCWlmICh1cGNhc2VfdGFibGVbY29sX2lu
ZGV4XSA9PSBOVUxMKSB7CisJCQkJCQlyZXQgPSBGRlNfTUVNT1JZRVJSOworCQkJCQkJZ290byBl
cnJvcjsKKwkJCQkJfQorCisJCQkJCWZvciAoaiA9IDA7IGogPCBVVEJMX1JPV19DT1VOVDsgaisr
KQorCQkJCQkJdXBjYXNlX3RhYmxlW2NvbF9pbmRleF1bal0gPSAoY29sX2luZGV4IDw8IExPV19J
TkRFWF9CSVQpIHwgajsKKwkJCQl9CisKKwkJCQl1cGNhc2VfdGFibGVbY29sX2luZGV4XVtnZXRf
cm93X2luZGV4KGluZGV4KV0gPSB1bmk7CisJCQkJaW5kZXgrKzsKKwkJCX0KKwkJfQorCX0KKwlp
ZiAoaW5kZXggPj0gMHhGRkZGICYmIHV0YmxfY2hlY2tzdW0gPT0gY2hlY2tzdW0pIHsKKwkJaWYg
KHRtcF9iaCkKKwkJCWJyZWxzZSh0bXBfYmgpOworCQlyZXR1cm4gRkZTX1NVQ0NFU1M7CisJfQor
CXJldCA9IEZGU19FUlJPUjsKK2Vycm9yOgorCWlmICh0bXBfYmgpCisJCWJyZWxzZSh0bXBfYmgp
OworCWZyZWVfdXBjYXNlX3RhYmxlKHNiKTsKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgczMy
IF9fbG9hZF9kZWZhdWx0X3VwY2FzZV90YWJsZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQorewor
CWludCBpLCByZXQgPSBGRlNfRVJST1I7CisJdTMyIGo7CisJc3RydWN0IGZzX2luZm9fdCAqcF9m
cyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCXU4CXNraXAgPSBGQUxTRTsKKwl1MzIJ
aW5kZXggPSAwOworCXUxNgl1bmkgPSAwOworCXUxNiAqKnVwY2FzZV90YWJsZTsKKworCXVwY2Fz
ZV90YWJsZSA9IHBfZnMtPnZvbF91dGJsID0ga21hbGxvYyhVVEJMX0NPTF9DT1VOVCAqIHNpemVv
Zih1MTYgKiksCisJCQkJCQlHRlBfS0VSTkVMKTsKKwlpZiAodXBjYXNlX3RhYmxlID09IE5VTEwp
CisJCXJldHVybiBGRlNfTUVNT1JZRVJSOworCW1lbXNldCh1cGNhc2VfdGFibGUsIDAsIFVUQkxf
Q09MX0NPVU5UICogc2l6ZW9mKHUxNiAqKSk7CisKKwlmb3IgKGkgPSAwOyBpbmRleCA8PSAweEZG
RkYgJiYgaSA8IE5VTV9VUENBU0UqMjsgaSArPSAyKSB7CisJCXVuaSA9IEdFVDE2KHVuaV91cGNh
c2UgKyBpKTsKKwkJaWYgKHNraXApIHsKKwkJCXByX2RlYnVnKCJza2lwIGZyb20gMHglWCAiLCBp
bmRleCk7CisJCQlpbmRleCArPSB1bmk7CisJCQlwcl9kZWJ1ZygidG8gMHglWCAoYW1vdW50IG9m
IDB4JVgpXG4iLCBpbmRleCwgdW5pKTsKKwkJCXNraXAgPSBGQUxTRTsKKwkJfSBlbHNlIGlmICh1
bmkgPT0gaW5kZXgpCisJCQlpbmRleCsrOworCQllbHNlIGlmICh1bmkgPT0gMHhGRkZGKQorCQkJ
c2tpcCA9IFRSVUU7CisJCWVsc2UgeyAvKiB1bmkgIT0gaW5kZXggLCB1bmkgIT0gMHhGRkZGICov
CisJCQl1MTYgY29sX2luZGV4ID0gZ2V0X2NvbF9pbmRleChpbmRleCk7CisKKwkJCWlmICh1cGNh
c2VfdGFibGVbY29sX2luZGV4XSA9PSBOVUxMKSB7CisJCQkJcHJfZGVidWcoImFsbG9jID0gMHgl
WFxuIiwgY29sX2luZGV4KTsKKwkJCQl1cGNhc2VfdGFibGVbY29sX2luZGV4XSA9IGttYWxsb2Nf
YXJyYXkoVVRCTF9ST1dfQ09VTlQsCisJCQkJCQkJCQlzaXplb2YodTE2KSwKKwkJCQkJCQkJCUdG
UF9LRVJORUwpOworCQkJCWlmICh1cGNhc2VfdGFibGVbY29sX2luZGV4XSA9PSBOVUxMKSB7CisJ
CQkJCXJldCA9IEZGU19NRU1PUllFUlI7CisJCQkJCWdvdG8gZXJyb3I7CisJCQkJfQorCisJCQkJ
Zm9yIChqID0gMDsgaiA8IFVUQkxfUk9XX0NPVU5UOyBqKyspCisJCQkJCXVwY2FzZV90YWJsZVtj
b2xfaW5kZXhdW2pdID0gKGNvbF9pbmRleCA8PCBMT1dfSU5ERVhfQklUKSB8IGo7CisJCQl9CisK
KwkJCXVwY2FzZV90YWJsZVtjb2xfaW5kZXhdW2dldF9yb3dfaW5kZXgoaW5kZXgpXSA9IHVuaTsK
KwkJCWluZGV4Kys7CisJCX0KKwl9CisKKwlpZiAoaW5kZXggPj0gMHhGRkZGKQorCQlyZXR1cm4g
RkZTX1NVQ0NFU1M7CisKK2Vycm9yOgorCS8qIEZBVEFMIGVycm9yOiBkZWZhdWx0IHVwY2FzZSB0
YWJsZSBoYXMgZXJyb3IgKi8KKwlmcmVlX3VwY2FzZV90YWJsZShzYik7CisJcmV0dXJuIHJldDsK
K30KKworczMyIGxvYWRfdXBjYXNlX3RhYmxlKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCit7CisJ
aW50IGk7CisJdTMyIHRibF9jbHUsIHRibF9zaXplOworCXNlY3Rvcl90IHNlY3RvcjsKKwl1MzIg
dHlwZSwgbnVtX3NlY3RvcnM7CisJc3RydWN0IGNoYWluX3QgY2x1OworCXN0cnVjdCBjYXNlX2Rl
bnRyeV90ICplcDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZz
X2luZm8pOworCXN0cnVjdCBiZF9pbmZvX3QgKnBfYmQgPSAmKEVYRkFUX1NCKHNiKS0+YmRfaW5m
byk7CisKKwljbHUuZGlyID0gcF9mcy0+cm9vdF9kaXI7CisJY2x1LmZsYWdzID0gMHgwMTsKKwor
CWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJcmV0dXJuIEZGU19NRURJQUVSUjsKKworCXdoaWxl
IChjbHUuZGlyICE9IENMVVNURVJfMzIofjApKSB7CisJCWZvciAoaSA9IDA7IGkgPCBwX2ZzLT5k
ZW50cmllc19wZXJfY2x1OyBpKyspIHsKKwkJCWVwID0gKHN0cnVjdCBjYXNlX2RlbnRyeV90ICop
Z2V0X2VudHJ5X2luX2RpcihzYiwgJmNsdSwKKwkJCQkJCQkJICAgICAgaSwgTlVMTCk7CisJCQlp
ZiAoIWVwKQorCQkJCXJldHVybiBGRlNfTUVESUFFUlI7CisKKwkJCXR5cGUgPSBwX2ZzLT5mc19m
dW5jLT5nZXRfZW50cnlfdHlwZSgoc3RydWN0IGRlbnRyeV90ICopZXApOworCisJCQlpZiAodHlw
ZSA9PSBUWVBFX1VOVVNFRCkKKwkJCQlicmVhazsKKwkJCWlmICh0eXBlICE9IFRZUEVfVVBDQVNF
KQorCQkJCWNvbnRpbnVlOworCisJCQl0YmxfY2x1ICA9IEdFVDMyX0EoZXAtPnN0YXJ0X2NsdSk7
CisJCQl0Ymxfc2l6ZSA9ICh1MzIpIEdFVDY0X0EoZXAtPnNpemUpOworCisJCQlzZWN0b3IgPSBT
VEFSVF9TRUNUT1IodGJsX2NsdSk7CisJCQludW1fc2VjdG9ycyA9ICgodGJsX3NpemUtMSkgPj4g
cF9iZC0+c2VjdG9yX3NpemVfYml0cykgKyAxOworCQkJaWYgKF9fbG9hZF91cGNhc2VfdGFibGUo
c2IsIHNlY3RvciwgbnVtX3NlY3RvcnMsCisJCQkJCQlHRVQzMl9BKGVwLT5jaGVja3N1bSkpICE9
IEZGU19TVUNDRVNTKQorCQkJCWJyZWFrOworCQkJcmV0dXJuIEZGU19TVUNDRVNTOworCQl9CisJ
CWlmIChGQVRfcmVhZChzYiwgY2x1LmRpciwgJmNsdS5kaXIpICE9IDApCisJCQlyZXR1cm4gRkZT
X01FRElBRVJSOworCX0KKwkvKiBsb2FkIGRlZmF1bHQgdXBjYXNlIHRhYmxlICovCisJcmV0dXJu
IF9fbG9hZF9kZWZhdWx0X3VwY2FzZV90YWJsZShzYik7Cit9CisKK3ZvaWQgZnJlZV91cGNhc2Vf
dGFibGUoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sKKwl1MzIgaTsKKwlzdHJ1Y3QgZnNfaW5m
b190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXUxNiAqKnVwY2FzZV90YWJs
ZTsKKworCXVwY2FzZV90YWJsZSA9IHBfZnMtPnZvbF91dGJsOworCWZvciAoaSA9IDA7IGkgPCBV
VEJMX0NPTF9DT1VOVDsgaSsrKQorCQlrZnJlZSh1cGNhc2VfdGFibGVbaV0pOworCisJa2ZyZWUo
cF9mcy0+dm9sX3V0YmwpOworCXBfZnMtPnZvbF91dGJsID0gTlVMTDsKK30KKworLyoKKyAqICBE
aXJlY3RvcnkgRW50cnkgTWFuYWdlbWVudCBGdW5jdGlvbnMKKyAqLworCit1MzIgZmF0X2dldF9l
bnRyeV90eXBlKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSkKK3sKKwlzdHJ1Y3QgZG9zX2RlbnRy
eV90ICplcCA9IChzdHJ1Y3QgZG9zX2RlbnRyeV90ICopIHBfZW50cnk7CisKKwlpZiAoKihlcC0+
bmFtZSkgPT0gMHgwKQorCQlyZXR1cm4gVFlQRV9VTlVTRUQ7CisKKwllbHNlIGlmICgqKGVwLT5u
YW1lKSA9PSAweEU1KQorCQlyZXR1cm4gVFlQRV9ERUxFVEVEOworCisJZWxzZSBpZiAoZXAtPmF0
dHIgPT0gQVRUUl9FWFRFTkQpCisJCXJldHVybiBUWVBFX0VYVEVORDsKKworCWVsc2UgaWYgKChl
cC0+YXR0ciAmIChBVFRSX1NVQkRJUnxBVFRSX1ZPTFVNRSkpID09IEFUVFJfVk9MVU1FKQorCQly
ZXR1cm4gVFlQRV9WT0xVTUU7CisKKwllbHNlIGlmICgoZXAtPmF0dHIgJiAoQVRUUl9TVUJESVJ8
QVRUUl9WT0xVTUUpKSA9PSBBVFRSX1NVQkRJUikKKwkJcmV0dXJuIFRZUEVfRElSOworCisJcmV0
dXJuIFRZUEVfRklMRTsKK30KKwordTMyIGV4ZmF0X2dldF9lbnRyeV90eXBlKHN0cnVjdCBkZW50
cnlfdCAqcF9lbnRyeSkKK3sKKwlzdHJ1Y3QgZmlsZV9kZW50cnlfdCAqZXAgPSAoc3RydWN0IGZp
bGVfZGVudHJ5X3QgKikgcF9lbnRyeTsKKworCWlmIChlcC0+dHlwZSA9PSAweDApIHsKKwkJcmV0
dXJuIFRZUEVfVU5VU0VEOworCX0gZWxzZSBpZiAoZXAtPnR5cGUgPCAweDgwKSB7CisJCXJldHVy
biBUWVBFX0RFTEVURUQ7CisJfSBlbHNlIGlmIChlcC0+dHlwZSA9PSAweDgwKSB7CisJCXJldHVy
biBUWVBFX0lOVkFMSUQ7CisJfSBlbHNlIGlmIChlcC0+dHlwZSA8IDB4QTApIHsKKwkJaWYgKGVw
LT50eXBlID09IDB4ODEpIHsKKwkJCXJldHVybiBUWVBFX0JJVE1BUDsKKwkJfSBlbHNlIGlmIChl
cC0+dHlwZSA9PSAweDgyKSB7CisJCQlyZXR1cm4gVFlQRV9VUENBU0U7CisJCX0gZWxzZSBpZiAo
ZXAtPnR5cGUgPT0gMHg4MykgeworCQkJcmV0dXJuIFRZUEVfVk9MVU1FOworCQl9IGVsc2UgaWYg
KGVwLT50eXBlID09IDB4ODUpIHsKKwkJCWlmIChHRVQxNl9BKGVwLT5hdHRyKSAmIEFUVFJfU1VC
RElSKQorCQkJCXJldHVybiBUWVBFX0RJUjsKKwkJCWVsc2UKKwkJCQlyZXR1cm4gVFlQRV9GSUxF
OworCQl9CisJCXJldHVybiBUWVBFX0NSSVRJQ0FMX1BSSTsKKwl9IGVsc2UgaWYgKGVwLT50eXBl
IDwgMHhDMCkgeworCQlpZiAoZXAtPnR5cGUgPT0gMHhBMCkKKwkJCXJldHVybiBUWVBFX0dVSUQ7
CisJCWVsc2UgaWYgKGVwLT50eXBlID09IDB4QTEpCisJCQlyZXR1cm4gVFlQRV9QQURESU5HOwor
CQllbHNlIGlmIChlcC0+dHlwZSA9PSAweEEyKQorCQkJcmV0dXJuIFRZUEVfQUNMVEFCOworCQly
ZXR1cm4gVFlQRV9CRU5JR05fUFJJOworCX0gZWxzZSBpZiAoZXAtPnR5cGUgPCAweEUwKSB7CisJ
CWlmIChlcC0+dHlwZSA9PSAweEMwKQorCQkJcmV0dXJuIFRZUEVfU1RSRUFNOworCQllbHNlIGlm
IChlcC0+dHlwZSA9PSAweEMxKQorCQkJcmV0dXJuIFRZUEVfRVhURU5EOworCQllbHNlIGlmIChl
cC0+dHlwZSA9PSAweEMyKQorCQkJcmV0dXJuIFRZUEVfQUNMOworCQlyZXR1cm4gVFlQRV9DUklU
SUNBTF9TRUM7CisJfQorCisJcmV0dXJuIFRZUEVfQkVOSUdOX1NFQzsKK30KKwordm9pZCBmYXRf
c2V0X2VudHJ5X3R5cGUoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5LCB1MzIgdHlwZSkKK3sKKwlz
dHJ1Y3QgZG9zX2RlbnRyeV90ICplcCA9IChzdHJ1Y3QgZG9zX2RlbnRyeV90ICopIHBfZW50cnk7
CisKKwlpZiAodHlwZSA9PSBUWVBFX1VOVVNFRCkKKwkJKihlcC0+bmFtZSkgPSAweDA7CisKKwll
bHNlIGlmICh0eXBlID09IFRZUEVfREVMRVRFRCkKKwkJKihlcC0+bmFtZSkgPSAweEU1OworCisJ
ZWxzZSBpZiAodHlwZSA9PSBUWVBFX0VYVEVORCkKKwkJZXAtPmF0dHIgPSBBVFRSX0VYVEVORDsK
KworCWVsc2UgaWYgKHR5cGUgPT0gVFlQRV9ESVIpCisJCWVwLT5hdHRyID0gQVRUUl9TVUJESVI7
CisKKwllbHNlIGlmICh0eXBlID09IFRZUEVfRklMRSkKKwkJZXAtPmF0dHIgPSBBVFRSX0FSQ0hJ
VkU7CisKKwllbHNlIGlmICh0eXBlID09IFRZUEVfU1lNTElOSykKKwkJZXAtPmF0dHIgPSBBVFRS
X0FSQ0hJVkUgfCBBVFRSX1NZTUxJTks7Cit9CisKK3ZvaWQgZXhmYXRfc2V0X2VudHJ5X3R5cGUo
c3RydWN0IGRlbnRyeV90ICpwX2VudHJ5LCB1MzIgdHlwZSkKK3sKKwlzdHJ1Y3QgZmlsZV9kZW50
cnlfdCAqZXAgPSAoc3RydWN0IGZpbGVfZGVudHJ5X3QgKikgcF9lbnRyeTsKKworCWlmICh0eXBl
ID09IFRZUEVfVU5VU0VEKSB7CisJCWVwLT50eXBlID0gMHgwOworCX0gZWxzZSBpZiAodHlwZSA9
PSBUWVBFX0RFTEVURUQpIHsKKwkJZXAtPnR5cGUgJj0gfjB4ODA7CisJfSBlbHNlIGlmICh0eXBl
ID09IFRZUEVfU1RSRUFNKSB7CisJCWVwLT50eXBlID0gMHhDMDsKKwl9IGVsc2UgaWYgKHR5cGUg
PT0gVFlQRV9FWFRFTkQpIHsKKwkJZXAtPnR5cGUgPSAweEMxOworCX0gZWxzZSBpZiAodHlwZSA9
PSBUWVBFX0JJVE1BUCkgeworCQllcC0+dHlwZSA9IDB4ODE7CisJfSBlbHNlIGlmICh0eXBlID09
IFRZUEVfVVBDQVNFKSB7CisJCWVwLT50eXBlID0gMHg4MjsKKwl9IGVsc2UgaWYgKHR5cGUgPT0g
VFlQRV9WT0xVTUUpIHsKKwkJZXAtPnR5cGUgPSAweDgzOworCX0gZWxzZSBpZiAodHlwZSA9PSBU
WVBFX0RJUikgeworCQllcC0+dHlwZSA9IDB4ODU7CisJCVNFVDE2X0EoZXAtPmF0dHIsIEFUVFJf
U1VCRElSKTsKKwl9IGVsc2UgaWYgKHR5cGUgPT0gVFlQRV9GSUxFKSB7CisJCWVwLT50eXBlID0g
MHg4NTsKKwkJU0VUMTZfQShlcC0+YXR0ciwgQVRUUl9BUkNISVZFKTsKKwl9IGVsc2UgaWYgKHR5
cGUgPT0gVFlQRV9TWU1MSU5LKSB7CisJCWVwLT50eXBlID0gMHg4NTsKKwkJU0VUMTZfQShlcC0+
YXR0ciwgQVRUUl9BUkNISVZFIHwgQVRUUl9TWU1MSU5LKTsKKwl9Cit9CisKK3UzMiBmYXRfZ2V0
X2VudHJ5X2F0dHIoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5KQoreworCXN0cnVjdCBkb3NfZGVu
dHJ5X3QgKmVwID0gKHN0cnVjdCBkb3NfZGVudHJ5X3QgKikgcF9lbnRyeTsKKworCXJldHVybiAo
dTMyKSBlcC0+YXR0cjsKK30KKwordTMyIGV4ZmF0X2dldF9lbnRyeV9hdHRyKHN0cnVjdCBkZW50
cnlfdCAqcF9lbnRyeSkKK3sKKwlzdHJ1Y3QgZmlsZV9kZW50cnlfdCAqZXAgPSAoc3RydWN0IGZp
bGVfZGVudHJ5X3QgKikgcF9lbnRyeTsKKworCXJldHVybiAodTMyKSBHRVQxNl9BKGVwLT5hdHRy
KTsKK30KKwordm9pZCBmYXRfc2V0X2VudHJ5X2F0dHIoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5
LCB1MzIgYXR0cikKK3sKKwlzdHJ1Y3QgZG9zX2RlbnRyeV90ICplcCA9IChzdHJ1Y3QgZG9zX2Rl
bnRyeV90ICopIHBfZW50cnk7CisKKwllcC0+YXR0ciA9ICh1OCkgYXR0cjsKK30KKwordm9pZCBl
eGZhdF9zZXRfZW50cnlfYXR0cihzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHUzMiBhdHRyKQor
eworCXN0cnVjdCBmaWxlX2RlbnRyeV90ICplcCA9IChzdHJ1Y3QgZmlsZV9kZW50cnlfdCAqKSBw
X2VudHJ5OworCisJU0VUMTZfQShlcC0+YXR0ciwgKHUxNikgYXR0cik7Cit9CisKK3U4IGZhdF9n
ZXRfZW50cnlfZmxhZyhzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnkpCit7CisJcmV0dXJuIDB4MDE7
Cit9CisKK3U4IGV4ZmF0X2dldF9lbnRyeV9mbGFnKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSkK
K3sKKwlzdHJ1Y3Qgc3RybV9kZW50cnlfdCAqZXAgPSAoc3RydWN0IHN0cm1fZGVudHJ5X3QgKikg
cF9lbnRyeTsKKworCXJldHVybiBlcC0+ZmxhZ3M7Cit9CisKK3ZvaWQgZmF0X3NldF9lbnRyeV9m
bGFnKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSwgdTggZmxhZ3MpCit7Cit9CisKK3ZvaWQgZXhm
YXRfc2V0X2VudHJ5X2ZsYWcoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5LCB1OCBmbGFncykKK3sK
KwlzdHJ1Y3Qgc3RybV9kZW50cnlfdCAqZXAgPSAoc3RydWN0IHN0cm1fZGVudHJ5X3QgKikgcF9l
bnRyeTsKKworCWVwLT5mbGFncyA9IGZsYWdzOworfQorCit1MzIgZmF0X2dldF9lbnRyeV9jbHUw
KHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSkKK3sKKwlzdHJ1Y3QgZG9zX2RlbnRyeV90ICplcCA9
IChzdHJ1Y3QgZG9zX2RlbnRyeV90ICopIHBfZW50cnk7CisKKwlyZXR1cm4gKCh1MzIpR0VUMTZf
QShlcC0+c3RhcnRfY2x1X2hpKSA8PCAxNikgfAorCQlHRVQxNl9BKGVwLT5zdGFydF9jbHVfbG8p
OworfQorCit1MzIgZXhmYXRfZ2V0X2VudHJ5X2NsdTAoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5
KQoreworCXN0cnVjdCBzdHJtX2RlbnRyeV90ICplcCA9IChzdHJ1Y3Qgc3RybV9kZW50cnlfdCAq
KSBwX2VudHJ5OworCisJcmV0dXJuIEdFVDMyX0EoZXAtPnN0YXJ0X2NsdSk7Cit9CisKK3ZvaWQg
ZmF0X3NldF9lbnRyeV9jbHUwKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSwgdTMyIHN0YXJ0X2Ns
dSkKK3sKKwlzdHJ1Y3QgZG9zX2RlbnRyeV90ICplcCA9IChzdHJ1Y3QgZG9zX2RlbnRyeV90ICop
cF9lbnRyeTsKKworCVNFVDE2X0EoZXAtPnN0YXJ0X2NsdV9sbywgQ0xVU1RFUl8xNihzdGFydF9j
bHUpKTsKKwlTRVQxNl9BKGVwLT5zdGFydF9jbHVfaGksIENMVVNURVJfMTYoc3RhcnRfY2x1ID4+
IDE2KSk7Cit9CisKK3ZvaWQgZXhmYXRfc2V0X2VudHJ5X2NsdTAoc3RydWN0IGRlbnRyeV90ICpw
X2VudHJ5LCB1MzIgc3RhcnRfY2x1KQoreworCXN0cnVjdCBzdHJtX2RlbnRyeV90ICplcCA9IChz
dHJ1Y3Qgc3RybV9kZW50cnlfdCAqKXBfZW50cnk7CisKKwlTRVQzMl9BKGVwLT5zdGFydF9jbHUs
IHN0YXJ0X2NsdSk7Cit9CisKK3U2NCBmYXRfZ2V0X2VudHJ5X3NpemUoc3RydWN0IGRlbnRyeV90
ICpwX2VudHJ5KQoreworCXN0cnVjdCBkb3NfZGVudHJ5X3QgKmVwID0gKHN0cnVjdCBkb3NfZGVu
dHJ5X3QgKilwX2VudHJ5OworCisJcmV0dXJuICh1NjQpIEdFVDMyX0EoZXAtPnNpemUpOworfQor
Cit1NjQgZXhmYXRfZ2V0X2VudHJ5X3NpemUoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5KQorewor
CXN0cnVjdCBzdHJtX2RlbnRyeV90ICplcCA9IChzdHJ1Y3Qgc3RybV9kZW50cnlfdCAqKXBfZW50
cnk7CisKKwlyZXR1cm4gR0VUNjRfQShlcC0+dmFsaWRfc2l6ZSk7Cit9CisKK3ZvaWQgZmF0X3Nl
dF9lbnRyeV9zaXplKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSwgdTY0IHNpemUpCit7CisJc3Ry
dWN0IGRvc19kZW50cnlfdCAqZXAgPSAoc3RydWN0IGRvc19kZW50cnlfdCAqKXBfZW50cnk7CisK
KwlTRVQzMl9BKGVwLT5zaXplLCAodTMyKSBzaXplKTsKK30KKwordm9pZCBleGZhdF9zZXRfZW50
cnlfc2l6ZShzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHU2NCBzaXplKQoreworCXN0cnVjdCBz
dHJtX2RlbnRyeV90ICplcCA9IChzdHJ1Y3Qgc3RybV9kZW50cnlfdCAqKXBfZW50cnk7CisKKwlT
RVQ2NF9BKGVwLT52YWxpZF9zaXplLCBzaXplKTsKKwlTRVQ2NF9BKGVwLT5zaXplLCBzaXplKTsK
K30KKwordm9pZCBmYXRfZ2V0X2VudHJ5X3RpbWUoc3RydWN0IGRlbnRyeV90ICpwX2VudHJ5LCBz
dHJ1Y3QgdGltZXN0YW1wX3QgKnRwLAorCQkJdTggbW9kZSkKK3sKKwl1MTYgdCA9IDB4MDAsIGQg
PSAweDIxOworCXN0cnVjdCBkb3NfZGVudHJ5X3QgKmVwID0gKHN0cnVjdCBkb3NfZGVudHJ5X3Qg
KilwX2VudHJ5OworCisJc3dpdGNoIChtb2RlKSB7CisJY2FzZSBUTV9DUkVBVEU6CisJCXQgPSBH
RVQxNl9BKGVwLT5jcmVhdGVfdGltZSk7CisJCWQgPSBHRVQxNl9BKGVwLT5jcmVhdGVfZGF0ZSk7
CisJCWJyZWFrOworCWNhc2UgVE1fTU9ESUZZOgorCQl0ID0gR0VUMTZfQShlcC0+bW9kaWZ5X3Rp
bWUpOworCQlkID0gR0VUMTZfQShlcC0+bW9kaWZ5X2RhdGUpOworCQlicmVhazsKKwl9CisKKwl0
cC0+c2VjICA9ICh0ICYgMHgwMDFGKSA8PCAxOworCXRwLT5taW4gID0gKHQgPj4gNSkgJiAweDAw
M0Y7CisJdHAtPmhvdXIgPSAodCA+PiAxMSk7CisJdHAtPmRheSAgPSAoZCAmIDB4MDAxRik7CisJ
dHAtPm1vbiAgPSAoZCA+PiA1KSAmIDB4MDAwRjsKKwl0cC0+eWVhciA9IChkID4+IDkpOworfQor
Cit2b2lkIGV4ZmF0X2dldF9lbnRyeV90aW1lKHN0cnVjdCBkZW50cnlfdCAqcF9lbnRyeSwgc3Ry
dWN0IHRpbWVzdGFtcF90ICp0cCwKKwkJCSAgdTggbW9kZSkKK3sKKwl1MTYgdCA9IDB4MDAsIGQg
PSAweDIxOworCXN0cnVjdCBmaWxlX2RlbnRyeV90ICplcCA9IChzdHJ1Y3QgZmlsZV9kZW50cnlf
dCAqKXBfZW50cnk7CisKKwlzd2l0Y2ggKG1vZGUpIHsKKwljYXNlIFRNX0NSRUFURToKKwkJdCA9
IEdFVDE2X0EoZXAtPmNyZWF0ZV90aW1lKTsKKwkJZCA9IEdFVDE2X0EoZXAtPmNyZWF0ZV9kYXRl
KTsKKwkJYnJlYWs7CisJY2FzZSBUTV9NT0RJRlk6CisJCXQgPSBHRVQxNl9BKGVwLT5tb2RpZnlf
dGltZSk7CisJCWQgPSBHRVQxNl9BKGVwLT5tb2RpZnlfZGF0ZSk7CisJCWJyZWFrOworCWNhc2Ug
VE1fQUNDRVNTOgorCQl0ID0gR0VUMTZfQShlcC0+YWNjZXNzX3RpbWUpOworCQlkID0gR0VUMTZf
QShlcC0+YWNjZXNzX2RhdGUpOworCQlicmVhazsKKwl9CisKKwl0cC0+c2VjICA9ICh0ICYgMHgw
MDFGKSA8PCAxOworCXRwLT5taW4gID0gKHQgPj4gNSkgJiAweDAwM0Y7CisJdHAtPmhvdXIgPSAo
dCA+PiAxMSk7CisJdHAtPmRheSAgPSAoZCAmIDB4MDAxRik7CisJdHAtPm1vbiAgPSAoZCA+PiA1
KSAmIDB4MDAwRjsKKwl0cC0+eWVhciA9IChkID4+IDkpOworfQorCit2b2lkIGZhdF9zZXRfZW50
cnlfdGltZShzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnksIHN0cnVjdCB0aW1lc3RhbXBfdCAqdHAs
CisJCQl1OCBtb2RlKQoreworCXUxNiB0LCBkOworCXN0cnVjdCBkb3NfZGVudHJ5X3QgKmVwID0g
KHN0cnVjdCBkb3NfZGVudHJ5X3QgKilwX2VudHJ5OworCisJdCA9ICh0cC0+aG91ciA8PCAxMSkg
fCAodHAtPm1pbiA8PCA1KSB8ICh0cC0+c2VjID4+IDEpOworCWQgPSAodHAtPnllYXIgPDwgIDkp
IHwgKHRwLT5tb24gPDwgNSkgfCAgdHAtPmRheTsKKworCXN3aXRjaCAobW9kZSkgeworCWNhc2Ug
VE1fQ1JFQVRFOgorCQlTRVQxNl9BKGVwLT5jcmVhdGVfdGltZSwgdCk7CisJCVNFVDE2X0EoZXAt
PmNyZWF0ZV9kYXRlLCBkKTsKKwkJYnJlYWs7CisJY2FzZSBUTV9NT0RJRlk6CisJCVNFVDE2X0Eo
ZXAtPm1vZGlmeV90aW1lLCB0KTsKKwkJU0VUMTZfQShlcC0+bW9kaWZ5X2RhdGUsIGQpOworCQli
cmVhazsKKwl9Cit9CisKK3ZvaWQgZXhmYXRfc2V0X2VudHJ5X3RpbWUoc3RydWN0IGRlbnRyeV90
ICpwX2VudHJ5LCBzdHJ1Y3QgdGltZXN0YW1wX3QgKnRwLAorCQkJICB1OCBtb2RlKQoreworCXUx
NiB0LCBkOworCXN0cnVjdCBmaWxlX2RlbnRyeV90ICplcCA9IChzdHJ1Y3QgZmlsZV9kZW50cnlf
dCAqKXBfZW50cnk7CisKKwl0ID0gKHRwLT5ob3VyIDw8IDExKSB8ICh0cC0+bWluIDw8IDUpIHwg
KHRwLT5zZWMgPj4gMSk7CisJZCA9ICh0cC0+eWVhciA8PCAgOSkgfCAodHAtPm1vbiA8PCA1KSB8
ICB0cC0+ZGF5OworCisJc3dpdGNoIChtb2RlKSB7CisJY2FzZSBUTV9DUkVBVEU6CisJCVNFVDE2
X0EoZXAtPmNyZWF0ZV90aW1lLCB0KTsKKwkJU0VUMTZfQShlcC0+Y3JlYXRlX2RhdGUsIGQpOwor
CQlicmVhazsKKwljYXNlIFRNX01PRElGWToKKwkJU0VUMTZfQShlcC0+bW9kaWZ5X3RpbWUsIHQp
OworCQlTRVQxNl9BKGVwLT5tb2RpZnlfZGF0ZSwgZCk7CisJCWJyZWFrOworCWNhc2UgVE1fQUND
RVNTOgorCQlTRVQxNl9BKGVwLT5hY2Nlc3NfdGltZSwgdCk7CisJCVNFVDE2X0EoZXAtPmFjY2Vz
c19kYXRlLCBkKTsKKwkJYnJlYWs7CisJfQorfQorCitzMzIgZmF0X2luaXRfZGlyX2VudHJ5KHN0
cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwgczMyIGVudHJ5LAor
CQkgICAgICAgdTMyIHR5cGUsIHUzMiBzdGFydF9jbHUsIHU2NCBzaXplKQoreworCXNlY3Rvcl90
IHNlY3RvcjsKKwlzdHJ1Y3QgZG9zX2RlbnRyeV90ICpkb3NfZXA7CisKKwlkb3NfZXAgPSAoc3Ry
dWN0IGRvc19kZW50cnlfdCAqKWdldF9lbnRyeV9pbl9kaXIoc2IsIHBfZGlyLCBlbnRyeSwKKwkJ
CQkJCQkgJnNlY3Rvcik7CisJaWYgKCFkb3NfZXApCisJCXJldHVybiBGRlNfTUVESUFFUlI7CisK
Kwlpbml0X2Rvc19lbnRyeShkb3NfZXAsIHR5cGUsIHN0YXJ0X2NsdSk7CisJYnVmX21vZGlmeShz
Yiwgc2VjdG9yKTsKKworCXJldHVybiBGRlNfU1VDQ0VTUzsKK30KKworczMyIGV4ZmF0X2luaXRf
ZGlyX2VudHJ5KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwK
KwkJCSBzMzIgZW50cnksIHUzMiB0eXBlLCB1MzIgc3RhcnRfY2x1LCB1NjQgc2l6ZSkKK3sKKwlz
ZWN0b3JfdCBzZWN0b3I7CisJdTggZmxhZ3M7CisJc3RydWN0IGZpbGVfZGVudHJ5X3QgKmZpbGVf
ZXA7CisJc3RydWN0IHN0cm1fZGVudHJ5X3QgKnN0cm1fZXA7CisKKwlmbGFncyA9ICh0eXBlID09
IFRZUEVfRklMRSkgPyAweDAxIDogMHgwMzsKKworCS8qIHdlIGNhbm5vdCB1c2UgZ2V0X2VudHJ5
X3NldF9pbl9kaXIgaGVyZSBiZWNhdXNlIGZpbGUgZXAgaXMgbm90IGluaXRpYWxpemVkIHlldCAq
LworCWZpbGVfZXAgPSAoc3RydWN0IGZpbGVfZGVudHJ5X3QgKilnZXRfZW50cnlfaW5fZGlyKHNi
LCBwX2RpciwgZW50cnksCisJCQkJCQkJICAgJnNlY3Rvcik7CisJaWYgKCFmaWxlX2VwKQorCQly
ZXR1cm4gRkZTX01FRElBRVJSOworCisJc3RybV9lcCA9IChzdHJ1Y3Qgc3RybV9kZW50cnlfdCAq
KWdldF9lbnRyeV9pbl9kaXIoc2IsIHBfZGlyLCBlbnRyeSsxLAorCQkJCQkJCSAgICZzZWN0b3Ip
OworCWlmICghc3RybV9lcCkKKwkJcmV0dXJuIEZGU19NRURJQUVSUjsKKworCWluaXRfZmlsZV9l
bnRyeShmaWxlX2VwLCB0eXBlKTsKKwlidWZfbW9kaWZ5KHNiLCBzZWN0b3IpOworCisJaW5pdF9z
dHJtX2VudHJ5KHN0cm1fZXAsIGZsYWdzLCBzdGFydF9jbHUsIHNpemUpOworCWJ1Zl9tb2RpZnko
c2IsIHNlY3Rvcik7CisKKwlyZXR1cm4gRkZTX1NVQ0NFU1M7Cit9CisKK3N0YXRpYyBzMzIgZmF0
X2luaXRfZXh0X2VudHJ5KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpw
X2RpciwKKwkJCSAgICAgIHMzMiBlbnRyeSwgczMyIG51bV9lbnRyaWVzLAorCQkJICAgICAgc3Ry
dWN0IHVuaV9uYW1lX3QgKnBfdW5pbmFtZSwKKwkJCSAgICAgIHN0cnVjdCBkb3NfbmFtZV90ICpw
X2Rvc25hbWUpCit7CisJaW50IGk7CisJc2VjdG9yX3Qgc2VjdG9yOworCXU4IGNoa3N1bTsKKwl1
MTYgKnVuaW5hbWUgPSBwX3VuaW5hbWUtPm5hbWU7CisJc3RydWN0IGRvc19kZW50cnlfdCAqZG9z
X2VwOworCXN0cnVjdCBleHRfZGVudHJ5X3QgKmV4dF9lcDsKKworCWRvc19lcCA9IChzdHJ1Y3Qg
ZG9zX2RlbnRyeV90ICopZ2V0X2VudHJ5X2luX2RpcihzYiwgcF9kaXIsIGVudHJ5LAorCQkJCQkJ
CSAmc2VjdG9yKTsKKwlpZiAoIWRvc19lcCkKKwkJcmV0dXJuIEZGU19NRURJQUVSUjsKKworCWRv
c19lcC0+bGNhc2UgPSBwX2Rvc25hbWUtPm5hbWVfY2FzZTsKKwltZW1jcHkoZG9zX2VwLT5uYW1l
LCBwX2Rvc25hbWUtPm5hbWUsIERPU19OQU1FX0xFTkdUSCk7CisJYnVmX21vZGlmeShzYiwgc2Vj
dG9yKTsKKworCWlmICgoLS1udW1fZW50cmllcykgPiAwKSB7CisJCWNoa3N1bSA9IGNhbGNfY2hl
Y2tzdW1fMWJ5dGUoKHZvaWQgKilkb3NfZXAtPm5hbWUsCisJCQkJCSAgICAgRE9TX05BTUVfTEVO
R1RILCAwKTsKKworCQlmb3IgKGkgPSAxOyBpIDwgbnVtX2VudHJpZXM7IGkrKykgeworCQkJZXh0
X2VwID0gKHN0cnVjdCBleHRfZGVudHJ5X3QgKilnZXRfZW50cnlfaW5fZGlyKHNiLAorCQkJCQkJ
CQkJIHBfZGlyLAorCQkJCQkJCQkJIGVudHJ5IC0gaSwKKwkJCQkJCQkJCSAmc2VjdG9yKTsKKwkJ
CWlmICghZXh0X2VwKQorCQkJCXJldHVybiBGRlNfTUVESUFFUlI7CisKKwkJCWluaXRfZXh0X2Vu
dHJ5KGV4dF9lcCwgaSwgY2hrc3VtLCB1bmluYW1lKTsKKwkJCWJ1Zl9tb2RpZnkoc2IsIHNlY3Rv
cik7CisJCQl1bmluYW1lICs9IDEzOworCQl9CisKKwkJZXh0X2VwID0gKHN0cnVjdCBleHRfZGVu
dHJ5X3QgKilnZXRfZW50cnlfaW5fZGlyKHNiLCBwX2RpciwKKwkJCQkJCQkJIGVudHJ5IC0gaSwK
KwkJCQkJCQkJICZzZWN0b3IpOworCQlpZiAoIWV4dF9lcCkKKwkJCXJldHVybiBGRlNfTUVESUFF
UlI7CisKKwkJaW5pdF9leHRfZW50cnkoZXh0X2VwLCBpKzB4NDAsIGNoa3N1bSwgdW5pbmFtZSk7
CisJCWJ1Zl9tb2RpZnkoc2IsIHNlY3Rvcik7CisJfQorCisJcmV0dXJuIEZGU19TVUNDRVNTOwor
fQorCitzdGF0aWMgczMyIGV4ZmF0X2luaXRfZXh0X2VudHJ5KHN0cnVjdCBzdXBlcl9ibG9jayAq
c2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJCQlzMzIgZW50cnksIHMzMiBudW1fZW50cmll
cywKKwkJCQlzdHJ1Y3QgdW5pX25hbWVfdCAqcF91bmluYW1lLAorCQkJCXN0cnVjdCBkb3NfbmFt
ZV90ICpwX2Rvc25hbWUpCit7CisJaW50IGk7CisJc2VjdG9yX3Qgc2VjdG9yOworCXUxNiAqdW5p
bmFtZSA9IHBfdW5pbmFtZS0+bmFtZTsKKwlzdHJ1Y3QgZmlsZV9kZW50cnlfdCAqZmlsZV9lcDsK
KwlzdHJ1Y3Qgc3RybV9kZW50cnlfdCAqc3RybV9lcDsKKwlzdHJ1Y3QgbmFtZV9kZW50cnlfdCAq
bmFtZV9lcDsKKworCWZpbGVfZXAgPSAoc3RydWN0IGZpbGVfZGVudHJ5X3QgKilnZXRfZW50cnlf
aW5fZGlyKHNiLCBwX2RpciwgZW50cnksCisJCQkJCQkJICAgJnNlY3Rvcik7CisJaWYgKCFmaWxl
X2VwKQorCQlyZXR1cm4gRkZTX01FRElBRVJSOworCisJZmlsZV9lcC0+bnVtX2V4dCA9ICh1OCko
bnVtX2VudHJpZXMgLSAxKTsKKwlidWZfbW9kaWZ5KHNiLCBzZWN0b3IpOworCisJc3RybV9lcCA9
IChzdHJ1Y3Qgc3RybV9kZW50cnlfdCAqKWdldF9lbnRyeV9pbl9kaXIoc2IsIHBfZGlyLCBlbnRy
eSsxLAorCQkJCQkJCSAgICZzZWN0b3IpOworCWlmICghc3RybV9lcCkKKwkJcmV0dXJuIEZGU19N
RURJQUVSUjsKKworCXN0cm1fZXAtPm5hbWVfbGVuID0gcF91bmluYW1lLT5uYW1lX2xlbjsKKwlT
RVQxNl9BKHN0cm1fZXAtPm5hbWVfaGFzaCwgcF91bmluYW1lLT5uYW1lX2hhc2gpOworCWJ1Zl9t
b2RpZnkoc2IsIHNlY3Rvcik7CisKKwlmb3IgKGkgPSAyOyBpIDwgbnVtX2VudHJpZXM7IGkrKykg
eworCQluYW1lX2VwID0gKHN0cnVjdCBuYW1lX2RlbnRyeV90ICopZ2V0X2VudHJ5X2luX2Rpcihz
YiwgcF9kaXIsCisJCQkJCQkJCSAgIGVudHJ5ICsgaSwKKwkJCQkJCQkJICAgJnNlY3Rvcik7CisJ
CWlmICghbmFtZV9lcCkKKwkJCXJldHVybiBGRlNfTUVESUFFUlI7CisKKwkJaW5pdF9uYW1lX2Vu
dHJ5KG5hbWVfZXAsIHVuaW5hbWUpOworCQlidWZfbW9kaWZ5KHNiLCBzZWN0b3IpOworCQl1bmlu
YW1lICs9IDE1OworCX0KKworCXVwZGF0ZV9kaXJfY2hlY2tzdW0oc2IsIHBfZGlyLCBlbnRyeSk7
CisKKwlyZXR1cm4gRkZTX1NVQ0NFU1M7Cit9CisKK3ZvaWQgaW5pdF9kb3NfZW50cnkoc3RydWN0
IGRvc19kZW50cnlfdCAqZXAsIHUzMiB0eXBlLCB1MzIgc3RhcnRfY2x1KQoreworCXN0cnVjdCB0
aW1lc3RhbXBfdCB0bSwgKnRwOworCisJZmF0X3NldF9lbnRyeV90eXBlKChzdHJ1Y3QgZGVudHJ5
X3QgKikgZXAsIHR5cGUpOworCVNFVDE2X0EoZXAtPnN0YXJ0X2NsdV9sbywgQ0xVU1RFUl8xNihz
dGFydF9jbHUpKTsKKwlTRVQxNl9BKGVwLT5zdGFydF9jbHVfaGksIENMVVNURVJfMTYoc3RhcnRf
Y2x1ID4+IDE2KSk7CisJU0VUMzJfQShlcC0+c2l6ZSwgMCk7CisKKwl0cCA9IHRtX2N1cnJlbnQo
JnRtKTsKKwlmYXRfc2V0X2VudHJ5X3RpbWUoKHN0cnVjdCBkZW50cnlfdCAqKSBlcCwgdHAsIFRN
X0NSRUFURSk7CisJZmF0X3NldF9lbnRyeV90aW1lKChzdHJ1Y3QgZGVudHJ5X3QgKikgZXAsIHRw
LCBUTV9NT0RJRlkpOworCVNFVDE2X0EoZXAtPmFjY2Vzc19kYXRlLCAwKTsKKwllcC0+Y3JlYXRl
X3RpbWVfbXMgPSAwOworfQorCit2b2lkIGluaXRfZXh0X2VudHJ5KHN0cnVjdCBleHRfZGVudHJ5
X3QgKmVwLCBzMzIgb3JkZXIsIHU4IGNoa3N1bSwgdTE2ICp1bmluYW1lKQoreworCWludCBpOwor
CXU4IGVuZCA9IEZBTFNFOworCisJZmF0X3NldF9lbnRyeV90eXBlKChzdHJ1Y3QgZGVudHJ5X3Qg
KikgZXAsIFRZUEVfRVhURU5EKTsKKwllcC0+b3JkZXIgPSAodTgpIG9yZGVyOworCWVwLT5zeXNp
ZCA9IDA7CisJZXAtPmNoZWNrc3VtID0gY2hrc3VtOworCVNFVDE2X0EoZXAtPnN0YXJ0X2NsdSwg
MCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgMTA7IGkgKz0gMikgeworCQlpZiAoIWVuZCkgeworCQkJ
U0VUMTYoZXAtPnVuaWNvZGVfMF80K2ksICp1bmluYW1lKTsKKwkJCWlmICgqdW5pbmFtZSA9PSAw
eDApCisJCQkJZW5kID0gVFJVRTsKKwkJCWVsc2UKKwkJCQl1bmluYW1lKys7CisJCX0gZWxzZSB7
CisJCQlTRVQxNihlcC0+dW5pY29kZV8wXzQraSwgMHhGRkZGKTsKKwkJfQorCX0KKworCWZvciAo
aSA9IDA7IGkgPCAxMjsgaSArPSAyKSB7CisJCWlmICghZW5kKSB7CisJCQlTRVQxNl9BKGVwLT51
bmljb2RlXzVfMTAgKyBpLCAqdW5pbmFtZSk7CisJCQlpZiAoKnVuaW5hbWUgPT0gMHgwKQorCQkJ
CWVuZCA9IFRSVUU7CisJCQllbHNlCisJCQkJdW5pbmFtZSsrOworCQl9IGVsc2UgeworCQkJU0VU
MTZfQShlcC0+dW5pY29kZV81XzEwICsgaSwgMHhGRkZGKTsKKwkJfQorCX0KKworCWZvciAoaSA9
IDA7IGkgPCA0OyBpICs9IDIpIHsKKwkJaWYgKCFlbmQpIHsKKwkJCVNFVDE2X0EoZXAtPnVuaWNv
ZGVfMTFfMTIgKyBpLCAqdW5pbmFtZSk7CisJCQlpZiAoKnVuaW5hbWUgPT0gMHgwKQorCQkJCWVu
ZCA9IFRSVUU7CisJCQllbHNlCisJCQkJdW5pbmFtZSsrOworCQl9IGVsc2UgeworCQkJU0VUMTZf
QShlcC0+dW5pY29kZV8xMV8xMiArIGksIDB4RkZGRik7CisJCX0KKwl9Cit9CisKK3ZvaWQgaW5p
dF9maWxlX2VudHJ5KHN0cnVjdCBmaWxlX2RlbnRyeV90ICplcCwgdTMyIHR5cGUpCit7CisJc3Ry
dWN0IHRpbWVzdGFtcF90IHRtLCAqdHA7CisKKwlleGZhdF9zZXRfZW50cnlfdHlwZSgoc3RydWN0
IGRlbnRyeV90ICopZXAsIHR5cGUpOworCisJdHAgPSB0bV9jdXJyZW50KCZ0bSk7CisJZXhmYXRf
c2V0X2VudHJ5X3RpbWUoKHN0cnVjdCBkZW50cnlfdCAqKWVwLCB0cCwgVE1fQ1JFQVRFKTsKKwll
eGZhdF9zZXRfZW50cnlfdGltZSgoc3RydWN0IGRlbnRyeV90ICopZXAsIHRwLCBUTV9NT0RJRlkp
OworCWV4ZmF0X3NldF9lbnRyeV90aW1lKChzdHJ1Y3QgZGVudHJ5X3QgKillcCwgdHAsIFRNX0FD
Q0VTUyk7CisJZXAtPmNyZWF0ZV90aW1lX21zID0gMDsKKwllcC0+bW9kaWZ5X3RpbWVfbXMgPSAw
OworCWVwLT5hY2Nlc3NfdGltZV9tcyA9IDA7Cit9CisKK3ZvaWQgaW5pdF9zdHJtX2VudHJ5KHN0
cnVjdCBzdHJtX2RlbnRyeV90ICplcCwgdTggZmxhZ3MsIHUzMiBzdGFydF9jbHUsIHU2NCBzaXpl
KQoreworCWV4ZmF0X3NldF9lbnRyeV90eXBlKChzdHJ1Y3QgZGVudHJ5X3QgKillcCwgVFlQRV9T
VFJFQU0pOworCWVwLT5mbGFncyA9IGZsYWdzOworCVNFVDMyX0EoZXAtPnN0YXJ0X2NsdSwgc3Rh
cnRfY2x1KTsKKwlTRVQ2NF9BKGVwLT52YWxpZF9zaXplLCBzaXplKTsKKwlTRVQ2NF9BKGVwLT5z
aXplLCBzaXplKTsKK30KKwordm9pZCBpbml0X25hbWVfZW50cnkoc3RydWN0IG5hbWVfZGVudHJ5
X3QgKmVwLCB1MTYgKnVuaW5hbWUpCit7CisJaW50IGk7CisKKwlleGZhdF9zZXRfZW50cnlfdHlw
ZSgoc3RydWN0IGRlbnRyeV90ICopZXAsIFRZUEVfRVhURU5EKTsKKwllcC0+ZmxhZ3MgPSAweDA7
CisKKwlmb3IgKGkgPSAwOyBpIDwgMzA7IGkrKywgaSsrKSB7CisJCVNFVDE2X0EoZXAtPnVuaWNv
ZGVfMF8xNCtpLCAqdW5pbmFtZSk7CisJCWlmICgqdW5pbmFtZSA9PSAweDApCisJCQlicmVhazsK
KwkJdW5pbmFtZSsrOworCX0KK30KKwordm9pZCBmYXRfZGVsZXRlX2Rpcl9lbnRyeShzdHJ1Y3Qg
c3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJCXMzMiBlbnRyeSwgczMy
IG9yZGVyLCBzMzIgbnVtX2VudHJpZXMpCit7CisJaW50IGk7CisJc2VjdG9yX3Qgc2VjdG9yOwor
CXN0cnVjdCBkZW50cnlfdCAqZXA7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRf
U0Ioc2IpLT5mc19pbmZvKTsKKworCWZvciAoaSA9IG51bV9lbnRyaWVzLTE7IGkgPj0gb3JkZXI7
IGktLSkgeworCQllcCA9IGdldF9lbnRyeV9pbl9kaXIoc2IsIHBfZGlyLCBlbnRyeS1pLCAmc2Vj
dG9yKTsKKwkJaWYgKCFlcCkKKwkJCXJldHVybjsKKworCQlwX2ZzLT5mc19mdW5jLT5zZXRfZW50
cnlfdHlwZShlcCwgVFlQRV9ERUxFVEVEKTsKKwkJYnVmX21vZGlmeShzYiwgc2VjdG9yKTsKKwl9
Cit9CisKK3ZvaWQgZXhmYXRfZGVsZXRlX2Rpcl9lbnRyeShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
LCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJCXMzMiBlbnRyeSwgczMyIG9yZGVyLCBzMzIgbnVt
X2VudHJpZXMpCit7CisJaW50IGk7CisJc2VjdG9yX3Qgc2VjdG9yOworCXN0cnVjdCBkZW50cnlf
dCAqZXA7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZv
KTsKKworCWZvciAoaSA9IG9yZGVyOyBpIDwgbnVtX2VudHJpZXM7IGkrKykgeworCQllcCA9IGdl
dF9lbnRyeV9pbl9kaXIoc2IsIHBfZGlyLCBlbnRyeStpLCAmc2VjdG9yKTsKKwkJaWYgKCFlcCkK
KwkJCXJldHVybjsKKworCQlwX2ZzLT5mc19mdW5jLT5zZXRfZW50cnlfdHlwZShlcCwgVFlQRV9E
RUxFVEVEKTsKKwkJYnVmX21vZGlmeShzYiwgc2VjdG9yKTsKKwl9Cit9CisKK3ZvaWQgdXBkYXRl
X2Rpcl9jaGVja3N1bShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9k
aXIsCisJCQkgczMyIGVudHJ5KQoreworCWludCBpLCBudW1fZW50cmllczsKKwlzZWN0b3JfdCBz
ZWN0b3I7CisJdTE2IGNoa3N1bTsKKwlzdHJ1Y3QgZmlsZV9kZW50cnlfdCAqZmlsZV9lcDsKKwlz
dHJ1Y3QgZGVudHJ5X3QgKmVwOworCisJZmlsZV9lcCA9IChzdHJ1Y3QgZmlsZV9kZW50cnlfdCAq
KWdldF9lbnRyeV9pbl9kaXIoc2IsIHBfZGlyLCBlbnRyeSwKKwkJCQkJCQkgICAmc2VjdG9yKTsK
KwlpZiAoIWZpbGVfZXApCisJCXJldHVybjsKKworCWJ1Zl9sb2NrKHNiLCBzZWN0b3IpOworCisJ
bnVtX2VudHJpZXMgPSAoczMyKSBmaWxlX2VwLT5udW1fZXh0ICsgMTsKKwljaGtzdW0gPSBjYWxj
X2NoZWNrc3VtXzJieXRlKCh2b2lkICopZmlsZV9lcCwgREVOVFJZX1NJWkUsIDAsCisJCQkJICAg
ICBDU19ESVJfRU5UUlkpOworCisJZm9yIChpID0gMTsgaSA8IG51bV9lbnRyaWVzOyBpKyspIHsK
KwkJZXAgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCBwX2RpciwgZW50cnkraSwgTlVMTCk7CisJCWlm
ICghZXApIHsKKwkJCWJ1Zl91bmxvY2soc2IsIHNlY3Rvcik7CisJCQlyZXR1cm47CisJCX0KKwor
CQljaGtzdW0gPSBjYWxjX2NoZWNrc3VtXzJieXRlKCh2b2lkICopZXAsIERFTlRSWV9TSVpFLCBj
aGtzdW0sCisJCQkJCSAgICAgQ1NfREVGQVVMVCk7CisJfQorCisJU0VUMTZfQShmaWxlX2VwLT5j
aGVja3N1bSwgY2hrc3VtKTsKKwlidWZfbW9kaWZ5KHNiLCBzZWN0b3IpOworCWJ1Zl91bmxvY2so
c2IsIHNlY3Rvcik7Cit9CisKK3ZvaWQgdXBkYXRlX2Rpcl9jaGVja3N1bV93aXRoX2VudHJ5X3Nl
dChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJCQlzdHJ1Y3QgZW50cnlfc2V0X2NhY2hlX3Qg
KmVzKQoreworCXN0cnVjdCBkZW50cnlfdCAqZXA7CisJdTE2IGNoa3N1bSA9IDA7CisJczMyIGNo
a3N1bV90eXBlID0gQ1NfRElSX0VOVFJZLCBpOworCisJZXAgPSAoc3RydWN0IGRlbnRyeV90ICop
Jihlcy0+X19idWYpOworCWZvciAoaSA9IDA7IGkgPCBlcy0+bnVtX2VudHJpZXM7IGkrKykgewor
CQlwcl9kZWJ1ZygiJXMgZXAgJXBcbiIsIF9fZnVuY19fLCBlcCk7CisJCWNoa3N1bSA9IGNhbGNf
Y2hlY2tzdW1fMmJ5dGUoKHZvaWQgKillcCwgREVOVFJZX1NJWkUsIGNoa3N1bSwKKwkJCQkJICAg
ICBjaGtzdW1fdHlwZSk7CisJCWVwKys7CisJCWNoa3N1bV90eXBlID0gQ1NfREVGQVVMVDsKKwl9
CisKKwllcCA9IChzdHJ1Y3QgZGVudHJ5X3QgKikmKGVzLT5fX2J1Zik7CisJU0VUMTZfQSgoKHN0
cnVjdCBmaWxlX2RlbnRyeV90ICopZXApLT5jaGVja3N1bSwgY2hrc3VtKTsKKwl3cml0ZV93aG9s
ZV9lbnRyeV9zZXQoc2IsIGVzKTsKK30KKworc3RhdGljIHMzMiBfd2Fsa19mYXRfY2hhaW4oc3Ry
dWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkJICAgczMyIGJ5
dGVfb2Zmc2V0LCB1MzIgKmNsdSkKK3sKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZB
VF9TQihzYiktPmZzX2luZm8pOworCXMzMiBjbHVfb2Zmc2V0OworCXUzMiBjdXJfY2x1OworCisJ
Y2x1X29mZnNldCA9IGJ5dGVfb2Zmc2V0ID4+IHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzOworCWN1
cl9jbHUgPSBwX2Rpci0+ZGlyOworCisJaWYgKHBfZGlyLT5mbGFncyA9PSAweDAzKSB7CisJCWN1
cl9jbHUgKz0gY2x1X29mZnNldDsKKwl9IGVsc2UgeworCQl3aGlsZSAoY2x1X29mZnNldCA+IDAp
IHsKKwkJCWlmIChGQVRfcmVhZChzYiwgY3VyX2NsdSwgJmN1cl9jbHUpID09IC0xKQorCQkJCXJl
dHVybiBGRlNfTUVESUFFUlI7CisJCQljbHVfb2Zmc2V0LS07CisJCX0KKwl9CisKKwlpZiAoY2x1
KQorCQkqY2x1ID0gY3VyX2NsdTsKKwlyZXR1cm4gRkZTX1NVQ0NFU1M7Cit9CisKK3MzMiBmaW5k
X2xvY2F0aW9uKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2Rpciwg
czMyIGVudHJ5LAorCQkgIHNlY3Rvcl90ICpzZWN0b3IsIHMzMiAqb2Zmc2V0KQoreworCXMzMiBv
ZmYsIHJldDsKKwl1MzIgY2x1ID0gMDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZB
VF9TQihzYiktPmZzX2luZm8pOworCXN0cnVjdCBiZF9pbmZvX3QgKnBfYmQgPSAmKEVYRkFUX1NC
KHNiKS0+YmRfaW5mbyk7CisKKwlvZmYgPSBlbnRyeSA8PCBERU5UUllfU0laRV9CSVRTOworCisJ
aWYgKHBfZGlyLT5kaXIgPT0gQ0xVU1RFUl8zMigwKSkgeyAvKiBGQVQxNiByb290X2RpciAqLwor
CQkqb2Zmc2V0ID0gb2ZmICYgcF9iZC0+c2VjdG9yX3NpemVfbWFzazsKKwkJKnNlY3RvciA9IG9m
ZiA+PiBwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzOworCQkqc2VjdG9yICs9IHBfZnMtPnJvb3Rfc3Rh
cnRfc2VjdG9yOworCX0gZWxzZSB7CisJCXJldCA9IF93YWxrX2ZhdF9jaGFpbihzYiwgcF9kaXIs
IG9mZiwgJmNsdSk7CisJCWlmIChyZXQgIT0gRkZTX1NVQ0NFU1MpCisJCQlyZXR1cm4gcmV0Owor
CisJCS8qIGJ5dGUgb2Zmc2V0IGluIGNsdXN0ZXIgKi8KKwkJb2ZmICY9IHBfZnMtPmNsdXN0ZXJf
c2l6ZSAtIDE7CisKKwkJLyogYnl0ZSBvZmZzZXQgaW4gc2VjdG9yICAgICovCisJCSpvZmZzZXQg
PSBvZmYgJiBwX2JkLT5zZWN0b3Jfc2l6ZV9tYXNrOworCisJCS8qIHNlY3RvciBvZmZzZXQgaW4g
Y2x1c3RlciAqLworCQkqc2VjdG9yID0gb2ZmID4+IHBfYmQtPnNlY3Rvcl9zaXplX2JpdHM7CisJ
CSpzZWN0b3IgKz0gU1RBUlRfU0VDVE9SKGNsdSk7CisJfQorCXJldHVybiBGRlNfU1VDQ0VTUzsK
K30KKworc3RydWN0IGRlbnRyeV90ICpnZXRfZW50cnlfd2l0aF9zZWN0b3Ioc3RydWN0IHN1cGVy
X2Jsb2NrICpzYiwgc2VjdG9yX3Qgc2VjdG9yLAorCQkJCSAgICAgICBzMzIgb2Zmc2V0KQorewor
CXU4ICpidWY7CisKKwlidWYgPSBidWZfZ2V0YmxrKHNiLCBzZWN0b3IpOworCisJaWYgKGJ1ZiA9
PSBOVUxMKQorCQlyZXR1cm4gTlVMTDsKKworCXJldHVybiAoc3RydWN0IGRlbnRyeV90ICopKGJ1
ZiArIG9mZnNldCk7Cit9CisKK3N0cnVjdCBkZW50cnlfdCAqZ2V0X2VudHJ5X2luX2RpcihzdHJ1
Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJCQkJICBzMzIgZW50
cnksIHNlY3Rvcl90ICpzZWN0b3IpCit7CisJczMyIG9mZjsKKwlzZWN0b3JfdCBzZWM7CisJdTgg
KmJ1ZjsKKworCWlmIChmaW5kX2xvY2F0aW9uKHNiLCBwX2RpciwgZW50cnksICZzZWMsICZvZmYp
ICE9IEZGU19TVUNDRVNTKQorCQlyZXR1cm4gTlVMTDsKKworCWJ1ZiA9IGJ1Zl9nZXRibGsoc2Is
IHNlYyk7CisKKwlpZiAoYnVmID09IE5VTEwpCisJCXJldHVybiBOVUxMOworCisJaWYgKHNlY3Rv
ciAhPSBOVUxMKQorCQkqc2VjdG9yID0gc2VjOworCXJldHVybiAoc3RydWN0IGRlbnRyeV90ICop
KGJ1ZiArIG9mZik7Cit9CisKKy8qIHJldHVybnMgYSBzZXQgb2YgZGVudHJpZXMgZm9yIGEgZmls
ZSBvciBkaXIuCisgKiBOb3RlIHRoYXQgdGhpcyBpcyBhIGNvcHkgKGR1bXApIG9mIGRlbnRyaWVz
IHNvIHRoYXQgdXNlciBzaG91bGQgY2FsbCB3cml0ZV9lbnRyeV9zZXQoKQorICogdG8gYXBwbHkg
Y2hhbmdlcyBtYWRlIGluIHRoaXMgZW50cnkgc2V0IHRvIHRoZSByZWFsIGRldmljZS4KKyAqIGlu
OgorICogICBzYitwX2RpcitlbnRyeTogaW5kaWNhdGVzIGEgZmlsZS9kaXIKKyAqICAgdHlwZTog
IHNwZWNpZmllcyBob3cgbWFueSBkZW50cmllcyBzaG91bGQgYmUgaW5jbHVkZWQuCisgKiBvdXQ6
CisgKiAgIGZpbGVfZXA6IHdpbGwgcG9pbnQgdGhlIGZpcnN0IGRlbnRyeSg9IGZpbGUgZGVudHJ5
KSBvbiBzdWNjZXNzCisgKiByZXR1cm46CisgKiAgIHBvaW50ZXIgb2YgZW50cnkgc2V0IG9uIHN1
Y2Nlc3MsCisgKiAgIE5VTEwgb24gZmFpbHVyZS4KKyAqLworCisjZGVmaW5lIEVTX01PREVfU1RB
UlRFRAkJCQkwCisjZGVmaW5lIEVTX01PREVfR0VUX0ZJTEVfRU5UUlkJCQkxCisjZGVmaW5lIEVT
X01PREVfR0VUX1NUUk1fRU5UUlkJCQkyCisjZGVmaW5lIEVTX01PREVfR0VUX05BTUVfRU5UUlkJ
CQkzCisjZGVmaW5lIEVTX01PREVfR0VUX0NSSVRJQ0FMX1NFQ19FTlRSWQkJNAorc3RydWN0IGVu
dHJ5X3NldF9jYWNoZV90ICpnZXRfZW50cnlfc2V0X2luX2RpcihzdHJ1Y3Qgc3VwZXJfYmxvY2sg
KnNiLAorCQkJCQkgICAgICAgc3RydWN0IGNoYWluX3QgKnBfZGlyLCBzMzIgZW50cnksCisJCQkJ
CSAgICAgICB1MzIgdHlwZSwKKwkJCQkJICAgICAgIHN0cnVjdCBkZW50cnlfdCAqKmZpbGVfZXAp
Cit7CisJczMyIG9mZiwgcmV0LCBieXRlX29mZnNldDsKKwl1MzIgY2x1ID0gMDsKKwlzZWN0b3Jf
dCBzZWM7CisJdTMyIGVudHJ5X3R5cGU7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhG
QVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihFWEZBVF9T
QihzYiktPmJkX2luZm8pOworCXN0cnVjdCBlbnRyeV9zZXRfY2FjaGVfdCAqZXMgPSBOVUxMOwor
CXN0cnVjdCBkZW50cnlfdCAqZXAsICpwb3M7CisJdTggKmJ1ZjsKKwl1OCBudW1fZW50cmllczsK
KwlzMzIgbW9kZSA9IEVTX01PREVfU1RBUlRFRDsKKwlzaXplX3QgYnVmc2l6ZTsKKworCXByX2Rl
YnVnKCIlcyBlbnRlcmVkIHBfZGlyIGRpciAldSBmbGFncyAleCBzaXplICVkXG4iLAorCQlfX2Z1
bmNfXywgcF9kaXItPmRpciwgcF9kaXItPmZsYWdzLCBwX2Rpci0+c2l6ZSk7CisKKwlieXRlX29m
ZnNldCA9IGVudHJ5IDw8IERFTlRSWV9TSVpFX0JJVFM7CisJcmV0ID0gX3dhbGtfZmF0X2NoYWlu
KHNiLCBwX2RpciwgYnl0ZV9vZmZzZXQsICZjbHUpOworCWlmIChyZXQgIT0gRkZTX1NVQ0NFU1Mp
CisJCXJldHVybiBOVUxMOworCisKKwkvKiBieXRlIG9mZnNldCBpbiBjbHVzdGVyICovCisJYnl0
ZV9vZmZzZXQgJj0gcF9mcy0+Y2x1c3Rlcl9zaXplIC0gMTsKKworCS8qIGJ5dGUgb2Zmc2V0IGlu
IHNlY3RvciAgICAqLworCW9mZiA9IGJ5dGVfb2Zmc2V0ICYgcF9iZC0+c2VjdG9yX3NpemVfbWFz
azsKKworCS8qIHNlY3RvciBvZmZzZXQgaW4gY2x1c3RlciAqLworCXNlYyA9IGJ5dGVfb2Zmc2V0
ID4+IHBfYmQtPnNlY3Rvcl9zaXplX2JpdHM7CisJc2VjICs9IFNUQVJUX1NFQ1RPUihjbHUpOwor
CisJYnVmID0gYnVmX2dldGJsayhzYiwgc2VjKTsKKwlpZiAoYnVmID09IE5VTEwpCisJCWdvdG8g
ZXJyX291dDsKKworCisJZXAgPSAoc3RydWN0IGRlbnRyeV90ICopKGJ1ZiArIG9mZik7CisJZW50
cnlfdHlwZSA9IHBfZnMtPmZzX2Z1bmMtPmdldF9lbnRyeV90eXBlKGVwKTsKKworCWlmICgoZW50
cnlfdHlwZSAhPSBUWVBFX0ZJTEUpCisJCSYmIChlbnRyeV90eXBlICE9IFRZUEVfRElSKSkKKwkJ
Z290byBlcnJfb3V0OworCisJaWYgKHR5cGUgPT0gRVNfQUxMX0VOVFJJRVMpCisJCW51bV9lbnRy
aWVzID0gKChzdHJ1Y3QgZmlsZV9kZW50cnlfdCAqKWVwKS0+bnVtX2V4dCsxOworCWVsc2UKKwkJ
bnVtX2VudHJpZXMgPSB0eXBlOworCisJYnVmc2l6ZSA9IG9mZnNldG9mKHN0cnVjdCBlbnRyeV9z
ZXRfY2FjaGVfdCwgX19idWYpICsgKG51bV9lbnRyaWVzKSAqCisJCSAgc2l6ZW9mKHN0cnVjdCBk
ZW50cnlfdCk7CisJcHJfZGVidWcoIiVzOiB0cnlpbmcgdG8ga21hbGxvYyAlenggYnl0ZXMgZm9y
ICVkIGVudHJpZXNcbiIsIF9fZnVuY19fLAorCQkgYnVmc2l6ZSwgbnVtX2VudHJpZXMpOworCWVz
ID0ga21hbGxvYyhidWZzaXplLCBHRlBfS0VSTkVMKTsKKwlpZiAoZXMgPT0gTlVMTCkKKwkJZ290
byBlcnJfb3V0OworCisJZXMtPm51bV9lbnRyaWVzID0gbnVtX2VudHJpZXM7CisJZXMtPnNlY3Rv
ciA9IHNlYzsKKwllcy0+b2Zmc2V0ID0gb2ZmOworCWVzLT5hbGxvY19mbGFnID0gcF9kaXItPmZs
YWdzOworCisJcG9zID0gKHN0cnVjdCBkZW50cnlfdCAqKSAmKGVzLT5fX2J1Zik7CisKKwl3aGls
ZSAobnVtX2VudHJpZXMpIHsKKwkJLyoKKwkJICogaW5zdGVhZCBvZiBjb3B5aW5nIHdob2xlIHNl
Y3Rvciwgd2Ugd2lsbCBjaGVjayBldmVyeSBlbnRyeS4KKwkJICogdGhpcyB3aWxsIHByb3ZpZGUg
bWluaW11bSBzdGFibGl0eSBhbmQgY29uc2lzdGFuY3kuCisJCSAqLworCQllbnRyeV90eXBlID0g
cF9mcy0+ZnNfZnVuYy0+Z2V0X2VudHJ5X3R5cGUoZXApOworCisJCWlmICgoZW50cnlfdHlwZSA9
PSBUWVBFX1VOVVNFRCkgfHwgKGVudHJ5X3R5cGUgPT0gVFlQRV9ERUxFVEVEKSkKKwkJCWdvdG8g
ZXJyX291dDsKKworCQlzd2l0Y2ggKG1vZGUpIHsKKwkJY2FzZSBFU19NT0RFX1NUQVJURUQ6CisJ
CQlpZiAoKGVudHJ5X3R5cGUgPT0gVFlQRV9GSUxFKSB8fCAoZW50cnlfdHlwZSA9PSBUWVBFX0RJ
UikpCisJCQkJbW9kZSA9IEVTX01PREVfR0VUX0ZJTEVfRU5UUlk7CisJCQllbHNlCisJCQkJZ290
byBlcnJfb3V0OworCQkJYnJlYWs7CisJCWNhc2UgRVNfTU9ERV9HRVRfRklMRV9FTlRSWToKKwkJ
CWlmIChlbnRyeV90eXBlID09IFRZUEVfU1RSRUFNKQorCQkJCW1vZGUgPSBFU19NT0RFX0dFVF9T
VFJNX0VOVFJZOworCQkJZWxzZQorCQkJCWdvdG8gZXJyX291dDsKKwkJCWJyZWFrOworCQljYXNl
IEVTX01PREVfR0VUX1NUUk1fRU5UUlk6CisJCQlpZiAoZW50cnlfdHlwZSA9PSBUWVBFX0VYVEVO
RCkKKwkJCQltb2RlID0gRVNfTU9ERV9HRVRfTkFNRV9FTlRSWTsKKwkJCWVsc2UKKwkJCQlnb3Rv
IGVycl9vdXQ7CisJCQlicmVhazsKKwkJY2FzZSBFU19NT0RFX0dFVF9OQU1FX0VOVFJZOgorCQkJ
aWYgKGVudHJ5X3R5cGUgPT0gVFlQRV9FWFRFTkQpCisJCQkJYnJlYWs7CisJCQllbHNlIGlmIChl
bnRyeV90eXBlID09IFRZUEVfU1RSRUFNKQorCQkJCWdvdG8gZXJyX291dDsKKwkJCWVsc2UgaWYg
KGVudHJ5X3R5cGUgJiBUWVBFX0NSSVRJQ0FMX1NFQykKKwkJCQltb2RlID0gRVNfTU9ERV9HRVRf
Q1JJVElDQUxfU0VDX0VOVFJZOworCQkJZWxzZQorCQkJCWdvdG8gZXJyX291dDsKKwkJCWJyZWFr
OworCQljYXNlIEVTX01PREVfR0VUX0NSSVRJQ0FMX1NFQ19FTlRSWToKKwkJCWlmICgoZW50cnlf
dHlwZSA9PSBUWVBFX0VYVEVORCkgfHwKKwkJCSAgICAoZW50cnlfdHlwZSA9PSBUWVBFX1NUUkVB
TSkpCisJCQkJZ290byBlcnJfb3V0OworCQkJZWxzZSBpZiAoKGVudHJ5X3R5cGUgJiBUWVBFX0NS
SVRJQ0FMX1NFQykgIT0KKwkJCQkgVFlQRV9DUklUSUNBTF9TRUMpCisJCQkJZ290byBlcnJfb3V0
OworCQkJYnJlYWs7CisJCX0KKworCQltZW1jcHkocG9zLCBlcCwgc2l6ZW9mKHN0cnVjdCBkZW50
cnlfdCkpOworCisJCWlmICgtLW51bV9lbnRyaWVzID09IDApCisJCQlicmVhazsKKworCQlpZiAo
KChvZmYgKyBERU5UUllfU0laRSkgJiBwX2JkLT5zZWN0b3Jfc2l6ZV9tYXNrKSA8CisJCSAgICAo
b2ZmICYgIHBfYmQtPnNlY3Rvcl9zaXplX21hc2spKSB7CisJCQkvKiBnZXQgdGhlIG5leHQgc2Vj
dG9yICovCisJCQlpZiAoSVNfTEFTVF9TRUNUT1JfSU5fQ0xVU1RFUihzZWMpKSB7CisJCQkJaWYg
KGVzLT5hbGxvY19mbGFnID09IDB4MDMpIHsKKwkJCQkJY2x1Kys7CisJCQkJfSBlbHNlIHsKKwkJ
CQkJaWYgKEZBVF9yZWFkKHNiLCBjbHUsICZjbHUpID09IC0xKQorCQkJCQkJZ290byBlcnJfb3V0
OworCQkJCX0KKwkJCQlzZWMgPSBTVEFSVF9TRUNUT1IoY2x1KTsKKwkJCX0gZWxzZSB7CisJCQkJ
c2VjKys7CisJCQl9CisJCQlidWYgPSBidWZfZ2V0YmxrKHNiLCBzZWMpOworCQkJaWYgKGJ1ZiA9
PSBOVUxMKQorCQkJCWdvdG8gZXJyX291dDsKKwkJCW9mZiA9IDA7CisJCQllcCA9IChzdHJ1Y3Qg
ZGVudHJ5X3QgKikoYnVmKTsKKwkJfSBlbHNlIHsKKwkJCWVwKys7CisJCQlvZmYgKz0gREVOVFJZ
X1NJWkU7CisJCX0KKwkJcG9zKys7CisJfQorCisJaWYgKGZpbGVfZXApCisJCSpmaWxlX2VwID0g
KHN0cnVjdCBkZW50cnlfdCAqKSYoZXMtPl9fYnVmKTsKKworCXByX2RlYnVnKCIlcyBleGl0aW5n
IGVzICVwIHNlYyAlbGx1IG9mZnNldCAlZCBmbGFncyAlZCwgbnVtX2VudHJpZXMgJXUgYnVmIHB0
ciAlcFxuIiwKKwkJICAgX19mdW5jX18sIGVzLCAodW5zaWduZWQgbG9uZyBsb25nKWVzLT5zZWN0
b3IsIGVzLT5vZmZzZXQsCisJCSAgIGVzLT5hbGxvY19mbGFnLCBlcy0+bnVtX2VudHJpZXMsICZl
cy0+X19idWYpOworCXJldHVybiBlczsKK2Vycl9vdXQ6CisJcHJfZGVidWcoIiVzIGV4aXRlZCBO
VUxMIChlcyAlcClcbiIsIF9fZnVuY19fLCBlcyk7CisJa2ZyZWUoZXMpOworCXJldHVybiBOVUxM
OworfQorCit2b2lkIHJlbGVhc2VfZW50cnlfc2V0KHN0cnVjdCBlbnRyeV9zZXRfY2FjaGVfdCAq
ZXMpCit7CisJcHJfZGVidWcoIiVzIGVzPSVwXG4iLCBfX2Z1bmNfXywgZXMpOworCWtmcmVlKGVz
KTsKK30KKworCitzdGF0aWMgczMyIF9fd3JpdGVfcGFydGlhbF9lbnRyaWVzX2luX2VudHJ5X3Nl
dChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJCQkJc3RydWN0IGVudHJ5X3NldF9jYWNoZV90
ICplcywKKwkJCQkJCXNlY3Rvcl90IHNlYywgczMyIG9mZiwgdTMyIGNvdW50KQoreworCXMzMiBu
dW1fZW50cmllcywgYnVmX29mZiA9IChvZmYgLSBlcy0+b2Zmc2V0KTsKKwl1MzIgcmVtYWluaW5n
X2J5dGVfaW5fc2VjdG9yLCBjb3B5X2VudHJpZXM7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9
ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihF
WEZBVF9TQihzYiktPmJkX2luZm8pOworCXUzMiBjbHU7CisJdTggKmJ1ZiwgKmVzYnVmID0gKHU4
ICopJihlcy0+X19idWYpOworCisJcHJfZGVidWcoIiVzIGVudGVyZWQgZXMgJXAgc2VjICVsbHUg
b2ZmICVkIGNvdW50ICVkXG4iLAorCQlfX2Z1bmNfXywgZXMsICh1bnNpZ25lZCBsb25nIGxvbmcp
c2VjLCBvZmYsIGNvdW50KTsKKwludW1fZW50cmllcyA9IGNvdW50OworCisJd2hpbGUgKG51bV9l
bnRyaWVzKSB7CisJCS8qIHdoaXRlIHBlciBzZWN0b3IgYmFzZSAqLworCQlyZW1haW5pbmdfYnl0
ZV9pbl9zZWN0b3IgPSAoMSA8PCBwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzKSAtIG9mZjsKKwkJY29w
eV9lbnRyaWVzID0gbWluX3QoczMyLAorCQkJCSAgICAgcmVtYWluaW5nX2J5dGVfaW5fc2VjdG9y
ID4+IERFTlRSWV9TSVpFX0JJVFMsCisJCQkJICAgICBudW1fZW50cmllcyk7CisJCWJ1ZiA9IGJ1
Zl9nZXRibGsoc2IsIHNlYyk7CisJCWlmIChidWYgPT0gTlVMTCkKKwkJCWdvdG8gZXJyX291dDsK
KwkJcHJfZGVidWcoImVzLT5idWYgJXAgYnVmX29mZiAldVxuIiwgZXNidWYsIGJ1Zl9vZmYpOwor
CQlwcl9kZWJ1ZygiY29weWluZyAlZCBlbnRyaWVzIGZyb20gJXAgdG8gc2VjdG9yICVsbHVcbiIs
CisJCQljb3B5X2VudHJpZXMsIChlc2J1ZiArIGJ1Zl9vZmYpLAorCQkJKHVuc2lnbmVkIGxvbmcg
bG9uZylzZWMpOworCQltZW1jcHkoYnVmICsgb2ZmLCBlc2J1ZiArIGJ1Zl9vZmYsCisJCSAgICAg
ICBjb3B5X2VudHJpZXMgPDwgREVOVFJZX1NJWkVfQklUUyk7CisJCWJ1Zl9tb2RpZnkoc2IsIHNl
Yyk7CisJCW51bV9lbnRyaWVzIC09IGNvcHlfZW50cmllczsKKworCQlpZiAobnVtX2VudHJpZXMp
IHsKKwkJCS8qIGdldCBuZXh0IHNlY3RvciAqLworCQkJaWYgKElTX0xBU1RfU0VDVE9SX0lOX0NM
VVNURVIoc2VjKSkgeworCQkJCWNsdSA9IEdFVF9DTFVTVEVSX0ZST01fU0VDVE9SKHNlYyk7CisJ
CQkJaWYgKGVzLT5hbGxvY19mbGFnID09IDB4MDMpIHsKKwkJCQkJY2x1Kys7CisJCQkJfSBlbHNl
IHsKKwkJCQkJaWYgKEZBVF9yZWFkKHNiLCBjbHUsICZjbHUpID09IC0xKQorCQkJCQkJZ290byBl
cnJfb3V0OworCQkJCX0KKwkJCQlzZWMgPSBTVEFSVF9TRUNUT1IoY2x1KTsKKwkJCX0gZWxzZSB7
CisJCQkJc2VjKys7CisJCQl9CisJCQlvZmYgPSAwOworCQkJYnVmX29mZiArPSBjb3B5X2VudHJp
ZXMgPDwgREVOVFJZX1NJWkVfQklUUzsKKwkJfQorCX0KKworCXByX2RlYnVnKCIlcyBleGl0ZWQg
c3VjY2Vzc2Z1bGx5XG4iLCBfX2Z1bmNfXyk7CisJcmV0dXJuIEZGU19TVUNDRVNTOworZXJyX291
dDoKKwlwcl9kZWJ1ZygiJXMgZmFpbGVkXG4iLCBfX2Z1bmNfXyk7CisJcmV0dXJuIEZGU19FUlJP
UjsKK30KKworLyogd3JpdGUgYmFjayBhbGwgZW50cmllcyBpbiBlbnRyeSBzZXQgKi8KK3MzMiB3
cml0ZV93aG9sZV9lbnRyeV9zZXQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGVudHJ5
X3NldF9jYWNoZV90ICplcykKK3sKKwlyZXR1cm4gX193cml0ZV9wYXJ0aWFsX2VudHJpZXNfaW5f
ZW50cnlfc2V0KHNiLCBlcywgZXMtPnNlY3RvciwKKwkJCQkJCSAgICBlcy0+b2Zmc2V0LAorCQkJ
CQkJICAgIGVzLT5udW1fZW50cmllcyk7Cit9CisKKy8qIHdyaXRlIGJhY2sgc29tZSBlbnRyaWVz
IGluIGVudHJ5IHNldCAqLworczMyIHdyaXRlX3BhcnRpYWxfZW50cmllc19pbl9lbnRyeV9zZXQo
c3RydWN0IHN1cGVyX2Jsb2NrICpzYiwKKwlzdHJ1Y3QgZW50cnlfc2V0X2NhY2hlX3QgKmVzLCBz
dHJ1Y3QgZGVudHJ5X3QgKmVwLCB1MzIgY291bnQpCit7CisJczMyIHJldCwgYnl0ZV9vZmZzZXQs
IG9mZjsKKwl1MzIgY2x1ID0gMDsKKwlzZWN0b3JfdCBzZWM7CisJc3RydWN0IGZzX2luZm9fdCAq
cF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2Jk
ID0gJihFWEZBVF9TQihzYiktPmJkX2luZm8pOworCXN0cnVjdCBjaGFpbl90IGRpcjsKKworCS8q
IHZhaWRpdHkgY2hlY2sgKi8KKwlpZiAoZXAgKyBjb3VudCAgPiAoKHN0cnVjdCBkZW50cnlfdCAq
KSYoZXMtPl9fYnVmKSkgKyBlcy0+bnVtX2VudHJpZXMpCisJCXJldHVybiBGRlNfRVJST1I7CisK
KwlkaXIuZGlyID0gR0VUX0NMVVNURVJfRlJPTV9TRUNUT1IoZXMtPnNlY3Rvcik7CisJZGlyLmZs
YWdzID0gZXMtPmFsbG9jX2ZsYWc7CisJZGlyLnNpemUgPSAweGZmZmZmZmZmOwkJLyogWFhYICov
CisKKwlieXRlX29mZnNldCA9IChlcy0+c2VjdG9yIC0gU1RBUlRfU0VDVE9SKGRpci5kaXIpKSA8
PAorCQkJcF9iZC0+c2VjdG9yX3NpemVfYml0czsKKwlieXRlX29mZnNldCArPSAoKHZvaWQgKiop
ZXAgLSAmKGVzLT5fX2J1ZikpICsgZXMtPm9mZnNldDsKKworCXJldCA9IF93YWxrX2ZhdF9jaGFp
bihzYiwgJmRpciwgYnl0ZV9vZmZzZXQsICZjbHUpOworCWlmIChyZXQgIT0gRkZTX1NVQ0NFU1Mp
CisJCXJldHVybiByZXQ7CisKKwkvKiBieXRlIG9mZnNldCBpbiBjbHVzdGVyICovCisJYnl0ZV9v
ZmZzZXQgJj0gcF9mcy0+Y2x1c3Rlcl9zaXplIC0gMTsKKworCS8qIGJ5dGUgb2Zmc2V0IGluIHNl
Y3RvciAgICAqLworCW9mZiA9IGJ5dGVfb2Zmc2V0ICYgcF9iZC0+c2VjdG9yX3NpemVfbWFzazsK
KworCS8qIHNlY3RvciBvZmZzZXQgaW4gY2x1c3RlciAqLworCXNlYyA9IGJ5dGVfb2Zmc2V0ID4+
IHBfYmQtPnNlY3Rvcl9zaXplX2JpdHM7CisJc2VjICs9IFNUQVJUX1NFQ1RPUihjbHUpOworCXJl
dHVybiBfX3dyaXRlX3BhcnRpYWxfZW50cmllc19pbl9lbnRyeV9zZXQoc2IsIGVzLCBzZWMsIG9m
ZiwgY291bnQpOworfQorCisvKiBzZWFyY2ggRU1QVFkgQ09OVElOVU9VUyAibnVtX2VudHJpZXMi
IGVudHJpZXMgKi8KK3MzMiBzZWFyY2hfZGVsZXRlZF9vcl91bnVzZWRfZW50cnkoc3RydWN0IHN1
cGVyX2Jsb2NrICpzYiwKKwkJCQkgICBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsIHMzMiBudW1fZW50
cmllcykKK3sKKwlpbnQgaSwgZGVudHJ5LCBudW1fZW1wdHkgPSAwOworCXMzMiBkZW50cmllc19w
ZXJfY2x1OworCXUzMiB0eXBlOworCXN0cnVjdCBjaGFpbl90IGNsdTsKKwlzdHJ1Y3QgZGVudHJ5
X3QgKmVwOworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5m
byk7CisKKwlpZiAocF9kaXItPmRpciA9PSBDTFVTVEVSXzMyKDApKSAvKiBGQVQxNiByb290X2Rp
ciAqLworCQlkZW50cmllc19wZXJfY2x1ID0gcF9mcy0+ZGVudHJpZXNfaW5fcm9vdDsKKwllbHNl
CisJCWRlbnRyaWVzX3Blcl9jbHUgPSBwX2ZzLT5kZW50cmllc19wZXJfY2x1OworCisJaWYgKHBf
ZnMtPmhpbnRfdWVudHJ5LmRpciA9PSBwX2Rpci0+ZGlyKSB7CisJCWlmIChwX2ZzLT5oaW50X3Vl
bnRyeS5lbnRyeSA9PSAtMSkKKwkJCXJldHVybiAtMTsKKworCQljbHUuZGlyID0gcF9mcy0+aGlu
dF91ZW50cnkuY2x1LmRpcjsKKwkJY2x1LnNpemUgPSBwX2ZzLT5oaW50X3VlbnRyeS5jbHUuc2l6
ZTsKKwkJY2x1LmZsYWdzID0gcF9mcy0+aGludF91ZW50cnkuY2x1LmZsYWdzOworCisJCWRlbnRy
eSA9IHBfZnMtPmhpbnRfdWVudHJ5LmVudHJ5OworCX0gZWxzZSB7CisJCXBfZnMtPmhpbnRfdWVu
dHJ5LmVudHJ5ID0gLTE7CisKKwkJY2x1LmRpciA9IHBfZGlyLT5kaXI7CisJCWNsdS5zaXplID0g
cF9kaXItPnNpemU7CisJCWNsdS5mbGFncyA9IHBfZGlyLT5mbGFnczsKKworCQlkZW50cnkgPSAw
OworCX0KKworCXdoaWxlIChjbHUuZGlyICE9IENMVVNURVJfMzIofjApKSB7CisJCWlmIChwX2Zz
LT5kZXZfZWplY3RlZCkKKwkJCWJyZWFrOworCisJCWlmIChwX2Rpci0+ZGlyID09IENMVVNURVJf
MzIoMCkpIC8qIEZBVDE2IHJvb3RfZGlyICovCisJCQlpID0gZGVudHJ5ICUgZGVudHJpZXNfcGVy
X2NsdTsKKwkJZWxzZQorCQkJaSA9IGRlbnRyeSAmIChkZW50cmllc19wZXJfY2x1LTEpOworCisJ
CWZvciAoOyBpIDwgZGVudHJpZXNfcGVyX2NsdTsgaSsrLCBkZW50cnkrKykgeworCQkJZXAgPSBn
ZXRfZW50cnlfaW5fZGlyKHNiLCAmY2x1LCBpLCBOVUxMKTsKKwkJCWlmICghZXApCisJCQkJcmV0
dXJuIC0xOworCisJCQl0eXBlID0gcF9mcy0+ZnNfZnVuYy0+Z2V0X2VudHJ5X3R5cGUoZXApOwor
CisJCQlpZiAodHlwZSA9PSBUWVBFX1VOVVNFRCkgeworCQkJCW51bV9lbXB0eSsrOworCQkJCWlm
IChwX2ZzLT5oaW50X3VlbnRyeS5lbnRyeSA9PSAtMSkgeworCQkJCQlwX2ZzLT5oaW50X3VlbnRy
eS5kaXIgPSBwX2Rpci0+ZGlyOworCQkJCQlwX2ZzLT5oaW50X3VlbnRyeS5lbnRyeSA9IGRlbnRy
eTsKKworCQkJCQlwX2ZzLT5oaW50X3VlbnRyeS5jbHUuZGlyID0gY2x1LmRpcjsKKwkJCQkJcF9m
cy0+aGludF91ZW50cnkuY2x1LnNpemUgPSBjbHUuc2l6ZTsKKwkJCQkJcF9mcy0+aGludF91ZW50
cnkuY2x1LmZsYWdzID0gY2x1LmZsYWdzOworCQkJCX0KKwkJCX0gZWxzZSBpZiAodHlwZSA9PSBU
WVBFX0RFTEVURUQpIHsKKwkJCQludW1fZW1wdHkrKzsKKwkJCX0gZWxzZSB7CisJCQkJbnVtX2Vt
cHR5ID0gMDsKKwkJCX0KKworCQkJaWYgKG51bV9lbXB0eSA+PSBudW1fZW50cmllcykgeworCQkJ
CXBfZnMtPmhpbnRfdWVudHJ5LmRpciA9IENMVVNURVJfMzIofjApOworCQkJCXBfZnMtPmhpbnRf
dWVudHJ5LmVudHJ5ID0gLTE7CisKKwkJCQlpZiAocF9mcy0+dm9sX3R5cGUgPT0gRVhGQVQpCisJ
CQkJCXJldHVybiBkZW50cnkgLSAobnVtX2VudHJpZXMtMSk7CisJCQkJZWxzZQorCQkJCQlyZXR1
cm4gZGVudHJ5OworCQkJfQorCQl9CisKKwkJaWYgKHBfZGlyLT5kaXIgPT0gQ0xVU1RFUl8zMigw
KSkKKwkJCWJyZWFrOyAvKiBGQVQxNiByb290X2RpciAqLworCisJCWlmIChjbHUuZmxhZ3MgPT0g
MHgwMykgeworCQkJaWYgKCgtLWNsdS5zaXplKSA+IDApCisJCQkJY2x1LmRpcisrOworCQkJZWxz
ZQorCQkJCWNsdS5kaXIgPSBDTFVTVEVSXzMyKH4wKTsKKwkJfSBlbHNlIHsKKwkJCWlmIChGQVRf
cmVhZChzYiwgY2x1LmRpciwgJmNsdS5kaXIpICE9IDApCisJCQkJcmV0dXJuIC0xOworCQl9CisJ
fQorCisJcmV0dXJuIC0xOworfQorCitzMzIgZmluZF9lbXB0eV9lbnRyeShzdHJ1Y3QgaW5vZGUg
Kmlub2RlLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsIHMzMiBudW1fZW50cmllcykKK3sKKwlzMzIg
cmV0LCBkZW50cnk7CisJdTMyIGxhc3RfY2x1OworCXNlY3Rvcl90IHNlY3RvcjsKKwl1NjQgc2l6
ZSA9IDA7CisJc3RydWN0IGNoYWluX3QgY2x1OworCXN0cnVjdCBkZW50cnlfdCAqZXAgPSBOVUxM
OworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKKwlzdHJ1Y3QgZnNfaW5m
b190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0cnVjdCBmaWxlX2lkX3Qg
KmZpZCA9ICYoRVhGQVRfSShpbm9kZSktPmZpZCk7CisKKwlpZiAocF9kaXItPmRpciA9PSBDTFVT
VEVSXzMyKDApKSAvKiBGQVQxNiByb290X2RpciAqLworCQlyZXR1cm4gc2VhcmNoX2RlbGV0ZWRf
b3JfdW51c2VkX2VudHJ5KHNiLCBwX2RpciwgbnVtX2VudHJpZXMpOworCisJd2hpbGUgKChkZW50
cnkgPSBzZWFyY2hfZGVsZXRlZF9vcl91bnVzZWRfZW50cnkoc2IsIHBfZGlyLCBudW1fZW50cmll
cykpIDwgMCkgeworCQlpZiAocF9mcy0+ZGV2X2VqZWN0ZWQpCisJCQlicmVhazsKKworCQlpZiAo
cF9mcy0+dm9sX3R5cGUgPT0gRVhGQVQpIHsKKwkJCWlmIChwX2Rpci0+ZGlyICE9IHBfZnMtPnJv
b3RfZGlyKQorCQkJCXNpemUgPSBpX3NpemVfcmVhZChpbm9kZSk7CisJCX0KKworCQlsYXN0X2Ns
dSA9IGZpbmRfbGFzdF9jbHVzdGVyKHNiLCBwX2Rpcik7CisJCWNsdS5kaXIgPSBsYXN0X2NsdSAr
IDE7CisJCWNsdS5zaXplID0gMDsKKwkJY2x1LmZsYWdzID0gcF9kaXItPmZsYWdzOworCisJCS8q
ICgxKSBhbGxvY2F0ZSBhIGNsdXN0ZXIgKi8KKwkJcmV0ID0gcF9mcy0+ZnNfZnVuYy0+YWxsb2Nf
Y2x1c3RlcihzYiwgMSwgJmNsdSk7CisJCWlmIChyZXQgPCAxKQorCQkJcmV0dXJuIC0xOworCisJ
CWlmIChjbGVhcl9jbHVzdGVyKHNiLCBjbHUuZGlyKSAhPSBGRlNfU1VDQ0VTUykKKwkJCXJldHVy
biAtMTsKKworCQkvKiAoMikgYXBwZW5kIHRvIHRoZSBGQVQgY2hhaW4gKi8KKwkJaWYgKGNsdS5m
bGFncyAhPSBwX2Rpci0+ZmxhZ3MpIHsKKwkJCWV4ZmF0X2NoYWluX2NvbnRfY2x1c3RlcihzYiwg
cF9kaXItPmRpciwgcF9kaXItPnNpemUpOworCQkJcF9kaXItPmZsYWdzID0gMHgwMTsKKwkJCXBf
ZnMtPmhpbnRfdWVudHJ5LmNsdS5mbGFncyA9IDB4MDE7CisJCX0KKwkJaWYgKGNsdS5mbGFncyA9
PSAweDAxKQorCQkJaWYgKEZBVF93cml0ZShzYiwgbGFzdF9jbHUsIGNsdS5kaXIpIDwgMCkKKwkJ
CQlyZXR1cm4gLTE7CisKKwkJaWYgKHBfZnMtPmhpbnRfdWVudHJ5LmVudHJ5ID09IC0xKSB7CisJ
CQlwX2ZzLT5oaW50X3VlbnRyeS5kaXIgPSBwX2Rpci0+ZGlyOworCQkJcF9mcy0+aGludF91ZW50
cnkuZW50cnkgPSBwX2Rpci0+c2l6ZSA8PCAocF9mcy0+Y2x1c3Rlcl9zaXplX2JpdHMgLSBERU5U
UllfU0laRV9CSVRTKTsKKworCQkJcF9mcy0+aGludF91ZW50cnkuY2x1LmRpciA9IGNsdS5kaXI7
CisJCQlwX2ZzLT5oaW50X3VlbnRyeS5jbHUuc2l6ZSA9IDA7CisJCQlwX2ZzLT5oaW50X3VlbnRy
eS5jbHUuZmxhZ3MgPSBjbHUuZmxhZ3M7CisJCX0KKwkJcF9mcy0+aGludF91ZW50cnkuY2x1LnNp
emUrKzsKKwkJcF9kaXItPnNpemUrKzsKKworCQkvKiAoMykgdXBkYXRlIHRoZSBkaXJlY3Rvcnkg
ZW50cnkgKi8KKwkJaWYgKHBfZnMtPnZvbF90eXBlID09IEVYRkFUKSB7CisJCQlpZiAocF9kaXIt
PmRpciAhPSBwX2ZzLT5yb290X2RpcikgeworCQkJCXNpemUgKz0gcF9mcy0+Y2x1c3Rlcl9zaXpl
OworCisJCQkJZXAgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCAmZmlkLT5kaXIsCisJCQkJCQkgICAg
ICBmaWQtPmVudHJ5ICsgMSwgJnNlY3Rvcik7CisJCQkJaWYgKCFlcCkKKwkJCQkJcmV0dXJuIC0x
OworCQkJCXBfZnMtPmZzX2Z1bmMtPnNldF9lbnRyeV9zaXplKGVwLCBzaXplKTsKKwkJCQlwX2Zz
LT5mc19mdW5jLT5zZXRfZW50cnlfZmxhZyhlcCwgcF9kaXItPmZsYWdzKTsKKwkJCQlidWZfbW9k
aWZ5KHNiLCBzZWN0b3IpOworCisJCQkJdXBkYXRlX2Rpcl9jaGVja3N1bShzYiwgJihmaWQtPmRp
ciksCisJCQkJCQkgICAgZmlkLT5lbnRyeSk7CisJCQl9CisJCX0KKworCQlpX3NpemVfd3JpdGUo
aW5vZGUsIGlfc2l6ZV9yZWFkKGlub2RlKStwX2ZzLT5jbHVzdGVyX3NpemUpOworCQlFWEZBVF9J
KGlub2RlKS0+bW11X3ByaXZhdGUgKz0gcF9mcy0+Y2x1c3Rlcl9zaXplOworCQlFWEZBVF9JKGlu
b2RlKS0+ZmlkLnNpemUgKz0gcF9mcy0+Y2x1c3Rlcl9zaXplOworCQlFWEZBVF9JKGlub2RlKS0+
ZmlkLmZsYWdzID0gcF9kaXItPmZsYWdzOworCQlpbm9kZS0+aV9ibG9ja3MgKz0gMSA8PCAocF9m
cy0+Y2x1c3Rlcl9zaXplX2JpdHMgLSA5KTsKKwl9CisKKwlyZXR1cm4gZGVudHJ5OworfQorCisv
KiByZXR1cm4gdmFsdWVzIG9mIGZhdF9maW5kX2Rpcl9lbnRyeSgpCisgKiA+PSAwIDogcmV0dXJu
IGRpciBlbnRpcnkgcG9zaXRpb24gd2l0aCB0aGUgbmFtZSBpbiBkaXIKKyAqIC0xIDogKHJvb3Qg
ZGlyLCAiLiIpIGl0IGlzIHRoZSByb290IGRpciBpdHNlbGYKKyAqIC0yIDogZW50cnkgd2l0aCB0
aGUgbmFtZSBkb2VzIG5vdCBleGlzdAorICovCitzMzIgZmF0X2ZpbmRfZGlyX2VudHJ5KHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJICAgICAgIHN0cnVj
dCB1bmlfbmFtZV90ICpwX3VuaW5hbWUsIHMzMiBudW1fZW50cmllcywKKwkJICAgICAgIHN0cnVj
dCBkb3NfbmFtZV90ICpwX2Rvc25hbWUsIHUzMiB0eXBlKQoreworCWludCBpLCBkZW50cnkgPSAw
LCBsb3NzeSA9IEZBTFNFLCBsZW47CisJczMyIG9yZGVyID0gMCwgaXNfZmVhc2libGVfZW50cnkg
PSBUUlVFLCBoYXNfZXh0X2VudHJ5ID0gRkFMU0U7CisJczMyIGRlbnRyaWVzX3Blcl9jbHU7CisJ
dTMyIGVudHJ5X3R5cGU7CisJdTE2IGVudHJ5X3VuaW5hbWVbMTRdLCAqdW5pbmFtZSA9IE5VTEws
IHVuaWNoYXI7CisJc3RydWN0IGNoYWluX3QgY2x1OworCXN0cnVjdCBkZW50cnlfdCAqZXA7CisJ
c3RydWN0IGRvc19kZW50cnlfdCAqZG9zX2VwOworCXN0cnVjdCBleHRfZGVudHJ5X3QgKmV4dF9l
cDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOwor
CisJaWYgKHBfZGlyLT5kaXIgPT0gcF9mcy0+cm9vdF9kaXIpIHsKKwkJaWYgKCghbmxzX3VuaW5h
bWVfY21wKHNiLCBwX3VuaW5hbWUtPm5hbWUsCisJCQkJICAgICAgKHUxNiAqKVVOSV9DVVJfRElS
X05BTUUpKSB8fAorCQkJKCFubHNfdW5pbmFtZV9jbXAoc2IsIHBfdW5pbmFtZS0+bmFtZSwKKwkJ
CQkJICAodTE2ICopVU5JX1BBUl9ESVJfTkFNRSkpKQorCQkJcmV0dXJuIC0xOyAvLyBzcGVjaWFs
IGNhc2UsIHJvb3QgZGlyZWN0b3J5IGl0c2VsZgorCX0KKworCWlmIChwX2Rpci0+ZGlyID09IENM
VVNURVJfMzIoMCkpIC8qIEZBVDE2IHJvb3RfZGlyICovCisJCWRlbnRyaWVzX3Blcl9jbHUgPSBw
X2ZzLT5kZW50cmllc19pbl9yb290OworCWVsc2UKKwkJZGVudHJpZXNfcGVyX2NsdSA9IHBfZnMt
PmRlbnRyaWVzX3Blcl9jbHU7CisKKwljbHUuZGlyID0gcF9kaXItPmRpcjsKKwljbHUuZmxhZ3Mg
PSBwX2Rpci0+ZmxhZ3M7CisKKwl3aGlsZSAoY2x1LmRpciAhPSBDTFVTVEVSXzMyKH4wKSkgewor
CQlpZiAocF9mcy0+ZGV2X2VqZWN0ZWQpCisJCQlicmVhazsKKworCQlmb3IgKGkgPSAwOyBpIDwg
ZGVudHJpZXNfcGVyX2NsdTsgaSsrLCBkZW50cnkrKykgeworCQkJZXAgPSBnZXRfZW50cnlfaW5f
ZGlyKHNiLCAmY2x1LCBpLCBOVUxMKTsKKwkJCWlmICghZXApCisJCQkJcmV0dXJuIC0yOworCisJ
CQllbnRyeV90eXBlID0gcF9mcy0+ZnNfZnVuYy0+Z2V0X2VudHJ5X3R5cGUoZXApOworCisJCQlp
ZiAoKGVudHJ5X3R5cGUgPT0gVFlQRV9GSUxFKSB8fCAoZW50cnlfdHlwZSA9PSBUWVBFX0RJUikp
IHsKKwkJCQlpZiAoKHR5cGUgPT0gVFlQRV9BTEwpIHx8ICh0eXBlID09IGVudHJ5X3R5cGUpKSB7
CisJCQkJCWlmIChpc19mZWFzaWJsZV9lbnRyeSAmJiBoYXNfZXh0X2VudHJ5KQorCQkJCQkJcmV0
dXJuIGRlbnRyeTsKKworCQkJCQlkb3NfZXAgPSAoc3RydWN0IGRvc19kZW50cnlfdCAqKSBlcDsK
KwkJCQkJaWYgKCghbG9zc3kpICYmICghbmxzX2Rvc25hbWVfY21wKHNiLCBwX2Rvc25hbWUtPm5h
bWUsIGRvc19lcC0+bmFtZSkpKQorCQkJCQkJcmV0dXJuIGRlbnRyeTsKKwkJCQl9CisJCQkJaXNf
ZmVhc2libGVfZW50cnkgPSBUUlVFOworCQkJCWhhc19leHRfZW50cnkgPSBGQUxTRTsKKwkJCX0g
ZWxzZSBpZiAoZW50cnlfdHlwZSA9PSBUWVBFX0VYVEVORCkgeworCQkJCWlmIChpc19mZWFzaWJs
ZV9lbnRyeSkgeworCQkJCQlleHRfZXAgPSAoc3RydWN0IGV4dF9kZW50cnlfdCAqKSBlcDsKKwkJ
CQkJaWYgKGV4dF9lcC0+b3JkZXIgPiAweDQwKSB7CisJCQkJCQlvcmRlciA9IChzMzIpKGV4dF9l
cC0+b3JkZXIgLSAweDQwKTsKKwkJCQkJCXVuaW5hbWUgPSBwX3VuaW5hbWUtPm5hbWUgKyAxMyAq
IChvcmRlci0xKTsKKwkJCQkJfSBlbHNlIHsKKwkJCQkJCW9yZGVyID0gKHMzMikgZXh0X2VwLT5v
cmRlcjsKKwkJCQkJCXVuaW5hbWUgLT0gMTM7CisJCQkJCX0KKworCQkJCQlsZW4gPSBleHRyYWN0
X3VuaV9uYW1lX2Zyb21fZXh0X2VudHJ5KGV4dF9lcCwgZW50cnlfdW5pbmFtZSwgb3JkZXIpOwor
CisJCQkJCXVuaWNoYXIgPSAqKHVuaW5hbWUrbGVuKTsKKwkJCQkJKih1bmluYW1lK2xlbikgPSAw
eDA7CisKKwkJCQkJaWYgKG5sc191bmluYW1lX2NtcChzYiwgdW5pbmFtZSwgZW50cnlfdW5pbmFt
ZSkpCisJCQkJCQlpc19mZWFzaWJsZV9lbnRyeSA9IEZBTFNFOworCisJCQkJCSoodW5pbmFtZSts
ZW4pID0gdW5pY2hhcjsKKwkJCQl9CisJCQkJaGFzX2V4dF9lbnRyeSA9IFRSVUU7CisJCQl9IGVs
c2UgaWYgKGVudHJ5X3R5cGUgPT0gVFlQRV9VTlVTRUQpIHsKKwkJCQlyZXR1cm4gLTI7CisJCQl9
CisJCQlpc19mZWFzaWJsZV9lbnRyeSA9IFRSVUU7CisJCQloYXNfZXh0X2VudHJ5ID0gRkFMU0U7
CisJCX0KKworCQlpZiAocF9kaXItPmRpciA9PSBDTFVTVEVSXzMyKDApKQorCQkJYnJlYWs7IC8q
IEZBVDE2IHJvb3RfZGlyICovCisKKwkJaWYgKEZBVF9yZWFkKHNiLCBjbHUuZGlyLCAmY2x1LmRp
cikgIT0gMCkKKwkJCXJldHVybiAtMjsKKwl9CisKKwlyZXR1cm4gLTI7Cit9CisKKy8qIHJldHVy
biB2YWx1ZXMgb2YgZXhmYXRfZmluZF9kaXJfZW50cnkoKQorICogPj0gMCA6IHJldHVybiBkaXIg
ZW50aXJ5IHBvc2l0aW9uIHdpdGggdGhlIG5hbWUgaW4gZGlyCisgKiAtMSA6IChyb290IGRpciwg
Ii4iKSBpdCBpcyB0aGUgcm9vdCBkaXIgaXRzZWxmCisgKiAtMiA6IGVudHJ5IHdpdGggdGhlIG5h
bWUgZG9lcyBub3QgZXhpc3QKKyAqLworczMyIGV4ZmF0X2ZpbmRfZGlyX2VudHJ5KHN0cnVjdCBz
dXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJCSBzdHJ1Y3QgdW5pX25h
bWVfdCAqcF91bmluYW1lLCBzMzIgbnVtX2VudHJpZXMsCisJCQkgc3RydWN0IGRvc19uYW1lX3Qg
KnBfZG9zbmFtZSwgdTMyIHR5cGUpCit7CisJaW50IGkgPSAwLCBkZW50cnkgPSAwLCBudW1fZXh0
X2VudHJpZXMgPSAwLCBsZW4sIHN0ZXA7CisJczMyIG9yZGVyID0gMCwgaXNfZmVhc2libGVfZW50
cnkgPSBGQUxTRTsKKwlzMzIgZGVudHJpZXNfcGVyX2NsdSwgbnVtX2VtcHR5ID0gMDsKKwl1MzIg
ZW50cnlfdHlwZTsKKwl1MTYgZW50cnlfdW5pbmFtZVsxNl0sICp1bmluYW1lID0gTlVMTCwgdW5p
Y2hhcjsKKwlzdHJ1Y3QgY2hhaW5fdCBjbHU7CisJc3RydWN0IGRlbnRyeV90ICplcDsKKwlzdHJ1
Y3QgZmlsZV9kZW50cnlfdCAqZmlsZV9lcDsKKwlzdHJ1Y3Qgc3RybV9kZW50cnlfdCAqc3RybV9l
cDsKKwlzdHJ1Y3QgbmFtZV9kZW50cnlfdCAqbmFtZV9lcDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpw
X2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJaWYgKHBfZGlyLT5kaXIgPT0gcF9m
cy0+cm9vdF9kaXIpIHsKKwkJaWYgKCghbmxzX3VuaW5hbWVfY21wKHNiLCBwX3VuaW5hbWUtPm5h
bWUsCisJCQkJICAgICAgKHUxNiAqKVVOSV9DVVJfRElSX05BTUUpKSB8fAorCQkJKCFubHNfdW5p
bmFtZV9jbXAoc2IsIHBfdW5pbmFtZS0+bmFtZSwKKwkJCQkJICAodTE2ICopVU5JX1BBUl9ESVJf
TkFNRSkpKQorCQkJcmV0dXJuIC0xOyAvLyBzcGVjaWFsIGNhc2UsIHJvb3QgZGlyZWN0b3J5IGl0
c2VsZgorCX0KKworCWlmIChwX2Rpci0+ZGlyID09IENMVVNURVJfMzIoMCkpIC8qIEZBVDE2IHJv
b3RfZGlyICovCisJCWRlbnRyaWVzX3Blcl9jbHUgPSBwX2ZzLT5kZW50cmllc19pbl9yb290Owor
CWVsc2UKKwkJZGVudHJpZXNfcGVyX2NsdSA9IHBfZnMtPmRlbnRyaWVzX3Blcl9jbHU7CisKKwlj
bHUuZGlyID0gcF9kaXItPmRpcjsKKwljbHUuc2l6ZSA9IHBfZGlyLT5zaXplOworCWNsdS5mbGFn
cyA9IHBfZGlyLT5mbGFnczsKKworCXBfZnMtPmhpbnRfdWVudHJ5LmRpciA9IHBfZGlyLT5kaXI7
CisJcF9mcy0+aGludF91ZW50cnkuZW50cnkgPSAtMTsKKworCXdoaWxlIChjbHUuZGlyICE9IENM
VVNURVJfMzIofjApKSB7CisJCWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJCWJyZWFrOworCisJ
CXdoaWxlIChpIDwgZGVudHJpZXNfcGVyX2NsdSkgeworCQkJZXAgPSBnZXRfZW50cnlfaW5fZGly
KHNiLCAmY2x1LCBpLCBOVUxMKTsKKwkJCWlmICghZXApCisJCQkJcmV0dXJuIC0yOworCisJCQll
bnRyeV90eXBlID0gcF9mcy0+ZnNfZnVuYy0+Z2V0X2VudHJ5X3R5cGUoZXApOworCQkJc3RlcCA9
IDE7CisKKwkJCWlmICgoZW50cnlfdHlwZSA9PSBUWVBFX1VOVVNFRCkgfHwgKGVudHJ5X3R5cGUg
PT0gVFlQRV9ERUxFVEVEKSkgeworCQkJCWlzX2ZlYXNpYmxlX2VudHJ5ID0gRkFMU0U7CisKKwkJ
CQlpZiAocF9mcy0+aGludF91ZW50cnkuZW50cnkgPT0gLTEpIHsKKwkJCQkJbnVtX2VtcHR5Kys7
CisKKwkJCQkJaWYgKG51bV9lbXB0eSA9PSAxKSB7CisJCQkJCQlwX2ZzLT5oaW50X3VlbnRyeS5j
bHUuZGlyID0gY2x1LmRpcjsKKwkJCQkJCXBfZnMtPmhpbnRfdWVudHJ5LmNsdS5zaXplID0gY2x1
LnNpemU7CisJCQkJCQlwX2ZzLT5oaW50X3VlbnRyeS5jbHUuZmxhZ3MgPSBjbHUuZmxhZ3M7CisJ
CQkJCX0KKwkJCQkJaWYgKChudW1fZW1wdHkgPj0gbnVtX2VudHJpZXMpIHx8IChlbnRyeV90eXBl
ID09IFRZUEVfVU5VU0VEKSkKKwkJCQkJCXBfZnMtPmhpbnRfdWVudHJ5LmVudHJ5ID0gZGVudHJ5
IC0gKG51bV9lbXB0eS0xKTsKKwkJCQl9CisKKwkJCQlpZiAoZW50cnlfdHlwZSA9PSBUWVBFX1VO
VVNFRCkKKwkJCQkJcmV0dXJuIC0yOworCQkJfSBlbHNlIHsKKwkJCQludW1fZW1wdHkgPSAwOwor
CisJCQkJaWYgKChlbnRyeV90eXBlID09IFRZUEVfRklMRSkgfHwgKGVudHJ5X3R5cGUgPT0gVFlQ
RV9ESVIpKSB7CisJCQkJCWZpbGVfZXAgPSAoc3RydWN0IGZpbGVfZGVudHJ5X3QgKikgZXA7CisJ
CQkJCWlmICgodHlwZSA9PSBUWVBFX0FMTCkgfHwgKHR5cGUgPT0gZW50cnlfdHlwZSkpIHsKKwkJ
CQkJCW51bV9leHRfZW50cmllcyA9IGZpbGVfZXAtPm51bV9leHQ7CisJCQkJCQlpc19mZWFzaWJs
ZV9lbnRyeSA9IFRSVUU7CisJCQkJCX0gZWxzZSB7CisJCQkJCQlpc19mZWFzaWJsZV9lbnRyeSA9
IEZBTFNFOworCQkJCQkJc3RlcCA9IGZpbGVfZXAtPm51bV9leHQgKyAxOworCQkJCQl9CisJCQkJ
fSBlbHNlIGlmIChlbnRyeV90eXBlID09IFRZUEVfU1RSRUFNKSB7CisJCQkJCWlmIChpc19mZWFz
aWJsZV9lbnRyeSkgeworCQkJCQkJc3RybV9lcCA9IChzdHJ1Y3Qgc3RybV9kZW50cnlfdCAqKWVw
OworCQkJCQkJaWYgKHBfdW5pbmFtZS0+bmFtZV9oYXNoID09IEdFVDE2X0Eoc3RybV9lcC0+bmFt
ZV9oYXNoKSAmJgorCQkJCQkJICAgIHBfdW5pbmFtZS0+bmFtZV9sZW4gPT0gc3RybV9lcC0+bmFt
ZV9sZW4pIHsKKwkJCQkJCQlvcmRlciA9IDE7CisJCQkJCQl9IGVsc2UgeworCQkJCQkJCWlzX2Zl
YXNpYmxlX2VudHJ5ID0gRkFMU0U7CisJCQkJCQkJc3RlcCA9IG51bV9leHRfZW50cmllczsKKwkJ
CQkJCX0KKwkJCQkJfQorCQkJCX0gZWxzZSBpZiAoZW50cnlfdHlwZSA9PSBUWVBFX0VYVEVORCkg
eworCQkJCQlpZiAoaXNfZmVhc2libGVfZW50cnkpIHsKKwkJCQkJCW5hbWVfZXAgPSAoc3RydWN0
IG5hbWVfZGVudHJ5X3QgKillcDsKKworCQkJCQkJaWYgKCgrK29yZGVyKSA9PSAyKQorCQkJCQkJ
CXVuaW5hbWUgPSBwX3VuaW5hbWUtPm5hbWU7CisJCQkJCQllbHNlCisJCQkJCQkJdW5pbmFtZSAr
PSAxNTsKKworCQkJCQkJbGVuID0gZXh0cmFjdF91bmlfbmFtZV9mcm9tX25hbWVfZW50cnkobmFt
ZV9lcCwKKwkJCQkJCQkJZW50cnlfdW5pbmFtZSwgb3JkZXIpOworCisJCQkJCQl1bmljaGFyID0g
Kih1bmluYW1lK2xlbik7CisJCQkJCQkqKHVuaW5hbWUrbGVuKSA9IDB4MDsKKworCQkJCQkJaWYg
KG5sc191bmluYW1lX2NtcChzYiwgdW5pbmFtZSwgZW50cnlfdW5pbmFtZSkpIHsKKwkJCQkJCQlp
c19mZWFzaWJsZV9lbnRyeSA9IEZBTFNFOworCQkJCQkJCXN0ZXAgPSBudW1fZXh0X2VudHJpZXMg
LSBvcmRlciArIDE7CisJCQkJCQl9IGVsc2UgaWYgKG9yZGVyID09IG51bV9leHRfZW50cmllcykg
eworCQkJCQkJCXBfZnMtPmhpbnRfdWVudHJ5LmRpciA9IENMVVNURVJfMzIofjApOworCQkJCQkJ
CXBfZnMtPmhpbnRfdWVudHJ5LmVudHJ5ID0gLTE7CisJCQkJCQkJcmV0dXJuIGRlbnRyeSAtIChu
dW1fZXh0X2VudHJpZXMpOworCQkJCQkJfQorCisJCQkJCQkqKHVuaW5hbWUrbGVuKSA9IHVuaWNo
YXI7CisJCQkJCX0KKwkJCQl9IGVsc2UgeworCQkJCQlpc19mZWFzaWJsZV9lbnRyeSA9IEZBTFNF
OworCQkJCX0KKwkJCX0KKworCQkJaSArPSBzdGVwOworCQkJZGVudHJ5ICs9IHN0ZXA7CisJCX0K
KworCQlpIC09IGRlbnRyaWVzX3Blcl9jbHU7CisKKwkJaWYgKHBfZGlyLT5kaXIgPT0gQ0xVU1RF
Ul8zMigwKSkKKwkJCWJyZWFrOyAvKiBGQVQxNiByb290X2RpciAqLworCisJCWlmIChjbHUuZmxh
Z3MgPT0gMHgwMykgeworCQkJaWYgKCgtLWNsdS5zaXplKSA+IDApCisJCQkJY2x1LmRpcisrOwor
CQkJZWxzZQorCQkJCWNsdS5kaXIgPSBDTFVTVEVSXzMyKH4wKTsKKwkJfSBlbHNlIHsKKwkJCWlm
IChGQVRfcmVhZChzYiwgY2x1LmRpciwgJmNsdS5kaXIpICE9IDApCisJCQkJcmV0dXJuIC0yOwor
CQl9CisJfQorCisJcmV0dXJuIC0yOworfQorCitzMzIgZmF0X2NvdW50X2V4dF9lbnRyaWVzKHN0
cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJCSAgczMyIGVu
dHJ5LCBzdHJ1Y3QgZGVudHJ5X3QgKnBfZW50cnkpCit7CisJczMyIGNvdW50ID0gMDsKKwl1OCBj
aGtzdW07CisJc3RydWN0IGRvc19kZW50cnlfdCAqZG9zX2VwID0gKHN0cnVjdCBkb3NfZGVudHJ5
X3QgKikgcF9lbnRyeTsKKwlzdHJ1Y3QgZXh0X2RlbnRyeV90ICpleHRfZXA7CisJc3RydWN0IGZz
X2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCWNoa3N1bSA9IGNh
bGNfY2hlY2tzdW1fMWJ5dGUoKHZvaWQgKikgZG9zX2VwLT5uYW1lLCBET1NfTkFNRV9MRU5HVEgs
IDApOworCisJZm9yIChlbnRyeS0tOyBlbnRyeSA+PSAwOyBlbnRyeS0tKSB7CisJCWV4dF9lcCA9
IChzdHJ1Y3QgZXh0X2RlbnRyeV90ICopZ2V0X2VudHJ5X2luX2RpcihzYiwgcF9kaXIsCisJCQkJ
CQkJCSBlbnRyeSwgTlVMTCk7CisJCWlmICghZXh0X2VwKQorCQkJcmV0dXJuIC0xOworCisJCWlm
ICgocF9mcy0+ZnNfZnVuYy0+Z2V0X2VudHJ5X3R5cGUoKHN0cnVjdCBkZW50cnlfdCAqKWV4dF9l
cCkgPT0KKwkJICAgICBUWVBFX0VYVEVORCkgJiYgKGV4dF9lcC0+Y2hlY2tzdW0gPT0gY2hrc3Vt
KSkgeworCQkJY291bnQrKzsKKwkJCWlmIChleHRfZXAtPm9yZGVyID4gMHg0MCkKKwkJCQlyZXR1
cm4gY291bnQ7CisJCX0gZWxzZSB7CisJCQlyZXR1cm4gY291bnQ7CisJCX0KKwl9CisKKwlyZXR1
cm4gY291bnQ7Cit9CisKK3MzMiBleGZhdF9jb3VudF9leHRfZW50cmllcyhzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKnNiLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJCQkgICAgczMyIGVudHJ5LCBzdHJ1
Y3QgZGVudHJ5X3QgKnBfZW50cnkpCit7CisJaW50IGksIGNvdW50ID0gMDsKKwl1MzIgdHlwZTsK
KwlzdHJ1Y3QgZmlsZV9kZW50cnlfdCAqZmlsZV9lcCA9IChzdHJ1Y3QgZmlsZV9kZW50cnlfdCAq
KXBfZW50cnk7CisJc3RydWN0IGRlbnRyeV90ICpleHRfZXA7CisJc3RydWN0IGZzX2luZm9fdCAq
cF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCWZvciAoaSA9IDAsIGVudHJ5Kys7
IGkgPCBmaWxlX2VwLT5udW1fZXh0OyBpKyssIGVudHJ5KyspIHsKKwkJZXh0X2VwID0gZ2V0X2Vu
dHJ5X2luX2RpcihzYiwgcF9kaXIsIGVudHJ5LCBOVUxMKTsKKwkJaWYgKCFleHRfZXApCisJCQly
ZXR1cm4gLTE7CisKKwkJdHlwZSA9IHBfZnMtPmZzX2Z1bmMtPmdldF9lbnRyeV90eXBlKGV4dF9l
cCk7CisJCWlmICgodHlwZSA9PSBUWVBFX0VYVEVORCkgfHwgKHR5cGUgPT0gVFlQRV9TVFJFQU0p
KQorCQkJY291bnQrKzsKKwkJZWxzZQorCQkJcmV0dXJuIGNvdW50OworCX0KKworCXJldHVybiBj
b3VudDsKK30KKworczMyIGNvdW50X2Rvc19uYW1lX2VudHJpZXMoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYiwgc3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkJICAgdTMyIHR5cGUpCit7CisJaW50IGks
IGNvdW50ID0gMDsKKwlzMzIgZGVudHJpZXNfcGVyX2NsdTsKKwl1MzIgZW50cnlfdHlwZTsKKwlz
dHJ1Y3QgY2hhaW5fdCBjbHU7CisJc3RydWN0IGRlbnRyeV90ICplcDsKKwlzdHJ1Y3QgZnNfaW5m
b190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJaWYgKHBfZGlyLT5kaXIg
PT0gQ0xVU1RFUl8zMigwKSkgLyogRkFUMTYgcm9vdF9kaXIgKi8KKwkJZGVudHJpZXNfcGVyX2Ns
dSA9IHBfZnMtPmRlbnRyaWVzX2luX3Jvb3Q7CisJZWxzZQorCQlkZW50cmllc19wZXJfY2x1ID0g
cF9mcy0+ZGVudHJpZXNfcGVyX2NsdTsKKworCWNsdS5kaXIgPSBwX2Rpci0+ZGlyOworCWNsdS5z
aXplID0gcF9kaXItPnNpemU7CisJY2x1LmZsYWdzID0gcF9kaXItPmZsYWdzOworCisJd2hpbGUg
KGNsdS5kaXIgIT0gQ0xVU1RFUl8zMih+MCkpIHsKKwkJaWYgKHBfZnMtPmRldl9lamVjdGVkKQor
CQkJYnJlYWs7CisKKwkJZm9yIChpID0gMDsgaSA8IGRlbnRyaWVzX3Blcl9jbHU7IGkrKykgewor
CQkJZXAgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCAmY2x1LCBpLCBOVUxMKTsKKwkJCWlmICghZXAp
CisJCQkJcmV0dXJuIC0xOworCisJCQllbnRyeV90eXBlID0gcF9mcy0+ZnNfZnVuYy0+Z2V0X2Vu
dHJ5X3R5cGUoZXApOworCisJCQlpZiAoZW50cnlfdHlwZSA9PSBUWVBFX1VOVVNFRCkKKwkJCQly
ZXR1cm4gY291bnQ7CisJCQlpZiAoISh0eXBlICYgVFlQRV9DUklUSUNBTF9QUkkpICYmCisJCQkg
ICAgISh0eXBlICYgVFlQRV9CRU5JR05fUFJJKSkKKwkJCQljb250aW51ZTsKKworCQkJaWYgKCh0
eXBlID09IFRZUEVfQUxMKSB8fCAodHlwZSA9PSBlbnRyeV90eXBlKSkKKwkJCQljb3VudCsrOwor
CQl9CisKKwkJaWYgKHBfZGlyLT5kaXIgPT0gQ0xVU1RFUl8zMigwKSkKKwkJCWJyZWFrOyAvKiBG
QVQxNiByb290X2RpciAqLworCisJCWlmIChjbHUuZmxhZ3MgPT0gMHgwMykgeworCQkJaWYgKCgt
LWNsdS5zaXplKSA+IDApCisJCQkJY2x1LmRpcisrOworCQkJZWxzZQorCQkJCWNsdS5kaXIgPSBD
TFVTVEVSXzMyKH4wKTsKKwkJfSBlbHNlIHsKKwkJCWlmIChGQVRfcmVhZChzYiwgY2x1LmRpciwg
JmNsdS5kaXIpICE9IDApCisJCQkJcmV0dXJuIC0xOworCQl9CisJfQorCisJcmV0dXJuIGNvdW50
OworfQorCitib29sIGlzX2Rpcl9lbXB0eShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3Qg
Y2hhaW5fdCAqcF9kaXIpCit7CisJaW50IGksIGNvdW50ID0gMDsKKwlzMzIgZGVudHJpZXNfcGVy
X2NsdTsKKwl1MzIgdHlwZTsKKwlzdHJ1Y3QgY2hhaW5fdCBjbHU7CisJc3RydWN0IGRlbnRyeV90
ICplcDsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8p
OworCisJaWYgKHBfZGlyLT5kaXIgPT0gQ0xVU1RFUl8zMigwKSkgLyogRkFUMTYgcm9vdF9kaXIg
Ki8KKwkJZGVudHJpZXNfcGVyX2NsdSA9IHBfZnMtPmRlbnRyaWVzX2luX3Jvb3Q7CisJZWxzZQor
CQlkZW50cmllc19wZXJfY2x1ID0gcF9mcy0+ZGVudHJpZXNfcGVyX2NsdTsKKworCWNsdS5kaXIg
PSBwX2Rpci0+ZGlyOworCWNsdS5zaXplID0gcF9kaXItPnNpemU7CisJY2x1LmZsYWdzID0gcF9k
aXItPmZsYWdzOworCisJd2hpbGUgKGNsdS5kaXIgIT0gQ0xVU1RFUl8zMih+MCkpIHsKKwkJaWYg
KHBfZnMtPmRldl9lamVjdGVkKQorCQkJYnJlYWs7CisKKwkJZm9yIChpID0gMDsgaSA8IGRlbnRy
aWVzX3Blcl9jbHU7IGkrKykgeworCQkJZXAgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCAmY2x1LCBp
LCBOVUxMKTsKKwkJCWlmICghZXApCisJCQkJYnJlYWs7CisKKwkJCXR5cGUgPSBwX2ZzLT5mc19m
dW5jLT5nZXRfZW50cnlfdHlwZShlcCk7CisKKwkJCWlmICh0eXBlID09IFRZUEVfVU5VU0VEKQor
CQkJCXJldHVybiBUUlVFOworCQkJaWYgKCh0eXBlICE9IFRZUEVfRklMRSkgJiYgKHR5cGUgIT0g
VFlQRV9ESVIpKQorCQkJCWNvbnRpbnVlOworCisJCQlpZiAocF9kaXItPmRpciA9PSBDTFVTVEVS
XzMyKDApKSAvKiBGQVQxNiByb290X2RpciAqLworCQkJCXJldHVybiBGQUxTRTsKKworCQkJaWYg
KHBfZnMtPnZvbF90eXBlID09IEVYRkFUKQorCQkJCXJldHVybiBGQUxTRTsKKwkJCWlmICgocF9k
aXItPmRpciA9PSBwX2ZzLT5yb290X2RpcikgfHwgKCgrK2NvdW50KSA+IDIpKQorCQkJCXJldHVy
biBGQUxTRTsKKwkJfQorCisJCWlmIChwX2Rpci0+ZGlyID09IENMVVNURVJfMzIoMCkpCisJCQli
cmVhazsgLyogRkFUMTYgcm9vdF9kaXIgKi8KKworCQlpZiAoY2x1LmZsYWdzID09IDB4MDMpIHsK
KwkJCWlmICgoLS1jbHUuc2l6ZSkgPiAwKQorCQkJCWNsdS5kaXIrKzsKKwkJCWVsc2UKKwkJCQlj
bHUuZGlyID0gQ0xVU1RFUl8zMih+MCk7CisJCX0KKwkJaWYgKEZBVF9yZWFkKHNiLCBjbHUuZGly
LCAmY2x1LmRpcikgIT0gMCkKKwkJCWJyZWFrOworCX0KKworCXJldHVybiBUUlVFOworfQorCisv
KgorICogIE5hbWUgQ29udmVyc2lvbiBGdW5jdGlvbnMKKyAqLworCisvKiBpbnB1dCAgOiBkaXIs
IHVuaV9uYW1lCisgKiBvdXRwdXQgOiBudW1fb2ZfZW50cnksIGRvc19uYW1lKGZvcm1hdCA6IGFh
YWFhYX4xLmJiYikKKyAqLworczMyIGdldF9udW1fZW50cmllc19hbmRfZG9zX25hbWUoc3RydWN0
IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGNoYWluX3QgKnBfZGlyLAorCQkJCSBzdHJ1Y3QgdW5p
X25hbWVfdCAqcF91bmluYW1lLCBzMzIgKmVudHJpZXMsCisJCQkJIHN0cnVjdCBkb3NfbmFtZV90
ICpwX2Rvc25hbWUpCit7CisJczMyIHJldCwgbnVtX2VudHJpZXM7CisJYm9vbCBsb3NzeSA9IGZh
bHNlOworCWNoYXIgKipyOworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNi
KS0+ZnNfaW5mbyk7CisKKwludW1fZW50cmllcyA9IHBfZnMtPmZzX2Z1bmMtPmNhbGNfbnVtX2Vu
dHJpZXMocF91bmluYW1lKTsKKwlpZiAobnVtX2VudHJpZXMgPT0gMCkKKwkJcmV0dXJuIEZGU19J
TlZBTElEUEFUSDsKKworCWlmIChwX2ZzLT52b2xfdHlwZSAhPSBFWEZBVCkgeworCQlubHNfdW5p
bmFtZV90b19kb3NuYW1lKHNiLCBwX2Rvc25hbWUsIHBfdW5pbmFtZSwgJmxvc3N5KTsKKworCQlp
ZiAobG9zc3kpIHsKKwkJCXJldCA9IGZhdF9nZW5lcmF0ZV9kb3NfbmFtZShzYiwgcF9kaXIsIHBf
ZG9zbmFtZSk7CisJCQlpZiAocmV0KQorCQkJCXJldHVybiByZXQ7CisJCX0gZWxzZSB7CisJCQlm
b3IgKHIgPSByZXNlcnZlZF9uYW1lczsgKnI7IHIrKykgeworCQkJCWlmICghc3RybmNtcCgodm9p
ZCAqKXBfZG9zbmFtZS0+bmFtZSwgKnIsIDgpKQorCQkJCQlyZXR1cm4gRkZTX0lOVkFMSURQQVRI
OworCQkJfQorCisJCQlpZiAocF9kb3NuYW1lLT5uYW1lX2Nhc2UgIT0gMHhGRikKKwkJCQludW1f
ZW50cmllcyA9IDE7CisJCX0KKworCQlpZiAobnVtX2VudHJpZXMgPiAxKQorCQkJcF9kb3NuYW1l
LT5uYW1lX2Nhc2UgPSAweDA7CisJfQorCisJKmVudHJpZXMgPSBudW1fZW50cmllczsKKworCXJl
dHVybiBGRlNfU1VDQ0VTUzsKK30KKwordm9pZCBnZXRfdW5pX25hbWVfZnJvbV9kb3NfZW50cnko
c3RydWN0IHN1cGVyX2Jsb2NrICpzYiwKKwkJCQkgc3RydWN0IGRvc19kZW50cnlfdCAqZXAsCisJ
CQkJIHN0cnVjdCB1bmlfbmFtZV90ICpwX3VuaW5hbWUsIHU4IG1vZGUpCit7CisJc3RydWN0IGRv
c19uYW1lX3QgZG9zX25hbWU7CisKKwlpZiAobW9kZSA9PSAweDApCisJCWRvc19uYW1lLm5hbWVf
Y2FzZSA9IDB4MDsKKwllbHNlCisJCWRvc19uYW1lLm5hbWVfY2FzZSA9IGVwLT5sY2FzZTsKKwor
CW1lbWNweShkb3NfbmFtZS5uYW1lLCBlcC0+bmFtZSwgRE9TX05BTUVfTEVOR1RIKTsKKwlubHNf
ZG9zbmFtZV90b191bmluYW1lKHNiLCBwX3VuaW5hbWUsICZkb3NfbmFtZSk7Cit9CisKK3ZvaWQg
ZmF0X2dldF91bmlfbmFtZV9mcm9tX2V4dF9lbnRyeShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAor
CQkJCSAgICAgc3RydWN0IGNoYWluX3QgKnBfZGlyLCBzMzIgZW50cnksCisJCQkJICAgICB1MTYg
KnVuaW5hbWUpCit7CisJaW50IGk7CisJc3RydWN0IGV4dF9kZW50cnlfdCAqZXA7CisJc3RydWN0
IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCWZvciAoZW50
cnktLSwgaSA9IDE7IGVudHJ5ID49IDA7IGVudHJ5LS0sIGkrKykgeworCQllcCA9IChzdHJ1Y3Qg
ZXh0X2RlbnRyeV90ICopZ2V0X2VudHJ5X2luX2RpcihzYiwgcF9kaXIsIGVudHJ5LAorCQkJCQkJ
CSAgICAgTlVMTCk7CisJCWlmICghZXApCisJCQlyZXR1cm47CisKKwkJaWYgKHBfZnMtPmZzX2Z1
bmMtPmdldF9lbnRyeV90eXBlKChzdHJ1Y3QgZGVudHJ5X3QgKillcCkgPT0KKwkJICAgIFRZUEVf
RVhURU5EKSB7CisJCQlleHRyYWN0X3VuaV9uYW1lX2Zyb21fZXh0X2VudHJ5KGVwLCB1bmluYW1l
LCBpKTsKKwkJCWlmIChlcC0+b3JkZXIgPiAweDQwKQorCQkJCXJldHVybjsKKwkJfSBlbHNlIHsK
KwkJCXJldHVybjsKKwkJfQorCisJCXVuaW5hbWUgKz0gMTM7CisJfQorfQorCit2b2lkIGV4ZmF0
X2dldF91bmlfbmFtZV9mcm9tX2V4dF9lbnRyeShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJ
CSAgICAgICBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsIHMzMiBlbnRyeSwKKwkJCQkgICAgICAgdTE2
ICp1bmluYW1lKQoreworCWludCBpOworCXN0cnVjdCBkZW50cnlfdCAqZXA7CisJc3RydWN0IGVu
dHJ5X3NldF9jYWNoZV90ICplczsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9T
QihzYiktPmZzX2luZm8pOworCisJZXMgPSBnZXRfZW50cnlfc2V0X2luX2RpcihzYiwgcF9kaXIs
IGVudHJ5LCBFU19BTExfRU5UUklFUywgJmVwKTsKKwlpZiAoZXMgPT0gTlVMTCB8fCBlcy0+bnVt
X2VudHJpZXMgPCAzKSB7CisJCWlmIChlcykKKwkJCXJlbGVhc2VfZW50cnlfc2V0KGVzKTsKKwkJ
cmV0dXJuOworCX0KKworCWVwICs9IDI7CisKKwkvKgorCSAqIEZpcnN0IGVudHJ5ICA6IGZpbGUg
ZW50cnkKKwkgKiBTZWNvbmQgZW50cnkgOiBzdHJlYW0tZXh0ZW5zaW9uIGVudHJ5CisJICogVGhp
cmQgZW50cnkgIDogZmlyc3QgZmlsZS1uYW1lIGVudHJ5CisJICogU28sIHRoZSBpbmRleCBvZiBm
aXJzdCBmaWxlLW5hbWUgZGVudHJ5IHNob3VsZCBzdGFydCBmcm9tIDIuCisJICovCisJZm9yIChp
ID0gMjsgaSA8IGVzLT5udW1fZW50cmllczsgaSsrLCBlcCsrKSB7CisJCWlmIChwX2ZzLT5mc19m
dW5jLT5nZXRfZW50cnlfdHlwZShlcCkgPT0gVFlQRV9FWFRFTkQpCisJCQlleHRyYWN0X3VuaV9u
YW1lX2Zyb21fbmFtZV9lbnRyeSgoc3RydWN0IG5hbWVfZGVudHJ5X3QgKikKKwkJCQkJCQkgZXAs
IHVuaW5hbWUsIGkpOworCQllbHNlCisJCQlnb3RvIG91dDsKKwkJdW5pbmFtZSArPSAxNTsKKwl9
CisKK291dDoKKwlyZWxlYXNlX2VudHJ5X3NldChlcyk7Cit9CisKK3MzMiBleHRyYWN0X3VuaV9u
YW1lX2Zyb21fZXh0X2VudHJ5KHN0cnVjdCBleHRfZGVudHJ5X3QgKmVwLCB1MTYgKnVuaW5hbWUs
CisJCQkJICAgIHMzMiBvcmRlcikKK3sKKwlpbnQgaSwgbGVuID0gMDsKKworCWZvciAoaSA9IDA7
IGkgPCAxMDsgaSArPSAyKSB7CisJCSp1bmluYW1lID0gR0VUMTYoZXAtPnVuaWNvZGVfMF80ICsg
aSk7CisJCWlmICgqdW5pbmFtZSA9PSAweDApCisJCQlyZXR1cm4gbGVuOworCQl1bmluYW1lKys7
CisJCWxlbisrOworCX0KKworCWlmIChvcmRlciA8IDIwKSB7CisJCWZvciAoaSA9IDA7IGkgPCAx
MjsgaSArPSAyKSB7CisJCQkqdW5pbmFtZSA9IEdFVDE2X0EoZXAtPnVuaWNvZGVfNV8xMCArIGkp
OworCQkJaWYgKCp1bmluYW1lID09IDB4MCkKKwkJCQlyZXR1cm4gbGVuOworCQkJdW5pbmFtZSsr
OworCQkJbGVuKys7CisJCX0KKwl9IGVsc2UgeworCQlmb3IgKGkgPSAwOyBpIDwgODsgaSArPSAy
KSB7CisJCQkqdW5pbmFtZSA9IEdFVDE2X0EoZXAtPnVuaWNvZGVfNV8xMCArIGkpOworCQkJaWYg
KCp1bmluYW1lID09IDB4MCkKKwkJCQlyZXR1cm4gbGVuOworCQkJdW5pbmFtZSsrOworCQkJbGVu
Kys7CisJCX0KKwkJKnVuaW5hbWUgPSAweDA7IC8qIHVuaW5hbWVbTUFYX05BTUVfTEVOR1RILTFd
ICovCisJCXJldHVybiBsZW47CisJfQorCisJZm9yIChpID0gMDsgaSA8IDQ7IGkgKz0gMikgewor
CQkqdW5pbmFtZSA9IEdFVDE2X0EoZXAtPnVuaWNvZGVfMTFfMTIgKyBpKTsKKwkJaWYgKCp1bmlu
YW1lID09IDB4MCkKKwkJCXJldHVybiBsZW47CisJCXVuaW5hbWUrKzsKKwkJbGVuKys7CisJfQor
CisJKnVuaW5hbWUgPSAweDA7CisJcmV0dXJuIGxlbjsKK30KKworczMyIGV4dHJhY3RfdW5pX25h
bWVfZnJvbV9uYW1lX2VudHJ5KHN0cnVjdCBuYW1lX2RlbnRyeV90ICplcCwgdTE2ICp1bmluYW1l
LAorCQkJCSAgICAgczMyIG9yZGVyKQoreworCWludCBpLCBsZW4gPSAwOworCisJZm9yIChpID0g
MDsgaSA8IDMwOyBpICs9IDIpIHsKKwkJKnVuaW5hbWUgPSBHRVQxNl9BKGVwLT51bmljb2RlXzBf
MTQgKyBpKTsKKwkJaWYgKCp1bmluYW1lID09IDB4MCkKKwkJCXJldHVybiBsZW47CisJCXVuaW5h
bWUrKzsKKwkJbGVuKys7CisJfQorCisJKnVuaW5hbWUgPSAweDA7CisJcmV0dXJuIGxlbjsKK30K
KworczMyIGZhdF9nZW5lcmF0ZV9kb3NfbmFtZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1
Y3QgY2hhaW5fdCAqcF9kaXIsCisJCQkgIHN0cnVjdCBkb3NfbmFtZV90ICpwX2Rvc25hbWUpCit7
CisJaW50IGksIGosIGNvdW50ID0gMCwgY291bnRfYmVnaW4gPSBGQUxTRTsKKwlzMzIgZGVudHJp
ZXNfcGVyX2NsdTsKKwl1MzIgdHlwZTsKKwl1OCBibWFwWzEyOC8qIDEgfiAxMDIzICovXTsKKwlz
dHJ1Y3QgY2hhaW5fdCBjbHU7CisJc3RydWN0IGRvc19kZW50cnlfdCAqZXA7CisJc3RydWN0IGZz
X2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCW1lbXNldChibWFw
LCAwLCBzaXplb2YoYm1hcCkpOworCWV4ZmF0X2JpdG1hcF9zZXQoYm1hcCwgMCk7CisKKwlpZiAo
cF9kaXItPmRpciA9PSBDTFVTVEVSXzMyKDApKSAvKiBGQVQxNiByb290X2RpciAqLworCQlkZW50
cmllc19wZXJfY2x1ID0gcF9mcy0+ZGVudHJpZXNfaW5fcm9vdDsKKwllbHNlCisJCWRlbnRyaWVz
X3Blcl9jbHUgPSBwX2ZzLT5kZW50cmllc19wZXJfY2x1OworCisJY2x1LmRpciA9IHBfZGlyLT5k
aXI7CisJY2x1LmZsYWdzID0gcF9kaXItPmZsYWdzOworCisJd2hpbGUgKGNsdS5kaXIgIT0gQ0xV
U1RFUl8zMih+MCkpIHsKKwkJaWYgKHBfZnMtPmRldl9lamVjdGVkKQorCQkJYnJlYWs7CisKKwkJ
Zm9yIChpID0gMDsgaSA8IGRlbnRyaWVzX3Blcl9jbHU7IGkrKykgeworCQkJZXAgPSAoc3RydWN0
IGRvc19kZW50cnlfdCAqKWdldF9lbnRyeV9pbl9kaXIoc2IsICZjbHUsCisJCQkJCQkJCSAgICAg
aSwgTlVMTCk7CisJCQlpZiAoIWVwKQorCQkJCXJldHVybiBGRlNfTUVESUFFUlI7CisKKwkJCXR5
cGUgPSBwX2ZzLT5mc19mdW5jLT5nZXRfZW50cnlfdHlwZSgoc3RydWN0IGRlbnRyeV90ICopCisJ
CQkJCQkJICAgICBlcCk7CisKKwkJCWlmICh0eXBlID09IFRZUEVfVU5VU0VEKQorCQkJCWJyZWFr
OworCQkJaWYgKCh0eXBlICE9IFRZUEVfRklMRSkgJiYgKHR5cGUgIT0gVFlQRV9ESVIpKQorCQkJ
CWNvbnRpbnVlOworCisJCQljb3VudCA9IDA7CisJCQljb3VudF9iZWdpbiA9IEZBTFNFOworCisJ
CQlmb3IgKGogPSAwOyBqIDwgODsgaisrKSB7CisJCQkJaWYgKGVwLT5uYW1lW2pdID09ICcgJykK
KwkJCQkJYnJlYWs7CisKKwkJCQlpZiAoZXAtPm5hbWVbal0gPT0gJ34nKSB7CisJCQkJCWNvdW50
X2JlZ2luID0gVFJVRTsKKwkJCQl9IGVsc2UgaWYgKGNvdW50X2JlZ2luKSB7CisJCQkJCWlmICgo
ZXAtPm5hbWVbal0gPj0gJzAnKSAmJgorCQkJCQkgICAgKGVwLT5uYW1lW2pdIDw9ICc5JykpIHsK
KwkJCQkJCWNvdW50ID0gY291bnQgKiAxMCArCisJCQkJCQkJKGVwLT5uYW1lW2pdIC0gJzAnKTsK
KwkJCQkJfSBlbHNlIHsKKwkJCQkJCWNvdW50ID0gMDsKKwkJCQkJCWNvdW50X2JlZ2luID0gRkFM
U0U7CisJCQkJCX0KKwkJCQl9CisJCQl9CisKKwkJCWlmICgoY291bnQgPiAwKSAmJiAoY291bnQg
PCAxMDI0KSkKKwkJCQlleGZhdF9iaXRtYXBfc2V0KGJtYXAsIGNvdW50KTsKKwkJfQorCisJCWlm
IChwX2Rpci0+ZGlyID09IENMVVNURVJfMzIoMCkpCisJCQlicmVhazsgLyogRkFUMTYgcm9vdF9k
aXIgKi8KKworCQlpZiAoRkFUX3JlYWQoc2IsIGNsdS5kaXIsICZjbHUuZGlyKSAhPSAwKQorCQkJ
cmV0dXJuIEZGU19NRURJQUVSUjsKKwl9CisKKwljb3VudCA9IDA7CisJZm9yIChpID0gMDsgaSA8
IDEyODsgaSsrKSB7CisJCWlmIChibWFwW2ldICE9IDB4RkYpIHsKKwkJCWZvciAoaiA9IDA7IGog
PCA4OyBqKyspIHsKKwkJCQlpZiAoZXhmYXRfYml0bWFwX3Rlc3QoJmJtYXBbaV0sIGopID09IDAp
IHsKKwkJCQkJY291bnQgPSAoaSA8PCAzKSArIGo7CisJCQkJCWJyZWFrOworCQkJCX0KKwkJCX0K
KwkJCWlmIChjb3VudCAhPSAwKQorCQkJCWJyZWFrOworCQl9CisJfQorCisJaWYgKChjb3VudCA9
PSAwKSB8fCAoY291bnQgPj0gMTAyNCkpCisJCXJldHVybiBGRlNfRklMRUVYSVNUOworCWZhdF9h
dHRhY2hfY291bnRfdG9fZG9zX25hbWUocF9kb3NuYW1lLT5uYW1lLCBjb3VudCk7CisKKwkvKiBO
b3cgZG9zX25hbWUgaGFzIERPU34/Pz8/LkVYVCAqLworCXJldHVybiBGRlNfU1VDQ0VTUzsKK30K
Kwordm9pZCBmYXRfYXR0YWNoX2NvdW50X3RvX2Rvc19uYW1lKHU4ICpkb3NuYW1lLCBzMzIgY291
bnQpCit7CisJaW50IGksIGosIGxlbmd0aDsKKwljaGFyIHN0cl9jb3VudFs2XTsKKworCXNucHJp
bnRmKHN0cl9jb3VudCwgc2l6ZW9mKHN0cl9jb3VudCksICJ+JWQiLCBjb3VudCk7CisJbGVuZ3Ro
ID0gc3RybGVuKHN0cl9jb3VudCk7CisKKwlpID0gMDsKKwlqID0gMDsKKwl3aGlsZSAoaiA8PSAo
OCAtIGxlbmd0aCkpIHsKKwkJaSA9IGo7CisJCWlmIChkb3NuYW1lW2pdID09ICcgJykKKwkJCWJy
ZWFrOworCQlpZiAoZG9zbmFtZVtqXSAmIDB4ODApCisJCQlqICs9IDI7CisJCWVsc2UKKwkJCWor
KzsKKwl9CisKKwlmb3IgKGogPSAwOyBqIDwgbGVuZ3RoOyBpKyssIGorKykKKwkJZG9zbmFtZVtp
XSA9ICh1OClzdHJfY291bnRbal07CisKKwlpZiAoaSA9PSA3KQorCQlkb3NuYW1lWzddID0gJyAn
OworfQorCitzMzIgZmF0X2NhbGNfbnVtX2VudHJpZXMoc3RydWN0IHVuaV9uYW1lX3QgKnBfdW5p
bmFtZSkKK3sKKwlzMzIgbGVuOworCisJbGVuID0gcF91bmluYW1lLT5uYW1lX2xlbjsKKwlpZiAo
bGVuID09IDApCisJCXJldHVybiAwOworCisJLyogMSBkb3MgbmFtZSBlbnRyeSArIGV4dGVuZGVk
IGVudHJpZXMgKi8KKwlyZXR1cm4gKGxlbiAtIDEpIC8gMTMgKyAyOworfQorCitzMzIgZXhmYXRf
Y2FsY19udW1fZW50cmllcyhzdHJ1Y3QgdW5pX25hbWVfdCAqcF91bmluYW1lKQoreworCXMzMiBs
ZW47CisKKwlsZW4gPSBwX3VuaW5hbWUtPm5hbWVfbGVuOworCWlmIChsZW4gPT0gMCkKKwkJcmV0
dXJuIDA7CisKKwkvKiAxIGZpbGUgZW50cnkgKyAxIHN0cmVhbSBlbnRyeSArIG5hbWUgZW50cmll
cyAqLworCXJldHVybiAobGVuIC0gMSkgLyAxNSArIDM7Cit9CisKK3U4IGNhbGNfY2hlY2tzdW1f
MWJ5dGUodm9pZCAqZGF0YSwgczMyIGxlbiwgdTggY2hrc3VtKQoreworCWludCBpOworCXU4ICpj
ID0gKHU4ICopZGF0YTsKKworCWZvciAoaSA9IDA7IGkgPCBsZW47IGkrKywgYysrKQorCQljaGtz
dW0gPSAoKChjaGtzdW0gJiAxKSA8PCA3KSB8ICgoY2hrc3VtICYgMHhGRSkgPj4gMSkpICsgKmM7
CisKKwlyZXR1cm4gY2hrc3VtOworfQorCit1MTYgY2FsY19jaGVja3N1bV8yYnl0ZSh2b2lkICpk
YXRhLCBzMzIgbGVuLCB1MTYgY2hrc3VtLCBzMzIgdHlwZSkKK3sKKwlpbnQgaTsKKwl1OCAqYyA9
ICh1OCAqKWRhdGE7CisKKwlzd2l0Y2ggKHR5cGUpIHsKKwljYXNlIENTX0RJUl9FTlRSWToKKwkJ
Zm9yIChpID0gMDsgaSA8IGxlbjsgaSsrLCBjKyspIHsKKwkJCWlmICgoaSA9PSAyKSB8fCAoaSA9
PSAzKSkKKwkJCQljb250aW51ZTsKKwkJCWNoa3N1bSA9ICgoKGNoa3N1bSAmIDEpIDw8IDE1KSB8
CisJCQkJICAoKGNoa3N1bSAmIDB4RkZGRSkgPj4gMSkpICsgKHUxNikqYzsKKwkJfQorCQlicmVh
azsKKwlkZWZhdWx0CisJCQk6CisJCWZvciAoaSA9IDA7IGkgPCBsZW47IGkrKywgYysrKQorCQkJ
Y2hrc3VtID0gKCgoY2hrc3VtICYgMSkgPDwgMTUpIHwKKwkJCQkgICgoY2hrc3VtICYgMHhGRkZF
KSA+PiAxKSkgKyAodTE2KSpjOworCX0KKworCXJldHVybiBjaGtzdW07Cit9CisKK3UzMiBjYWxj
X2NoZWNrc3VtXzRieXRlKHZvaWQgKmRhdGEsIHMzMiBsZW4sIHUzMiBjaGtzdW0sIHMzMiB0eXBl
KQoreworCWludCBpOworCXU4ICpjID0gKHU4ICopZGF0YTsKKworCXN3aXRjaCAodHlwZSkgewor
CWNhc2UgQ1NfUEJSX1NFQ1RPUjoKKwkJZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrLCBjKyspIHsK
KwkJCWlmICgoaSA9PSAxMDYpIHx8IChpID09IDEwNykgfHwgKGkgPT0gMTEyKSkKKwkJCQljb250
aW51ZTsKKwkJCWNoa3N1bSA9ICgoKGNoa3N1bSAmIDEpIDw8IDMxKSB8CisJCQkJICAoKGNoa3N1
bSAmIDB4RkZGRkZGRkUpID4+IDEpKSArICh1MzIpKmM7CisJCX0KKwkJYnJlYWs7CisJZGVmYXVs
dAorCQkJOgorCQlmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyssIGMrKykKKwkJCWNoa3N1bSA9ICgo
KGNoa3N1bSAmIDEpIDw8IDMxKSB8CisJCQkJICAoKGNoa3N1bSAmIDB4RkZGRkZGRkUpID4+IDEp
KSArICh1MzIpKmM7CisJfQorCisJcmV0dXJuIGNoa3N1bTsKK30KKworLyoKKyAqICBOYW1lIFJl
c29sdXRpb24gRnVuY3Rpb25zCisgKi8KKworLyogcmV0dXJuIHZhbHVlcyBvZiByZXNvbHZlX3Bh
dGgoKQorICogPiAwIDogcmV0dXJuIHRoZSBsZW5ndGggb2YgdGhlIHBhdGgKKyAqIDwgMCA6IHJl
dHVybiBlcnJvcgorICovCitzMzIgcmVzb2x2ZV9wYXRoKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNo
YXIgKnBhdGgsIHN0cnVjdCBjaGFpbl90ICpwX2RpciwKKwkJIHN0cnVjdCB1bmlfbmFtZV90ICpw
X3VuaW5hbWUpCit7CisJYm9vbCBsb3NzeSA9IGZhbHNlOworCXN0cnVjdCBzdXBlcl9ibG9jayAq
c2IgPSBpbm9kZS0+aV9zYjsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihz
YiktPmZzX2luZm8pOworCXN0cnVjdCBmaWxlX2lkX3QgKmZpZCA9ICYoRVhGQVRfSShpbm9kZSkt
PmZpZCk7CisKKwlpZiAoc3RybGVuKHBhdGgpID49IChNQVhfTkFNRV9MRU5HVEggKiBNQVhfQ0hB
UlNFVF9TSVpFKSkKKwkJcmV0dXJuIEZGU19JTlZBTElEUEFUSDsKKworCXN0cmNweShuYW1lX2J1
ZiwgcGF0aCk7CisKKwlubHNfY3N0cmluZ190b191bmluYW1lKHNiLCBwX3VuaW5hbWUsIG5hbWVf
YnVmLCAmbG9zc3kpOworCWlmIChsb3NzeSkKKwkJcmV0dXJuIEZGU19JTlZBTElEUEFUSDsKKwor
CWZpZC0+c2l6ZSA9IGlfc2l6ZV9yZWFkKGlub2RlKTsKKworCXBfZGlyLT5kaXIgPSBmaWQtPnN0
YXJ0X2NsdTsKKwlwX2Rpci0+c2l6ZSA9IChzMzIpKGZpZC0+c2l6ZSA+PiBwX2ZzLT5jbHVzdGVy
X3NpemVfYml0cyk7CisJcF9kaXItPmZsYWdzID0gZmlkLT5mbGFnczsKKworCXJldHVybiBGRlNf
U1VDQ0VTUzsKK30KKworLyoKKyAqICBGaWxlIE9wZXJhdGlvbiBGdW5jdGlvbnMKKyAqLworc3Rh
dGljIHN0cnVjdCBmc19mdW5jIGZhdF9mc19mdW5jID0geworCS5hbGxvY19jbHVzdGVyID0gZmF0
X2FsbG9jX2NsdXN0ZXIsCisJLmZyZWVfY2x1c3RlciA9IGZhdF9mcmVlX2NsdXN0ZXIsCisJLmNv
dW50X3VzZWRfY2x1c3RlcnMgPSBmYXRfY291bnRfdXNlZF9jbHVzdGVycywKKworCS5pbml0X2Rp
cl9lbnRyeSA9IGZhdF9pbml0X2Rpcl9lbnRyeSwKKwkuaW5pdF9leHRfZW50cnkgPSBmYXRfaW5p
dF9leHRfZW50cnksCisJLmZpbmRfZGlyX2VudHJ5ID0gZmF0X2ZpbmRfZGlyX2VudHJ5LAorCS5k
ZWxldGVfZGlyX2VudHJ5ID0gZmF0X2RlbGV0ZV9kaXJfZW50cnksCisJLmdldF91bmlfbmFtZV9m
cm9tX2V4dF9lbnRyeSA9IGZhdF9nZXRfdW5pX25hbWVfZnJvbV9leHRfZW50cnksCisJLmNvdW50
X2V4dF9lbnRyaWVzID0gZmF0X2NvdW50X2V4dF9lbnRyaWVzLAorCS5jYWxjX251bV9lbnRyaWVz
ID0gZmF0X2NhbGNfbnVtX2VudHJpZXMsCisKKwkuZ2V0X2VudHJ5X3R5cGUgPSBmYXRfZ2V0X2Vu
dHJ5X3R5cGUsCisJLnNldF9lbnRyeV90eXBlID0gZmF0X3NldF9lbnRyeV90eXBlLAorCS5nZXRf
ZW50cnlfYXR0ciA9IGZhdF9nZXRfZW50cnlfYXR0ciwKKwkuc2V0X2VudHJ5X2F0dHIgPSBmYXRf
c2V0X2VudHJ5X2F0dHIsCisJLmdldF9lbnRyeV9mbGFnID0gZmF0X2dldF9lbnRyeV9mbGFnLAor
CS5zZXRfZW50cnlfZmxhZyA9IGZhdF9zZXRfZW50cnlfZmxhZywKKwkuZ2V0X2VudHJ5X2NsdTAg
PSBmYXRfZ2V0X2VudHJ5X2NsdTAsCisJLnNldF9lbnRyeV9jbHUwID0gZmF0X3NldF9lbnRyeV9j
bHUwLAorCS5nZXRfZW50cnlfc2l6ZSA9IGZhdF9nZXRfZW50cnlfc2l6ZSwKKwkuc2V0X2VudHJ5
X3NpemUgPSBmYXRfc2V0X2VudHJ5X3NpemUsCisJLmdldF9lbnRyeV90aW1lID0gZmF0X2dldF9l
bnRyeV90aW1lLAorCS5zZXRfZW50cnlfdGltZSA9IGZhdF9zZXRfZW50cnlfdGltZSwKK307CisK
K3MzMiBmYXQxNl9tb3VudChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgcGJyX3NlY3Rv
cl90ICpwX3BicikKK3sKKwlzMzIgbnVtX3Jlc2VydmVkLCBudW1fcm9vdF9zZWN0b3JzOworCXN0
cnVjdCBicGIxNl90ICpwX2JwYiA9IChzdHJ1Y3QgYnBiMTZfdCAqKXBfcGJyLT5icGI7CisJc3Ry
dWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3Qg
YmRfaW5mb190ICpwX2JkID0gJihFWEZBVF9TQihzYiktPmJkX2luZm8pOworCisJaWYgKHBfYnBi
LT5udW1fZmF0cyA9PSAwKQorCQlyZXR1cm4gRkZTX0ZPUk1BVEVSUjsKKworCW51bV9yb290X3Nl
Y3RvcnMgPSBHRVQxNihwX2JwYi0+bnVtX3Jvb3RfZW50cmllcykgPDwgREVOVFJZX1NJWkVfQklU
UzsKKwludW1fcm9vdF9zZWN0b3JzID0gKChudW1fcm9vdF9zZWN0b3JzIC0gMSkgPj4KKwkJCSAg
ICBwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzKSArIDE7CisKKwlwX2ZzLT5zZWN0b3JzX3Blcl9jbHUg
PSBwX2JwYi0+c2VjdG9yc19wZXJfY2x1OworCXBfZnMtPnNlY3RvcnNfcGVyX2NsdV9iaXRzID0g
aWxvZzIocF9icGItPnNlY3RvcnNfcGVyX2NsdSk7CisJcF9mcy0+Y2x1c3Rlcl9zaXplX2JpdHMg
PSBwX2ZzLT5zZWN0b3JzX3Blcl9jbHVfYml0cyArCisJCQkJICBwX2JkLT5zZWN0b3Jfc2l6ZV9i
aXRzOworCXBfZnMtPmNsdXN0ZXJfc2l6ZSA9IDEgPDwgcF9mcy0+Y2x1c3Rlcl9zaXplX2JpdHM7
CisKKwlwX2ZzLT5udW1fRkFUX3NlY3RvcnMgPSBHRVQxNihwX2JwYi0+bnVtX2ZhdF9zZWN0b3Jz
KTsKKworCXBfZnMtPkZBVDFfc3RhcnRfc2VjdG9yID0gcF9mcy0+UEJSX3NlY3RvciArIEdFVDE2
KHBfYnBiLT5udW1fcmVzZXJ2ZWQpOworCWlmIChwX2JwYi0+bnVtX2ZhdHMgPT0gMSkKKwkJcF9m
cy0+RkFUMl9zdGFydF9zZWN0b3IgPSBwX2ZzLT5GQVQxX3N0YXJ0X3NlY3RvcjsKKwllbHNlCisJ
CXBfZnMtPkZBVDJfc3RhcnRfc2VjdG9yID0gcF9mcy0+RkFUMV9zdGFydF9zZWN0b3IgKworCQkJ
CQkgIHBfZnMtPm51bV9GQVRfc2VjdG9yczsKKworCXBfZnMtPnJvb3Rfc3RhcnRfc2VjdG9yID0g
cF9mcy0+RkFUMl9zdGFydF9zZWN0b3IgKworCQkJCSAgcF9mcy0+bnVtX0ZBVF9zZWN0b3JzOwor
CXBfZnMtPmRhdGFfc3RhcnRfc2VjdG9yID0gcF9mcy0+cm9vdF9zdGFydF9zZWN0b3IgKyBudW1f
cm9vdF9zZWN0b3JzOworCisJcF9mcy0+bnVtX3NlY3RvcnMgPSBHRVQxNihwX2JwYi0+bnVtX3Nl
Y3RvcnMpOworCWlmIChwX2ZzLT5udW1fc2VjdG9ycyA9PSAwKQorCQlwX2ZzLT5udW1fc2VjdG9y
cyA9IEdFVDMyKHBfYnBiLT5udW1faHVnZV9zZWN0b3JzKTsKKworCW51bV9yZXNlcnZlZCA9IHBf
ZnMtPmRhdGFfc3RhcnRfc2VjdG9yIC0gcF9mcy0+UEJSX3NlY3RvcjsKKwlwX2ZzLT5udW1fY2x1
c3RlcnMgPSAoKHBfZnMtPm51bV9zZWN0b3JzIC0gbnVtX3Jlc2VydmVkKSA+PgorCQkJICAgICAg
cF9mcy0+c2VjdG9yc19wZXJfY2x1X2JpdHMpICsgMjsKKwkvKiBiZWNhdXNlIHRoZSBjbHVzdGVy
IGluZGV4IHN0YXJ0cyB3aXRoIDIgKi8KKworCWlmIChwX2ZzLT5udW1fY2x1c3RlcnMgPCBGQVQx
Ml9USFJFU0hPTEQpCisJCXBfZnMtPnZvbF90eXBlID0gRkFUMTI7CisJZWxzZQorCQlwX2ZzLT52
b2xfdHlwZSA9IEZBVDE2OworCXBfZnMtPnZvbF9pZCA9IEdFVDMyKHBfYnBiLT52b2xfc2VyaWFs
KTsKKworCXBfZnMtPnJvb3RfZGlyID0gMDsKKwlwX2ZzLT5kZW50cmllc19pbl9yb290ID0gR0VU
MTYocF9icGItPm51bV9yb290X2VudHJpZXMpOworCXBfZnMtPmRlbnRyaWVzX3Blcl9jbHUgPSAx
IDw8IChwX2ZzLT5jbHVzdGVyX3NpemVfYml0cyAtCisJCQkJICAgICAgIERFTlRSWV9TSVpFX0JJ
VFMpOworCisJcF9mcy0+dm9sX2ZsYWcgPSBWT0xfQ0xFQU47CisJcF9mcy0+Y2x1X3NyY2hfcHRy
ID0gMjsKKwlwX2ZzLT51c2VkX2NsdXN0ZXJzID0gKHUzMil+MDsKKworCXBfZnMtPmZzX2Z1bmMg
PSAmZmF0X2ZzX2Z1bmM7CisKKwlyZXR1cm4gRkZTX1NVQ0NFU1M7Cit9CisKK3MzMiBmYXQzMl9t
b3VudChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgcGJyX3NlY3Rvcl90ICpwX3BicikK
K3sKKwlzMzIgbnVtX3Jlc2VydmVkOworCXN0cnVjdCBicGIzMl90ICpwX2JwYiA9IChzdHJ1Y3Qg
YnBiMzJfdCAqKXBfcGJyLT5icGI7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRf
U0Ioc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihFWEZBVF9TQihz
YiktPmJkX2luZm8pOworCisJaWYgKHBfYnBiLT5udW1fZmF0cyA9PSAwKQorCQlyZXR1cm4gRkZT
X0ZPUk1BVEVSUjsKKworCXBfZnMtPnNlY3RvcnNfcGVyX2NsdSA9IHBfYnBiLT5zZWN0b3JzX3Bl
cl9jbHU7CisJcF9mcy0+c2VjdG9yc19wZXJfY2x1X2JpdHMgPSBpbG9nMihwX2JwYi0+c2VjdG9y
c19wZXJfY2x1KTsKKwlwX2ZzLT5jbHVzdGVyX3NpemVfYml0cyA9IHBfZnMtPnNlY3RvcnNfcGVy
X2NsdV9iaXRzICsKKwkJCQkgIHBfYmQtPnNlY3Rvcl9zaXplX2JpdHM7CisJcF9mcy0+Y2x1c3Rl
cl9zaXplID0gMSA8PCBwX2ZzLT5jbHVzdGVyX3NpemVfYml0czsKKworCXBfZnMtPm51bV9GQVRf
c2VjdG9ycyA9IEdFVDMyKHBfYnBiLT5udW1fZmF0MzJfc2VjdG9ycyk7CisKKwlwX2ZzLT5GQVQx
X3N0YXJ0X3NlY3RvciA9IHBfZnMtPlBCUl9zZWN0b3IgKyBHRVQxNihwX2JwYi0+bnVtX3Jlc2Vy
dmVkKTsKKwlpZiAocF9icGItPm51bV9mYXRzID09IDEpCisJCXBfZnMtPkZBVDJfc3RhcnRfc2Vj
dG9yID0gcF9mcy0+RkFUMV9zdGFydF9zZWN0b3I7CisJZWxzZQorCQlwX2ZzLT5GQVQyX3N0YXJ0
X3NlY3RvciA9IHBfZnMtPkZBVDFfc3RhcnRfc2VjdG9yICsKKwkJCQkJICBwX2ZzLT5udW1fRkFU
X3NlY3RvcnM7CisKKwlwX2ZzLT5yb290X3N0YXJ0X3NlY3RvciA9IHBfZnMtPkZBVDJfc3RhcnRf
c2VjdG9yICsKKwkJCQkgIHBfZnMtPm51bV9GQVRfc2VjdG9yczsKKwlwX2ZzLT5kYXRhX3N0YXJ0
X3NlY3RvciA9IHBfZnMtPnJvb3Rfc3RhcnRfc2VjdG9yOworCisJcF9mcy0+bnVtX3NlY3RvcnMg
PSBHRVQzMihwX2JwYi0+bnVtX2h1Z2Vfc2VjdG9ycyk7CisJbnVtX3Jlc2VydmVkID0gcF9mcy0+
ZGF0YV9zdGFydF9zZWN0b3IgLSBwX2ZzLT5QQlJfc2VjdG9yOworCisJcF9mcy0+bnVtX2NsdXN0
ZXJzID0gKChwX2ZzLT5udW1fc2VjdG9ycyAtIG51bV9yZXNlcnZlZCkgPj4KKwkJCSAgICAgIHBf
ZnMtPnNlY3RvcnNfcGVyX2NsdV9iaXRzKSArIDI7CisJLyogYmVjYXVzZSB0aGUgY2x1c3RlciBp
bmRleCBzdGFydHMgd2l0aCAyICovCisKKwlwX2ZzLT52b2xfdHlwZSA9IEZBVDMyOworCXBfZnMt
PnZvbF9pZCA9IEdFVDMyKHBfYnBiLT52b2xfc2VyaWFsKTsKKworCXBfZnMtPnJvb3RfZGlyID0g
R0VUMzIocF9icGItPnJvb3RfY2x1c3Rlcik7CisJcF9mcy0+ZGVudHJpZXNfaW5fcm9vdCA9IDA7
CisJcF9mcy0+ZGVudHJpZXNfcGVyX2NsdSA9IDEgPDwgKHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRz
IC0KKwkJCQkgICAgICAgREVOVFJZX1NJWkVfQklUUyk7CisKKwlwX2ZzLT52b2xfZmxhZyA9IFZP
TF9DTEVBTjsKKwlwX2ZzLT5jbHVfc3JjaF9wdHIgPSAyOworCXBfZnMtPnVzZWRfY2x1c3RlcnMg
PSAodTMyKX4wOworCisJcF9mcy0+ZnNfZnVuYyA9ICZmYXRfZnNfZnVuYzsKKworCXJldHVybiBG
RlNfU1VDQ0VTUzsKK30KKworc3RhdGljIHN0cnVjdCBmc19mdW5jIGV4ZmF0X2ZzX2Z1bmMgPSB7
CisJLmFsbG9jX2NsdXN0ZXIgPSBleGZhdF9hbGxvY19jbHVzdGVyLAorCS5mcmVlX2NsdXN0ZXIg
PSBleGZhdF9mcmVlX2NsdXN0ZXIsCisJLmNvdW50X3VzZWRfY2x1c3RlcnMgPSBleGZhdF9jb3Vu
dF91c2VkX2NsdXN0ZXJzLAorCisJLmluaXRfZGlyX2VudHJ5ID0gZXhmYXRfaW5pdF9kaXJfZW50
cnksCisJLmluaXRfZXh0X2VudHJ5ID0gZXhmYXRfaW5pdF9leHRfZW50cnksCisJLmZpbmRfZGly
X2VudHJ5ID0gZXhmYXRfZmluZF9kaXJfZW50cnksCisJLmRlbGV0ZV9kaXJfZW50cnkgPSBleGZh
dF9kZWxldGVfZGlyX2VudHJ5LAorCS5nZXRfdW5pX25hbWVfZnJvbV9leHRfZW50cnkgPSBleGZh
dF9nZXRfdW5pX25hbWVfZnJvbV9leHRfZW50cnksCisJLmNvdW50X2V4dF9lbnRyaWVzID0gZXhm
YXRfY291bnRfZXh0X2VudHJpZXMsCisJLmNhbGNfbnVtX2VudHJpZXMgPSBleGZhdF9jYWxjX251
bV9lbnRyaWVzLAorCisJLmdldF9lbnRyeV90eXBlID0gZXhmYXRfZ2V0X2VudHJ5X3R5cGUsCisJ
LnNldF9lbnRyeV90eXBlID0gZXhmYXRfc2V0X2VudHJ5X3R5cGUsCisJLmdldF9lbnRyeV9hdHRy
ID0gZXhmYXRfZ2V0X2VudHJ5X2F0dHIsCisJLnNldF9lbnRyeV9hdHRyID0gZXhmYXRfc2V0X2Vu
dHJ5X2F0dHIsCisJLmdldF9lbnRyeV9mbGFnID0gZXhmYXRfZ2V0X2VudHJ5X2ZsYWcsCisJLnNl
dF9lbnRyeV9mbGFnID0gZXhmYXRfc2V0X2VudHJ5X2ZsYWcsCisJLmdldF9lbnRyeV9jbHUwID0g
ZXhmYXRfZ2V0X2VudHJ5X2NsdTAsCisJLnNldF9lbnRyeV9jbHUwID0gZXhmYXRfc2V0X2VudHJ5
X2NsdTAsCisJLmdldF9lbnRyeV9zaXplID0gZXhmYXRfZ2V0X2VudHJ5X3NpemUsCisJLnNldF9l
bnRyeV9zaXplID0gZXhmYXRfc2V0X2VudHJ5X3NpemUsCisJLmdldF9lbnRyeV90aW1lID0gZXhm
YXRfZ2V0X2VudHJ5X3RpbWUsCisJLnNldF9lbnRyeV90aW1lID0gZXhmYXRfc2V0X2VudHJ5X3Rp
bWUsCit9OworCitzMzIgZXhmYXRfbW91bnQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0
IHBicl9zZWN0b3JfdCAqcF9wYnIpCit7CisJc3RydWN0IGJwYmV4X3QgKnBfYnBiID0gKHN0cnVj
dCBicGJleF90ICopcF9wYnItPmJwYjsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZB
VF9TQihzYiktPmZzX2luZm8pOworCXN0cnVjdCBiZF9pbmZvX3QgKnBfYmQgPSAmKEVYRkFUX1NC
KHNiKS0+YmRfaW5mbyk7CisKKwlpZiAocF9icGItPm51bV9mYXRzID09IDApCisJCXJldHVybiBG
RlNfRk9STUFURVJSOworCisJcF9mcy0+c2VjdG9yc19wZXJfY2x1ID0gMSA8PCBwX2JwYi0+c2Vj
dG9yc19wZXJfY2x1X2JpdHM7CisJcF9mcy0+c2VjdG9yc19wZXJfY2x1X2JpdHMgPSBwX2JwYi0+
c2VjdG9yc19wZXJfY2x1X2JpdHM7CisJcF9mcy0+Y2x1c3Rlcl9zaXplX2JpdHMgPSBwX2ZzLT5z
ZWN0b3JzX3Blcl9jbHVfYml0cyArCisJCQkJICBwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzOworCXBf
ZnMtPmNsdXN0ZXJfc2l6ZSA9IDEgPDwgcF9mcy0+Y2x1c3Rlcl9zaXplX2JpdHM7CisKKwlwX2Zz
LT5udW1fRkFUX3NlY3RvcnMgPSBHRVQzMihwX2JwYi0+ZmF0X2xlbmd0aCk7CisKKwlwX2ZzLT5G
QVQxX3N0YXJ0X3NlY3RvciA9IHBfZnMtPlBCUl9zZWN0b3IgKyBHRVQzMihwX2JwYi0+ZmF0X29m
ZnNldCk7CisJaWYgKHBfYnBiLT5udW1fZmF0cyA9PSAxKQorCQlwX2ZzLT5GQVQyX3N0YXJ0X3Nl
Y3RvciA9IHBfZnMtPkZBVDFfc3RhcnRfc2VjdG9yOworCWVsc2UKKwkJcF9mcy0+RkFUMl9zdGFy
dF9zZWN0b3IgPSBwX2ZzLT5GQVQxX3N0YXJ0X3NlY3RvciArCisJCQkJCSAgcF9mcy0+bnVtX0ZB
VF9zZWN0b3JzOworCisJcF9mcy0+cm9vdF9zdGFydF9zZWN0b3IgPSBwX2ZzLT5QQlJfc2VjdG9y
ICsgR0VUMzIocF9icGItPmNsdV9vZmZzZXQpOworCXBfZnMtPmRhdGFfc3RhcnRfc2VjdG9yID0g
cF9mcy0+cm9vdF9zdGFydF9zZWN0b3I7CisKKwlwX2ZzLT5udW1fc2VjdG9ycyA9IEdFVDY0KHBf
YnBiLT52b2xfbGVuZ3RoKTsKKwlwX2ZzLT5udW1fY2x1c3RlcnMgPSBHRVQzMihwX2JwYi0+Y2x1
X2NvdW50KSArIDI7CisJLyogYmVjYXVzZSB0aGUgY2x1c3RlciBpbmRleCBzdGFydHMgd2l0aCAy
ICovCisKKwlwX2ZzLT52b2xfdHlwZSA9IEVYRkFUOworCXBfZnMtPnZvbF9pZCA9IEdFVDMyKHBf
YnBiLT52b2xfc2VyaWFsKTsKKworCXBfZnMtPnJvb3RfZGlyID0gR0VUMzIocF9icGItPnJvb3Rf
Y2x1c3Rlcik7CisJcF9mcy0+ZGVudHJpZXNfaW5fcm9vdCA9IDA7CisJcF9mcy0+ZGVudHJpZXNf
cGVyX2NsdSA9IDEgPDwgKHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzIC0KKwkJCQkgICAgICAgREVO
VFJZX1NJWkVfQklUUyk7CisKKwlwX2ZzLT52b2xfZmxhZyA9ICh1MzIpR0VUMTYocF9icGItPnZv
bF9mbGFncyk7CisJcF9mcy0+Y2x1X3NyY2hfcHRyID0gMjsKKwlwX2ZzLT51c2VkX2NsdXN0ZXJz
ID0gKHUzMil+MDsKKworCXBfZnMtPmZzX2Z1bmMgPSAmZXhmYXRfZnNfZnVuYzsKKworCXJldHVy
biBGRlNfU1VDQ0VTUzsKK30KKworczMyIGNyZWF0ZV9kaXIoc3RydWN0IGlub2RlICppbm9kZSwg
c3RydWN0IGNoYWluX3QgKnBfZGlyLAorCSAgICAgICBzdHJ1Y3QgdW5pX25hbWVfdCAqcF91bmlu
YW1lLCBzdHJ1Y3QgZmlsZV9pZF90ICpmaWQpCit7CisJczMyIHJldCwgZGVudHJ5LCBudW1fZW50
cmllczsKKwl1NjQgc2l6ZTsKKwlzdHJ1Y3QgY2hhaW5fdCBjbHU7CisJc3RydWN0IGRvc19uYW1l
X3QgZG9zX25hbWUsIGRvdF9uYW1lOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+
aV9zYjsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8p
OworCXN0cnVjdCBmc19mdW5jICpmc19mdW5jID0gcF9mcy0+ZnNfZnVuYzsKKworCXJldCA9IGdl
dF9udW1fZW50cmllc19hbmRfZG9zX25hbWUoc2IsIHBfZGlyLCBwX3VuaW5hbWUsICZudW1fZW50
cmllcywKKwkJCQkJICAgJmRvc19uYW1lKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJ
LyogZmluZF9lbXB0eV9lbnRyeSBtdXN0IGJlIGNhbGxlZCBiZWZvcmUgYWxsb2NfY2x1c3RlciAq
LworCWRlbnRyeSA9IGZpbmRfZW1wdHlfZW50cnkoaW5vZGUsIHBfZGlyLCBudW1fZW50cmllcyk7
CisJaWYgKGRlbnRyeSA8IDApCisJCXJldHVybiBGRlNfRlVMTDsKKworCWNsdS5kaXIgPSBDTFVT
VEVSXzMyKH4wKTsKKwljbHUuc2l6ZSA9IDA7CisJY2x1LmZsYWdzID0gKHBfZnMtPnZvbF90eXBl
ID09IEVYRkFUKSA/IDB4MDMgOiAweDAxOworCisJLyogKDEpIGFsbG9jYXRlIGEgY2x1c3RlciAq
LworCXJldCA9IGZzX2Z1bmMtPmFsbG9jX2NsdXN0ZXIoc2IsIDEsICZjbHUpOworCWlmIChyZXQg
PCAwKQorCQlyZXR1cm4gRkZTX01FRElBRVJSOworCWVsc2UgaWYgKHJldCA9PSAwKQorCQlyZXR1
cm4gRkZTX0ZVTEw7CisKKwlyZXQgPSBjbGVhcl9jbHVzdGVyKHNiLCBjbHUuZGlyKTsKKwlpZiAo
cmV0ICE9IEZGU19TVUNDRVNTKQorCQlyZXR1cm4gcmV0OworCisJaWYgKHBfZnMtPnZvbF90eXBl
ID09IEVYRkFUKSB7CisJCXNpemUgPSBwX2ZzLT5jbHVzdGVyX3NpemU7CisJfSBlbHNlIHsKKwkJ
c2l6ZSA9IDA7CisKKwkJLyogaW5pdGlhbGl6ZSB0aGUgLiBhbmQgLi4gZW50cnkKKwkJICogSW5m
b3JtYXRpb24gZm9yIC4gcG9pbnRzIHRvIGl0c2VsZgorCQkgKiBJbmZvcm1hdGlvbiBmb3IgLi4g
cG9pbnRzIHRvIHBhcmVudCBkaXIKKwkJICovCisKKwkJZG90X25hbWUubmFtZV9jYXNlID0gMHgw
OworCQltZW1jcHkoZG90X25hbWUubmFtZSwgRE9TX0NVUl9ESVJfTkFNRSwgRE9TX05BTUVfTEVO
R1RIKTsKKworCQlyZXQgPSBmc19mdW5jLT5pbml0X2Rpcl9lbnRyeShzYiwgJmNsdSwgMCwgVFlQ
RV9ESVIsIGNsdS5kaXIsCisJCQkJCSAgICAgIDApOworCQlpZiAocmV0ICE9IEZGU19TVUNDRVNT
KQorCQkJcmV0dXJuIHJldDsKKworCQlyZXQgPSBmc19mdW5jLT5pbml0X2V4dF9lbnRyeShzYiwg
JmNsdSwgMCwgMSwgTlVMTCwgJmRvdF9uYW1lKTsKKwkJaWYgKHJldCAhPSBGRlNfU1VDQ0VTUykK
KwkJCXJldHVybiByZXQ7CisKKwkJbWVtY3B5KGRvdF9uYW1lLm5hbWUsIERPU19QQVJfRElSX05B
TUUsIERPU19OQU1FX0xFTkdUSCk7CisKKwkJaWYgKHBfZGlyLT5kaXIgPT0gcF9mcy0+cm9vdF9k
aXIpCisJCQlyZXQgPSBmc19mdW5jLT5pbml0X2Rpcl9lbnRyeShzYiwgJmNsdSwgMSwgVFlQRV9E
SVIsCisJCQkJCQkgICAgICBDTFVTVEVSXzMyKDApLCAwKTsKKwkJZWxzZQorCQkJcmV0ID0gZnNf
ZnVuYy0+aW5pdF9kaXJfZW50cnkoc2IsICZjbHUsIDEsIFRZUEVfRElSLAorCQkJCQkJICAgICAg
cF9kaXItPmRpciwgMCk7CisKKwkJaWYgKHJldCAhPSBGRlNfU1VDQ0VTUykKKwkJCXJldHVybiBy
ZXQ7CisKKwkJcmV0ID0gcF9mcy0+ZnNfZnVuYy0+aW5pdF9leHRfZW50cnkoc2IsICZjbHUsIDEs
IDEsIE5VTEwsCisJCQkJCQkgICAgJmRvdF9uYW1lKTsKKwkJaWYgKHJldCAhPSBGRlNfU1VDQ0VT
UykKKwkJCXJldHVybiByZXQ7CisJfQorCisJLyogKDIpIHVwZGF0ZSB0aGUgZGlyZWN0b3J5IGVu
dHJ5ICovCisJLyogbWFrZSBzdWItZGlyIGVudHJ5IGluIHBhcmVudCBkaXJlY3RvcnkgKi8KKwly
ZXQgPSBmc19mdW5jLT5pbml0X2Rpcl9lbnRyeShzYiwgcF9kaXIsIGRlbnRyeSwgVFlQRV9ESVIs
IGNsdS5kaXIsCisJCQkJICAgICAgc2l6ZSk7CisJaWYgKHJldCAhPSBGRlNfU1VDQ0VTUykKKwkJ
cmV0dXJuIHJldDsKKworCXJldCA9IGZzX2Z1bmMtPmluaXRfZXh0X2VudHJ5KHNiLCBwX2Rpciwg
ZGVudHJ5LCBudW1fZW50cmllcywgcF91bmluYW1lLAorCQkJCSAgICAgICZkb3NfbmFtZSk7CisJ
aWYgKHJldCAhPSBGRlNfU1VDQ0VTUykKKwkJcmV0dXJuIHJldDsKKworCWZpZC0+ZGlyLmRpciA9
IHBfZGlyLT5kaXI7CisJZmlkLT5kaXIuc2l6ZSA9IHBfZGlyLT5zaXplOworCWZpZC0+ZGlyLmZs
YWdzID0gcF9kaXItPmZsYWdzOworCWZpZC0+ZW50cnkgPSBkZW50cnk7CisKKwlmaWQtPmF0dHIg
PSBBVFRSX1NVQkRJUjsKKwlmaWQtPmZsYWdzID0gKHBfZnMtPnZvbF90eXBlID09IEVYRkFUKSA/
IDB4MDMgOiAweDAxOworCWZpZC0+c2l6ZSA9IHNpemU7CisJZmlkLT5zdGFydF9jbHUgPSBjbHUu
ZGlyOworCisJZmlkLT50eXBlID0gVFlQRV9ESVI7CisJZmlkLT5yd29mZnNldCA9IDA7CisJZmlk
LT5oaW50X2xhc3Rfb2ZmID0gLTE7CisKKwlyZXR1cm4gRkZTX1NVQ0NFU1M7Cit9CisKK3MzMiBj
cmVhdGVfZmlsZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIsCisJ
CXN0cnVjdCB1bmlfbmFtZV90ICpwX3VuaW5hbWUsIHU4IG1vZGUsIHN0cnVjdCBmaWxlX2lkX3Qg
KmZpZCkKK3sKKwlzMzIgcmV0LCBkZW50cnksIG51bV9lbnRyaWVzOworCXN0cnVjdCBkb3NfbmFt
ZV90IGRvc19uYW1lOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKKwlz
dHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0cnVj
dCBmc19mdW5jICpmc19mdW5jID0gcF9mcy0+ZnNfZnVuYzsKKworCXJldCA9IGdldF9udW1fZW50
cmllc19hbmRfZG9zX25hbWUoc2IsIHBfZGlyLCBwX3VuaW5hbWUsICZudW1fZW50cmllcywKKwkJ
CQkJICAgJmRvc19uYW1lKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJLyogZmluZF9l
bXB0eV9lbnRyeSBtdXN0IGJlIGNhbGxlZCBiZWZvcmUgYWxsb2NfY2x1c3RlcigpICovCisJZGVu
dHJ5ID0gZmluZF9lbXB0eV9lbnRyeShpbm9kZSwgcF9kaXIsIG51bV9lbnRyaWVzKTsKKwlpZiAo
ZGVudHJ5IDwgMCkKKwkJcmV0dXJuIEZGU19GVUxMOworCisJLyogKDEpIHVwZGF0ZSB0aGUgZGly
ZWN0b3J5IGVudHJ5ICovCisJLyogZmlsbCB0aGUgZG9zIG5hbWUgZGlyZWN0b3J5IGVudHJ5IGlu
Zm9ybWF0aW9uIG9mIHRoZSBjcmVhdGVkIGZpbGUuCisJICogdGhlIGZpcnN0IGNsdXN0ZXIgaXMg
bm90IGRldGVybWluZWQgeWV0LiAoMCkKKwkgKi8KKwlyZXQgPSBmc19mdW5jLT5pbml0X2Rpcl9l
bnRyeShzYiwgcF9kaXIsIGRlbnRyeSwgVFlQRV9GSUxFIHwgbW9kZSwKKwkJCQkgICAgICBDTFVT
VEVSXzMyKDApLCAwKTsKKwlpZiAocmV0ICE9IEZGU19TVUNDRVNTKQorCQlyZXR1cm4gcmV0Owor
CisJcmV0ID0gZnNfZnVuYy0+aW5pdF9leHRfZW50cnkoc2IsIHBfZGlyLCBkZW50cnksIG51bV9l
bnRyaWVzLCBwX3VuaW5hbWUsCisJCQkJICAgICAgJmRvc19uYW1lKTsKKwlpZiAocmV0ICE9IEZG
U19TVUNDRVNTKQorCQlyZXR1cm4gcmV0OworCisJZmlkLT5kaXIuZGlyID0gcF9kaXItPmRpcjsK
KwlmaWQtPmRpci5zaXplID0gcF9kaXItPnNpemU7CisJZmlkLT5kaXIuZmxhZ3MgPSBwX2Rpci0+
ZmxhZ3M7CisJZmlkLT5lbnRyeSA9IGRlbnRyeTsKKworCWZpZC0+YXR0ciA9IEFUVFJfQVJDSElW
RSB8IG1vZGU7CisJZmlkLT5mbGFncyA9IChwX2ZzLT52b2xfdHlwZSA9PSBFWEZBVCkgPyAweDAz
IDogMHgwMTsKKwlmaWQtPnNpemUgPSAwOworCWZpZC0+c3RhcnRfY2x1ID0gQ0xVU1RFUl8zMih+
MCk7CisKKwlmaWQtPnR5cGUgPSBUWVBFX0ZJTEU7CisJZmlkLT5yd29mZnNldCA9IDA7CisJZmlk
LT5oaW50X2xhc3Rfb2ZmID0gLTE7CisKKwlyZXR1cm4gRkZTX1NVQ0NFU1M7Cit9CisKK3ZvaWQg
cmVtb3ZlX2ZpbGUoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGNoYWluX3QgKnBfZGlyLCBz
MzIgZW50cnkpCit7CisJczMyIG51bV9lbnRyaWVzOworCXNlY3Rvcl90IHNlY3RvcjsKKwlzdHJ1
Y3QgZGVudHJ5X3QgKmVwOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsK
KwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0
cnVjdCBmc19mdW5jICpmc19mdW5jID0gcF9mcy0+ZnNfZnVuYzsKKworCWVwID0gZ2V0X2VudHJ5
X2luX2RpcihzYiwgcF9kaXIsIGVudHJ5LCAmc2VjdG9yKTsKKwlpZiAoIWVwKQorCQlyZXR1cm47
CisKKwlidWZfbG9jayhzYiwgc2VjdG9yKTsKKworCS8qIGJ1Zl9sb2NrKCkgYmVmb3JlIGNhbGwg
Y291bnRfZXh0X2VudHJpZXMoKSAqLworCW51bV9lbnRyaWVzID0gZnNfZnVuYy0+Y291bnRfZXh0
X2VudHJpZXMoc2IsIHBfZGlyLCBlbnRyeSwgZXApOworCWlmIChudW1fZW50cmllcyA8IDApIHsK
KwkJYnVmX3VubG9jayhzYiwgc2VjdG9yKTsKKwkJcmV0dXJuOworCX0KKwludW1fZW50cmllcysr
OworCisJYnVmX3VubG9jayhzYiwgc2VjdG9yKTsKKworCS8qICgxKSB1cGRhdGUgdGhlIGRpcmVj
dG9yeSBlbnRyeSAqLworCWZzX2Z1bmMtPmRlbGV0ZV9kaXJfZW50cnkoc2IsIHBfZGlyLCBlbnRy
eSwgMCwgbnVtX2VudHJpZXMpOworfQorCitzMzIgcmVuYW1lX2ZpbGUoc3RydWN0IGlub2RlICpp
bm9kZSwgc3RydWN0IGNoYWluX3QgKnBfZGlyLCBzMzIgb2xkZW50cnksCisJCXN0cnVjdCB1bmlf
bmFtZV90ICpwX3VuaW5hbWUsIHN0cnVjdCBmaWxlX2lkX3QgKmZpZCkKK3sKKwlzMzIgcmV0LCBu
ZXdlbnRyeSA9IC0xLCBudW1fb2xkX2VudHJpZXMsIG51bV9uZXdfZW50cmllczsKKwlzZWN0b3Jf
dCBzZWN0b3Jfb2xkLCBzZWN0b3JfbmV3OworCXN0cnVjdCBkb3NfbmFtZV90IGRvc19uYW1lOwor
CXN0cnVjdCBkZW50cnlfdCAqZXBvbGQsICplcG5ldzsKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
ID0gaW5vZGUtPmlfc2I7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2Ip
LT5mc19pbmZvKTsKKwlzdHJ1Y3QgZnNfZnVuYyAqZnNfZnVuYyA9IHBfZnMtPmZzX2Z1bmM7CisK
KwllcG9sZCA9IGdldF9lbnRyeV9pbl9kaXIoc2IsIHBfZGlyLCBvbGRlbnRyeSwgJnNlY3Rvcl9v
bGQpOworCWlmICghZXBvbGQpCisJCXJldHVybiBGRlNfTUVESUFFUlI7CisKKwlidWZfbG9jayhz
Yiwgc2VjdG9yX29sZCk7CisKKwkvKiBidWZfbG9jaygpIGJlZm9yZSBjYWxsIGNvdW50X2V4dF9l
bnRyaWVzKCkgKi8KKwludW1fb2xkX2VudHJpZXMgPSBmc19mdW5jLT5jb3VudF9leHRfZW50cmll
cyhzYiwgcF9kaXIsIG9sZGVudHJ5LAorCQkJCQkJICAgICBlcG9sZCk7CisJaWYgKG51bV9vbGRf
ZW50cmllcyA8IDApIHsKKwkJYnVmX3VubG9jayhzYiwgc2VjdG9yX29sZCk7CisJCXJldHVybiBG
RlNfTUVESUFFUlI7CisJfQorCW51bV9vbGRfZW50cmllcysrOworCisJcmV0ID0gZ2V0X251bV9l
bnRyaWVzX2FuZF9kb3NfbmFtZShzYiwgcF9kaXIsIHBfdW5pbmFtZSwKKwkJCQkJICAgJm51bV9u
ZXdfZW50cmllcywgJmRvc19uYW1lKTsKKwlpZiAocmV0KSB7CisJCWJ1Zl91bmxvY2soc2IsIHNl
Y3Rvcl9vbGQpOworCQlyZXR1cm4gcmV0OworCX0KKworCWlmIChudW1fb2xkX2VudHJpZXMgPCBu
dW1fbmV3X2VudHJpZXMpIHsKKwkJbmV3ZW50cnkgPSBmaW5kX2VtcHR5X2VudHJ5KGlub2RlLCBw
X2RpciwgbnVtX25ld19lbnRyaWVzKTsKKwkJaWYgKG5ld2VudHJ5IDwgMCkgeworCQkJYnVmX3Vu
bG9jayhzYiwgc2VjdG9yX29sZCk7CisJCQlyZXR1cm4gRkZTX0ZVTEw7CisJCX0KKworCQllcG5l
dyA9IGdldF9lbnRyeV9pbl9kaXIoc2IsIHBfZGlyLCBuZXdlbnRyeSwgJnNlY3Rvcl9uZXcpOwor
CQlpZiAoIWVwbmV3KSB7CisJCQlidWZfdW5sb2NrKHNiLCBzZWN0b3Jfb2xkKTsKKwkJCXJldHVy
biBGRlNfTUVESUFFUlI7CisJCX0KKworCQltZW1jcHkoKHZvaWQgKillcG5ldywgKHZvaWQgKill
cG9sZCwgREVOVFJZX1NJWkUpOworCQlpZiAoZnNfZnVuYy0+Z2V0X2VudHJ5X3R5cGUoZXBuZXcp
ID09IFRZUEVfRklMRSkgeworCQkJZnNfZnVuYy0+c2V0X2VudHJ5X2F0dHIoZXBuZXcsCisJCQkJ
CQlmc19mdW5jLT5nZXRfZW50cnlfYXR0cihlcG5ldykgfAorCQkJCQkJQVRUUl9BUkNISVZFKTsK
KwkJCWZpZC0+YXR0ciB8PSBBVFRSX0FSQ0hJVkU7CisJCX0KKwkJYnVmX21vZGlmeShzYiwgc2Vj
dG9yX25ldyk7CisJCWJ1Zl91bmxvY2soc2IsIHNlY3Rvcl9vbGQpOworCisJCWlmIChwX2ZzLT52
b2xfdHlwZSA9PSBFWEZBVCkgeworCQkJZXBvbGQgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCBwX2Rp
ciwgb2xkZW50cnkgKyAxLAorCQkJCQkJICZzZWN0b3Jfb2xkKTsKKwkJCWJ1Zl9sb2NrKHNiLCBz
ZWN0b3Jfb2xkKTsKKwkJCWVwbmV3ID0gZ2V0X2VudHJ5X2luX2RpcihzYiwgcF9kaXIsIG5ld2Vu
dHJ5ICsgMSwKKwkJCQkJCSAmc2VjdG9yX25ldyk7CisKKwkJCWlmICghZXBvbGQgfHwgIWVwbmV3
KSB7CisJCQkJYnVmX3VubG9jayhzYiwgc2VjdG9yX29sZCk7CisJCQkJcmV0dXJuIEZGU19NRURJ
QUVSUjsKKwkJCX0KKworCQkJbWVtY3B5KCh2b2lkICopZXBuZXcsICh2b2lkICopZXBvbGQsIERF
TlRSWV9TSVpFKTsKKwkJCWJ1Zl9tb2RpZnkoc2IsIHNlY3Rvcl9uZXcpOworCQkJYnVmX3VubG9j
ayhzYiwgc2VjdG9yX29sZCk7CisJCX0KKworCQlyZXQgPSBmc19mdW5jLT5pbml0X2V4dF9lbnRy
eShzYiwgcF9kaXIsIG5ld2VudHJ5LAorCQkJCQkgICAgICBudW1fbmV3X2VudHJpZXMsIHBfdW5p
bmFtZSwKKwkJCQkJICAgICAgJmRvc19uYW1lKTsKKwkJaWYgKHJldCAhPSBGRlNfU1VDQ0VTUykK
KwkJCXJldHVybiByZXQ7CisKKwkJZnNfZnVuYy0+ZGVsZXRlX2Rpcl9lbnRyeShzYiwgcF9kaXIs
IG9sZGVudHJ5LCAwLAorCQkJCQkgIG51bV9vbGRfZW50cmllcyk7CisJCWZpZC0+ZW50cnkgPSBu
ZXdlbnRyeTsKKwl9IGVsc2UgeworCQlpZiAoZnNfZnVuYy0+Z2V0X2VudHJ5X3R5cGUoZXBvbGQp
ID09IFRZUEVfRklMRSkgeworCQkJZnNfZnVuYy0+c2V0X2VudHJ5X2F0dHIoZXBvbGQsCisJCQkJ
CQlmc19mdW5jLT5nZXRfZW50cnlfYXR0cihlcG9sZCkgfAorCQkJCQkJQVRUUl9BUkNISVZFKTsK
KwkJCWZpZC0+YXR0ciB8PSBBVFRSX0FSQ0hJVkU7CisJCX0KKwkJYnVmX21vZGlmeShzYiwgc2Vj
dG9yX29sZCk7CisJCWJ1Zl91bmxvY2soc2IsIHNlY3Rvcl9vbGQpOworCisJCXJldCA9IGZzX2Z1
bmMtPmluaXRfZXh0X2VudHJ5KHNiLCBwX2Rpciwgb2xkZW50cnksCisJCQkJCSAgICAgIG51bV9u
ZXdfZW50cmllcywgcF91bmluYW1lLAorCQkJCQkgICAgICAmZG9zX25hbWUpOworCQlpZiAocmV0
ICE9IEZGU19TVUNDRVNTKQorCQkJcmV0dXJuIHJldDsKKworCQlmc19mdW5jLT5kZWxldGVfZGly
X2VudHJ5KHNiLCBwX2Rpciwgb2xkZW50cnksIG51bV9uZXdfZW50cmllcywKKwkJCQkJICBudW1f
b2xkX2VudHJpZXMpOworCX0KKworCXJldHVybiBGRlNfU1VDQ0VTUzsKK30KKworczMyIG1vdmVf
ZmlsZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgY2hhaW5fdCAqcF9vbGRkaXIsIHMzMiBv
bGRlbnRyeSwKKwkgICAgICBzdHJ1Y3QgY2hhaW5fdCAqcF9uZXdkaXIsIHN0cnVjdCB1bmlfbmFt
ZV90ICpwX3VuaW5hbWUsCisJICAgICAgc3RydWN0IGZpbGVfaWRfdCAqZmlkKQoreworCXMzMiBy
ZXQsIG5ld2VudHJ5LCBudW1fbmV3X2VudHJpZXMsIG51bV9vbGRfZW50cmllczsKKwlzZWN0b3Jf
dCBzZWN0b3JfbW92LCBzZWN0b3JfbmV3OworCXN0cnVjdCBjaGFpbl90IGNsdTsKKwlzdHJ1Y3Qg
ZG9zX25hbWVfdCBkb3NfbmFtZTsKKwlzdHJ1Y3QgZGVudHJ5X3QgKmVwbW92LCAqZXBuZXc7CisJ
c3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGlub2RlLT5pX3NiOworCXN0cnVjdCBmc19pbmZvX3Qg
KnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisJc3RydWN0IGZzX2Z1bmMgKmZzX2Z1
bmMgPSBwX2ZzLT5mc19mdW5jOworCisJZXBtb3YgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCBwX29s
ZGRpciwgb2xkZW50cnksICZzZWN0b3JfbW92KTsKKwlpZiAoIWVwbW92KQorCQlyZXR1cm4gRkZT
X01FRElBRVJSOworCisJLyogY2hlY2sgaWYgdGhlIHNvdXJjZSBhbmQgdGFyZ2V0IGRpcmVjdG9y
eSBpcyB0aGUgc2FtZSAqLworCWlmIChmc19mdW5jLT5nZXRfZW50cnlfdHlwZShlcG1vdikgPT0g
VFlQRV9ESVIgJiYKKwkgICAgZnNfZnVuYy0+Z2V0X2VudHJ5X2NsdTAoZXBtb3YpID09IHBfbmV3
ZGlyLT5kaXIpCisJCXJldHVybiBGRlNfSU5WQUxJRFBBVEg7CisKKwlidWZfbG9jayhzYiwgc2Vj
dG9yX21vdik7CisKKwkvKiBidWZfbG9jaygpIGJlZm9yZSBjYWxsIGNvdW50X2V4dF9lbnRyaWVz
KCkgKi8KKwludW1fb2xkX2VudHJpZXMgPSBmc19mdW5jLT5jb3VudF9leHRfZW50cmllcyhzYiwg
cF9vbGRkaXIsIG9sZGVudHJ5LAorCQkJCQkJICAgICBlcG1vdik7CisJaWYgKG51bV9vbGRfZW50
cmllcyA8IDApIHsKKwkJYnVmX3VubG9jayhzYiwgc2VjdG9yX21vdik7CisJCXJldHVybiBGRlNf
TUVESUFFUlI7CisJfQorCW51bV9vbGRfZW50cmllcysrOworCisJcmV0ID0gZ2V0X251bV9lbnRy
aWVzX2FuZF9kb3NfbmFtZShzYiwgcF9uZXdkaXIsIHBfdW5pbmFtZSwKKwkJCQkJICAgJm51bV9u
ZXdfZW50cmllcywgJmRvc19uYW1lKTsKKwlpZiAocmV0KSB7CisJCWJ1Zl91bmxvY2soc2IsIHNl
Y3Rvcl9tb3YpOworCQlyZXR1cm4gcmV0OworCX0KKworCW5ld2VudHJ5ID0gZmluZF9lbXB0eV9l
bnRyeShpbm9kZSwgcF9uZXdkaXIsIG51bV9uZXdfZW50cmllcyk7CisJaWYgKG5ld2VudHJ5IDwg
MCkgeworCQlidWZfdW5sb2NrKHNiLCBzZWN0b3JfbW92KTsKKwkJcmV0dXJuIEZGU19GVUxMOwor
CX0KKworCWVwbmV3ID0gZ2V0X2VudHJ5X2luX2RpcihzYiwgcF9uZXdkaXIsIG5ld2VudHJ5LCAm
c2VjdG9yX25ldyk7CisJaWYgKCFlcG5ldykgeworCQlidWZfdW5sb2NrKHNiLCBzZWN0b3JfbW92
KTsKKwkJcmV0dXJuIEZGU19NRURJQUVSUjsKKwl9CisKKwltZW1jcHkoKHZvaWQgKillcG5ldywg
KHZvaWQgKillcG1vdiwgREVOVFJZX1NJWkUpOworCWlmIChmc19mdW5jLT5nZXRfZW50cnlfdHlw
ZShlcG5ldykgPT0gVFlQRV9GSUxFKSB7CisJCWZzX2Z1bmMtPnNldF9lbnRyeV9hdHRyKGVwbmV3
LCBmc19mdW5jLT5nZXRfZW50cnlfYXR0cihlcG5ldykgfAorCQkJCQlBVFRSX0FSQ0hJVkUpOwor
CQlmaWQtPmF0dHIgfD0gQVRUUl9BUkNISVZFOworCX0KKwlidWZfbW9kaWZ5KHNiLCBzZWN0b3Jf
bmV3KTsKKwlidWZfdW5sb2NrKHNiLCBzZWN0b3JfbW92KTsKKworCWlmIChwX2ZzLT52b2xfdHlw
ZSA9PSBFWEZBVCkgeworCQllcG1vdiA9IGdldF9lbnRyeV9pbl9kaXIoc2IsIHBfb2xkZGlyLCBv
bGRlbnRyeSArIDEsCisJCQkJCSAmc2VjdG9yX21vdik7CisJCWJ1Zl9sb2NrKHNiLCBzZWN0b3Jf
bW92KTsKKwkJZXBuZXcgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCBwX25ld2RpciwgbmV3ZW50cnkg
KyAxLAorCQkJCQkgJnNlY3Rvcl9uZXcpOworCQlpZiAoIWVwbW92IHx8ICFlcG5ldykgeworCQkJ
YnVmX3VubG9jayhzYiwgc2VjdG9yX21vdik7CisJCQlyZXR1cm4gRkZTX01FRElBRVJSOworCQl9
CisKKwkJbWVtY3B5KCh2b2lkICopZXBuZXcsICh2b2lkICopZXBtb3YsIERFTlRSWV9TSVpFKTsK
KwkJYnVmX21vZGlmeShzYiwgc2VjdG9yX25ldyk7CisJCWJ1Zl91bmxvY2soc2IsIHNlY3Rvcl9t
b3YpOworCX0gZWxzZSBpZiAoZnNfZnVuYy0+Z2V0X2VudHJ5X3R5cGUoZXBuZXcpID09IFRZUEVf
RElSKSB7CisJCS8qIGNoYW5nZSAiLi4iIHBvaW50ZXIgdG8gbmV3IHBhcmVudCBkaXIgKi8KKwkJ
Y2x1LmRpciA9IGZzX2Z1bmMtPmdldF9lbnRyeV9jbHUwKGVwbmV3KTsKKwkJY2x1LmZsYWdzID0g
MHgwMTsKKworCQllcG5ldyA9IGdldF9lbnRyeV9pbl9kaXIoc2IsICZjbHUsIDEsICZzZWN0b3Jf
bmV3KTsKKwkJaWYgKCFlcG5ldykKKwkJCXJldHVybiBGRlNfTUVESUFFUlI7CisKKwkJaWYgKHBf
bmV3ZGlyLT5kaXIgPT0gcF9mcy0+cm9vdF9kaXIpCisJCQlmc19mdW5jLT5zZXRfZW50cnlfY2x1
MChlcG5ldywgQ0xVU1RFUl8zMigwKSk7CisJCWVsc2UKKwkJCWZzX2Z1bmMtPnNldF9lbnRyeV9j
bHUwKGVwbmV3LCBwX25ld2Rpci0+ZGlyKTsKKwkJYnVmX21vZGlmeShzYiwgc2VjdG9yX25ldyk7
CisJfQorCisJcmV0ID0gZnNfZnVuYy0+aW5pdF9leHRfZW50cnkoc2IsIHBfbmV3ZGlyLCBuZXdl
bnRyeSwgbnVtX25ld19lbnRyaWVzLAorCQkJCSAgICAgIHBfdW5pbmFtZSwgJmRvc19uYW1lKTsK
KwlpZiAocmV0ICE9IEZGU19TVUNDRVNTKQorCQlyZXR1cm4gcmV0OworCisJZnNfZnVuYy0+ZGVs
ZXRlX2Rpcl9lbnRyeShzYiwgcF9vbGRkaXIsIG9sZGVudHJ5LCAwLCBudW1fb2xkX2VudHJpZXMp
OworCisJZmlkLT5kaXIuZGlyID0gcF9uZXdkaXItPmRpcjsKKwlmaWQtPmRpci5zaXplID0gcF9u
ZXdkaXItPnNpemU7CisJZmlkLT5kaXIuZmxhZ3MgPSBwX25ld2Rpci0+ZmxhZ3M7CisKKwlmaWQt
PmVudHJ5ID0gbmV3ZW50cnk7CisKKwlyZXR1cm4gRkZTX1NVQ0NFU1M7Cit9CisKKy8qCisgKiAg
U2VjdG9yIFJlYWQvV3JpdGUgRnVuY3Rpb25zCisgKi8KKworaW50IHNlY3Rvcl9yZWFkKHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IsIHNlY3Rvcl90IHNlYywgc3RydWN0IGJ1ZmZlcl9oZWFkICoqYmgs
CisJCWJvb2wgcmVhZCkKK3sKKwlzMzIgcmV0ID0gRkZTX01FRElBRVJSOworCXN0cnVjdCBmc19p
bmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisKKwlpZiAoKHNlYyA+PSAo
cF9mcy0+UEJSX3NlY3RvciArIHBfZnMtPm51bV9zZWN0b3JzKSkgJiYKKwkgICAgKHBfZnMtPm51
bV9zZWN0b3JzID4gMCkpIHsKKwkJcHJfZXJyKCJbRVhGQVRdICVzOiBvdXQgb2YgcmFuZ2UgZXJy
b3IhIChzZWMgPSAlbGx1KVxuIiwKKwkJICAgICAgIF9fZnVuY19fLCAodW5zaWduZWQgbG9uZyBs
b25nKXNlYyk7CisJCWZzX2Vycm9yKHNiKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlpZiAoIXBf
ZnMtPmRldl9lamVjdGVkKSB7CisJCXJldCA9IGJkZXZfcmVhZChzYiwgc2VjLCBiaCwgMSwgcmVh
ZCk7CisJCWlmIChyZXQgIT0gRkZTX1NVQ0NFU1MpCisJCQlwX2ZzLT5kZXZfZWplY3RlZCA9IFRS
VUU7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworaW50IHNlY3Rvcl93cml0ZShzdHJ1Y3Qgc3Vw
ZXJfYmxvY2sgKnNiLCBzZWN0b3JfdCBzZWMsIHN0cnVjdCBidWZmZXJfaGVhZCAqYmgsCisJCSBi
b29sIHN5bmMpCit7CisJczMyIHJldCA9IEZGU19NRURJQUVSUjsKKwlzdHJ1Y3QgZnNfaW5mb190
ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJaWYgKHNlYyA+PSAocF9mcy0+
UEJSX3NlY3RvciArIHBfZnMtPm51bV9zZWN0b3JzKSAmJgorCSAgICAocF9mcy0+bnVtX3NlY3Rv
cnMgPiAwKSkgeworCQlwcl9lcnIoIltFWEZBVF0gJXM6IG91dCBvZiByYW5nZSBlcnJvciEgKHNl
YyA9ICVsbHUpXG4iLAorCQkgICAgICAgX19mdW5jX18sICh1bnNpZ25lZCBsb25nIGxvbmcpc2Vj
KTsKKwkJZnNfZXJyb3Ioc2IpOworCQlyZXR1cm4gcmV0OworCX0KKworCWlmICghYmgpIHsKKwkJ
cHJfZXJyKCJbRVhGQVRdICVzOiBiaCBpcyBOVUxMIVxuIiwgX19mdW5jX18pOworCQlmc19lcnJv
cihzYik7CisJCXJldHVybiByZXQ7CisJfQorCisJaWYgKCFwX2ZzLT5kZXZfZWplY3RlZCkgewor
CQlyZXQgPSBiZGV2X3dyaXRlKHNiLCBzZWMsIGJoLCAxLCBzeW5jKTsKKwkJaWYgKHJldCAhPSBG
RlNfU1VDQ0VTUykKKwkJCXBfZnMtPmRldl9lamVjdGVkID0gVFJVRTsKKwl9CisKKwlyZXR1cm4g
cmV0OworfQorCitpbnQgbXVsdGlfc2VjdG9yX3JlYWQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwg
c2VjdG9yX3Qgc2VjLAorCQkgICAgICBzdHJ1Y3QgYnVmZmVyX2hlYWQgKipiaCwgczMyIG51bV9z
ZWNzLCBib29sIHJlYWQpCit7CisJczMyIHJldCA9IEZGU19NRURJQUVSUjsKKwlzdHJ1Y3QgZnNf
aW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJaWYgKCgoc2VjICsg
bnVtX3NlY3MpID4gKHBfZnMtPlBCUl9zZWN0b3IgKyBwX2ZzLT5udW1fc2VjdG9ycykpICYmCisJ
ICAgIChwX2ZzLT5udW1fc2VjdG9ycyA+IDApKSB7CisJCXByX2VycigiW0VYRkFUXSAlczogb3V0
IG9mIHJhbmdlIGVycm9yISAoc2VjID0gJWxsdSwgbnVtX3NlY3MgPSAlZClcbiIsCisJCSAgICAg
ICBfX2Z1bmNfXywgKHVuc2lnbmVkIGxvbmcgbG9uZylzZWMsIG51bV9zZWNzKTsKKwkJZnNfZXJy
b3Ioc2IpOworCQlyZXR1cm4gcmV0OworCX0KKworCWlmICghcF9mcy0+ZGV2X2VqZWN0ZWQpIHsK
KwkJcmV0ID0gYmRldl9yZWFkKHNiLCBzZWMsIGJoLCBudW1fc2VjcywgcmVhZCk7CisJCWlmIChy
ZXQgIT0gRkZTX1NVQ0NFU1MpCisJCQlwX2ZzLT5kZXZfZWplY3RlZCA9IFRSVUU7CisJfQorCisJ
cmV0dXJuIHJldDsKK30KKworaW50IG11bHRpX3NlY3Rvcl93cml0ZShzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiLCBzZWN0b3JfdCBzZWMsCisJCSAgICAgICBzdHJ1Y3QgYnVmZmVyX2hlYWQgKmJoLCBz
MzIgbnVtX3NlY3MsIGJvb2wgc3luYykKK3sKKwlzMzIgcmV0ID0gRkZTX01FRElBRVJSOworCXN0
cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisKKwlpZiAo
KHNlYyArIG51bV9zZWNzKSA+IChwX2ZzLT5QQlJfc2VjdG9yICsgcF9mcy0+bnVtX3NlY3RvcnMp
ICYmCisJICAgIChwX2ZzLT5udW1fc2VjdG9ycyA+IDApKSB7CisJCXByX2VycigiW0VYRkFUXSAl
czogb3V0IG9mIHJhbmdlIGVycm9yISAoc2VjID0gJWxsdSwgbnVtX3NlY3MgPSAlZClcbiIsCisJ
CSAgICAgICBfX2Z1bmNfXywgKHVuc2lnbmVkIGxvbmcgbG9uZylzZWMsIG51bV9zZWNzKTsKKwkJ
ZnNfZXJyb3Ioc2IpOworCQlyZXR1cm4gcmV0OworCX0KKwlpZiAoIWJoKSB7CisJCXByX2Vycigi
W0VYRkFUXSAlczogYmggaXMgTlVMTCFcbiIsIF9fZnVuY19fKTsKKwkJZnNfZXJyb3Ioc2IpOwor
CQlyZXR1cm4gcmV0OworCX0KKworCWlmICghcF9mcy0+ZGV2X2VqZWN0ZWQpIHsKKwkJcmV0ID0g
YmRldl93cml0ZShzYiwgc2VjLCBiaCwgbnVtX3NlY3MsIHN5bmMpOworCQlpZiAocmV0ICE9IEZG
U19TVUNDRVNTKQorCQkJcF9mcy0+ZGV2X2VqZWN0ZWQgPSBUUlVFOworCX0KKworCXJldHVybiBy
ZXQ7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhmYXRfbmxzLmMgYi9k
cml2ZXJzL3N0YWdpbmcvZXhmYXQvZXhmYXRfbmxzLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5k
ZXggMDAwMDAwMDAwMDAwLi4yY2E1ODYxNjE1OWIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJz
L3N0YWdpbmcvZXhmYXQvZXhmYXRfbmxzLmMKQEAgLTAsMCArMSw0MDQgQEAKKy8vIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogIENvcHlyaWdodCAoQykgMjAxMi0yMDEz
IFNhbXN1bmcgRWxlY3Ryb25pY3MgQ28uLCBMdGQuCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L3N0
cmluZy5oPgorI2luY2x1ZGUgPGxpbnV4L25scy5oPgorI2luY2x1ZGUgImV4ZmF0LmgiCisKK3N0
YXRpYyB1MTYgYmFkX2Rvc19jaGFyc1tdID0geworCS8qICsgLCA7ID0gWyBdICovCisJMHgwMDJC
LCAweDAwMkMsIDB4MDAzQiwgMHgwMDNELCAweDAwNUIsIDB4MDA1RCwKKwkweEZGMEIsIDB4RkYw
QywgMHhGRjFCLCAweEZGMUQsIDB4RkYzQiwgMHhGRjNELAorCTAKK307CisKK3N0YXRpYyB1MTYg
YmFkX3VuaV9jaGFyc1tdID0geworCS8qICIgKiAvIDogPCA+ID8gXCB8ICovCisJMHgwMDIyLCAg
ICAgICAgIDB4MDAyQSwgMHgwMDJGLCAweDAwM0EsCisJMHgwMDNDLCAweDAwM0UsIDB4MDAzRiwg
MHgwMDVDLCAweDAwN0MsCisJMAorfTsKKworc3RhdGljIGludCBjb252ZXJ0X2NoX3RvX3VuaShz
dHJ1Y3QgbmxzX3RhYmxlICpubHMsIHUxNiAqdW5pLCB1OCAqY2gsCisJCQkgICAgIGJvb2wgKmxv
c3N5KQoreworCWludCBsZW47CisKKwkqdW5pID0gMHgwOworCisJaWYgKGNoWzBdIDwgMHg4MCkg
eworCQkqdW5pID0gKHUxNiljaFswXTsKKwkJcmV0dXJuIDE7CisJfQorCisJbGVuID0gbmxzLT5j
aGFyMnVuaShjaCwgTkxTX01BWF9DSEFSU0VUX1NJWkUsIHVuaSk7CisJaWYgKGxlbiA8IDApIHsK
KwkJLyogY29udmVyc2lvbiBmYWlsZWQgKi8KKwkJcHJfaW5mbygiJXM6IGZhaWwgdG8gdXNlIG5s
c1xuIiwgX19mdW5jX18pOworCQlpZiAobG9zc3kpCisJCQkqbG9zc3kgPSB0cnVlOworCQkqdW5p
ID0gKHUxNiknXyc7CisJCWlmICghc3RyY21wKG5scy0+Y2hhcnNldCwgInV0ZjgiKSkKKwkJCXJl
dHVybiAxOworCQllbHNlCisJCQlyZXR1cm4gMjsKKwl9CisKKwlyZXR1cm4gbGVuOworfQorCitz
dGF0aWMgaW50IGNvbnZlcnRfdW5pX3RvX2NoKHN0cnVjdCBubHNfdGFibGUgKm5scywgdTggKmNo
LCB1MTYgdW5pLAorCQkJICAgICBib29sICpsb3NzeSkKK3sKKwlpbnQgbGVuOworCisJY2hbMF0g
PSAweDA7CisKKwlpZiAodW5pIDwgMHgwMDgwKSB7CisJCWNoWzBdID0gKHU4KXVuaTsKKwkJcmV0
dXJuIDE7CisJfQorCisJbGVuID0gbmxzLT51bmkyY2hhcih1bmksIGNoLCBOTFNfTUFYX0NIQVJT
RVRfU0laRSk7CisJaWYgKGxlbiA8IDApIHsKKwkJLyogY29udmVyc2lvbiBmYWlsZWQgKi8KKwkJ
cHJfaW5mbygiJXM6IGZhaWwgdG8gdXNlIG5sc1xuIiwgX19mdW5jX18pOworCQlpZiAobG9zc3kp
CisJCQkqbG9zc3kgPSB0cnVlOworCQljaFswXSA9ICdfJzsKKwkJcmV0dXJuIDE7CisJfQorCisJ
cmV0dXJuIGxlbjsKK30KKwordTE2IG5sc191cHBlcihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCB1
MTYgYSkKK3sKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2lu
Zm8pOworCisJaWYgKEVYRkFUX1NCKHNiKS0+b3B0aW9ucy5jYXNlc2Vuc2l0aXZlKQorCQlyZXR1
cm4gYTsKKwlpZiAocF9mcy0+dm9sX3V0YmwgJiYgcF9mcy0+dm9sX3V0YmxbZ2V0X2NvbF9pbmRl
eChhKV0pCisJCXJldHVybiBwX2ZzLT52b2xfdXRibFtnZXRfY29sX2luZGV4KGEpXVtnZXRfcm93
X2luZGV4KGEpXTsKKwllbHNlCisJCXJldHVybiBhOworfQorCitzdGF0aWMgdTE2ICpubHNfd3N0
cmNocih1MTYgKnN0ciwgdTE2IHdjaGFyKQoreworCXdoaWxlICgqc3RyKSB7CisJCWlmICgqKHN0
cisrKSA9PSB3Y2hhcikKKwkJCXJldHVybiBzdHI7CisJfQorCisJcmV0dXJuIE5VTEw7Cit9CisK
K2ludCBubHNfZG9zbmFtZV9jbXAoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTggKmEsIHU4ICpi
KQoreworCXJldHVybiBzdHJuY21wKGEsIGIsIERPU19OQU1FX0xFTkdUSCk7Cit9CisKK2ludCBu
bHNfdW5pbmFtZV9jbXAoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdTE2ICphLCB1MTYgKmIpCit7
CisJaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgTUFYX05BTUVfTEVOR1RIOyBpKyssIGErKywg
YisrKSB7CisJCWlmIChubHNfdXBwZXIoc2IsICphKSAhPSBubHNfdXBwZXIoc2IsICpiKSkKKwkJ
CXJldHVybiAxOworCQlpZiAoKmEgPT0gMHgwKQorCQkJcmV0dXJuIDA7CisJfQorCXJldHVybiAw
OworfQorCit2b2lkIG5sc191bmluYW1lX3RvX2Rvc25hbWUoc3RydWN0IHN1cGVyX2Jsb2NrICpz
YiwKKwkJCSAgICBzdHJ1Y3QgZG9zX25hbWVfdCAqcF9kb3NuYW1lLAorCQkJICAgIHN0cnVjdCB1
bmlfbmFtZV90ICpwX3VuaW5hbWUsIGJvb2wgKnBfbG9zc3kpCit7CisJaW50IGksIGosIGxlbjsK
Kwlib29sIGxvc3N5ID0gZmFsc2U7CisJdTggYnVmW01BWF9DSEFSU0VUX1NJWkVdOworCXU4IGxv
d2VyID0gMCwgdXBwZXIgPSAwOworCXU4ICpkb3NuYW1lID0gcF9kb3NuYW1lLT5uYW1lOworCXUx
NiAqdW5pbmFtZSA9IHBfdW5pbmFtZS0+bmFtZTsKKwl1MTYgKnAsICpsYXN0X3BlcmlvZDsKKwlz
dHJ1Y3QgbmxzX3RhYmxlICpubHMgPSBFWEZBVF9TQihzYiktPm5sc19kaXNrOworCisJZm9yIChp
ID0gMDsgaSA8IERPU19OQU1FX0xFTkdUSDsgaSsrKQorCQkqKGRvc25hbWUgKyBpKSA9ICcgJzsK
KworCWlmICghbmxzX3VuaW5hbWVfY21wKHNiLCB1bmluYW1lLCAodTE2ICopVU5JX0NVUl9ESVJf
TkFNRSkpIHsKKwkJKihkb3NuYW1lKSA9ICcuJzsKKwkJcF9kb3NuYW1lLT5uYW1lX2Nhc2UgPSAw
eDA7CisJCWlmIChwX2xvc3N5KQorCQkJKnBfbG9zc3kgPSBmYWxzZTsKKwkJcmV0dXJuOworCX0K
KworCWlmICghbmxzX3VuaW5hbWVfY21wKHNiLCB1bmluYW1lLCAodTE2ICopVU5JX1BBUl9ESVJf
TkFNRSkpIHsKKwkJKihkb3NuYW1lKSA9ICcuJzsKKwkJKihkb3NuYW1lICsgMSkgPSAnLic7CisJ
CXBfZG9zbmFtZS0+bmFtZV9jYXNlID0gMHgwOworCQlpZiAocF9sb3NzeSkKKwkJCSpwX2xvc3N5
ID0gZmFsc2U7CisJCXJldHVybjsKKwl9CisKKwkvKiBzZWFyY2ggZm9yIHRoZSBsYXN0IGVtYmVk
ZGVkIHBlcmlvZCAqLworCWxhc3RfcGVyaW9kID0gTlVMTDsKKwlmb3IgKHAgPSB1bmluYW1lOyAq
cDsgcCsrKSB7CisJCWlmICgqcCA9PSAodTE2KScuJykKKwkJCWxhc3RfcGVyaW9kID0gcDsKKwl9
CisKKwlpID0gMDsKKwl3aGlsZSAoaSA8IERPU19OQU1FX0xFTkdUSCkgeworCQlpZiAoaSA9PSA4
KSB7CisJCQlpZiAoIWxhc3RfcGVyaW9kKQorCQkJCWJyZWFrOworCisJCQlpZiAodW5pbmFtZSA8
PSBsYXN0X3BlcmlvZCkgeworCQkJCWlmICh1bmluYW1lIDwgbGFzdF9wZXJpb2QpCisJCQkJCWxv
c3N5ID0gdHJ1ZTsKKwkJCQl1bmluYW1lID0gbGFzdF9wZXJpb2QgKyAxOworCQkJfQorCQl9CisK
KwkJaWYgKCp1bmluYW1lID09ICh1MTYpJ1wwJykgeworCQkJYnJlYWs7CisJCX0gZWxzZSBpZiAo
KnVuaW5hbWUgPT0gKHUxNiknICcpIHsKKwkJCWxvc3N5ID0gdHJ1ZTsKKwkJfSBlbHNlIGlmICgq
dW5pbmFtZSA9PSAodTE2KScuJykgeworCQkJaWYgKHVuaW5hbWUgPCBsYXN0X3BlcmlvZCkKKwkJ
CQlsb3NzeSA9IHRydWU7CisJCQllbHNlCisJCQkJaSA9IDg7CisJCX0gZWxzZSBpZiAobmxzX3dz
dHJjaHIoYmFkX2Rvc19jaGFycywgKnVuaW5hbWUpKSB7CisJCQlsb3NzeSA9IHRydWU7CisJCQkq
KGRvc25hbWUgKyBpKSA9ICdfJzsKKwkJCWkrKzsKKwkJfSBlbHNlIHsKKwkJCWxlbiA9IGNvbnZl
cnRfdW5pX3RvX2NoKG5scywgYnVmLCAqdW5pbmFtZSwgJmxvc3N5KTsKKworCQkJaWYgKGxlbiA+
IDEpIHsKKwkJCQlpZiAoKGkgPj0gOCkgJiYgKChpICsgbGVuKSA+IERPU19OQU1FX0xFTkdUSCkp
CisJCQkJCWJyZWFrOworCisJCQkJaWYgKChpIDwgOCkgJiYgKChpICsgbGVuKSA+IDgpKSB7CisJ
CQkJCWkgPSA4OworCQkJCQljb250aW51ZTsKKwkJCQl9CisKKwkJCQlsb3dlciA9IDB4RkY7CisK
KwkJCQlmb3IgKGogPSAwOyBqIDwgbGVuOyBqKyssIGkrKykKKwkJCQkJKihkb3NuYW1lICsgaSkg
PSAqKGJ1ZiArIGopOworCQkJfSBlbHNlIHsgLyogbGVuID09IDEgKi8KKwkJCQlpZiAoKCpidWYg
Pj0gJ2EnKSAmJiAoKmJ1ZiA8PSAneicpKSB7CisJCQkJCSooZG9zbmFtZSArIGkpID0gKmJ1ZiAt
ICgnYScgLSAnQScpOworCisJCQkJCWlmIChpIDwgOCkKKwkJCQkJCWxvd2VyIHw9IDB4MDg7CisJ
CQkJCWVsc2UKKwkJCQkJCWxvd2VyIHw9IDB4MTA7CisJCQkJfSBlbHNlIGlmICgoKmJ1ZiA+PSAn
QScpICYmICgqYnVmIDw9ICdaJykpIHsKKwkJCQkJKihkb3NuYW1lICsgaSkgPSAqYnVmOworCisJ
CQkJCWlmIChpIDwgOCkKKwkJCQkJCXVwcGVyIHw9IDB4MDg7CisJCQkJCWVsc2UKKwkJCQkJCXVw
cGVyIHw9IDB4MTA7CisJCQkJfSBlbHNlIHsKKwkJCQkJKihkb3NuYW1lICsgaSkgPSAqYnVmOwor
CQkJCX0KKwkJCQlpKys7CisJCQl9CisJCX0KKworCQl1bmluYW1lKys7CisJfQorCisJaWYgKCpk
b3NuYW1lID09IDB4RTUpCisJCSpkb3NuYW1lID0gMHgwNTsKKworCWlmICgqdW5pbmFtZSAhPSAw
eDApCisJCWxvc3N5ID0gVFJVRTsKKworCWlmICh1cHBlciAmIGxvd2VyKQorCQlwX2Rvc25hbWUt
Pm5hbWVfY2FzZSA9IDB4RkY7CisJZWxzZQorCQlwX2Rvc25hbWUtPm5hbWVfY2FzZSA9IGxvd2Vy
OworCisJaWYgKHBfbG9zc3kpCisJCSpwX2xvc3N5ID0gbG9zc3k7Cit9CisKK3ZvaWQgbmxzX2Rv
c25hbWVfdG9fdW5pbmFtZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJICAgIHN0cnVjdCB1
bmlfbmFtZV90ICpwX3VuaW5hbWUsCisJCQkgICAgc3RydWN0IGRvc19uYW1lX3QgKnBfZG9zbmFt
ZSkKK3sKKwlpbnQgaSA9IDAsIGosIG4gPSAwOworCXU4IGJ1ZltET1NfTkFNRV9MRU5HVEggKyAy
XTsKKwl1OCAqZG9zbmFtZSA9IHBfZG9zbmFtZS0+bmFtZTsKKwl1MTYgKnVuaW5hbWUgPSBwX3Vu
aW5hbWUtPm5hbWU7CisJc3RydWN0IG5sc190YWJsZSAqbmxzID0gRVhGQVRfU0Ioc2IpLT5ubHNf
ZGlzazsKKworCWlmICgqZG9zbmFtZSA9PSAweDA1KSB7CisJCSpidWYgPSAweEU1OworCQlpKys7
CisJCW4rKzsKKwl9CisKKwlmb3IgKDsgaSA8IDg7IGkrKywgbisrKSB7CisJCWlmICgqKGRvc25h
bWUgKyBpKSA9PSAnICcpCisJCQlicmVhazsKKworCQlpZiAoKCooZG9zbmFtZSArIGkpID49ICdB
JykgJiYgKCooZG9zbmFtZSArIGkpIDw9ICdaJykgJiYKKwkJICAgIChwX2Rvc25hbWUtPm5hbWVf
Y2FzZSAmIDB4MDgpKQorCQkJKihidWYgKyBuKSA9ICooZG9zbmFtZSArIGkpICsgKCdhJyAtICdB
Jyk7CisJCWVsc2UKKwkJCSooYnVmICsgbikgPSAqKGRvc25hbWUgKyBpKTsKKwl9CisJaWYgKCoo
ZG9zbmFtZSArIDgpICE9ICcgJykgeworCQkqKGJ1ZiArIG4pID0gJy4nOworCQluKys7CisJfQor
CisJZm9yIChpID0gODsgaSA8IERPU19OQU1FX0xFTkdUSDsgaSsrLCBuKyspIHsKKwkJaWYgKCoo
ZG9zbmFtZSArIGkpID09ICcgJykKKwkJCWJyZWFrOworCisJCWlmICgoKihkb3NuYW1lICsgaSkg
Pj0gJ0EnKSAmJiAoKihkb3NuYW1lICsgaSkgPD0gJ1onKSAmJgorCQkgICAgKHBfZG9zbmFtZS0+
bmFtZV9jYXNlICYgMHgxMCkpCisJCQkqKGJ1ZiArIG4pID0gKihkb3NuYW1lICsgaSkgKyAoJ2En
IC0gJ0EnKTsKKwkJZWxzZQorCQkJKihidWYgKyBuKSA9ICooZG9zbmFtZSArIGkpOworCX0KKwkq
KGJ1ZiArIG4pID0gJ1wwJzsKKworCWkgPSAwOworCWogPSAwOworCXdoaWxlIChqIDwgKE1BWF9O
QU1FX0xFTkdUSCAtIDEpKSB7CisJCWlmICgqKGJ1ZiArIGkpID09ICdcMCcpCisJCQlicmVhazsK
KworCQlpICs9IGNvbnZlcnRfY2hfdG9fdW5pKG5scywgdW5pbmFtZSwgKGJ1ZiArIGkpLCBOVUxM
KTsKKworCQl1bmluYW1lKys7CisJCWorKzsKKwl9CisKKwkqdW5pbmFtZSA9ICh1MTYpJ1wwJzsK
K30KKwordm9pZCBubHNfdW5pbmFtZV90b19jc3RyaW5nKHN0cnVjdCBzdXBlcl9ibG9jayAqc2Is
IHU4ICpwX2NzdHJpbmcsCisJCQkgICAgc3RydWN0IHVuaV9uYW1lX3QgKnBfdW5pbmFtZSkKK3sK
KwlpbnQgaSwgaiwgbGVuOworCXU4IGJ1ZltNQVhfQ0hBUlNFVF9TSVpFXTsKKwl1MTYgKnVuaW5h
bWUgPSBwX3VuaW5hbWUtPm5hbWU7CisJc3RydWN0IG5sc190YWJsZSAqbmxzID0gRVhGQVRfU0Io
c2IpLT5ubHNfaW87CisKKwlpZiAoIW5scykgeworCQlsZW4gPSB1dGYxNnNfdG9fdXRmOHModW5p
bmFtZSwgTUFYX05BTUVfTEVOR1RILAorCQkJCSAgICAgIFVURjE2X0hPU1RfRU5ESUFOLCBwX2Nz
dHJpbmcsCisJCQkJICAgICAgTUFYX05BTUVfTEVOR1RIKTsKKwkJcF9jc3RyaW5nW2xlbl0gPSAw
OworCQlyZXR1cm47CisJfQorCisJaSA9IDA7CisJd2hpbGUgKGkgPCAoTUFYX05BTUVfTEVOR1RI
IC0gMSkpIHsKKwkJaWYgKCp1bmluYW1lID09ICh1MTYpJ1wwJykKKwkJCWJyZWFrOworCisJCWxl
biA9IGNvbnZlcnRfdW5pX3RvX2NoKG5scywgYnVmLCAqdW5pbmFtZSwgTlVMTCk7CisKKwkJaWYg
KGxlbiA+IDEpIHsKKwkJCWZvciAoaiA9IDA7IGogPCBsZW47IGorKykKKwkJCQkqcF9jc3RyaW5n
KysgPSAoY2hhcikqKGJ1ZiArIGopOworCQl9IGVsc2UgeyAvKiBsZW4gPT0gMSAqLworCQkJKnBf
Y3N0cmluZysrID0gKGNoYXIpKmJ1ZjsKKwkJfQorCisJCXVuaW5hbWUrKzsKKwkJaSsrOworCX0K
KworCSpwX2NzdHJpbmcgPSAnXDAnOworfQorCit2b2lkIG5sc19jc3RyaW5nX3RvX3VuaW5hbWUo
c3RydWN0IHN1cGVyX2Jsb2NrICpzYiwKKwkJCSAgICBzdHJ1Y3QgdW5pX25hbWVfdCAqcF91bmlu
YW1lLCB1OCAqcF9jc3RyaW5nLAorCQkJICAgIGJvb2wgKnBfbG9zc3kpCit7CisJaW50IGksIGo7
CisJYm9vbCBsb3NzeSA9IGZhbHNlOworCXU4ICplbmRfb2ZfbmFtZTsKKwl1OCB1cG5hbWVbTUFY
X05BTUVfTEVOR1RIICogMl07CisJdTE2ICp1bmluYW1lID0gcF91bmluYW1lLT5uYW1lOworCXN0
cnVjdCBubHNfdGFibGUgKm5scyA9IEVYRkFUX1NCKHNiKS0+bmxzX2lvOworCisJLyogc3RyaXAg
YWxsIHRyYWlsaW5nIHNwYWNlcyAqLworCWVuZF9vZl9uYW1lID0gcF9jc3RyaW5nICsgc3RybGVu
KHBfY3N0cmluZyk7CisKKwl3aGlsZSAoKigtLWVuZF9vZl9uYW1lKSA9PSAnICcpIHsKKwkJaWYg
KGVuZF9vZl9uYW1lIDwgcF9jc3RyaW5nKQorCQkJYnJlYWs7CisJfQorCSooKytlbmRfb2ZfbmFt
ZSkgPSAnXDAnOworCisJaWYgKHN0cmNtcChwX2NzdHJpbmcsICIuIikgJiYgc3RyY21wKHBfY3N0
cmluZywgIi4uIikpIHsKKwkJLyogc3RyaXAgYWxsIHRyYWlsaW5nIHBlcmlvZHMgKi8KKwkJd2hp
bGUgKCooLS1lbmRfb2ZfbmFtZSkgPT0gJy4nKSB7CisJCQlpZiAoZW5kX29mX25hbWUgPCBwX2Nz
dHJpbmcpCisJCQkJYnJlYWs7CisJCX0KKwkJKigrK2VuZF9vZl9uYW1lKSA9ICdcMCc7CisJfQor
CisJaWYgKCpwX2NzdHJpbmcgPT0gJ1wwJykKKwkJbG9zc3kgPSB0cnVlOworCisJaWYgKCFubHMp
IHsKKwkJaSA9IHV0ZjhzX3RvX3V0ZjE2cyhwX2NzdHJpbmcsIE1BWF9OQU1FX0xFTkdUSCwKKwkJ
CQkgICAgVVRGMTZfSE9TVF9FTkRJQU4sIHVuaW5hbWUsCisJCQkJICAgIE1BWF9OQU1FX0xFTkdU
SCk7CisJCWZvciAoaiA9IDA7IGogPCBpOyBqKyspCisJCQlTRVQxNl9BKHVwbmFtZSArIGogKiAy
LCBubHNfdXBwZXIoc2IsIHVuaW5hbWVbal0pKTsKKwkJdW5pbmFtZVtpXSA9ICdcMCc7CisJfSBl
bHNlIHsKKwkJaSA9IDA7CisJCWogPSAwOworCQl3aGlsZSAoaiA8IChNQVhfTkFNRV9MRU5HVEgg
LSAxKSkgeworCQkJaWYgKCoocF9jc3RyaW5nICsgaSkgPT0gJ1wwJykKKwkJCQlicmVhazsKKwor
CQkJaSArPSBjb252ZXJ0X2NoX3RvX3VuaShubHMsIHVuaW5hbWUsCisJCQkJCSAgICAgICAodTgg
KikocF9jc3RyaW5nICsgaSksICZsb3NzeSk7CisKKwkJCWlmICgoKnVuaW5hbWUgPCAweDAwMjAp
IHx8CisJCQkgICAgbmxzX3dzdHJjaHIoYmFkX3VuaV9jaGFycywgKnVuaW5hbWUpKQorCQkJCWxv
c3N5ID0gdHJ1ZTsKKworCQkJU0VUMTZfQSh1cG5hbWUgKyBqICogMiwgbmxzX3VwcGVyKHNiLCAq
dW5pbmFtZSkpOworCisJCQl1bmluYW1lKys7CisJCQlqKys7CisJCX0KKworCQlpZiAoKihwX2Nz
dHJpbmcgKyBpKSAhPSAnXDAnKQorCQkJbG9zc3kgPSB0cnVlOworCQkqdW5pbmFtZSA9ICh1MTYp
J1wwJzsKKwl9CisKKwlwX3VuaW5hbWUtPm5hbWVfbGVuID0gajsKKwlwX3VuaW5hbWUtPm5hbWVf
aGFzaCA9IGNhbGNfY2hlY2tzdW1fMmJ5dGUodXBuYW1lLCBqIDw8IDEsIDAsCisJCQkJCQkgICBD
U19ERUZBVUxUKTsKKworCWlmIChwX2xvc3N5KQorCQkqcF9sb3NzeSA9IGxvc3N5OworfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2V4ZmF0L2V4ZmF0X3N1cGVyLmMgYi9kcml2ZXJzL3N0
YWdpbmcvZXhmYXQvZXhmYXRfc3VwZXIuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAw
MDAwMDAwMDAuLjViNWMyY2E4YzlhYQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2lu
Zy9leGZhdC9leGZhdF9zdXBlci5jCkBAIC0wLDAgKzEsNDEzNyBAQAorLy8gU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiAgQ29weXJpZ2h0IChDKSAyMDEyLTIwMTMgU2Ft
c3VuZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4KKyAqLworCisjaW5jbHVkZSA8bGludXgvdmVyc2lv
bi5oPgorI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L2luaXQuaD4K
KyNpbmNsdWRlIDxsaW51eC90aW1lLmg+CisjaW5jbHVkZSA8bGludXgvc2xhYi5oPgorI2luY2x1
ZGUgPGxpbnV4L3NlcV9maWxlLmg+CisjaW5jbHVkZSA8bGludXgvcGFnZW1hcC5oPgorI2luY2x1
ZGUgPGxpbnV4L21wYWdlLmg+CisjaW5jbHVkZSA8bGludXgvYnVmZmVyX2hlYWQuaD4KKyNpbmNs
dWRlIDxsaW51eC9leHBvcnRmcy5oPgorI2luY2x1ZGUgPGxpbnV4L21vdW50Lmg+CisjaW5jbHVk
ZSA8bGludXgvdmZzLmg+CisjaW5jbHVkZSA8bGludXgvYWlvLmg+CisjaW5jbHVkZSA8bGludXgv
aXZlcnNpb24uaD4KKyNpbmNsdWRlIDxsaW51eC9wYXJzZXIuaD4KKyNpbmNsdWRlIDxsaW51eC91
aW8uaD4KKyNpbmNsdWRlIDxsaW51eC93cml0ZWJhY2suaD4KKyNpbmNsdWRlIDxsaW51eC9sb2cy
Lmg+CisjaW5jbHVkZSA8bGludXgvaGFzaC5oPgorI2luY2x1ZGUgPGxpbnV4L2JhY2tpbmctZGV2
Lmg+CisjaW5jbHVkZSA8bGludXgvc2NoZWQuaD4KKyNpbmNsdWRlIDxsaW51eC9mc19zdHJ1Y3Qu
aD4KKyNpbmNsdWRlIDxsaW51eC9uYW1laS5oPgorI2luY2x1ZGUgPGxpbnV4L3RpbWUuaD4KKwor
I2luY2x1ZGUgPGxpbnV4L3N0cmluZy5oPgorI2luY2x1ZGUgPGxpbnV4L25scy5oPgorI2luY2x1
ZGUgPGxpbnV4L211dGV4Lmg+CisjaW5jbHVkZSA8bGludXgvc3dhcC5oPgorCisjZGVmaW5lIEVY
RkFUX1ZFUlNJT04gICIxLjMuMCIKKworI2luY2x1ZGUgImV4ZmF0LmgiCisKK3N0YXRpYyBzdHJ1
Y3Qga21lbV9jYWNoZSAqZXhmYXRfaW5vZGVfY2FjaGVwOworCisvLyBGSVhNRSB1c2UgY29tbWVu
dGVkIGxpbmVzCisvLyBzdGF0aWMgaW50IGV4ZmF0X2RlZmF1bHRfY29kZXBhZ2UgPSBDT05GSUdf
RVhGQVRfREVGQVVMVF9DT0RFUEFHRTsKKy8vIHN0YXRpYyBjaGFyIGV4ZmF0X2RlZmF1bHRfaW9j
aGFyc2V0W10gPSBDT05GSUdfRVhGQVRfREVGQVVMVF9JT0NIQVJTRVQ7CitzdGF0aWMgaW50IGV4
ZmF0X2RlZmF1bHRfY29kZXBhZ2UgPSBDT05GSUdfRkFUX0RFRkFVTFRfQ09ERVBBR0U7CitzdGF0
aWMgY2hhciBleGZhdF9kZWZhdWx0X2lvY2hhcnNldFtdID0gQ09ORklHX0ZBVF9ERUZBVUxUX0lP
Q0hBUlNFVDsKKworI2RlZmluZSBJTkNfSVZFUlNJT04oeCkgKGlub2RlX2luY19pdmVyc2lvbih4
KSkKKyNkZWZpbmUgR0VUX0lWRVJTSU9OKHgpIChpbm9kZV9wZWVrX2l2ZXJzaW9uX3Jhdyh4KSkK
KyNkZWZpbmUgU0VUX0lWRVJTSU9OKHgsIHkpIChpbm9kZV9zZXRfaXZlcnNpb24oeCwgeSkpCisK
K3N0YXRpYyBzdHJ1Y3QgaW5vZGUgKmV4ZmF0X2lnZXQoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwg
bG9mZl90IGlfcG9zKTsKK3N0YXRpYyBpbnQgZXhmYXRfc3luY19pbm9kZShzdHJ1Y3QgaW5vZGUg
Kmlub2RlKTsKK3N0YXRpYyBzdHJ1Y3QgaW5vZGUgKmV4ZmF0X2J1aWxkX2lub2RlKHN0cnVjdCBz
dXBlcl9ibG9jayAqc2IsCisJCQkJICAgICAgIHN0cnVjdCBmaWxlX2lkX3QgKmZpZCwgbG9mZl90
IGlfcG9zKTsKK3N0YXRpYyBpbnQgZXhmYXRfd3JpdGVfaW5vZGUoc3RydWN0IGlub2RlICppbm9k
ZSwKKwkJCSAgICAgc3RydWN0IHdyaXRlYmFja19jb250cm9sICp3YmMpOworc3RhdGljIHZvaWQg
ZXhmYXRfd3JpdGVfc3VwZXIoc3RydWN0IHN1cGVyX2Jsb2NrICpzYik7CisKKyNkZWZpbmUgVU5J
WF9TRUNTXzE5ODAgICAgMzE1NTMyODAwTAorCisjaWYgQklUU19QRVJfTE9ORyA9PSA2NAorI2Rl
ZmluZSBVTklYX1NFQ1NfMjEwOCAgICA0MzU0ODE5MjAwTAorI2VuZGlmCisKKy8qIGRheXMgYmV0
d2VlbiAxLjEuNzAgYW5kIDEuMS44MCAoMiBsZWFwIGRheXMpICovCisjZGVmaW5lIERBWVNfREVM
VEFfREVDQURFICAgICgzNjUgKiAxMCArIDIpCisvKiAxMjAgKDIxMDAgLSAxOTgwKSBpc24ndCBs
ZWFwIHllYXIgKi8KKyNkZWZpbmUgTk9fTEVBUF9ZRUFSXzIxMDAgICAgKDEyMCkKKyNkZWZpbmUg
SVNfTEVBUF9ZRUFSKHkpICAgICghKCh5KSAmIDB4MykgJiYgKHkpICE9IE5PX0xFQVBfWUVBUl8y
MTAwKQorCisjZGVmaW5lIFNFQ1NfUEVSX01JTiAgICAoNjApCisjZGVmaW5lIFNFQ1NfUEVSX0hP
VVIgICAoNjAgKiBTRUNTX1BFUl9NSU4pCisjZGVmaW5lIFNFQ1NfUEVSX0RBWSAgICAoMjQgKiBT
RUNTX1BFUl9IT1VSKQorCisjZGVmaW5lIE1BS0VfTEVBUF9ZRUFSKGxlYXBfeWVhciwgeWVhcikg
ICAgICAgICAgICAgICAgICAgICAgICAgXAorCWRvIHsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorCQlpZiAodW5saWtlbHkoeWVhciA+IE5PX0xF
QVBfWUVBUl8yMTAwKSkgICAgICAgICBcCisJCQlsZWFwX3llYXIgPSAoKHllYXIgKyAzKSAvIDQp
IC0gMTsgICAgICAgXAorCQllbHNlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBcCisJCQlsZWFwX3llYXIgPSAoKHllYXIgKyAzKSAvIDQpOyAgICAgICAgICAgXAor
CX0gd2hpbGUgKDApCisKKy8qIExpbmVhciBkYXkgbnVtYmVycyBvZiB0aGUgcmVzcGVjdGl2ZSAx
c3RzIGluIG5vbi1sZWFwIHllYXJzLiAqLworc3RhdGljIHRpbWVfdCBhY2N1bV9kYXlzX2luX3ll
YXJbXSA9IHsKKwkvKiBKYW4gIEZlYiAgTWFyICBBcHIgIE1heSAgSnVuICBKdWwgIEF1ZyAgU2Vw
ICBPY3QgIE5vdiAgRGVjICovCisJMCwgICAwLCAgMzEsICA1OSwgIDkwLCAxMjAsIDE1MSwgMTgx
LCAyMTIsIDI0MywgMjczLCAzMDQsIDMzNCwgMCwgMCwgMCwKK307CisKKy8qIENvbnZlcnQgYSBG
QVQgdGltZS9kYXRlIHBhaXIgdG8gYSBVTklYIGRhdGUgKHNlY29uZHMgc2luY2UgMSAxIDcwKS4g
Ki8KK3N0YXRpYyB2b2lkIGV4ZmF0X3RpbWVfZmF0MnVuaXgoc3RydWN0IGV4ZmF0X3NiX2luZm8g
KnNiaSwKKwkJCQlzdHJ1Y3QgdGltZXNwZWM2NCAqdHMsIHN0cnVjdCBkYXRlX3RpbWVfdCAqdHAp
Cit7CisJdGltZV90IHllYXIgPSB0cC0+WWVhcjsKKwl0aW1lX3QgbGQ7CisKKwlNQUtFX0xFQVBf
WUVBUihsZCwgeWVhcik7CisKKwlpZiAoSVNfTEVBUF9ZRUFSKHllYXIpICYmICh0cC0+TW9udGgp
ID4gMikKKwkJbGQrKzsKKworCXRzLT50dl9zZWMgPSB0cC0+U2Vjb25kICsKKwkJICAgICB0cC0+
TWludXRlICogU0VDU19QRVJfTUlOICsKKwkJICAgICB0cC0+SG91ciAqIFNFQ1NfUEVSX0hPVVIg
KworCQkgICAgIChsZCArIGFjY3VtX2RheXNfaW5feWVhclsodHAtPk1vbnRoKV0gKworCQkgICAg
ICAodHAtPkRheSAtIDEpKSAqIFNFQ1NfUEVSX0RBWSArCisJCSAgICAgKHllYXIgKiAzNjUgKyBE
QVlTX0RFTFRBX0RFQ0FERSkgKiBTRUNTX1BFUl9EQVkgKworCQkgICAgIHN5c190ei50el9taW51
dGVzd2VzdCAqIFNFQ1NfUEVSX01JTjsKKworCXRzLT50dl9uc2VjID0gMDsKK30KKworLyogQ29u
dmVydCBsaW5lYXIgVU5JWCBkYXRlIHRvIGEgRkFUIHRpbWUvZGF0ZSBwYWlyLiAqLworc3RhdGlj
IHZvaWQgZXhmYXRfdGltZV91bml4MmZhdChzdHJ1Y3QgZXhmYXRfc2JfaW5mbyAqc2JpLAorCQkJ
CXN0cnVjdCB0aW1lc3BlYzY0ICp0cywgc3RydWN0IGRhdGVfdGltZV90ICp0cCkKK3sKKwl0aW1l
X3Qgc2Vjb25kID0gdHMtPnR2X3NlYzsKKwl0aW1lX3QgZGF5LCBtb250aCwgeWVhcjsKKwl0aW1l
X3QgbGQ7CisKKwlzZWNvbmQgLT0gc3lzX3R6LnR6X21pbnV0ZXN3ZXN0ICogU0VDU19QRVJfTUlO
OworCisJLyogSmFuIDEgR01UIDAwOjAwOjAwIDE5ODAuIEJ1dCB3aGF0IGFib3V0IGFub3RoZXIg
dGltZSB6b25lPyAqLworCWlmIChzZWNvbmQgPCBVTklYX1NFQ1NfMTk4MCkgeworCQl0cC0+U2Vj
b25kICA9IDA7CisJCXRwLT5NaW51dGUgID0gMDsKKwkJdHAtPkhvdXIgPSAwOworCQl0cC0+RGF5
ICA9IDE7CisJCXRwLT5Nb250aCAgPSAxOworCQl0cC0+WWVhciA9IDA7CisJCXJldHVybjsKKwl9
CisjaWYgKEJJVFNfUEVSX0xPTkcgPT0gNjQpCisJaWYgKHNlY29uZCA+PSBVTklYX1NFQ1NfMjEw
OCkgeworCQl0cC0+U2Vjb25kICA9IDU5OworCQl0cC0+TWludXRlICA9IDU5OworCQl0cC0+SG91
ciA9IDIzOworCQl0cC0+RGF5ICA9IDMxOworCQl0cC0+TW9udGggID0gMTI7CisJCXRwLT5ZZWFy
ID0gMTI3OworCQlyZXR1cm47CisJfQorI2VuZGlmCisJZGF5ID0gc2Vjb25kIC8gU0VDU19QRVJf
REFZIC0gREFZU19ERUxUQV9ERUNBREU7CisJeWVhciA9IGRheSAvIDM2NTsKKwlNQUtFX0xFQVBf
WUVBUihsZCwgeWVhcik7CisJaWYgKHllYXIgKiAzNjUgKyBsZCA+IGRheSkKKwkJeWVhci0tOwor
CisJTUFLRV9MRUFQX1lFQVIobGQsIHllYXIpOworCWRheSAtPSB5ZWFyICogMzY1ICsgbGQ7CisK
KwlpZiAoSVNfTEVBUF9ZRUFSKHllYXIpICYmIGRheSA9PSBhY2N1bV9kYXlzX2luX3llYXJbM10p
IHsKKwkJbW9udGggPSAyOworCX0gZWxzZSB7CisJCWlmIChJU19MRUFQX1lFQVIoeWVhcikgJiYg
ZGF5ID4gYWNjdW1fZGF5c19pbl95ZWFyWzNdKQorCQkJZGF5LS07CisJCWZvciAobW9udGggPSAx
OyBtb250aCA8IDEyOyBtb250aCsrKSB7CisJCQlpZiAoYWNjdW1fZGF5c19pbl95ZWFyW21vbnRo
ICsgMV0gPiBkYXkpCisJCQkJYnJlYWs7CisJCX0KKwl9CisJZGF5IC09IGFjY3VtX2RheXNfaW5f
eWVhclttb250aF07CisKKwl0cC0+U2Vjb25kICA9IHNlY29uZCAlIFNFQ1NfUEVSX01JTjsKKwl0
cC0+TWludXRlICA9IChzZWNvbmQgLyBTRUNTX1BFUl9NSU4pICUgNjA7CisJdHAtPkhvdXIgPSAo
c2Vjb25kIC8gU0VDU19QRVJfSE9VUikgJSAyNDsKKwl0cC0+RGF5ICA9IGRheSArIDE7CisJdHAt
Pk1vbnRoICA9IG1vbnRoOworCXRwLT5ZZWFyID0geWVhcjsKK30KKworc3RydWN0IHRpbWVzdGFt
cF90ICp0bV9jdXJyZW50KHN0cnVjdCB0aW1lc3RhbXBfdCAqdHApCit7CisJc3RydWN0IHRpbWVz
cGVjNjQgdHM7CisJdGltZV90IHNlY29uZCwgZGF5LCBsZWFwX2RheSwgbW9udGgsIHllYXI7CisK
KwlrdGltZV9nZXRfcmVhbF90czY0KCZ0cyk7CisKKwlzZWNvbmQgPSB0cy50dl9zZWM7CisJc2Vj
b25kIC09IHN5c190ei50el9taW51dGVzd2VzdCAqIFNFQ1NfUEVSX01JTjsKKworCS8qIEphbiAx
IEdNVCAwMDowMDowMCAxOTgwLiBCdXQgd2hhdCBhYm91dCBhbm90aGVyIHRpbWUgem9uZT8gKi8K
KwlpZiAoc2Vjb25kIDwgVU5JWF9TRUNTXzE5ODApIHsKKwkJdHAtPnNlYyAgPSAwOworCQl0cC0+
bWluICA9IDA7CisJCXRwLT5ob3VyID0gMDsKKwkJdHAtPmRheSAgPSAxOworCQl0cC0+bW9uICA9
IDE7CisJCXRwLT55ZWFyID0gMDsKKwkJcmV0dXJuIHRwOworCX0KKyNpZiBCSVRTX1BFUl9MT05H
ID09IDY0CisJaWYgKHNlY29uZCA+PSBVTklYX1NFQ1NfMjEwOCkgeworCQl0cC0+c2VjICA9IDU5
OworCQl0cC0+bWluICA9IDU5OworCQl0cC0+aG91ciA9IDIzOworCQl0cC0+ZGF5ICA9IDMxOwor
CQl0cC0+bW9uICA9IDEyOworCQl0cC0+eWVhciA9IDEyNzsKKwkJcmV0dXJuIHRwOworCX0KKyNl
bmRpZgorCisJZGF5ID0gc2Vjb25kIC8gU0VDU19QRVJfREFZIC0gREFZU19ERUxUQV9ERUNBREU7
CisJeWVhciA9IGRheSAvIDM2NTsKKworCU1BS0VfTEVBUF9ZRUFSKGxlYXBfZGF5LCB5ZWFyKTsK
KwlpZiAoeWVhciAqIDM2NSArIGxlYXBfZGF5ID4gZGF5KQorCQl5ZWFyLS07CisKKwlNQUtFX0xF
QVBfWUVBUihsZWFwX2RheSwgeWVhcik7CisKKwlkYXkgLT0geWVhciAqIDM2NSArIGxlYXBfZGF5
OworCisJaWYgKElTX0xFQVBfWUVBUih5ZWFyKSAmJiBkYXkgPT0gYWNjdW1fZGF5c19pbl95ZWFy
WzNdKSB7CisJCW1vbnRoID0gMjsKKwl9IGVsc2UgeworCQlpZiAoSVNfTEVBUF9ZRUFSKHllYXIp
ICYmIGRheSA+IGFjY3VtX2RheXNfaW5feWVhclszXSkKKwkJCWRheS0tOworCQlmb3IgKG1vbnRo
ID0gMTsgbW9udGggPCAxMjsgbW9udGgrKykgeworCQkJaWYgKGFjY3VtX2RheXNfaW5feWVhcltt
b250aCArIDFdID4gZGF5KQorCQkJCWJyZWFrOworCQl9CisJfQorCWRheSAtPSBhY2N1bV9kYXlz
X2luX3llYXJbbW9udGhdOworCisJdHAtPnNlYyAgPSBzZWNvbmQgJSBTRUNTX1BFUl9NSU47CisJ
dHAtPm1pbiAgPSAoc2Vjb25kIC8gU0VDU19QRVJfTUlOKSAlIDYwOworCXRwLT5ob3VyID0gKHNl
Y29uZCAvIFNFQ1NfUEVSX0hPVVIpICUgMjQ7CisJdHAtPmRheSAgPSBkYXkgKyAxOworCXRwLT5t
b24gID0gbW9udGg7CisJdHAtPnllYXIgPSB5ZWFyOworCisJcmV0dXJuIHRwOworfQorCitzdGF0
aWMgdm9pZCBfX2xvY2tfc3VwZXIoc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sKKwlzdHJ1Y3Qg
ZXhmYXRfc2JfaW5mbyAqc2JpID0gRVhGQVRfU0Ioc2IpOworCisJbXV0ZXhfbG9jaygmc2JpLT5z
X2xvY2spOworfQorCitzdGF0aWMgdm9pZCBfX3VubG9ja19zdXBlcihzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiKQoreworCXN0cnVjdCBleGZhdF9zYl9pbmZvICpzYmkgPSBFWEZBVF9TQihzYik7CisK
KwltdXRleF91bmxvY2soJnNiaS0+c19sb2NrKTsKK30KKworc3RhdGljIGludCBfX2lzX3NiX2Rp
cnR5KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCit7CisJc3RydWN0IGV4ZmF0X3NiX2luZm8gKnNi
aSA9IEVYRkFUX1NCKHNiKTsKKworCXJldHVybiBzYmktPnNfZGlydDsKK30KKworc3RhdGljIHZv
aWQgX19zZXRfc2JfY2xlYW4oc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sKKwlzdHJ1Y3QgZXhm
YXRfc2JfaW5mbyAqc2JpID0gRVhGQVRfU0Ioc2IpOworCisJc2JpLT5zX2RpcnQgPSAwOworfQor
CitzdGF0aWMgaW50IF9fZXhmYXRfcmV2YWxpZGF0ZShzdHJ1Y3QgZGVudHJ5ICpkZW50cnkpCit7
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZXhmYXRfcmV2YWxpZGF0ZShzdHJ1Y3QgZGVu
dHJ5ICpkZW50cnksIHVuc2lnbmVkIGludCBmbGFncykKK3sKKwlpZiAoZmxhZ3MgJiBMT09LVVBf
UkNVKQorCQlyZXR1cm4gLUVDSElMRDsKKworCWlmIChkZW50cnktPmRfaW5vZGUpCisJCXJldHVy
biAxOworCXJldHVybiBfX2V4ZmF0X3JldmFsaWRhdGUoZGVudHJ5KTsKK30KKworc3RhdGljIGlu
dCBleGZhdF9yZXZhbGlkYXRlX2NpKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwgdW5zaWduZWQgaW50
IGZsYWdzKQoreworCWlmIChmbGFncyAmIExPT0tVUF9SQ1UpCisJCXJldHVybiAtRUNISUxEOwor
CisJaWYgKGRlbnRyeS0+ZF9pbm9kZSkKKwkJcmV0dXJuIDE7CisKKwlpZiAoIWZsYWdzKQorCQly
ZXR1cm4gMDsKKworCWlmIChmbGFncyAmIChMT09LVVBfQ1JFQVRFIHwgTE9PS1VQX1JFTkFNRV9U
QVJHRVQpKQorCQlyZXR1cm4gMDsKKworCXJldHVybiBfX2V4ZmF0X3JldmFsaWRhdGUoZGVudHJ5
KTsKK30KKworc3RhdGljIHVuc2lnbmVkIGludCBfX2V4ZmF0X3N0cmlwdGFpbF9sZW4odW5zaWdu
ZWQgaW50IGxlbiwgY29uc3QgY2hhciAqbmFtZSkKK3sKKwl3aGlsZSAobGVuICYmIG5hbWVbbGVu
IC0gMV0gPT0gJy4nKQorCQlsZW4tLTsKKwlyZXR1cm4gbGVuOworfQorCitzdGF0aWMgdW5zaWdu
ZWQgaW50IGV4ZmF0X3N0cmlwdGFpbF9sZW4oY29uc3Qgc3RydWN0IHFzdHIgKnFzdHIpCit7CisJ
cmV0dXJuIF9fZXhmYXRfc3RyaXB0YWlsX2xlbihxc3RyLT5sZW4sIHFzdHItPm5hbWUpOworfQor
CitzdGF0aWMgaW50IGV4ZmF0X2RfaGFzaChjb25zdCBzdHJ1Y3QgZGVudHJ5ICpkZW50cnksIHN0
cnVjdCBxc3RyICpxc3RyKQoreworCXFzdHItPmhhc2ggPSBmdWxsX25hbWVfaGFzaChkZW50cnks
IHFzdHItPm5hbWUsCisJCQkJICAgIGV4ZmF0X3N0cmlwdGFpbF9sZW4ocXN0cikpOworCXJldHVy
biAwOworfQorCitzdGF0aWMgaW50IGV4ZmF0X2RfaGFzaGkoY29uc3Qgc3RydWN0IGRlbnRyeSAq
ZGVudHJ5LCBzdHJ1Y3QgcXN0ciAqcXN0cikKK3sKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0g
ZGVudHJ5LT5kX3NiOworCWNvbnN0IHVuc2lnbmVkIGNoYXIgKm5hbWU7CisJdW5zaWduZWQgaW50
IGxlbjsKKwl1bnNpZ25lZCBsb25nIGhhc2g7CisKKwluYW1lID0gcXN0ci0+bmFtZTsKKwlsZW4g
PSBleGZhdF9zdHJpcHRhaWxfbGVuKHFzdHIpOworCisJaGFzaCA9IGluaXRfbmFtZV9oYXNoKGRl
bnRyeSk7CisJd2hpbGUgKGxlbi0tKQorCQloYXNoID0gcGFydGlhbF9uYW1lX2hhc2gobmxzX3Vw
cGVyKHNiLCAqbmFtZSsrKSwgaGFzaCk7CisJcXN0ci0+aGFzaCA9IGVuZF9uYW1lX2hhc2goaGFz
aCk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBleGZhdF9jbXBpKGNvbnN0IHN0cnVj
dCBkZW50cnkgKmRlbnRyeSwgdW5zaWduZWQgaW50IGxlbiwKKwkJICAgICAgY29uc3QgY2hhciAq
c3RyLCBjb25zdCBzdHJ1Y3QgcXN0ciAqbmFtZSkKK3sKKwlzdHJ1Y3QgbmxzX3RhYmxlICp0ID0g
RVhGQVRfU0IoZGVudHJ5LT5kX3NiKS0+bmxzX2lvOworCXVuc2lnbmVkIGludCBhbGVuLCBibGVu
OworCisJYWxlbiA9IGV4ZmF0X3N0cmlwdGFpbF9sZW4obmFtZSk7CisJYmxlbiA9IF9fZXhmYXRf
c3RyaXB0YWlsX2xlbihsZW4sIHN0cik7CisJaWYgKGFsZW4gPT0gYmxlbikgeworCQlpZiAodCA9
PSBOVUxMKSB7CisJCQlpZiAoc3RybmNhc2VjbXAobmFtZS0+bmFtZSwgc3RyLCBhbGVuKSA9PSAw
KQorCQkJCXJldHVybiAwOworCQl9IGVsc2UgaWYgKG5sc19zdHJuaWNtcCh0LCBuYW1lLT5uYW1l
LCBzdHIsIGFsZW4pID09IDApCisJCQlyZXR1cm4gMDsKKwl9CisJcmV0dXJuIDE7Cit9CisKK3N0
YXRpYyBpbnQgZXhmYXRfY21wKGNvbnN0IHN0cnVjdCBkZW50cnkgKmRlbnRyeSwgdW5zaWduZWQg
aW50IGxlbiwKKwkJICAgICBjb25zdCBjaGFyICpzdHIsIGNvbnN0IHN0cnVjdCBxc3RyICpuYW1l
KQoreworCXVuc2lnbmVkIGludCBhbGVuLCBibGVuOworCisJYWxlbiA9IGV4ZmF0X3N0cmlwdGFp
bF9sZW4obmFtZSk7CisJYmxlbiA9IF9fZXhmYXRfc3RyaXB0YWlsX2xlbihsZW4sIHN0cik7CisJ
aWYgKGFsZW4gPT0gYmxlbikgeworCQlpZiAoc3RybmNtcChuYW1lLT5uYW1lLCBzdHIsIGFsZW4p
ID09IDApCisJCQlyZXR1cm4gMDsKKwl9CisJcmV0dXJuIDE7Cit9CisKK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgZGVudHJ5X29wZXJhdGlvbnMgZXhmYXRfY2lfZGVudHJ5X29wcyA9IHsKKwkuZF9yZXZh
bGlkYXRlICAgPSBleGZhdF9yZXZhbGlkYXRlX2NpLAorCS5kX2hhc2ggICAgICAgICA9IGV4ZmF0
X2RfaGFzaGksCisJLmRfY29tcGFyZSAgICAgID0gZXhmYXRfY21waSwKK307CisKK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgZGVudHJ5X29wZXJhdGlvbnMgZXhmYXRfZGVudHJ5X29wcyA9IHsKKwkuZF9y
ZXZhbGlkYXRlICAgPSBleGZhdF9yZXZhbGlkYXRlLAorCS5kX2hhc2ggICAgICAgICA9IGV4ZmF0
X2RfaGFzaCwKKwkuZF9jb21wYXJlICAgICAgPSBleGZhdF9jbXAsCit9OworCitzdGF0aWMgREVG
SU5FX1NFTUFQSE9SRSh6X3NlbSk7CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBmc19zeW5jKHN0cnVj
dCBzdXBlcl9ibG9jayAqc2IsIGJvb2wgZG9fc3luYykKK3sKKwlpZiAoZG9fc3luYykKKwkJYmRl
dl9zeW5jKHNiKTsKK30KKworLyoKKyAqIElmIC0+aV9tb2RlIGNhbid0IGhvbGQgU19JV1VHTyAo
aS5lLiBBVFRSX1JPKSwgd2UgdXNlIC0+aV9hdHRycyB0bworICogc2F2ZSBBVFRSX1JPIGluc3Rl
YWQgb2YgLT5pX21vZGUuCisgKgorICogSWYgaXQncyBkaXJlY3RvcnkgYW5kICFzYmktPm9wdGlv
bnMucm9kaXIsIEFUVFJfUk8gaXNuJ3QgcmVhZC1vbmx5CisgKiBiaXQsIGl0J3MganVzdCB1c2Vk
IGFzIGZsYWcgZm9yIGFwcC4KKyAqLworc3RhdGljIGlubGluZSBpbnQgZXhmYXRfbW9kZV9jYW5f
aG9sZF9ybyhzdHJ1Y3QgaW5vZGUgKmlub2RlKQoreworCXN0cnVjdCBleGZhdF9zYl9pbmZvICpz
YmkgPSBFWEZBVF9TQihpbm9kZS0+aV9zYik7CisKKwlpZiAoU19JU0RJUihpbm9kZS0+aV9tb2Rl
KSkKKwkJcmV0dXJuIDA7CisKKwlpZiAoKH5zYmktPm9wdGlvbnMuZnNfZm1hc2spICYgMDIyMikK
KwkJcmV0dXJuIDE7CisJcmV0dXJuIDA7Cit9CisKKy8qIENvbnZlcnQgYXR0cmlidXRlIGJpdHMg
YW5kIGEgbWFzayB0byB0aGUgVU5JWCBtb2RlLiAqLworc3RhdGljIGlubGluZSBtb2RlX3QgZXhm
YXRfbWFrZV9tb2RlKHN0cnVjdCBleGZhdF9zYl9pbmZvICpzYmksIHUzMiBhdHRyLAorCQkJCSAg
ICAgbW9kZV90IG1vZGUpCit7CisJaWYgKChhdHRyICYgQVRUUl9SRUFET05MWSkgJiYgIShhdHRy
ICYgQVRUUl9TVUJESVIpKQorCQltb2RlICY9IH4wMjIyOworCisJaWYgKGF0dHIgJiBBVFRSX1NV
QkRJUikKKwkJcmV0dXJuIChtb2RlICYgfnNiaS0+b3B0aW9ucy5mc19kbWFzaykgfCBTX0lGRElS
OworCWVsc2UgaWYgKGF0dHIgJiBBVFRSX1NZTUxJTkspCisJCXJldHVybiAobW9kZSAmIH5zYmkt
Pm9wdGlvbnMuZnNfZG1hc2spIHwgU19JRkxOSzsKKwllbHNlCisJCXJldHVybiAobW9kZSAmIH5z
YmktPm9wdGlvbnMuZnNfZm1hc2spIHwgU19JRlJFRzsKK30KKworLyogUmV0dXJuIHRoZSBGQVQg
YXR0cmlidXRlIGJ5dGUgZm9yIHRoaXMgaW5vZGUgKi8KK3N0YXRpYyBpbmxpbmUgdTMyIGV4ZmF0
X21ha2VfYXR0cihzdHJ1Y3QgaW5vZGUgKmlub2RlKQoreworCWlmIChleGZhdF9tb2RlX2Nhbl9o
b2xkX3JvKGlub2RlKSAmJiAhKGlub2RlLT5pX21vZGUgJiAwMjIyKSkKKwkJcmV0dXJuIChFWEZB
VF9JKGlub2RlKS0+ZmlkLmF0dHIpIHwgQVRUUl9SRUFET05MWTsKKwllbHNlCisJCXJldHVybiBF
WEZBVF9JKGlub2RlKS0+ZmlkLmF0dHI7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBleGZhdF9z
YXZlX2F0dHIoc3RydWN0IGlub2RlICppbm9kZSwgdTMyIGF0dHIpCit7CisJaWYgKGV4ZmF0X21v
ZGVfY2FuX2hvbGRfcm8oaW5vZGUpKQorCQlFWEZBVF9JKGlub2RlKS0+ZmlkLmF0dHIgPSBhdHRy
ICYgQVRUUl9SV01BU0s7CisJZWxzZQorCQlFWEZBVF9JKGlub2RlKS0+ZmlkLmF0dHIgPSBhdHRy
ICYgKEFUVFJfUldNQVNLIHwgQVRUUl9SRUFET05MWSk7Cit9CisKK3N0YXRpYyBpbnQgZmZzTW91
bnRWb2woc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sKKwlpbnQgaSwgcmV0OworCXN0cnVjdCBw
YnJfc2VjdG9yX3QgKnBfcGJyOworCXN0cnVjdCBidWZmZXJfaGVhZCAqdG1wX2JoID0gTlVMTDsK
KwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0
cnVjdCBiZF9pbmZvX3QgKnBfYmQgPSAmKEVYRkFUX1NCKHNiKS0+YmRfaW5mbyk7CisKKwlwcl9p
bmZvKCJbRVhGQVRdIHRyeWluZyB0byBtb3VudC4uLlxuIik7CisKKwlkb3duKCZ6X3NlbSk7CisK
KwlidWZfaW5pdChzYik7CisKKwlzZW1hX2luaXQoJnBfZnMtPnZfc2VtLCAxKTsKKwlwX2ZzLT5k
ZXZfZWplY3RlZCA9IEZBTFNFOworCisJLyogb3BlbiB0aGUgYmxvY2sgZGV2aWNlICovCisJYmRl
dl9vcGVuKHNiKTsKKworCWlmIChwX2JkLT5zZWN0b3Jfc2l6ZSA8IHNiLT5zX2Jsb2Nrc2l6ZSkg
eworCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJCWdvdG8gb3V0OworCX0KKwlpZiAocF9iZC0+c2Vj
dG9yX3NpemUgPiBzYi0+c19ibG9ja3NpemUpCisJCXNiX3NldF9ibG9ja3NpemUoc2IsIHBfYmQt
PnNlY3Rvcl9zaXplKTsKKworCS8qIHJlYWQgU2VjdG9yIDAgKi8KKwlpZiAoc2VjdG9yX3JlYWQo
c2IsIDAsICZ0bXBfYmgsIDEpICE9IEZGU19TVUNDRVNTKSB7CisJCXJldCA9IEZGU19NRURJQUVS
UjsKKwkJZ290byBvdXQ7CisJfQorCisJcF9mcy0+UEJSX3NlY3RvciA9IDA7CisKKwlwX3BiciA9
IChzdHJ1Y3QgcGJyX3NlY3Rvcl90ICopIHRtcF9iaC0+Yl9kYXRhOworCisJLyogY2hlY2sgdGhl
IHZhbGlkaXR5IG9mIFBCUiAqLworCWlmIChHRVQxNl9BKHBfcGJyLT5zaWduYXR1cmUpICE9IFBC
Ul9TSUdOQVRVUkUpIHsKKwkJYnJlbHNlKHRtcF9iaCk7CisJCWJkZXZfY2xvc2Uoc2IpOworCQly
ZXQgPSBGRlNfRk9STUFURVJSOworCQlnb3RvIG91dDsKKwl9CisKKwkvKiBmaWxsIGZzX3N0dWN0
ICovCisJZm9yIChpID0gMDsgaSA8IDUzOyBpKyspCisJCWlmIChwX3Bici0+YnBiW2ldKQorCQkJ
YnJlYWs7CisKKwlpZiAoaSA8IDUzKSB7CisJCWlmIChHRVQxNihwX3Bici0+YnBiICsgMTEpKSAv
KiBudW1fZmF0X3NlY3RvcnMgKi8KKwkJCXJldCA9IGZhdDE2X21vdW50KHNiLCBwX3Bicik7CisJ
CWVsc2UKKwkJCXJldCA9IGZhdDMyX21vdW50KHNiLCBwX3Bicik7CisJfSBlbHNlIHsKKwkJcmV0
ID0gZXhmYXRfbW91bnQoc2IsIHBfcGJyKTsKKwl9CisKKwlicmVsc2UodG1wX2JoKTsKKworCWlm
IChyZXQpIHsKKwkJYmRldl9jbG9zZShzYik7CisJCWdvdG8gb3V0OworCX0KKworCWlmIChwX2Zz
LT52b2xfdHlwZSA9PSBFWEZBVCkgeworCQlyZXQgPSBsb2FkX2FsbG9jX2JpdG1hcChzYik7CisJ
CWlmIChyZXQpIHsKKwkJCWJkZXZfY2xvc2Uoc2IpOworCQkJZ290byBvdXQ7CisJCX0KKwkJcmV0
ID0gbG9hZF91cGNhc2VfdGFibGUoc2IpOworCQlpZiAocmV0KSB7CisJCQlmcmVlX2FsbG9jX2Jp
dG1hcChzYik7CisJCQliZGV2X2Nsb3NlKHNiKTsKKwkJCWdvdG8gb3V0OworCQl9CisJfQorCisJ
aWYgKHBfZnMtPmRldl9lamVjdGVkKSB7CisJCWlmIChwX2ZzLT52b2xfdHlwZSA9PSBFWEZBVCkg
eworCQkJZnJlZV91cGNhc2VfdGFibGUoc2IpOworCQkJZnJlZV9hbGxvY19iaXRtYXAoc2IpOwor
CQl9CisJCWJkZXZfY2xvc2Uoc2IpOworCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJCWdvdG8gb3V0
OworCX0KKworCXByX2luZm8oIltFWEZBVF0gbW91bnRlZCBzdWNjZXNzZnVsbHlcbiIpOworCitv
dXQ6CisJdXAoJnpfc2VtKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgZmZzVW1v
dW50Vm9sKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCit7CisJc3RydWN0IGZzX2luZm9fdCAqcF9m
cyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlpbnQgZXJyID0gRkZTX1NVQ0NFU1M7CisK
Kwlwcl9pbmZvKCJbRVhGQVRdIHRyeWluZyB0byB1bm1vdW50Li4uXG4iKTsKKworCWRvd24oJnpf
c2VtKTsKKworCS8qIGFjcXVpcmUgdGhlIGxvY2sgZm9yIGZpbGUgc3lzdGVtIGNyaXRpY2FsIHNl
Y3Rpb24gKi8KKwlkb3duKCZwX2ZzLT52X3NlbSk7CisKKwlmc19zeW5jKHNiLCBmYWxzZSk7CisJ
ZnNfc2V0X3ZvbF9mbGFncyhzYiwgVk9MX0NMRUFOKTsKKworCWlmIChwX2ZzLT52b2xfdHlwZSA9
PSBFWEZBVCkgeworCQlmcmVlX3VwY2FzZV90YWJsZShzYik7CisJCWZyZWVfYWxsb2NfYml0bWFw
KHNiKTsKKwl9CisKKwlGQVRfcmVsZWFzZV9hbGwoc2IpOworCWJ1Zl9yZWxlYXNlX2FsbChzYik7
CisKKwkvKiBjbG9zZSB0aGUgYmxvY2sgZGV2aWNlICovCisJYmRldl9jbG9zZShzYik7CisKKwlp
ZiAocF9mcy0+ZGV2X2VqZWN0ZWQpIHsKKwkJcHJfaW5mbygiW0VYRkFUXSB1bm1vdW50ZWQgd2l0
aCBtZWRpYSBlcnJvcnMuIERldmljZSBpcyBhbHJlYWR5IGVqZWN0ZWQuXG4iKTsKKwkJZXJyID0g
RkZTX01FRElBRVJSOworCX0KKworCWJ1Zl9zaHV0ZG93bihzYik7CisKKwkvKiByZWxlYXNlIHRo
ZSBsb2NrIGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJdXAoJnBfZnMtPnZf
c2VtKTsKKwl1cCgmel9zZW0pOworCisJcHJfaW5mbygiW0VYRkFUXSB1bm1vdW50ZWQgc3VjY2Vz
c2Z1bGx5XG4iKTsKKworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgZmZzR2V0Vm9sSW5m
byhzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3Qgdm9sX2luZm9fdCAqaW5mbykKK3sKKwlp
bnQgZXJyID0gRkZTX1NVQ0NFU1M7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRf
U0Ioc2IpLT5mc19pbmZvKTsKKworCS8qIGNoZWNrIHRoZSB2YWxpZGl0eSBvZiBwb2ludGVyIHBh
cmFtZXRlcnMgKi8KKwlpZiAoaW5mbyA9PSBOVUxMKQorCQlyZXR1cm4gRkZTX0VSUk9SOworCisJ
LyogYWNxdWlyZSB0aGUgbG9jayBmb3IgZmlsZSBzeXN0ZW0gY3JpdGljYWwgc2VjdGlvbiAqLwor
CWRvd24oJnBfZnMtPnZfc2VtKTsKKworCWlmIChwX2ZzLT51c2VkX2NsdXN0ZXJzID09ICh1MzIp
IH4wKQorCQlwX2ZzLT51c2VkX2NsdXN0ZXJzID0gcF9mcy0+ZnNfZnVuYy0+Y291bnRfdXNlZF9j
bHVzdGVycyhzYik7CisKKwlpbmZvLT5GYXRUeXBlID0gcF9mcy0+dm9sX3R5cGU7CisJaW5mby0+
Q2x1c3RlclNpemUgPSBwX2ZzLT5jbHVzdGVyX3NpemU7CisJaW5mby0+TnVtQ2x1c3RlcnMgPSBw
X2ZzLT5udW1fY2x1c3RlcnMgLSAyOyAvKiBjbHUgMCAmIDEgKi8KKwlpbmZvLT5Vc2VkQ2x1c3Rl
cnMgPSBwX2ZzLT51c2VkX2NsdXN0ZXJzOworCWluZm8tPkZyZWVDbHVzdGVycyA9IGluZm8tPk51
bUNsdXN0ZXJzIC0gaW5mby0+VXNlZENsdXN0ZXJzOworCisJaWYgKHBfZnMtPmRldl9lamVjdGVk
KQorCQllcnIgPSBGRlNfTUVESUFFUlI7CisKKwkvKiByZWxlYXNlIHRoZSBsb2NrIGZvciBmaWxl
IHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJdXAoJnBfZnMtPnZfc2VtKTsKKworCXJldHVy
biBlcnI7Cit9CisKK3N0YXRpYyBpbnQgZmZzU3luY1ZvbChzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
LCBib29sIGRvX3N5bmMpCit7CisJaW50IGVyciA9IEZGU19TVUNDRVNTOworCXN0cnVjdCBmc19p
bmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisKKwkvKiBhY3F1aXJlIHRo
ZSBsb2NrIGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJZG93bigmcF9mcy0+
dl9zZW0pOworCisJLyogc3luY2hyb25pemUgdGhlIGZpbGUgc3lzdGVtICovCisJZnNfc3luYyhz
YiwgZG9fc3luYyk7CisJZnNfc2V0X3ZvbF9mbGFncyhzYiwgVk9MX0NMRUFOKTsKKworCWlmIChw
X2ZzLT5kZXZfZWplY3RlZCkKKwkJZXJyID0gRkZTX01FRElBRVJSOworCisJLyogcmVsZWFzZSB0
aGUgbG9jayBmb3IgZmlsZSBzeXN0ZW0gY3JpdGljYWwgc2VjdGlvbiAqLworCXVwKCZwX2ZzLT52
X3NlbSk7CisKKwlyZXR1cm4gZXJyOworfQorCisvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLworLyogIEZpbGUg
T3BlcmF0aW9uIEZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKi8KKy8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCisKK3N0YXRpYyBpbnQgZmZzTG9va3VwRmlsZShz
dHJ1Y3QgaW5vZGUgKmlub2RlLCBjaGFyICpwYXRoLCBzdHJ1Y3QgZmlsZV9pZF90ICpmaWQpCit7
CisJaW50IHJldCwgZGVudHJ5LCBudW1fZW50cmllczsKKwlzdHJ1Y3QgY2hhaW5fdCBkaXI7CisJ
c3RydWN0IHVuaV9uYW1lX3QgdW5pX25hbWU7CisJc3RydWN0IGRvc19uYW1lX3QgZG9zX25hbWU7
CisJc3RydWN0IGRlbnRyeV90ICplcCwgKmVwMjsKKwlzdHJ1Y3QgZW50cnlfc2V0X2NhY2hlX3Qg
KmVzID0gTlVMTDsKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0gaW5vZGUtPmlfc2I7CisJc3Ry
dWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKworCXByX2Rl
YnVnKCIlcyBlbnRlcmVkXG4iLCBfX2Z1bmNfXyk7CisKKwkvKiBjaGVjayB0aGUgdmFsaWRpdHkg
b2YgcG9pbnRlciBwYXJhbWV0ZXJzICovCisJaWYgKChmaWQgPT0gTlVMTCkgfHwgKHBhdGggPT0g
TlVMTCkgfHwgKCpwYXRoID09ICdcMCcpKQorCQlyZXR1cm4gRkZTX0VSUk9SOworCisJLyogYWNx
dWlyZSB0aGUgbG9jayBmb3IgZmlsZSBzeXN0ZW0gY3JpdGljYWwgc2VjdGlvbiAqLworCWRvd24o
JnBfZnMtPnZfc2VtKTsKKworCS8qIGNoZWNrIHRoZSB2YWxpZGl0eSBvZiBkaXJlY3RvcnkgbmFt
ZSBpbiB0aGUgZ2l2ZW4gcGF0aG5hbWUgKi8KKwlyZXQgPSByZXNvbHZlX3BhdGgoaW5vZGUsIHBh
dGgsICZkaXIsICZ1bmlfbmFtZSk7CisJaWYgKHJldCkKKwkJZ290byBvdXQ7CisKKwlyZXQgPSBn
ZXRfbnVtX2VudHJpZXNfYW5kX2Rvc19uYW1lKHNiLCAmZGlyLCAmdW5pX25hbWUsICZudW1fZW50
cmllcywKKwkJCQkJICAgJmRvc19uYW1lKTsKKwlpZiAocmV0KQorCQlnb3RvIG91dDsKKworCS8q
IHNlYXJjaCB0aGUgZmlsZSBuYW1lIGZvciBkaXJlY3RvcmllcyAqLworCWRlbnRyeSA9IHBfZnMt
PmZzX2Z1bmMtPmZpbmRfZGlyX2VudHJ5KHNiLCAmZGlyLCAmdW5pX25hbWUsIG51bV9lbnRyaWVz
LAorCQkJCQkgICAgICAgJmRvc19uYW1lLCBUWVBFX0FMTCk7CisJaWYgKGRlbnRyeSA8IC0xKSB7
CisJCXJldHVybiBGRlNfTk9URk9VTkQ7CisJCWdvdG8gb3V0OworCX0KKworCWZpZC0+ZGlyLmRp
ciA9IGRpci5kaXI7CisJZmlkLT5kaXIuc2l6ZSA9IGRpci5zaXplOworCWZpZC0+ZGlyLmZsYWdz
ID0gZGlyLmZsYWdzOworCWZpZC0+ZW50cnkgPSBkZW50cnk7CisKKwlpZiAoZGVudHJ5ID09IC0x
KSB7CisJCWZpZC0+dHlwZSA9IFRZUEVfRElSOworCQlmaWQtPnJ3b2Zmc2V0ID0gMDsKKwkJZmlk
LT5oaW50X2xhc3Rfb2ZmID0gLTE7CisKKwkJZmlkLT5hdHRyID0gQVRUUl9TVUJESVI7CisJCWZp
ZC0+ZmxhZ3MgPSAweDAxOworCQlmaWQtPnNpemUgPSAwOworCQlmaWQtPnN0YXJ0X2NsdSA9IHBf
ZnMtPnJvb3RfZGlyOworCX0gZWxzZSB7CisJCWlmIChwX2ZzLT52b2xfdHlwZSA9PSBFWEZBVCkg
eworCQkJZXMgPSBnZXRfZW50cnlfc2V0X2luX2RpcihzYiwgJmRpciwgZGVudHJ5LAorCQkJCQkJ
ICBFU18yX0VOVFJJRVMsICZlcCk7CisJCQlpZiAoIWVzKSB7CisJCQkJcmV0ID0gIEZGU19NRURJ
QUVSUjsKKwkJCQlnb3RvIG91dDsKKwkJCX0KKwkJCWVwMiA9IGVwKzE7CisJCX0gZWxzZSB7CisJ
CQllcCA9IGdldF9lbnRyeV9pbl9kaXIoc2IsICZkaXIsIGRlbnRyeSwgTlVMTCk7CisJCQlpZiAo
IWVwKSB7CisJCQkJcmV0ID0gIEZGU19NRURJQUVSUjsKKwkJCQlnb3RvIG91dDsKKwkJCX0KKwkJ
CWVwMiA9IGVwOworCQl9CisKKwkJZmlkLT50eXBlID0gcF9mcy0+ZnNfZnVuYy0+Z2V0X2VudHJ5
X3R5cGUoZXApOworCQlmaWQtPnJ3b2Zmc2V0ID0gMDsKKwkJZmlkLT5oaW50X2xhc3Rfb2ZmID0g
LTE7CisJCWZpZC0+YXR0ciA9IHBfZnMtPmZzX2Z1bmMtPmdldF9lbnRyeV9hdHRyKGVwKTsKKwor
CQlmaWQtPnNpemUgPSBwX2ZzLT5mc19mdW5jLT5nZXRfZW50cnlfc2l6ZShlcDIpOworCQlpZiAo
KGZpZC0+dHlwZSA9PSBUWVBFX0ZJTEUpICYmIChmaWQtPnNpemUgPT0gMCkpIHsKKwkJCWZpZC0+
ZmxhZ3MgPSAocF9mcy0+dm9sX3R5cGUgPT0gRVhGQVQpID8gMHgwMyA6IDB4MDE7CisJCQlmaWQt
PnN0YXJ0X2NsdSA9IENMVVNURVJfMzIofjApOworCQl9IGVsc2UgeworCQkJZmlkLT5mbGFncyA9
IHBfZnMtPmZzX2Z1bmMtPmdldF9lbnRyeV9mbGFnKGVwMik7CisJCQlmaWQtPnN0YXJ0X2NsdSA9
IHBfZnMtPmZzX2Z1bmMtPmdldF9lbnRyeV9jbHUwKGVwMik7CisJCX0KKworCQlpZiAocF9mcy0+
dm9sX3R5cGUgPT0gRVhGQVQpCisJCQlyZWxlYXNlX2VudHJ5X3NldChlcyk7CisJfQorCisJaWYg
KHBfZnMtPmRldl9lamVjdGVkKQorCQlyZXQgPSBGRlNfTUVESUFFUlI7CitvdXQ6CisJLyogcmVs
ZWFzZSB0aGUgbG9jayBmb3IgZmlsZSBzeXN0ZW0gY3JpdGljYWwgc2VjdGlvbiAqLworCXVwKCZw
X2ZzLT52X3NlbSk7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGZmc0NyZWF0ZUZp
bGUoc3RydWN0IGlub2RlICppbm9kZSwgY2hhciAqcGF0aCwgdTggbW9kZSwKKwkJCSBzdHJ1Y3Qg
ZmlsZV9pZF90ICpmaWQpCit7CisJc3RydWN0IGNoYWluX3QgZGlyOworCXN0cnVjdCB1bmlfbmFt
ZV90IHVuaV9uYW1lOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKKwlz
dHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCWludCBy
ZXQ7CisKKwkvKiBjaGVjayB0aGUgdmFsaWRpdHkgb2YgcG9pbnRlciBwYXJhbWV0ZXJzICovCisJ
aWYgKChmaWQgPT0gTlVMTCkgfHwgKHBhdGggPT0gTlVMTCkgfHwgKCpwYXRoID09ICdcMCcpKQor
CQlyZXR1cm4gRkZTX0VSUk9SOworCisJLyogYWNxdWlyZSB0aGUgbG9jayBmb3IgZmlsZSBzeXN0
ZW0gY3JpdGljYWwgc2VjdGlvbiAqLworCWRvd24oJnBfZnMtPnZfc2VtKTsKKworCS8qIGNoZWNr
IHRoZSB2YWxpZGl0eSBvZiBkaXJlY3RvcnkgbmFtZSBpbiB0aGUgZ2l2ZW4gcGF0aG5hbWUgKi8K
KwlyZXQgPSByZXNvbHZlX3BhdGgoaW5vZGUsIHBhdGgsICZkaXIsICZ1bmlfbmFtZSk7CisJaWYg
KHJldCkKKwkJZ290byBvdXQ7CisKKwlmc19zZXRfdm9sX2ZsYWdzKHNiLCBWT0xfRElSVFkpOwor
CisJLyogY3JlYXRlIGEgbmV3IGZpbGUgKi8KKwlyZXQgPSBjcmVhdGVfZmlsZShpbm9kZSwgJmRp
ciwgJnVuaV9uYW1lLCBtb2RlLCBmaWQpOworCisjaWZkZWYgQ09ORklHX0VYRkFUX0RFTEFZRURf
U1lOQworCWZzX3N5bmMoc2IsIGZhbHNlKTsKKwlmc19zZXRfdm9sX2ZsYWdzKHNiLCBWT0xfQ0xF
QU4pOworI2VuZGlmCisKKwlpZiAocF9mcy0+ZGV2X2VqZWN0ZWQpCisJCXJldCA9IEZGU19NRURJ
QUVSUjsKKworb3V0OgorCS8qIHJlbGVhc2UgdGhlIGxvY2sgZm9yIGZpbGUgc3lzdGVtIGNyaXRp
Y2FsIHNlY3Rpb24gKi8KKwl1cCgmcF9mcy0+dl9zZW0pOworCisJcmV0dXJuIHJldDsKK30KKwor
c3RhdGljIGludCBmZnNSZWFkRmlsZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZV9p
ZF90ICpmaWQsIHZvaWQgKmJ1ZmZlciwKKwkJICAgICAgIHU2NCBjb3VudCwgdTY0ICpyY291bnQp
Cit7CisJczMyIG9mZnNldCwgc2VjX29mZnNldCwgY2x1X29mZnNldDsKKwl1MzIgY2x1OworCWlu
dCByZXQ7CisJc2VjdG9yX3QgTG9nU2VjdG9yOworCXU2NCBvbmVibGtyZWFkLCByZWFkX2J5dGVz
OworCXN0cnVjdCBidWZmZXJfaGVhZCAqdG1wX2JoID0gTlVMTDsKKwlzdHJ1Y3Qgc3VwZXJfYmxv
Y2sgKnNiID0gaW5vZGUtPmlfc2I7CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRf
U0Ioc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgYmRfaW5mb190ICpwX2JkID0gJihFWEZBVF9TQihz
YiktPmJkX2luZm8pOworCisJLyogY2hlY2sgdGhlIHZhbGlkaXR5IG9mIHRoZSBnaXZlbiBmaWxl
IGlkICovCisJaWYgKGZpZCA9PSBOVUxMKQorCQlyZXR1cm4gRkZTX0lOVkFMSURGSUQ7CisKKwkv
KiBjaGVjayB0aGUgdmFsaWRpdHkgb2YgcG9pbnRlciBwYXJhbWV0ZXJzICovCisJaWYgKGJ1ZmZl
ciA9PSBOVUxMKQorCQlyZXR1cm4gRkZTX0VSUk9SOworCisJLyogYWNxdWlyZSB0aGUgbG9jayBm
b3IgZmlsZSBzeXN0ZW0gY3JpdGljYWwgc2VjdGlvbiAqLworCWRvd24oJnBfZnMtPnZfc2VtKTsK
KworCS8qIGNoZWNrIGlmIHRoZSBnaXZlbiBmaWxlIElEIGlzIG9wZW5lZCAqLworCWlmIChmaWQt
PnR5cGUgIT0gVFlQRV9GSUxFKSB7CisJCXJldCA9IEZGU19QRVJNSVNTSU9ORVJSOworCQlnb3Rv
IG91dDsKKwl9CisKKwlpZiAoZmlkLT5yd29mZnNldCA+IGZpZC0+c2l6ZSkKKwkJZmlkLT5yd29m
ZnNldCA9IGZpZC0+c2l6ZTsKKworCWlmIChjb3VudCA+IChmaWQtPnNpemUgLSBmaWQtPnJ3b2Zm
c2V0KSkKKwkJY291bnQgPSBmaWQtPnNpemUgLSBmaWQtPnJ3b2Zmc2V0OworCisJaWYgKGNvdW50
ID09IDApIHsKKwkJaWYgKHJjb3VudCAhPSBOVUxMKQorCQkJKnJjb3VudCA9IDA7CisJCXJldCA9
IEZGU19FT0Y7CisJCWdvdG8gb3V0OworCX0KKworCXJlYWRfYnl0ZXMgPSAwOworCisJd2hpbGUg
KGNvdW50ID4gMCkgeworCQljbHVfb2Zmc2V0ID0gKHMzMikoZmlkLT5yd29mZnNldCA+PiBwX2Zz
LT5jbHVzdGVyX3NpemVfYml0cyk7CisJCWNsdSA9IGZpZC0+c3RhcnRfY2x1OworCisJCWlmIChm
aWQtPmZsYWdzID09IDB4MDMpIHsKKwkJCWNsdSArPSBjbHVfb2Zmc2V0OworCQl9IGVsc2Ugewor
CQkJLyogaGludCBpbmZvcm1hdGlvbiAqLworCQkJaWYgKChjbHVfb2Zmc2V0ID4gMCkgJiYgKGZp
ZC0+aGludF9sYXN0X29mZiA+IDApICYmCisJCQkgICAgKGNsdV9vZmZzZXQgPj0gZmlkLT5oaW50
X2xhc3Rfb2ZmKSkgeworCQkJCWNsdV9vZmZzZXQgLT0gZmlkLT5oaW50X2xhc3Rfb2ZmOworCQkJ
CWNsdSA9IGZpZC0+aGludF9sYXN0X2NsdTsKKwkJCX0KKworCQkJd2hpbGUgKGNsdV9vZmZzZXQg
PiAwKSB7CisJCQkJLyogY2x1ID0gRkFUX3JlYWQoc2IsIGNsdSk7ICovCisJCQkJaWYgKEZBVF9y
ZWFkKHNiLCBjbHUsICZjbHUpID09IC0xKQorCQkJCQlyZXR1cm4gRkZTX01FRElBRVJSOworCisJ
CQkJY2x1X29mZnNldC0tOworCQkJfQorCQl9CisKKwkJLyogaGludCBpbmZvcm1hdGlvbiAqLwor
CQlmaWQtPmhpbnRfbGFzdF9vZmYgPSAoczMyKShmaWQtPnJ3b2Zmc2V0ID4+CisJCQkJCSAgIHBf
ZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKTsKKwkJZmlkLT5oaW50X2xhc3RfY2x1ID0gY2x1OworCisJ
CS8qIGJ5dGUgb2Zmc2V0IGluIGNsdXN0ZXIgKi8KKwkJb2Zmc2V0ID0gKHMzMikoZmlkLT5yd29m
ZnNldCAmIChwX2ZzLT5jbHVzdGVyX3NpemUtMSkpOworCisJCS8qIHNlY3RvciBvZmZzZXQgaW4g
Y2x1c3RlciAqLworCQlzZWNfb2Zmc2V0ID0gb2Zmc2V0ID4+IHBfYmQtPnNlY3Rvcl9zaXplX2Jp
dHM7CisKKwkJLyogYnl0ZSBvZmZzZXQgaW4gc2VjdG9yICovCisJCW9mZnNldCAmPSBwX2JkLT5z
ZWN0b3Jfc2l6ZV9tYXNrOworCisJCUxvZ1NlY3RvciA9IFNUQVJUX1NFQ1RPUihjbHUpICsgc2Vj
X29mZnNldDsKKworCQlvbmVibGtyZWFkID0gKHU2NCkocF9iZC0+c2VjdG9yX3NpemUgLSBvZmZz
ZXQpOworCQlpZiAob25lYmxrcmVhZCA+IGNvdW50KQorCQkJb25lYmxrcmVhZCA9IGNvdW50Owor
CisJCWlmICgob2Zmc2V0ID09IDApICYmIChvbmVibGtyZWFkID09IHBfYmQtPnNlY3Rvcl9zaXpl
KSkgeworCQkJaWYgKHNlY3Rvcl9yZWFkKHNiLCBMb2dTZWN0b3IsICZ0bXBfYmgsIDEpICE9CisJ
CQkgICAgRkZTX1NVQ0NFU1MpCisJCQkJZ290byBlcnJfb3V0OworCQkJbWVtY3B5KChjaGFyICop
YnVmZmVyICsgcmVhZF9ieXRlcywKKwkJCSAgICAgICAoY2hhciAqKXRtcF9iaC0+Yl9kYXRhLCAo
czMyKW9uZWJsa3JlYWQpOworCQl9IGVsc2UgeworCQkJaWYgKHNlY3Rvcl9yZWFkKHNiLCBMb2dT
ZWN0b3IsICZ0bXBfYmgsIDEpICE9CisJCQkgICAgRkZTX1NVQ0NFU1MpCisJCQkJZ290byBlcnJf
b3V0OworCQkJbWVtY3B5KChjaGFyICopYnVmZmVyICsgcmVhZF9ieXRlcywKKwkJCSAgICAgICAo
Y2hhciAqKXRtcF9iaC0+Yl9kYXRhICsgb2Zmc2V0LAorCQkJICAgICAgIChzMzIpb25lYmxrcmVh
ZCk7CisJCX0KKwkJY291bnQgLT0gb25lYmxrcmVhZDsKKwkJcmVhZF9ieXRlcyArPSBvbmVibGty
ZWFkOworCQlmaWQtPnJ3b2Zmc2V0ICs9IG9uZWJsa3JlYWQ7CisJfQorCWJyZWxzZSh0bXBfYmgp
OworCisvKiBIb3cgZGlkIHRoaXMgZXZlciB3b3JrIGFuZCBub3QgbGVhayBhIGJybHNlKCk/PyAq
LworZXJyX291dDoKKwkvKiBzZXQgdGhlIHNpemUgb2YgcmVhZCBieXRlcyAqLworCWlmIChyY291
bnQgIT0gTlVMTCkKKwkJKnJjb3VudCA9IHJlYWRfYnl0ZXM7CisKKwlpZiAocF9mcy0+ZGV2X2Vq
ZWN0ZWQpCisJCXJldCA9IEZGU19NRURJQUVSUjsKKworb3V0OgorCS8qIHJlbGVhc2UgdGhlIGxv
Y2sgZm9yIGZpbGUgc3lzdGVtIGNyaXRpY2FsIHNlY3Rpb24gKi8KKwl1cCgmcF9mcy0+dl9zZW0p
OworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBmZnNXcml0ZUZpbGUoc3RydWN0IGlu
b2RlICppbm9kZSwgc3RydWN0IGZpbGVfaWRfdCAqZmlkLAorCQkJdm9pZCAqYnVmZmVyLCB1NjQg
Y291bnQsIHU2NCAqd2NvdW50KQoreworCXMzMiBtb2RpZmllZCA9IEZBTFNFLCBvZmZzZXQsIHNl
Y19vZmZzZXQsIGNsdV9vZmZzZXQ7CisJczMyIG51bV9jbHVzdGVycywgbnVtX2FsbG9jLCBudW1f
YWxsb2NlZCA9IChzMzIpIH4wOworCWludCByZXQgPSAwOworCXUzMiBjbHUsIGxhc3RfY2x1Owor
CXNlY3Rvcl90IExvZ1NlY3Rvciwgc2VjdG9yID0gMDsKKwl1NjQgb25lYmxrd3JpdGUsIHdyaXRl
X2J5dGVzOworCXN0cnVjdCBjaGFpbl90IG5ld19jbHU7CisJc3RydWN0IHRpbWVzdGFtcF90IHRt
OworCXN0cnVjdCBkZW50cnlfdCAqZXAsICplcDI7CisJc3RydWN0IGVudHJ5X3NldF9jYWNoZV90
ICplcyA9IE5VTEw7CisJc3RydWN0IGJ1ZmZlcl9oZWFkICp0bXBfYmggPSBOVUxMOworCXN0cnVj
dCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2Zz
ID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0cnVjdCBiZF9pbmZvX3QgKnBfYmQgPSAm
KEVYRkFUX1NCKHNiKS0+YmRfaW5mbyk7CisKKwkvKiBjaGVjayB0aGUgdmFsaWRpdHkgb2YgdGhl
IGdpdmVuIGZpbGUgaWQgKi8KKwlpZiAoZmlkID09IE5VTEwpCisJCXJldHVybiBGRlNfSU5WQUxJ
REZJRDsKKworCS8qIGNoZWNrIHRoZSB2YWxpZGl0eSBvZiBwb2ludGVyIHBhcmFtZXRlcnMgKi8K
KwlpZiAoYnVmZmVyID09IE5VTEwpCisJCXJldHVybiBGRlNfRVJST1I7CisKKwkvKiBhY3F1aXJl
IHRoZSBsb2NrIGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJZG93bigmcF9m
cy0+dl9zZW0pOworCisJLyogY2hlY2sgaWYgdGhlIGdpdmVuIGZpbGUgSUQgaXMgb3BlbmVkICov
CisJaWYgKGZpZC0+dHlwZSAhPSBUWVBFX0ZJTEUpIHsKKwkJcmV0ID0gRkZTX1BFUk1JU1NJT05F
UlI7CisJCWdvdG8gb3V0OworCX0KKworCWlmIChmaWQtPnJ3b2Zmc2V0ID4gZmlkLT5zaXplKQor
CQlmaWQtPnJ3b2Zmc2V0ID0gZmlkLT5zaXplOworCisJaWYgKGNvdW50ID09IDApIHsKKwkJaWYg
KHdjb3VudCAhPSBOVUxMKQorCQkJKndjb3VudCA9IDA7CisJCXJldCA9IEZGU19TVUNDRVNTOwor
CQlnb3RvIG91dDsKKwl9CisKKwlmc19zZXRfdm9sX2ZsYWdzKHNiLCBWT0xfRElSVFkpOworCisJ
aWYgKGZpZC0+c2l6ZSA9PSAwKQorCQludW1fY2x1c3RlcnMgPSAwOworCWVsc2UKKwkJbnVtX2Ns
dXN0ZXJzID0gKHMzMikoKGZpZC0+c2l6ZS0xKSA+PgorCQkJCSAgICAgcF9mcy0+Y2x1c3Rlcl9z
aXplX2JpdHMpICsgMTsKKworCXdyaXRlX2J5dGVzID0gMDsKKworCXdoaWxlIChjb3VudCA+IDAp
IHsKKwkJY2x1X29mZnNldCA9IChzMzIpKGZpZC0+cndvZmZzZXQgPj4gcF9mcy0+Y2x1c3Rlcl9z
aXplX2JpdHMpOworCQljbHUgPSBsYXN0X2NsdSA9IGZpZC0+c3RhcnRfY2x1OworCisJCWlmIChm
aWQtPmZsYWdzID09IDB4MDMpIHsKKwkJCWlmICgoY2x1X29mZnNldCA+IDApICYmIChjbHUgIT0g
Q0xVU1RFUl8zMih+MCkpKSB7CisJCQkJbGFzdF9jbHUgKz0gY2x1X29mZnNldCAtIDE7CisKKwkJ
CQlpZiAoY2x1X29mZnNldCA9PSBudW1fY2x1c3RlcnMpCisJCQkJCWNsdSA9IENMVVNURVJfMzIo
fjApOworCQkJCWVsc2UKKwkJCQkJY2x1ICs9IGNsdV9vZmZzZXQ7CisJCQl9CisJCX0gZWxzZSB7
CisJCQkvKiBoaW50IGluZm9ybWF0aW9uICovCisJCQlpZiAoKGNsdV9vZmZzZXQgPiAwKSAmJiAo
ZmlkLT5oaW50X2xhc3Rfb2ZmID4gMCkgJiYKKwkJCSAgICAoY2x1X29mZnNldCA+PSBmaWQtPmhp
bnRfbGFzdF9vZmYpKSB7CisJCQkJY2x1X29mZnNldCAtPSBmaWQtPmhpbnRfbGFzdF9vZmY7CisJ
CQkJY2x1ID0gZmlkLT5oaW50X2xhc3RfY2x1OworCQkJfQorCisJCQl3aGlsZSAoKGNsdV9vZmZz
ZXQgPiAwKSAmJiAoY2x1ICE9IENMVVNURVJfMzIofjApKSkgeworCQkJCWxhc3RfY2x1ID0gY2x1
OworCQkJCS8qIGNsdSA9IEZBVF9yZWFkKHNiLCBjbHUpOyAqLworCQkJCWlmIChGQVRfcmVhZChz
YiwgY2x1LCAmY2x1KSA9PSAtMSkgeworCQkJCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJCQkJCWdv
dG8gb3V0OworCQkJCX0KKwkJCQljbHVfb2Zmc2V0LS07CisJCQl9CisJCX0KKworCQlpZiAoY2x1
ID09IENMVVNURVJfMzIofjApKSB7CisJCQludW1fYWxsb2MgPSAoczMyKSgoY291bnQgLSAxKSA+
PgorCQkJCQkgIHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKSArIDE7CisJCQluZXdfY2x1LmRpciA9
IChsYXN0X2NsdSA9PSBDTFVTVEVSXzMyKH4wKSkgPworCQkJCQlDTFVTVEVSXzMyKH4wKSA6IGxh
c3RfY2x1KzE7CisJCQluZXdfY2x1LnNpemUgPSAwOworCQkJbmV3X2NsdS5mbGFncyA9IGZpZC0+
ZmxhZ3M7CisKKwkJCS8qICgxKSBhbGxvY2F0ZSBhIGNoYWluIG9mIGNsdXN0ZXJzICovCisJCQlu
dW1fYWxsb2NlZCA9IHBfZnMtPmZzX2Z1bmMtPmFsbG9jX2NsdXN0ZXIoc2IsCisJCQkJCQkJCSAg
IG51bV9hbGxvYywKKwkJCQkJCQkJICAgJm5ld19jbHUpOworCQkJaWYgKG51bV9hbGxvY2VkID09
IDApCisJCQkJYnJlYWs7CisJCQllbHNlIGlmIChudW1fYWxsb2NlZCA8IDApIHsKKwkJCQlyZXQg
PSBGRlNfTUVESUFFUlI7CisJCQkJZ290byBvdXQ7CisJCQl9CisKKwkJCS8qICgyKSBhcHBlbmQg
dG8gdGhlIEZBVCBjaGFpbiAqLworCQkJaWYgKGxhc3RfY2x1ID09IENMVVNURVJfMzIofjApKSB7
CisJCQkJaWYgKG5ld19jbHUuZmxhZ3MgPT0gMHgwMSkKKwkJCQkJZmlkLT5mbGFncyA9IDB4MDE7
CisJCQkJZmlkLT5zdGFydF9jbHUgPSBuZXdfY2x1LmRpcjsKKwkJCQltb2RpZmllZCA9IFRSVUU7
CisJCQl9IGVsc2UgeworCQkJCWlmIChuZXdfY2x1LmZsYWdzICE9IGZpZC0+ZmxhZ3MpIHsKKwkJ
CQkJZXhmYXRfY2hhaW5fY29udF9jbHVzdGVyKHNiLAorCQkJCQkJCQkgZmlkLT5zdGFydF9jbHUs
CisJCQkJCQkJCSBudW1fY2x1c3RlcnMpOworCQkJCQlmaWQtPmZsYWdzID0gMHgwMTsKKwkJCQkJ
bW9kaWZpZWQgPSBUUlVFOworCQkJCX0KKwkJCQlpZiAobmV3X2NsdS5mbGFncyA9PSAweDAxKQor
CQkJCQlGQVRfd3JpdGUoc2IsIGxhc3RfY2x1LCBuZXdfY2x1LmRpcik7CisJCQl9CisKKwkJCW51
bV9jbHVzdGVycyArPSBudW1fYWxsb2NlZDsKKwkJCWNsdSA9IG5ld19jbHUuZGlyOworCQl9CisK
KwkJLyogaGludCBpbmZvcm1hdGlvbiAqLworCQlmaWQtPmhpbnRfbGFzdF9vZmYgPSAoczMyKShm
aWQtPnJ3b2Zmc2V0ID4+CisJCQkJCSAgIHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKTsKKwkJZmlk
LT5oaW50X2xhc3RfY2x1ID0gY2x1OworCisJCS8qIGJ5dGUgb2Zmc2V0IGluIGNsdXN0ZXIgICAq
LworCQlvZmZzZXQgPSAoczMyKShmaWQtPnJ3b2Zmc2V0ICYgKHBfZnMtPmNsdXN0ZXJfc2l6ZSAt
IDEpKTsKKworCQkvKiBzZWN0b3Igb2Zmc2V0IGluIGNsdXN0ZXIgKi8KKwkJc2VjX29mZnNldCA9
IG9mZnNldCA+PiBwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzOworCisJCS8qIGJ5dGUgb2Zmc2V0IGlu
IHNlY3RvciAgICAqLworCQlvZmZzZXQgJj0gcF9iZC0+c2VjdG9yX3NpemVfbWFzazsKKworCQlM
b2dTZWN0b3IgPSBTVEFSVF9TRUNUT1IoY2x1KSArIHNlY19vZmZzZXQ7CisKKwkJb25lYmxrd3Jp
dGUgPSAodTY0KShwX2JkLT5zZWN0b3Jfc2l6ZSAtIG9mZnNldCk7CisJCWlmIChvbmVibGt3cml0
ZSA+IGNvdW50KQorCQkJb25lYmxrd3JpdGUgPSBjb3VudDsKKworCQlpZiAoKG9mZnNldCA9PSAw
KSAmJiAob25lYmxrd3JpdGUgPT0gcF9iZC0+c2VjdG9yX3NpemUpKSB7CisJCQlpZiAoc2VjdG9y
X3JlYWQoc2IsIExvZ1NlY3RvciwgJnRtcF9iaCwgMCkgIT0KKwkJCSAgICBGRlNfU1VDQ0VTUykK
KwkJCQlnb3RvIGVycl9vdXQ7CisJCQltZW1jcHkoKGNoYXIgKil0bXBfYmgtPmJfZGF0YSwKKwkJ
CSAgICAgICAoY2hhciAqKWJ1ZmZlciArIHdyaXRlX2J5dGVzLCAoczMyKW9uZWJsa3dyaXRlKTsK
KwkJCWlmIChzZWN0b3Jfd3JpdGUoc2IsIExvZ1NlY3RvciwgdG1wX2JoLCAwKSAhPQorCQkJICAg
IEZGU19TVUNDRVNTKSB7CisJCQkJYnJlbHNlKHRtcF9iaCk7CisJCQkJZ290byBlcnJfb3V0Owor
CQkJfQorCQl9IGVsc2UgeworCQkJaWYgKChvZmZzZXQgPiAwKSB8fAorCQkJICAgICgoZmlkLT5y
d29mZnNldCtvbmVibGt3cml0ZSkgPCBmaWQtPnNpemUpKSB7CisJCQkJaWYgKHNlY3Rvcl9yZWFk
KHNiLCBMb2dTZWN0b3IsICZ0bXBfYmgsIDEpICE9CisJCQkJICAgIEZGU19TVUNDRVNTKQorCQkJ
CQlnb3RvIGVycl9vdXQ7CisJCQl9IGVsc2UgeworCQkJCWlmIChzZWN0b3JfcmVhZChzYiwgTG9n
U2VjdG9yLCAmdG1wX2JoLCAwKSAhPQorCQkJCSAgICBGRlNfU1VDQ0VTUykKKwkJCQkJZ290byBl
cnJfb3V0OworCQkJfQorCisJCQltZW1jcHkoKGNoYXIgKil0bXBfYmgtPmJfZGF0YSArIG9mZnNl
dCwKKwkJCSAgICAgICAoY2hhciAqKWJ1ZmZlciArIHdyaXRlX2J5dGVzLCAoczMyKW9uZWJsa3dy
aXRlKTsKKwkJCWlmIChzZWN0b3Jfd3JpdGUoc2IsIExvZ1NlY3RvciwgdG1wX2JoLCAwKSAhPQor
CQkJICAgIEZGU19TVUNDRVNTKSB7CisJCQkJYnJlbHNlKHRtcF9iaCk7CisJCQkJZ290byBlcnJf
b3V0OworCQkJfQorCQl9CisKKwkJY291bnQgLT0gb25lYmxrd3JpdGU7CisJCXdyaXRlX2J5dGVz
ICs9IG9uZWJsa3dyaXRlOworCQlmaWQtPnJ3b2Zmc2V0ICs9IG9uZWJsa3dyaXRlOworCisJCWZp
ZC0+YXR0ciB8PSBBVFRSX0FSQ0hJVkU7CisKKwkJaWYgKGZpZC0+c2l6ZSA8IGZpZC0+cndvZmZz
ZXQpIHsKKwkJCWZpZC0+c2l6ZSA9IGZpZC0+cndvZmZzZXQ7CisJCQltb2RpZmllZCA9IFRSVUU7
CisJCX0KKwl9CisKKwlicmVsc2UodG1wX2JoKTsKKworCS8qICgzKSB1cGRhdGUgdGhlIGRpcmVj
b3R5IGVudHJ5ICovCisJaWYgKHBfZnMtPnZvbF90eXBlID09IEVYRkFUKSB7CisJCWVzID0gZ2V0
X2VudHJ5X3NldF9pbl9kaXIoc2IsICYoZmlkLT5kaXIpLCBmaWQtPmVudHJ5LAorCQkJCQkgIEVT
X0FMTF9FTlRSSUVTLCAmZXApOworCQlpZiAoZXMgPT0gTlVMTCkKKwkJCWdvdG8gZXJyX291dDsK
KwkJZXAyID0gZXArMTsKKwl9IGVsc2UgeworCQllcCA9IGdldF9lbnRyeV9pbl9kaXIoc2IsICYo
ZmlkLT5kaXIpLCBmaWQtPmVudHJ5LCAmc2VjdG9yKTsKKwkJaWYgKCFlcCkKKwkJCWdvdG8gZXJy
X291dDsKKwkJZXAyID0gZXA7CisJfQorCisJcF9mcy0+ZnNfZnVuYy0+c2V0X2VudHJ5X3RpbWUo
ZXAsIHRtX2N1cnJlbnQoJnRtKSwgVE1fTU9ESUZZKTsKKwlwX2ZzLT5mc19mdW5jLT5zZXRfZW50
cnlfYXR0cihlcCwgZmlkLT5hdHRyKTsKKworCWlmIChwX2ZzLT52b2xfdHlwZSAhPSBFWEZBVCkK
KwkJYnVmX21vZGlmeShzYiwgc2VjdG9yKTsKKworCWlmIChtb2RpZmllZCkgeworCQlpZiAocF9m
cy0+ZnNfZnVuYy0+Z2V0X2VudHJ5X2ZsYWcoZXAyKSAhPSBmaWQtPmZsYWdzKQorCQkJcF9mcy0+
ZnNfZnVuYy0+c2V0X2VudHJ5X2ZsYWcoZXAyLCBmaWQtPmZsYWdzKTsKKworCQlpZiAocF9mcy0+
ZnNfZnVuYy0+Z2V0X2VudHJ5X3NpemUoZXAyKSAhPSBmaWQtPnNpemUpCisJCQlwX2ZzLT5mc19m
dW5jLT5zZXRfZW50cnlfc2l6ZShlcDIsIGZpZC0+c2l6ZSk7CisKKwkJaWYgKHBfZnMtPmZzX2Z1
bmMtPmdldF9lbnRyeV9jbHUwKGVwMikgIT0gZmlkLT5zdGFydF9jbHUpCisJCQlwX2ZzLT5mc19m
dW5jLT5zZXRfZW50cnlfY2x1MChlcDIsIGZpZC0+c3RhcnRfY2x1KTsKKworCQlpZiAocF9mcy0+
dm9sX3R5cGUgIT0gRVhGQVQpCisJCQlidWZfbW9kaWZ5KHNiLCBzZWN0b3IpOworCX0KKworCWlm
IChwX2ZzLT52b2xfdHlwZSA9PSBFWEZBVCkgeworCQl1cGRhdGVfZGlyX2NoZWNrc3VtX3dpdGhf
ZW50cnlfc2V0KHNiLCBlcyk7CisJCXJlbGVhc2VfZW50cnlfc2V0KGVzKTsKKwl9CisKKyNpZmRl
ZiBDT05GSUdfRVhGQVRfREVMQVlFRF9TWU5DCisJZnNfc3luYyhzYiwgZmFsc2UpOworCWZzX3Nl
dF92b2xfZmxhZ3Moc2IsIFZPTF9DTEVBTik7CisjZW5kaWYKKworZXJyX291dDoKKwkvKiBzZXQg
dGhlIHNpemUgb2Ygd3JpdHRlbiBieXRlcyAqLworCWlmICh3Y291bnQgIT0gTlVMTCkKKwkJKndj
b3VudCA9IHdyaXRlX2J5dGVzOworCisJaWYgKG51bV9hbGxvY2VkID09IDApCisJCXJldCA9IEZG
U19GVUxMOworCisJZWxzZSBpZiAocF9mcy0+ZGV2X2VqZWN0ZWQpCisJCXJldCA9IEZGU19NRURJ
QUVSUjsKKworb3V0OgorCS8qIHJlbGVhc2UgdGhlIGxvY2sgZm9yIGZpbGUgc3lzdGVtIGNyaXRp
Y2FsIHNlY3Rpb24gKi8KKwl1cCgmcF9mcy0+dl9zZW0pOworCisJcmV0dXJuIHJldDsKK30KKwor
c3RhdGljIGludCBmZnNUcnVuY2F0ZUZpbGUoc3RydWN0IGlub2RlICppbm9kZSwgdTY0IG9sZF9z
aXplLCB1NjQgbmV3X3NpemUpCit7CisJczMyIG51bV9jbHVzdGVyczsKKwl1MzIgbGFzdF9jbHUg
PSBDTFVTVEVSXzMyKDApOworCWludCByZXQgPSAwOworCXNlY3Rvcl90IHNlY3RvciA9IDA7CisJ
c3RydWN0IGNoYWluX3QgY2x1OworCXN0cnVjdCB0aW1lc3RhbXBfdCB0bTsKKwlzdHJ1Y3QgZGVu
dHJ5X3QgKmVwLCAqZXAyOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsK
KwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0
cnVjdCBmaWxlX2lkX3QgKmZpZCA9ICYoRVhGQVRfSShpbm9kZSktPmZpZCk7CisJc3RydWN0IGVu
dHJ5X3NldF9jYWNoZV90ICplcyA9IE5VTEw7CisKKwlwcl9kZWJ1ZygiJXMgZW50ZXJlZCAoaW5v
ZGUgJXAgc2l6ZSAlbGx1KVxuIiwgX19mdW5jX18sIGlub2RlLAorCQkgbmV3X3NpemUpOworCisJ
LyogYWNxdWlyZSB0aGUgbG9jayBmb3IgZmlsZSBzeXN0ZW0gY3JpdGljYWwgc2VjdGlvbiAqLwor
CWRvd24oJnBfZnMtPnZfc2VtKTsKKworCS8qIGNoZWNrIGlmIHRoZSBnaXZlbiBmaWxlIElEIGlz
IG9wZW5lZCAqLworCWlmIChmaWQtPnR5cGUgIT0gVFlQRV9GSUxFKSB7CisJCXJldCA9IEZGU19Q
RVJNSVNTSU9ORVJSOworCQlnb3RvIG91dDsKKwl9CisKKwlpZiAoZmlkLT5zaXplICE9IG9sZF9z
aXplKSB7CisJCXByX2VycigiW0VYRkFUXSB0cnVuY2F0ZSA6IGNhbid0IHNraXAgaXQgYmVjYXVz
ZSBvZiBzaXplLW1pc21hdGNoKG9sZDolbGxkLT5maWQ6JWxsZCkuXG4iLAorCQkgICAgICAgb2xk
X3NpemUsIGZpZC0+c2l6ZSk7CisJfQorCisJaWYgKG9sZF9zaXplIDw9IG5ld19zaXplKSB7CisJ
CXJldCA9IEZGU19TVUNDRVNTOworCQlnb3RvIG91dDsKKwl9CisKKwlmc19zZXRfdm9sX2ZsYWdz
KHNiLCBWT0xfRElSVFkpOworCisJY2x1LmRpciA9IGZpZC0+c3RhcnRfY2x1OworCWNsdS5zaXpl
ID0gKHMzMikoKG9sZF9zaXplLTEpID4+IHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKSArIDE7CisJ
Y2x1LmZsYWdzID0gZmlkLT5mbGFnczsKKworCWlmIChuZXdfc2l6ZSA+IDApIHsKKwkJbnVtX2Ns
dXN0ZXJzID0gKHMzMikoKG5ld19zaXplLTEpID4+CisJCQkJICAgICBwX2ZzLT5jbHVzdGVyX3Np
emVfYml0cykgKyAxOworCisJCWlmIChjbHUuZmxhZ3MgPT0gMHgwMykgeworCQkJY2x1LmRpciAr
PSBudW1fY2x1c3RlcnM7CisJCX0gZWxzZSB7CisJCQl3aGlsZSAobnVtX2NsdXN0ZXJzID4gMCkg
eworCQkJCWxhc3RfY2x1ID0gY2x1LmRpcjsKKwkJCQlpZiAoRkFUX3JlYWQoc2IsIGNsdS5kaXIs
ICZjbHUuZGlyKSA9PSAtMSkKKwkJCQkJcmV0dXJuIEZGU19NRURJQUVSUjsKKwkJCQludW1fY2x1
c3RlcnMtLTsKKwkJCX0KKwkJfQorCisJCWNsdS5zaXplIC09IG51bV9jbHVzdGVyczsKKwl9CisK
KwlmaWQtPnNpemUgPSBuZXdfc2l6ZTsKKwlmaWQtPmF0dHIgfD0gQVRUUl9BUkNISVZFOworCWlm
IChuZXdfc2l6ZSA9PSAwKSB7CisJCWZpZC0+ZmxhZ3MgPSAocF9mcy0+dm9sX3R5cGUgPT0gRVhG
QVQpID8gMHgwMyA6IDB4MDE7CisJCWZpZC0+c3RhcnRfY2x1ID0gQ0xVU1RFUl8zMih+MCk7CisJ
fQorCisJLyogKDEpIHVwZGF0ZSB0aGUgZGlyZWN0b3J5IGVudHJ5ICovCisJaWYgKHBfZnMtPnZv
bF90eXBlID09IEVYRkFUKSB7CisJCWVzID0gZ2V0X2VudHJ5X3NldF9pbl9kaXIoc2IsICZmaWQt
PmRpciwgZmlkLT5lbnRyeSwKKwkJCQkJICBFU19BTExfRU5UUklFUywgJmVwKTsKKwkJaWYgKGVz
ID09IE5VTEwpIHsKKwkJCXJldCA9IEZGU19NRURJQUVSUjsKKwkJCWdvdG8gb3V0OworCQkJfQor
CQllcDIgPSBlcCsxOworCX0gZWxzZSB7CisJCWVwID0gZ2V0X2VudHJ5X2luX2RpcihzYiwgJihm
aWQtPmRpciksIGZpZC0+ZW50cnksICZzZWN0b3IpOworCQlpZiAoIWVwKSB7CisJCQlyZXQgPSBG
RlNfTUVESUFFUlI7CisJCQlnb3RvIG91dDsKKwkJfQorCQllcDIgPSBlcDsKKwl9CisKKwlwX2Zz
LT5mc19mdW5jLT5zZXRfZW50cnlfdGltZShlcCwgdG1fY3VycmVudCgmdG0pLCBUTV9NT0RJRlkp
OworCXBfZnMtPmZzX2Z1bmMtPnNldF9lbnRyeV9hdHRyKGVwLCBmaWQtPmF0dHIpOworCisJcF9m
cy0+ZnNfZnVuYy0+c2V0X2VudHJ5X3NpemUoZXAyLCBuZXdfc2l6ZSk7CisJaWYgKG5ld19zaXpl
ID09IDApIHsKKwkJcF9mcy0+ZnNfZnVuYy0+c2V0X2VudHJ5X2ZsYWcoZXAyLCAweDAxKTsKKwkJ
cF9mcy0+ZnNfZnVuYy0+c2V0X2VudHJ5X2NsdTAoZXAyLCBDTFVTVEVSXzMyKDApKTsKKwl9CisK
KwlpZiAocF9mcy0+dm9sX3R5cGUgIT0gRVhGQVQpCisJCWJ1Zl9tb2RpZnkoc2IsIHNlY3Rvcik7
CisJZWxzZSB7CisJCXVwZGF0ZV9kaXJfY2hlY2tzdW1fd2l0aF9lbnRyeV9zZXQoc2IsIGVzKTsK
KwkJcmVsZWFzZV9lbnRyeV9zZXQoZXMpOworCX0KKworCS8qICgyKSBjdXQgb2ZmIGZyb20gdGhl
IEZBVCBjaGFpbiAqLworCWlmIChsYXN0X2NsdSAhPSBDTFVTVEVSXzMyKDApKSB7CisJCWlmIChm
aWQtPmZsYWdzID09IDB4MDEpCisJCQlGQVRfd3JpdGUoc2IsIGxhc3RfY2x1LCBDTFVTVEVSXzMy
KH4wKSk7CisJfQorCisJLyogKDMpIGZyZWUgdGhlIGNsdXN0ZXJzICovCisJcF9mcy0+ZnNfZnVu
Yy0+ZnJlZV9jbHVzdGVyKHNiLCAmY2x1LCAwKTsKKworCS8qIGhpbnQgaW5mb3JtYXRpb24gKi8K
KwlmaWQtPmhpbnRfbGFzdF9vZmYgPSAtMTsKKwlpZiAoZmlkLT5yd29mZnNldCA+IGZpZC0+c2l6
ZSkKKwkJZmlkLT5yd29mZnNldCA9IGZpZC0+c2l6ZTsKKworI2lmZGVmIENPTkZJR19FWEZBVF9E
RUxBWUVEX1NZTkMKKwlmc19zeW5jKHNiLCBmYWxzZSk7CisJZnNfc2V0X3ZvbF9mbGFncyhzYiwg
Vk9MX0NMRUFOKTsKKyNlbmRpZgorCisJaWYgKHBfZnMtPmRldl9lamVjdGVkKQorCQlyZXQgPSBG
RlNfTUVESUFFUlI7CisKK291dDoKKwlwcl9kZWJ1ZygiJXMgZXhpdGVkICglZClcbiIsIF9fZnVu
Y19fLCByZXQpOworCS8qIHJlbGVhc2UgdGhlIGxvY2sgZm9yIGZpbGUgc3lzdGVtIGNyaXRpY2Fs
IHNlY3Rpb24gKi8KKwl1cCgmcF9mcy0+dl9zZW0pOworCisJcmV0dXJuIHJldDsKK30KKworc3Rh
dGljIHZvaWQgdXBkYXRlX3BhcmVudF9pbmZvKHN0cnVjdCBmaWxlX2lkX3QgKmZpZCwKKwkJCSAg
ICAgICBzdHJ1Y3QgaW5vZGUgKnBhcmVudF9pbm9kZSkKK3sKKwlzdHJ1Y3QgZnNfaW5mb190ICpw
X2ZzID0gJihFWEZBVF9TQihwYXJlbnRfaW5vZGUtPmlfc2IpLT5mc19pbmZvKTsKKwlzdHJ1Y3Qg
ZmlsZV9pZF90ICpwYXJlbnRfZmlkID0gJihFWEZBVF9JKHBhcmVudF9pbm9kZSktPmZpZCk7CisK
KwlpZiAodW5saWtlbHkoKHBhcmVudF9maWQtPmZsYWdzICE9IGZpZC0+ZGlyLmZsYWdzKSB8fAor
CQkgICAgIChwYXJlbnRfZmlkLT5zaXplICE9CisJCSAgICAgIChmaWQtPmRpci5zaXplIDw8IHBf
ZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKSkgfHwKKwkJICAgICAocGFyZW50X2ZpZC0+c3RhcnRfY2x1
ICE9IGZpZC0+ZGlyLmRpcikpKSB7CisJCWZpZC0+ZGlyLmRpciA9IHBhcmVudF9maWQtPnN0YXJ0
X2NsdTsKKwkJZmlkLT5kaXIuZmxhZ3MgPSBwYXJlbnRfZmlkLT5mbGFnczsKKwkJZmlkLT5kaXIu
c2l6ZSA9ICgocGFyZW50X2ZpZC0+c2l6ZSArIChwX2ZzLT5jbHVzdGVyX3NpemUtMSkpCisJCQkJ
CQk+PiBwX2ZzLT5jbHVzdGVyX3NpemVfYml0cyk7CisJfQorfQorCitzdGF0aWMgaW50IGZmc01v
dmVGaWxlKHN0cnVjdCBpbm9kZSAqb2xkX3BhcmVudF9pbm9kZSwgc3RydWN0IGZpbGVfaWRfdCAq
ZmlkLAorCQkgICAgICAgc3RydWN0IGlub2RlICpuZXdfcGFyZW50X2lub2RlLCBzdHJ1Y3QgZGVu
dHJ5ICpuZXdfZGVudHJ5KQoreworCXMzMiByZXQ7CisJczMyIGRlbnRyeTsKKwlzdHJ1Y3QgY2hh
aW5fdCBvbGRkaXIsIG5ld2RpcjsKKwlzdHJ1Y3QgY2hhaW5fdCAqcF9kaXIgPSBOVUxMOworCXN0
cnVjdCB1bmlfbmFtZV90IHVuaV9uYW1lOworCXN0cnVjdCBkZW50cnlfdCAqZXA7CisJc3RydWN0
IHN1cGVyX2Jsb2NrICpzYiA9IG9sZF9wYXJlbnRfaW5vZGUtPmlfc2I7CisJc3RydWN0IGZzX2lu
Zm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwl1OCAqbmV3X3BhdGggPSAo
dTggKikgbmV3X2RlbnRyeS0+ZF9uYW1lLm5hbWU7CisJc3RydWN0IGlub2RlICpuZXdfaW5vZGUg
PSBuZXdfZGVudHJ5LT5kX2lub2RlOworCWludCBudW1fZW50cmllczsKKwlzdHJ1Y3QgZmlsZV9p
ZF90ICpuZXdfZmlkID0gTlVMTDsKKwlzMzIgbmV3X2VudHJ5ID0gMDsKKworCS8qIGNoZWNrIHRo
ZSB2YWxpZGl0eSBvZiB0aGUgZ2l2ZW4gZmlsZSBpZCAqLworCWlmIChmaWQgPT0gTlVMTCkKKwkJ
cmV0dXJuIEZGU19JTlZBTElERklEOworCisJLyogY2hlY2sgdGhlIHZhbGlkaXR5IG9mIHBvaW50
ZXIgcGFyYW1ldGVycyAqLworCWlmICgobmV3X3BhdGggPT0gTlVMTCkgfHwgKCpuZXdfcGF0aCA9
PSAnXDAnKSkKKwkJcmV0dXJuIEZGU19FUlJPUjsKKworCS8qIGFjcXVpcmUgdGhlIGxvY2sgZm9y
IGZpbGUgc3lzdGVtIGNyaXRpY2FsIHNlY3Rpb24gKi8KKwlkb3duKCZwX2ZzLT52X3NlbSk7CisK
Kwl1cGRhdGVfcGFyZW50X2luZm8oZmlkLCBvbGRfcGFyZW50X2lub2RlKTsKKworCW9sZGRpci5k
aXIgPSBmaWQtPmRpci5kaXI7CisJb2xkZGlyLnNpemUgPSBmaWQtPmRpci5zaXplOworCW9sZGRp
ci5mbGFncyA9IGZpZC0+ZGlyLmZsYWdzOworCisJZGVudHJ5ID0gZmlkLT5lbnRyeTsKKworCS8q
IGNoZWNrIGlmIHRoZSBvbGQgZmlsZSBpcyAiLiIgb3IgIi4uIiAqLworCWlmIChwX2ZzLT52b2xf
dHlwZSAhPSBFWEZBVCkgeworCQlpZiAoKG9sZGRpci5kaXIgIT0gcF9mcy0+cm9vdF9kaXIpICYm
IChkZW50cnkgPCAyKSkgeworCQkJcmV0ID0gRkZTX1BFUk1JU1NJT05FUlI7CisJCQlnb3RvIG91
dDI7CisJCX0KKwl9CisKKwllcCA9IGdldF9lbnRyeV9pbl9kaXIoc2IsICZvbGRkaXIsIGRlbnRy
eSwgTlVMTCk7CisJaWYgKCFlcCkgeworCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJCWdvdG8gb3V0
MjsKKwl9CisKKwlpZiAocF9mcy0+ZnNfZnVuYy0+Z2V0X2VudHJ5X2F0dHIoZXApICYgQVRUUl9S
RUFET05MWSkgeworCQlyZXQgPSBGRlNfUEVSTUlTU0lPTkVSUjsKKwkJZ290byBvdXQyOworCX0K
KworCS8qIGNoZWNrIHdoZXRoZXIgbmV3IGRpciBpcyBleGlzdGluZyBkaXJlY3RvcnkgYW5kIGVt
cHR5ICovCisJaWYgKG5ld19pbm9kZSkgeworCQl1MzIgZW50cnlfdHlwZTsKKworCQlyZXQgPSBG
RlNfTUVESUFFUlI7CisJCW5ld19maWQgPSAmRVhGQVRfSShuZXdfaW5vZGUpLT5maWQ7CisKKwkJ
dXBkYXRlX3BhcmVudF9pbmZvKG5ld19maWQsIG5ld19wYXJlbnRfaW5vZGUpOworCisJCXBfZGly
ID0gJihuZXdfZmlkLT5kaXIpOworCQluZXdfZW50cnkgPSBuZXdfZmlkLT5lbnRyeTsKKwkJZXAg
PSBnZXRfZW50cnlfaW5fZGlyKHNiLCBwX2RpciwgbmV3X2VudHJ5LCBOVUxMKTsKKwkJaWYgKCFl
cCkKKwkJCWdvdG8gb3V0OworCisJCWVudHJ5X3R5cGUgPSBwX2ZzLT5mc19mdW5jLT5nZXRfZW50
cnlfdHlwZShlcCk7CisKKwkJaWYgKGVudHJ5X3R5cGUgPT0gVFlQRV9ESVIpIHsKKwkJCXN0cnVj
dCBjaGFpbl90IG5ld19jbHU7CisKKwkJCW5ld19jbHUuZGlyID0gbmV3X2ZpZC0+c3RhcnRfY2x1
OworCQkJbmV3X2NsdS5zaXplID0gKHMzMikoKG5ld19maWQtPnNpemUgLSAxKSA+PgorCQkJCQkg
ICAgIHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKSArIDE7CisJCQluZXdfY2x1LmZsYWdzID0gbmV3
X2ZpZC0+ZmxhZ3M7CisKKwkJCWlmICghaXNfZGlyX2VtcHR5KHNiLCAmbmV3X2NsdSkpIHsKKwkJ
CQlyZXQgPSBGRlNfRklMRUVYSVNUOworCQkJCWdvdG8gb3V0OworCQkJfQorCQl9CisJfQorCisJ
LyogY2hlY2sgdGhlIHZhbGlkaXR5IG9mIGRpcmVjdG9yeSBuYW1lIGluIHRoZSBnaXZlbiBuZXcg
cGF0aG5hbWUgKi8KKwlyZXQgPSByZXNvbHZlX3BhdGgobmV3X3BhcmVudF9pbm9kZSwgbmV3X3Bh
dGgsICZuZXdkaXIsICZ1bmlfbmFtZSk7CisJaWYgKHJldCkKKwkJZ290byBvdXQyOworCisJZnNf
c2V0X3ZvbF9mbGFncyhzYiwgVk9MX0RJUlRZKTsKKworCWlmIChvbGRkaXIuZGlyID09IG5ld2Rp
ci5kaXIpCisJCXJldCA9IHJlbmFtZV9maWxlKG5ld19wYXJlbnRfaW5vZGUsICZvbGRkaXIsIGRl
bnRyeSwgJnVuaV9uYW1lLAorCQkJCSAgZmlkKTsKKwllbHNlCisJCXJldCA9IG1vdmVfZmlsZShu
ZXdfcGFyZW50X2lub2RlLCAmb2xkZGlyLCBkZW50cnksICZuZXdkaXIsCisJCQkJJnVuaV9uYW1l
LCBmaWQpOworCisJaWYgKChyZXQgPT0gRkZTX1NVQ0NFU1MpICYmIG5ld19pbm9kZSkgeworCQkv
KiBkZWxldGUgZW50cmllcyBvZiBuZXdfZGlyICovCisJCWVwID0gZ2V0X2VudHJ5X2luX2Rpcihz
YiwgcF9kaXIsIG5ld19lbnRyeSwgTlVMTCk7CisJCWlmICghZXApCisJCQlnb3RvIG91dDsKKwor
CQludW1fZW50cmllcyA9IHBfZnMtPmZzX2Z1bmMtPmNvdW50X2V4dF9lbnRyaWVzKHNiLCBwX2Rp
ciwKKwkJCQkJCQkgICAgICAgbmV3X2VudHJ5LCBlcCk7CisJCWlmIChudW1fZW50cmllcyA8IDAp
CisJCQlnb3RvIG91dDsKKwkJcF9mcy0+ZnNfZnVuYy0+ZGVsZXRlX2Rpcl9lbnRyeShzYiwgcF9k
aXIsIG5ld19lbnRyeSwgMCwKKwkJCQkJCW51bV9lbnRyaWVzKzEpOworCX0KK291dDoKKyNpZmRl
ZiBDT05GSUdfRVhGQVRfREVMQVlFRF9TWU5DCisJZnNfc3luYyhzYiwgZmFsc2UpOworCWZzX3Nl
dF92b2xfZmxhZ3Moc2IsIFZPTF9DTEVBTik7CisjZW5kaWYKKworCWlmIChwX2ZzLT5kZXZfZWpl
Y3RlZCkKKwkJcmV0ID0gRkZTX01FRElBRVJSOworb3V0MjoKKwkvKiByZWxlYXNlIHRoZSBsb2Nr
IGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJdXAoJnBfZnMtPnZfc2VtKTsK
KworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgZmZzUmVtb3ZlRmlsZShzdHJ1Y3QgaW5v
ZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZV9pZF90ICpmaWQpCit7CisJczMyIGRlbnRyeTsKKwlpbnQg
cmV0ID0gRkZTX1NVQ0NFU1M7CisJc3RydWN0IGNoYWluX3QgZGlyLCBjbHVfdG9fZnJlZTsKKwlz
dHJ1Y3QgZGVudHJ5X3QgKmVwOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9z
YjsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOwor
CisJLyogY2hlY2sgdGhlIHZhbGlkaXR5IG9mIHRoZSBnaXZlbiBmaWxlIGlkICovCisJaWYgKGZp
ZCA9PSBOVUxMKQorCQlyZXR1cm4gRkZTX0lOVkFMSURGSUQ7CisKKwkvKiBhY3F1aXJlIHRoZSBs
b2NrIGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJZG93bigmcF9mcy0+dl9z
ZW0pOworCisJZGlyLmRpciA9IGZpZC0+ZGlyLmRpcjsKKwlkaXIuc2l6ZSA9IGZpZC0+ZGlyLnNp
emU7CisJZGlyLmZsYWdzID0gZmlkLT5kaXIuZmxhZ3M7CisKKwlkZW50cnkgPSBmaWQtPmVudHJ5
OworCisJZXAgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCAmZGlyLCBkZW50cnksIE5VTEwpOworCWlm
ICghZXApIHsKKwkJcmV0ID0gRkZTX01FRElBRVJSOworCQlnb3RvIG91dDsKKwl9CisKKwlpZiAo
cF9mcy0+ZnNfZnVuYy0+Z2V0X2VudHJ5X2F0dHIoZXApICYgQVRUUl9SRUFET05MWSkgeworCQly
ZXQgPSBGRlNfUEVSTUlTU0lPTkVSUjsKKwkJZ290byBvdXQ7CisJfQorCWZzX3NldF92b2xfZmxh
Z3Moc2IsIFZPTF9ESVJUWSk7CisKKwkvKiAoMSkgdXBkYXRlIHRoZSBkaXJlY3RvcnkgZW50cnkg
Ki8KKwlyZW1vdmVfZmlsZShpbm9kZSwgJmRpciwgZGVudHJ5KTsKKworCWNsdV90b19mcmVlLmRp
ciA9IGZpZC0+c3RhcnRfY2x1OworCWNsdV90b19mcmVlLnNpemUgPSAoczMyKSgoZmlkLT5zaXpl
LTEpID4+IHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKSArIDE7CisJY2x1X3RvX2ZyZWUuZmxhZ3Mg
PSBmaWQtPmZsYWdzOworCisJLyogKDIpIGZyZWUgdGhlIGNsdXN0ZXJzICovCisJcF9mcy0+ZnNf
ZnVuYy0+ZnJlZV9jbHVzdGVyKHNiLCAmY2x1X3RvX2ZyZWUsIDApOworCisJZmlkLT5zaXplID0g
MDsKKwlmaWQtPnN0YXJ0X2NsdSA9IENMVVNURVJfMzIofjApOworCWZpZC0+ZmxhZ3MgPSAocF9m
cy0+dm9sX3R5cGUgPT0gRVhGQVQpID8gMHgwMyA6IDB4MDE7CisKKyNpZmRlZiBDT05GSUdfRVhG
QVRfREVMQVlFRF9TWU5DCisJZnNfc3luYyhzYiwgZmFsc2UpOworCWZzX3NldF92b2xfZmxhZ3Mo
c2IsIFZPTF9DTEVBTik7CisjZW5kaWYKKworCWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJcmV0
ID0gRkZTX01FRElBRVJSOworb3V0OgorCS8qIHJlbGVhc2UgdGhlIGxvY2sgZm9yIGZpbGUgc3lz
dGVtIGNyaXRpY2FsIHNlY3Rpb24gKi8KKwl1cCgmcF9mcy0+dl9zZW0pOworCisJcmV0dXJuIHJl
dDsKK30KKworI2lmIDAKKy8qIE5vdCBjdXJyZW50bHkgd2lyZWQgdXAgKi8KK3N0YXRpYyBpbnQg
ZmZzU2V0QXR0cihzdHJ1Y3QgaW5vZGUgKmlub2RlLCB1MzIgYXR0cikKK3sKKwl1MzIgdHlwZTsK
KwlpbnQgcmV0ID0gRkZTX1NVQ0NFU1M7CisJc2VjdG9yX3Qgc2VjdG9yID0gMDsKKwlzdHJ1Y3Qg
ZGVudHJ5X3QgKmVwOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKKwlz
dHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCXN0cnVj
dCBmaWxlX2lkX3QgKmZpZCA9ICYoRVhGQVRfSShpbm9kZSktPmZpZCk7CisJdTggaXNfZGlyID0g
KGZpZC0+dHlwZSA9PSBUWVBFX0RJUikgPyAxIDogMDsKKwlzdHJ1Y3QgZW50cnlfc2V0X2NhY2hl
X3QgKmVzID0gTlVMTDsKKworCWlmIChmaWQtPmF0dHIgPT0gYXR0cikgeworCQlpZiAocF9mcy0+
ZGV2X2VqZWN0ZWQpCisJCQlyZXR1cm4gRkZTX01FRElBRVJSOworCQlyZXR1cm4gRkZTX1NVQ0NF
U1M7CisJfQorCisJaWYgKGlzX2RpcikgeworCQlpZiAoKGZpZC0+ZGlyLmRpciA9PSBwX2ZzLT5y
b290X2RpcikgJiYKKwkJICAgIChmaWQtPmVudHJ5ID09IC0xKSkgeworCQkJaWYgKHBfZnMtPmRl
dl9lamVjdGVkKQorCQkJCXJldHVybiBGRlNfTUVESUFFUlI7CisJCQlyZXR1cm4gRkZTX1NVQ0NF
U1M7CisJCX0KKwl9CisKKwkvKiBhY3F1aXJlIHRoZSBsb2NrIGZvciBmaWxlIHN5c3RlbSBjcml0
aWNhbCBzZWN0aW9uICovCisJZG93bigmcF9mcy0+dl9zZW0pOworCisJLyogZ2V0IHRoZSBkaXJl
Y3RvcnkgZW50cnkgb2YgZ2l2ZW4gZmlsZSAqLworCWlmIChwX2ZzLT52b2xfdHlwZSA9PSBFWEZB
VCkgeworCQllcyA9IGdldF9lbnRyeV9zZXRfaW5fZGlyKHNiLCAmKGZpZC0+ZGlyKSwgZmlkLT5l
bnRyeSwKKwkJCQkJICBFU19BTExfRU5UUklFUywgJmVwKTsKKwkJaWYgKGVzID09IE5VTEwpIHsK
KwkJCXJldCA9IEZGU19NRURJQUVSUjsKKwkJCWdvdG8gb3V0OworCQl9CisJfSBlbHNlIHsKKwkJ
ZXAgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCAmKGZpZC0+ZGlyKSwgZmlkLT5lbnRyeSwgJnNlY3Rv
cik7CisJCWlmICghZXApIHsKKwkJCXJldCA9IEZGU19NRURJQUVSUjsKKwkJCWdvdG8gb3V0Owor
CQl9CisJfQorCisJdHlwZSA9IHBfZnMtPmZzX2Z1bmMtPmdldF9lbnRyeV90eXBlKGVwKTsKKwor
CWlmICgoKHR5cGUgPT0gVFlQRV9GSUxFKSAmJiAoYXR0ciAmIEFUVFJfU1VCRElSKSkgfHwKKwkg
ICAgKCh0eXBlID09IFRZUEVfRElSKSAmJiAoIShhdHRyICYgQVRUUl9TVUJESVIpKSkpIHsKKwkJ
aWYgKHBfZnMtPmRldl9lamVjdGVkKQorCQkJcmV0ID0gRkZTX01FRElBRVJSOworCQllbHNlCisJ
CQlyZXQgPSBGRlNfRVJST1I7CisKKwkJaWYgKHBfZnMtPnZvbF90eXBlID09IEVYRkFUKQorCQkJ
cmVsZWFzZV9lbnRyeV9zZXQoZXMpOworCQlnb3RvIG91dDsKKwl9CisKKwlmc19zZXRfdm9sX2Zs
YWdzKHNiLCBWT0xfRElSVFkpOworCisJLyogc2V0IHRoZSBmaWxlIGF0dHJpYnV0ZSAqLworCWZp
ZC0+YXR0ciA9IGF0dHI7CisJcF9mcy0+ZnNfZnVuYy0+c2V0X2VudHJ5X2F0dHIoZXAsIGF0dHIp
OworCisJaWYgKHBfZnMtPnZvbF90eXBlICE9IEVYRkFUKQorCQlidWZfbW9kaWZ5KHNiLCBzZWN0
b3IpOworCWVsc2UgeworCQl1cGRhdGVfZGlyX2NoZWNrc3VtX3dpdGhfZW50cnlfc2V0KHNiLCBl
cyk7CisJCXJlbGVhc2VfZW50cnlfc2V0KGVzKTsKKwl9CisKKyNpZmRlZiBDT05GSUdfRVhGQVRf
REVMQVlFRF9TWU5DCisJZnNfc3luYyhzYiwgZmFsc2UpOworCWZzX3NldF92b2xfZmxhZ3Moc2Is
IFZPTF9DTEVBTik7CisjZW5kaWYKKworCWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJcmV0ID0g
RkZTX01FRElBRVJSOworb3V0OgorCS8qIHJlbGVhc2UgdGhlIGxvY2sgZm9yIGZpbGUgc3lzdGVt
IGNyaXRpY2FsIHNlY3Rpb24gKi8KKwl1cCgmcF9mcy0+dl9zZW0pOworCisJcmV0dXJuIHJldDsK
K30KKyNlbmRpZgorCitzdGF0aWMgaW50IGZmc1JlYWRTdGF0KHN0cnVjdCBpbm9kZSAqaW5vZGUs
IHN0cnVjdCBkaXJfZW50cnlfdCAqaW5mbykKK3sKKwlzZWN0b3JfdCBzZWN0b3IgPSAwOworCXMz
MiBjb3VudDsKKwlpbnQgcmV0ID0gRkZTX1NVQ0NFU1M7CisJc3RydWN0IGNoYWluX3QgZGlyOwor
CXN0cnVjdCB1bmlfbmFtZV90IHVuaV9uYW1lOworCXN0cnVjdCB0aW1lc3RhbXBfdCB0bTsKKwlz
dHJ1Y3QgZGVudHJ5X3QgKmVwLCAqZXAyOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9k
ZS0+aV9zYjsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2lu
Zm8pOworCXN0cnVjdCBmaWxlX2lkX3QgKmZpZCA9ICYoRVhGQVRfSShpbm9kZSktPmZpZCk7CisJ
c3RydWN0IGVudHJ5X3NldF9jYWNoZV90ICplcyA9IE5VTEw7CisJdTggaXNfZGlyID0gKGZpZC0+
dHlwZSA9PSBUWVBFX0RJUikgPyAxIDogMDsKKworCXByX2RlYnVnKCIlcyBlbnRlcmVkXG4iLCBf
X2Z1bmNfXyk7CisKKwkvKiBhY3F1aXJlIHRoZSBsb2NrIGZvciBmaWxlIHN5c3RlbSBjcml0aWNh
bCBzZWN0aW9uICovCisJZG93bigmcF9mcy0+dl9zZW0pOworCisJaWYgKGlzX2RpcikgeworCQlp
ZiAoKGZpZC0+ZGlyLmRpciA9PSBwX2ZzLT5yb290X2RpcikgJiYKKwkJICAgIChmaWQtPmVudHJ5
ID09IC0xKSkgeworCQkJaW5mby0+QXR0ciA9IEFUVFJfU1VCRElSOworCQkJbWVtc2V0KChjaGFy
ICopJmluZm8tPkNyZWF0ZVRpbWVzdGFtcCwgMCwKKwkJCSAgICAgICBzaXplb2Yoc3RydWN0IGRh
dGVfdGltZV90KSk7CisJCQltZW1zZXQoKGNoYXIgKikmaW5mby0+TW9kaWZ5VGltZXN0YW1wLCAw
LAorCQkJICAgICAgIHNpemVvZihzdHJ1Y3QgZGF0ZV90aW1lX3QpKTsKKwkJCW1lbXNldCgoY2hh
ciAqKSZpbmZvLT5BY2Nlc3NUaW1lc3RhbXAsIDAsCisJCQkgICAgICAgc2l6ZW9mKHN0cnVjdCBk
YXRlX3RpbWVfdCkpOworCQkJc3RyY3B5KGluZm8tPlNob3J0TmFtZSwgIi4iKTsKKwkJCXN0cmNw
eShpbmZvLT5OYW1lLCAiLiIpOworCisJCQlkaXIuZGlyID0gcF9mcy0+cm9vdF9kaXI7CisJCQlk
aXIuZmxhZ3MgPSAweDAxOworCisJCQlpZiAocF9mcy0+cm9vdF9kaXIgPT0gQ0xVU1RFUl8zMigw
KSkgeworCQkJCS8qIEZBVDE2IHJvb3RfZGlyICovCisJCQkJaW5mby0+U2l6ZSA9IHBfZnMtPmRl
bnRyaWVzX2luX3Jvb3QgPDwKKwkJCQkJCURFTlRSWV9TSVpFX0JJVFM7CisJCQl9IGVsc2Ugewor
CQkJCWluZm8tPlNpemUgPSBjb3VudF9udW1fY2x1c3RlcnMoc2IsICZkaXIpIDw8CisJCQkJCQlw
X2ZzLT5jbHVzdGVyX3NpemVfYml0czsKKwkJCX0KKworCQkJY291bnQgPSBjb3VudF9kb3NfbmFt
ZV9lbnRyaWVzKHNiLCAmZGlyLCBUWVBFX0RJUik7CisJCQlpZiAoY291bnQgPCAwKSB7CisJCQkJ
cmV0ID0gRkZTX01FRElBRVJSOworCQkJCWdvdG8gb3V0OworCQkJfQorCQkJaW5mby0+TnVtU3Vi
ZGlycyA9IGNvdW50OworCisJCQlpZiAocF9mcy0+ZGV2X2VqZWN0ZWQpCisJCQkJcmV0ID0gRkZT
X01FRElBRVJSOworCQkJZ290byBvdXQ7CisJCX0KKwl9CisKKwkvKiBnZXQgdGhlIGRpcmVjdG9y
eSBlbnRyeSBvZiBnaXZlbiBmaWxlIG9yIGRpcmVjdG9yeSAqLworCWlmIChwX2ZzLT52b2xfdHlw
ZSA9PSBFWEZBVCkgeworCQllcyA9IGdldF9lbnRyeV9zZXRfaW5fZGlyKHNiLCAmKGZpZC0+ZGly
KSwgZmlkLT5lbnRyeSwKKwkJCQkJICBFU18yX0VOVFJJRVMsICZlcCk7CisJCWlmIChlcyA9PSBO
VUxMKSB7CisJCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJCQlnb3RvIG91dDsKKwkJfQorCQllcDIg
PSBlcCsxOworCX0gZWxzZSB7CisJCWVwID0gZ2V0X2VudHJ5X2luX2RpcihzYiwgJihmaWQtPmRp
ciksIGZpZC0+ZW50cnksICZzZWN0b3IpOworCQlpZiAoIWVwKSB7CisJCQlyZXQgPSBGRlNfTUVE
SUFFUlI7CisJCQlnb3RvIG91dDsKKwkJfQorCQllcDIgPSBlcDsKKwkJYnVmX2xvY2soc2IsIHNl
Y3Rvcik7CisJfQorCisJLyogc2V0IEZJTEVfSU5GTyBzdHJ1Y3R1cmUgdXNpbmcgdGhlIGFjcXVp
cmVkIHN0cnVjdCBkZW50cnlfdCAqLworCWluZm8tPkF0dHIgPSBwX2ZzLT5mc19mdW5jLT5nZXRf
ZW50cnlfYXR0cihlcCk7CisKKwlwX2ZzLT5mc19mdW5jLT5nZXRfZW50cnlfdGltZShlcCwgJnRt
LCBUTV9DUkVBVEUpOworCWluZm8tPkNyZWF0ZVRpbWVzdGFtcC5ZZWFyID0gdG0ueWVhcjsKKwlp
bmZvLT5DcmVhdGVUaW1lc3RhbXAuTW9udGggPSB0bS5tb247CisJaW5mby0+Q3JlYXRlVGltZXN0
YW1wLkRheSA9IHRtLmRheTsKKwlpbmZvLT5DcmVhdGVUaW1lc3RhbXAuSG91ciA9IHRtLmhvdXI7
CisJaW5mby0+Q3JlYXRlVGltZXN0YW1wLk1pbnV0ZSA9IHRtLm1pbjsKKwlpbmZvLT5DcmVhdGVU
aW1lc3RhbXAuU2Vjb25kID0gdG0uc2VjOworCWluZm8tPkNyZWF0ZVRpbWVzdGFtcC5NaWxsaVNl
Y29uZCA9IDA7CisKKwlwX2ZzLT5mc19mdW5jLT5nZXRfZW50cnlfdGltZShlcCwgJnRtLCBUTV9N
T0RJRlkpOworCWluZm8tPk1vZGlmeVRpbWVzdGFtcC5ZZWFyID0gdG0ueWVhcjsKKwlpbmZvLT5N
b2RpZnlUaW1lc3RhbXAuTW9udGggPSB0bS5tb247CisJaW5mby0+TW9kaWZ5VGltZXN0YW1wLkRh
eSA9IHRtLmRheTsKKwlpbmZvLT5Nb2RpZnlUaW1lc3RhbXAuSG91ciA9IHRtLmhvdXI7CisJaW5m
by0+TW9kaWZ5VGltZXN0YW1wLk1pbnV0ZSA9IHRtLm1pbjsKKwlpbmZvLT5Nb2RpZnlUaW1lc3Rh
bXAuU2Vjb25kID0gdG0uc2VjOworCWluZm8tPk1vZGlmeVRpbWVzdGFtcC5NaWxsaVNlY29uZCA9
IDA7CisKKwltZW1zZXQoKGNoYXIgKikgJmluZm8tPkFjY2Vzc1RpbWVzdGFtcCwgMCwgc2l6ZW9m
KHN0cnVjdCBkYXRlX3RpbWVfdCkpOworCisJKih1bmlfbmFtZS5uYW1lKSA9IDB4MDsKKwkvKiBY
WFggdGhpcyBpcyB2ZXJ5IGJhZCBmb3IgZXhmYXQgY3V6IG5hbWUgaXMgYWxyZWFkeSBpbmNsdWRl
ZCBpbiBlcy4KKwkgKiBBUEkgc2hvdWxkIGJlIHJldmlzZWQKKwkgKi8KKwlwX2ZzLT5mc19mdW5j
LT5nZXRfdW5pX25hbWVfZnJvbV9leHRfZW50cnkoc2IsICYoZmlkLT5kaXIpLCBmaWQtPmVudHJ5
LAorCQkJCQkJICAgdW5pX25hbWUubmFtZSk7CisJaWYgKCp1bmlfbmFtZS5uYW1lID09IDB4MCAm
JiBwX2ZzLT52b2xfdHlwZSAhPSBFWEZBVCkKKwkJZ2V0X3VuaV9uYW1lX2Zyb21fZG9zX2VudHJ5
KHNiLCAoc3RydWN0IGRvc19kZW50cnlfdCAqKWVwLAorCQkJCQkgICAgJnVuaV9uYW1lLCAweDEp
OworCW5sc191bmluYW1lX3RvX2NzdHJpbmcoc2IsIGluZm8tPk5hbWUsICZ1bmlfbmFtZSk7CisK
KwlpZiAocF9mcy0+dm9sX3R5cGUgPT0gRVhGQVQpIHsKKwkJaW5mby0+TnVtU3ViZGlycyA9IDI7
CisJfSBlbHNlIHsKKwkJYnVmX3VubG9jayhzYiwgc2VjdG9yKTsKKwkJZ2V0X3VuaV9uYW1lX2Zy
b21fZG9zX2VudHJ5KHNiLCAoc3RydWN0IGRvc19kZW50cnlfdCAqKWVwLAorCQkJCQkgICAgJnVu
aV9uYW1lLCAweDApOworCQlubHNfdW5pbmFtZV90b19jc3RyaW5nKHNiLCBpbmZvLT5TaG9ydE5h
bWUsICZ1bmlfbmFtZSk7CisJCWluZm8tPk51bVN1YmRpcnMgPSAwOworCX0KKworCWluZm8tPlNp
emUgPSBwX2ZzLT5mc19mdW5jLT5nZXRfZW50cnlfc2l6ZShlcDIpOworCisJaWYgKHBfZnMtPnZv
bF90eXBlID09IEVYRkFUKQorCQlyZWxlYXNlX2VudHJ5X3NldChlcyk7CisKKwlpZiAoaXNfZGly
KSB7CisJCWRpci5kaXIgPSBmaWQtPnN0YXJ0X2NsdTsKKwkJZGlyLmZsYWdzID0gMHgwMTsKKwor
CQlpZiAoaW5mby0+U2l6ZSA9PSAwKQorCQkJaW5mby0+U2l6ZSA9ICh1NjQpY291bnRfbnVtX2Ns
dXN0ZXJzKHNiLCAmZGlyKSA8PAorCQkJCQlwX2ZzLT5jbHVzdGVyX3NpemVfYml0czsKKworCQlj
b3VudCA9IGNvdW50X2Rvc19uYW1lX2VudHJpZXMoc2IsICZkaXIsIFRZUEVfRElSKTsKKwkJaWYg
KGNvdW50IDwgMCkgeworCQkJcmV0ID0gRkZTX01FRElBRVJSOworCQkJZ290byBvdXQ7CisJCX0K
KwkJaW5mby0+TnVtU3ViZGlycyArPSBjb3VudDsKKwl9CisKKwlpZiAocF9mcy0+ZGV2X2VqZWN0
ZWQpCisJCXJldCA9IEZGU19NRURJQUVSUjsKKworb3V0OgorCS8qIHJlbGVhc2UgdGhlIGxvY2sg
Zm9yIGZpbGUgc3lzdGVtIGNyaXRpY2FsIHNlY3Rpb24gKi8KKwl1cCgmcF9mcy0+dl9zZW0pOwor
CisJcHJfZGVidWcoIiVzIGV4aXRlZCBzdWNjZXNzZnVsbHlcbiIsIF9fZnVuY19fKTsKKwlyZXR1
cm4gcmV0OworfQorCitzdGF0aWMgaW50IGZmc1dyaXRlU3RhdChzdHJ1Y3QgaW5vZGUgKmlub2Rl
LCBzdHJ1Y3QgZGlyX2VudHJ5X3QgKmluZm8pCit7CisJc2VjdG9yX3Qgc2VjdG9yID0gMDsKKwlp
bnQgcmV0ID0gRkZTX1NVQ0NFU1M7CisJc3RydWN0IHRpbWVzdGFtcF90IHRtOworCXN0cnVjdCBk
ZW50cnlfdCAqZXAsICplcDI7CisJc3RydWN0IGVudHJ5X3NldF9jYWNoZV90ICplcyA9IE5VTEw7
CisJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGlub2RlLT5pX3NiOworCXN0cnVjdCBmc19pbmZv
X3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisJc3RydWN0IGZpbGVfaWRfdCAq
ZmlkID0gJihFWEZBVF9JKGlub2RlKS0+ZmlkKTsKKwl1OCBpc19kaXIgPSAoZmlkLT50eXBlID09
IFRZUEVfRElSKSA/IDEgOiAwOworCisJcHJfZGVidWcoIiVzIGVudGVyZWQgKGlub2RlICVwIGlu
Zm8gJXBcbiIsIF9fZnVuY19fLCBpbm9kZSwgaW5mbyk7CisKKwkvKiBhY3F1aXJlIHRoZSBsb2Nr
IGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJZG93bigmcF9mcy0+dl9zZW0p
OworCisJaWYgKGlzX2RpcikgeworCQlpZiAoKGZpZC0+ZGlyLmRpciA9PSBwX2ZzLT5yb290X2Rp
cikgJiYKKwkJICAgIChmaWQtPmVudHJ5ID09IC0xKSkgeworCQkJaWYgKHBfZnMtPmRldl9lamVj
dGVkKQorCQkJCXJldCA9IEZGU19NRURJQUVSUjsKKwkJCXJldCA9IEZGU19TVUNDRVNTOworCQkJ
Z290byBvdXQ7CisJCX0KKwl9CisKKwlmc19zZXRfdm9sX2ZsYWdzKHNiLCBWT0xfRElSVFkpOwor
CisJLyogZ2V0IHRoZSBkaXJlY3RvcnkgZW50cnkgb2YgZ2l2ZW4gZmlsZSBvciBkaXJlY3Rvcnkg
Ki8KKwlpZiAocF9mcy0+dm9sX3R5cGUgPT0gRVhGQVQpIHsKKwkJZXMgPSBnZXRfZW50cnlfc2V0
X2luX2RpcihzYiwgJihmaWQtPmRpciksIGZpZC0+ZW50cnksCisJCQkJCSAgRVNfQUxMX0VOVFJJ
RVMsICZlcCk7CisJCWlmIChlcyA9PSBOVUxMKSB7CisJCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJ
CQlnb3RvIG91dDsKKwkJfQorCQllcDIgPSBlcCsxOworCX0gZWxzZSB7CisJCS8qIGZvciBvdGhl
ciB0aGFuIGV4ZmF0ICovCisJCWVwID0gZ2V0X2VudHJ5X2luX2RpcihzYiwgJihmaWQtPmRpciks
IGZpZC0+ZW50cnksICZzZWN0b3IpOworCQlpZiAoIWVwKSB7CisJCQlyZXQgPSBGRlNfTUVESUFF
UlI7CisJCQlnb3RvIG91dDsKKwkJfQorCQllcDIgPSBlcDsKKwl9CisKKwlwX2ZzLT5mc19mdW5j
LT5zZXRfZW50cnlfYXR0cihlcCwgaW5mby0+QXR0cik7CisKKwkvKiBzZXQgRklMRV9JTkZPIHN0
cnVjdHVyZSB1c2luZyB0aGUgYWNxdWlyZWQgc3RydWN0IGRlbnRyeV90ICovCisJdG0uc2VjICA9
IGluZm8tPkNyZWF0ZVRpbWVzdGFtcC5TZWNvbmQ7CisJdG0ubWluICA9IGluZm8tPkNyZWF0ZVRp
bWVzdGFtcC5NaW51dGU7CisJdG0uaG91ciA9IGluZm8tPkNyZWF0ZVRpbWVzdGFtcC5Ib3VyOwor
CXRtLmRheSAgPSBpbmZvLT5DcmVhdGVUaW1lc3RhbXAuRGF5OworCXRtLm1vbiAgPSBpbmZvLT5D
cmVhdGVUaW1lc3RhbXAuTW9udGg7CisJdG0ueWVhciA9IGluZm8tPkNyZWF0ZVRpbWVzdGFtcC5Z
ZWFyOworCXBfZnMtPmZzX2Z1bmMtPnNldF9lbnRyeV90aW1lKGVwLCAmdG0sIFRNX0NSRUFURSk7
CisKKwl0bS5zZWMgID0gaW5mby0+TW9kaWZ5VGltZXN0YW1wLlNlY29uZDsKKwl0bS5taW4gID0g
aW5mby0+TW9kaWZ5VGltZXN0YW1wLk1pbnV0ZTsKKwl0bS5ob3VyID0gaW5mby0+TW9kaWZ5VGlt
ZXN0YW1wLkhvdXI7CisJdG0uZGF5ICA9IGluZm8tPk1vZGlmeVRpbWVzdGFtcC5EYXk7CisJdG0u
bW9uICA9IGluZm8tPk1vZGlmeVRpbWVzdGFtcC5Nb250aDsKKwl0bS55ZWFyID0gaW5mby0+TW9k
aWZ5VGltZXN0YW1wLlllYXI7CisJcF9mcy0+ZnNfZnVuYy0+c2V0X2VudHJ5X3RpbWUoZXAsICZ0
bSwgVE1fTU9ESUZZKTsKKworCXBfZnMtPmZzX2Z1bmMtPnNldF9lbnRyeV9zaXplKGVwMiwgaW5m
by0+U2l6ZSk7CisKKwlpZiAocF9mcy0+dm9sX3R5cGUgIT0gRVhGQVQpIHsKKwkJYnVmX21vZGlm
eShzYiwgc2VjdG9yKTsKKwl9IGVsc2UgeworCQl1cGRhdGVfZGlyX2NoZWNrc3VtX3dpdGhfZW50
cnlfc2V0KHNiLCBlcyk7CisJCXJlbGVhc2VfZW50cnlfc2V0KGVzKTsKKwl9CisKKwlpZiAocF9m
cy0+ZGV2X2VqZWN0ZWQpCisJCXJldCA9IEZGU19NRURJQUVSUjsKKworb3V0OgorCS8qIHJlbGVh
c2UgdGhlIGxvY2sgZm9yIGZpbGUgc3lzdGVtIGNyaXRpY2FsIHNlY3Rpb24gKi8KKwl1cCgmcF9m
cy0+dl9zZW0pOworCisJcHJfZGVidWcoIiVzIGV4aXRlZCAoJWQpXG4iLCBfX2Z1bmNfXywgcmV0
KTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgZmZzTWFwQ2x1c3RlcihzdHJ1Y3Qg
aW5vZGUgKmlub2RlLCBzMzIgY2x1X29mZnNldCwgdTMyICpjbHUpCit7CisJczMyIG51bV9jbHVz
dGVycywgbnVtX2FsbG9jZWQsIG1vZGlmaWVkID0gRkFMU0U7CisJdTMyIGxhc3RfY2x1OworCWlu
dCByZXQgPSBGRlNfU1VDQ0VTUzsKKwlzZWN0b3JfdCBzZWN0b3IgPSAwOworCXN0cnVjdCBjaGFp
bl90IG5ld19jbHU7CisJc3RydWN0IGRlbnRyeV90ICplcDsKKwlzdHJ1Y3QgZW50cnlfc2V0X2Nh
Y2hlX3QgKmVzID0gTlVMTDsKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0gaW5vZGUtPmlfc2I7
CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlz
dHJ1Y3QgZmlsZV9pZF90ICpmaWQgPSAmKEVYRkFUX0koaW5vZGUpLT5maWQpOworCisJLyogY2hl
Y2sgdGhlIHZhbGlkaXR5IG9mIHBvaW50ZXIgcGFyYW1ldGVycyAqLworCWlmIChjbHUgPT0gTlVM
TCkKKwkJcmV0dXJuIEZGU19FUlJPUjsKKworCS8qIGFjcXVpcmUgdGhlIGxvY2sgZm9yIGZpbGUg
c3lzdGVtIGNyaXRpY2FsIHNlY3Rpb24gKi8KKwlkb3duKCZwX2ZzLT52X3NlbSk7CisKKwlmaWQt
PnJ3b2Zmc2V0ID0gKHM2NCkoY2x1X29mZnNldCkgPDwgcF9mcy0+Y2x1c3Rlcl9zaXplX2JpdHM7
CisKKwlpZiAoRVhGQVRfSShpbm9kZSktPm1tdV9wcml2YXRlID09IDApCisJCW51bV9jbHVzdGVy
cyA9IDA7CisJZWxzZQorCQludW1fY2x1c3RlcnMgPSAoczMyKSgoRVhGQVRfSShpbm9kZSktPm1t
dV9wcml2YXRlIC0gMSkgPj4KKwkJCQkgICAgIHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKSArIDE7
CisKKwkqY2x1ID0gbGFzdF9jbHUgPSBmaWQtPnN0YXJ0X2NsdTsKKworCWlmIChmaWQtPmZsYWdz
ID09IDB4MDMpIHsKKwkJaWYgKChjbHVfb2Zmc2V0ID4gMCkgJiYgKCpjbHUgIT0gQ0xVU1RFUl8z
Mih+MCkpKSB7CisJCQlsYXN0X2NsdSArPSBjbHVfb2Zmc2V0IC0gMTsKKworCQkJaWYgKGNsdV9v
ZmZzZXQgPT0gbnVtX2NsdXN0ZXJzKQorCQkJCSpjbHUgPSBDTFVTVEVSXzMyKH4wKTsKKwkJCWVs
c2UKKwkJCQkqY2x1ICs9IGNsdV9vZmZzZXQ7CisJCX0KKwl9IGVsc2UgeworCQkvKiBoaW50IGlu
Zm9ybWF0aW9uICovCisJCWlmICgoY2x1X29mZnNldCA+IDApICYmIChmaWQtPmhpbnRfbGFzdF9v
ZmYgPiAwKSAmJgorCQkgICAgKGNsdV9vZmZzZXQgPj0gZmlkLT5oaW50X2xhc3Rfb2ZmKSkgewor
CQkJY2x1X29mZnNldCAtPSBmaWQtPmhpbnRfbGFzdF9vZmY7CisJCQkqY2x1ID0gZmlkLT5oaW50
X2xhc3RfY2x1OworCQl9CisKKwkJd2hpbGUgKChjbHVfb2Zmc2V0ID4gMCkgJiYgKCpjbHUgIT0g
Q0xVU1RFUl8zMih+MCkpKSB7CisJCQlsYXN0X2NsdSA9ICpjbHU7CisJCQlpZiAoRkFUX3JlYWQo
c2IsICpjbHUsIGNsdSkgPT0gLTEpIHsKKwkJCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJCQkJZ290
byBvdXQ7CisJCQl9CisJCQljbHVfb2Zmc2V0LS07CisJCX0KKwl9CisKKwlpZiAoKmNsdSA9PSBD
TFVTVEVSXzMyKH4wKSkgeworCQlmc19zZXRfdm9sX2ZsYWdzKHNiLCBWT0xfRElSVFkpOworCisJ
CW5ld19jbHUuZGlyID0gKGxhc3RfY2x1ID09IENMVVNURVJfMzIofjApKSA/IENMVVNURVJfMzIo
fjApIDoKKwkJCQkJbGFzdF9jbHUgKyAxOworCQluZXdfY2x1LnNpemUgPSAwOworCQluZXdfY2x1
LmZsYWdzID0gZmlkLT5mbGFnczsKKworCQkvKiAoMSkgYWxsb2NhdGUgYSBjbHVzdGVyICovCisJ
CW51bV9hbGxvY2VkID0gcF9mcy0+ZnNfZnVuYy0+YWxsb2NfY2x1c3RlcihzYiwgMSwgJm5ld19j
bHUpOworCQlpZiAobnVtX2FsbG9jZWQgPCAwKSB7CisJCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJ
CQlnb3RvIG91dDsKKwkJfSBlbHNlIGlmIChudW1fYWxsb2NlZCA9PSAwKSB7CisJCQlyZXQgPSBG
RlNfRlVMTDsKKwkJCWdvdG8gb3V0OworCQl9CisKKwkJLyogKDIpIGFwcGVuZCB0byB0aGUgRkFU
IGNoYWluICovCisJCWlmIChsYXN0X2NsdSA9PSBDTFVTVEVSXzMyKH4wKSkgeworCQkJaWYgKG5l
d19jbHUuZmxhZ3MgPT0gMHgwMSkKKwkJCQlmaWQtPmZsYWdzID0gMHgwMTsKKwkJCWZpZC0+c3Rh
cnRfY2x1ID0gbmV3X2NsdS5kaXI7CisJCQltb2RpZmllZCA9IFRSVUU7CisJCX0gZWxzZSB7CisJ
CQlpZiAobmV3X2NsdS5mbGFncyAhPSBmaWQtPmZsYWdzKSB7CisJCQkJZXhmYXRfY2hhaW5fY29u
dF9jbHVzdGVyKHNiLCBmaWQtPnN0YXJ0X2NsdSwKKwkJCQkJCQkgbnVtX2NsdXN0ZXJzKTsKKwkJ
CQlmaWQtPmZsYWdzID0gMHgwMTsKKwkJCQltb2RpZmllZCA9IFRSVUU7CisJCQl9CisJCQlpZiAo
bmV3X2NsdS5mbGFncyA9PSAweDAxKQorCQkJCUZBVF93cml0ZShzYiwgbGFzdF9jbHUsIG5ld19j
bHUuZGlyKTsKKwkJfQorCisJCW51bV9jbHVzdGVycyArPSBudW1fYWxsb2NlZDsKKwkJKmNsdSA9
IG5ld19jbHUuZGlyOworCisJCWlmIChwX2ZzLT52b2xfdHlwZSA9PSBFWEZBVCkgeworCQkJZXMg
PSBnZXRfZW50cnlfc2V0X2luX2RpcihzYiwgJmZpZC0+ZGlyLCBmaWQtPmVudHJ5LAorCQkJCQkJ
ICBFU19BTExfRU5UUklFUywgJmVwKTsKKwkJCWlmIChlcyA9PSBOVUxMKSB7CisJCQkJcmV0ID0g
RkZTX01FRElBRVJSOworCQkJCWdvdG8gb3V0OworCQkJfQorCQkJLyogZ2V0IHN0cmVhbSBlbnRy
eSAqLworCQkJZXArKzsKKwkJfQorCisJCS8qICgzKSB1cGRhdGUgZGlyZWN0b3J5IGVudHJ5ICov
CisJCWlmIChtb2RpZmllZCkgeworCQkJaWYgKHBfZnMtPnZvbF90eXBlICE9IEVYRkFUKSB7CisJ
CQkJZXAgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCAmKGZpZC0+ZGlyKSwKKwkJCQkJCSAgICAgIGZp
ZC0+ZW50cnksICZzZWN0b3IpOworCQkJCWlmICghZXApIHsKKwkJCQkJcmV0ID0gRkZTX01FRElB
RVJSOworCQkJCQlnb3RvIG91dDsKKwkJCQl9CisJCQl9CisKKwkJCWlmIChwX2ZzLT5mc19mdW5j
LT5nZXRfZW50cnlfZmxhZyhlcCkgIT0gZmlkLT5mbGFncykKKwkJCQlwX2ZzLT5mc19mdW5jLT5z
ZXRfZW50cnlfZmxhZyhlcCwgZmlkLT5mbGFncyk7CisKKwkJCWlmIChwX2ZzLT5mc19mdW5jLT5n
ZXRfZW50cnlfY2x1MChlcCkgIT0gZmlkLT5zdGFydF9jbHUpCisJCQkJcF9mcy0+ZnNfZnVuYy0+
c2V0X2VudHJ5X2NsdTAoZXAsCisJCQkJCQkJICAgICAgZmlkLT5zdGFydF9jbHUpOworCisJCQlp
ZiAocF9mcy0+dm9sX3R5cGUgIT0gRVhGQVQpCisJCQkJYnVmX21vZGlmeShzYiwgc2VjdG9yKTsK
KwkJfQorCisJCWlmIChwX2ZzLT52b2xfdHlwZSA9PSBFWEZBVCkgeworCQkJdXBkYXRlX2Rpcl9j
aGVja3N1bV93aXRoX2VudHJ5X3NldChzYiwgZXMpOworCQkJcmVsZWFzZV9lbnRyeV9zZXQoZXMp
OworCQl9CisKKwkJLyogYWRkIG51bWJlciBvZiBuZXcgYmxvY2tzIHRvIGlub2RlICovCisJCWlu
b2RlLT5pX2Jsb2NrcyArPSBudW1fYWxsb2NlZCA8PCAocF9mcy0+Y2x1c3Rlcl9zaXplX2JpdHMg
LSA5KTsKKwl9CisKKwkvKiBoaW50IGluZm9ybWF0aW9uICovCisJZmlkLT5oaW50X2xhc3Rfb2Zm
ID0gKHMzMikoZmlkLT5yd29mZnNldCA+PiBwX2ZzLT5jbHVzdGVyX3NpemVfYml0cyk7CisJZmlk
LT5oaW50X2xhc3RfY2x1ID0gKmNsdTsKKworCWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJcmV0
ID0gRkZTX01FRElBRVJSOworCitvdXQ6CisJLyogcmVsZWFzZSB0aGUgbG9jayBmb3IgZmlsZSBz
eXN0ZW0gY3JpdGljYWwgc2VjdGlvbiAqLworCXVwKCZwX2ZzLT52X3NlbSk7CisKKwlyZXR1cm4g
cmV0OworfQorCisvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLworLyogIERpcmVjdG9yeSBPcGVyYXRpb24gRnVu
Y3Rpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KKy8qLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLSovCisKK3N0YXRpYyBpbnQgZmZzQ3JlYXRlRGlyKHN0cnVjdCBpbm9kZSAqaW5vZGUs
IGNoYXIgKnBhdGgsIHN0cnVjdCBmaWxlX2lkX3QgKmZpZCkKK3sKKwlpbnQgcmV0ID0gRkZTX1NV
Q0NFU1M7CisJc3RydWN0IGNoYWluX3QgZGlyOworCXN0cnVjdCB1bmlfbmFtZV90IHVuaV9uYW1l
OworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKKwlzdHJ1Y3QgZnNfaW5m
b190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZzX2luZm8pOworCisJcHJfZGVidWcoIiVzIGVu
dGVyZWRcbiIsIF9fZnVuY19fKTsKKworCS8qIGNoZWNrIHRoZSB2YWxpZGl0eSBvZiBwb2ludGVy
IHBhcmFtZXRlcnMgKi8KKwlpZiAoKGZpZCA9PSBOVUxMKSB8fCAocGF0aCA9PSBOVUxMKSB8fCAo
KnBhdGggPT0gJ1wwJykpCisJCXJldHVybiBGRlNfRVJST1I7CisKKwkvKiBhY3F1aXJlIHRoZSBs
b2NrIGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJZG93bigmcF9mcy0+dl9z
ZW0pOworCisJLyogY2hlY2sgdGhlIHZhbGlkaXR5IG9mIGRpcmVjdG9yeSBuYW1lIGluIHRoZSBn
aXZlbiBvbGQgcGF0aG5hbWUgKi8KKwlyZXQgPSByZXNvbHZlX3BhdGgoaW5vZGUsIHBhdGgsICZk
aXIsICZ1bmlfbmFtZSk7CisJaWYgKHJldCkKKwkJZ290byBvdXQ7CisKKwlmc19zZXRfdm9sX2Zs
YWdzKHNiLCBWT0xfRElSVFkpOworCisJcmV0ID0gY3JlYXRlX2Rpcihpbm9kZSwgJmRpciwgJnVu
aV9uYW1lLCBmaWQpOworCisjaWZkZWYgQ09ORklHX0VYRkFUX0RFTEFZRURfU1lOQworCWZzX3N5
bmMoc2IsIGZhbHNlKTsKKwlmc19zZXRfdm9sX2ZsYWdzKHNiLCBWT0xfQ0xFQU4pOworI2VuZGlm
CisKKwlpZiAocF9mcy0+ZGV2X2VqZWN0ZWQpCisJCXJldCA9IEZGU19NRURJQUVSUjsKK291dDoK
KwkvKiByZWxlYXNlIHRoZSBsb2NrIGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICov
CisJdXAoJnBfZnMtPnZfc2VtKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgZmZz
UmVhZERpcihzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZGlyX2VudHJ5X3QgKmRpcl9lbnRy
eSkKK3sKKwlpbnQgaSwgZGVudHJ5LCBjbHVfb2Zmc2V0OworCWludCByZXQgPSBGRlNfU1VDQ0VT
UzsKKwlzMzIgZGVudHJpZXNfcGVyX2NsdSwgZGVudHJpZXNfcGVyX2NsdV9iaXRzID0gMDsKKwl1
MzIgdHlwZTsKKwlzZWN0b3JfdCBzZWN0b3I7CisJc3RydWN0IGNoYWluX3QgZGlyLCBjbHU7CisJ
c3RydWN0IHVuaV9uYW1lX3QgdW5pX25hbWU7CisJc3RydWN0IHRpbWVzdGFtcF90IHRtOworCXN0
cnVjdCBkZW50cnlfdCAqZXA7CisJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGlub2RlLT5pX3Ni
OworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisJ
c3RydWN0IGZzX2Z1bmMgKmZzX2Z1bmMgPSBwX2ZzLT5mc19mdW5jOworCXN0cnVjdCBmaWxlX2lk
X3QgKmZpZCA9ICYoRVhGQVRfSShpbm9kZSktPmZpZCk7CisKKwkvKiBjaGVjayB0aGUgdmFsaWRp
dHkgb2YgcG9pbnRlciBwYXJhbWV0ZXJzICovCisJaWYgKGRpcl9lbnRyeSA9PSBOVUxMKQorCQly
ZXR1cm4gRkZTX0VSUk9SOworCisJLyogY2hlY2sgaWYgdGhlIGdpdmVuIGZpbGUgSUQgaXMgb3Bl
bmVkICovCisJaWYgKGZpZC0+dHlwZSAhPSBUWVBFX0RJUikKKwkJcmV0dXJuIEZGU19QRVJNSVNT
SU9ORVJSOworCisJLyogYWNxdWlyZSB0aGUgbG9jayBmb3IgZmlsZSBzeXN0ZW0gY3JpdGljYWwg
c2VjdGlvbiAqLworCWRvd24oJnBfZnMtPnZfc2VtKTsKKworCWlmIChmaWQtPmVudHJ5ID09IC0x
KSB7CisJCWRpci5kaXIgPSBwX2ZzLT5yb290X2RpcjsKKwkJZGlyLmZsYWdzID0gMHgwMTsKKwl9
IGVsc2UgeworCQlkaXIuZGlyID0gZmlkLT5zdGFydF9jbHU7CisJCWRpci5zaXplID0gKHMzMiko
ZmlkLT5zaXplID4+IHBfZnMtPmNsdXN0ZXJfc2l6ZV9iaXRzKTsKKwkJZGlyLmZsYWdzID0gZmlk
LT5mbGFnczsKKwl9CisKKwlkZW50cnkgPSAoczMyKWZpZC0+cndvZmZzZXQ7CisKKwlpZiAoZGly
LmRpciA9PSBDTFVTVEVSXzMyKDApKSB7CisJCS8qIEZBVDE2IHJvb3RfZGlyICovCisJCWRlbnRy
aWVzX3Blcl9jbHUgPSBwX2ZzLT5kZW50cmllc19pbl9yb290OworCisJCWlmIChkZW50cnkgPT0g
ZGVudHJpZXNfcGVyX2NsdSkgeworCQkJY2x1LmRpciA9IENMVVNURVJfMzIofjApOworCQl9IGVs
c2UgeworCQkJY2x1LmRpciA9IGRpci5kaXI7CisJCQljbHUuc2l6ZSA9IGRpci5zaXplOworCQkJ
Y2x1LmZsYWdzID0gZGlyLmZsYWdzOworCQl9CisJfSBlbHNlIHsKKwkJZGVudHJpZXNfcGVyX2Ns
dSA9IHBfZnMtPmRlbnRyaWVzX3Blcl9jbHU7CisJCWRlbnRyaWVzX3Blcl9jbHVfYml0cyA9IGls
b2cyKGRlbnRyaWVzX3Blcl9jbHUpOworCisJCWNsdV9vZmZzZXQgPSBkZW50cnkgPj4gZGVudHJp
ZXNfcGVyX2NsdV9iaXRzOworCQljbHUuZGlyID0gZGlyLmRpcjsKKwkJY2x1LnNpemUgPSBkaXIu
c2l6ZTsKKwkJY2x1LmZsYWdzID0gZGlyLmZsYWdzOworCisJCWlmIChjbHUuZmxhZ3MgPT0gMHgw
MykgeworCQkJY2x1LmRpciArPSBjbHVfb2Zmc2V0OworCQkJY2x1LnNpemUgLT0gY2x1X29mZnNl
dDsKKwkJfSBlbHNlIHsKKwkJCS8qIGhpbnRfaW5mb3JtYXRpb24gKi8KKwkJCWlmICgoY2x1X29m
ZnNldCA+IDApICYmIChmaWQtPmhpbnRfbGFzdF9vZmYgPiAwKSAmJgorCQkJICAgIChjbHVfb2Zm
c2V0ID49IGZpZC0+aGludF9sYXN0X29mZikpIHsKKwkJCQljbHVfb2Zmc2V0IC09IGZpZC0+aGlu
dF9sYXN0X29mZjsKKwkJCQljbHUuZGlyID0gZmlkLT5oaW50X2xhc3RfY2x1OworCQkJfQorCisJ
CQl3aGlsZSAoY2x1X29mZnNldCA+IDApIHsKKwkJCQkvKiBjbHUuZGlyID0gRkFUX3JlYWQoc2Is
IGNsdS5kaXIpOyAqLworCQkJCWlmIChGQVRfcmVhZChzYiwgY2x1LmRpciwgJmNsdS5kaXIpID09
IC0xKSB7CisJCQkJCXJldCA9IEZGU19NRURJQUVSUjsKKwkJCQkJZ290byBvdXQ7CisJCQkJfQor
CQkJCWNsdV9vZmZzZXQtLTsKKwkJCX0KKwkJfQorCX0KKworCXdoaWxlIChjbHUuZGlyICE9IENM
VVNURVJfMzIofjApKSB7CisJCWlmIChwX2ZzLT5kZXZfZWplY3RlZCkKKwkJCWJyZWFrOworCisJ
CWlmIChkaXIuZGlyID09IENMVVNURVJfMzIoMCkpIC8qIEZBVDE2IHJvb3RfZGlyICovCisJCQlp
ID0gZGVudHJ5ICUgZGVudHJpZXNfcGVyX2NsdTsKKwkJZWxzZQorCQkJaSA9IGRlbnRyeSAmIChk
ZW50cmllc19wZXJfY2x1LTEpOworCisJCWZvciAoIDsgaSA8IGRlbnRyaWVzX3Blcl9jbHU7IGkr
KywgZGVudHJ5KyspIHsKKwkJCWVwID0gZ2V0X2VudHJ5X2luX2RpcihzYiwgJmNsdSwgaSwgJnNl
Y3Rvcik7CisJCQlpZiAoIWVwKSB7CisJCQkJcmV0ID0gRkZTX01FRElBRVJSOworCQkJCWdvdG8g
b3V0OworCQkJfQorCQkJdHlwZSA9IGZzX2Z1bmMtPmdldF9lbnRyeV90eXBlKGVwKTsKKworCQkJ
aWYgKHR5cGUgPT0gVFlQRV9VTlVTRUQpCisJCQkJYnJlYWs7CisKKwkJCWlmICgodHlwZSAhPSBU
WVBFX0ZJTEUpICYmICh0eXBlICE9IFRZUEVfRElSKSkKKwkJCQljb250aW51ZTsKKworCQkJYnVm
X2xvY2soc2IsIHNlY3Rvcik7CisJCQlkaXJfZW50cnktPkF0dHIgPSBmc19mdW5jLT5nZXRfZW50
cnlfYXR0cihlcCk7CisKKwkJCWZzX2Z1bmMtPmdldF9lbnRyeV90aW1lKGVwLCAmdG0sIFRNX0NS
RUFURSk7CisJCQlkaXJfZW50cnktPkNyZWF0ZVRpbWVzdGFtcC5ZZWFyID0gdG0ueWVhcjsKKwkJ
CWRpcl9lbnRyeS0+Q3JlYXRlVGltZXN0YW1wLk1vbnRoID0gdG0ubW9uOworCQkJZGlyX2VudHJ5
LT5DcmVhdGVUaW1lc3RhbXAuRGF5ID0gdG0uZGF5OworCQkJZGlyX2VudHJ5LT5DcmVhdGVUaW1l
c3RhbXAuSG91ciA9IHRtLmhvdXI7CisJCQlkaXJfZW50cnktPkNyZWF0ZVRpbWVzdGFtcC5NaW51
dGUgPSB0bS5taW47CisJCQlkaXJfZW50cnktPkNyZWF0ZVRpbWVzdGFtcC5TZWNvbmQgPSB0bS5z
ZWM7CisJCQlkaXJfZW50cnktPkNyZWF0ZVRpbWVzdGFtcC5NaWxsaVNlY29uZCA9IDA7CisKKwkJ
CWZzX2Z1bmMtPmdldF9lbnRyeV90aW1lKGVwLCAmdG0sIFRNX01PRElGWSk7CisJCQlkaXJfZW50
cnktPk1vZGlmeVRpbWVzdGFtcC5ZZWFyID0gdG0ueWVhcjsKKwkJCWRpcl9lbnRyeS0+TW9kaWZ5
VGltZXN0YW1wLk1vbnRoID0gdG0ubW9uOworCQkJZGlyX2VudHJ5LT5Nb2RpZnlUaW1lc3RhbXAu
RGF5ID0gdG0uZGF5OworCQkJZGlyX2VudHJ5LT5Nb2RpZnlUaW1lc3RhbXAuSG91ciA9IHRtLmhv
dXI7CisJCQlkaXJfZW50cnktPk1vZGlmeVRpbWVzdGFtcC5NaW51dGUgPSB0bS5taW47CisJCQlk
aXJfZW50cnktPk1vZGlmeVRpbWVzdGFtcC5TZWNvbmQgPSB0bS5zZWM7CisJCQlkaXJfZW50cnkt
Pk1vZGlmeVRpbWVzdGFtcC5NaWxsaVNlY29uZCA9IDA7CisKKwkJCW1lbXNldCgoY2hhciAqKSZk
aXJfZW50cnktPkFjY2Vzc1RpbWVzdGFtcCwgMCwKKwkJCSAgICAgICBzaXplb2Yoc3RydWN0IGRh
dGVfdGltZV90KSk7CisKKwkJCSoodW5pX25hbWUubmFtZSkgPSAweDA7CisJCQlmc19mdW5jLT5n
ZXRfdW5pX25hbWVfZnJvbV9leHRfZW50cnkoc2IsICZkaXIsIGRlbnRyeSwKKwkJCQkJCQkgICAg
IHVuaV9uYW1lLm5hbWUpOworCQkJaWYgKCp1bmlfbmFtZS5uYW1lID09IDB4MCAmJiBwX2ZzLT52
b2xfdHlwZSAhPSBFWEZBVCkKKwkJCQlnZXRfdW5pX25hbWVfZnJvbV9kb3NfZW50cnkoc2IsCisJ
CQkJCQkoc3RydWN0IGRvc19kZW50cnlfdCAqKWVwLAorCQkJCQkJJnVuaV9uYW1lLCAweDEpOwor
CQkJbmxzX3VuaW5hbWVfdG9fY3N0cmluZyhzYiwgZGlyX2VudHJ5LT5OYW1lLCAmdW5pX25hbWUp
OworCQkJYnVmX3VubG9jayhzYiwgc2VjdG9yKTsKKworCQkJaWYgKHBfZnMtPnZvbF90eXBlID09
IEVYRkFUKSB7CisJCQkJZXAgPSBnZXRfZW50cnlfaW5fZGlyKHNiLCAmY2x1LCBpKzEsIE5VTEwp
OworCQkJCWlmICghZXApIHsKKwkJCQkJcmV0ID0gRkZTX01FRElBRVJSOworCQkJCQlnb3RvIG91
dDsKKwkJCQl9CisJCQl9IGVsc2UgeworCQkJCWdldF91bmlfbmFtZV9mcm9tX2Rvc19lbnRyeShz
YiwKKwkJCQkJCShzdHJ1Y3QgZG9zX2RlbnRyeV90ICopZXAsCisJCQkJCQkmdW5pX25hbWUsIDB4
MCk7CisJCQkJbmxzX3VuaW5hbWVfdG9fY3N0cmluZyhzYiwgZGlyX2VudHJ5LT5TaG9ydE5hbWUs
CisJCQkJCQkgICAgICAgJnVuaV9uYW1lKTsKKwkJCX0KKworCQkJZGlyX2VudHJ5LT5TaXplID0g
ZnNfZnVuYy0+Z2V0X2VudHJ5X3NpemUoZXApOworCisJCQkvKiBoaW50IGluZm9ybWF0aW9uICov
CisJCQlpZiAoZGlyLmRpciA9PSBDTFVTVEVSXzMyKDApKSB7IC8qIEZBVDE2IHJvb3RfZGlyICov
CisJCQl9IGVsc2UgeworCQkJCWZpZC0+aGludF9sYXN0X29mZiA9IGRlbnRyeSA+PgorCQkJCQkJ
CWRlbnRyaWVzX3Blcl9jbHVfYml0czsKKwkJCQlmaWQtPmhpbnRfbGFzdF9jbHUgPSBjbHUuZGly
OworCQkJfQorCisJCQlmaWQtPnJ3b2Zmc2V0ID0gKHM2NCkgKytkZW50cnk7CisKKwkJCWlmIChw
X2ZzLT5kZXZfZWplY3RlZCkKKwkJCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJCQlnb3RvIG91dDsK
KwkJfQorCisJCWlmIChkaXIuZGlyID09IENMVVNURVJfMzIoMCkpCisJCQlicmVhazsgLyogRkFU
MTYgcm9vdF9kaXIgKi8KKworCQlpZiAoY2x1LmZsYWdzID09IDB4MDMpIHsKKwkJCWlmICgoLS1j
bHUuc2l6ZSkgPiAwKQorCQkJCWNsdS5kaXIrKzsKKwkJCWVsc2UKKwkJCQljbHUuZGlyID0gQ0xV
U1RFUl8zMih+MCk7CisJCX0gZWxzZSB7CisJCQkvKiBjbHUuZGlyID0gRkFUX3JlYWQoc2IsIGNs
dS5kaXIpOyAqLworCQkJaWYgKEZBVF9yZWFkKHNiLCBjbHUuZGlyLCAmY2x1LmRpcikgPT0gLTEp
IHsKKwkJCQlyZXQgPSBGRlNfTUVESUFFUlI7CisJCQkJZ290byBvdXQ7CisJCQl9CisJCX0KKwl9
CisKKwkqKGRpcl9lbnRyeS0+TmFtZSkgPSAnXDAnOworCisJZmlkLT5yd29mZnNldCA9IChzNjQp
ICsrZGVudHJ5OworCisJaWYgKHBfZnMtPmRldl9lamVjdGVkKQorCQlyZXQgPSBGRlNfTUVESUFF
UlI7CisKK291dDoKKwkvKiByZWxlYXNlIHRoZSBsb2NrIGZvciBmaWxlIHN5c3RlbSBjcml0aWNh
bCBzZWN0aW9uICovCisJdXAoJnBfZnMtPnZfc2VtKTsKKworCXJldHVybiByZXQ7Cit9CisKK3N0
YXRpYyBpbnQgZmZzUmVtb3ZlRGlyKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0cnVjdCBmaWxlX2lk
X3QgKmZpZCkKK3sKKwlzMzIgZGVudHJ5OworCWludCByZXQgPSBGRlNfU1VDQ0VTUzsKKwlzdHJ1
Y3QgY2hhaW5fdCBkaXIsIGNsdV90b19mcmVlOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBp
bm9kZS0+aV9zYjsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihFWEZBVF9TQihzYiktPmZz
X2luZm8pOworCisJLyogY2hlY2sgdGhlIHZhbGlkaXR5IG9mIHRoZSBnaXZlbiBmaWxlIGlkICov
CisJaWYgKGZpZCA9PSBOVUxMKQorCQlyZXR1cm4gRkZTX0lOVkFMSURGSUQ7CisKKwlkaXIuZGly
ID0gZmlkLT5kaXIuZGlyOworCWRpci5zaXplID0gZmlkLT5kaXIuc2l6ZTsKKwlkaXIuZmxhZ3Mg
PSBmaWQtPmRpci5mbGFnczsKKworCWRlbnRyeSA9IGZpZC0+ZW50cnk7CisKKwkvKiBjaGVjayBp
ZiB0aGUgZmlsZSBpcyAiLiIgb3IgIi4uIiAqLworCWlmIChwX2ZzLT52b2xfdHlwZSAhPSBFWEZB
VCkgeworCQlpZiAoKGRpci5kaXIgIT0gcF9mcy0+cm9vdF9kaXIpICYmIChkZW50cnkgPCAyKSkK
KwkJCXJldHVybiBGRlNfUEVSTUlTU0lPTkVSUjsKKwl9CisKKwkvKiBhY3F1aXJlIHRoZSBsb2Nr
IGZvciBmaWxlIHN5c3RlbSBjcml0aWNhbCBzZWN0aW9uICovCisJZG93bigmcF9mcy0+dl9zZW0p
OworCisJY2x1X3RvX2ZyZWUuZGlyID0gZmlkLT5zdGFydF9jbHU7CisJY2x1X3RvX2ZyZWUuc2l6
ZSA9IChzMzIpKChmaWQtPnNpemUtMSkgPj4gcF9mcy0+Y2x1c3Rlcl9zaXplX2JpdHMpICsgMTsK
KwljbHVfdG9fZnJlZS5mbGFncyA9IGZpZC0+ZmxhZ3M7CisKKwlpZiAoIWlzX2Rpcl9lbXB0eShz
YiwgJmNsdV90b19mcmVlKSkgeworCQlyZXQgPSBGRlNfRklMRUVYSVNUOworCQlnb3RvIG91dDsK
Kwl9CisKKwlmc19zZXRfdm9sX2ZsYWdzKHNiLCBWT0xfRElSVFkpOworCisJLyogKDEpIHVwZGF0
ZSB0aGUgZGlyZWN0b3J5IGVudHJ5ICovCisJcmVtb3ZlX2ZpbGUoaW5vZGUsICZkaXIsIGRlbnRy
eSk7CisKKwkvKiAoMikgZnJlZSB0aGUgY2x1c3RlcnMgKi8KKwlwX2ZzLT5mc19mdW5jLT5mcmVl
X2NsdXN0ZXIoc2IsICZjbHVfdG9fZnJlZSwgMSk7CisKKwlmaWQtPnNpemUgPSAwOworCWZpZC0+
c3RhcnRfY2x1ID0gQ0xVU1RFUl8zMih+MCk7CisJZmlkLT5mbGFncyA9IChwX2ZzLT52b2xfdHlw
ZSA9PSBFWEZBVCkgPyAweDAzIDogMHgwMTsKKworI2lmZGVmIENPTkZJR19FWEZBVF9ERUxBWUVE
X1NZTkMKKwlmc19zeW5jKHNiLCBmYWxzZSk7CisJZnNfc2V0X3ZvbF9mbGFncyhzYiwgVk9MX0NM
RUFOKTsKKyNlbmRpZgorCisJaWYgKHBfZnMtPmRldl9lamVjdGVkKQorCQlyZXQgPSBGRlNfTUVE
SUFFUlI7CisKK291dDoKKwkvKiByZWxlYXNlIHRoZSBsb2NrIGZvciBmaWxlIHN5c3RlbSBjcml0
aWNhbCBzZWN0aW9uICovCisJdXAoJnBfZnMtPnZfc2VtKTsKKworCXJldHVybiByZXQ7Cit9CisK
Ky8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PSovCisvKiAgRGlyZWN0b3J5IEVudHJ5IE9wZXJhdGlvbnMgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLworLyo9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8K
Kworc3RhdGljIGludCBleGZhdF9yZWFkZGlyKHN0cnVjdCBmaWxlICpmaWxwLCBzdHJ1Y3QgZGly
X2NvbnRleHQgKmN0eCkKK3sKKwlzdHJ1Y3QgaW5vZGUgKmlub2RlID0gZmlsZV9pbm9kZShmaWxw
KTsKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0gaW5vZGUtPmlfc2I7CisJc3RydWN0IGV4ZmF0
X3NiX2luZm8gKnNiaSA9IEVYRkFUX1NCKHNiKTsKKwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0g
JihzYmktPmZzX2luZm8pOworCXN0cnVjdCBiZF9pbmZvX3QgKnBfYmQgPSAmKEVYRkFUX1NCKHNi
KS0+YmRfaW5mbyk7CisJc3RydWN0IGRpcl9lbnRyeV90IGRlOworCXVuc2lnbmVkIGxvbmcgaW51
bTsKKwlsb2ZmX3QgY3BvczsKKwlpbnQgZXJyID0gMDsKKworCV9fbG9ja19zdXBlcihzYik7CisK
KwljcG9zID0gY3R4LT5wb3M7CisJLyogRmFrZSAuIGFuZCAuLiBmb3IgdGhlIHJvb3QgZGlyZWN0
b3J5LiAqLworCWlmICgocF9mcy0+dm9sX3R5cGUgPT0gRVhGQVQpIHx8IChpbm9kZS0+aV9pbm8g
PT0gRVhGQVRfUk9PVF9JTk8pKSB7CisJCXdoaWxlIChjcG9zIDwgMikgeworCQkJaWYgKGlub2Rl
LT5pX2lubyA9PSBFWEZBVF9ST09UX0lOTykKKwkJCQlpbnVtID0gRVhGQVRfUk9PVF9JTk87CisJ
CQllbHNlIGlmIChjcG9zID09IDApCisJCQkJaW51bSA9IGlub2RlLT5pX2lubzsKKwkJCWVsc2Ug
LyogKGNwb3MgPT0gMSkgKi8KKwkJCQlpbnVtID0gcGFyZW50X2lubyhmaWxwLT5mX3BhdGguZGVu
dHJ5KTsKKworCQkJaWYgKCFkaXJfZW1pdF9kb3RzKGZpbHAsIGN0eCkpCisJCQkJZ290byBvdXQ7
CisJCQljcG9zKys7CisJCQljdHgtPnBvcysrOworCQl9CisJCWlmIChjcG9zID09IDIpCisJCQlj
cG9zID0gMDsKKwl9CisJaWYgKGNwb3MgJiAoREVOVFJZX1NJWkUgLSAxKSkgeworCQllcnIgPSAt
RU5PRU5UOworCQlnb3RvIG91dDsKKwl9CisKK2dldF9uZXc6CisJRVhGQVRfSShpbm9kZSktPmZp
ZC5zaXplID0gaV9zaXplX3JlYWQoaW5vZGUpOworCUVYRkFUX0koaW5vZGUpLT5maWQucndvZmZz
ZXQgPSBjcG9zID4+IERFTlRSWV9TSVpFX0JJVFM7CisKKwllcnIgPSBmZnNSZWFkRGlyKGlub2Rl
LCAmZGUpOworCWlmIChlcnIpIHsKKwkJLyogYXQgbGVhc3Qgd2UgdHJpZWQgdG8gcmVhZCBhIHNl
Y3RvcgorCQkgKiBtb3ZlIGNwb3MgdG8gbmV4dCBzZWN0b3IgcG9zaXRpb24gKHNob3VsZCBiZSBh
bGlnbmVkKQorCQkgKi8KKwkJaWYgKGVyciA9PSBGRlNfTUVESUFFUlIpIHsKKwkJCWNwb3MgKz0g
MSA8PCBwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzOworCQkJY3BvcyAmPSB+KCgxIDw8IHBfYmQtPnNl
Y3Rvcl9zaXplX2JpdHMpLTEpOworCQl9CisKKwkJZXJyID0gLUVJTzsKKwkJZ290byBlbmRfb2Zf
ZGlyOworCX0KKworCWNwb3MgPSBFWEZBVF9JKGlub2RlKS0+ZmlkLnJ3b2Zmc2V0IDw8IERFTlRS
WV9TSVpFX0JJVFM7CisKKwlpZiAoIWRlLk5hbWVbMF0pCisJCWdvdG8gZW5kX29mX2RpcjsKKwor
CWlmICghbWVtY21wKGRlLlNob3J0TmFtZSwgRE9TX0NVUl9ESVJfTkFNRSwgRE9TX05BTUVfTEVO
R1RIKSkgeworCQlpbnVtID0gaW5vZGUtPmlfaW5vOworCX0gZWxzZSBpZiAoIW1lbWNtcChkZS5T
aG9ydE5hbWUsIERPU19QQVJfRElSX05BTUUsIERPU19OQU1FX0xFTkdUSCkpIHsKKwkJaW51bSA9
IHBhcmVudF9pbm8oZmlscC0+Zl9wYXRoLmRlbnRyeSk7CisJfSBlbHNlIHsKKwkJbG9mZl90IGlf
cG9zID0gKChsb2ZmX3QpIEVYRkFUX0koaW5vZGUpLT5maWQuc3RhcnRfY2x1IDw8IDMyKSB8CisJ
CQkJKChFWEZBVF9JKGlub2RlKS0+ZmlkLnJ3b2Zmc2V0LTEpICYgMHhmZmZmZmZmZik7CisJCXN0
cnVjdCBpbm9kZSAqdG1wID0gZXhmYXRfaWdldChzYiwgaV9wb3MpOworCisJCWlmICh0bXApIHsK
KwkJCWludW0gPSB0bXAtPmlfaW5vOworCQkJaXB1dCh0bXApOworCQl9IGVsc2UgeworCQkJaW51
bSA9IGl1bmlxdWUoc2IsIEVYRkFUX1JPT1RfSU5PKTsKKwkJfQorCX0KKworCWlmICghZGlyX2Vt
aXQoY3R4LCBkZS5OYW1lLCBzdHJsZW4oZGUuTmFtZSksIGludW0sCisJCSAgICAgIChkZS5BdHRy
ICYgQVRUUl9TVUJESVIpID8gRFRfRElSIDogRFRfUkVHKSkKKwkJZ290byBvdXQ7CisKKwljdHgt
PnBvcyA9IGNwb3M7CisJZ290byBnZXRfbmV3OworCitlbmRfb2ZfZGlyOgorCWN0eC0+cG9zID0g
Y3BvczsKK291dDoKKwlfX3VubG9ja19zdXBlcihzYik7CisJcmV0dXJuIGVycjsKK30KKworc3Rh
dGljIGludCBleGZhdF9pb2N0bF92b2x1bWVfaWQoc3RydWN0IGlub2RlICpkaXIpCit7CisJc3Ry
dWN0IHN1cGVyX2Jsb2NrICpzYiA9IGRpci0+aV9zYjsKKwlzdHJ1Y3QgZXhmYXRfc2JfaW5mbyAq
c2JpID0gRVhGQVRfU0Ioc2IpOworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKHNiaS0+ZnNf
aW5mbyk7CisKKwlyZXR1cm4gcF9mcy0+dm9sX2lkOworfQorCitzdGF0aWMgbG9uZyBleGZhdF9n
ZW5lcmljX2lvY3RsKHN0cnVjdCBmaWxlICpmaWxwLCB1bnNpZ25lZCBpbnQgY21kLAorCQkJCXVu
c2lnbmVkIGxvbmcgYXJnKQoreworc3RydWN0IGlub2RlICppbm9kZSA9IGZpbHAtPmZfcGF0aC5k
ZW50cnktPmRfaW5vZGU7CisjaWZkZWYgQ09ORklHX0VYRkFUX0tFUk5FTF9ERUJVRworCXVuc2ln
bmVkIGludCBmbGFnczsKKyNlbmRpZiAvKiBDT05GSUdfRVhGQVRfS0VSTkVMX0RFQlVHICovCisK
Kwlzd2l0Y2ggKGNtZCkgeworCWNhc2UgRVhGQVRfSU9DVExfR0VUX1ZPTFVNRV9JRDoKKwkJcmV0
dXJuIGV4ZmF0X2lvY3RsX3ZvbHVtZV9pZChpbm9kZSk7CisjaWZkZWYgQ09ORklHX0VYRkFUX0tF
Uk5FTF9ERUJVRworCWNhc2UgRVhGQVRfSU9DX0dFVF9ERUJVR0ZMQUdTOiB7CisJCXN0cnVjdCBz
dXBlcl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKKwkJc3RydWN0IGV4ZmF0X3NiX2luZm8gKnNi
aSA9IEVYRkFUX1NCKHNiKTsKKworCQlmbGFncyA9IHNiaS0+ZGVidWdfZmxhZ3M7CisJCXJldHVy
biBwdXRfdXNlcihmbGFncywgKGludCBfX3VzZXIgKilhcmcpOworCX0KKwljYXNlIEVYRkFUX0lP
Q19TRVRfREVCVUdGTEFHUzogeworCQlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0gaW5vZGUtPmlf
c2I7CisJCXN0cnVjdCBleGZhdF9zYl9pbmZvICpzYmkgPSBFWEZBVF9TQihzYik7CisKKwkJaWYg
KCFjYXBhYmxlKENBUF9TWVNfQURNSU4pKQorCQkJcmV0dXJuIC1FUEVSTTsKKworCQlpZiAoZ2V0
X3VzZXIoZmxhZ3MsIChpbnQgX191c2VyICopIGFyZykpCisJCQlyZXR1cm4gLUVGQVVMVDsKKwor
CQlfX2xvY2tfc3VwZXIoc2IpOworCQlzYmktPmRlYnVnX2ZsYWdzID0gZmxhZ3M7CisJCV9fdW5s
b2NrX3N1cGVyKHNiKTsKKworCQlyZXR1cm4gMDsKKwl9CisjZW5kaWYgLyogQ09ORklHX0VYRkFU
X0tFUk5FTF9ERUJVRyAqLworCWRlZmF1bHQ6CisJCXJldHVybiAtRU5PVFRZOyAvKiBJbmFwcHJv
cHJpYXRlIGlvY3RsIGZvciBkZXZpY2UgKi8KKwl9Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qg
ZmlsZV9vcGVyYXRpb25zIGV4ZmF0X2Rpcl9vcGVyYXRpb25zID0geworCS5sbHNlZWsgICAgID0g
Z2VuZXJpY19maWxlX2xsc2VlaywKKwkucmVhZCAgICAgICA9IGdlbmVyaWNfcmVhZF9kaXIsCisJ
Lml0ZXJhdGUgICAgPSBleGZhdF9yZWFkZGlyLAorCS51bmxvY2tlZF9pb2N0bCA9IGV4ZmF0X2dl
bmVyaWNfaW9jdGwsCisJLmZzeW5jICAgICAgPSBnZW5lcmljX2ZpbGVfZnN5bmMsCit9OworCitz
dGF0aWMgaW50IGV4ZmF0X2NyZWF0ZShzdHJ1Y3QgaW5vZGUgKmRpciwgc3RydWN0IGRlbnRyeSAq
ZGVudHJ5LCB1bW9kZV90IG1vZGUsCisJCQlib29sIGV4Y2wpCit7CisJc3RydWN0IHN1cGVyX2Js
b2NrICpzYiA9IGRpci0+aV9zYjsKKwlzdHJ1Y3QgaW5vZGUgKmlub2RlOworCXN0cnVjdCBmaWxl
X2lkX3QgZmlkOworCWxvZmZfdCBpX3BvczsKKwlpbnQgZXJyOworCisJX19sb2NrX3N1cGVyKHNi
KTsKKworCXByX2RlYnVnKCIlcyBlbnRlcmVkXG4iLCBfX2Z1bmNfXyk7CisKKwllcnIgPSBmZnND
cmVhdGVGaWxlKGRpciwgKHU4ICopIGRlbnRyeS0+ZF9uYW1lLm5hbWUsIEZNX1JFR1VMQVIsICZm
aWQpOworCWlmIChlcnIpIHsKKwkJaWYgKGVyciA9PSBGRlNfSU5WQUxJRFBBVEgpCisJCQllcnIg
PSAtRUlOVkFMOworCQllbHNlIGlmIChlcnIgPT0gRkZTX0ZJTEVFWElTVCkKKwkJCWVyciA9IC1F
RVhJU1Q7CisJCWVsc2UgaWYgKGVyciA9PSBGRlNfRlVMTCkKKwkJCWVyciA9IC1FTk9TUEM7CisJ
CWVsc2UgaWYgKGVyciA9PSBGRlNfTkFNRVRPT0xPTkcpCisJCQllcnIgPSAtRU5BTUVUT09MT05H
OworCQllbHNlCisJCQllcnIgPSAtRUlPOworCQlnb3RvIG91dDsKKwl9CisJSU5DX0lWRVJTSU9O
KGRpcik7CisJZGlyLT5pX2N0aW1lID0gZGlyLT5pX210aW1lID0gZGlyLT5pX2F0aW1lID0gY3Vy
cmVudF90aW1lKGRpcik7CisJaWYgKElTX0RJUlNZTkMoZGlyKSkKKwkJKHZvaWQpIGV4ZmF0X3N5
bmNfaW5vZGUoZGlyKTsKKwllbHNlCisJCW1hcmtfaW5vZGVfZGlydHkoZGlyKTsKKworCWlfcG9z
ID0gKChsb2ZmX3QpIGZpZC5kaXIuZGlyIDw8IDMyKSB8IChmaWQuZW50cnkgJiAweGZmZmZmZmZm
KTsKKworCWlub2RlID0gZXhmYXRfYnVpbGRfaW5vZGUoc2IsICZmaWQsIGlfcG9zKTsKKwlpZiAo
SVNfRVJSKGlub2RlKSkgeworCQllcnIgPSBQVFJfRVJSKGlub2RlKTsKKwkJZ290byBvdXQ7CisJ
fQorCUlOQ19JVkVSU0lPTihpbm9kZSk7CisJaW5vZGUtPmlfbXRpbWUgPSBpbm9kZS0+aV9hdGlt
ZSA9IGlub2RlLT5pX2N0aW1lID0gY3VycmVudF90aW1lKGlub2RlKTsKKwkvKgorCSAqIHRpbWVz
dGFtcCBpcyBhbHJlYWR5IHdyaXR0ZW4sIHNvIG1hcmtfaW5vZGVfZGlydHkoKSBpcyB1bm5lY2Vz
c2FyeS4KKwkgKi8KKworCWRlbnRyeS0+ZF90aW1lID0gR0VUX0lWRVJTSU9OKGRlbnRyeS0+ZF9w
YXJlbnQtPmRfaW5vZGUpOworCWRfaW5zdGFudGlhdGUoZGVudHJ5LCBpbm9kZSk7CisKK291dDoK
KwlfX3VubG9ja19zdXBlcihzYik7CisJcHJfZGVidWcoIiVzIGV4aXRlZFxuIiwgX19mdW5jX18p
OworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgZXhmYXRfZmluZChzdHJ1Y3QgaW5vZGUg
KmRpciwgc3RydWN0IHFzdHIgKnFuYW1lLAorCQkgICAgICBzdHJ1Y3QgZmlsZV9pZF90ICpmaWQp
Cit7CisJaW50IGVycjsKKworCWlmIChxbmFtZS0+bGVuID09IDApCisJCXJldHVybiAtRU5PRU5U
OworCisJZXJyID0gZmZzTG9va3VwRmlsZShkaXIsICh1OCAqKSBxbmFtZS0+bmFtZSwgZmlkKTsK
KwlpZiAoZXJyKQorCQlyZXR1cm4gLUVOT0VOVDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMg
aW50IGV4ZmF0X2RfYW5vbl9kaXNjb25uKHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKK3sKKwlyZXR1
cm4gSVNfUk9PVChkZW50cnkpICYmIChkZW50cnktPmRfZmxhZ3MgJiBEQ0FDSEVfRElTQ09OTkVD
VEVEKTsKK30KKworc3RhdGljIHN0cnVjdCBkZW50cnkgKmV4ZmF0X2xvb2t1cChzdHJ1Y3QgaW5v
ZGUgKmRpciwgc3RydWN0IGRlbnRyeSAqZGVudHJ5LAorCQkJCSAgIHVuc2lnbmVkIGludCBmbGFn
cykKK3sKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0gZGlyLT5pX3NiOworCXN0cnVjdCBpbm9k
ZSAqaW5vZGU7CisJc3RydWN0IGRlbnRyeSAqYWxpYXM7CisJaW50IGVycjsKKwlzdHJ1Y3QgZmls
ZV9pZF90IGZpZDsKKwlsb2ZmX3QgaV9wb3M7CisJdTY0IHJldDsKKwltb2RlX3QgaV9tb2RlOwor
CisJX19sb2NrX3N1cGVyKHNiKTsKKwlwcl9kZWJ1ZygiJXMgZW50ZXJlZFxuIiwgX19mdW5jX18p
OworCWVyciA9IGV4ZmF0X2ZpbmQoZGlyLCAmZGVudHJ5LT5kX25hbWUsICZmaWQpOworCWlmIChl
cnIpIHsKKwkJaWYgKGVyciA9PSAtRU5PRU5UKSB7CisJCQlpbm9kZSA9IE5VTEw7CisJCQlnb3Rv
IG91dDsKKwkJfQorCQlnb3RvIGVycm9yOworCX0KKworCWlfcG9zID0gKChsb2ZmX3QpIGZpZC5k
aXIuZGlyIDw8IDMyKSB8IChmaWQuZW50cnkgJiAweGZmZmZmZmZmKTsKKwlpbm9kZSA9IGV4ZmF0
X2J1aWxkX2lub2RlKHNiLCAmZmlkLCBpX3Bvcyk7CisJaWYgKElTX0VSUihpbm9kZSkpIHsKKwkJ
ZXJyID0gUFRSX0VSUihpbm9kZSk7CisJCWdvdG8gZXJyb3I7CisJfQorCisJaV9tb2RlID0gaW5v
ZGUtPmlfbW9kZTsKKwlpZiAoU19JU0xOSyhpX21vZGUpICYmICFFWEZBVF9JKGlub2RlKS0+dGFy
Z2V0KSB7CisJCUVYRkFUX0koaW5vZGUpLT50YXJnZXQgPSBrbWFsbG9jKGlfc2l6ZV9yZWFkKGlu
b2RlKSArIDEsCisJCQkJCQkgR0ZQX0tFUk5FTCk7CisJCWlmICghRVhGQVRfSShpbm9kZSktPnRh
cmdldCkgeworCQkJZXJyID0gLUVOT01FTTsKKwkJCWdvdG8gZXJyb3I7CisJCX0KKwkJZmZzUmVh
ZEZpbGUoZGlyLCAmZmlkLCBFWEZBVF9JKGlub2RlKS0+dGFyZ2V0LAorCQkJICAgIGlfc2l6ZV9y
ZWFkKGlub2RlKSwgJnJldCk7CisJCSooRVhGQVRfSShpbm9kZSktPnRhcmdldCArIGlfc2l6ZV9y
ZWFkKGlub2RlKSkgPSAnXDAnOworCX0KKworCWFsaWFzID0gZF9maW5kX2FsaWFzKGlub2RlKTsK
KwlpZiAoYWxpYXMgJiYgIWV4ZmF0X2RfYW5vbl9kaXNjb25uKGFsaWFzKSkgeworCQlCVUdfT04o
ZF91bmhhc2hlZChhbGlhcykpOworCQlpZiAoIVNfSVNESVIoaV9tb2RlKSkKKwkJCWRfbW92ZShh
bGlhcywgZGVudHJ5KTsKKwkJaXB1dChpbm9kZSk7CisJCV9fdW5sb2NrX3N1cGVyKHNiKTsKKwkJ
cHJfZGVidWcoIiVzIGV4aXRlZCAxXG4iLCBfX2Z1bmNfXyk7CisJCXJldHVybiBhbGlhczsKKwl9
CisJZHB1dChhbGlhcyk7CitvdXQ6CisJX191bmxvY2tfc3VwZXIoc2IpOworCWRlbnRyeS0+ZF90
aW1lID0gR0VUX0lWRVJTSU9OKGRlbnRyeS0+ZF9wYXJlbnQtPmRfaW5vZGUpOworCWRlbnRyeSA9
IGRfc3BsaWNlX2FsaWFzKGlub2RlLCBkZW50cnkpOworCWlmIChkZW50cnkpCisJCWRlbnRyeS0+
ZF90aW1lID0gR0VUX0lWRVJTSU9OKGRlbnRyeS0+ZF9wYXJlbnQtPmRfaW5vZGUpOworCXByX2Rl
YnVnKCIlcyBleGl0ZWQgMlxuIiwgX19mdW5jX18pOworCXJldHVybiBkZW50cnk7CisKK2Vycm9y
OgorCV9fdW5sb2NrX3N1cGVyKHNiKTsKKwlwcl9kZWJ1ZygiJXMgZXhpdGVkIDNcbiIsIF9fZnVu
Y19fKTsKKwlyZXR1cm4gRVJSX1BUUihlcnIpOworfQorCitzdGF0aWMgaW5saW5lIHVuc2lnbmVk
IGxvbmcgZXhmYXRfaGFzaChsb2ZmX3QgaV9wb3MpCit7CisJcmV0dXJuIGhhc2hfMzIoaV9wb3Ms
IEVYRkFUX0hBU0hfQklUUyk7Cit9CisKK3N0YXRpYyB2b2lkIGV4ZmF0X2F0dGFjaChzdHJ1Y3Qg
aW5vZGUgKmlub2RlLCBsb2ZmX3QgaV9wb3MpCit7CisJc3RydWN0IGV4ZmF0X3NiX2luZm8gKnNi
aSA9IEVYRkFUX1NCKGlub2RlLT5pX3NiKTsKKwlzdHJ1Y3QgaGxpc3RfaGVhZCAqaGVhZCA9IHNi
aS0+aW5vZGVfaGFzaHRhYmxlICsgZXhmYXRfaGFzaChpX3Bvcyk7CisKKwlzcGluX2xvY2soJnNi
aS0+aW5vZGVfaGFzaF9sb2NrKTsKKwlFWEZBVF9JKGlub2RlKS0+aV9wb3MgPSBpX3BvczsKKwlo
bGlzdF9hZGRfaGVhZCgmRVhGQVRfSShpbm9kZSktPmlfaGFzaF9mYXQsIGhlYWQpOworCXNwaW5f
dW5sb2NrKCZzYmktPmlub2RlX2hhc2hfbG9jayk7Cit9CisKK3N0YXRpYyB2b2lkIGV4ZmF0X2Rl
dGFjaChzdHJ1Y3QgaW5vZGUgKmlub2RlKQoreworCXN0cnVjdCBleGZhdF9zYl9pbmZvICpzYmkg
PSBFWEZBVF9TQihpbm9kZS0+aV9zYik7CisKKwlzcGluX2xvY2soJnNiaS0+aW5vZGVfaGFzaF9s
b2NrKTsKKwlobGlzdF9kZWxfaW5pdCgmRVhGQVRfSShpbm9kZSktPmlfaGFzaF9mYXQpOworCUVY
RkFUX0koaW5vZGUpLT5pX3BvcyA9IDA7CisJc3Bpbl91bmxvY2soJnNiaS0+aW5vZGVfaGFzaF9s
b2NrKTsKK30KKworc3RhdGljIGludCBleGZhdF91bmxpbmsoc3RydWN0IGlub2RlICpkaXIsIHN0
cnVjdCBkZW50cnkgKmRlbnRyeSkKK3sKKwlzdHJ1Y3QgaW5vZGUgKmlub2RlID0gZGVudHJ5LT5k
X2lub2RlOworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBkaXItPmlfc2I7CisJaW50IGVycjsK
KworCV9fbG9ja19zdXBlcihzYik7CisKKwlwcl9kZWJ1ZygiJXMgZW50ZXJlZFxuIiwgX19mdW5j
X18pOworCisJRVhGQVRfSShpbm9kZSktPmZpZC5zaXplID0gaV9zaXplX3JlYWQoaW5vZGUpOwor
CisJZXJyID0gZmZzUmVtb3ZlRmlsZShkaXIsICYoRVhGQVRfSShpbm9kZSktPmZpZCkpOworCWlm
IChlcnIpIHsKKwkJaWYgKGVyciA9PSBGRlNfUEVSTUlTU0lPTkVSUikKKwkJCWVyciA9IC1FUEVS
TTsKKwkJZWxzZQorCQkJZXJyID0gLUVJTzsKKwkJZ290byBvdXQ7CisJfQorCUlOQ19JVkVSU0lP
TihkaXIpOworCWRpci0+aV9tdGltZSA9IGRpci0+aV9hdGltZSA9IGN1cnJlbnRfdGltZShkaXIp
OworCWlmIChJU19ESVJTWU5DKGRpcikpCisJCSh2b2lkKSBleGZhdF9zeW5jX2lub2RlKGRpcik7
CisJZWxzZQorCQltYXJrX2lub2RlX2RpcnR5KGRpcik7CisKKwljbGVhcl9ubGluayhpbm9kZSk7
CisJaW5vZGUtPmlfbXRpbWUgPSBpbm9kZS0+aV9hdGltZSA9IGN1cnJlbnRfdGltZShpbm9kZSk7
CisJZXhmYXRfZGV0YWNoKGlub2RlKTsKKwlyZW1vdmVfaW5vZGVfaGFzaChpbm9kZSk7CisKK291
dDoKKwlfX3VubG9ja19zdXBlcihzYik7CisJcHJfZGVidWcoIiVzIGV4aXRlZFxuIiwgX19mdW5j
X18pOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQgZXhmYXRfc3ltbGluayhzdHJ1Y3Qg
aW5vZGUgKmRpciwgc3RydWN0IGRlbnRyeSAqZGVudHJ5LAorCQkJIGNvbnN0IGNoYXIgKnRhcmdl
dCkKK3sKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0gZGlyLT5pX3NiOworCXN0cnVjdCBpbm9k
ZSAqaW5vZGU7CisJc3RydWN0IGZpbGVfaWRfdCBmaWQ7CisJbG9mZl90IGlfcG9zOworCWludCBl
cnI7CisJdTY0IGxlbiA9ICh1NjQpIHN0cmxlbih0YXJnZXQpOworCXU2NCByZXQ7CisKKwlfX2xv
Y2tfc3VwZXIoc2IpOworCisJcHJfZGVidWcoIiVzIGVudGVyZWRcbiIsIF9fZnVuY19fKTsKKwor
CWVyciA9IGZmc0NyZWF0ZUZpbGUoZGlyLCAodTggKikgZGVudHJ5LT5kX25hbWUubmFtZSwgRk1f
U1lNTElOSywgJmZpZCk7CisJaWYgKGVycikgeworCQlpZiAoZXJyID09IEZGU19JTlZBTElEUEFU
SCkKKwkJCWVyciA9IC1FSU5WQUw7CisJCWVsc2UgaWYgKGVyciA9PSBGRlNfRklMRUVYSVNUKQor
CQkJZXJyID0gLUVFWElTVDsKKwkJZWxzZSBpZiAoZXJyID09IEZGU19GVUxMKQorCQkJZXJyID0g
LUVOT1NQQzsKKwkJZWxzZQorCQkJZXJyID0gLUVJTzsKKwkJZ290byBvdXQ7CisJfQorCisJZXJy
ID0gZmZzV3JpdGVGaWxlKGRpciwgJmZpZCwgKGNoYXIgKikgdGFyZ2V0LCBsZW4sICZyZXQpOwor
CisJaWYgKGVycikgeworCQlmZnNSZW1vdmVGaWxlKGRpciwgJmZpZCk7CisKKwkJaWYgKGVyciA9
PSBGRlNfRlVMTCkKKwkJCWVyciA9IC1FTk9TUEM7CisJCWVsc2UKKwkJCWVyciA9IC1FSU87CisJ
CWdvdG8gb3V0OworCX0KKworCUlOQ19JVkVSU0lPTihkaXIpOworCWRpci0+aV9jdGltZSA9IGRp
ci0+aV9tdGltZSA9IGRpci0+aV9hdGltZSA9IGN1cnJlbnRfdGltZShkaXIpOworCWlmIChJU19E
SVJTWU5DKGRpcikpCisJCSh2b2lkKSBleGZhdF9zeW5jX2lub2RlKGRpcik7CisJZWxzZQorCQlt
YXJrX2lub2RlX2RpcnR5KGRpcik7CisKKwlpX3BvcyA9ICgobG9mZl90KSBmaWQuZGlyLmRpciA8
PCAzMikgfCAoZmlkLmVudHJ5ICYgMHhmZmZmZmZmZik7CisKKwlpbm9kZSA9IGV4ZmF0X2J1aWxk
X2lub2RlKHNiLCAmZmlkLCBpX3Bvcyk7CisJaWYgKElTX0VSUihpbm9kZSkpIHsKKwkJZXJyID0g
UFRSX0VSUihpbm9kZSk7CisJCWdvdG8gb3V0OworCX0KKwlJTkNfSVZFUlNJT04oaW5vZGUpOwor
CWlub2RlLT5pX210aW1lID0gaW5vZGUtPmlfYXRpbWUgPSBpbm9kZS0+aV9jdGltZSA9IGN1cnJl
bnRfdGltZShpbm9kZSk7CisJLyogdGltZXN0YW1wIGlzIGFscmVhZHkgd3JpdHRlbiwgc28gbWFy
a19pbm9kZV9kaXJ0eSgpIGlzIHVubmVlZGVkLiAqLworCisJRVhGQVRfSShpbm9kZSktPnRhcmdl
dCA9IGttYWxsb2MobGVuKzEsIEdGUF9LRVJORUwpOworCWlmICghRVhGQVRfSShpbm9kZSktPnRh
cmdldCkgeworCQllcnIgPSAtRU5PTUVNOworCQlnb3RvIG91dDsKKwl9CisJbWVtY3B5KEVYRkFU
X0koaW5vZGUpLT50YXJnZXQsIHRhcmdldCwgbGVuKzEpOworCisJZGVudHJ5LT5kX3RpbWUgPSBH
RVRfSVZFUlNJT04oZGVudHJ5LT5kX3BhcmVudC0+ZF9pbm9kZSk7CisJZF9pbnN0YW50aWF0ZShk
ZW50cnksIGlub2RlKTsKKworb3V0OgorCV9fdW5sb2NrX3N1cGVyKHNiKTsKKwlwcl9kZWJ1Zygi
JXMgZXhpdGVkXG4iLCBfX2Z1bmNfXyk7CisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBl
eGZhdF9ta2RpcihzdHJ1Y3QgaW5vZGUgKmRpciwgc3RydWN0IGRlbnRyeSAqZGVudHJ5LCB1bW9k
ZV90IG1vZGUpCit7CisJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGRpci0+aV9zYjsKKwlzdHJ1
Y3QgaW5vZGUgKmlub2RlOworCXN0cnVjdCBmaWxlX2lkX3QgZmlkOworCWxvZmZfdCBpX3BvczsK
KwlpbnQgZXJyOworCisJX19sb2NrX3N1cGVyKHNiKTsKKworCXByX2RlYnVnKCIlcyBlbnRlcmVk
XG4iLCBfX2Z1bmNfXyk7CisKKwllcnIgPSBmZnNDcmVhdGVEaXIoZGlyLCAodTggKikgZGVudHJ5
LT5kX25hbWUubmFtZSwgJmZpZCk7CisJaWYgKGVycikgeworCQlpZiAoZXJyID09IEZGU19JTlZB
TElEUEFUSCkKKwkJCWVyciA9IC1FSU5WQUw7CisJCWVsc2UgaWYgKGVyciA9PSBGRlNfRklMRUVY
SVNUKQorCQkJZXJyID0gLUVFWElTVDsKKwkJZWxzZSBpZiAoZXJyID09IEZGU19GVUxMKQorCQkJ
ZXJyID0gLUVOT1NQQzsKKwkJZWxzZSBpZiAoZXJyID09IEZGU19OQU1FVE9PTE9ORykKKwkJCWVy
ciA9IC1FTkFNRVRPT0xPTkc7CisJCWVsc2UKKwkJCWVyciA9IC1FSU87CisJCWdvdG8gb3V0Owor
CX0KKwlJTkNfSVZFUlNJT04oZGlyKTsKKwlkaXItPmlfY3RpbWUgPSBkaXItPmlfbXRpbWUgPSBk
aXItPmlfYXRpbWUgPSBjdXJyZW50X3RpbWUoZGlyKTsKKwlpZiAoSVNfRElSU1lOQyhkaXIpKQor
CQkodm9pZCkgZXhmYXRfc3luY19pbm9kZShkaXIpOworCWVsc2UKKwkJbWFya19pbm9kZV9kaXJ0
eShkaXIpOworCWluY19ubGluayhkaXIpOworCisJaV9wb3MgPSAoKGxvZmZfdCkgZmlkLmRpci5k
aXIgPDwgMzIpIHwgKGZpZC5lbnRyeSAmIDB4ZmZmZmZmZmYpOworCisJaW5vZGUgPSBleGZhdF9i
dWlsZF9pbm9kZShzYiwgJmZpZCwgaV9wb3MpOworCWlmIChJU19FUlIoaW5vZGUpKSB7CisJCWVy
ciA9IFBUUl9FUlIoaW5vZGUpOworCQlnb3RvIG91dDsKKwl9CisJSU5DX0lWRVJTSU9OKGlub2Rl
KTsKKwlpbm9kZS0+aV9tdGltZSA9IGlub2RlLT5pX2F0aW1lID0gaW5vZGUtPmlfY3RpbWUgPSBj
dXJyZW50X3RpbWUoaW5vZGUpOworCS8qIHRpbWVzdGFtcCBpcyBhbHJlYWR5IHdyaXR0ZW4sIHNv
IG1hcmtfaW5vZGVfZGlydHkoKSBpcyB1bm5lZWRlZC4gKi8KKworCWRlbnRyeS0+ZF90aW1lID0g
R0VUX0lWRVJTSU9OKGRlbnRyeS0+ZF9wYXJlbnQtPmRfaW5vZGUpOworCWRfaW5zdGFudGlhdGUo
ZGVudHJ5LCBpbm9kZSk7CisKK291dDoKKwlfX3VubG9ja19zdXBlcihzYik7CisJcHJfZGVidWco
IiVzIGV4aXRlZFxuIiwgX19mdW5jX18pOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRpYyBpbnQg
ZXhmYXRfcm1kaXIoc3RydWN0IGlub2RlICpkaXIsIHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKK3sK
KwlzdHJ1Y3QgaW5vZGUgKmlub2RlID0gZGVudHJ5LT5kX2lub2RlOworCXN0cnVjdCBzdXBlcl9i
bG9jayAqc2IgPSBkaXItPmlfc2I7CisJaW50IGVycjsKKworCV9fbG9ja19zdXBlcihzYik7CisK
Kwlwcl9kZWJ1ZygiJXMgZW50ZXJlZFxuIiwgX19mdW5jX18pOworCisJRVhGQVRfSShpbm9kZSkt
PmZpZC5zaXplID0gaV9zaXplX3JlYWQoaW5vZGUpOworCisJZXJyID0gZmZzUmVtb3ZlRGlyKGRp
ciwgJihFWEZBVF9JKGlub2RlKS0+ZmlkKSk7CisJaWYgKGVycikgeworCQlpZiAoZXJyID09IEZG
U19JTlZBTElEUEFUSCkKKwkJCWVyciA9IC1FSU5WQUw7CisJCWVsc2UgaWYgKGVyciA9PSBGRlNf
RklMRUVYSVNUKQorCQkJZXJyID0gLUVOT1RFTVBUWTsKKwkJZWxzZSBpZiAoZXJyID09IEZGU19O
T1RGT1VORCkKKwkJCWVyciA9IC1FTk9FTlQ7CisJCWVsc2UgaWYgKGVyciA9PSBGRlNfRElSQlVT
WSkKKwkJCWVyciA9IC1FQlVTWTsKKwkJZWxzZQorCQkJZXJyID0gLUVJTzsKKwkJZ290byBvdXQ7
CisJfQorCUlOQ19JVkVSU0lPTihkaXIpOworCWRpci0+aV9tdGltZSA9IGRpci0+aV9hdGltZSA9
IGN1cnJlbnRfdGltZShkaXIpOworCWlmIChJU19ESVJTWU5DKGRpcikpCisJCSh2b2lkKSBleGZh
dF9zeW5jX2lub2RlKGRpcik7CisJZWxzZQorCQltYXJrX2lub2RlX2RpcnR5KGRpcik7CisJZHJv
cF9ubGluayhkaXIpOworCisJY2xlYXJfbmxpbmsoaW5vZGUpOworCWlub2RlLT5pX210aW1lID0g
aW5vZGUtPmlfYXRpbWUgPSBjdXJyZW50X3RpbWUoaW5vZGUpOworCWV4ZmF0X2RldGFjaChpbm9k
ZSk7CisJcmVtb3ZlX2lub2RlX2hhc2goaW5vZGUpOworCitvdXQ6CisJX191bmxvY2tfc3VwZXIo
c2IpOworCXByX2RlYnVnKCIlcyBleGl0ZWRcbiIsIF9fZnVuY19fKTsKKwlyZXR1cm4gZXJyOwor
fQorCitzdGF0aWMgaW50IGV4ZmF0X3JlbmFtZShzdHJ1Y3QgaW5vZGUgKm9sZF9kaXIsIHN0cnVj
dCBkZW50cnkgKm9sZF9kZW50cnksCisJCQlzdHJ1Y3QgaW5vZGUgKm5ld19kaXIsIHN0cnVjdCBk
ZW50cnkgKm5ld19kZW50cnksCisJCQl1bnNpZ25lZCBpbnQgZmxhZ3MpCit7CisJc3RydWN0IGlu
b2RlICpvbGRfaW5vZGUsICpuZXdfaW5vZGU7CisJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IG9s
ZF9kaXItPmlfc2I7CisJbG9mZl90IGlfcG9zOworCWludCBlcnI7CisKKwlpZiAoZmxhZ3MpCisJ
CXJldHVybiAtRUlOVkFMOworCisJX19sb2NrX3N1cGVyKHNiKTsKKworCXByX2RlYnVnKCIlcyBl
bnRlcmVkXG4iLCBfX2Z1bmNfXyk7CisKKwlvbGRfaW5vZGUgPSBvbGRfZGVudHJ5LT5kX2lub2Rl
OworCW5ld19pbm9kZSA9IG5ld19kZW50cnktPmRfaW5vZGU7CisKKwlFWEZBVF9JKG9sZF9pbm9k
ZSktPmZpZC5zaXplID0gaV9zaXplX3JlYWQob2xkX2lub2RlKTsKKworCWVyciA9IGZmc01vdmVG
aWxlKG9sZF9kaXIsICYoRVhGQVRfSShvbGRfaW5vZGUpLT5maWQpLCBuZXdfZGlyLAorCQkJICBu
ZXdfZGVudHJ5KTsKKwlpZiAoZXJyKSB7CisJCWlmIChlcnIgPT0gRkZTX1BFUk1JU1NJT05FUlIp
CisJCQllcnIgPSAtRVBFUk07CisJCWVsc2UgaWYgKGVyciA9PSBGRlNfSU5WQUxJRFBBVEgpCisJ
CQllcnIgPSAtRUlOVkFMOworCQllbHNlIGlmIChlcnIgPT0gRkZTX0ZJTEVFWElTVCkKKwkJCWVy
ciA9IC1FRVhJU1Q7CisJCWVsc2UgaWYgKGVyciA9PSBGRlNfTk9URk9VTkQpCisJCQllcnIgPSAt
RU5PRU5UOworCQllbHNlIGlmIChlcnIgPT0gRkZTX0ZVTEwpCisJCQllcnIgPSAtRU5PU1BDOwor
CQllbHNlCisJCQllcnIgPSAtRUlPOworCQlnb3RvIG91dDsKKwl9CisJSU5DX0lWRVJTSU9OKG5l
d19kaXIpOworCW5ld19kaXItPmlfY3RpbWUgPSBuZXdfZGlyLT5pX210aW1lID0gbmV3X2Rpci0+
aV9hdGltZSA9CisJCQkJY3VycmVudF90aW1lKG5ld19kaXIpOworCWlmIChJU19ESVJTWU5DKG5l
d19kaXIpKQorCQkodm9pZCkgZXhmYXRfc3luY19pbm9kZShuZXdfZGlyKTsKKwllbHNlCisJCW1h
cmtfaW5vZGVfZGlydHkobmV3X2Rpcik7CisKKwlpX3BvcyA9ICgobG9mZl90KSBFWEZBVF9JKG9s
ZF9pbm9kZSktPmZpZC5kaXIuZGlyIDw8IDMyKSB8CisJCQkoRVhGQVRfSShvbGRfaW5vZGUpLT5m
aWQuZW50cnkgJiAweGZmZmZmZmZmKTsKKworCWV4ZmF0X2RldGFjaChvbGRfaW5vZGUpOworCWV4
ZmF0X2F0dGFjaChvbGRfaW5vZGUsIGlfcG9zKTsKKwlpZiAoSVNfRElSU1lOQyhuZXdfZGlyKSkK
KwkJKHZvaWQpIGV4ZmF0X3N5bmNfaW5vZGUob2xkX2lub2RlKTsKKwllbHNlCisJCW1hcmtfaW5v
ZGVfZGlydHkob2xkX2lub2RlKTsKKworCWlmICgoU19JU0RJUihvbGRfaW5vZGUtPmlfbW9kZSkp
ICYmIChvbGRfZGlyICE9IG5ld19kaXIpKSB7CisJCWRyb3Bfbmxpbmsob2xkX2Rpcik7CisJCWlm
ICghbmV3X2lub2RlKQorCQkJaW5jX25saW5rKG5ld19kaXIpOworCX0KKwlJTkNfSVZFUlNJT04o
b2xkX2Rpcik7CisJb2xkX2Rpci0+aV9jdGltZSA9IG9sZF9kaXItPmlfbXRpbWUgPSBjdXJyZW50
X3RpbWUob2xkX2Rpcik7CisJaWYgKElTX0RJUlNZTkMob2xkX2RpcikpCisJCSh2b2lkKSBleGZh
dF9zeW5jX2lub2RlKG9sZF9kaXIpOworCWVsc2UKKwkJbWFya19pbm9kZV9kaXJ0eShvbGRfZGly
KTsKKworCWlmIChuZXdfaW5vZGUpIHsKKwkJZXhmYXRfZGV0YWNoKG5ld19pbm9kZSk7CisJCWRy
b3BfbmxpbmsobmV3X2lub2RlKTsKKwkJaWYgKFNfSVNESVIobmV3X2lub2RlLT5pX21vZGUpKQor
CQkJZHJvcF9ubGluayhuZXdfaW5vZGUpOworCQluZXdfaW5vZGUtPmlfY3RpbWUgPSBjdXJyZW50
X3RpbWUobmV3X2lub2RlKTsKKwl9CisKK291dDoKKwlfX3VubG9ja19zdXBlcihzYik7CisJcHJf
ZGVidWcoIiVzIGV4aXRlZFxuIiwgX19mdW5jX18pOworCXJldHVybiBlcnI7Cit9CisKK3N0YXRp
YyBpbnQgZXhmYXRfY29udF9leHBhbmQoc3RydWN0IGlub2RlICppbm9kZSwgbG9mZl90IHNpemUp
Cit7CisJc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcgPSBpbm9kZS0+aV9tYXBwaW5nOwor
CWxvZmZfdCBzdGFydCA9IGlfc2l6ZV9yZWFkKGlub2RlKSwgY291bnQgPSBzaXplIC0gaV9zaXpl
X3JlYWQoaW5vZGUpOworCWludCBlcnIsIGVycjI7CisKKwllcnIgPSBnZW5lcmljX2NvbnRfZXhw
YW5kX3NpbXBsZShpbm9kZSwgc2l6ZSk7CisJaWYgKGVyciAhPSAwKQorCQlyZXR1cm4gZXJyOwor
CisJaW5vZGUtPmlfY3RpbWUgPSBpbm9kZS0+aV9tdGltZSA9IGN1cnJlbnRfdGltZShpbm9kZSk7
CisJbWFya19pbm9kZV9kaXJ0eShpbm9kZSk7CisKKwlpZiAoSVNfU1lOQyhpbm9kZSkpIHsKKwkJ
ZXJyID0gZmlsZW1hcF9mZGF0YXdyaXRlX3JhbmdlKG1hcHBpbmcsIHN0YXJ0LAorCQkJCQkgICAg
ICAgc3RhcnQgKyBjb3VudCAtIDEpOworCQllcnIyID0gc3luY19tYXBwaW5nX2J1ZmZlcnMobWFw
cGluZyk7CisJCWVyciA9IChlcnIpID8gKGVycikgOiAoZXJyMik7CisJCWVycjIgPSB3cml0ZV9p
bm9kZV9ub3coaW5vZGUsIDEpOworCQllcnIgPSAoZXJyKSA/IChlcnIpIDogKGVycjIpOworCQlp
ZiAoIWVycikKKwkJCWVyciA9ICBmaWxlbWFwX2ZkYXRhd2FpdF9yYW5nZShtYXBwaW5nLCBzdGFy
dCwKKwkJCQkJCSAgICAgICBzdGFydCArIGNvdW50IC0gMSk7CisJfQorCXJldHVybiBlcnI7Cit9
CisKK3N0YXRpYyBpbnQgZXhmYXRfYWxsb3dfc2V0X3RpbWUoc3RydWN0IGV4ZmF0X3NiX2luZm8g
KnNiaSwgc3RydWN0IGlub2RlICppbm9kZSkKK3sKKwltb2RlX3QgYWxsb3dfdXRpbWUgPSBzYmkt
Pm9wdGlvbnMuYWxsb3dfdXRpbWU7CisKKwlpZiAoIXVpZF9lcShjdXJyZW50X2ZzdWlkKCksIGlu
b2RlLT5pX3VpZCkpIHsKKwkJaWYgKGluX2dyb3VwX3AoaW5vZGUtPmlfZ2lkKSkKKwkJCWFsbG93
X3V0aW1lID4+PSAzOworCQlpZiAoYWxsb3dfdXRpbWUgJiBNQVlfV1JJVEUpCisJCQlyZXR1cm4g
MTsKKwl9CisKKwkvKiB1c2UgYSBkZWZhdWx0IGNoZWNrICovCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgZXhmYXRfc2FuaXRpemVfbW9kZShjb25zdCBzdHJ1Y3QgZXhmYXRfc2JfaW5mbyAq
c2JpLAorCQkJICAgICAgIHN0cnVjdCBpbm9kZSAqaW5vZGUsIHVtb2RlX3QgKm1vZGVfcHRyKQor
eworCW1vZGVfdCBpX21vZGUsIG1hc2ssIHBlcm07CisKKwlpX21vZGUgPSBpbm9kZS0+aV9tb2Rl
OworCisJaWYgKFNfSVNSRUcoaV9tb2RlKSB8fCBTX0lTTE5LKGlfbW9kZSkpCisJCW1hc2sgPSBz
YmktPm9wdGlvbnMuZnNfZm1hc2s7CisJZWxzZQorCQltYXNrID0gc2JpLT5vcHRpb25zLmZzX2Rt
YXNrOworCisJcGVybSA9ICptb2RlX3B0ciAmIH4oU19JRk1UIHwgbWFzayk7CisKKwkvKiBPZiB0
aGUgciBhbmQgeCBiaXRzLCBhbGwgKHN1YmplY3QgdG8gdW1hc2spIG11c3QgYmUgcHJlc2VudC4q
LworCWlmICgocGVybSAmIDA1NTUpICE9IChpX21vZGUgJiAwNTU1KSkKKwkJcmV0dXJuIC1FUEVS
TTsKKworCWlmIChleGZhdF9tb2RlX2Nhbl9ob2xkX3JvKGlub2RlKSkgeworCQkvKgorCQkgKiBP
ZiB0aGUgdyBiaXRzLCBlaXRoZXIgYWxsIChzdWJqZWN0IHRvIHVtYXNrKSBvciBub25lIG11c3Qg
YmUKKwkJICogcHJlc2VudC4KKwkJICovCisJCWlmICgocGVybSAmIDAyMjIpICYmICgocGVybSAm
IDAyMjIpICE9ICgwMjIyICYgfm1hc2spKSkKKwkJCXJldHVybiAtRVBFUk07CisJfSBlbHNlIHsK
KwkJLyoKKwkJICogSWYgZXhmYXRfbW9kZV9jYW5faG9sZF9ybyhpbm9kZSkgaXMgZmFsc2UsIGNh
bid0IGNoYW5nZSB3CisJCSAqIGJpdHMuCisJCSAqLworCQlpZiAoKHBlcm0gJiAwMjIyKSAhPSAo
MDIyMiAmIH5tYXNrKSkKKwkJCXJldHVybiAtRVBFUk07CisJfQorCisJKm1vZGVfcHRyICY9IFNf
SUZNVCB8IHBlcm07CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgZXhmYXRfdHJ1bmNh
dGUoc3RydWN0IGlub2RlICppbm9kZSwgbG9mZl90IG9sZF9zaXplKQoreworCXN0cnVjdCBzdXBl
cl9ibG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKKwlzdHJ1Y3QgZXhmYXRfc2JfaW5mbyAqc2JpID0g
RVhGQVRfU0Ioc2IpOworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKHNiaS0+ZnNfaW5mbyk7
CisJaW50IGVycjsKKworCV9fbG9ja19zdXBlcihzYik7CisKKwkvKgorCSAqIFRoaXMgcHJvdGVj
dHMgYWdhaW5zdCB0cnVuY2F0aW5nIGEgZmlsZSBiaWdnZXIgdGhhbiBpdCB3YXMgdGhlbgorCSAq
IHRyeWluZyB0byB3cml0ZSBpbnRvIHRoZSBob2xlLgorCSAqLworCWlmIChFWEZBVF9JKGlub2Rl
KS0+bW11X3ByaXZhdGUgPiBpX3NpemVfcmVhZChpbm9kZSkpCisJCUVYRkFUX0koaW5vZGUpLT5t
bXVfcHJpdmF0ZSA9IGlfc2l6ZV9yZWFkKGlub2RlKTsKKworCWlmIChFWEZBVF9JKGlub2RlKS0+
ZmlkLnN0YXJ0X2NsdSA9PSAwKQorCQlnb3RvIG91dDsKKworCWVyciA9IGZmc1RydW5jYXRlRmls
ZShpbm9kZSwgb2xkX3NpemUsIGlfc2l6ZV9yZWFkKGlub2RlKSk7CisJaWYgKGVycikKKwkJZ290
byBvdXQ7CisKKwlpbm9kZS0+aV9jdGltZSA9IGlub2RlLT5pX210aW1lID0gY3VycmVudF90aW1l
KGlub2RlKTsKKwlpZiAoSVNfRElSU1lOQyhpbm9kZSkpCisJCSh2b2lkKSBleGZhdF9zeW5jX2lu
b2RlKGlub2RlKTsKKwllbHNlCisJCW1hcmtfaW5vZGVfZGlydHkoaW5vZGUpOworCisJaW5vZGUt
PmlfYmxvY2tzID0gKChpX3NpemVfcmVhZChpbm9kZSkgKyAocF9mcy0+Y2x1c3Rlcl9zaXplIC0g
MSkpICYKKwkJCSAgIH4oKGxvZmZfdClwX2ZzLT5jbHVzdGVyX3NpemUgLSAxKSkgPj4gOTsKK291
dDoKKwlfX3VubG9ja19zdXBlcihzYik7Cit9CisKK3N0YXRpYyBpbnQgZXhmYXRfc2V0YXR0cihz
dHJ1Y3QgZGVudHJ5ICpkZW50cnksIHN0cnVjdCBpYXR0ciAqYXR0cikKK3sKKworCXN0cnVjdCBl
eGZhdF9zYl9pbmZvICpzYmkgPSBFWEZBVF9TQihkZW50cnktPmRfc2IpOworCXN0cnVjdCBpbm9k
ZSAqaW5vZGUgPSBkZW50cnktPmRfaW5vZGU7CisJdW5zaWduZWQgaW50IGlhX3ZhbGlkOworCWlu
dCBlcnJvcjsKKwlsb2ZmX3Qgb2xkX3NpemU7CisKKwlwcl9kZWJ1ZygiJXMgZW50ZXJlZFxuIiwg
X19mdW5jX18pOworCisJaWYgKChhdHRyLT5pYV92YWxpZCAmIEFUVFJfU0laRSkKKwkJJiYgKGF0
dHItPmlhX3NpemUgPiBpX3NpemVfcmVhZChpbm9kZSkpKSB7CisJCWVycm9yID0gZXhmYXRfY29u
dF9leHBhbmQoaW5vZGUsIGF0dHItPmlhX3NpemUpOworCQlpZiAoZXJyb3IgfHwgYXR0ci0+aWFf
dmFsaWQgPT0gQVRUUl9TSVpFKQorCQkJcmV0dXJuIGVycm9yOworCQlhdHRyLT5pYV92YWxpZCAm
PSB+QVRUUl9TSVpFOworCX0KKworCWlhX3ZhbGlkID0gYXR0ci0+aWFfdmFsaWQ7CisKKwlpZiAo
KGlhX3ZhbGlkICYgKEFUVFJfTVRJTUVfU0VUIHwgQVRUUl9BVElNRV9TRVQgfCBBVFRSX1RJTUVT
X1NFVCkpCisJCSYmIGV4ZmF0X2FsbG93X3NldF90aW1lKHNiaSwgaW5vZGUpKSB7CisJCWF0dHIt
PmlhX3ZhbGlkICY9IH4oQVRUUl9NVElNRV9TRVQgfAorCQkJCSAgICBBVFRSX0FUSU1FX1NFVCB8
CisJCQkJICAgIEFUVFJfVElNRVNfU0VUKTsKKwl9CisKKwllcnJvciA9IHNldGF0dHJfcHJlcGFy
ZShkZW50cnksIGF0dHIpOworCWF0dHItPmlhX3ZhbGlkID0gaWFfdmFsaWQ7CisJaWYgKGVycm9y
KQorCQlyZXR1cm4gZXJyb3I7CisKKwlpZiAoKChhdHRyLT5pYV92YWxpZCAmIEFUVFJfVUlEKSAm
JgorCSAgICAgKCF1aWRfZXEoYXR0ci0+aWFfdWlkLCBzYmktPm9wdGlvbnMuZnNfdWlkKSkpIHx8
CisJICAgICgoYXR0ci0+aWFfdmFsaWQgJiBBVFRSX0dJRCkgJiYKKwkgICAgICghZ2lkX2VxKGF0
dHItPmlhX2dpZCwgc2JpLT5vcHRpb25zLmZzX2dpZCkpKSB8fAorCSAgICAoKGF0dHItPmlhX3Zh
bGlkICYgQVRUUl9NT0RFKSAmJgorCSAgICAgKGF0dHItPmlhX21vZGUgJiB+KFNfSUZSRUcgfCBT
X0lGTE5LIHwgU19JRkRJUiB8IDA3NzcpKSkpIHsKKwkJcmV0dXJuIC1FUEVSTTsKKwl9CisKKwkv
KgorCSAqIFdlIGRvbid0IHJldHVybiAtRVBFUk0gaGVyZS4gWWVzLCBzdHJhbmdlLCBidXQgdGhp
cyBpcyB0b28KKwkgKiBvbGQgYmVoYXZpb3IuCisJICovCisJaWYgKGF0dHItPmlhX3ZhbGlkICYg
QVRUUl9NT0RFKSB7CisJCWlmIChleGZhdF9zYW5pdGl6ZV9tb2RlKHNiaSwgaW5vZGUsICZhdHRy
LT5pYV9tb2RlKSA8IDApCisJCQlhdHRyLT5pYV92YWxpZCAmPSB+QVRUUl9NT0RFOworCX0KKwor
CUVYRkFUX0koaW5vZGUpLT5maWQuc2l6ZSA9IGlfc2l6ZV9yZWFkKGlub2RlKTsKKworCWlmIChh
dHRyLT5pYV92YWxpZCAmIEFUVFJfU0laRSkgeworCQlvbGRfc2l6ZSA9IGlfc2l6ZV9yZWFkKGlu
b2RlKTsKKwkJZG93bl93cml0ZSgmRVhGQVRfSShpbm9kZSktPnRydW5jYXRlX2xvY2spOworCQl0
cnVuY2F0ZV9zZXRzaXplKGlub2RlLCBhdHRyLT5pYV9zaXplKTsKKwkJZXhmYXRfdHJ1bmNhdGUo
aW5vZGUsIG9sZF9zaXplKTsKKwkJdXBfd3JpdGUoJkVYRkFUX0koaW5vZGUpLT50cnVuY2F0ZV9s
b2NrKTsKKwl9CisJc2V0YXR0cl9jb3B5KGlub2RlLCBhdHRyKTsKKwltYXJrX2lub2RlX2RpcnR5
KGlub2RlKTsKKworCXByX2RlYnVnKCIlcyBleGl0ZWRcbiIsIF9fZnVuY19fKTsKKwlyZXR1cm4g
ZXJyb3I7Cit9CisKK3N0YXRpYyBpbnQgZXhmYXRfZ2V0YXR0cihjb25zdCBzdHJ1Y3QgcGF0aCAq
cGF0aCwgc3RydWN0IGtzdGF0ICpzdGF0LAorCQkJIHUzMiByZXF1ZXN0X21hc2ssIHVuc2lnbmVk
IGludCBmbGFncykKK3sKKwlzdHJ1Y3QgaW5vZGUgKmlub2RlID0gcGF0aC0+ZGVudHJ5LT5kX2lu
b2RlOworCisJcHJfZGVidWcoIiVzIGVudGVyZWRcbiIsIF9fZnVuY19fKTsKKworCWdlbmVyaWNf
ZmlsbGF0dHIoaW5vZGUsIHN0YXQpOworCXN0YXQtPmJsa3NpemUgPSBFWEZBVF9TQihpbm9kZS0+
aV9zYiktPmZzX2luZm8uY2x1c3Rlcl9zaXplOworCisJcHJfZGVidWcoIiVzIGV4aXRlZFxuIiwg
X19mdW5jX18pOworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGlub2RlX29w
ZXJhdGlvbnMgZXhmYXRfZGlyX2lub2RlX29wZXJhdGlvbnMgPSB7CisJLmNyZWF0ZSAgICAgICAg
PSBleGZhdF9jcmVhdGUsCisJLmxvb2t1cCAgICAgICAgPSBleGZhdF9sb29rdXAsCisJLnVubGlu
ayAgICAgICAgPSBleGZhdF91bmxpbmssCisJLnN5bWxpbmsgICAgICAgPSBleGZhdF9zeW1saW5r
LAorCS5ta2RpciAgICAgICAgID0gZXhmYXRfbWtkaXIsCisJLnJtZGlyICAgICAgICAgPSBleGZh
dF9ybWRpciwKKwkucmVuYW1lICAgICAgICA9IGV4ZmF0X3JlbmFtZSwKKwkuc2V0YXR0ciAgICAg
ICA9IGV4ZmF0X3NldGF0dHIsCisJLmdldGF0dHIgICAgICAgPSBleGZhdF9nZXRhdHRyLAorfTsK
KworLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09Ki8KKy8qICBGaWxlIE9wZXJhdGlvbnMgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovCisvKj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0q
Lworc3RhdGljIGNvbnN0IGNoYXIgKmV4ZmF0X2dldF9saW5rKHN0cnVjdCBkZW50cnkgKmRlbnRy
eSwgc3RydWN0IGlub2RlICppbm9kZSwKKwkJCQkgIHN0cnVjdCBkZWxheWVkX2NhbGwgKmRvbmUp
Cit7CisJc3RydWN0IGV4ZmF0X2lub2RlX2luZm8gKmVpID0gRVhGQVRfSShpbm9kZSk7CisKKwlp
ZiAoZWktPnRhcmdldCAhPSBOVUxMKSB7CisJCWNoYXIgKmNvb2tpZSA9IGVpLT50YXJnZXQ7CisK
KwkJaWYgKGNvb2tpZSAhPSBOVUxMKQorCQkJcmV0dXJuIChjaGFyICopKGVpLT50YXJnZXQpOwor
CX0KKwlyZXR1cm4gTlVMTDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBpbm9kZV9vcGVyYXRp
b25zIGV4ZmF0X3N5bWxpbmtfaW5vZGVfb3BlcmF0aW9ucyA9IHsKKwkJLmdldF9saW5rID0gZXhm
YXRfZ2V0X2xpbmssCit9OworCitzdGF0aWMgaW50IGV4ZmF0X2ZpbGVfcmVsZWFzZShzdHJ1Y3Qg
aW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlscCkKK3sKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sg
KnNiID0gaW5vZGUtPmlfc2I7CisKKwlFWEZBVF9JKGlub2RlKS0+ZmlkLnNpemUgPSBpX3NpemVf
cmVhZChpbm9kZSk7CisJZmZzU3luY1ZvbChzYiwgZmFsc2UpOworCXJldHVybiAwOworfQorCitz
dGF0aWMgY29uc3Qgc3RydWN0IGZpbGVfb3BlcmF0aW9ucyBleGZhdF9maWxlX29wZXJhdGlvbnMg
PSB7CisJLmxsc2VlayAgICAgID0gZ2VuZXJpY19maWxlX2xsc2VlaywKKwkucmVhZF9pdGVyICAg
PSBnZW5lcmljX2ZpbGVfcmVhZF9pdGVyLAorCS53cml0ZV9pdGVyICA9IGdlbmVyaWNfZmlsZV93
cml0ZV9pdGVyLAorCS5tbWFwICAgICAgICA9IGdlbmVyaWNfZmlsZV9tbWFwLAorCS5yZWxlYXNl
ICAgICA9IGV4ZmF0X2ZpbGVfcmVsZWFzZSwKKwkudW5sb2NrZWRfaW9jdGwgID0gZXhmYXRfZ2Vu
ZXJpY19pb2N0bCwKKwkuZnN5bmMgICAgICAgPSBnZW5lcmljX2ZpbGVfZnN5bmMsCisJLnNwbGlj
ZV9yZWFkID0gZ2VuZXJpY19maWxlX3NwbGljZV9yZWFkLAorfTsKKworc3RhdGljIGNvbnN0IHN0
cnVjdCBpbm9kZV9vcGVyYXRpb25zIGV4ZmF0X2ZpbGVfaW5vZGVfb3BlcmF0aW9ucyA9IHsKKwku
c2V0YXR0ciAgICAgPSBleGZhdF9zZXRhdHRyLAorCS5nZXRhdHRyICAgICA9IGV4ZmF0X2dldGF0
dHIsCit9OworCisvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0qLworLyogIEFkZHJlc3MgU3BhY2UgT3BlcmF0aW9u
cyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KKy8qPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PSovCisKK3N0YXRpYyBpbnQgZXhmYXRfYm1hcChzdHJ1Y3QgaW5vZGUgKmlub2RlLCBz
ZWN0b3JfdCBzZWN0b3IsIHNlY3Rvcl90ICpwaHlzLAorCQkgICAgICB1bnNpZ25lZCBsb25nICpt
YXBwZWRfYmxvY2tzLCBpbnQgKmNyZWF0ZSkKK3sKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0g
aW5vZGUtPmlfc2I7CisJc3RydWN0IGV4ZmF0X3NiX2luZm8gKnNiaSA9IEVYRkFUX1NCKHNiKTsK
KwlzdHJ1Y3QgZnNfaW5mb190ICpwX2ZzID0gJihzYmktPmZzX2luZm8pOworCXN0cnVjdCBiZF9p
bmZvX3QgKnBfYmQgPSAmKHNiaS0+YmRfaW5mbyk7CisJY29uc3QgdW5zaWduZWQgbG9uZyBibG9j
a3NpemUgPSBzYi0+c19ibG9ja3NpemU7CisJY29uc3QgdW5zaWduZWQgY2hhciBibG9ja3NpemVf
Yml0cyA9IHNiLT5zX2Jsb2Nrc2l6ZV9iaXRzOworCXNlY3Rvcl90IGxhc3RfYmxvY2s7CisJaW50
IGVyciwgY2x1X29mZnNldCwgc2VjX29mZnNldDsKKwl1bnNpZ25lZCBpbnQgY2x1c3RlcjsKKwor
CSpwaHlzID0gMDsKKwkqbWFwcGVkX2Jsb2NrcyA9IDA7CisKKwlpZiAoKHBfZnMtPnZvbF90eXBl
ID09IEZBVDEyKSB8fCAocF9mcy0+dm9sX3R5cGUgPT0gRkFUMTYpKSB7CisJCWlmIChpbm9kZS0+
aV9pbm8gPT0gRVhGQVRfUk9PVF9JTk8pIHsKKwkJCWlmIChzZWN0b3IgPAorCQkJICAgIChwX2Zz
LT5kZW50cmllc19pbl9yb290ID4+CisJCQkgICAgIChwX2JkLT5zZWN0b3Jfc2l6ZV9iaXRzLURF
TlRSWV9TSVpFX0JJVFMpKSkgeworCQkJCSpwaHlzID0gc2VjdG9yICsgcF9mcy0+cm9vdF9zdGFy
dF9zZWN0b3I7CisJCQkJKm1hcHBlZF9ibG9ja3MgPSAxOworCQkJfQorCQkJcmV0dXJuIDA7CisJ
CX0KKwl9CisKKwlsYXN0X2Jsb2NrID0gKGlfc2l6ZV9yZWFkKGlub2RlKSArIChibG9ja3NpemUg
LSAxKSkgPj4gYmxvY2tzaXplX2JpdHM7CisJaWYgKHNlY3RvciA+PSBsYXN0X2Jsb2NrKSB7CisJ
CWlmICgqY3JlYXRlID09IDApCisJCQlyZXR1cm4gMDsKKwl9IGVsc2UgeworCQkqY3JlYXRlID0g
MDsKKwl9CisKKwkvKiBjbHVzdGVyIG9mZnNldCAqLworCWNsdV9vZmZzZXQgPSBzZWN0b3IgPj4g
cF9mcy0+c2VjdG9yc19wZXJfY2x1X2JpdHM7CisKKwkvKiBzZWN0b3Igb2Zmc2V0IGluIGNsdXN0
ZXIgKi8KKwlzZWNfb2Zmc2V0ID0gc2VjdG9yICYgKHBfZnMtPnNlY3RvcnNfcGVyX2NsdSAtIDEp
OworCisJRVhGQVRfSShpbm9kZSktPmZpZC5zaXplID0gaV9zaXplX3JlYWQoaW5vZGUpOworCisJ
ZXJyID0gZmZzTWFwQ2x1c3Rlcihpbm9kZSwgY2x1X29mZnNldCwgJmNsdXN0ZXIpOworCisJaWYg
KGVycikgeworCQlpZiAoZXJyID09IEZGU19GVUxMKQorCQkJcmV0dXJuIC1FTk9TUEM7CisJCWVs
c2UKKwkJCXJldHVybiAtRUlPOworCX0gZWxzZSBpZiAoY2x1c3RlciAhPSBDTFVTVEVSXzMyKH4w
KSkgeworCQkqcGh5cyA9IFNUQVJUX1NFQ1RPUihjbHVzdGVyKSArIHNlY19vZmZzZXQ7CisJCSpt
YXBwZWRfYmxvY2tzID0gcF9mcy0+c2VjdG9yc19wZXJfY2x1IC0gc2VjX29mZnNldDsKKwl9CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBleGZhdF9nZXRfYmxvY2soc3RydWN0IGlub2Rl
ICppbm9kZSwgc2VjdG9yX3QgaWJsb2NrLAorCQkJICAgc3RydWN0IGJ1ZmZlcl9oZWFkICpiaF9y
ZXN1bHQsIGludCBjcmVhdGUpCit7CisJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGlub2RlLT5p
X3NiOworCXVuc2lnbmVkIGxvbmcgbWF4X2Jsb2NrcyA9IGJoX3Jlc3VsdC0+Yl9zaXplID4+IGlu
b2RlLT5pX2Jsa2JpdHM7CisJaW50IGVycjsKKwl1bnNpZ25lZCBsb25nIG1hcHBlZF9ibG9ja3M7
CisJc2VjdG9yX3QgcGh5czsKKworCV9fbG9ja19zdXBlcihzYik7CisKKwllcnIgPSBleGZhdF9i
bWFwKGlub2RlLCBpYmxvY2ssICZwaHlzLCAmbWFwcGVkX2Jsb2NrcywgJmNyZWF0ZSk7CisJaWYg
KGVycikgeworCQlfX3VubG9ja19zdXBlcihzYik7CisJCXJldHVybiBlcnI7CisJfQorCisJaWYg
KHBoeXMpIHsKKwkJbWF4X2Jsb2NrcyA9IG1pbihtYXBwZWRfYmxvY2tzLCBtYXhfYmxvY2tzKTsK
KwkJaWYgKGNyZWF0ZSkgeworCQkJRVhGQVRfSShpbm9kZSktPm1tdV9wcml2YXRlICs9IG1heF9i
bG9ja3MgPDwKKwkJCQkJCQlzYi0+c19ibG9ja3NpemVfYml0czsKKwkJCXNldF9idWZmZXJfbmV3
KGJoX3Jlc3VsdCk7CisJCX0KKwkJbWFwX2JoKGJoX3Jlc3VsdCwgc2IsIHBoeXMpOworCX0KKwor
CWJoX3Jlc3VsdC0+Yl9zaXplID0gbWF4X2Jsb2NrcyA8PCBzYi0+c19ibG9ja3NpemVfYml0czsK
KwlfX3VubG9ja19zdXBlcihzYik7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBleGZh
dF9yZWFkcGFnZShzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IHBhZ2UgKnBhZ2UpCit7CisJcmV0
dXJuICBtcGFnZV9yZWFkcGFnZShwYWdlLCBleGZhdF9nZXRfYmxvY2spOworfQorCitzdGF0aWMg
aW50IGV4ZmF0X3JlYWRwYWdlcyhzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0IGFkZHJlc3Nfc3Bh
Y2UgKm1hcHBpbmcsCisJCQkgICBzdHJ1Y3QgbGlzdF9oZWFkICpwYWdlcywgdW5zaWduZWQgaW50
IG5yX3BhZ2VzKQoreworCXJldHVybiAgbXBhZ2VfcmVhZHBhZ2VzKG1hcHBpbmcsIHBhZ2VzLCBu
cl9wYWdlcywgZXhmYXRfZ2V0X2Jsb2NrKTsKK30KKworc3RhdGljIGludCBleGZhdF93cml0ZXBh
Z2Uoc3RydWN0IHBhZ2UgKnBhZ2UsIHN0cnVjdCB3cml0ZWJhY2tfY29udHJvbCAqd2JjKQorewor
CXJldHVybiBibG9ja193cml0ZV9mdWxsX3BhZ2UocGFnZSwgZXhmYXRfZ2V0X2Jsb2NrLCB3YmMp
OworfQorCitzdGF0aWMgaW50IGV4ZmF0X3dyaXRlcGFnZXMoc3RydWN0IGFkZHJlc3Nfc3BhY2Ug
Km1hcHBpbmcsCisJCQkgICAgc3RydWN0IHdyaXRlYmFja19jb250cm9sICp3YmMpCit7CisJcmV0
dXJuIG1wYWdlX3dyaXRlcGFnZXMobWFwcGluZywgd2JjLCBleGZhdF9nZXRfYmxvY2spOworfQor
CitzdGF0aWMgdm9pZCBleGZhdF93cml0ZV9mYWlsZWQoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1h
cHBpbmcsIGxvZmZfdCB0bykKK3sKKwlzdHJ1Y3QgaW5vZGUgKmlub2RlID0gbWFwcGluZy0+aG9z
dDsKKworCWlmICh0byA+IGlfc2l6ZV9yZWFkKGlub2RlKSkgeworCQl0cnVuY2F0ZV9wYWdlY2Fj
aGUoaW5vZGUsIGlfc2l6ZV9yZWFkKGlub2RlKSk7CisJCUVYRkFUX0koaW5vZGUpLT5maWQuc2l6
ZSA9IGlfc2l6ZV9yZWFkKGlub2RlKTsKKwkJZXhmYXRfdHJ1bmNhdGUoaW5vZGUsIGlfc2l6ZV9y
ZWFkKGlub2RlKSk7CisJfQorfQorCitzdGF0aWMgaW50IGV4ZmF0X3dyaXRlX2JlZ2luKHN0cnVj
dCBmaWxlICpmaWxlLCBzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZywKKwkJCSAgICAgbG9m
Zl90IHBvcywgdW5zaWduZWQgaW50IGxlbiwgdW5zaWduZWQgaW50IGZsYWdzLAorCQkJICAgICBz
dHJ1Y3QgcGFnZSAqKnBhZ2VwLCB2b2lkICoqZnNkYXRhKQoreworCWludCByZXQ7CisKKwkqcGFn
ZXAgPSBOVUxMOworCXJldCA9IGNvbnRfd3JpdGVfYmVnaW4oZmlsZSwgbWFwcGluZywgcG9zLCBs
ZW4sIGZsYWdzLCBwYWdlcCwgZnNkYXRhLAorCQkJICAgICAgIGV4ZmF0X2dldF9ibG9jaywKKwkJ
CSAgICAgICAmRVhGQVRfSShtYXBwaW5nLT5ob3N0KS0+bW11X3ByaXZhdGUpOworCisJaWYgKHJl
dCA8IDApCisJCWV4ZmF0X3dyaXRlX2ZhaWxlZChtYXBwaW5nLCBwb3MrbGVuKTsKKwlyZXR1cm4g
cmV0OworfQorCitzdGF0aWMgaW50IGV4ZmF0X3dyaXRlX2VuZChzdHJ1Y3QgZmlsZSAqZmlsZSwg
c3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcsCisJCQkgICBsb2ZmX3QgcG9zLCB1bnNpZ25l
ZCBpbnQgbGVuLCB1bnNpZ25lZCBpbnQgY29waWVkLAorCQkJICAgc3RydWN0IHBhZ2UgKnBhZ2Vw
LCB2b2lkICpmc2RhdGEpCit7CisJc3RydWN0IGlub2RlICppbm9kZSA9IG1hcHBpbmctPmhvc3Q7
CisJc3RydWN0IGZpbGVfaWRfdCAqZmlkID0gJihFWEZBVF9JKGlub2RlKS0+ZmlkKTsKKwlpbnQg
ZXJyOworCisJZXJyID0gZ2VuZXJpY193cml0ZV9lbmQoZmlsZSwgbWFwcGluZywgcG9zLCBsZW4s
IGNvcGllZCwgcGFnZXAsIGZzZGF0YSk7CisKKwlpZiAoZXJyIDwgbGVuKQorCQlleGZhdF93cml0
ZV9mYWlsZWQobWFwcGluZywgcG9zK2xlbik7CisKKwlpZiAoIShlcnIgPCAwKSAmJiAhKGZpZC0+
YXR0ciAmIEFUVFJfQVJDSElWRSkpIHsKKwkJaW5vZGUtPmlfbXRpbWUgPSBpbm9kZS0+aV9jdGlt
ZSA9IGN1cnJlbnRfdGltZShpbm9kZSk7CisJCWZpZC0+YXR0ciB8PSBBVFRSX0FSQ0hJVkU7CisJ
CW1hcmtfaW5vZGVfZGlydHkoaW5vZGUpOworCX0KKwlyZXR1cm4gZXJyOworfQorCitzdGF0aWMg
c3NpemVfdCBleGZhdF9kaXJlY3RfSU8oc3RydWN0IGtpb2NiICppb2NiLCBzdHJ1Y3QgaW92X2l0
ZXIgKml0ZXIpCit7CisJc3RydWN0IGlub2RlICppbm9kZSA9IGlvY2ItPmtpX2ZpbHAtPmZfbWFw
cGluZy0+aG9zdDsKKwlzdHJ1Y3QgYWRkcmVzc19zcGFjZSAqbWFwcGluZyA9IGlvY2ItPmtpX2Zp
bHAtPmZfbWFwcGluZzsKKwlzc2l6ZV90IHJldDsKKwlpbnQgcnc7CisKKwlydyA9IGlvdl9pdGVy
X3J3KGl0ZXIpOworCisJaWYgKHJ3ID09IFdSSVRFKSB7CisJCWlmIChFWEZBVF9JKGlub2RlKS0+
bW11X3ByaXZhdGUgPCBpb3ZfaXRlcl9jb3VudChpdGVyKSkKKwkJCXJldHVybiAwOworCX0KKwly
ZXQgPSBibG9ja2Rldl9kaXJlY3RfSU8oaW9jYiwgaW5vZGUsIGl0ZXIsIGV4ZmF0X2dldF9ibG9j
ayk7CisKKwlpZiAoKHJldCA8IDApICYmIChydyAmIFdSSVRFKSkKKwkJZXhmYXRfd3JpdGVfZmFp
bGVkKG1hcHBpbmcsIGlvdl9pdGVyX2NvdW50KGl0ZXIpKTsKKwlyZXR1cm4gcmV0OworfQorCitz
dGF0aWMgc2VjdG9yX3QgX2V4ZmF0X2JtYXAoc3RydWN0IGFkZHJlc3Nfc3BhY2UgKm1hcHBpbmcs
IHNlY3Rvcl90IGJsb2NrKQoreworCXNlY3Rvcl90IGJsb2NrbnI7CisKKwkvKiBleGZhdF9nZXRf
Y2x1c3RlcigpIGFzc3VtZXMgdGhlIHJlcXVlc3RlZCBibG9ja25yIGlzbid0IHRydW5jYXRlZC4g
Ki8KKwlkb3duX3JlYWQoJkVYRkFUX0kobWFwcGluZy0+aG9zdCktPnRydW5jYXRlX2xvY2spOwor
CWJsb2NrbnIgPSBnZW5lcmljX2Jsb2NrX2JtYXAobWFwcGluZywgYmxvY2ssIGV4ZmF0X2dldF9i
bG9jayk7CisJdXBfcmVhZCgmRVhGQVRfSShtYXBwaW5nLT5ob3N0KS0+dHJ1bmNhdGVfbG9jayk7
CisKKwlyZXR1cm4gYmxvY2tucjsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBhZGRyZXNzX3Nw
YWNlX29wZXJhdGlvbnMgZXhmYXRfYW9wcyA9IHsKKwkucmVhZHBhZ2UgICAgPSBleGZhdF9yZWFk
cGFnZSwKKwkucmVhZHBhZ2VzICAgPSBleGZhdF9yZWFkcGFnZXMsCisJLndyaXRlcGFnZSAgID0g
ZXhmYXRfd3JpdGVwYWdlLAorCS53cml0ZXBhZ2VzICA9IGV4ZmF0X3dyaXRlcGFnZXMsCisJLndy
aXRlX2JlZ2luID0gZXhmYXRfd3JpdGVfYmVnaW4sCisJLndyaXRlX2VuZCAgID0gZXhmYXRfd3Jp
dGVfZW5kLAorCS5kaXJlY3RfSU8gICA9IGV4ZmF0X2RpcmVjdF9JTywKKwkuYm1hcCAgICAgICAg
PSBfZXhmYXRfYm1hcAorfTsKKworLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KKy8qICBTdXBlciBPcGVyYXRp
b25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICov
CisvKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0qLworCitzdGF0aWMgc3RydWN0IGlub2RlICpleGZhdF9pZ2V0KHN0
cnVjdCBzdXBlcl9ibG9jayAqc2IsIGxvZmZfdCBpX3BvcykKK3sKKwlzdHJ1Y3QgZXhmYXRfc2Jf
aW5mbyAqc2JpID0gRVhGQVRfU0Ioc2IpOworCXN0cnVjdCBleGZhdF9pbm9kZV9pbmZvICppbmZv
OworCXN0cnVjdCBobGlzdF9oZWFkICpoZWFkID0gc2JpLT5pbm9kZV9oYXNodGFibGUgKyBleGZh
dF9oYXNoKGlfcG9zKTsKKwlzdHJ1Y3QgaW5vZGUgKmlub2RlID0gTlVMTDsKKworCXNwaW5fbG9j
aygmc2JpLT5pbm9kZV9oYXNoX2xvY2spOworCWhsaXN0X2Zvcl9lYWNoX2VudHJ5KGluZm8sIGhl
YWQsIGlfaGFzaF9mYXQpIHsKKwkJQlVHX09OKGluZm8tPnZmc19pbm9kZS5pX3NiICE9IHNiKTsK
KworCQlpZiAoaV9wb3MgIT0gaW5mby0+aV9wb3MpCisJCQljb250aW51ZTsKKwkJaW5vZGUgPSBp
Z3JhYigmaW5mby0+dmZzX2lub2RlKTsKKwkJaWYgKGlub2RlKQorCQkJYnJlYWs7CisJfQorCXNw
aW5fdW5sb2NrKCZzYmktPmlub2RlX2hhc2hfbG9jayk7CisJcmV0dXJuIGlub2RlOworfQorCisv
KiBkb2Vzbid0IGRlYWwgd2l0aCByb290IGlub2RlICovCitzdGF0aWMgaW50IGV4ZmF0X2ZpbGxf
aW5vZGUoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGVfaWRfdCAqZmlkKQoreworCXN0
cnVjdCBleGZhdF9zYl9pbmZvICpzYmkgPSBFWEZBVF9TQihpbm9kZS0+aV9zYik7CisJc3RydWN0
IGZzX2luZm9fdCAqcF9mcyA9ICYoc2JpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgZGlyX2VudHJ5X3Qg
aW5mbzsKKworCW1lbWNweSgmKEVYRkFUX0koaW5vZGUpLT5maWQpLCBmaWQsIHNpemVvZihzdHJ1
Y3QgZmlsZV9pZF90KSk7CisKKwlmZnNSZWFkU3RhdChpbm9kZSwgJmluZm8pOworCisJRVhGQVRf
SShpbm9kZSktPmlfcG9zID0gMDsKKwlFWEZBVF9JKGlub2RlKS0+dGFyZ2V0ID0gTlVMTDsKKwlp
bm9kZS0+aV91aWQgPSBzYmktPm9wdGlvbnMuZnNfdWlkOworCWlub2RlLT5pX2dpZCA9IHNiaS0+
b3B0aW9ucy5mc19naWQ7CisJSU5DX0lWRVJTSU9OKGlub2RlKTsKKwlpbm9kZS0+aV9nZW5lcmF0
aW9uID0gZ2V0X3NlY29uZHMoKTsKKworCWlmIChpbmZvLkF0dHIgJiBBVFRSX1NVQkRJUikgeyAv
KiBkaXJlY3RvcnkgKi8KKwkJaW5vZGUtPmlfZ2VuZXJhdGlvbiAmPSB+MTsKKwkJaW5vZGUtPmlf
bW9kZSA9IGV4ZmF0X21ha2VfbW9kZShzYmksIGluZm8uQXR0ciwgMDc3Nyk7CisJCWlub2RlLT5p
X29wID0gJmV4ZmF0X2Rpcl9pbm9kZV9vcGVyYXRpb25zOworCQlpbm9kZS0+aV9mb3AgPSAmZXhm
YXRfZGlyX29wZXJhdGlvbnM7CisKKwkJaV9zaXplX3dyaXRlKGlub2RlLCBpbmZvLlNpemUpOwor
CQlFWEZBVF9JKGlub2RlKS0+bW11X3ByaXZhdGUgPSBpX3NpemVfcmVhZChpbm9kZSk7CisJCXNl
dF9ubGluayhpbm9kZSwgaW5mby5OdW1TdWJkaXJzKTsKKwl9IGVsc2UgaWYgKGluZm8uQXR0ciAm
IEFUVFJfU1lNTElOSykgeyAvKiBzeW1ib2xpYyBsaW5rICovCisJCWlub2RlLT5pX2dlbmVyYXRp
b24gfD0gMTsKKwkJaW5vZGUtPmlfbW9kZSA9IGV4ZmF0X21ha2VfbW9kZShzYmksIGluZm8uQXR0
ciwgMDc3Nyk7CisJCWlub2RlLT5pX29wID0gJmV4ZmF0X3N5bWxpbmtfaW5vZGVfb3BlcmF0aW9u
czsKKworCQlpX3NpemVfd3JpdGUoaW5vZGUsIGluZm8uU2l6ZSk7CisJCUVYRkFUX0koaW5vZGUp
LT5tbXVfcHJpdmF0ZSA9IGlfc2l6ZV9yZWFkKGlub2RlKTsKKwl9IGVsc2UgeyAvKiByZWd1bGFy
IGZpbGUgKi8KKwkJaW5vZGUtPmlfZ2VuZXJhdGlvbiB8PSAxOworCQlpbm9kZS0+aV9tb2RlID0g
ZXhmYXRfbWFrZV9tb2RlKHNiaSwgaW5mby5BdHRyLCAwNzc3KTsKKwkJaW5vZGUtPmlfb3AgPSAm
ZXhmYXRfZmlsZV9pbm9kZV9vcGVyYXRpb25zOworCQlpbm9kZS0+aV9mb3AgPSAmZXhmYXRfZmls
ZV9vcGVyYXRpb25zOworCQlpbm9kZS0+aV9tYXBwaW5nLT5hX29wcyA9ICZleGZhdF9hb3BzOwor
CQlpbm9kZS0+aV9tYXBwaW5nLT5ucnBhZ2VzID0gMDsKKworCQlpX3NpemVfd3JpdGUoaW5vZGUs
IGluZm8uU2l6ZSk7CisJCUVYRkFUX0koaW5vZGUpLT5tbXVfcHJpdmF0ZSA9IGlfc2l6ZV9yZWFk
KGlub2RlKTsKKwl9CisJZXhmYXRfc2F2ZV9hdHRyKGlub2RlLCBpbmZvLkF0dHIpOworCisJaW5v
ZGUtPmlfYmxvY2tzID0gKChpX3NpemVfcmVhZChpbm9kZSkgKyAocF9mcy0+Y2x1c3Rlcl9zaXpl
IC0gMSkpCisJCQkJJiB+KChsb2ZmX3QpcF9mcy0+Y2x1c3Rlcl9zaXplIC0gMSkpID4+IDk7CisK
KwlleGZhdF90aW1lX2ZhdDJ1bml4KHNiaSwgJmlub2RlLT5pX210aW1lLCAmaW5mby5Nb2RpZnlU
aW1lc3RhbXApOworCWV4ZmF0X3RpbWVfZmF0MnVuaXgoc2JpLCAmaW5vZGUtPmlfY3RpbWUsICZp
bmZvLkNyZWF0ZVRpbWVzdGFtcCk7CisJZXhmYXRfdGltZV9mYXQydW5peChzYmksICZpbm9kZS0+
aV9hdGltZSwgJmluZm8uQWNjZXNzVGltZXN0YW1wKTsKKworCXJldHVybiAwOworfQorCitzdGF0
aWMgc3RydWN0IGlub2RlICpleGZhdF9idWlsZF9pbm9kZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
LAorCQkJCSAgICAgICBzdHJ1Y3QgZmlsZV9pZF90ICpmaWQsIGxvZmZfdCBpX3BvcykKK3sKKwlz
dHJ1Y3QgaW5vZGUgKmlub2RlOworCWludCBlcnI7CisKKwlpbm9kZSA9IGV4ZmF0X2lnZXQoc2Is
IGlfcG9zKTsKKwlpZiAoaW5vZGUpCisJCWdvdG8gb3V0OworCWlub2RlID0gbmV3X2lub2RlKHNi
KTsKKwlpZiAoIWlub2RlKSB7CisJCWlub2RlID0gRVJSX1BUUigtRU5PTUVNKTsKKwkJZ290byBv
dXQ7CisJfQorCWlub2RlLT5pX2lubyA9IGl1bmlxdWUoc2IsIEVYRkFUX1JPT1RfSU5PKTsKKwlT
RVRfSVZFUlNJT04oaW5vZGUsIDEpOworCWVyciA9IGV4ZmF0X2ZpbGxfaW5vZGUoaW5vZGUsIGZp
ZCk7CisJaWYgKGVycikgeworCQlpcHV0KGlub2RlKTsKKwkJaW5vZGUgPSBFUlJfUFRSKGVycik7
CisJCWdvdG8gb3V0OworCX0KKwlleGZhdF9hdHRhY2goaW5vZGUsIGlfcG9zKTsKKwlpbnNlcnRf
aW5vZGVfaGFzaChpbm9kZSk7CitvdXQ6CisJcmV0dXJuIGlub2RlOworfQorCitzdGF0aWMgaW50
IGV4ZmF0X3N5bmNfaW5vZGUoc3RydWN0IGlub2RlICppbm9kZSkKK3sKKwlyZXR1cm4gZXhmYXRf
d3JpdGVfaW5vZGUoaW5vZGUsIE5VTEwpOworfQorCitzdGF0aWMgc3RydWN0IGlub2RlICpleGZh
dF9hbGxvY19pbm9kZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQoreworCXN0cnVjdCBleGZhdF9p
bm9kZV9pbmZvICplaTsKKworCWVpID0ga21lbV9jYWNoZV9hbGxvYyhleGZhdF9pbm9kZV9jYWNo
ZXAsIEdGUF9OT0ZTKTsKKwlpZiAoIWVpKQorCQlyZXR1cm4gTlVMTDsKKworCWluaXRfcndzZW0o
JmVpLT50cnVuY2F0ZV9sb2NrKTsKKworCXJldHVybiAmZWktPnZmc19pbm9kZTsKK30KKworc3Rh
dGljIHZvaWQgZXhmYXRfZGVzdHJveV9pbm9kZShzdHJ1Y3QgaW5vZGUgKmlub2RlKQoreworCWlm
IChFWEZBVF9JKGlub2RlKS0+dGFyZ2V0KQorCQlrZnJlZShFWEZBVF9JKGlub2RlKS0+dGFyZ2V0
KTsKKwlFWEZBVF9JKGlub2RlKS0+dGFyZ2V0ID0gTlVMTDsKKworCWttZW1fY2FjaGVfZnJlZShl
eGZhdF9pbm9kZV9jYWNoZXAsIEVYRkFUX0koaW5vZGUpKTsKK30KKworc3RhdGljIGludCBleGZh
dF93cml0ZV9pbm9kZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3Qgd3JpdGViYWNrX2NvbnRy
b2wgKndiYykKK3sKKwlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiID0gaW5vZGUtPmlfc2I7CisJc3Ry
dWN0IGV4ZmF0X3NiX2luZm8gKnNiaSA9IEVYRkFUX1NCKHNiKTsKKwlzdHJ1Y3QgZGlyX2VudHJ5
X3QgaW5mbzsKKworCWlmIChpbm9kZS0+aV9pbm8gPT0gRVhGQVRfUk9PVF9JTk8pCisJCXJldHVy
biAwOworCisJaW5mby5BdHRyID0gZXhmYXRfbWFrZV9hdHRyKGlub2RlKTsKKwlpbmZvLlNpemUg
PSBpX3NpemVfcmVhZChpbm9kZSk7CisKKwlleGZhdF90aW1lX3VuaXgyZmF0KHNiaSwgJmlub2Rl
LT5pX210aW1lLCAmaW5mby5Nb2RpZnlUaW1lc3RhbXApOworCWV4ZmF0X3RpbWVfdW5peDJmYXQo
c2JpLCAmaW5vZGUtPmlfY3RpbWUsICZpbmZvLkNyZWF0ZVRpbWVzdGFtcCk7CisJZXhmYXRfdGlt
ZV91bml4MmZhdChzYmksICZpbm9kZS0+aV9hdGltZSwgJmluZm8uQWNjZXNzVGltZXN0YW1wKTsK
KworCWZmc1dyaXRlU3RhdChpbm9kZSwgJmluZm8pOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyB2b2lkIGV4ZmF0X2V2aWN0X2lub2RlKHN0cnVjdCBpbm9kZSAqaW5vZGUpCit7CisJdHJ1bmNh
dGVfaW5vZGVfcGFnZXMoJmlub2RlLT5pX2RhdGEsIDApOworCisJaWYgKCFpbm9kZS0+aV9ubGlu
aykKKwkJaV9zaXplX3dyaXRlKGlub2RlLCAwKTsKKwlpbnZhbGlkYXRlX2lub2RlX2J1ZmZlcnMo
aW5vZGUpOworCWNsZWFyX2lub2RlKGlub2RlKTsKKwlleGZhdF9kZXRhY2goaW5vZGUpOworCisJ
cmVtb3ZlX2lub2RlX2hhc2goaW5vZGUpOworfQorCitzdGF0aWMgdm9pZCBleGZhdF9mcmVlX3N1
cGVyKHN0cnVjdCBleGZhdF9zYl9pbmZvICpzYmkpCit7CisJaWYgKHNiaS0+bmxzX2Rpc2spCisJ
CXVubG9hZF9ubHMoc2JpLT5ubHNfZGlzayk7CisJaWYgKHNiaS0+bmxzX2lvKQorCQl1bmxvYWRf
bmxzKHNiaS0+bmxzX2lvKTsKKwlpZiAoc2JpLT5vcHRpb25zLmlvY2hhcnNldCAhPSBleGZhdF9k
ZWZhdWx0X2lvY2hhcnNldCkKKwkJa2ZyZWUoc2JpLT5vcHRpb25zLmlvY2hhcnNldCk7CisJLyog
bXV0ZXhfaW5pdCBpcyBpbiBleGZhdF9maWxsX3N1cGVyIGZ1bmN0aW9uLiBvbmx5IGZvciAzLjcr
ICovCisJbXV0ZXhfZGVzdHJveSgmc2JpLT5zX2xvY2spOworCWtmcmVlKHNiaSk7Cit9CisKK3N0
YXRpYyB2b2lkIGV4ZmF0X3B1dF9zdXBlcihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiKQoreworCXN0
cnVjdCBleGZhdF9zYl9pbmZvICpzYmkgPSBFWEZBVF9TQihzYik7CisKKwlpZiAoX19pc19zYl9k
aXJ0eShzYikpCisJCWV4ZmF0X3dyaXRlX3N1cGVyKHNiKTsKKworCWZmc1Vtb3VudFZvbChzYik7
CisKKwlzYi0+c19mc19pbmZvID0gTlVMTDsKKwlleGZhdF9mcmVlX3N1cGVyKHNiaSk7Cit9CisK
K3N0YXRpYyB2b2lkIGV4ZmF0X3dyaXRlX3N1cGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCit7
CisJX19sb2NrX3N1cGVyKHNiKTsKKworCV9fc2V0X3NiX2NsZWFuKHNiKTsKKworCWlmICghc2Jf
cmRvbmx5KHNiKSkKKwkJZmZzU3luY1ZvbChzYiwgdHJ1ZSk7CisKKwlfX3VubG9ja19zdXBlcihz
Yik7Cit9CisKK3N0YXRpYyBpbnQgZXhmYXRfc3luY19mcyhzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
LCBpbnQgd2FpdCkKK3sKKwlpbnQgZXJyID0gMDsKKworCWlmIChfX2lzX3NiX2RpcnR5KHNiKSkg
eworCQlfX2xvY2tfc3VwZXIoc2IpOworCQlfX3NldF9zYl9jbGVhbihzYik7CisJCWVyciA9IGZm
c1N5bmNWb2woc2IsIHRydWUpOworCQlfX3VubG9ja19zdXBlcihzYik7CisJfQorCisJcmV0dXJu
IGVycjsKK30KKworc3RhdGljIGludCBleGZhdF9zdGF0ZnMoc3RydWN0IGRlbnRyeSAqZGVudHJ5
LCBzdHJ1Y3Qga3N0YXRmcyAqYnVmKQoreworCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IgPSBkZW50
cnktPmRfc2I7CisJdTY0IGlkID0gaHVnZV9lbmNvZGVfZGV2KHNiLT5zX2JkZXYtPmJkX2Rldik7
CisJc3RydWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoRVhGQVRfU0Ioc2IpLT5mc19pbmZvKTsKKwlz
dHJ1Y3Qgdm9sX2luZm9fdCBpbmZvOworCisJaWYgKHBfZnMtPnVzZWRfY2x1c3RlcnMgPT0gKHUz
MikgfjApIHsKKwkJaWYgKGZmc0dldFZvbEluZm8oc2IsICZpbmZvKSA9PSBGRlNfTUVESUFFUlIp
CisJCQlyZXR1cm4gLUVJTzsKKworCX0gZWxzZSB7CisJCWluZm8uRmF0VHlwZSA9IHBfZnMtPnZv
bF90eXBlOworCQlpbmZvLkNsdXN0ZXJTaXplID0gcF9mcy0+Y2x1c3Rlcl9zaXplOworCQlpbmZv
Lk51bUNsdXN0ZXJzID0gcF9mcy0+bnVtX2NsdXN0ZXJzIC0gMjsKKwkJaW5mby5Vc2VkQ2x1c3Rl
cnMgPSBwX2ZzLT51c2VkX2NsdXN0ZXJzOworCQlpbmZvLkZyZWVDbHVzdGVycyA9IGluZm8uTnVt
Q2x1c3RlcnMgLSBpbmZvLlVzZWRDbHVzdGVyczsKKworCQlpZiAocF9mcy0+ZGV2X2VqZWN0ZWQp
CisJCQlwcl9pbmZvKCJbRVhGQVRdIHN0YXRmcyBvbiBkZXZpY2UgdGhhdCBpcyBlamVjdGVkXG4i
KTsKKwl9CisKKwlidWYtPmZfdHlwZSA9IHNiLT5zX21hZ2ljOworCWJ1Zi0+Zl9ic2l6ZSA9IGlu
Zm8uQ2x1c3RlclNpemU7CisJYnVmLT5mX2Jsb2NrcyA9IGluZm8uTnVtQ2x1c3RlcnM7CisJYnVm
LT5mX2JmcmVlID0gaW5mby5GcmVlQ2x1c3RlcnM7CisJYnVmLT5mX2JhdmFpbCA9IGluZm8uRnJl
ZUNsdXN0ZXJzOworCWJ1Zi0+Zl9mc2lkLnZhbFswXSA9ICh1MzIpaWQ7CisJYnVmLT5mX2ZzaWQu
dmFsWzFdID0gKHUzMikoaWQgPj4gMzIpOworCWJ1Zi0+Zl9uYW1lbGVuID0gMjYwOworCisJcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZXhmYXRfcmVtb3VudChzdHJ1Y3Qgc3VwZXJfYmxvY2sg
KnNiLCBpbnQgKmZsYWdzLCBjaGFyICpkYXRhKQoreworCSpmbGFncyB8PSBTQl9OT0RJUkFUSU1F
OworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGV4ZmF0X3Nob3dfb3B0aW9ucyhzdHJ1Y3Qg
c2VxX2ZpbGUgKm0sIHN0cnVjdCBkZW50cnkgKnJvb3QpCit7CisJc3RydWN0IGV4ZmF0X3NiX2lu
Zm8gKnNiaSA9IEVYRkFUX1NCKHJvb3QtPmRfc2IpOworCXN0cnVjdCBleGZhdF9tb3VudF9vcHRp
b25zICpvcHRzID0gJnNiaS0+b3B0aW9uczsKKworCWlmIChfX2t1aWRfdmFsKG9wdHMtPmZzX3Vp
ZCkpCisJCXNlcV9wcmludGYobSwgIix1aWQ9JXUiLCBfX2t1aWRfdmFsKG9wdHMtPmZzX3VpZCkp
OworCWlmIChfX2tnaWRfdmFsKG9wdHMtPmZzX2dpZCkpCisJCXNlcV9wcmludGYobSwgIixnaWQ9
JXUiLCBfX2tnaWRfdmFsKG9wdHMtPmZzX2dpZCkpOworCXNlcV9wcmludGYobSwgIixmbWFzaz0l
MDRvIiwgb3B0cy0+ZnNfZm1hc2spOworCXNlcV9wcmludGYobSwgIixkbWFzaz0lMDRvIiwgb3B0
cy0+ZnNfZG1hc2spOworCWlmIChvcHRzLT5hbGxvd191dGltZSkKKwkJc2VxX3ByaW50ZihtLCAi
LGFsbG93X3V0aW1lPSUwNG8iLCBvcHRzLT5hbGxvd191dGltZSk7CisJaWYgKHNiaS0+bmxzX2Rp
c2spCisJCXNlcV9wcmludGYobSwgIixjb2RlcGFnZT0lcyIsIHNiaS0+bmxzX2Rpc2stPmNoYXJz
ZXQpOworCWlmIChzYmktPm5sc19pbykKKwkJc2VxX3ByaW50ZihtLCAiLGlvY2hhcnNldD0lcyIs
IHNiaS0+bmxzX2lvLT5jaGFyc2V0KTsKKwlzZXFfcHJpbnRmKG0sICIsbmFtZWNhc2U9JXUiLCBv
cHRzLT5jYXNlc2Vuc2l0aXZlKTsKKwlpZiAob3B0cy0+ZXJyb3JzID09IEVYRkFUX0VSUk9SU19D
T05UKQorCQlzZXFfcHV0cyhtLCAiLGVycm9ycz1jb250aW51ZSIpOworCWVsc2UgaWYgKG9wdHMt
PmVycm9ycyA9PSBFWEZBVF9FUlJPUlNfUEFOSUMpCisJCXNlcV9wdXRzKG0sICIsZXJyb3JzPXBh
bmljIik7CisJZWxzZQorCQlzZXFfcHV0cyhtLCAiLGVycm9ycz1yZW1vdW50LXJvIik7CisjaWZk
ZWYgQ09ORklHX0VYRkFUX0RJU0NBUkQKKwlpZiAob3B0cy0+ZGlzY2FyZCkKKwkJc2VxX3B1dHMo
bSwgIixkaXNjYXJkIik7CisjZW5kaWYKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0
cnVjdCBzdXBlcl9vcGVyYXRpb25zIGV4ZmF0X3NvcHMgPSB7CisJLmFsbG9jX2lub2RlICAgPSBl
eGZhdF9hbGxvY19pbm9kZSwKKwkuZGVzdHJveV9pbm9kZSA9IGV4ZmF0X2Rlc3Ryb3lfaW5vZGUs
CisJLndyaXRlX2lub2RlICAgPSBleGZhdF93cml0ZV9pbm9kZSwKKwkuZXZpY3RfaW5vZGUgID0g
ZXhmYXRfZXZpY3RfaW5vZGUsCisJLnB1dF9zdXBlciAgICAgPSBleGZhdF9wdXRfc3VwZXIsCisJ
LnN5bmNfZnMgICAgICAgPSBleGZhdF9zeW5jX2ZzLAorCS5zdGF0ZnMgICAgICAgID0gZXhmYXRf
c3RhdGZzLAorCS5yZW1vdW50X2ZzICAgID0gZXhmYXRfcmVtb3VudCwKKwkuc2hvd19vcHRpb25z
ICA9IGV4ZmF0X3Nob3dfb3B0aW9ucywKK307CisKKy8qPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCisvKiAgRXhw
b3J0IE9wZXJhdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAqLworLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KKworc3RhdGljIHN0cnVjdCBpbm9kZSAqZXhm
YXRfbmZzX2dldF9pbm9kZShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCB1NjQgaW5vLAorCQkJCQkg
dTMyIGdlbmVyYXRpb24pCit7CisJc3RydWN0IGlub2RlICppbm9kZSA9IE5VTEw7CisKKwlpZiAo
aW5vIDwgRVhGQVRfUk9PVF9JTk8pCisJCXJldHVybiBpbm9kZTsKKwlpbm9kZSA9IGlsb29rdXAo
c2IsIGlubyk7CisKKwlpZiAoaW5vZGUgJiYgZ2VuZXJhdGlvbiAmJiAoaW5vZGUtPmlfZ2VuZXJh
dGlvbiAhPSBnZW5lcmF0aW9uKSkgeworCQlpcHV0KGlub2RlKTsKKwkJaW5vZGUgPSBOVUxMOwor
CX0KKworCXJldHVybiBpbm9kZTsKK30KKworc3RhdGljIHN0cnVjdCBkZW50cnkgKmV4ZmF0X2Zo
X3RvX2RlbnRyeShzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJCQkgc3RydWN0IGZpZCAqZmlk
LCBpbnQgZmhfbGVuLAorCQkJCQkgaW50IGZoX3R5cGUpCit7CisJcmV0dXJuIGdlbmVyaWNfZmhf
dG9fZGVudHJ5KHNiLCBmaWQsIGZoX2xlbiwgZmhfdHlwZSwKKwkJCQlleGZhdF9uZnNfZ2V0X2lu
b2RlKTsKK30KKworc3RhdGljIHN0cnVjdCBkZW50cnkgKmV4ZmF0X2ZoX3RvX3BhcmVudChzdHJ1
Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJCQkgc3RydWN0IGZpZCAqZmlkLCBpbnQgZmhfbGVuLAor
CQkJCQkgaW50IGZoX3R5cGUpCit7CisJcmV0dXJuIGdlbmVyaWNfZmhfdG9fcGFyZW50KHNiLCBm
aWQsIGZoX2xlbiwgZmhfdHlwZSwKKwkJCQlleGZhdF9uZnNfZ2V0X2lub2RlKTsKK30KKworc3Rh
dGljIGNvbnN0IHN0cnVjdCBleHBvcnRfb3BlcmF0aW9ucyBleGZhdF9leHBvcnRfb3BzID0gewor
CS5maF90b19kZW50cnkgICA9IGV4ZmF0X2ZoX3RvX2RlbnRyeSwKKwkuZmhfdG9fcGFyZW50ICAg
PSBleGZhdF9maF90b19wYXJlbnQsCit9OworCisvKj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qLworLyogIFN1cGVy
IEJsb2NrIFJlYWQgT3BlcmF0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKi8KKy8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PSovCisKK2VudW0geworCU9wdF91aWQsCisJT3B0X2dp
ZCwKKwlPcHRfdW1hc2ssCisJT3B0X2RtYXNrLAorCU9wdF9mbWFzaywKKwlPcHRfYWxsb3dfdXRp
bWUsCisJT3B0X2NvZGVwYWdlLAorCU9wdF9jaGFyc2V0LAorCU9wdF9uYW1lY2FzZSwKKwlPcHRf
ZGVidWcsCisJT3B0X2Vycl9jb250LAorCU9wdF9lcnJfcGFuaWMsCisJT3B0X2Vycl9ybywKKwlP
cHRfdXRmOF9oYWNrLAorCU9wdF9lcnIsCisjaWZkZWYgQ09ORklHX0VYRkFUX0RJU0NBUkQKKwlP
cHRfZGlzY2FyZCwKKyNlbmRpZiAvKiBFWEZBVF9DT05GSUdfRElTQ0FSRCAqLworfTsKKworc3Rh
dGljIGNvbnN0IG1hdGNoX3RhYmxlX3QgZXhmYXRfdG9rZW5zID0geworCXtPcHRfdWlkLCAidWlk
PSV1In0sCisJe09wdF9naWQsICJnaWQ9JXUifSwKKwl7T3B0X3VtYXNrLCAidW1hc2s9JW8ifSwK
Kwl7T3B0X2RtYXNrLCAiZG1hc2s9JW8ifSwKKwl7T3B0X2ZtYXNrLCAiZm1hc2s9JW8ifSwKKwl7
T3B0X2FsbG93X3V0aW1lLCAiYWxsb3dfdXRpbWU9JW8ifSwKKwl7T3B0X2NvZGVwYWdlLCAiY29k
ZXBhZ2U9JXUifSwKKwl7T3B0X2NoYXJzZXQsICJpb2NoYXJzZXQ9JXMifSwKKwl7T3B0X25hbWVj
YXNlLCAibmFtZWNhc2U9JXUifSwKKwl7T3B0X2RlYnVnLCAiZGVidWcifSwKKwl7T3B0X2Vycl9j
b250LCAiZXJyb3JzPWNvbnRpbnVlIn0sCisJe09wdF9lcnJfcGFuaWMsICJlcnJvcnM9cGFuaWMi
fSwKKwl7T3B0X2Vycl9ybywgImVycm9ycz1yZW1vdW50LXJvIn0sCisJe09wdF91dGY4X2hhY2ss
ICJ1dGY4In0sCisjaWZkZWYgQ09ORklHX0VYRkFUX0RJU0NBUkQKKwl7T3B0X2Rpc2NhcmQsICJk
aXNjYXJkIn0sCisjZW5kaWYgLyogQ09ORklHX0VYRkFUX0RJU0NBUkQgKi8KKwl7T3B0X2Vyciwg
TlVMTH0KK307CisKK3N0YXRpYyBpbnQgcGFyc2Vfb3B0aW9ucyhjaGFyICpvcHRpb25zLCBpbnQg
c2lsZW50LCBpbnQgKmRlYnVnLAorCQkJIHN0cnVjdCBleGZhdF9tb3VudF9vcHRpb25zICpvcHRz
KQoreworCWNoYXIgKnA7CisJc3Vic3RyaW5nX3QgYXJnc1tNQVhfT1BUX0FSR1NdOworCWludCBv
cHRpb247CisJY2hhciAqaW9jaGFyc2V0OworCisJb3B0cy0+ZnNfdWlkID0gY3VycmVudF91aWQo
KTsKKwlvcHRzLT5mc19naWQgPSBjdXJyZW50X2dpZCgpOworCW9wdHMtPmZzX2ZtYXNrID0gb3B0
cy0+ZnNfZG1hc2sgPSBjdXJyZW50LT5mcy0+dW1hc2s7CisJb3B0cy0+YWxsb3dfdXRpbWUgPSAo
dW5zaWduZWQgc2hvcnQpIC0xOworCW9wdHMtPmNvZGVwYWdlID0gZXhmYXRfZGVmYXVsdF9jb2Rl
cGFnZTsKKwlvcHRzLT5pb2NoYXJzZXQgPSBleGZhdF9kZWZhdWx0X2lvY2hhcnNldDsKKwlvcHRz
LT5jYXNlc2Vuc2l0aXZlID0gMDsKKwlvcHRzLT5lcnJvcnMgPSBFWEZBVF9FUlJPUlNfUk87Cisj
aWZkZWYgQ09ORklHX0VYRkFUX0RJU0NBUkQKKwlvcHRzLT5kaXNjYXJkID0gMDsKKyNlbmRpZgor
CSpkZWJ1ZyA9IDA7CisKKwlpZiAoIW9wdGlvbnMpCisJCWdvdG8gb3V0OworCisJd2hpbGUgKChw
ID0gc3Ryc2VwKCZvcHRpb25zLCAiLCIpKSAhPSBOVUxMKSB7CisJCWludCB0b2tlbjsKKworCQlp
ZiAoISpwKQorCQkJY29udGludWU7CisKKwkJdG9rZW4gPSBtYXRjaF90b2tlbihwLCBleGZhdF90
b2tlbnMsIGFyZ3MpOworCQlzd2l0Y2ggKHRva2VuKSB7CisJCWNhc2UgT3B0X3VpZDoKKwkJCWlm
IChtYXRjaF9pbnQoJmFyZ3NbMF0sICZvcHRpb24pKQorCQkJCXJldHVybiAwOworCQkJb3B0cy0+
ZnNfdWlkID0gS1VJRFRfSU5JVChvcHRpb24pOworCQkJYnJlYWs7CisJCWNhc2UgT3B0X2dpZDoK
KwkJCWlmIChtYXRjaF9pbnQoJmFyZ3NbMF0sICZvcHRpb24pKQorCQkJCXJldHVybiAwOworCQkJ
b3B0cy0+ZnNfZ2lkID0gS0dJRFRfSU5JVChvcHRpb24pOworCQkJYnJlYWs7CisJCWNhc2UgT3B0
X3VtYXNrOgorCQljYXNlIE9wdF9kbWFzazoKKwkJY2FzZSBPcHRfZm1hc2s6CisJCQlpZiAobWF0
Y2hfb2N0YWwoJmFyZ3NbMF0sICZvcHRpb24pKQorCQkJCXJldHVybiAwOworCQkJaWYgKHRva2Vu
ICE9IE9wdF9kbWFzaykKKwkJCQlvcHRzLT5mc19mbWFzayA9IG9wdGlvbjsKKwkJCWlmICh0b2tl
biAhPSBPcHRfZm1hc2spCisJCQkJb3B0cy0+ZnNfZG1hc2sgPSBvcHRpb247CisJCQlicmVhazsK
KwkJY2FzZSBPcHRfYWxsb3dfdXRpbWU6CisJCQlpZiAobWF0Y2hfb2N0YWwoJmFyZ3NbMF0sICZv
cHRpb24pKQorCQkJCXJldHVybiAwOworCQkJb3B0cy0+YWxsb3dfdXRpbWUgPSBvcHRpb24gJiAw
MDIyOworCQkJYnJlYWs7CisJCWNhc2UgT3B0X2NvZGVwYWdlOgorCQkJaWYgKG1hdGNoX2ludCgm
YXJnc1swXSwgJm9wdGlvbikpCisJCQkJcmV0dXJuIDA7CisJCQlvcHRzLT5jb2RlcGFnZSA9IG9w
dGlvbjsKKwkJCWJyZWFrOworCQljYXNlIE9wdF9jaGFyc2V0OgorCQkJaWYgKG9wdHMtPmlvY2hh
cnNldCAhPSBleGZhdF9kZWZhdWx0X2lvY2hhcnNldCkKKwkJCQlrZnJlZShvcHRzLT5pb2NoYXJz
ZXQpOworCQkJaW9jaGFyc2V0ID0gbWF0Y2hfc3RyZHVwKCZhcmdzWzBdKTsKKwkJCWlmICghaW9j
aGFyc2V0KQorCQkJCXJldHVybiAtRU5PTUVNOworCQkJb3B0cy0+aW9jaGFyc2V0ID0gaW9jaGFy
c2V0OworCQkJYnJlYWs7CisJCWNhc2UgT3B0X25hbWVjYXNlOgorCQkJaWYgKG1hdGNoX2ludCgm
YXJnc1swXSwgJm9wdGlvbikpCisJCQkJcmV0dXJuIDA7CisJCQlvcHRzLT5jYXNlc2Vuc2l0aXZl
ID0gb3B0aW9uOworCQkJYnJlYWs7CisJCWNhc2UgT3B0X2Vycl9jb250OgorCQkJb3B0cy0+ZXJy
b3JzID0gRVhGQVRfRVJST1JTX0NPTlQ7CisJCQlicmVhazsKKwkJY2FzZSBPcHRfZXJyX3Bhbmlj
OgorCQkJb3B0cy0+ZXJyb3JzID0gRVhGQVRfRVJST1JTX1BBTklDOworCQkJYnJlYWs7CisJCWNh
c2UgT3B0X2Vycl9ybzoKKwkJCW9wdHMtPmVycm9ycyA9IEVYRkFUX0VSUk9SU19STzsKKwkJCWJy
ZWFrOworCQljYXNlIE9wdF9kZWJ1ZzoKKwkJCSpkZWJ1ZyA9IDE7CisJCQlicmVhazsKKyNpZmRl
ZiBDT05GSUdfRVhGQVRfRElTQ0FSRAorCQljYXNlIE9wdF9kaXNjYXJkOgorCQkJb3B0cy0+ZGlz
Y2FyZCA9IDE7CisJCQlicmVhazsKKyNlbmRpZiAvKiBDT05GSUdfRVhGQVRfRElTQ0FSRCAqLwor
CQljYXNlIE9wdF91dGY4X2hhY2s6CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCWlmICghc2ls
ZW50KQorCQkJCXByX2VycigiW0VYRkFUXSBVbnJlY29nbml6ZWQgbW91bnQgb3B0aW9uICVzIG9y
IG1pc3NpbmcgdmFsdWVcbiIsCisJCQkJICAgICAgIHApOworCQkJcmV0dXJuIC1FSU5WQUw7CisJ
CX0KKwl9CisKK291dDoKKwlpZiAob3B0cy0+YWxsb3dfdXRpbWUgPT0gKHVuc2lnbmVkIHNob3J0
KSAtMSkKKwkJb3B0cy0+YWxsb3dfdXRpbWUgPSB+b3B0cy0+ZnNfZG1hc2sgJiAwMDIyOworCisJ
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGV4ZmF0X2hhc2hfaW5pdChzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKnNiKQoreworCXN0cnVjdCBleGZhdF9zYl9pbmZvICpzYmkgPSBFWEZBVF9TQihzYik7
CisJaW50IGk7CisKKwlzcGluX2xvY2tfaW5pdCgmc2JpLT5pbm9kZV9oYXNoX2xvY2spOworCWZv
ciAoaSA9IDA7IGkgPCBFWEZBVF9IQVNIX1NJWkU7IGkrKykKKwkJSU5JVF9ITElTVF9IRUFEKCZz
YmktPmlub2RlX2hhc2h0YWJsZVtpXSk7Cit9CisKK3N0YXRpYyBpbnQgZXhmYXRfcmVhZF9yb290
KHN0cnVjdCBpbm9kZSAqaW5vZGUpCit7CisJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGlub2Rl
LT5pX3NiOworCXN0cnVjdCBleGZhdF9zYl9pbmZvICpzYmkgPSBFWEZBVF9TQihzYik7CisJc3Ry
dWN0IGZzX2luZm9fdCAqcF9mcyA9ICYoc2JpLT5mc19pbmZvKTsKKwlzdHJ1Y3QgZGlyX2VudHJ5
X3QgaW5mbzsKKworCUVYRkFUX0koaW5vZGUpLT5maWQuZGlyLmRpciA9IHBfZnMtPnJvb3RfZGly
OworCUVYRkFUX0koaW5vZGUpLT5maWQuZGlyLmZsYWdzID0gMHgwMTsKKwlFWEZBVF9JKGlub2Rl
KS0+ZmlkLmVudHJ5ID0gLTE7CisJRVhGQVRfSShpbm9kZSktPmZpZC5zdGFydF9jbHUgPSBwX2Zz
LT5yb290X2RpcjsKKwlFWEZBVF9JKGlub2RlKS0+ZmlkLmZsYWdzID0gMHgwMTsKKwlFWEZBVF9J
KGlub2RlKS0+ZmlkLnR5cGUgPSBUWVBFX0RJUjsKKwlFWEZBVF9JKGlub2RlKS0+ZmlkLnJ3b2Zm
c2V0ID0gMDsKKwlFWEZBVF9JKGlub2RlKS0+ZmlkLmhpbnRfbGFzdF9vZmYgPSAtMTsKKworCUVY
RkFUX0koaW5vZGUpLT50YXJnZXQgPSBOVUxMOworCisJZmZzUmVhZFN0YXQoaW5vZGUsICZpbmZv
KTsKKworCWlub2RlLT5pX3VpZCA9IHNiaS0+b3B0aW9ucy5mc191aWQ7CisJaW5vZGUtPmlfZ2lk
ID0gc2JpLT5vcHRpb25zLmZzX2dpZDsKKwlJTkNfSVZFUlNJT04oaW5vZGUpOworCWlub2RlLT5p
X2dlbmVyYXRpb24gPSAwOworCWlub2RlLT5pX21vZGUgPSBleGZhdF9tYWtlX21vZGUoc2JpLCBB
VFRSX1NVQkRJUiwgMDc3Nyk7CisJaW5vZGUtPmlfb3AgPSAmZXhmYXRfZGlyX2lub2RlX29wZXJh
dGlvbnM7CisJaW5vZGUtPmlfZm9wID0gJmV4ZmF0X2Rpcl9vcGVyYXRpb25zOworCisJaV9zaXpl
X3dyaXRlKGlub2RlLCBpbmZvLlNpemUpOworCWlub2RlLT5pX2Jsb2NrcyA9ICgoaV9zaXplX3Jl
YWQoaW5vZGUpICsgKHBfZnMtPmNsdXN0ZXJfc2l6ZSAtIDEpKQorCQkJCSYgfigobG9mZl90KXBf
ZnMtPmNsdXN0ZXJfc2l6ZSAtIDEpKSA+PiA5OworCUVYRkFUX0koaW5vZGUpLT5pX3BvcyA9ICgo
bG9mZl90KSBwX2ZzLT5yb290X2RpciA8PCAzMikgfCAweGZmZmZmZmZmOworCUVYRkFUX0koaW5v
ZGUpLT5tbXVfcHJpdmF0ZSA9IGlfc2l6ZV9yZWFkKGlub2RlKTsKKworCWV4ZmF0X3NhdmVfYXR0
cihpbm9kZSwgQVRUUl9TVUJESVIpOworCWlub2RlLT5pX210aW1lID0gaW5vZGUtPmlfYXRpbWUg
PSBpbm9kZS0+aV9jdGltZSA9IGN1cnJlbnRfdGltZShpbm9kZSk7CisJc2V0X25saW5rKGlub2Rl
LCBpbmZvLk51bVN1YmRpcnMgKyAyKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBz
ZXR1cF9kb3BzKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCit7CisJaWYgKEVYRkFUX1NCKHNiKS0+
b3B0aW9ucy5jYXNlc2Vuc2l0aXZlID09IDApCisJCXNiLT5zX2Rfb3AgPSAmZXhmYXRfY2lfZGVu
dHJ5X29wczsKKwllbHNlCisJCXNiLT5zX2Rfb3AgPSAmZXhmYXRfZGVudHJ5X29wczsKK30KKwor
c3RhdGljIGludCBleGZhdF9maWxsX3N1cGVyKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHZvaWQg
KmRhdGEsIGludCBzaWxlbnQpCit7CisJc3RydWN0IGlub2RlICpyb290X2lub2RlID0gTlVMTDsK
KwlzdHJ1Y3QgZXhmYXRfc2JfaW5mbyAqc2JpOworCWludCBkZWJ1ZywgcmV0OworCWxvbmcgZXJy
b3I7CisJY2hhciBidWZbNTBdOworCisJLyoKKwkgKiBHRlBfS0VSTkVMIGlzIG9rIGhlcmUsIGJl
Y2F1c2Ugd2hpbGUgd2UgZG8gaG9sZCB0aGUKKwkgKiBzdXBlYmxvY2sgbG9jaywgbWVtb3J5IHBy
ZXNzdXJlIGNhbid0IGNhbGwgYmFjayBpbnRvCisJICogdGhlIGZpbGVzeXN0ZW0sIHNpbmNlIHdl
J3JlIG9ubHkganVzdCBhYm91dCB0byBtb3VudAorCSAqIGl0IGFuZCBoYXZlIG5vIGlub2RlcyBl
dGMgYWN0aXZlIQorCSAqLworCXNiaSA9IGt6YWxsb2Moc2l6ZW9mKHN0cnVjdCBleGZhdF9zYl9p
bmZvKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFzYmkpCisJCXJldHVybiAtRU5PTUVNOworCW11dGV4
X2luaXQoJnNiaS0+c19sb2NrKTsKKwlzYi0+c19mc19pbmZvID0gc2JpOworCXNiLT5zX2ZsYWdz
IHw9IFNCX05PRElSQVRJTUU7CisJc2ItPnNfbWFnaWMgPSBFWEZBVF9TVVBFUl9NQUdJQzsKKwlz
Yi0+c19vcCA9ICZleGZhdF9zb3BzOworCXNiLT5zX2V4cG9ydF9vcCA9ICZleGZhdF9leHBvcnRf
b3BzOworCisJZXJyb3IgPSBwYXJzZV9vcHRpb25zKGRhdGEsIHNpbGVudCwgJmRlYnVnLCAmc2Jp
LT5vcHRpb25zKTsKKwlpZiAoZXJyb3IpCisJCWdvdG8gb3V0X2ZhaWw7CisKKwlzZXR1cF9kb3Bz
KHNiKTsKKworCWVycm9yID0gLUVJTzsKKwlzYl9taW5fYmxvY2tzaXplKHNiLCA1MTIpOworCXNi
LT5zX21heGJ5dGVzID0gMHg3ZmZmZmZmZmZmZmZmZmZmTEw7ICAgIC8qIG1heGltdW0gZmlsZSBz
aXplICovCisKKwlyZXQgPSBmZnNNb3VudFZvbChzYik7CisJaWYgKHJldCkgeworCQlpZiAoIXNp
bGVudCkKKwkJCXByX2VycigiW0VYRkFUXSBmZnNNb3VudFZvbCBmYWlsZWRcbiIpOworCisJCWdv
dG8gb3V0X2ZhaWw7CisJfQorCisJLyogc2V0IHVwIGVub3VnaCBzbyB0aGF0IGl0IGNhbiByZWFk
IGFuIGlub2RlICovCisJZXhmYXRfaGFzaF9pbml0KHNiKTsKKworCS8qCisJICogVGhlIGxvdyBi
eXRlIG9mIEZBVCdzIGZpcnN0IGVudHJ5IG11c3QgaGF2ZSBzYW1lIHZhbHVlIHdpdGgKKwkgKiBt
ZWRpYS1maWVsZC4gIEJ1dCBpbiByZWFsIHdvcmxkLCB0b28gbWFueSBkZXZpY2VzIGlzCisJICog
d3JpdGluZyB3cm9uZyB2YWx1ZS4gIFNvLCByZW1vdmVkIHRoYXQgdmFsaWRpdHkgY2hlY2suCisJ
ICoKKwkgKiBpZiAoRkFUX0ZJUlNUX0VOVChzYiwgbWVkaWEpICE9IGZpcnN0KQorCSAqLworCisJ
LyogY29kZXBhZ2UgaXMgbm90IG1lYW5pbmdmdWwgaW4gZXhmYXQgKi8KKwlpZiAoc2JpLT5mc19p
bmZvLnZvbF90eXBlICE9IEVYRkFUKSB7CisJCWVycm9yID0gLUVJTlZBTDsKKwkJc3ByaW50Zihi
dWYsICJjcCVkIiwgc2JpLT5vcHRpb25zLmNvZGVwYWdlKTsKKwkJc2JpLT5ubHNfZGlzayA9IGxv
YWRfbmxzKGJ1Zik7CisJCWlmICghc2JpLT5ubHNfZGlzaykgeworCQkJcHJfZXJyKCJbRVhGQVRd
IENvZGVwYWdlICVzIG5vdCBmb3VuZFxuIiwgYnVmKTsKKwkJCWdvdG8gb3V0X2ZhaWwyOworCQl9
CisJfQorCisJc2JpLT5ubHNfaW8gPSBsb2FkX25scyhzYmktPm9wdGlvbnMuaW9jaGFyc2V0KTsK
KworCWVycm9yID0gLUVOT01FTTsKKwlyb290X2lub2RlID0gbmV3X2lub2RlKHNiKTsKKwlpZiAo
IXJvb3RfaW5vZGUpCisJCWdvdG8gb3V0X2ZhaWwyOworCXJvb3RfaW5vZGUtPmlfaW5vID0gRVhG
QVRfUk9PVF9JTk87CisJU0VUX0lWRVJTSU9OKHJvb3RfaW5vZGUsIDEpOworCisJZXJyb3IgPSBl
eGZhdF9yZWFkX3Jvb3Qocm9vdF9pbm9kZSk7CisJaWYgKGVycm9yIDwgMCkKKwkJZ290byBvdXRf
ZmFpbDI7CisJZXJyb3IgPSAtRU5PTUVNOworCWV4ZmF0X2F0dGFjaChyb290X2lub2RlLCBFWEZB
VF9JKHJvb3RfaW5vZGUpLT5pX3Bvcyk7CisJaW5zZXJ0X2lub2RlX2hhc2gocm9vdF9pbm9kZSk7
CisJc2ItPnNfcm9vdCA9IGRfbWFrZV9yb290KHJvb3RfaW5vZGUpOworCWlmICghc2ItPnNfcm9v
dCkgeworCQlwcl9lcnIoIltFWEZBVF0gR2V0dGluZyB0aGUgcm9vdCBpbm9kZSBmYWlsZWRcbiIp
OworCQlnb3RvIG91dF9mYWlsMjsKKwl9CisKKwlyZXR1cm4gMDsKKworb3V0X2ZhaWwyOgorCWZm
c1Vtb3VudFZvbChzYik7CitvdXRfZmFpbDoKKwlpZiAocm9vdF9pbm9kZSkKKwkJaXB1dChyb290
X2lub2RlKTsKKwlzYi0+c19mc19pbmZvID0gTlVMTDsKKwlleGZhdF9mcmVlX3N1cGVyKHNiaSk7
CisJcmV0dXJuIGVycm9yOworfQorCitzdGF0aWMgc3RydWN0IGRlbnRyeSAqZXhmYXRfZnNfbW91
bnQoc3RydWN0IGZpbGVfc3lzdGVtX3R5cGUgKmZzX3R5cGUsCisJCQkJICAgICBpbnQgZmxhZ3Ms
IGNvbnN0IGNoYXIgKmRldl9uYW1lLAorCQkJCSAgICAgdm9pZCAqZGF0YSkKK3sKKwlyZXR1cm4g
bW91bnRfYmRldihmc190eXBlLCBmbGFncywgZGV2X25hbWUsIGRhdGEsIGV4ZmF0X2ZpbGxfc3Vw
ZXIpOworfQorCitzdGF0aWMgdm9pZCBpbml0X29uY2Uodm9pZCAqZm9vKQoreworCXN0cnVjdCBl
eGZhdF9pbm9kZV9pbmZvICplaSA9IChzdHJ1Y3QgZXhmYXRfaW5vZGVfaW5mbyAqKWZvbzsKKwor
CUlOSVRfSExJU1RfTk9ERSgmZWktPmlfaGFzaF9mYXQpOworCWlub2RlX2luaXRfb25jZSgmZWkt
PnZmc19pbm9kZSk7Cit9CisKK3N0YXRpYyBpbnQgX19pbml0IGV4ZmF0X2luaXRfaW5vZGVjYWNo
ZSh2b2lkKQoreworCWV4ZmF0X2lub2RlX2NhY2hlcCA9IGttZW1fY2FjaGVfY3JlYXRlKCJleGZh
dF9pbm9kZV9jYWNoZSIsCisJCQkJCSAgICAgICBzaXplb2Yoc3RydWN0IGV4ZmF0X2lub2RlX2lu
Zm8pLAorCQkJCQkgICAgICAgMCwKKwkJCQkJICAgICAgIChTTEFCX1JFQ0xBSU1fQUNDT1VOVCB8
CisJCQkJCQlTTEFCX01FTV9TUFJFQUQpLAorCQkJCQkgICAgICAgaW5pdF9vbmNlKTsKKwlpZiAo
ZXhmYXRfaW5vZGVfY2FjaGVwID09IE5VTEwpCisJCXJldHVybiAtRU5PTUVNOworCXJldHVybiAw
OworfQorCitzdGF0aWMgdm9pZCBfX2V4aXQgZXhmYXRfZGVzdHJveV9pbm9kZWNhY2hlKHZvaWQp
Cit7CisJLyoKKwkgKiBNYWtlIHN1cmUgYWxsIGRlbGF5ZWQgcmN1IGZyZWUgaW5vZGVzIGFyZSBm
bHVzaGVkIGJlZm9yZSB3ZQorCSAqIGRlc3Ryb3kgY2FjaGUuCisJICovCisJcmN1X2JhcnJpZXIo
KTsKKwlrbWVtX2NhY2hlX2Rlc3Ryb3koZXhmYXRfaW5vZGVfY2FjaGVwKTsKK30KKworI2lmZGVm
IENPTkZJR19FWEZBVF9LRVJORUxfREVCVUcKK3N0YXRpYyB2b2lkIGV4ZmF0X2RlYnVnX2tpbGxf
c2Ioc3RydWN0IHN1cGVyX2Jsb2NrICpzYikKK3sKKwlzdHJ1Y3QgZXhmYXRfc2JfaW5mbyAqc2Jp
ID0gRVhGQVRfU0Ioc2IpOworCXN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYgPSBzYi0+c19iZGV2
OworCXN0cnVjdCBmc19pbmZvX3QgKnBfZnMgPSAmKEVYRkFUX1NCKHNiKS0+ZnNfaW5mbyk7CisK
Kwlsb25nIGZsYWdzOworCisJaWYgKHNiaSkgeworCQlmbGFncyA9IHNiaS0+ZGVidWdfZmxhZ3M7
CisKKwkJaWYgKGZsYWdzICYgRVhGQVRfREVCVUdGTEFHU19JTlZBTElEX1VNT1VOVCkgeworCQkJ
LyoKKwkJCSAqIGludmFsaWRhdGVfYmRldiBkcm9wcyBhbGwgZGV2aWNlIGNhY2hlIGluY2x1ZGUK
KwkJCSAqIGRpcnR5LiBXZSB1c2UgdGhpcyB0byBzaW11bGF0ZSBkZXZpY2UgcmVtb3ZhbC4KKwkJ
CSAqLworCQkJZG93bigmcF9mcy0+dl9zZW0pOworCQkJRkFUX3JlbGVhc2VfYWxsKHNiKTsKKwkJ
CWJ1Zl9yZWxlYXNlX2FsbChzYik7CisJCQl1cCgmcF9mcy0+dl9zZW0pOworCisJCQlpbnZhbGlk
YXRlX2JkZXYoYmRldik7CisJCX0KKwl9CisKKwlraWxsX2Jsb2NrX3N1cGVyKHNiKTsKK30KKyNl
bmRpZiAvKiBDT05GSUdfRVhGQVRfS0VSTkVMX0RFQlVHICovCisKK3N0YXRpYyBzdHJ1Y3QgZmls
ZV9zeXN0ZW1fdHlwZSBleGZhdF9mc190eXBlID0geworCS5vd25lciAgICAgICA9IFRISVNfTU9E
VUxFLAorCS5uYW1lICAgICAgICA9ICJleGZhdCIsCisJLm1vdW50ICAgICAgID0gZXhmYXRfZnNf
bW91bnQsCisjaWZkZWYgQ09ORklHX0VYRkFUX0tFUk5FTF9ERUJVRworCS5raWxsX3NiICAgID0g
ZXhmYXRfZGVidWdfa2lsbF9zYiwKKyNlbHNlCisJLmtpbGxfc2IgICAgPSBraWxsX2Jsb2NrX3N1
cGVyLAorI2VuZGlmIC8qIENPTkZJR19FWEZBVF9LRVJORUxfREVCVUcgKi8KKwkuZnNfZmxhZ3Mg
ICAgPSBGU19SRVFVSVJFU19ERVYsCit9OworCitzdGF0aWMgaW50IF9faW5pdCBpbml0X2V4ZmF0
KHZvaWQpCit7CisJaW50IGVycjsKKworCUJVSUxEX0JVR19PTihzaXplb2Yoc3RydWN0IGRlbnRy
eV90KSAhPSBERU5UUllfU0laRSk7CisJQlVJTERfQlVHX09OKHNpemVvZihzdHJ1Y3QgZG9zX2Rl
bnRyeV90KSAhPSBERU5UUllfU0laRSk7CisJQlVJTERfQlVHX09OKHNpemVvZihzdHJ1Y3QgZXh0
X2RlbnRyeV90KSAhPSBERU5UUllfU0laRSk7CisJQlVJTERfQlVHX09OKHNpemVvZihzdHJ1Y3Qg
ZmlsZV9kZW50cnlfdCkgIT0gREVOVFJZX1NJWkUpOworCUJVSUxEX0JVR19PTihzaXplb2Yoc3Ry
dWN0IHN0cm1fZGVudHJ5X3QpICE9IERFTlRSWV9TSVpFKTsKKwlCVUlMRF9CVUdfT04oc2l6ZW9m
KHN0cnVjdCBuYW1lX2RlbnRyeV90KSAhPSBERU5UUllfU0laRSk7CisJQlVJTERfQlVHX09OKHNp
emVvZihzdHJ1Y3QgYm1hcF9kZW50cnlfdCkgIT0gREVOVFJZX1NJWkUpOworCUJVSUxEX0JVR19P
TihzaXplb2Yoc3RydWN0IGNhc2VfZGVudHJ5X3QpICE9IERFTlRSWV9TSVpFKTsKKwlCVUlMRF9C
VUdfT04oc2l6ZW9mKHN0cnVjdCB2b2xtX2RlbnRyeV90KSAhPSBERU5UUllfU0laRSk7CisKKwlw
cl9pbmZvKCJleEZBVDogVmVyc2lvbiAlc1xuIiwgRVhGQVRfVkVSU0lPTik7CisKKwllcnIgPSBl
eGZhdF9pbml0X2lub2RlY2FjaGUoKTsKKwlpZiAoZXJyKQorCQlyZXR1cm4gZXJyOworCisJZXJy
ID0gcmVnaXN0ZXJfZmlsZXN5c3RlbSgmZXhmYXRfZnNfdHlwZSk7CisJaWYgKGVycikKKwkJcmV0
dXJuIGVycjsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBfX2V4aXQgZXhpdF9leGZh
dCh2b2lkKQoreworCWV4ZmF0X2Rlc3Ryb3lfaW5vZGVjYWNoZSgpOworCXVucmVnaXN0ZXJfZmls
ZXN5c3RlbSgmZXhmYXRfZnNfdHlwZSk7Cit9CisKK21vZHVsZV9pbml0KGluaXRfZXhmYXQpOwor
bW9kdWxlX2V4aXQoZXhpdF9leGZhdCk7CisKK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsKK01PRFVM
RV9ERVNDUklQVElPTigiZXhGQVQgRmlsZXN5c3RlbSBEcml2ZXIiKTsKK01PRFVMRV9BTElBU19G
UygiZXhmYXQiKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9leGZhdC9leGZhdF91cGNh
c2UuYyBiL2RyaXZlcnMvc3RhZ2luZy9leGZhdC9leGZhdF91cGNhc2UuYwpuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjM2NjA4MmZiM2RhYgotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvc3RhZ2luZy9leGZhdC9leGZhdF91cGNhc2UuYwpAQCAtMCwwICsxLDc0MCBA
QAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKKy8qCisgKiAgQ29weXJpZ2h0
IChDKSAyMDEyLTIwMTMgU2Ftc3VuZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4KKyAqLworCisjaW5j
bHVkZSA8bGludXgvdHlwZXMuaD4KKyNpbmNsdWRlICJleGZhdC5oIgorCitjb25zdCB1OCB1bmlf
dXBjYXNlW05VTV9VUENBU0UgPDwgMV0gPSB7CisJMHgwMCwgMHgwMCwgMHgwMSwgMHgwMCwgMHgw
MiwgMHgwMCwgMHgwMywgMHgwMCwKKwkweDA0LCAweDAwLCAweDA1LCAweDAwLCAweDA2LCAweDAw
LCAweDA3LCAweDAwLAorCTB4MDgsIDB4MDAsIDB4MDksIDB4MDAsIDB4MEEsIDB4MDAsIDB4MEIs
IDB4MDAsCisJMHgwQywgMHgwMCwgMHgwRCwgMHgwMCwgMHgwRSwgMHgwMCwgMHgwRiwgMHgwMCwK
KwkweDEwLCAweDAwLCAweDExLCAweDAwLCAweDEyLCAweDAwLCAweDEzLCAweDAwLAorCTB4MTQs
IDB4MDAsIDB4MTUsIDB4MDAsIDB4MTYsIDB4MDAsIDB4MTcsIDB4MDAsCisJMHgxOCwgMHgwMCwg
MHgxOSwgMHgwMCwgMHgxQSwgMHgwMCwgMHgxQiwgMHgwMCwKKwkweDFDLCAweDAwLCAweDFELCAw
eDAwLCAweDFFLCAweDAwLCAweDFGLCAweDAwLAorCTB4MjAsIDB4MDAsIDB4MjEsIDB4MDAsIDB4
MjIsIDB4MDAsIDB4MjMsIDB4MDAsCisJMHgyNCwgMHgwMCwgMHgyNSwgMHgwMCwgMHgyNiwgMHgw
MCwgMHgyNywgMHgwMCwKKwkweDI4LCAweDAwLCAweDI5LCAweDAwLCAweDJBLCAweDAwLCAweDJC
LCAweDAwLAorCTB4MkMsIDB4MDAsIDB4MkQsIDB4MDAsIDB4MkUsIDB4MDAsIDB4MkYsIDB4MDAs
CisJMHgzMCwgMHgwMCwgMHgzMSwgMHgwMCwgMHgzMiwgMHgwMCwgMHgzMywgMHgwMCwKKwkweDM0
LCAweDAwLCAweDM1LCAweDAwLCAweDM2LCAweDAwLCAweDM3LCAweDAwLAorCTB4MzgsIDB4MDAs
IDB4MzksIDB4MDAsIDB4M0EsIDB4MDAsIDB4M0IsIDB4MDAsCisJMHgzQywgMHgwMCwgMHgzRCwg
MHgwMCwgMHgzRSwgMHgwMCwgMHgzRiwgMHgwMCwKKwkweDQwLCAweDAwLCAweDQxLCAweDAwLCAw
eDQyLCAweDAwLCAweDQzLCAweDAwLAorCTB4NDQsIDB4MDAsIDB4NDUsIDB4MDAsIDB4NDYsIDB4
MDAsIDB4NDcsIDB4MDAsCisJMHg0OCwgMHgwMCwgMHg0OSwgMHgwMCwgMHg0QSwgMHgwMCwgMHg0
QiwgMHgwMCwKKwkweDRDLCAweDAwLCAweDRELCAweDAwLCAweDRFLCAweDAwLCAweDRGLCAweDAw
LAorCTB4NTAsIDB4MDAsIDB4NTEsIDB4MDAsIDB4NTIsIDB4MDAsIDB4NTMsIDB4MDAsCisJMHg1
NCwgMHgwMCwgMHg1NSwgMHgwMCwgMHg1NiwgMHgwMCwgMHg1NywgMHgwMCwKKwkweDU4LCAweDAw
LCAweDU5LCAweDAwLCAweDVBLCAweDAwLCAweDVCLCAweDAwLAorCTB4NUMsIDB4MDAsIDB4NUQs
IDB4MDAsIDB4NUUsIDB4MDAsIDB4NUYsIDB4MDAsCisJMHg2MCwgMHgwMCwgMHg0MSwgMHgwMCwg
MHg0MiwgMHgwMCwgMHg0MywgMHgwMCwKKwkweDQ0LCAweDAwLCAweDQ1LCAweDAwLCAweDQ2LCAw
eDAwLCAweDQ3LCAweDAwLAorCTB4NDgsIDB4MDAsIDB4NDksIDB4MDAsIDB4NEEsIDB4MDAsIDB4
NEIsIDB4MDAsCisJMHg0QywgMHgwMCwgMHg0RCwgMHgwMCwgMHg0RSwgMHgwMCwgMHg0RiwgMHgw
MCwKKwkweDUwLCAweDAwLCAweDUxLCAweDAwLCAweDUyLCAweDAwLCAweDUzLCAweDAwLAorCTB4
NTQsIDB4MDAsIDB4NTUsIDB4MDAsIDB4NTYsIDB4MDAsIDB4NTcsIDB4MDAsCisJMHg1OCwgMHgw
MCwgMHg1OSwgMHgwMCwgMHg1QSwgMHgwMCwgMHg3QiwgMHgwMCwKKwkweDdDLCAweDAwLCAweDdE
LCAweDAwLCAweDdFLCAweDAwLCAweDdGLCAweDAwLAorCTB4ODAsIDB4MDAsIDB4ODEsIDB4MDAs
IDB4ODIsIDB4MDAsIDB4ODMsIDB4MDAsCisJMHg4NCwgMHgwMCwgMHg4NSwgMHgwMCwgMHg4Niwg
MHgwMCwgMHg4NywgMHgwMCwKKwkweDg4LCAweDAwLCAweDg5LCAweDAwLCAweDhBLCAweDAwLCAw
eDhCLCAweDAwLAorCTB4OEMsIDB4MDAsIDB4OEQsIDB4MDAsIDB4OEUsIDB4MDAsIDB4OEYsIDB4
MDAsCisJMHg5MCwgMHgwMCwgMHg5MSwgMHgwMCwgMHg5MiwgMHgwMCwgMHg5MywgMHgwMCwKKwkw
eDk0LCAweDAwLCAweDk1LCAweDAwLCAweDk2LCAweDAwLCAweDk3LCAweDAwLAorCTB4OTgsIDB4
MDAsIDB4OTksIDB4MDAsIDB4OUEsIDB4MDAsIDB4OUIsIDB4MDAsCisJMHg5QywgMHgwMCwgMHg5
RCwgMHgwMCwgMHg5RSwgMHgwMCwgMHg5RiwgMHgwMCwKKwkweEEwLCAweDAwLCAweEExLCAweDAw
LCAweEEyLCAweDAwLCAweEEzLCAweDAwLAorCTB4QTQsIDB4MDAsIDB4QTUsIDB4MDAsIDB4QTYs
IDB4MDAsIDB4QTcsIDB4MDAsCisJMHhBOCwgMHgwMCwgMHhBOSwgMHgwMCwgMHhBQSwgMHgwMCwg
MHhBQiwgMHgwMCwKKwkweEFDLCAweDAwLCAweEFELCAweDAwLCAweEFFLCAweDAwLCAweEFGLCAw
eDAwLAorCTB4QjAsIDB4MDAsIDB4QjEsIDB4MDAsIDB4QjIsIDB4MDAsIDB4QjMsIDB4MDAsCisJ
MHhCNCwgMHgwMCwgMHhCNSwgMHgwMCwgMHhCNiwgMHgwMCwgMHhCNywgMHgwMCwKKwkweEI4LCAw
eDAwLCAweEI5LCAweDAwLCAweEJBLCAweDAwLCAweEJCLCAweDAwLAorCTB4QkMsIDB4MDAsIDB4
QkQsIDB4MDAsIDB4QkUsIDB4MDAsIDB4QkYsIDB4MDAsCisJMHhDMCwgMHgwMCwgMHhDMSwgMHgw
MCwgMHhDMiwgMHgwMCwgMHhDMywgMHgwMCwKKwkweEM0LCAweDAwLCAweEM1LCAweDAwLCAweEM2
LCAweDAwLCAweEM3LCAweDAwLAorCTB4QzgsIDB4MDAsIDB4QzksIDB4MDAsIDB4Q0EsIDB4MDAs
IDB4Q0IsIDB4MDAsCisJMHhDQywgMHgwMCwgMHhDRCwgMHgwMCwgMHhDRSwgMHgwMCwgMHhDRiwg
MHgwMCwKKwkweEQwLCAweDAwLCAweEQxLCAweDAwLCAweEQyLCAweDAwLCAweEQzLCAweDAwLAor
CTB4RDQsIDB4MDAsIDB4RDUsIDB4MDAsIDB4RDYsIDB4MDAsIDB4RDcsIDB4MDAsCisJMHhEOCwg
MHgwMCwgMHhEOSwgMHgwMCwgMHhEQSwgMHgwMCwgMHhEQiwgMHgwMCwKKwkweERDLCAweDAwLCAw
eERELCAweDAwLCAweERFLCAweDAwLCAweERGLCAweDAwLAorCTB4QzAsIDB4MDAsIDB4QzEsIDB4
MDAsIDB4QzIsIDB4MDAsIDB4QzMsIDB4MDAsCisJMHhDNCwgMHgwMCwgMHhDNSwgMHgwMCwgMHhD
NiwgMHgwMCwgMHhDNywgMHgwMCwKKwkweEM4LCAweDAwLCAweEM5LCAweDAwLCAweENBLCAweDAw
LCAweENCLCAweDAwLAorCTB4Q0MsIDB4MDAsIDB4Q0QsIDB4MDAsIDB4Q0UsIDB4MDAsIDB4Q0Ys
IDB4MDAsCisJMHhEMCwgMHgwMCwgMHhEMSwgMHgwMCwgMHhEMiwgMHgwMCwgMHhEMywgMHgwMCwK
KwkweEQ0LCAweDAwLCAweEQ1LCAweDAwLCAweEQ2LCAweDAwLCAweEY3LCAweDAwLAorCTB4RDgs
IDB4MDAsIDB4RDksIDB4MDAsIDB4REEsIDB4MDAsIDB4REIsIDB4MDAsCisJMHhEQywgMHgwMCwg
MHhERCwgMHgwMCwgMHhERSwgMHgwMCwgMHg3OCwgMHgwMSwKKwkweDAwLCAweDAxLCAweDAwLCAw
eDAxLCAweDAyLCAweDAxLCAweDAyLCAweDAxLAorCTB4MDQsIDB4MDEsIDB4MDQsIDB4MDEsIDB4
MDYsIDB4MDEsIDB4MDYsIDB4MDEsCisJMHgwOCwgMHgwMSwgMHgwOCwgMHgwMSwgMHgwQSwgMHgw
MSwgMHgwQSwgMHgwMSwKKwkweDBDLCAweDAxLCAweDBDLCAweDAxLCAweDBFLCAweDAxLCAweDBF
LCAweDAxLAorCTB4MTAsIDB4MDEsIDB4MTAsIDB4MDEsIDB4MTIsIDB4MDEsIDB4MTIsIDB4MDEs
CisJMHgxNCwgMHgwMSwgMHgxNCwgMHgwMSwgMHgxNiwgMHgwMSwgMHgxNiwgMHgwMSwKKwkweDE4
LCAweDAxLCAweDE4LCAweDAxLCAweDFBLCAweDAxLCAweDFBLCAweDAxLAorCTB4MUMsIDB4MDEs
IDB4MUMsIDB4MDEsIDB4MUUsIDB4MDEsIDB4MUUsIDB4MDEsCisJMHgyMCwgMHgwMSwgMHgyMCwg
MHgwMSwgMHgyMiwgMHgwMSwgMHgyMiwgMHgwMSwKKwkweDI0LCAweDAxLCAweDI0LCAweDAxLCAw
eDI2LCAweDAxLCAweDI2LCAweDAxLAorCTB4MjgsIDB4MDEsIDB4MjgsIDB4MDEsIDB4MkEsIDB4
MDEsIDB4MkEsIDB4MDEsCisJMHgyQywgMHgwMSwgMHgyQywgMHgwMSwgMHgyRSwgMHgwMSwgMHgy
RSwgMHgwMSwKKwkweDMwLCAweDAxLCAweDMxLCAweDAxLCAweDMyLCAweDAxLCAweDMyLCAweDAx
LAorCTB4MzQsIDB4MDEsIDB4MzQsIDB4MDEsIDB4MzYsIDB4MDEsIDB4MzYsIDB4MDEsCisJMHgz
OCwgMHgwMSwgMHgzOSwgMHgwMSwgMHgzOSwgMHgwMSwgMHgzQiwgMHgwMSwKKwkweDNCLCAweDAx
LCAweDNELCAweDAxLCAweDNELCAweDAxLCAweDNGLCAweDAxLAorCTB4M0YsIDB4MDEsIDB4NDEs
IDB4MDEsIDB4NDEsIDB4MDEsIDB4NDMsIDB4MDEsCisJMHg0MywgMHgwMSwgMHg0NSwgMHgwMSwg
MHg0NSwgMHgwMSwgMHg0NywgMHgwMSwKKwkweDQ3LCAweDAxLCAweDQ5LCAweDAxLCAweDRBLCAw
eDAxLCAweDRBLCAweDAxLAorCTB4NEMsIDB4MDEsIDB4NEMsIDB4MDEsIDB4NEUsIDB4MDEsIDB4
NEUsIDB4MDEsCisJMHg1MCwgMHgwMSwgMHg1MCwgMHgwMSwgMHg1MiwgMHgwMSwgMHg1MiwgMHgw
MSwKKwkweDU0LCAweDAxLCAweDU0LCAweDAxLCAweDU2LCAweDAxLCAweDU2LCAweDAxLAorCTB4
NTgsIDB4MDEsIDB4NTgsIDB4MDEsIDB4NUEsIDB4MDEsIDB4NUEsIDB4MDEsCisJMHg1QywgMHgw
MSwgMHg1QywgMHgwMSwgMHg1RSwgMHgwMSwgMHg1RSwgMHgwMSwKKwkweDYwLCAweDAxLCAweDYw
LCAweDAxLCAweDYyLCAweDAxLCAweDYyLCAweDAxLAorCTB4NjQsIDB4MDEsIDB4NjQsIDB4MDEs
IDB4NjYsIDB4MDEsIDB4NjYsIDB4MDEsCisJMHg2OCwgMHgwMSwgMHg2OCwgMHgwMSwgMHg2QSwg
MHgwMSwgMHg2QSwgMHgwMSwKKwkweDZDLCAweDAxLCAweDZDLCAweDAxLCAweDZFLCAweDAxLCAw
eDZFLCAweDAxLAorCTB4NzAsIDB4MDEsIDB4NzAsIDB4MDEsIDB4NzIsIDB4MDEsIDB4NzIsIDB4
MDEsCisJMHg3NCwgMHgwMSwgMHg3NCwgMHgwMSwgMHg3NiwgMHgwMSwgMHg3NiwgMHgwMSwKKwkw
eDc4LCAweDAxLCAweDc5LCAweDAxLCAweDc5LCAweDAxLCAweDdCLCAweDAxLAorCTB4N0IsIDB4
MDEsIDB4N0QsIDB4MDEsIDB4N0QsIDB4MDEsIDB4N0YsIDB4MDEsCisJMHg0MywgMHgwMiwgMHg4
MSwgMHgwMSwgMHg4MiwgMHgwMSwgMHg4MiwgMHgwMSwKKwkweDg0LCAweDAxLCAweDg0LCAweDAx
LCAweDg2LCAweDAxLCAweDg3LCAweDAxLAorCTB4ODcsIDB4MDEsIDB4ODksIDB4MDEsIDB4OEEs
IDB4MDEsIDB4OEIsIDB4MDEsCisJMHg4QiwgMHgwMSwgMHg4RCwgMHgwMSwgMHg4RSwgMHgwMSwg
MHg4RiwgMHgwMSwKKwkweDkwLCAweDAxLCAweDkxLCAweDAxLCAweDkxLCAweDAxLCAweDkzLCAw
eDAxLAorCTB4OTQsIDB4MDEsIDB4RjYsIDB4MDEsIDB4OTYsIDB4MDEsIDB4OTcsIDB4MDEsCisJ
MHg5OCwgMHgwMSwgMHg5OCwgMHgwMSwgMHgzRCwgMHgwMiwgMHg5QiwgMHgwMSwKKwkweDlDLCAw
eDAxLCAweDlELCAweDAxLCAweDIwLCAweDAyLCAweDlGLCAweDAxLAorCTB4QTAsIDB4MDEsIDB4
QTAsIDB4MDEsIDB4QTIsIDB4MDEsIDB4QTIsIDB4MDEsCisJMHhBNCwgMHgwMSwgMHhBNCwgMHgw
MSwgMHhBNiwgMHgwMSwgMHhBNywgMHgwMSwKKwkweEE3LCAweDAxLCAweEE5LCAweDAxLCAweEFB
LCAweDAxLCAweEFCLCAweDAxLAorCTB4QUMsIDB4MDEsIDB4QUMsIDB4MDEsIDB4QUUsIDB4MDEs
IDB4QUYsIDB4MDEsCisJMHhBRiwgMHgwMSwgMHhCMSwgMHgwMSwgMHhCMiwgMHgwMSwgMHhCMywg
MHgwMSwKKwkweEIzLCAweDAxLCAweEI1LCAweDAxLCAweEI1LCAweDAxLCAweEI3LCAweDAxLAor
CTB4QjgsIDB4MDEsIDB4QjgsIDB4MDEsIDB4QkEsIDB4MDEsIDB4QkIsIDB4MDEsCisJMHhCQywg
MHgwMSwgMHhCQywgMHgwMSwgMHhCRSwgMHgwMSwgMHhGNywgMHgwMSwKKwkweEMwLCAweDAxLCAw
eEMxLCAweDAxLCAweEMyLCAweDAxLCAweEMzLCAweDAxLAorCTB4QzQsIDB4MDEsIDB4QzUsIDB4
MDEsIDB4QzQsIDB4MDEsIDB4QzcsIDB4MDEsCisJMHhDOCwgMHgwMSwgMHhDNywgMHgwMSwgMHhD
QSwgMHgwMSwgMHhDQiwgMHgwMSwKKwkweENBLCAweDAxLCAweENELCAweDAxLCAweENELCAweDAx
LCAweENGLCAweDAxLAorCTB4Q0YsIDB4MDEsIDB4RDEsIDB4MDEsIDB4RDEsIDB4MDEsIDB4RDMs
IDB4MDEsCisJMHhEMywgMHgwMSwgMHhENSwgMHgwMSwgMHhENSwgMHgwMSwgMHhENywgMHgwMSwK
KwkweEQ3LCAweDAxLCAweEQ5LCAweDAxLCAweEQ5LCAweDAxLCAweERCLCAweDAxLAorCTB4REIs
IDB4MDEsIDB4OEUsIDB4MDEsIDB4REUsIDB4MDEsIDB4REUsIDB4MDEsCisJMHhFMCwgMHgwMSwg
MHhFMCwgMHgwMSwgMHhFMiwgMHgwMSwgMHhFMiwgMHgwMSwKKwkweEU0LCAweDAxLCAweEU0LCAw
eDAxLCAweEU2LCAweDAxLCAweEU2LCAweDAxLAorCTB4RTgsIDB4MDEsIDB4RTgsIDB4MDEsIDB4
RUEsIDB4MDEsIDB4RUEsIDB4MDEsCisJMHhFQywgMHgwMSwgMHhFQywgMHgwMSwgMHhFRSwgMHgw
MSwgMHhFRSwgMHgwMSwKKwkweEYwLCAweDAxLCAweEYxLCAweDAxLCAweEYyLCAweDAxLCAweEYx
LCAweDAxLAorCTB4RjQsIDB4MDEsIDB4RjQsIDB4MDEsIDB4RjYsIDB4MDEsIDB4RjcsIDB4MDEs
CisJMHhGOCwgMHgwMSwgMHhGOCwgMHgwMSwgMHhGQSwgMHgwMSwgMHhGQSwgMHgwMSwKKwkweEZD
LCAweDAxLCAweEZDLCAweDAxLCAweEZFLCAweDAxLCAweEZFLCAweDAxLAorCTB4MDAsIDB4MDIs
IDB4MDAsIDB4MDIsIDB4MDIsIDB4MDIsIDB4MDIsIDB4MDIsCisJMHgwNCwgMHgwMiwgMHgwNCwg
MHgwMiwgMHgwNiwgMHgwMiwgMHgwNiwgMHgwMiwKKwkweDA4LCAweDAyLCAweDA4LCAweDAyLCAw
eDBBLCAweDAyLCAweDBBLCAweDAyLAorCTB4MEMsIDB4MDIsIDB4MEMsIDB4MDIsIDB4MEUsIDB4
MDIsIDB4MEUsIDB4MDIsCisJMHgxMCwgMHgwMiwgMHgxMCwgMHgwMiwgMHgxMiwgMHgwMiwgMHgx
MiwgMHgwMiwKKwkweDE0LCAweDAyLCAweDE0LCAweDAyLCAweDE2LCAweDAyLCAweDE2LCAweDAy
LAorCTB4MTgsIDB4MDIsIDB4MTgsIDB4MDIsIDB4MUEsIDB4MDIsIDB4MUEsIDB4MDIsCisJMHgx
QywgMHgwMiwgMHgxQywgMHgwMiwgMHgxRSwgMHgwMiwgMHgxRSwgMHgwMiwKKwkweDIwLCAweDAy
LCAweDIxLCAweDAyLCAweDIyLCAweDAyLCAweDIyLCAweDAyLAorCTB4MjQsIDB4MDIsIDB4MjQs
IDB4MDIsIDB4MjYsIDB4MDIsIDB4MjYsIDB4MDIsCisJMHgyOCwgMHgwMiwgMHgyOCwgMHgwMiwg
MHgyQSwgMHgwMiwgMHgyQSwgMHgwMiwKKwkweDJDLCAweDAyLCAweDJDLCAweDAyLCAweDJFLCAw
eDAyLCAweDJFLCAweDAyLAorCTB4MzAsIDB4MDIsIDB4MzAsIDB4MDIsIDB4MzIsIDB4MDIsIDB4
MzIsIDB4MDIsCisJMHgzNCwgMHgwMiwgMHgzNSwgMHgwMiwgMHgzNiwgMHgwMiwgMHgzNywgMHgw
MiwKKwkweDM4LCAweDAyLCAweDM5LCAweDAyLCAweDY1LCAweDJDLCAweDNCLCAweDAyLAorCTB4
M0IsIDB4MDIsIDB4M0QsIDB4MDIsIDB4NjYsIDB4MkMsIDB4M0YsIDB4MDIsCisJMHg0MCwgMHgw
MiwgMHg0MSwgMHgwMiwgMHg0MSwgMHgwMiwgMHg0MywgMHgwMiwKKwkweDQ0LCAweDAyLCAweDQ1
LCAweDAyLCAweDQ2LCAweDAyLCAweDQ2LCAweDAyLAorCTB4NDgsIDB4MDIsIDB4NDgsIDB4MDIs
IDB4NEEsIDB4MDIsIDB4NEEsIDB4MDIsCisJMHg0QywgMHgwMiwgMHg0QywgMHgwMiwgMHg0RSwg
MHgwMiwgMHg0RSwgMHgwMiwKKwkweDUwLCAweDAyLCAweDUxLCAweDAyLCAweDUyLCAweDAyLCAw
eDgxLCAweDAxLAorCTB4ODYsIDB4MDEsIDB4NTUsIDB4MDIsIDB4ODksIDB4MDEsIDB4OEEsIDB4
MDEsCisJMHg1OCwgMHgwMiwgMHg4RiwgMHgwMSwgMHg1QSwgMHgwMiwgMHg5MCwgMHgwMSwKKwkw
eDVDLCAweDAyLCAweDVELCAweDAyLCAweDVFLCAweDAyLCAweDVGLCAweDAyLAorCTB4OTMsIDB4
MDEsIDB4NjEsIDB4MDIsIDB4NjIsIDB4MDIsIDB4OTQsIDB4MDEsCisJMHg2NCwgMHgwMiwgMHg2
NSwgMHgwMiwgMHg2NiwgMHgwMiwgMHg2NywgMHgwMiwKKwkweDk3LCAweDAxLCAweDk2LCAweDAx
LCAweDZBLCAweDAyLCAweDYyLCAweDJDLAorCTB4NkMsIDB4MDIsIDB4NkQsIDB4MDIsIDB4NkUs
IDB4MDIsIDB4OUMsIDB4MDEsCisJMHg3MCwgMHgwMiwgMHg3MSwgMHgwMiwgMHg5RCwgMHgwMSwg
MHg3MywgMHgwMiwKKwkweDc0LCAweDAyLCAweDlGLCAweDAxLCAweDc2LCAweDAyLCAweDc3LCAw
eDAyLAorCTB4NzgsIDB4MDIsIDB4NzksIDB4MDIsIDB4N0EsIDB4MDIsIDB4N0IsIDB4MDIsCisJ
MHg3QywgMHgwMiwgMHg2NCwgMHgyQywgMHg3RSwgMHgwMiwgMHg3RiwgMHgwMiwKKwkweEE2LCAw
eDAxLCAweDgxLCAweDAyLCAweDgyLCAweDAyLCAweEE5LCAweDAxLAorCTB4ODQsIDB4MDIsIDB4
ODUsIDB4MDIsIDB4ODYsIDB4MDIsIDB4ODcsIDB4MDIsCisJMHhBRSwgMHgwMSwgMHg0NCwgMHgw
MiwgMHhCMSwgMHgwMSwgMHhCMiwgMHgwMSwKKwkweDQ1LCAweDAyLCAweDhELCAweDAyLCAweDhF
LCAweDAyLCAweDhGLCAweDAyLAorCTB4OTAsIDB4MDIsIDB4OTEsIDB4MDIsIDB4QjcsIDB4MDEs
IDB4OTMsIDB4MDIsCisJMHg5NCwgMHgwMiwgMHg5NSwgMHgwMiwgMHg5NiwgMHgwMiwgMHg5Nywg
MHgwMiwKKwkweDk4LCAweDAyLCAweDk5LCAweDAyLCAweDlBLCAweDAyLCAweDlCLCAweDAyLAor
CTB4OUMsIDB4MDIsIDB4OUQsIDB4MDIsIDB4OUUsIDB4MDIsIDB4OUYsIDB4MDIsCisJMHhBMCwg
MHgwMiwgMHhBMSwgMHgwMiwgMHhBMiwgMHgwMiwgMHhBMywgMHgwMiwKKwkweEE0LCAweDAyLCAw
eEE1LCAweDAyLCAweEE2LCAweDAyLCAweEE3LCAweDAyLAorCTB4QTgsIDB4MDIsIDB4QTksIDB4
MDIsIDB4QUEsIDB4MDIsIDB4QUIsIDB4MDIsCisJMHhBQywgMHgwMiwgMHhBRCwgMHgwMiwgMHhB
RSwgMHgwMiwgMHhBRiwgMHgwMiwKKwkweEIwLCAweDAyLCAweEIxLCAweDAyLCAweEIyLCAweDAy
LCAweEIzLCAweDAyLAorCTB4QjQsIDB4MDIsIDB4QjUsIDB4MDIsIDB4QjYsIDB4MDIsIDB4Qjcs
IDB4MDIsCisJMHhCOCwgMHgwMiwgMHhCOSwgMHgwMiwgMHhCQSwgMHgwMiwgMHhCQiwgMHgwMiwK
KwkweEJDLCAweDAyLCAweEJELCAweDAyLCAweEJFLCAweDAyLCAweEJGLCAweDAyLAorCTB4QzAs
IDB4MDIsIDB4QzEsIDB4MDIsIDB4QzIsIDB4MDIsIDB4QzMsIDB4MDIsCisJMHhDNCwgMHgwMiwg
MHhDNSwgMHgwMiwgMHhDNiwgMHgwMiwgMHhDNywgMHgwMiwKKwkweEM4LCAweDAyLCAweEM5LCAw
eDAyLCAweENBLCAweDAyLCAweENCLCAweDAyLAorCTB4Q0MsIDB4MDIsIDB4Q0QsIDB4MDIsIDB4
Q0UsIDB4MDIsIDB4Q0YsIDB4MDIsCisJMHhEMCwgMHgwMiwgMHhEMSwgMHgwMiwgMHhEMiwgMHgw
MiwgMHhEMywgMHgwMiwKKwkweEQ0LCAweDAyLCAweEQ1LCAweDAyLCAweEQ2LCAweDAyLCAweEQ3
LCAweDAyLAorCTB4RDgsIDB4MDIsIDB4RDksIDB4MDIsIDB4REEsIDB4MDIsIDB4REIsIDB4MDIs
CisJMHhEQywgMHgwMiwgMHhERCwgMHgwMiwgMHhERSwgMHgwMiwgMHhERiwgMHgwMiwKKwkweEUw
LCAweDAyLCAweEUxLCAweDAyLCAweEUyLCAweDAyLCAweEUzLCAweDAyLAorCTB4RTQsIDB4MDIs
IDB4RTUsIDB4MDIsIDB4RTYsIDB4MDIsIDB4RTcsIDB4MDIsCisJMHhFOCwgMHgwMiwgMHhFOSwg
MHgwMiwgMHhFQSwgMHgwMiwgMHhFQiwgMHgwMiwKKwkweEVDLCAweDAyLCAweEVELCAweDAyLCAw
eEVFLCAweDAyLCAweEVGLCAweDAyLAorCTB4RjAsIDB4MDIsIDB4RjEsIDB4MDIsIDB4RjIsIDB4
MDIsIDB4RjMsIDB4MDIsCisJMHhGNCwgMHgwMiwgMHhGNSwgMHgwMiwgMHhGNiwgMHgwMiwgMHhG
NywgMHgwMiwKKwkweEY4LCAweDAyLCAweEY5LCAweDAyLCAweEZBLCAweDAyLCAweEZCLCAweDAy
LAorCTB4RkMsIDB4MDIsIDB4RkQsIDB4MDIsIDB4RkUsIDB4MDIsIDB4RkYsIDB4MDIsCisJMHgw
MCwgMHgwMywgMHgwMSwgMHgwMywgMHgwMiwgMHgwMywgMHgwMywgMHgwMywKKwkweDA0LCAweDAz
LCAweDA1LCAweDAzLCAweDA2LCAweDAzLCAweDA3LCAweDAzLAorCTB4MDgsIDB4MDMsIDB4MDks
IDB4MDMsIDB4MEEsIDB4MDMsIDB4MEIsIDB4MDMsCisJMHgwQywgMHgwMywgMHgwRCwgMHgwMywg
MHgwRSwgMHgwMywgMHgwRiwgMHgwMywKKwkweDEwLCAweDAzLCAweDExLCAweDAzLCAweDEyLCAw
eDAzLCAweDEzLCAweDAzLAorCTB4MTQsIDB4MDMsIDB4MTUsIDB4MDMsIDB4MTYsIDB4MDMsIDB4
MTcsIDB4MDMsCisJMHgxOCwgMHgwMywgMHgxOSwgMHgwMywgMHgxQSwgMHgwMywgMHgxQiwgMHgw
MywKKwkweDFDLCAweDAzLCAweDFELCAweDAzLCAweDFFLCAweDAzLCAweDFGLCAweDAzLAorCTB4
MjAsIDB4MDMsIDB4MjEsIDB4MDMsIDB4MjIsIDB4MDMsIDB4MjMsIDB4MDMsCisJMHgyNCwgMHgw
MywgMHgyNSwgMHgwMywgMHgyNiwgMHgwMywgMHgyNywgMHgwMywKKwkweDI4LCAweDAzLCAweDI5
LCAweDAzLCAweDJBLCAweDAzLCAweDJCLCAweDAzLAorCTB4MkMsIDB4MDMsIDB4MkQsIDB4MDMs
IDB4MkUsIDB4MDMsIDB4MkYsIDB4MDMsCisJMHgzMCwgMHgwMywgMHgzMSwgMHgwMywgMHgzMiwg
MHgwMywgMHgzMywgMHgwMywKKwkweDM0LCAweDAzLCAweDM1LCAweDAzLCAweDM2LCAweDAzLCAw
eDM3LCAweDAzLAorCTB4MzgsIDB4MDMsIDB4MzksIDB4MDMsIDB4M0EsIDB4MDMsIDB4M0IsIDB4
MDMsCisJMHgzQywgMHgwMywgMHgzRCwgMHgwMywgMHgzRSwgMHgwMywgMHgzRiwgMHgwMywKKwkw
eDQwLCAweDAzLCAweDQxLCAweDAzLCAweDQyLCAweDAzLCAweDQzLCAweDAzLAorCTB4NDQsIDB4
MDMsIDB4NDUsIDB4MDMsIDB4NDYsIDB4MDMsIDB4NDcsIDB4MDMsCisJMHg0OCwgMHgwMywgMHg0
OSwgMHgwMywgMHg0QSwgMHgwMywgMHg0QiwgMHgwMywKKwkweDRDLCAweDAzLCAweDRELCAweDAz
LCAweDRFLCAweDAzLCAweDRGLCAweDAzLAorCTB4NTAsIDB4MDMsIDB4NTEsIDB4MDMsIDB4NTIs
IDB4MDMsIDB4NTMsIDB4MDMsCisJMHg1NCwgMHgwMywgMHg1NSwgMHgwMywgMHg1NiwgMHgwMywg
MHg1NywgMHgwMywKKwkweDU4LCAweDAzLCAweDU5LCAweDAzLCAweDVBLCAweDAzLCAweDVCLCAw
eDAzLAorCTB4NUMsIDB4MDMsIDB4NUQsIDB4MDMsIDB4NUUsIDB4MDMsIDB4NUYsIDB4MDMsCisJ
MHg2MCwgMHgwMywgMHg2MSwgMHgwMywgMHg2MiwgMHgwMywgMHg2MywgMHgwMywKKwkweDY0LCAw
eDAzLCAweDY1LCAweDAzLCAweDY2LCAweDAzLCAweDY3LCAweDAzLAorCTB4NjgsIDB4MDMsIDB4
NjksIDB4MDMsIDB4NkEsIDB4MDMsIDB4NkIsIDB4MDMsCisJMHg2QywgMHgwMywgMHg2RCwgMHgw
MywgMHg2RSwgMHgwMywgMHg2RiwgMHgwMywKKwkweDcwLCAweDAzLCAweDcxLCAweDAzLCAweDcy
LCAweDAzLCAweDczLCAweDAzLAorCTB4NzQsIDB4MDMsIDB4NzUsIDB4MDMsIDB4NzYsIDB4MDMs
IDB4NzcsIDB4MDMsCisJMHg3OCwgMHgwMywgMHg3OSwgMHgwMywgMHg3QSwgMHgwMywgMHhGRCwg
MHgwMywKKwkweEZFLCAweDAzLCAweEZGLCAweDAzLCAweDdFLCAweDAzLCAweDdGLCAweDAzLAor
CTB4ODAsIDB4MDMsIDB4ODEsIDB4MDMsIDB4ODIsIDB4MDMsIDB4ODMsIDB4MDMsCisJMHg4NCwg
MHgwMywgMHg4NSwgMHgwMywgMHg4NiwgMHgwMywgMHg4NywgMHgwMywKKwkweDg4LCAweDAzLCAw
eDg5LCAweDAzLCAweDhBLCAweDAzLCAweDhCLCAweDAzLAorCTB4OEMsIDB4MDMsIDB4OEQsIDB4
MDMsIDB4OEUsIDB4MDMsIDB4OEYsIDB4MDMsCisJMHg5MCwgMHgwMywgMHg5MSwgMHgwMywgMHg5
MiwgMHgwMywgMHg5MywgMHgwMywKKwkweDk0LCAweDAzLCAweDk1LCAweDAzLCAweDk2LCAweDAz
LCAweDk3LCAweDAzLAorCTB4OTgsIDB4MDMsIDB4OTksIDB4MDMsIDB4OUEsIDB4MDMsIDB4OUIs
IDB4MDMsCisJMHg5QywgMHgwMywgMHg5RCwgMHgwMywgMHg5RSwgMHgwMywgMHg5RiwgMHgwMywK
KwkweEEwLCAweDAzLCAweEExLCAweDAzLCAweEEyLCAweDAzLCAweEEzLCAweDAzLAorCTB4QTQs
IDB4MDMsIDB4QTUsIDB4MDMsIDB4QTYsIDB4MDMsIDB4QTcsIDB4MDMsCisJMHhBOCwgMHgwMywg
MHhBOSwgMHgwMywgMHhBQSwgMHgwMywgMHhBQiwgMHgwMywKKwkweDg2LCAweDAzLCAweDg4LCAw
eDAzLCAweDg5LCAweDAzLCAweDhBLCAweDAzLAorCTB4QjAsIDB4MDMsIDB4OTEsIDB4MDMsIDB4
OTIsIDB4MDMsIDB4OTMsIDB4MDMsCisJMHg5NCwgMHgwMywgMHg5NSwgMHgwMywgMHg5NiwgMHgw
MywgMHg5NywgMHgwMywKKwkweDk4LCAweDAzLCAweDk5LCAweDAzLCAweDlBLCAweDAzLCAweDlC
LCAweDAzLAorCTB4OUMsIDB4MDMsIDB4OUQsIDB4MDMsIDB4OUUsIDB4MDMsIDB4OUYsIDB4MDMs
CisJMHhBMCwgMHgwMywgMHhBMSwgMHgwMywgMHhBMywgMHgwMywgMHhBMywgMHgwMywKKwkweEE0
LCAweDAzLCAweEE1LCAweDAzLCAweEE2LCAweDAzLCAweEE3LCAweDAzLAorCTB4QTgsIDB4MDMs
IDB4QTksIDB4MDMsIDB4QUEsIDB4MDMsIDB4QUIsIDB4MDMsCisJMHg4QywgMHgwMywgMHg4RSwg
MHgwMywgMHg4RiwgMHgwMywgMHhDRiwgMHgwMywKKwkweEQwLCAweDAzLCAweEQxLCAweDAzLCAw
eEQyLCAweDAzLCAweEQzLCAweDAzLAorCTB4RDQsIDB4MDMsIDB4RDUsIDB4MDMsIDB4RDYsIDB4
MDMsIDB4RDcsIDB4MDMsCisJMHhEOCwgMHgwMywgMHhEOCwgMHgwMywgMHhEQSwgMHgwMywgMHhE
QSwgMHgwMywKKwkweERDLCAweDAzLCAweERDLCAweDAzLCAweERFLCAweDAzLCAweERFLCAweDAz
LAorCTB4RTAsIDB4MDMsIDB4RTAsIDB4MDMsIDB4RTIsIDB4MDMsIDB4RTIsIDB4MDMsCisJMHhF
NCwgMHgwMywgMHhFNCwgMHgwMywgMHhFNiwgMHgwMywgMHhFNiwgMHgwMywKKwkweEU4LCAweDAz
LCAweEU4LCAweDAzLCAweEVBLCAweDAzLCAweEVBLCAweDAzLAorCTB4RUMsIDB4MDMsIDB4RUMs
IDB4MDMsIDB4RUUsIDB4MDMsIDB4RUUsIDB4MDMsCisJMHhGMCwgMHgwMywgMHhGMSwgMHgwMywg
MHhGOSwgMHgwMywgMHhGMywgMHgwMywKKwkweEY0LCAweDAzLCAweEY1LCAweDAzLCAweEY2LCAw
eDAzLCAweEY3LCAweDAzLAorCTB4RjcsIDB4MDMsIDB4RjksIDB4MDMsIDB4RkEsIDB4MDMsIDB4
RkEsIDB4MDMsCisJMHhGQywgMHgwMywgMHhGRCwgMHgwMywgMHhGRSwgMHgwMywgMHhGRiwgMHgw
MywKKwkweDAwLCAweDA0LCAweDAxLCAweDA0LCAweDAyLCAweDA0LCAweDAzLCAweDA0LAorCTB4
MDQsIDB4MDQsIDB4MDUsIDB4MDQsIDB4MDYsIDB4MDQsIDB4MDcsIDB4MDQsCisJMHgwOCwgMHgw
NCwgMHgwOSwgMHgwNCwgMHgwQSwgMHgwNCwgMHgwQiwgMHgwNCwKKwkweDBDLCAweDA0LCAweDBE
LCAweDA0LCAweDBFLCAweDA0LCAweDBGLCAweDA0LAorCTB4MTAsIDB4MDQsIDB4MTEsIDB4MDQs
IDB4MTIsIDB4MDQsIDB4MTMsIDB4MDQsCisJMHgxNCwgMHgwNCwgMHgxNSwgMHgwNCwgMHgxNiwg
MHgwNCwgMHgxNywgMHgwNCwKKwkweDE4LCAweDA0LCAweDE5LCAweDA0LCAweDFBLCAweDA0LCAw
eDFCLCAweDA0LAorCTB4MUMsIDB4MDQsIDB4MUQsIDB4MDQsIDB4MUUsIDB4MDQsIDB4MUYsIDB4
MDQsCisJMHgyMCwgMHgwNCwgMHgyMSwgMHgwNCwgMHgyMiwgMHgwNCwgMHgyMywgMHgwNCwKKwkw
eDI0LCAweDA0LCAweDI1LCAweDA0LCAweDI2LCAweDA0LCAweDI3LCAweDA0LAorCTB4MjgsIDB4
MDQsIDB4MjksIDB4MDQsIDB4MkEsIDB4MDQsIDB4MkIsIDB4MDQsCisJMHgyQywgMHgwNCwgMHgy
RCwgMHgwNCwgMHgyRSwgMHgwNCwgMHgyRiwgMHgwNCwKKwkweDEwLCAweDA0LCAweDExLCAweDA0
LCAweDEyLCAweDA0LCAweDEzLCAweDA0LAorCTB4MTQsIDB4MDQsIDB4MTUsIDB4MDQsIDB4MTYs
IDB4MDQsIDB4MTcsIDB4MDQsCisJMHgxOCwgMHgwNCwgMHgxOSwgMHgwNCwgMHgxQSwgMHgwNCwg
MHgxQiwgMHgwNCwKKwkweDFDLCAweDA0LCAweDFELCAweDA0LCAweDFFLCAweDA0LCAweDFGLCAw
eDA0LAorCTB4MjAsIDB4MDQsIDB4MjEsIDB4MDQsIDB4MjIsIDB4MDQsIDB4MjMsIDB4MDQsCisJ
MHgyNCwgMHgwNCwgMHgyNSwgMHgwNCwgMHgyNiwgMHgwNCwgMHgyNywgMHgwNCwKKwkweDI4LCAw
eDA0LCAweDI5LCAweDA0LCAweDJBLCAweDA0LCAweDJCLCAweDA0LAorCTB4MkMsIDB4MDQsIDB4
MkQsIDB4MDQsIDB4MkUsIDB4MDQsIDB4MkYsIDB4MDQsCisJMHgwMCwgMHgwNCwgMHgwMSwgMHgw
NCwgMHgwMiwgMHgwNCwgMHgwMywgMHgwNCwKKwkweDA0LCAweDA0LCAweDA1LCAweDA0LCAweDA2
LCAweDA0LCAweDA3LCAweDA0LAorCTB4MDgsIDB4MDQsIDB4MDksIDB4MDQsIDB4MEEsIDB4MDQs
IDB4MEIsIDB4MDQsCisJMHgwQywgMHgwNCwgMHgwRCwgMHgwNCwgMHgwRSwgMHgwNCwgMHgwRiwg
MHgwNCwKKwkweDYwLCAweDA0LCAweDYwLCAweDA0LCAweDYyLCAweDA0LCAweDYyLCAweDA0LAor
CTB4NjQsIDB4MDQsIDB4NjQsIDB4MDQsIDB4NjYsIDB4MDQsIDB4NjYsIDB4MDQsCisJMHg2OCwg
MHgwNCwgMHg2OCwgMHgwNCwgMHg2QSwgMHgwNCwgMHg2QSwgMHgwNCwKKwkweDZDLCAweDA0LCAw
eDZDLCAweDA0LCAweDZFLCAweDA0LCAweDZFLCAweDA0LAorCTB4NzAsIDB4MDQsIDB4NzAsIDB4
MDQsIDB4NzIsIDB4MDQsIDB4NzIsIDB4MDQsCisJMHg3NCwgMHgwNCwgMHg3NCwgMHgwNCwgMHg3
NiwgMHgwNCwgMHg3NiwgMHgwNCwKKwkweDc4LCAweDA0LCAweDc4LCAweDA0LCAweDdBLCAweDA0
LCAweDdBLCAweDA0LAorCTB4N0MsIDB4MDQsIDB4N0MsIDB4MDQsIDB4N0UsIDB4MDQsIDB4N0Us
IDB4MDQsCisJMHg4MCwgMHgwNCwgMHg4MCwgMHgwNCwgMHg4MiwgMHgwNCwgMHg4MywgMHgwNCwK
KwkweDg0LCAweDA0LCAweDg1LCAweDA0LCAweDg2LCAweDA0LCAweDg3LCAweDA0LAorCTB4ODgs
IDB4MDQsIDB4ODksIDB4MDQsIDB4OEEsIDB4MDQsIDB4OEEsIDB4MDQsCisJMHg4QywgMHgwNCwg
MHg4QywgMHgwNCwgMHg4RSwgMHgwNCwgMHg4RSwgMHgwNCwKKwkweDkwLCAweDA0LCAweDkwLCAw
eDA0LCAweDkyLCAweDA0LCAweDkyLCAweDA0LAorCTB4OTQsIDB4MDQsIDB4OTQsIDB4MDQsIDB4
OTYsIDB4MDQsIDB4OTYsIDB4MDQsCisJMHg5OCwgMHgwNCwgMHg5OCwgMHgwNCwgMHg5QSwgMHgw
NCwgMHg5QSwgMHgwNCwKKwkweDlDLCAweDA0LCAweDlDLCAweDA0LCAweDlFLCAweDA0LCAweDlF
LCAweDA0LAorCTB4QTAsIDB4MDQsIDB4QTAsIDB4MDQsIDB4QTIsIDB4MDQsIDB4QTIsIDB4MDQs
CisJMHhBNCwgMHgwNCwgMHhBNCwgMHgwNCwgMHhBNiwgMHgwNCwgMHhBNiwgMHgwNCwKKwkweEE4
LCAweDA0LCAweEE4LCAweDA0LCAweEFBLCAweDA0LCAweEFBLCAweDA0LAorCTB4QUMsIDB4MDQs
IDB4QUMsIDB4MDQsIDB4QUUsIDB4MDQsIDB4QUUsIDB4MDQsCisJMHhCMCwgMHgwNCwgMHhCMCwg
MHgwNCwgMHhCMiwgMHgwNCwgMHhCMiwgMHgwNCwKKwkweEI0LCAweDA0LCAweEI0LCAweDA0LCAw
eEI2LCAweDA0LCAweEI2LCAweDA0LAorCTB4QjgsIDB4MDQsIDB4QjgsIDB4MDQsIDB4QkEsIDB4
MDQsIDB4QkEsIDB4MDQsCisJMHhCQywgMHgwNCwgMHhCQywgMHgwNCwgMHhCRSwgMHgwNCwgMHhC
RSwgMHgwNCwKKwkweEMwLCAweDA0LCAweEMxLCAweDA0LCAweEMxLCAweDA0LCAweEMzLCAweDA0
LAorCTB4QzMsIDB4MDQsIDB4QzUsIDB4MDQsIDB4QzUsIDB4MDQsIDB4QzcsIDB4MDQsCisJMHhD
NywgMHgwNCwgMHhDOSwgMHgwNCwgMHhDOSwgMHgwNCwgMHhDQiwgMHgwNCwKKwkweENCLCAweDA0
LCAweENELCAweDA0LCAweENELCAweDA0LCAweEMwLCAweDA0LAorCTB4RDAsIDB4MDQsIDB4RDAs
IDB4MDQsIDB4RDIsIDB4MDQsIDB4RDIsIDB4MDQsCisJMHhENCwgMHgwNCwgMHhENCwgMHgwNCwg
MHhENiwgMHgwNCwgMHhENiwgMHgwNCwKKwkweEQ4LCAweDA0LCAweEQ4LCAweDA0LCAweERBLCAw
eDA0LCAweERBLCAweDA0LAorCTB4REMsIDB4MDQsIDB4REMsIDB4MDQsIDB4REUsIDB4MDQsIDB4
REUsIDB4MDQsCisJMHhFMCwgMHgwNCwgMHhFMCwgMHgwNCwgMHhFMiwgMHgwNCwgMHhFMiwgMHgw
NCwKKwkweEU0LCAweDA0LCAweEU0LCAweDA0LCAweEU2LCAweDA0LCAweEU2LCAweDA0LAorCTB4
RTgsIDB4MDQsIDB4RTgsIDB4MDQsIDB4RUEsIDB4MDQsIDB4RUEsIDB4MDQsCisJMHhFQywgMHgw
NCwgMHhFQywgMHgwNCwgMHhFRSwgMHgwNCwgMHhFRSwgMHgwNCwKKwkweEYwLCAweDA0LCAweEYw
LCAweDA0LCAweEYyLCAweDA0LCAweEYyLCAweDA0LAorCTB4RjQsIDB4MDQsIDB4RjQsIDB4MDQs
IDB4RjYsIDB4MDQsIDB4RjYsIDB4MDQsCisJMHhGOCwgMHgwNCwgMHhGOCwgMHgwNCwgMHhGQSwg
MHgwNCwgMHhGQSwgMHgwNCwKKwkweEZDLCAweDA0LCAweEZDLCAweDA0LCAweEZFLCAweDA0LCAw
eEZFLCAweDA0LAorCTB4MDAsIDB4MDUsIDB4MDAsIDB4MDUsIDB4MDIsIDB4MDUsIDB4MDIsIDB4
MDUsCisJMHgwNCwgMHgwNSwgMHgwNCwgMHgwNSwgMHgwNiwgMHgwNSwgMHgwNiwgMHgwNSwKKwkw
eDA4LCAweDA1LCAweDA4LCAweDA1LCAweDBBLCAweDA1LCAweDBBLCAweDA1LAorCTB4MEMsIDB4
MDUsIDB4MEMsIDB4MDUsIDB4MEUsIDB4MDUsIDB4MEUsIDB4MDUsCisJMHgxMCwgMHgwNSwgMHgx
MCwgMHgwNSwgMHgxMiwgMHgwNSwgMHgxMiwgMHgwNSwKKwkweDE0LCAweDA1LCAweDE1LCAweDA1
LCAweDE2LCAweDA1LCAweDE3LCAweDA1LAorCTB4MTgsIDB4MDUsIDB4MTksIDB4MDUsIDB4MUEs
IDB4MDUsIDB4MUIsIDB4MDUsCisJMHgxQywgMHgwNSwgMHgxRCwgMHgwNSwgMHgxRSwgMHgwNSwg
MHgxRiwgMHgwNSwKKwkweDIwLCAweDA1LCAweDIxLCAweDA1LCAweDIyLCAweDA1LCAweDIzLCAw
eDA1LAorCTB4MjQsIDB4MDUsIDB4MjUsIDB4MDUsIDB4MjYsIDB4MDUsIDB4MjcsIDB4MDUsCisJ
MHgyOCwgMHgwNSwgMHgyOSwgMHgwNSwgMHgyQSwgMHgwNSwgMHgyQiwgMHgwNSwKKwkweDJDLCAw
eDA1LCAweDJELCAweDA1LCAweDJFLCAweDA1LCAweDJGLCAweDA1LAorCTB4MzAsIDB4MDUsIDB4
MzEsIDB4MDUsIDB4MzIsIDB4MDUsIDB4MzMsIDB4MDUsCisJMHgzNCwgMHgwNSwgMHgzNSwgMHgw
NSwgMHgzNiwgMHgwNSwgMHgzNywgMHgwNSwKKwkweDM4LCAweDA1LCAweDM5LCAweDA1LCAweDNB
LCAweDA1LCAweDNCLCAweDA1LAorCTB4M0MsIDB4MDUsIDB4M0QsIDB4MDUsIDB4M0UsIDB4MDUs
IDB4M0YsIDB4MDUsCisJMHg0MCwgMHgwNSwgMHg0MSwgMHgwNSwgMHg0MiwgMHgwNSwgMHg0Mywg
MHgwNSwKKwkweDQ0LCAweDA1LCAweDQ1LCAweDA1LCAweDQ2LCAweDA1LCAweDQ3LCAweDA1LAor
CTB4NDgsIDB4MDUsIDB4NDksIDB4MDUsIDB4NEEsIDB4MDUsIDB4NEIsIDB4MDUsCisJMHg0Qywg
MHgwNSwgMHg0RCwgMHgwNSwgMHg0RSwgMHgwNSwgMHg0RiwgMHgwNSwKKwkweDUwLCAweDA1LCAw
eDUxLCAweDA1LCAweDUyLCAweDA1LCAweDUzLCAweDA1LAorCTB4NTQsIDB4MDUsIDB4NTUsIDB4
MDUsIDB4NTYsIDB4MDUsIDB4NTcsIDB4MDUsCisJMHg1OCwgMHgwNSwgMHg1OSwgMHgwNSwgMHg1
QSwgMHgwNSwgMHg1QiwgMHgwNSwKKwkweDVDLCAweDA1LCAweDVELCAweDA1LCAweDVFLCAweDA1
LCAweDVGLCAweDA1LAorCTB4NjAsIDB4MDUsIDB4MzEsIDB4MDUsIDB4MzIsIDB4MDUsIDB4MzMs
IDB4MDUsCisJMHgzNCwgMHgwNSwgMHgzNSwgMHgwNSwgMHgzNiwgMHgwNSwgMHgzNywgMHgwNSwK
KwkweDM4LCAweDA1LCAweDM5LCAweDA1LCAweDNBLCAweDA1LCAweDNCLCAweDA1LAorCTB4M0Ms
IDB4MDUsIDB4M0QsIDB4MDUsIDB4M0UsIDB4MDUsIDB4M0YsIDB4MDUsCisJMHg0MCwgMHgwNSwg
MHg0MSwgMHgwNSwgMHg0MiwgMHgwNSwgMHg0MywgMHgwNSwKKwkweDQ0LCAweDA1LCAweDQ1LCAw
eDA1LCAweDQ2LCAweDA1LCAweDQ3LCAweDA1LAorCTB4NDgsIDB4MDUsIDB4NDksIDB4MDUsIDB4
NEEsIDB4MDUsIDB4NEIsIDB4MDUsCisJMHg0QywgMHgwNSwgMHg0RCwgMHgwNSwgMHg0RSwgMHgw
NSwgMHg0RiwgMHgwNSwKKwkweDUwLCAweDA1LCAweDUxLCAweDA1LCAweDUyLCAweDA1LCAweDUz
LCAweDA1LAorCTB4NTQsIDB4MDUsIDB4NTUsIDB4MDUsIDB4NTYsIDB4MDUsIDB4RkYsIDB4RkYs
CisJMHhGNiwgMHgxNywgMHg2MywgMHgyQywgMHg3RSwgMHgxRCwgMHg3RiwgMHgxRCwKKwkweDgw
LCAweDFELCAweDgxLCAweDFELCAweDgyLCAweDFELCAweDgzLCAweDFELAorCTB4ODQsIDB4MUQs
IDB4ODUsIDB4MUQsIDB4ODYsIDB4MUQsIDB4ODcsIDB4MUQsCisJMHg4OCwgMHgxRCwgMHg4OSwg
MHgxRCwgMHg4QSwgMHgxRCwgMHg4QiwgMHgxRCwKKwkweDhDLCAweDFELCAweDhELCAweDFELCAw
eDhFLCAweDFELCAweDhGLCAweDFELAorCTB4OTAsIDB4MUQsIDB4OTEsIDB4MUQsIDB4OTIsIDB4
MUQsIDB4OTMsIDB4MUQsCisJMHg5NCwgMHgxRCwgMHg5NSwgMHgxRCwgMHg5NiwgMHgxRCwgMHg5
NywgMHgxRCwKKwkweDk4LCAweDFELCAweDk5LCAweDFELCAweDlBLCAweDFELCAweDlCLCAweDFE
LAorCTB4OUMsIDB4MUQsIDB4OUQsIDB4MUQsIDB4OUUsIDB4MUQsIDB4OUYsIDB4MUQsCisJMHhB
MCwgMHgxRCwgMHhBMSwgMHgxRCwgMHhBMiwgMHgxRCwgMHhBMywgMHgxRCwKKwkweEE0LCAweDFE
LCAweEE1LCAweDFELCAweEE2LCAweDFELCAweEE3LCAweDFELAorCTB4QTgsIDB4MUQsIDB4QTks
IDB4MUQsIDB4QUEsIDB4MUQsIDB4QUIsIDB4MUQsCisJMHhBQywgMHgxRCwgMHhBRCwgMHgxRCwg
MHhBRSwgMHgxRCwgMHhBRiwgMHgxRCwKKwkweEIwLCAweDFELCAweEIxLCAweDFELCAweEIyLCAw
eDFELCAweEIzLCAweDFELAorCTB4QjQsIDB4MUQsIDB4QjUsIDB4MUQsIDB4QjYsIDB4MUQsIDB4
QjcsIDB4MUQsCisJMHhCOCwgMHgxRCwgMHhCOSwgMHgxRCwgMHhCQSwgMHgxRCwgMHhCQiwgMHgx
RCwKKwkweEJDLCAweDFELCAweEJELCAweDFELCAweEJFLCAweDFELCAweEJGLCAweDFELAorCTB4
QzAsIDB4MUQsIDB4QzEsIDB4MUQsIDB4QzIsIDB4MUQsIDB4QzMsIDB4MUQsCisJMHhDNCwgMHgx
RCwgMHhDNSwgMHgxRCwgMHhDNiwgMHgxRCwgMHhDNywgMHgxRCwKKwkweEM4LCAweDFELCAweEM5
LCAweDFELCAweENBLCAweDFELCAweENCLCAweDFELAorCTB4Q0MsIDB4MUQsIDB4Q0QsIDB4MUQs
IDB4Q0UsIDB4MUQsIDB4Q0YsIDB4MUQsCisJMHhEMCwgMHgxRCwgMHhEMSwgMHgxRCwgMHhEMiwg
MHgxRCwgMHhEMywgMHgxRCwKKwkweEQ0LCAweDFELCAweEQ1LCAweDFELCAweEQ2LCAweDFELCAw
eEQ3LCAweDFELAorCTB4RDgsIDB4MUQsIDB4RDksIDB4MUQsIDB4REEsIDB4MUQsIDB4REIsIDB4
MUQsCisJMHhEQywgMHgxRCwgMHhERCwgMHgxRCwgMHhERSwgMHgxRCwgMHhERiwgMHgxRCwKKwkw
eEUwLCAweDFELCAweEUxLCAweDFELCAweEUyLCAweDFELCAweEUzLCAweDFELAorCTB4RTQsIDB4
MUQsIDB4RTUsIDB4MUQsIDB4RTYsIDB4MUQsIDB4RTcsIDB4MUQsCisJMHhFOCwgMHgxRCwgMHhF
OSwgMHgxRCwgMHhFQSwgMHgxRCwgMHhFQiwgMHgxRCwKKwkweEVDLCAweDFELCAweEVELCAweDFE
LCAweEVFLCAweDFELCAweEVGLCAweDFELAorCTB4RjAsIDB4MUQsIDB4RjEsIDB4MUQsIDB4RjIs
IDB4MUQsIDB4RjMsIDB4MUQsCisJMHhGNCwgMHgxRCwgMHhGNSwgMHgxRCwgMHhGNiwgMHgxRCwg
MHhGNywgMHgxRCwKKwkweEY4LCAweDFELCAweEY5LCAweDFELCAweEZBLCAweDFELCAweEZCLCAw
eDFELAorCTB4RkMsIDB4MUQsIDB4RkQsIDB4MUQsIDB4RkUsIDB4MUQsIDB4RkYsIDB4MUQsCisJ
MHgwMCwgMHgxRSwgMHgwMCwgMHgxRSwgMHgwMiwgMHgxRSwgMHgwMiwgMHgxRSwKKwkweDA0LCAw
eDFFLCAweDA0LCAweDFFLCAweDA2LCAweDFFLCAweDA2LCAweDFFLAorCTB4MDgsIDB4MUUsIDB4
MDgsIDB4MUUsIDB4MEEsIDB4MUUsIDB4MEEsIDB4MUUsCisJMHgwQywgMHgxRSwgMHgwQywgMHgx
RSwgMHgwRSwgMHgxRSwgMHgwRSwgMHgxRSwKKwkweDEwLCAweDFFLCAweDEwLCAweDFFLCAweDEy
LCAweDFFLCAweDEyLCAweDFFLAorCTB4MTQsIDB4MUUsIDB4MTQsIDB4MUUsIDB4MTYsIDB4MUUs
IDB4MTYsIDB4MUUsCisJMHgxOCwgMHgxRSwgMHgxOCwgMHgxRSwgMHgxQSwgMHgxRSwgMHgxQSwg
MHgxRSwKKwkweDFDLCAweDFFLCAweDFDLCAweDFFLCAweDFFLCAweDFFLCAweDFFLCAweDFFLAor
CTB4MjAsIDB4MUUsIDB4MjAsIDB4MUUsIDB4MjIsIDB4MUUsIDB4MjIsIDB4MUUsCisJMHgyNCwg
MHgxRSwgMHgyNCwgMHgxRSwgMHgyNiwgMHgxRSwgMHgyNiwgMHgxRSwKKwkweDI4LCAweDFFLCAw
eDI4LCAweDFFLCAweDJBLCAweDFFLCAweDJBLCAweDFFLAorCTB4MkMsIDB4MUUsIDB4MkMsIDB4
MUUsIDB4MkUsIDB4MUUsIDB4MkUsIDB4MUUsCisJMHgzMCwgMHgxRSwgMHgzMCwgMHgxRSwgMHgz
MiwgMHgxRSwgMHgzMiwgMHgxRSwKKwkweDM0LCAweDFFLCAweDM0LCAweDFFLCAweDM2LCAweDFF
LCAweDM2LCAweDFFLAorCTB4MzgsIDB4MUUsIDB4MzgsIDB4MUUsIDB4M0EsIDB4MUUsIDB4M0Es
IDB4MUUsCisJMHgzQywgMHgxRSwgMHgzQywgMHgxRSwgMHgzRSwgMHgxRSwgMHgzRSwgMHgxRSwK
KwkweDQwLCAweDFFLCAweDQwLCAweDFFLCAweDQyLCAweDFFLCAweDQyLCAweDFFLAorCTB4NDQs
IDB4MUUsIDB4NDQsIDB4MUUsIDB4NDYsIDB4MUUsIDB4NDYsIDB4MUUsCisJMHg0OCwgMHgxRSwg
MHg0OCwgMHgxRSwgMHg0QSwgMHgxRSwgMHg0QSwgMHgxRSwKKwkweDRDLCAweDFFLCAweDRDLCAw
eDFFLCAweDRFLCAweDFFLCAweDRFLCAweDFFLAorCTB4NTAsIDB4MUUsIDB4NTAsIDB4MUUsIDB4
NTIsIDB4MUUsIDB4NTIsIDB4MUUsCisJMHg1NCwgMHgxRSwgMHg1NCwgMHgxRSwgMHg1NiwgMHgx
RSwgMHg1NiwgMHgxRSwKKwkweDU4LCAweDFFLCAweDU4LCAweDFFLCAweDVBLCAweDFFLCAweDVB
LCAweDFFLAorCTB4NUMsIDB4MUUsIDB4NUMsIDB4MUUsIDB4NUUsIDB4MUUsIDB4NUUsIDB4MUUs
CisJMHg2MCwgMHgxRSwgMHg2MCwgMHgxRSwgMHg2MiwgMHgxRSwgMHg2MiwgMHgxRSwKKwkweDY0
LCAweDFFLCAweDY0LCAweDFFLCAweDY2LCAweDFFLCAweDY2LCAweDFFLAorCTB4NjgsIDB4MUUs
IDB4NjgsIDB4MUUsIDB4NkEsIDB4MUUsIDB4NkEsIDB4MUUsCisJMHg2QywgMHgxRSwgMHg2Qywg
MHgxRSwgMHg2RSwgMHgxRSwgMHg2RSwgMHgxRSwKKwkweDcwLCAweDFFLCAweDcwLCAweDFFLCAw
eDcyLCAweDFFLCAweDcyLCAweDFFLAorCTB4NzQsIDB4MUUsIDB4NzQsIDB4MUUsIDB4NzYsIDB4
MUUsIDB4NzYsIDB4MUUsCisJMHg3OCwgMHgxRSwgMHg3OCwgMHgxRSwgMHg3QSwgMHgxRSwgMHg3
QSwgMHgxRSwKKwkweDdDLCAweDFFLCAweDdDLCAweDFFLCAweDdFLCAweDFFLCAweDdFLCAweDFF
LAorCTB4ODAsIDB4MUUsIDB4ODAsIDB4MUUsIDB4ODIsIDB4MUUsIDB4ODIsIDB4MUUsCisJMHg4
NCwgMHgxRSwgMHg4NCwgMHgxRSwgMHg4NiwgMHgxRSwgMHg4NiwgMHgxRSwKKwkweDg4LCAweDFF
LCAweDg4LCAweDFFLCAweDhBLCAweDFFLCAweDhBLCAweDFFLAorCTB4OEMsIDB4MUUsIDB4OEMs
IDB4MUUsIDB4OEUsIDB4MUUsIDB4OEUsIDB4MUUsCisJMHg5MCwgMHgxRSwgMHg5MCwgMHgxRSwg
MHg5MiwgMHgxRSwgMHg5MiwgMHgxRSwKKwkweDk0LCAweDFFLCAweDk0LCAweDFFLCAweDk2LCAw
eDFFLCAweDk3LCAweDFFLAorCTB4OTgsIDB4MUUsIDB4OTksIDB4MUUsIDB4OUEsIDB4MUUsIDB4
OUIsIDB4MUUsCisJMHg5QywgMHgxRSwgMHg5RCwgMHgxRSwgMHg5RSwgMHgxRSwgMHg5RiwgMHgx
RSwKKwkweEEwLCAweDFFLCAweEEwLCAweDFFLCAweEEyLCAweDFFLCAweEEyLCAweDFFLAorCTB4
QTQsIDB4MUUsIDB4QTQsIDB4MUUsIDB4QTYsIDB4MUUsIDB4QTYsIDB4MUUsCisJMHhBOCwgMHgx
RSwgMHhBOCwgMHgxRSwgMHhBQSwgMHgxRSwgMHhBQSwgMHgxRSwKKwkweEFDLCAweDFFLCAweEFD
LCAweDFFLCAweEFFLCAweDFFLCAweEFFLCAweDFFLAorCTB4QjAsIDB4MUUsIDB4QjAsIDB4MUUs
IDB4QjIsIDB4MUUsIDB4QjIsIDB4MUUsCisJMHhCNCwgMHgxRSwgMHhCNCwgMHgxRSwgMHhCNiwg
MHgxRSwgMHhCNiwgMHgxRSwKKwkweEI4LCAweDFFLCAweEI4LCAweDFFLCAweEJBLCAweDFFLCAw
eEJBLCAweDFFLAorCTB4QkMsIDB4MUUsIDB4QkMsIDB4MUUsIDB4QkUsIDB4MUUsIDB4QkUsIDB4
MUUsCisJMHhDMCwgMHgxRSwgMHhDMCwgMHgxRSwgMHhDMiwgMHgxRSwgMHhDMiwgMHgxRSwKKwkw
eEM0LCAweDFFLCAweEM0LCAweDFFLCAweEM2LCAweDFFLCAweEM2LCAweDFFLAorCTB4QzgsIDB4
MUUsIDB4QzgsIDB4MUUsIDB4Q0EsIDB4MUUsIDB4Q0EsIDB4MUUsCisJMHhDQywgMHgxRSwgMHhD
QywgMHgxRSwgMHhDRSwgMHgxRSwgMHhDRSwgMHgxRSwKKwkweEQwLCAweDFFLCAweEQwLCAweDFF
LCAweEQyLCAweDFFLCAweEQyLCAweDFFLAorCTB4RDQsIDB4MUUsIDB4RDQsIDB4MUUsIDB4RDYs
IDB4MUUsIDB4RDYsIDB4MUUsCisJMHhEOCwgMHgxRSwgMHhEOCwgMHgxRSwgMHhEQSwgMHgxRSwg
MHhEQSwgMHgxRSwKKwkweERDLCAweDFFLCAweERDLCAweDFFLCAweERFLCAweDFFLCAweERFLCAw
eDFFLAorCTB4RTAsIDB4MUUsIDB4RTAsIDB4MUUsIDB4RTIsIDB4MUUsIDB4RTIsIDB4MUUsCisJ
MHhFNCwgMHgxRSwgMHhFNCwgMHgxRSwgMHhFNiwgMHgxRSwgMHhFNiwgMHgxRSwKKwkweEU4LCAw
eDFFLCAweEU4LCAweDFFLCAweEVBLCAweDFFLCAweEVBLCAweDFFLAorCTB4RUMsIDB4MUUsIDB4
RUMsIDB4MUUsIDB4RUUsIDB4MUUsIDB4RUUsIDB4MUUsCisJMHhGMCwgMHgxRSwgMHhGMCwgMHgx
RSwgMHhGMiwgMHgxRSwgMHhGMiwgMHgxRSwKKwkweEY0LCAweDFFLCAweEY0LCAweDFFLCAweEY2
LCAweDFFLCAweEY2LCAweDFFLAorCTB4RjgsIDB4MUUsIDB4RjgsIDB4MUUsIDB4RkEsIDB4MUUs
IDB4RkIsIDB4MUUsCisJMHhGQywgMHgxRSwgMHhGRCwgMHgxRSwgMHhGRSwgMHgxRSwgMHhGRiwg
MHgxRSwKKwkweDA4LCAweDFGLCAweDA5LCAweDFGLCAweDBBLCAweDFGLCAweDBCLCAweDFGLAor
CTB4MEMsIDB4MUYsIDB4MEQsIDB4MUYsIDB4MEUsIDB4MUYsIDB4MEYsIDB4MUYsCisJMHgwOCwg
MHgxRiwgMHgwOSwgMHgxRiwgMHgwQSwgMHgxRiwgMHgwQiwgMHgxRiwKKwkweDBDLCAweDFGLCAw
eDBELCAweDFGLCAweDBFLCAweDFGLCAweDBGLCAweDFGLAorCTB4MTgsIDB4MUYsIDB4MTksIDB4
MUYsIDB4MUEsIDB4MUYsIDB4MUIsIDB4MUYsCisJMHgxQywgMHgxRiwgMHgxRCwgMHgxRiwgMHgx
NiwgMHgxRiwgMHgxNywgMHgxRiwKKwkweDE4LCAweDFGLCAweDE5LCAweDFGLCAweDFBLCAweDFG
LCAweDFCLCAweDFGLAorCTB4MUMsIDB4MUYsIDB4MUQsIDB4MUYsIDB4MUUsIDB4MUYsIDB4MUYs
IDB4MUYsCisJMHgyOCwgMHgxRiwgMHgyOSwgMHgxRiwgMHgyQSwgMHgxRiwgMHgyQiwgMHgxRiwK
KwkweDJDLCAweDFGLCAweDJELCAweDFGLCAweDJFLCAweDFGLCAweDJGLCAweDFGLAorCTB4Mjgs
IDB4MUYsIDB4MjksIDB4MUYsIDB4MkEsIDB4MUYsIDB4MkIsIDB4MUYsCisJMHgyQywgMHgxRiwg
MHgyRCwgMHgxRiwgMHgyRSwgMHgxRiwgMHgyRiwgMHgxRiwKKwkweDM4LCAweDFGLCAweDM5LCAw
eDFGLCAweDNBLCAweDFGLCAweDNCLCAweDFGLAorCTB4M0MsIDB4MUYsIDB4M0QsIDB4MUYsIDB4
M0UsIDB4MUYsIDB4M0YsIDB4MUYsCisJMHgzOCwgMHgxRiwgMHgzOSwgMHgxRiwgMHgzQSwgMHgx
RiwgMHgzQiwgMHgxRiwKKwkweDNDLCAweDFGLCAweDNELCAweDFGLCAweDNFLCAweDFGLCAweDNG
LCAweDFGLAorCTB4NDgsIDB4MUYsIDB4NDksIDB4MUYsIDB4NEEsIDB4MUYsIDB4NEIsIDB4MUYs
CisJMHg0QywgMHgxRiwgMHg0RCwgMHgxRiwgMHg0NiwgMHgxRiwgMHg0NywgMHgxRiwKKwkweDQ4
LCAweDFGLCAweDQ5LCAweDFGLCAweDRBLCAweDFGLCAweDRCLCAweDFGLAorCTB4NEMsIDB4MUYs
IDB4NEQsIDB4MUYsIDB4NEUsIDB4MUYsIDB4NEYsIDB4MUYsCisJMHg1MCwgMHgxRiwgMHg1OSwg
MHgxRiwgMHg1MiwgMHgxRiwgMHg1QiwgMHgxRiwKKwkweDU0LCAweDFGLCAweDVELCAweDFGLCAw
eDU2LCAweDFGLCAweDVGLCAweDFGLAorCTB4NTgsIDB4MUYsIDB4NTksIDB4MUYsIDB4NUEsIDB4
MUYsIDB4NUIsIDB4MUYsCisJMHg1QywgMHgxRiwgMHg1RCwgMHgxRiwgMHg1RSwgMHgxRiwgMHg1
RiwgMHgxRiwKKwkweDY4LCAweDFGLCAweDY5LCAweDFGLCAweDZBLCAweDFGLCAweDZCLCAweDFG
LAorCTB4NkMsIDB4MUYsIDB4NkQsIDB4MUYsIDB4NkUsIDB4MUYsIDB4NkYsIDB4MUYsCisJMHg2
OCwgMHgxRiwgMHg2OSwgMHgxRiwgMHg2QSwgMHgxRiwgMHg2QiwgMHgxRiwKKwkweDZDLCAweDFG
LCAweDZELCAweDFGLCAweDZFLCAweDFGLCAweDZGLCAweDFGLAorCTB4QkEsIDB4MUYsIDB4QkIs
IDB4MUYsIDB4QzgsIDB4MUYsIDB4QzksIDB4MUYsCisJMHhDQSwgMHgxRiwgMHhDQiwgMHgxRiwg
MHhEQSwgMHgxRiwgMHhEQiwgMHgxRiwKKwkweEY4LCAweDFGLCAweEY5LCAweDFGLCAweEVBLCAw
eDFGLCAweEVCLCAweDFGLAorCTB4RkEsIDB4MUYsIDB4RkIsIDB4MUYsIDB4N0UsIDB4MUYsIDB4
N0YsIDB4MUYsCisJMHg4OCwgMHgxRiwgMHg4OSwgMHgxRiwgMHg4QSwgMHgxRiwgMHg4QiwgMHgx
RiwKKwkweDhDLCAweDFGLCAweDhELCAweDFGLCAweDhFLCAweDFGLCAweDhGLCAweDFGLAorCTB4
ODgsIDB4MUYsIDB4ODksIDB4MUYsIDB4OEEsIDB4MUYsIDB4OEIsIDB4MUYsCisJMHg4QywgMHgx
RiwgMHg4RCwgMHgxRiwgMHg4RSwgMHgxRiwgMHg4RiwgMHgxRiwKKwkweDk4LCAweDFGLCAweDk5
LCAweDFGLCAweDlBLCAweDFGLCAweDlCLCAweDFGLAorCTB4OUMsIDB4MUYsIDB4OUQsIDB4MUYs
IDB4OUUsIDB4MUYsIDB4OUYsIDB4MUYsCisJMHg5OCwgMHgxRiwgMHg5OSwgMHgxRiwgMHg5QSwg
MHgxRiwgMHg5QiwgMHgxRiwKKwkweDlDLCAweDFGLCAweDlELCAweDFGLCAweDlFLCAweDFGLCAw
eDlGLCAweDFGLAorCTB4QTgsIDB4MUYsIDB4QTksIDB4MUYsIDB4QUEsIDB4MUYsIDB4QUIsIDB4
MUYsCisJMHhBQywgMHgxRiwgMHhBRCwgMHgxRiwgMHhBRSwgMHgxRiwgMHhBRiwgMHgxRiwKKwkw
eEE4LCAweDFGLCAweEE5LCAweDFGLCAweEFBLCAweDFGLCAweEFCLCAweDFGLAorCTB4QUMsIDB4
MUYsIDB4QUQsIDB4MUYsIDB4QUUsIDB4MUYsIDB4QUYsIDB4MUYsCisJMHhCOCwgMHgxRiwgMHhC
OSwgMHgxRiwgMHhCMiwgMHgxRiwgMHhCQywgMHgxRiwKKwkweEI0LCAweDFGLCAweEI1LCAweDFG
LCAweEI2LCAweDFGLCAweEI3LCAweDFGLAorCTB4QjgsIDB4MUYsIDB4QjksIDB4MUYsIDB4QkEs
IDB4MUYsIDB4QkIsIDB4MUYsCisJMHhCQywgMHgxRiwgMHhCRCwgMHgxRiwgMHhCRSwgMHgxRiwg
MHhCRiwgMHgxRiwKKwkweEMwLCAweDFGLCAweEMxLCAweDFGLCAweEMyLCAweDFGLCAweEMzLCAw
eDFGLAorCTB4QzQsIDB4MUYsIDB4QzUsIDB4MUYsIDB4QzYsIDB4MUYsIDB4QzcsIDB4MUYsCisJ
MHhDOCwgMHgxRiwgMHhDOSwgMHgxRiwgMHhDQSwgMHgxRiwgMHhDQiwgMHgxRiwKKwkweEMzLCAw
eDFGLCAweENELCAweDFGLCAweENFLCAweDFGLCAweENGLCAweDFGLAorCTB4RDgsIDB4MUYsIDB4
RDksIDB4MUYsIDB4RDIsIDB4MUYsIDB4RDMsIDB4MUYsCisJMHhENCwgMHgxRiwgMHhENSwgMHgx
RiwgMHhENiwgMHgxRiwgMHhENywgMHgxRiwKKwkweEQ4LCAweDFGLCAweEQ5LCAweDFGLCAweERB
LCAweDFGLCAweERCLCAweDFGLAorCTB4REMsIDB4MUYsIDB4REQsIDB4MUYsIDB4REUsIDB4MUYs
IDB4REYsIDB4MUYsCisJMHhFOCwgMHgxRiwgMHhFOSwgMHgxRiwgMHhFMiwgMHgxRiwgMHhFMywg
MHgxRiwKKwkweEU0LCAweDFGLCAweEVDLCAweDFGLCAweEU2LCAweDFGLCAweEU3LCAweDFGLAor
CTB4RTgsIDB4MUYsIDB4RTksIDB4MUYsIDB4RUEsIDB4MUYsIDB4RUIsIDB4MUYsCisJMHhFQywg
MHgxRiwgMHhFRCwgMHgxRiwgMHhFRSwgMHgxRiwgMHhFRiwgMHgxRiwKKwkweEYwLCAweDFGLCAw
eEYxLCAweDFGLCAweEYyLCAweDFGLCAweEYzLCAweDFGLAorCTB4RjQsIDB4MUYsIDB4RjUsIDB4
MUYsIDB4RjYsIDB4MUYsIDB4RjcsIDB4MUYsCisJMHhGOCwgMHgxRiwgMHhGOSwgMHgxRiwgMHhG
QSwgMHgxRiwgMHhGQiwgMHgxRiwKKwkweEYzLCAweDFGLCAweEZELCAweDFGLCAweEZFLCAweDFG
LCAweEZGLCAweDFGLAorCTB4MDAsIDB4MjAsIDB4MDEsIDB4MjAsIDB4MDIsIDB4MjAsIDB4MDMs
IDB4MjAsCisJMHgwNCwgMHgyMCwgMHgwNSwgMHgyMCwgMHgwNiwgMHgyMCwgMHgwNywgMHgyMCwK
KwkweDA4LCAweDIwLCAweDA5LCAweDIwLCAweDBBLCAweDIwLCAweDBCLCAweDIwLAorCTB4MEMs
IDB4MjAsIDB4MEQsIDB4MjAsIDB4MEUsIDB4MjAsIDB4MEYsIDB4MjAsCisJMHgxMCwgMHgyMCwg
MHgxMSwgMHgyMCwgMHgxMiwgMHgyMCwgMHgxMywgMHgyMCwKKwkweDE0LCAweDIwLCAweDE1LCAw
eDIwLCAweDE2LCAweDIwLCAweDE3LCAweDIwLAorCTB4MTgsIDB4MjAsIDB4MTksIDB4MjAsIDB4
MUEsIDB4MjAsIDB4MUIsIDB4MjAsCisJMHgxQywgMHgyMCwgMHgxRCwgMHgyMCwgMHgxRSwgMHgy
MCwgMHgxRiwgMHgyMCwKKwkweDIwLCAweDIwLCAweDIxLCAweDIwLCAweDIyLCAweDIwLCAweDIz
LCAweDIwLAorCTB4MjQsIDB4MjAsIDB4MjUsIDB4MjAsIDB4MjYsIDB4MjAsIDB4MjcsIDB4MjAs
CisJMHgyOCwgMHgyMCwgMHgyOSwgMHgyMCwgMHgyQSwgMHgyMCwgMHgyQiwgMHgyMCwKKwkweDJD
LCAweDIwLCAweDJELCAweDIwLCAweDJFLCAweDIwLCAweDJGLCAweDIwLAorCTB4MzAsIDB4MjAs
IDB4MzEsIDB4MjAsIDB4MzIsIDB4MjAsIDB4MzMsIDB4MjAsCisJMHgzNCwgMHgyMCwgMHgzNSwg
MHgyMCwgMHgzNiwgMHgyMCwgMHgzNywgMHgyMCwKKwkweDM4LCAweDIwLCAweDM5LCAweDIwLCAw
eDNBLCAweDIwLCAweDNCLCAweDIwLAorCTB4M0MsIDB4MjAsIDB4M0QsIDB4MjAsIDB4M0UsIDB4
MjAsIDB4M0YsIDB4MjAsCisJMHg0MCwgMHgyMCwgMHg0MSwgMHgyMCwgMHg0MiwgMHgyMCwgMHg0
MywgMHgyMCwKKwkweDQ0LCAweDIwLCAweDQ1LCAweDIwLCAweDQ2LCAweDIwLCAweDQ3LCAweDIw
LAorCTB4NDgsIDB4MjAsIDB4NDksIDB4MjAsIDB4NEEsIDB4MjAsIDB4NEIsIDB4MjAsCisJMHg0
QywgMHgyMCwgMHg0RCwgMHgyMCwgMHg0RSwgMHgyMCwgMHg0RiwgMHgyMCwKKwkweDUwLCAweDIw
LCAweDUxLCAweDIwLCAweDUyLCAweDIwLCAweDUzLCAweDIwLAorCTB4NTQsIDB4MjAsIDB4NTUs
IDB4MjAsIDB4NTYsIDB4MjAsIDB4NTcsIDB4MjAsCisJMHg1OCwgMHgyMCwgMHg1OSwgMHgyMCwg
MHg1QSwgMHgyMCwgMHg1QiwgMHgyMCwKKwkweDVDLCAweDIwLCAweDVELCAweDIwLCAweDVFLCAw
eDIwLCAweDVGLCAweDIwLAorCTB4NjAsIDB4MjAsIDB4NjEsIDB4MjAsIDB4NjIsIDB4MjAsIDB4
NjMsIDB4MjAsCisJMHg2NCwgMHgyMCwgMHg2NSwgMHgyMCwgMHg2NiwgMHgyMCwgMHg2NywgMHgy
MCwKKwkweDY4LCAweDIwLCAweDY5LCAweDIwLCAweDZBLCAweDIwLCAweDZCLCAweDIwLAorCTB4
NkMsIDB4MjAsIDB4NkQsIDB4MjAsIDB4NkUsIDB4MjAsIDB4NkYsIDB4MjAsCisJMHg3MCwgMHgy
MCwgMHg3MSwgMHgyMCwgMHg3MiwgMHgyMCwgMHg3MywgMHgyMCwKKwkweDc0LCAweDIwLCAweDc1
LCAweDIwLCAweDc2LCAweDIwLCAweDc3LCAweDIwLAorCTB4NzgsIDB4MjAsIDB4NzksIDB4MjAs
IDB4N0EsIDB4MjAsIDB4N0IsIDB4MjAsCisJMHg3QywgMHgyMCwgMHg3RCwgMHgyMCwgMHg3RSwg
MHgyMCwgMHg3RiwgMHgyMCwKKwkweDgwLCAweDIwLCAweDgxLCAweDIwLCAweDgyLCAweDIwLCAw
eDgzLCAweDIwLAorCTB4ODQsIDB4MjAsIDB4ODUsIDB4MjAsIDB4ODYsIDB4MjAsIDB4ODcsIDB4
MjAsCisJMHg4OCwgMHgyMCwgMHg4OSwgMHgyMCwgMHg4QSwgMHgyMCwgMHg4QiwgMHgyMCwKKwkw
eDhDLCAweDIwLCAweDhELCAweDIwLCAweDhFLCAweDIwLCAweDhGLCAweDIwLAorCTB4OTAsIDB4
MjAsIDB4OTEsIDB4MjAsIDB4OTIsIDB4MjAsIDB4OTMsIDB4MjAsCisJMHg5NCwgMHgyMCwgMHg5
NSwgMHgyMCwgMHg5NiwgMHgyMCwgMHg5NywgMHgyMCwKKwkweDk4LCAweDIwLCAweDk5LCAweDIw
LCAweDlBLCAweDIwLCAweDlCLCAweDIwLAorCTB4OUMsIDB4MjAsIDB4OUQsIDB4MjAsIDB4OUUs
IDB4MjAsIDB4OUYsIDB4MjAsCisJMHhBMCwgMHgyMCwgMHhBMSwgMHgyMCwgMHhBMiwgMHgyMCwg
MHhBMywgMHgyMCwKKwkweEE0LCAweDIwLCAweEE1LCAweDIwLCAweEE2LCAweDIwLCAweEE3LCAw
eDIwLAorCTB4QTgsIDB4MjAsIDB4QTksIDB4MjAsIDB4QUEsIDB4MjAsIDB4QUIsIDB4MjAsCisJ
MHhBQywgMHgyMCwgMHhBRCwgMHgyMCwgMHhBRSwgMHgyMCwgMHhBRiwgMHgyMCwKKwkweEIwLCAw
eDIwLCAweEIxLCAweDIwLCAweEIyLCAweDIwLCAweEIzLCAweDIwLAorCTB4QjQsIDB4MjAsIDB4
QjUsIDB4MjAsIDB4QjYsIDB4MjAsIDB4QjcsIDB4MjAsCisJMHhCOCwgMHgyMCwgMHhCOSwgMHgy
MCwgMHhCQSwgMHgyMCwgMHhCQiwgMHgyMCwKKwkweEJDLCAweDIwLCAweEJELCAweDIwLCAweEJF
LCAweDIwLCAweEJGLCAweDIwLAorCTB4QzAsIDB4MjAsIDB4QzEsIDB4MjAsIDB4QzIsIDB4MjAs
IDB4QzMsIDB4MjAsCisJMHhDNCwgMHgyMCwgMHhDNSwgMHgyMCwgMHhDNiwgMHgyMCwgMHhDNywg
MHgyMCwKKwkweEM4LCAweDIwLCAweEM5LCAweDIwLCAweENBLCAweDIwLCAweENCLCAweDIwLAor
CTB4Q0MsIDB4MjAsIDB4Q0QsIDB4MjAsIDB4Q0UsIDB4MjAsIDB4Q0YsIDB4MjAsCisJMHhEMCwg
MHgyMCwgMHhEMSwgMHgyMCwgMHhEMiwgMHgyMCwgMHhEMywgMHgyMCwKKwkweEQ0LCAweDIwLCAw
eEQ1LCAweDIwLCAweEQ2LCAweDIwLCAweEQ3LCAweDIwLAorCTB4RDgsIDB4MjAsIDB4RDksIDB4
MjAsIDB4REEsIDB4MjAsIDB4REIsIDB4MjAsCisJMHhEQywgMHgyMCwgMHhERCwgMHgyMCwgMHhE
RSwgMHgyMCwgMHhERiwgMHgyMCwKKwkweEUwLCAweDIwLCAweEUxLCAweDIwLCAweEUyLCAweDIw
LCAweEUzLCAweDIwLAorCTB4RTQsIDB4MjAsIDB4RTUsIDB4MjAsIDB4RTYsIDB4MjAsIDB4RTcs
IDB4MjAsCisJMHhFOCwgMHgyMCwgMHhFOSwgMHgyMCwgMHhFQSwgMHgyMCwgMHhFQiwgMHgyMCwK
KwkweEVDLCAweDIwLCAweEVELCAweDIwLCAweEVFLCAweDIwLCAweEVGLCAweDIwLAorCTB4RjAs
IDB4MjAsIDB4RjEsIDB4MjAsIDB4RjIsIDB4MjAsIDB4RjMsIDB4MjAsCisJMHhGNCwgMHgyMCwg
MHhGNSwgMHgyMCwgMHhGNiwgMHgyMCwgMHhGNywgMHgyMCwKKwkweEY4LCAweDIwLCAweEY5LCAw
eDIwLCAweEZBLCAweDIwLCAweEZCLCAweDIwLAorCTB4RkMsIDB4MjAsIDB4RkQsIDB4MjAsIDB4
RkUsIDB4MjAsIDB4RkYsIDB4MjAsCisJMHgwMCwgMHgyMSwgMHgwMSwgMHgyMSwgMHgwMiwgMHgy
MSwgMHgwMywgMHgyMSwKKwkweDA0LCAweDIxLCAweDA1LCAweDIxLCAweDA2LCAweDIxLCAweDA3
LCAweDIxLAorCTB4MDgsIDB4MjEsIDB4MDksIDB4MjEsIDB4MEEsIDB4MjEsIDB4MEIsIDB4MjEs
CisJMHgwQywgMHgyMSwgMHgwRCwgMHgyMSwgMHgwRSwgMHgyMSwgMHgwRiwgMHgyMSwKKwkweDEw
LCAweDIxLCAweDExLCAweDIxLCAweDEyLCAweDIxLCAweDEzLCAweDIxLAorCTB4MTQsIDB4MjEs
IDB4MTUsIDB4MjEsIDB4MTYsIDB4MjEsIDB4MTcsIDB4MjEsCisJMHgxOCwgMHgyMSwgMHgxOSwg
MHgyMSwgMHgxQSwgMHgyMSwgMHgxQiwgMHgyMSwKKwkweDFDLCAweDIxLCAweDFELCAweDIxLCAw
eDFFLCAweDIxLCAweDFGLCAweDIxLAorCTB4MjAsIDB4MjEsIDB4MjEsIDB4MjEsIDB4MjIsIDB4
MjEsIDB4MjMsIDB4MjEsCisJMHgyNCwgMHgyMSwgMHgyNSwgMHgyMSwgMHgyNiwgMHgyMSwgMHgy
NywgMHgyMSwKKwkweDI4LCAweDIxLCAweDI5LCAweDIxLCAweDJBLCAweDIxLCAweDJCLCAweDIx
LAorCTB4MkMsIDB4MjEsIDB4MkQsIDB4MjEsIDB4MkUsIDB4MjEsIDB4MkYsIDB4MjEsCisJMHgz
MCwgMHgyMSwgMHgzMSwgMHgyMSwgMHgzMiwgMHgyMSwgMHgzMywgMHgyMSwKKwkweDM0LCAweDIx
LCAweDM1LCAweDIxLCAweDM2LCAweDIxLCAweDM3LCAweDIxLAorCTB4MzgsIDB4MjEsIDB4Mzks
IDB4MjEsIDB4M0EsIDB4MjEsIDB4M0IsIDB4MjEsCisJMHgzQywgMHgyMSwgMHgzRCwgMHgyMSwg
MHgzRSwgMHgyMSwgMHgzRiwgMHgyMSwKKwkweDQwLCAweDIxLCAweDQxLCAweDIxLCAweDQyLCAw
eDIxLCAweDQzLCAweDIxLAorCTB4NDQsIDB4MjEsIDB4NDUsIDB4MjEsIDB4NDYsIDB4MjEsIDB4
NDcsIDB4MjEsCisJMHg0OCwgMHgyMSwgMHg0OSwgMHgyMSwgMHg0QSwgMHgyMSwgMHg0QiwgMHgy
MSwKKwkweDRDLCAweDIxLCAweDRELCAweDIxLCAweDMyLCAweDIxLCAweDRGLCAweDIxLAorCTB4
NTAsIDB4MjEsIDB4NTEsIDB4MjEsIDB4NTIsIDB4MjEsIDB4NTMsIDB4MjEsCisJMHg1NCwgMHgy
MSwgMHg1NSwgMHgyMSwgMHg1NiwgMHgyMSwgMHg1NywgMHgyMSwKKwkweDU4LCAweDIxLCAweDU5
LCAweDIxLCAweDVBLCAweDIxLCAweDVCLCAweDIxLAorCTB4NUMsIDB4MjEsIDB4NUQsIDB4MjEs
IDB4NUUsIDB4MjEsIDB4NUYsIDB4MjEsCisJMHg2MCwgMHgyMSwgMHg2MSwgMHgyMSwgMHg2Miwg
MHgyMSwgMHg2MywgMHgyMSwKKwkweDY0LCAweDIxLCAweDY1LCAweDIxLCAweDY2LCAweDIxLCAw
eDY3LCAweDIxLAorCTB4NjgsIDB4MjEsIDB4NjksIDB4MjEsIDB4NkEsIDB4MjEsIDB4NkIsIDB4
MjEsCisJMHg2QywgMHgyMSwgMHg2RCwgMHgyMSwgMHg2RSwgMHgyMSwgMHg2RiwgMHgyMSwKKwkw
eDYwLCAweDIxLCAweDYxLCAweDIxLCAweDYyLCAweDIxLCAweDYzLCAweDIxLAorCTB4NjQsIDB4
MjEsIDB4NjUsIDB4MjEsIDB4NjYsIDB4MjEsIDB4NjcsIDB4MjEsCisJMHg2OCwgMHgyMSwgMHg2
OSwgMHgyMSwgMHg2QSwgMHgyMSwgMHg2QiwgMHgyMSwKKwkweDZDLCAweDIxLCAweDZELCAweDIx
LCAweDZFLCAweDIxLCAweDZGLCAweDIxLAorCTB4ODAsIDB4MjEsIDB4ODEsIDB4MjEsIDB4ODIs
IDB4MjEsIDB4ODMsIDB4MjEsCisJMHg4MywgMHgyMSwgMHhGRiwgMHhGRiwgMHg0QiwgMHgwMywg
MHhCNiwgMHgyNCwKKwkweEI3LCAweDI0LCAweEI4LCAweDI0LCAweEI5LCAweDI0LCAweEJBLCAw
eDI0LAorCTB4QkIsIDB4MjQsIDB4QkMsIDB4MjQsIDB4QkQsIDB4MjQsIDB4QkUsIDB4MjQsCisJ
MHhCRiwgMHgyNCwgMHhDMCwgMHgyNCwgMHhDMSwgMHgyNCwgMHhDMiwgMHgyNCwKKwkweEMzLCAw
eDI0LCAweEM0LCAweDI0LCAweEM1LCAweDI0LCAweEM2LCAweDI0LAorCTB4QzcsIDB4MjQsIDB4
QzgsIDB4MjQsIDB4QzksIDB4MjQsIDB4Q0EsIDB4MjQsCisJMHhDQiwgMHgyNCwgMHhDQywgMHgy
NCwgMHhDRCwgMHgyNCwgMHhDRSwgMHgyNCwKKwkweENGLCAweDI0LCAweEZGLCAweEZGLCAweDQ2
LCAweDA3LCAweDAwLCAweDJDLAorCTB4MDEsIDB4MkMsIDB4MDIsIDB4MkMsIDB4MDMsIDB4MkMs
IDB4MDQsIDB4MkMsCisJMHgwNSwgMHgyQywgMHgwNiwgMHgyQywgMHgwNywgMHgyQywgMHgwOCwg
MHgyQywKKwkweDA5LCAweDJDLCAweDBBLCAweDJDLCAweDBCLCAweDJDLCAweDBDLCAweDJDLAor
CTB4MEQsIDB4MkMsIDB4MEUsIDB4MkMsIDB4MEYsIDB4MkMsIDB4MTAsIDB4MkMsCisJMHgxMSwg
MHgyQywgMHgxMiwgMHgyQywgMHgxMywgMHgyQywgMHgxNCwgMHgyQywKKwkweDE1LCAweDJDLCAw
eDE2LCAweDJDLCAweDE3LCAweDJDLCAweDE4LCAweDJDLAorCTB4MTksIDB4MkMsIDB4MUEsIDB4
MkMsIDB4MUIsIDB4MkMsIDB4MUMsIDB4MkMsCisJMHgxRCwgMHgyQywgMHgxRSwgMHgyQywgMHgx
RiwgMHgyQywgMHgyMCwgMHgyQywKKwkweDIxLCAweDJDLCAweDIyLCAweDJDLCAweDIzLCAweDJD
LCAweDI0LCAweDJDLAorCTB4MjUsIDB4MkMsIDB4MjYsIDB4MkMsIDB4MjcsIDB4MkMsIDB4Mjgs
IDB4MkMsCisJMHgyOSwgMHgyQywgMHgyQSwgMHgyQywgMHgyQiwgMHgyQywgMHgyQywgMHgyQywK
KwkweDJELCAweDJDLCAweDJFLCAweDJDLCAweDVGLCAweDJDLCAweDYwLCAweDJDLAorCTB4NjAs
IDB4MkMsIDB4NjIsIDB4MkMsIDB4NjMsIDB4MkMsIDB4NjQsIDB4MkMsCisJMHg2NSwgMHgyQywg
MHg2NiwgMHgyQywgMHg2NywgMHgyQywgMHg2NywgMHgyQywKKwkweDY5LCAweDJDLCAweDY5LCAw
eDJDLCAweDZCLCAweDJDLCAweDZCLCAweDJDLAorCTB4NkQsIDB4MkMsIDB4NkUsIDB4MkMsIDB4
NkYsIDB4MkMsIDB4NzAsIDB4MkMsCisJMHg3MSwgMHgyQywgMHg3MiwgMHgyQywgMHg3MywgMHgy
QywgMHg3NCwgMHgyQywKKwkweDc1LCAweDJDLCAweDc1LCAweDJDLCAweDc3LCAweDJDLCAweDc4
LCAweDJDLAorCTB4NzksIDB4MkMsIDB4N0EsIDB4MkMsIDB4N0IsIDB4MkMsIDB4N0MsIDB4MkMs
CisJMHg3RCwgMHgyQywgMHg3RSwgMHgyQywgMHg3RiwgMHgyQywgMHg4MCwgMHgyQywKKwkweDgw
LCAweDJDLCAweDgyLCAweDJDLCAweDgyLCAweDJDLCAweDg0LCAweDJDLAorCTB4ODQsIDB4MkMs
IDB4ODYsIDB4MkMsIDB4ODYsIDB4MkMsIDB4ODgsIDB4MkMsCisJMHg4OCwgMHgyQywgMHg4QSwg
MHgyQywgMHg4QSwgMHgyQywgMHg4QywgMHgyQywKKwkweDhDLCAweDJDLCAweDhFLCAweDJDLCAw
eDhFLCAweDJDLCAweDkwLCAweDJDLAorCTB4OTAsIDB4MkMsIDB4OTIsIDB4MkMsIDB4OTIsIDB4
MkMsIDB4OTQsIDB4MkMsCisJMHg5NCwgMHgyQywgMHg5NiwgMHgyQywgMHg5NiwgMHgyQywgMHg5
OCwgMHgyQywKKwkweDk4LCAweDJDLCAweDlBLCAweDJDLCAweDlBLCAweDJDLCAweDlDLCAweDJD
LAorCTB4OUMsIDB4MkMsIDB4OUUsIDB4MkMsIDB4OUUsIDB4MkMsIDB4QTAsIDB4MkMsCisJMHhB
MCwgMHgyQywgMHhBMiwgMHgyQywgMHhBMiwgMHgyQywgMHhBNCwgMHgyQywKKwkweEE0LCAweDJD
LCAweEE2LCAweDJDLCAweEE2LCAweDJDLCAweEE4LCAweDJDLAorCTB4QTgsIDB4MkMsIDB4QUEs
IDB4MkMsIDB4QUEsIDB4MkMsIDB4QUMsIDB4MkMsCisJMHhBQywgMHgyQywgMHhBRSwgMHgyQywg
MHhBRSwgMHgyQywgMHhCMCwgMHgyQywKKwkweEIwLCAweDJDLCAweEIyLCAweDJDLCAweEIyLCAw
eDJDLCAweEI0LCAweDJDLAorCTB4QjQsIDB4MkMsIDB4QjYsIDB4MkMsIDB4QjYsIDB4MkMsIDB4
QjgsIDB4MkMsCisJMHhCOCwgMHgyQywgMHhCQSwgMHgyQywgMHhCQSwgMHgyQywgMHhCQywgMHgy
QywKKwkweEJDLCAweDJDLCAweEJFLCAweDJDLCAweEJFLCAweDJDLCAweEMwLCAweDJDLAorCTB4
QzAsIDB4MkMsIDB4QzIsIDB4MkMsIDB4QzIsIDB4MkMsIDB4QzQsIDB4MkMsCisJMHhDNCwgMHgy
QywgMHhDNiwgMHgyQywgMHhDNiwgMHgyQywgMHhDOCwgMHgyQywKKwkweEM4LCAweDJDLCAweENB
LCAweDJDLCAweENBLCAweDJDLCAweENDLCAweDJDLAorCTB4Q0MsIDB4MkMsIDB4Q0UsIDB4MkMs
IDB4Q0UsIDB4MkMsIDB4RDAsIDB4MkMsCisJMHhEMCwgMHgyQywgMHhEMiwgMHgyQywgMHhEMiwg
MHgyQywgMHhENCwgMHgyQywKKwkweEQ0LCAweDJDLCAweEQ2LCAweDJDLCAweEQ2LCAweDJDLCAw
eEQ4LCAweDJDLAorCTB4RDgsIDB4MkMsIDB4REEsIDB4MkMsIDB4REEsIDB4MkMsIDB4REMsIDB4
MkMsCisJMHhEQywgMHgyQywgMHhERSwgMHgyQywgMHhERSwgMHgyQywgMHhFMCwgMHgyQywKKwkw
eEUwLCAweDJDLCAweEUyLCAweDJDLCAweEUyLCAweDJDLCAweEU0LCAweDJDLAorCTB4RTUsIDB4
MkMsIDB4RTYsIDB4MkMsIDB4RTcsIDB4MkMsIDB4RTgsIDB4MkMsCisJMHhFOSwgMHgyQywgMHhF
QSwgMHgyQywgMHhFQiwgMHgyQywgMHhFQywgMHgyQywKKwkweEVELCAweDJDLCAweEVFLCAweDJD
LCAweEVGLCAweDJDLCAweEYwLCAweDJDLAorCTB4RjEsIDB4MkMsIDB4RjIsIDB4MkMsIDB4RjMs
IDB4MkMsIDB4RjQsIDB4MkMsCisJMHhGNSwgMHgyQywgMHhGNiwgMHgyQywgMHhGNywgMHgyQywg
MHhGOCwgMHgyQywKKwkweEY5LCAweDJDLCAweEZBLCAweDJDLCAweEZCLCAweDJDLCAweEZDLCAw
eDJDLAorCTB4RkQsIDB4MkMsIDB4RkUsIDB4MkMsIDB4RkYsIDB4MkMsIDB4QTAsIDB4MTAsCisJ
MHhBMSwgMHgxMCwgMHhBMiwgMHgxMCwgMHhBMywgMHgxMCwgMHhBNCwgMHgxMCwKKwkweEE1LCAw
eDEwLCAweEE2LCAweDEwLCAweEE3LCAweDEwLCAweEE4LCAweDEwLAorCTB4QTksIDB4MTAsIDB4
QUEsIDB4MTAsIDB4QUIsIDB4MTAsIDB4QUMsIDB4MTAsCisJMHhBRCwgMHgxMCwgMHhBRSwgMHgx
MCwgMHhBRiwgMHgxMCwgMHhCMCwgMHgxMCwKKwkweEIxLCAweDEwLCAweEIyLCAweDEwLCAweEIz
LCAweDEwLCAweEI0LCAweDEwLAorCTB4QjUsIDB4MTAsIDB4QjYsIDB4MTAsIDB4QjcsIDB4MTAs
IDB4QjgsIDB4MTAsCisJMHhCOSwgMHgxMCwgMHhCQSwgMHgxMCwgMHhCQiwgMHgxMCwgMHhCQywg
MHgxMCwKKwkweEJELCAweDEwLCAweEJFLCAweDEwLCAweEJGLCAweDEwLCAweEMwLCAweDEwLAor
CTB4QzEsIDB4MTAsIDB4QzIsIDB4MTAsIDB4QzMsIDB4MTAsIDB4QzQsIDB4MTAsCisJMHhDNSwg
MHgxMCwgMHhGRiwgMHhGRiwgMHgxQiwgMHhEMiwgMHgyMSwgMHhGRiwKKwkweDIyLCAweEZGLCAw
eDIzLCAweEZGLCAweDI0LCAweEZGLCAweDI1LCAweEZGLAorCTB4MjYsIDB4RkYsIDB4MjcsIDB4
RkYsIDB4MjgsIDB4RkYsIDB4MjksIDB4RkYsCisJMHgyQSwgMHhGRiwgMHgyQiwgMHhGRiwgMHgy
QywgMHhGRiwgMHgyRCwgMHhGRiwKKwkweDJFLCAweEZGLCAweDJGLCAweEZGLCAweDMwLCAweEZG
LCAweDMxLCAweEZGLAorCTB4MzIsIDB4RkYsIDB4MzMsIDB4RkYsIDB4MzQsIDB4RkYsIDB4MzUs
IDB4RkYsCisJMHgzNiwgMHhGRiwgMHgzNywgMHhGRiwgMHgzOCwgMHhGRiwgMHgzOSwgMHhGRiwK
KwkweDNBLCAweEZGLCAweDVCLCAweEZGLCAweDVDLCAweEZGLCAweDVELCAweEZGLAorCTB4NUUs
IDB4RkYsIDB4NUYsIDB4RkYsIDB4NjAsIDB4RkYsIDB4NjEsIDB4RkYsCisJMHg2MiwgMHhGRiwg
MHg2MywgMHhGRiwgMHg2NCwgMHhGRiwgMHg2NSwgMHhGRiwKKwkweDY2LCAweEZGLCAweDY3LCAw
eEZGLCAweDY4LCAweEZGLCAweDY5LCAweEZGLAorCTB4NkEsIDB4RkYsIDB4NkIsIDB4RkYsIDB4
NkMsIDB4RkYsIDB4NkQsIDB4RkYsCisJMHg2RSwgMHhGRiwgMHg2RiwgMHhGRiwgMHg3MCwgMHhG
RiwgMHg3MSwgMHhGRiwKKwkweDcyLCAweEZGLCAweDczLCAweEZGLCAweDc0LCAweEZGLCAweDc1
LCAweEZGLAorCTB4NzYsIDB4RkYsIDB4NzcsIDB4RkYsIDB4NzgsIDB4RkYsIDB4NzksIDB4RkYs
CisJMHg3QSwgMHhGRiwgMHg3QiwgMHhGRiwgMHg3QywgMHhGRiwgMHg3RCwgMHhGRiwKKwkweDdF
LCAweEZGLCAweDdGLCAweEZGLCAweDgwLCAweEZGLCAweDgxLCAweEZGLAorCTB4ODIsIDB4RkYs
IDB4ODMsIDB4RkYsIDB4ODQsIDB4RkYsIDB4ODUsIDB4RkYsCisJMHg4NiwgMHhGRiwgMHg4Nywg
MHhGRiwgMHg4OCwgMHhGRiwgMHg4OSwgMHhGRiwKKwkweDhBLCAweEZGLCAweDhCLCAweEZGLCAw
eDhDLCAweEZGLCAweDhELCAweEZGLAorCTB4OEUsIDB4RkYsIDB4OEYsIDB4RkYsIDB4OTAsIDB4
RkYsIDB4OTEsIDB4RkYsCisJMHg5MiwgMHhGRiwgMHg5MywgMHhGRiwgMHg5NCwgMHhGRiwgMHg5
NSwgMHhGRiwKKwkweDk2LCAweEZGLCAweDk3LCAweEZGLCAweDk4LCAweEZGLCAweDk5LCAweEZG
LAorCTB4OUEsIDB4RkYsIDB4OUIsIDB4RkYsIDB4OUMsIDB4RkYsIDB4OUQsIDB4RkYsCisJMHg5
RSwgMHhGRiwgMHg5RiwgMHhGRiwgMHhBMCwgMHhGRiwgMHhBMSwgMHhGRiwKKwkweEEyLCAweEZG
LCAweEEzLCAweEZGLCAweEE0LCAweEZGLCAweEE1LCAweEZGLAorCTB4QTYsIDB4RkYsIDB4QTcs
IDB4RkYsIDB4QTgsIDB4RkYsIDB4QTksIDB4RkYsCisJMHhBQSwgMHhGRiwgMHhBQiwgMHhGRiwg
MHhBQywgMHhGRiwgMHhBRCwgMHhGRiwKKwkweEFFLCAweEZGLCAweEFGLCAweEZGLCAweEIwLCAw
eEZGLCAweEIxLCAweEZGLAorCTB4QjIsIDB4RkYsIDB4QjMsIDB4RkYsIDB4QjQsIDB4RkYsIDB4
QjUsIDB4RkYsCisJMHhCNiwgMHhGRiwgMHhCNywgMHhGRiwgMHhCOCwgMHhGRiwgMHhCOSwgMHhG
RiwKKwkweEJBLCAweEZGLCAweEJCLCAweEZGLCAweEJDLCAweEZGLCAweEJELCAweEZGLAorCTB4
QkUsIDB4RkYsIDB4QkYsIDB4RkYsIDB4QzAsIDB4RkYsIDB4QzEsIDB4RkYsCisJMHhDMiwgMHhG
RiwgMHhDMywgMHhGRiwgMHhDNCwgMHhGRiwgMHhDNSwgMHhGRiwKKwkweEM2LCAweEZGLCAweEM3
LCAweEZGLCAweEM4LCAweEZGLCAweEM5LCAweEZGLAorCTB4Q0EsIDB4RkYsIDB4Q0IsIDB4RkYs
IDB4Q0MsIDB4RkYsIDB4Q0QsIDB4RkYsCisJMHhDRSwgMHhGRiwgMHhDRiwgMHhGRiwgMHhEMCwg
MHhGRiwgMHhEMSwgMHhGRiwKKwkweEQyLCAweEZGLCAweEQzLCAweEZGLCAweEQ0LCAweEZGLCAw
eEQ1LCAweEZGLAorCTB4RDYsIDB4RkYsIDB4RDcsIDB4RkYsIDB4RDgsIDB4RkYsIDB4RDksIDB4
RkYsCisJMHhEQSwgMHhGRiwgMHhEQiwgMHhGRiwgMHhEQywgMHhGRiwgMHhERCwgMHhGRiwKKwkw
eERFLCAweEZGLCAweERGLCAweEZGLCAweEUwLCAweEZGLCAweEUxLCAweEZGLAorCTB4RTIsIDB4
RkYsIDB4RTMsIDB4RkYsIDB4RTQsIDB4RkYsIDB4RTUsIDB4RkYsCisJMHhFNiwgMHhGRiwgMHhF
NywgMHhGRiwgMHhFOCwgMHhGRiwgMHhFOSwgMHhGRiwKKwkweEVBLCAweEZGLCAweEVCLCAweEZG
LCAweEVDLCAweEZGLCAweEVELCAweEZGLAorCTB4RUUsIDB4RkYsIDB4RUYsIDB4RkYsIDB4RjAs
IDB4RkYsIDB4RjEsIDB4RkYsCisJMHhGMiwgMHhGRiwgMHhGMywgMHhGRiwgMHhGNCwgMHhGRiwg
MHhGNSwgMHhGRiwKKwkweEY2LCAweEZGLCAweEY3LCAweEZGLCAweEY4LCAweEZGLCAweEY5LCAw
eEZGLAorCTB4RkEsIDB4RkYsIDB4RkIsIDB4RkYsIDB4RkMsIDB4RkYsIDB4RkQsIDB4RkYsCisJ
MHhGRSwgMHhGRiwgMHhGRiwgMHhGRgorfTsKLS0gCjIuMjMuMAoKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZGV2ZWwgbWFpbGluZyBsaXN0CmRldmVsQGxp
bnV4ZHJpdmVycHJvamVjdC5vcmcKaHR0cDovL2RyaXZlcmRldi5saW51eGRyaXZlcnByb2plY3Qu
b3JnL21haWxtYW4vbGlzdGluZm8vZHJpdmVyZGV2LWRldmVsCg==
